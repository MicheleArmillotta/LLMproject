[
  {
    "function_name": "nfs_fs_proc_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1466-1471",
    "snippet": "void nfs_fs_proc_exit(void)\n{\n\tremove_proc_entry(\"volumes\", proc_fs_nfs);\n\tremove_proc_entry(\"servers\", proc_fs_nfs);\n\tremove_proc_entry(\"fs/nfsfs\", NULL);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_entry",
          "args": [
            "\"fs/nfsfs\"",
            "NULL"
          ],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "523-554",
          "snippet": "void remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nvoid remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_fs_proc_exit(void)\n{\n\tremove_proc_entry(\"volumes\", proc_fs_nfs);\n\tremove_proc_entry(\"servers\", proc_fs_nfs);\n\tremove_proc_entry(\"fs/nfsfs\", NULL);\n}"
  },
  {
    "function_name": "nfs_fs_proc_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1436-1461",
    "snippet": "int __init nfs_fs_proc_init(void)\n{\n\tstruct proc_dir_entry *p;\n\n\tproc_fs_nfs = proc_mkdir(\"fs/nfsfs\", NULL);\n\tif (!proc_fs_nfs)\n\t\tgoto error_0;\n\n\t/* a file of servers with which we're dealing */\n\tp = proc_symlink(\"servers\", proc_fs_nfs, \"../../net/nfsfs/servers\");\n\tif (!p)\n\t\tgoto error_1;\n\n\t/* a file of volumes that we have mounted */\n\tp = proc_symlink(\"volumes\", proc_fs_nfs, \"../../net/nfsfs/volumes\");\n\tif (!p)\n\t\tgoto error_2;\n\treturn 0;\n\nerror_2:\n\tremove_proc_entry(\"servers\", proc_fs_nfs);\nerror_1:\n\tremove_proc_entry(\"fs/nfsfs\", NULL);\nerror_0:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_entry",
          "args": [
            "\"fs/nfsfs\"",
            "NULL"
          ],
          "line": 1458
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "523-554",
          "snippet": "void remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nvoid remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_symlink",
          "args": [
            "\"volumes\"",
            "proc_fs_nfs",
            "\"../../net/nfsfs/volumes\""
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "proc_symlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "393-417",
          "snippet": "struct proc_dir_entry *proc_symlink(const char *name,\n\t\tstruct proc_dir_entry *parent, const char *dest)\n{\n\tstruct proc_dir_entry *ent;\n\n\tent = __proc_create(&parent, name,\n\t\t\t  (S_IFLNK | S_IRUGO | S_IWUGO | S_IXUGO),1);\n\n\tif (ent) {\n\t\tent->data = kmalloc((ent->size=strlen(dest))+1, GFP_KERNEL);\n\t\tif (ent->data) {\n\t\t\tstrcpy((char*)ent->data,dest);\n\t\t\tent->proc_iops = &proc_link_inode_operations;\n\t\t\tif (proc_register(parent, ent) < 0) {\n\t\t\t\tkfree(ent->data);\n\t\t\t\tkfree(ent);\n\t\t\t\tent = NULL;\n\t\t\t}\n\t\t} else {\n\t\t\tkfree(ent);\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_symlink(const char *name,\n\t\tstruct proc_dir_entry *parent, const char *dest)\n{\n\tstruct proc_dir_entry *ent;\n\n\tent = __proc_create(&parent, name,\n\t\t\t  (S_IFLNK | S_IRUGO | S_IWUGO | S_IXUGO),1);\n\n\tif (ent) {\n\t\tent->data = kmalloc((ent->size=strlen(dest))+1, GFP_KERNEL);\n\t\tif (ent->data) {\n\t\t\tstrcpy((char*)ent->data,dest);\n\t\t\tent->proc_iops = &proc_link_inode_operations;\n\t\t\tif (proc_register(parent, ent) < 0) {\n\t\t\t\tkfree(ent->data);\n\t\t\t\tkfree(ent);\n\t\t\t\tent = NULL;\n\t\t\t}\n\t\t} else {\n\t\t\tkfree(ent);\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_mkdir",
          "args": [
            "\"fs/nfsfs\"",
            "NULL"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "proc_mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "451-455",
          "snippet": "struct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint __init nfs_fs_proc_init(void)\n{\n\tstruct proc_dir_entry *p;\n\n\tproc_fs_nfs = proc_mkdir(\"fs/nfsfs\", NULL);\n\tif (!proc_fs_nfs)\n\t\tgoto error_0;\n\n\t/* a file of servers with which we're dealing */\n\tp = proc_symlink(\"servers\", proc_fs_nfs, \"../../net/nfsfs/servers\");\n\tif (!p)\n\t\tgoto error_1;\n\n\t/* a file of volumes that we have mounted */\n\tp = proc_symlink(\"volumes\", proc_fs_nfs, \"../../net/nfsfs/volumes\");\n\tif (!p)\n\t\tgoto error_2;\n\treturn 0;\n\nerror_2:\n\tremove_proc_entry(\"servers\", proc_fs_nfs);\nerror_1:\n\tremove_proc_entry(\"fs/nfsfs\", NULL);\nerror_0:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "nfs_fs_proc_net_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1428-1431",
    "snippet": "void nfs_fs_proc_net_exit(struct net *net)\n{\n\tremove_proc_subtree(\"nfsfs\", net->proc_net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_subtree",
          "args": [
            "\"nfsfs\"",
            "net->proc_net"
          ],
          "line": 1430
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_subtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "557-601",
          "snippet": "int remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_fs_proc_net_exit(struct net *net)\n{\n\tremove_proc_subtree(\"nfsfs\", net->proc_net);\n}"
  },
  {
    "function_name": "nfs_fs_proc_net_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1400-1426",
    "snippet": "int nfs_fs_proc_net_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\tstruct proc_dir_entry *p;\n\n\tnn->proc_nfsfs = proc_net_mkdir(net, \"nfsfs\", net->proc_net);\n\tif (!nn->proc_nfsfs)\n\t\tgoto error_0;\n\n\t/* a file of servers with which we're dealing */\n\tp = proc_create(\"servers\", S_IFREG|S_IRUGO,\n\t\t\tnn->proc_nfsfs, &nfs_server_list_fops);\n\tif (!p)\n\t\tgoto error_1;\n\n\t/* a file of volumes that we have mounted */\n\tp = proc_create(\"volumes\", S_IFREG|S_IRUGO,\n\t\t\tnn->proc_nfsfs, &nfs_volume_list_fops);\n\tif (!p)\n\t\tgoto error_1;\n\treturn 0;\n\nerror_1:\n\tremove_proc_subtree(\"nfsfs\", net->proc_net);\nerror_0:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_subtree",
          "args": [
            "\"nfsfs\"",
            "net->proc_net"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_subtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "557-601",
          "snippet": "int remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"volumes\"",
            "S_IFREG|S_IRUGO",
            "nn->proc_nfsfs",
            "&nfs_volume_list_fops"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "3532-3558",
          "snippet": "static int\nnfs4_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\t int flags)\n{\n\tstruct nfs4_label l, *ilabel = NULL;\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state *state;\n\tint opened = 0;\n\tint status = 0;\n\n\tctx = alloc_nfs_open_context(dentry, FMODE_READ);\n\tif (IS_ERR(ctx))\n\t\treturn PTR_ERR(ctx);\n\n\tilabel = nfs4_label_init_security(dir, dentry, sattr, &l);\n\n\tsattr->ia_mode &= ~current_umask();\n\tstate = nfs4_do_open(dir, ctx, flags, sattr, ilabel, &opened);\n\tif (IS_ERR(state)) {\n\t\tstatus = PTR_ERR(state);\n\t\tgoto out;\n\t}\nout:\n\tnfs4_label_release_security(ilabel);\n\tput_nfs_open_context(ctx);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);\n\nstatic int\nnfs4_proc_create(struct inode *dir, struct dentry *dentry, struct iattr *sattr,\n\t\t int flags)\n{\n\tstruct nfs4_label l, *ilabel = NULL;\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state *state;\n\tint opened = 0;\n\tint status = 0;\n\n\tctx = alloc_nfs_open_context(dentry, FMODE_READ);\n\tif (IS_ERR(ctx))\n\t\treturn PTR_ERR(ctx);\n\n\tilabel = nfs4_label_init_security(dir, dentry, sattr, &l);\n\n\tsattr->ia_mode &= ~current_umask();\n\tstate = nfs4_do_open(dir, ctx, flags, sattr, ilabel, &opened);\n\tif (IS_ERR(state)) {\n\t\tstatus = PTR_ERR(state);\n\t\tgoto out;\n\t}\nout:\n\tnfs4_label_release_security(ilabel);\n\tput_nfs_open_context(ctx);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_net_mkdir",
          "args": [
            "net",
            "\"nfsfs\"",
            "net->proc_net"
          ],
          "line": 1405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 1402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_fs_proc_net_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\tstruct proc_dir_entry *p;\n\n\tnn->proc_nfsfs = proc_net_mkdir(net, \"nfsfs\", net->proc_net);\n\tif (!nn->proc_nfsfs)\n\t\tgoto error_0;\n\n\t/* a file of servers with which we're dealing */\n\tp = proc_create(\"servers\", S_IFREG|S_IRUGO,\n\t\t\tnn->proc_nfsfs, &nfs_server_list_fops);\n\tif (!p)\n\t\tgoto error_1;\n\n\t/* a file of volumes that we have mounted */\n\tp = proc_create(\"volumes\", S_IFREG|S_IRUGO,\n\t\t\tnn->proc_nfsfs, &nfs_volume_list_fops);\n\tif (!p)\n\t\tgoto error_1;\n\treturn 0;\n\nerror_1:\n\tremove_proc_subtree(\"nfsfs\", net->proc_net);\nerror_0:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "nfs_volume_list_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1364-1398",
    "snippet": "static int nfs_volume_list_show(struct seq_file *m, void *v)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_client *clp;\n\tchar dev[8], fsid[17];\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* display header on line 1 */\n\tif (v == &nn->nfs_volume_list) {\n\t\tseq_puts(m, \"NV SERVER   PORT DEV     FSID              FSC\\n\");\n\t\treturn 0;\n\t}\n\t/* display one transport per line on subsequent lines */\n\tserver = list_entry(v, struct nfs_server, master_link);\n\tclp = server->nfs_client;\n\n\tsnprintf(dev, 8, \"%u:%u\",\n\t\t MAJOR(server->s_dev), MINOR(server->s_dev));\n\n\tsnprintf(fsid, 17, \"%llx:%llx\",\n\t\t (unsigned long long) server->fsid.major,\n\t\t (unsigned long long) server->fsid.minor);\n\n\trcu_read_lock();\n\tseq_printf(m, \"v%u %s %s %-7s %-17s %s\\n\",\n\t\t   clp->rpc_ops->version,\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR),\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT),\n\t\t   dev,\n\t\t   fsid,\n\t\t   nfs_server_fscache_state(server));\n\trcu_read_unlock();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"v%u %s %s %-7s %-17s %s\\n\"",
            "clp->rpc_ops->version",
            "rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR)",
            "rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT)",
            "dev",
            "fsid",
            "nfs_server_fscache_state(server)"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_fscache_state",
          "args": [
            "server"
          ],
          "line": 1394
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_fscache_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.h",
          "lines": "223-226",
          "snippet": "static inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\treturn \"no \";\n}",
          "includes": [
            "#include <linux/fscache.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fscache.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n\nstatic inline const char *nfs_server_fscache_state(struct nfs_server *server)\n{\n\treturn \"no \";\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "clp->cl_rpcclient",
            "RPC_DISPLAY_HEX_PORT"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "clp->cl_rpcclient",
            "RPC_DISPLAY_HEX_ADDR"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "fsid",
            "17",
            "\"%llx:%llx\"",
            "(unsigned long long) server->fsid.major",
            "(unsigned long long) server->fsid.minor"
          ],
          "line": 1383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "dev",
            "8",
            "\"%u:%u\"",
            "MAJOR(server->s_dev)",
            "MINOR(server->s_dev)"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "server->s_dev"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "server->s_dev"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "v",
            "structnfs_server",
            "master_link"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"NV SERVER   PORT DEV     FSID              FSC\\n\""
          ],
          "line": 1373
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(m)",
            "nfs_net_id"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "m"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_volume_list_show(struct seq_file *m, void *v)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_client *clp;\n\tchar dev[8], fsid[17];\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* display header on line 1 */\n\tif (v == &nn->nfs_volume_list) {\n\t\tseq_puts(m, \"NV SERVER   PORT DEV     FSID              FSC\\n\");\n\t\treturn 0;\n\t}\n\t/* display one transport per line on subsequent lines */\n\tserver = list_entry(v, struct nfs_server, master_link);\n\tclp = server->nfs_client;\n\n\tsnprintf(dev, 8, \"%u:%u\",\n\t\t MAJOR(server->s_dev), MINOR(server->s_dev));\n\n\tsnprintf(fsid, 17, \"%llx:%llx\",\n\t\t (unsigned long long) server->fsid.major,\n\t\t (unsigned long long) server->fsid.minor);\n\n\trcu_read_lock();\n\tseq_printf(m, \"v%u %s %s %-7s %-17s %s\\n\",\n\t\t   clp->rpc_ops->version,\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR),\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT),\n\t\t   dev,\n\t\t   fsid,\n\t\t   nfs_server_fscache_state(server));\n\trcu_read_unlock();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_volume_list_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1353-1359",
    "snippet": "static void nfs_volume_list_stop(struct seq_file *p, void *v)\n\t\t\t\t__releases(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\tspin_unlock(&nn->nfs_client_lock);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1358
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(p)",
            "nfs_net_id"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "p"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_volume_list_stop(struct seq_file *p, void *v)\n\t\t\t\t__releases(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\tspin_unlock(&nn->nfs_client_lock);\n}"
  },
  {
    "function_name": "nfs_volume_list_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1343-1348",
    "snippet": "static void *nfs_volume_list_next(struct seq_file *p, void *v, loff_t *pos)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\treturn seq_list_next(v, &nn->nfs_volume_list, pos);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_next",
          "args": [
            "v",
            "&nn->nfs_volume_list",
            "pos"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "seq_list_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "779-786",
          "snippet": "struct list_head *seq_list_next(void *v, struct list_head *head, loff_t *ppos)\n{\n\tstruct list_head *lh;\n\n\tlh = ((struct list_head *)v)->next;\n\t++*ppos;\n\treturn lh == head ? NULL : lh;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstruct list_head *seq_list_next(void *v, struct list_head *head, loff_t *ppos)\n{\n\tstruct list_head *lh;\n\n\tlh = ((struct list_head *)v)->next;\n\t++*ppos;\n\treturn lh == head ? NULL : lh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(p)",
            "nfs_net_id"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "p"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void *nfs_volume_list_next(struct seq_file *p, void *v, loff_t *pos)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\treturn seq_list_next(v, &nn->nfs_volume_list, pos);\n}"
  },
  {
    "function_name": "nfs_volume_list_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1330-1338",
    "snippet": "static void *nfs_volume_list_start(struct seq_file *m, loff_t *_pos)\n\t\t\t\t__acquires(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* lock the list against modification */\n\tspin_lock(&nn->nfs_client_lock);\n\treturn seq_list_start_head(&nn->nfs_volume_list, *_pos);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_start_head",
          "args": [
            "&nn->nfs_volume_list",
            "*_pos"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "seq_list_start_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "770-776",
          "snippet": "struct list_head *seq_list_start_head(struct list_head *head, loff_t pos)\n{\n\tif (!pos)\n\t\treturn head;\n\n\treturn seq_list_start(head, pos - 1);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstruct list_head *seq_list_start_head(struct list_head *head, loff_t pos)\n{\n\tif (!pos)\n\t\treturn head;\n\n\treturn seq_list_start(head, pos - 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(m)",
            "nfs_net_id"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "m"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void *nfs_volume_list_start(struct seq_file *m, loff_t *_pos)\n\t\t\t\t__acquires(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* lock the list against modification */\n\tspin_lock(&nn->nfs_client_lock);\n\treturn seq_list_start_head(&nn->nfs_volume_list, *_pos);\n}"
  },
  {
    "function_name": "nfs_volume_list_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1321-1325",
    "snippet": "static int nfs_volume_list_open(struct inode *inode, struct file *file)\n{\n\treturn seq_open_net(inode, file, &nfs_volume_list_ops,\n\t\t\t   sizeof(struct seq_net_private));\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_open_net",
          "args": [
            "inode",
            "file",
            "&nfs_volume_list_ops",
            "sizeof(struct seq_net_private)"
          ],
          "line": 1323
        },
        "resolved": true,
        "details": {
          "function_name": "seq_open_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_net.c",
          "lines": "39-60",
          "snippet": "int seq_open_net(struct inode *ino, struct file *f,\n\t\t const struct seq_operations *ops, int size)\n{\n\tstruct net *net;\n\tstruct seq_net_private *p;\n\n\tBUG_ON(size < sizeof(*p));\n\n\tnet = get_proc_net(ino);\n\tif (net == NULL)\n\t\treturn -ENXIO;\n\n\tp = __seq_open_private(f, ops, size);\n\tif (p == NULL) {\n\t\tput_net(net);\n\t\treturn -ENOMEM;\n\t}\n#ifdef CONFIG_NET_NS\n\tp->net = net;\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/mount.h>",
            "#include <linux/bitops.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <asm/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <net/net_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/mount.h>\n#include <linux/bitops.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <asm/uaccess.h>\n\nint seq_open_net(struct inode *ino, struct file *f,\n\t\t const struct seq_operations *ops, int size)\n{\n\tstruct net *net;\n\tstruct seq_net_private *p;\n\n\tBUG_ON(size < sizeof(*p));\n\n\tnet = get_proc_net(ino);\n\tif (net == NULL)\n\t\treturn -ENXIO;\n\n\tp = __seq_open_private(f, ops, size);\n\tif (p == NULL) {\n\t\tput_net(net);\n\t\treturn -ENOMEM;\n\t}\n#ifdef CONFIG_NET_NS\n\tp->net = net;\n#endif\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_volume_list_open(struct inode *inode, struct file *file)\n{\n\treturn seq_open_net(inode, file, &nfs_volume_list_ops,\n\t\t\t   sizeof(struct seq_net_private));\n}"
  },
  {
    "function_name": "nfs_server_list_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1288-1316",
    "snippet": "static int nfs_server_list_show(struct seq_file *m, void *v)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* display header on line 1 */\n\tif (v == &nn->nfs_client_list) {\n\t\tseq_puts(m, \"NV SERVER   PORT USE HOSTNAME\\n\");\n\t\treturn 0;\n\t}\n\n\t/* display one transport per line on subsequent lines */\n\tclp = list_entry(v, struct nfs_client, cl_share_link);\n\n\t/* Check if the client is initialized */\n\tif (clp->cl_cons_state != NFS_CS_READY)\n\t\treturn 0;\n\n\trcu_read_lock();\n\tseq_printf(m, \"v%u %s %s %3d %s\\n\",\n\t\t   clp->rpc_ops->version,\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR),\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT),\n\t\t   atomic_read(&clp->cl_count),\n\t\t   clp->cl_hostname);\n\trcu_read_unlock();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"v%u %s %s %3d %s\\n\"",
            "clp->rpc_ops->version",
            "rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR)",
            "rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT)",
            "atomic_read(&clp->cl_count)",
            "clp->cl_hostname"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&clp->cl_count"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "clp->cl_rpcclient",
            "RPC_DISPLAY_HEX_PORT"
          ],
          "line": 1310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "clp->cl_rpcclient",
            "RPC_DISPLAY_HEX_ADDR"
          ],
          "line": 1309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "v",
            "structnfs_client",
            "cl_share_link"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"NV SERVER   PORT USE HOSTNAME\\n\""
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(m)",
            "nfs_net_id"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "m"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_server_list_show(struct seq_file *m, void *v)\n{\n\tstruct nfs_client *clp;\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* display header on line 1 */\n\tif (v == &nn->nfs_client_list) {\n\t\tseq_puts(m, \"NV SERVER   PORT USE HOSTNAME\\n\");\n\t\treturn 0;\n\t}\n\n\t/* display one transport per line on subsequent lines */\n\tclp = list_entry(v, struct nfs_client, cl_share_link);\n\n\t/* Check if the client is initialized */\n\tif (clp->cl_cons_state != NFS_CS_READY)\n\t\treturn 0;\n\n\trcu_read_lock();\n\tseq_printf(m, \"v%u %s %s %3d %s\\n\",\n\t\t   clp->rpc_ops->version,\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_ADDR),\n\t\t   rpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_HEX_PORT),\n\t\t   atomic_read(&clp->cl_count),\n\t\t   clp->cl_hostname);\n\trcu_read_unlock();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_server_list_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1277-1283",
    "snippet": "static void nfs_server_list_stop(struct seq_file *p, void *v)\n\t\t\t\t__releases(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\tspin_unlock(&nn->nfs_client_lock);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1282
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(p)",
            "nfs_net_id"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "p"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_server_list_stop(struct seq_file *p, void *v)\n\t\t\t\t__releases(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\tspin_unlock(&nn->nfs_client_lock);\n}"
  },
  {
    "function_name": "nfs_server_list_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1267-1272",
    "snippet": "static void *nfs_server_list_next(struct seq_file *p, void *v, loff_t *pos)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\treturn seq_list_next(v, &nn->nfs_client_list, pos);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_next",
          "args": [
            "v",
            "&nn->nfs_client_list",
            "pos"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "seq_list_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "779-786",
          "snippet": "struct list_head *seq_list_next(void *v, struct list_head *head, loff_t *ppos)\n{\n\tstruct list_head *lh;\n\n\tlh = ((struct list_head *)v)->next;\n\t++*ppos;\n\treturn lh == head ? NULL : lh;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstruct list_head *seq_list_next(void *v, struct list_head *head, loff_t *ppos)\n{\n\tstruct list_head *lh;\n\n\tlh = ((struct list_head *)v)->next;\n\t++*ppos;\n\treturn lh == head ? NULL : lh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(p)",
            "nfs_net_id"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "p"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void *nfs_server_list_next(struct seq_file *p, void *v, loff_t *pos)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(p), nfs_net_id);\n\n\treturn seq_list_next(v, &nn->nfs_client_list, pos);\n}"
  },
  {
    "function_name": "nfs_server_list_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1254-1262",
    "snippet": "static void *nfs_server_list_start(struct seq_file *m, loff_t *_pos)\n\t\t\t\t__acquires(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* lock the list against modification */\n\tspin_lock(&nn->nfs_client_lock);\n\treturn seq_list_start_head(&nn->nfs_client_list, *_pos);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_start_head",
          "args": [
            "&nn->nfs_client_list",
            "*_pos"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "seq_list_start_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "770-776",
          "snippet": "struct list_head *seq_list_start_head(struct list_head *head, loff_t pos)\n{\n\tif (!pos)\n\t\treturn head;\n\n\treturn seq_list_start(head, pos - 1);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nstruct list_head *seq_list_start_head(struct list_head *head, loff_t pos)\n{\n\tif (!pos)\n\t\treturn head;\n\n\treturn seq_list_start(head, pos - 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "seq_file_net(m)",
            "nfs_net_id"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_net",
          "args": [
            "m"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void *nfs_server_list_start(struct seq_file *m, loff_t *_pos)\n\t\t\t\t__acquires(&nn->nfs_client_lock)\n{\n\tstruct nfs_net *nn = net_generic(seq_file_net(m), nfs_net_id);\n\n\t/* lock the list against modification */\n\tspin_lock(&nn->nfs_client_lock);\n\treturn seq_list_start_head(&nn->nfs_client_list, *_pos);\n}"
  },
  {
    "function_name": "nfs_server_list_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1245-1249",
    "snippet": "static int nfs_server_list_open(struct inode *inode, struct file *file)\n{\n\treturn seq_open_net(inode, file, &nfs_server_list_ops,\n\t\t\t   sizeof(struct seq_net_private));\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_open_net",
          "args": [
            "inode",
            "file",
            "&nfs_server_list_ops",
            "sizeof(struct seq_net_private)"
          ],
          "line": 1247
        },
        "resolved": true,
        "details": {
          "function_name": "seq_open_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_net.c",
          "lines": "39-60",
          "snippet": "int seq_open_net(struct inode *ino, struct file *f,\n\t\t const struct seq_operations *ops, int size)\n{\n\tstruct net *net;\n\tstruct seq_net_private *p;\n\n\tBUG_ON(size < sizeof(*p));\n\n\tnet = get_proc_net(ino);\n\tif (net == NULL)\n\t\treturn -ENXIO;\n\n\tp = __seq_open_private(f, ops, size);\n\tif (p == NULL) {\n\t\tput_net(net);\n\t\treturn -ENOMEM;\n\t}\n#ifdef CONFIG_NET_NS\n\tp->net = net;\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/mount.h>",
            "#include <linux/bitops.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <asm/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <net/net_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/mount.h>\n#include <linux/bitops.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <asm/uaccess.h>\n\nint seq_open_net(struct inode *ino, struct file *f,\n\t\t const struct seq_operations *ops, int size)\n{\n\tstruct net *net;\n\tstruct seq_net_private *p;\n\n\tBUG_ON(size < sizeof(*p));\n\n\tnet = get_proc_net(ino);\n\tif (net == NULL)\n\t\treturn -ENXIO;\n\n\tp = __seq_open_private(f, ops, size);\n\tif (p == NULL) {\n\t\tput_net(net);\n\t\treturn -ENOMEM;\n\t}\n#ifdef CONFIG_NET_NS\n\tp->net = net;\n#endif\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_server_list_open(struct inode *inode, struct file *file)\n{\n\treturn seq_open_net(inode, file, &nfs_server_list_ops,\n\t\t\t   sizeof(struct seq_net_private));\n}"
  },
  {
    "function_name": "nfs_clients_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1183-1194",
    "snippet": "void nfs_clients_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tINIT_LIST_HEAD(&nn->nfs_client_list);\n\tINIT_LIST_HEAD(&nn->nfs_volume_list);\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tidr_init(&nn->cb_ident_idr);\n#endif\n\tspin_lock_init(&nn->nfs_client_lock);\n\tnn->boot_time = CURRENT_TIME;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idr_init",
          "args": [
            "&nn->cb_ident_idr"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nn->nfs_volume_list"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&nn->nfs_client_list"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_clients_init(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tINIT_LIST_HEAD(&nn->nfs_client_list);\n\tINIT_LIST_HEAD(&nn->nfs_volume_list);\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tidr_init(&nn->cb_ident_idr);\n#endif\n\tspin_lock_init(&nn->nfs_client_lock);\n\tnn->boot_time = CURRENT_TIME;\n}"
  },
  {
    "function_name": "nfs_clone_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1116-1180",
    "snippet": "struct nfs_server *nfs_clone_server(struct nfs_server *source,\n\t\t\t\t    struct nfs_fh *fh,\n\t\t\t\t    struct nfs_fattr *fattr,\n\t\t\t\t    rpc_authflavor_t flavor)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_fattr *fattr_fsinfo;\n\tint error;\n\n\tdprintk(\"--> nfs_clone_server(,%llx:%llx,)\\n\",\n\t\t(unsigned long long) fattr->fsid.major,\n\t\t(unsigned long long) fattr->fsid.minor);\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terror = -ENOMEM;\n\tfattr_fsinfo = nfs_alloc_fattr();\n\tif (fattr_fsinfo == NULL)\n\t\tgoto out_free_server;\n\n\t/* Copy data from the source */\n\tserver->nfs_client = source->nfs_client;\n\tserver->destroy = source->destroy;\n\tatomic_inc(&server->nfs_client->cl_count);\n\tnfs_server_copy_userdata(server, source);\n\n\tserver->fsid = fattr->fsid;\n\n\terror = nfs_init_server_rpcclient(server,\n\t\t\tsource->client->cl_timeout,\n\t\t\tflavor);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\t/* probe the filesystem info for this server filesystem */\n\terror = nfs_probe_fsinfo(server, fh, fattr_fsinfo);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tdprintk(\"Cloned FSID: %llx:%llx\\n\",\n\t\t(unsigned long long) server->fsid.major,\n\t\t(unsigned long long) server->fsid.minor);\n\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\n\tnfs_free_fattr(fattr_fsinfo);\n\tdprintk(\"<-- nfs_clone_server() = %p\\n\", server);\n\treturn server;\n\nout_free_server:\n\tnfs_free_fattr(fattr_fsinfo);\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs_clone_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_clone_server() = error %d\\n\"",
            "error"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr_fsinfo"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_clone_server() = %p\\n\"",
            "server"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr_fsinfo"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_insert_lists",
          "args": [
            "server"
          ],
          "line": 1168
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_insert_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "945-956",
          "snippet": "void nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_start_lockd",
          "args": [
            "server"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_lockd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "635-670",
          "snippet": "static int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nstatic int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"Cloned FSID: %llx:%llx\\n\"",
            "(unsigned long long) server->fsid.major",
            "(unsigned long long) server->fsid.minor"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_probe_fsinfo",
          "args": [
            "server",
            "fh",
            "fattr_fsinfo"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_probe_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "885-924",
          "snippet": "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_server_rpcclient",
          "args": [
            "server",
            "source->client->cl_timeout",
            "flavor"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_server_rpcclient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "675-697",
          "snippet": "int nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_copy_userdata",
          "args": [
            "server",
            "source"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_copy_userdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "930-942",
          "snippet": "void nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&server->nfs_client->cl_count"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_server",
          "args": [],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "981-1017",
          "snippet": "struct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_clone_server(,%llx:%llx,)\\n\"",
            "(unsigned long long) fattr->fsid.major",
            "(unsigned long long) fattr->fsid.minor"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_clone_server(struct nfs_server *source,\n\t\t\t\t    struct nfs_fh *fh,\n\t\t\t\t    struct nfs_fattr *fattr,\n\t\t\t\t    rpc_authflavor_t flavor)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_fattr *fattr_fsinfo;\n\tint error;\n\n\tdprintk(\"--> nfs_clone_server(,%llx:%llx,)\\n\",\n\t\t(unsigned long long) fattr->fsid.major,\n\t\t(unsigned long long) fattr->fsid.minor);\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terror = -ENOMEM;\n\tfattr_fsinfo = nfs_alloc_fattr();\n\tif (fattr_fsinfo == NULL)\n\t\tgoto out_free_server;\n\n\t/* Copy data from the source */\n\tserver->nfs_client = source->nfs_client;\n\tserver->destroy = source->destroy;\n\tatomic_inc(&server->nfs_client->cl_count);\n\tnfs_server_copy_userdata(server, source);\n\n\tserver->fsid = fattr->fsid;\n\n\terror = nfs_init_server_rpcclient(server,\n\t\t\tsource->client->cl_timeout,\n\t\t\tflavor);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\t/* probe the filesystem info for this server filesystem */\n\terror = nfs_probe_fsinfo(server, fh, fattr_fsinfo);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\tif (server->namelen == 0 || server->namelen > NFS4_MAXNAMLEN)\n\t\tserver->namelen = NFS4_MAXNAMLEN;\n\n\tdprintk(\"Cloned FSID: %llx:%llx\\n\",\n\t\t(unsigned long long) server->fsid.major,\n\t\t(unsigned long long) server->fsid.minor);\n\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto out_free_server;\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\n\tnfs_free_fattr(fattr_fsinfo);\n\tdprintk(\"<-- nfs_clone_server() = %p\\n\", server);\n\treturn server;\n\nout_free_server:\n\tnfs_free_fattr(fattr_fsinfo);\n\tnfs_free_server(server);\n\tdprintk(\"<-- nfs_clone_server() = error %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs_create_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1053-1110",
    "snippet": "struct nfs_server *nfs_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t     struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terror = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto error;\n\n\t/* Get a client representation */\n\terror = nfs_init_server(server, mount_info->parsed, nfs_mod);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Probe the root fh to retrieve its FSID */\n\terror = nfs_probe_fsinfo(server, mount_info->mntfh, fattr);\n\tif (error < 0)\n\t\tgoto error;\n\tif (server->nfs_client->rpc_ops->version == 3) {\n\t\tif (server->namelen == 0 || server->namelen > NFS3_MAXNAMLEN)\n\t\t\tserver->namelen = NFS3_MAXNAMLEN;\n\t\tif (!(mount_info->parsed->flags & NFS_MOUNT_NORDIRPLUS))\n\t\t\tserver->caps |= NFS_CAP_READDIRPLUS;\n\t} else {\n\t\tif (server->namelen == 0 || server->namelen > NFS2_MAXNAMLEN)\n\t\t\tserver->namelen = NFS2_MAXNAMLEN;\n\t}\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\terror = nfs_mod->rpc_ops->getattr(server, mount_info->mntfh, fattr, NULL);\n\t\tif (error < 0) {\n\t\t\tdprintk(\"nfs_create_server: getattr error = %d\\n\", -error);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tmemcpy(&server->fsid, &fattr->fsid, sizeof(server->fsid));\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t(unsigned long long) server->fsid.major,\n\t\t(unsigned long long) server->fsid.minor);\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tnfs_free_fattr(fattr);\n\treturn server;\n\nerror:\n\tnfs_free_fattr(fattr);\n\tnfs_free_server(server);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "fattr"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_insert_lists",
          "args": [
            "server"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_insert_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "945-956",
          "snippet": "void nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"Server FSID: %llx:%llx\\n\"",
            "(unsigned long long) server->fsid.major",
            "(unsigned long long) server->fsid.minor"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&server->fsid",
            "&fattr->fsid",
            "sizeof(server->fsid)"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs_create_server: getattr error = %d\\n\"",
            "-error"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->getattr",
          "args": [
            "server",
            "mount_info->mntfh",
            "fattr",
            "NULL"
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_probe_fsinfo",
          "args": [
            "server",
            "mount_info->mntfh",
            "fattr"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_probe_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "885-924",
          "snippet": "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_server",
          "args": [
            "server",
            "mount_info->parsed",
            "nfs_mod"
          ],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "742-823",
          "snippet": "static int nfs_init_server(struct nfs_server *server,\n\t\t\t   const struct nfs_parsed_mount_data *data,\n\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = data->nfs_server.hostname,\n\t\t.addr = (const struct sockaddr *)&data->nfs_server.address,\n\t\t.addrlen = data->nfs_server.addrlen,\n\t\t.nfs_mod = nfs_mod,\n\t\t.proto = data->nfs_server.protocol,\n\t\t.net = data->net,\n\t};\n\tstruct rpc_timeout timeparms;\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\tif (data->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, &timeparms, NULL, RPC_AUTH_UNIX);\n\tif (IS_ERR(clp)) {\n\t\tdprintk(\"<-- nfs_init_server() = error %ld\\n\", PTR_ERR(clp));\n\t\treturn PTR_ERR(clp);\n\t}\n\n\tserver->nfs_client = clp;\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->caps |= NFS_CAP_HARDLINKS|NFS_CAP_SYMLINKS|NFS_CAP_FILEID|\n\t\tNFS_CAP_MODE|NFS_CAP_NLINK|NFS_CAP_OWNER|NFS_CAP_OWNER_GROUP|\n\t\tNFS_CAP_ATIME|NFS_CAP_CTIME|NFS_CAP_MTIME|NFS_CAP_CHANGE_ATTR;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\t/* Start lockd here, before we might error out */\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto error;\n\n\tserver->port = data->nfs_server.port;\n\tserver->auth_info = data->auth_info;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Preserve the values of mount_server-related mount options */\n\tif (data->mount_server.addrlen) {\n\t\tmemcpy(&server->mountd_address, &data->mount_server.address,\n\t\t\tdata->mount_server.addrlen);\n\t\tserver->mountd_addrlen = data->mount_server.addrlen;\n\t}\n\tserver->mountd_version = data->mount_server.version;\n\tserver->mountd_port = data->mount_server.port;\n\tserver->mountd_protocol = data->mount_server.protocol;\n\n\tserver->namelen  = data->namlen;\n\tdprintk(\"<-- nfs_init_server() = 0 [new %p]\\n\", clp);\n\treturn 0;\n\nerror:\n\tserver->nfs_client = NULL;\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_server() = xerror %d\\n\", error);\n\treturn error;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_init_server(struct nfs_server *server,\n\t\t\t   const struct nfs_parsed_mount_data *data,\n\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = data->nfs_server.hostname,\n\t\t.addr = (const struct sockaddr *)&data->nfs_server.address,\n\t\t.addrlen = data->nfs_server.addrlen,\n\t\t.nfs_mod = nfs_mod,\n\t\t.proto = data->nfs_server.protocol,\n\t\t.net = data->net,\n\t};\n\tstruct rpc_timeout timeparms;\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\tif (data->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, &timeparms, NULL, RPC_AUTH_UNIX);\n\tif (IS_ERR(clp)) {\n\t\tdprintk(\"<-- nfs_init_server() = error %ld\\n\", PTR_ERR(clp));\n\t\treturn PTR_ERR(clp);\n\t}\n\n\tserver->nfs_client = clp;\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->caps |= NFS_CAP_HARDLINKS|NFS_CAP_SYMLINKS|NFS_CAP_FILEID|\n\t\tNFS_CAP_MODE|NFS_CAP_NLINK|NFS_CAP_OWNER|NFS_CAP_OWNER_GROUP|\n\t\tNFS_CAP_ATIME|NFS_CAP_CTIME|NFS_CAP_MTIME|NFS_CAP_CHANGE_ATTR;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\t/* Start lockd here, before we might error out */\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto error;\n\n\tserver->port = data->nfs_server.port;\n\tserver->auth_info = data->auth_info;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Preserve the values of mount_server-related mount options */\n\tif (data->mount_server.addrlen) {\n\t\tmemcpy(&server->mountd_address, &data->mount_server.address,\n\t\t\tdata->mount_server.addrlen);\n\t\tserver->mountd_addrlen = data->mount_server.addrlen;\n\t}\n\tserver->mountd_version = data->mount_server.version;\n\tserver->mountd_port = data->mount_server.port;\n\tserver->mountd_protocol = data->mount_server.protocol;\n\n\tserver->namelen  = data->namlen;\n\tdprintk(\"<-- nfs_init_server() = 0 [new %p]\\n\", clp);\n\treturn 0;\n\nerror:\n\tserver->nfs_client = NULL;\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_server() = xerror %d\\n\", error);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_server",
          "args": [],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "981-1017",
          "snippet": "struct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_create_server(struct nfs_mount_info *mount_info,\n\t\t\t\t     struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\tstruct nfs_fattr *fattr;\n\tint error;\n\n\tserver = nfs_alloc_server();\n\tif (!server)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\terror = -ENOMEM;\n\tfattr = nfs_alloc_fattr();\n\tif (fattr == NULL)\n\t\tgoto error;\n\n\t/* Get a client representation */\n\terror = nfs_init_server(server, mount_info->parsed, nfs_mod);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Probe the root fh to retrieve its FSID */\n\terror = nfs_probe_fsinfo(server, mount_info->mntfh, fattr);\n\tif (error < 0)\n\t\tgoto error;\n\tif (server->nfs_client->rpc_ops->version == 3) {\n\t\tif (server->namelen == 0 || server->namelen > NFS3_MAXNAMLEN)\n\t\t\tserver->namelen = NFS3_MAXNAMLEN;\n\t\tif (!(mount_info->parsed->flags & NFS_MOUNT_NORDIRPLUS))\n\t\t\tserver->caps |= NFS_CAP_READDIRPLUS;\n\t} else {\n\t\tif (server->namelen == 0 || server->namelen > NFS2_MAXNAMLEN)\n\t\t\tserver->namelen = NFS2_MAXNAMLEN;\n\t}\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR)) {\n\t\terror = nfs_mod->rpc_ops->getattr(server, mount_info->mntfh, fattr, NULL);\n\t\tif (error < 0) {\n\t\t\tdprintk(\"nfs_create_server: getattr error = %d\\n\", -error);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tmemcpy(&server->fsid, &fattr->fsid, sizeof(server->fsid));\n\n\tdprintk(\"Server FSID: %llx:%llx\\n\",\n\t\t(unsigned long long) server->fsid.major,\n\t\t(unsigned long long) server->fsid.minor);\n\n\tnfs_server_insert_lists(server);\n\tserver->mount_time = jiffies;\n\tnfs_free_fattr(fattr);\n\treturn server;\n\nerror:\n\tnfs_free_fattr(fattr);\n\tnfs_free_server(server);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs_free_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "1023-1046",
    "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_free_server()\\n\""
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_release_automount_timer",
          "args": [],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_release_automount_timer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/namespace.c",
          "lines": "216-220",
          "snippet": "void nfs_release_automount_timer(void)\n{\n\tif (list_empty(&nfs_automount_list))\n\t\tcancel_delayed_work(&nfs_automount_task);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/vfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/gfp.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(nfs_automount_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/sunrpc/gss_api.h>\n#include <linux/vfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/nfs_fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/gfp.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(nfs_automount_list);\n\nvoid nfs_release_automount_timer(void)\n{\n\tif (list_empty(&nfs_automount_list))\n\t\tcancel_delayed_work(&nfs_automount_task);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "server"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_destroy",
          "args": [
            "&server->backing_dev_info"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_bdi_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/inode.c",
          "lines": "372-376",
          "snippet": "static void fuse_bdi_destroy(struct fuse_conn *fc)\n{\n\tif (fc->bdi_initialized)\n\t\tbdi_destroy(&fc->bdi);\n}",
          "includes": [
            "#include <linux/exportfs.h>",
            "#include <linux/sched.h>",
            "#include <linux/random.h>",
            "#include <linux/statfs.h>",
            "#include <linux/parser.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/exportfs.h>\n#include <linux/sched.h>\n#include <linux/random.h>\n#include <linux/statfs.h>\n#include <linux/parser.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic void fuse_bdi_destroy(struct fuse_conn *fc)\n{\n\tif (fc->bdi_initialized)\n\t\tbdi_destroy(&fc->bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_iostats",
          "args": [
            "server->io_stats"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_iostats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "70-74",
          "snippet": "static inline void nfs_free_iostats(struct nfs_iostats __percpu *stats)\n{\n\tif (stats != NULL)\n\t\tfree_percpu(stats);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_free_iostats(struct nfs_iostats __percpu *stats)\n{\n\tif (stats != NULL)\n\t\tfree_percpu(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ida_destroy",
          "args": [
            "&server->openowner_id"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_destroy",
          "args": [
            "&server->lockowner_id"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "server->nfs_client"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "server->client"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server->client"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "server->client_acl"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server->client_acl"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "server->destroy",
          "args": [
            "server"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_remove_lists",
          "args": [
            "server"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_remove_lists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "959-975",
          "snippet": "void nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_free_server()\\n\""
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
  },
  {
    "function_name": "nfs_alloc_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "981-1017",
    "snippet": "struct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pnfs_init_server",
          "args": [
            "server"
          ],
          "line": 1014
        },
        "resolved": true,
        "details": {
          "function_name": "pnfs_init_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "232-234",
          "snippet": "static void pnfs_init_server(struct nfs_server *server)\n{\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void pnfs_init_server(struct nfs_server *server)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "ida_init",
          "args": [
            "&server->lockowner_id"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_init",
          "args": [
            "&server->openowner_id"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "server"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_iostats",
          "args": [
            "server->io_stats"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_iostats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "70-74",
          "snippet": "static inline void nfs_free_iostats(struct nfs_iostats __percpu *stats)\n{\n\tif (stats != NULL)\n\t\tfree_percpu(stats);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline void nfs_free_iostats(struct nfs_iostats __percpu *stats)\n{\n\tif (stats != NULL)\n\t\tfree_percpu(stats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bdi_init",
          "args": [
            "&server->backing_dev_info"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "server"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_iostats",
          "args": [],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_iostats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/iostat.h",
          "lines": "65-68",
          "snippet": "static inline struct nfs_iostats __percpu *nfs_alloc_iostats(void)\n{\n\treturn alloc_percpu(struct nfs_iostats);\n}",
          "includes": [
            "#include <linux/nfs_iostat.h>",
            "#include <linux/cache.h>",
            "#include <linux/percpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_iostat.h>\n#include <linux/cache.h>\n#include <linux/percpu.h>\n\nstatic inline struct nfs_iostats __percpu *nfs_alloc_iostats(void)\n{\n\treturn alloc_percpu(struct nfs_iostats);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&server->active",
            "0"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&server->state_owners_lru"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&server->layouts"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&server->delegations"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&server->master_link"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&server->client_link"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct nfs_server)",
            "GFP_KERNEL"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_server *nfs_alloc_server(void)\n{\n\tstruct nfs_server *server;\n\n\tserver = kzalloc(sizeof(struct nfs_server), GFP_KERNEL);\n\tif (!server)\n\t\treturn NULL;\n\n\tserver->client = server->client_acl = ERR_PTR(-EINVAL);\n\n\t/* Zero out the NFS state stuff */\n\tINIT_LIST_HEAD(&server->client_link);\n\tINIT_LIST_HEAD(&server->master_link);\n\tINIT_LIST_HEAD(&server->delegations);\n\tINIT_LIST_HEAD(&server->layouts);\n\tINIT_LIST_HEAD(&server->state_owners_lru);\n\n\tatomic_set(&server->active, 0);\n\n\tserver->io_stats = nfs_alloc_iostats();\n\tif (!server->io_stats) {\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tif (bdi_init(&server->backing_dev_info)) {\n\t\tnfs_free_iostats(server->io_stats);\n\t\tkfree(server);\n\t\treturn NULL;\n\t}\n\n\tida_init(&server->openowner_id);\n\tida_init(&server->lockowner_id);\n\tpnfs_init_server(server);\n\n\treturn server;\n}"
  },
  {
    "function_name": "nfs_server_remove_lists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "959-975",
    "snippet": "void nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "synchronize_rcu",
          "args": [],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 972
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&server->master_link"
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_CS_STOP_RENEW",
            "&clp->cl_res_state"
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&clp->cl_superblocks"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&server->client_link"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_remove_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn;\n\n\tif (clp == NULL)\n\t\treturn;\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_del_rcu(&server->client_link);\n\tif (list_empty(&clp->cl_superblocks))\n\t\tset_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tlist_del(&server->master_link);\n\tspin_unlock(&nn->nfs_client_lock);\n\n\tsynchronize_rcu();\n}"
  },
  {
    "function_name": "nfs_server_insert_lists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "945-956",
    "snippet": "void nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS_CS_STOP_RENEW",
            "&clp->cl_res_state"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&server->master_link",
            "&nn->nfs_volume_list"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&server->client_link",
            "&clp->cl_superblocks"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_insert_lists(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tspin_lock(&nn->nfs_client_lock);\n\tlist_add_tail_rcu(&server->client_link, &clp->cl_superblocks);\n\tlist_add_tail(&server->master_link, &nn->nfs_volume_list);\n\tclear_bit(NFS_CS_STOP_RENEW, &clp->cl_res_state);\n\tspin_unlock(&nn->nfs_client_lock);\n\n}"
  },
  {
    "function_name": "nfs_server_copy_userdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "930-942",
    "snippet": "void nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_server_copy_userdata(struct nfs_server *target, struct nfs_server *source)\n{\n\ttarget->flags = source->flags;\n\ttarget->rsize = source->rsize;\n\ttarget->wsize = source->wsize;\n\ttarget->acregmin = source->acregmin;\n\ttarget->acregmax = source->acregmax;\n\ttarget->acdirmin = source->acdirmin;\n\ttarget->acdirmax = source->acdirmax;\n\ttarget->caps = source->caps;\n\ttarget->options = source->options;\n\ttarget->auth_info = source->auth_info;\n}"
  },
  {
    "function_name": "nfs_probe_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "885-924",
    "snippet": "int nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"nfs_probe_fsinfo: error = %d\\n\"",
            "-error"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_probe_fsinfo() = 0\\n\""
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clp->rpc_ops->pathconf",
          "args": [
            "server",
            "mntfh",
            "&pathinfo"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fattr_init",
          "args": [
            "fattr"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1286-1293",
          "snippet": "void nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nvoid nfs_fattr_init(struct nfs_fattr *fattr)\n{\n\tfattr->valid = 0;\n\tfattr->time_start = jiffies;\n\tfattr->gencount = nfs_inc_attr_generation_counter();\n\tfattr->owner_name = NULL;\n\tfattr->group_name = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_server_set_fsinfo",
          "args": [
            "server",
            "mntfh",
            "&fsinfo"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_set_fsinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "828-880",
          "snippet": "static void nfs_server_set_fsinfo(struct nfs_server *server,\n\t\t\t\t  struct nfs_fh *mntfh,\n\t\t\t\t  struct nfs_fsinfo *fsinfo)\n{\n\tunsigned long max_rpc_payload;\n\n\t/* Work out a lot of parameters */\n\tif (server->rsize == 0)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtpref, NULL);\n\tif (server->wsize == 0)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtpref, NULL);\n\n\tif (fsinfo->rtmax >= 512 && server->rsize > fsinfo->rtmax)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtmax, NULL);\n\tif (fsinfo->wtmax >= 512 && server->wsize > fsinfo->wtmax)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtmax, NULL);\n\n\tmax_rpc_payload = nfs_block_size(rpc_max_payload(server->client), NULL);\n\tif (server->rsize > max_rpc_payload)\n\t\tserver->rsize = max_rpc_payload;\n\tif (server->rsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->rsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->rpages = (server->rsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->backing_dev_info.name = \"nfs\";\n\tserver->backing_dev_info.ra_pages = server->rpages * NFS_MAX_READAHEAD;\n\n\tif (server->wsize > max_rpc_payload)\n\t\tserver->wsize = max_rpc_payload;\n\tif (server->wsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->wsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->wpages = (server->wsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->wtmult = nfs_block_bits(fsinfo->wtmult, NULL);\n\n\tserver->dtsize = nfs_block_size(fsinfo->dtpref, NULL);\n\tif (server->dtsize > PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES)\n\t\tserver->dtsize = PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES;\n\tif (server->dtsize > server->rsize)\n\t\tserver->dtsize = server->rsize;\n\n\tif (server->flags & NFS_MOUNT_NOAC) {\n\t\tserver->acregmin = server->acregmax = 0;\n\t\tserver->acdirmin = server->acdirmax = 0;\n\t}\n\n\tserver->maxfilesize = fsinfo->maxfilesize;\n\n\tserver->time_delta = fsinfo->time_delta;\n\n\t/* We're airborne Set socket buffersize */\n\trpc_setbufsize(server->client, server->wsize + 100, server->rsize + 100);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_server_set_fsinfo(struct nfs_server *server,\n\t\t\t\t  struct nfs_fh *mntfh,\n\t\t\t\t  struct nfs_fsinfo *fsinfo)\n{\n\tunsigned long max_rpc_payload;\n\n\t/* Work out a lot of parameters */\n\tif (server->rsize == 0)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtpref, NULL);\n\tif (server->wsize == 0)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtpref, NULL);\n\n\tif (fsinfo->rtmax >= 512 && server->rsize > fsinfo->rtmax)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtmax, NULL);\n\tif (fsinfo->wtmax >= 512 && server->wsize > fsinfo->wtmax)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtmax, NULL);\n\n\tmax_rpc_payload = nfs_block_size(rpc_max_payload(server->client), NULL);\n\tif (server->rsize > max_rpc_payload)\n\t\tserver->rsize = max_rpc_payload;\n\tif (server->rsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->rsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->rpages = (server->rsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->backing_dev_info.name = \"nfs\";\n\tserver->backing_dev_info.ra_pages = server->rpages * NFS_MAX_READAHEAD;\n\n\tif (server->wsize > max_rpc_payload)\n\t\tserver->wsize = max_rpc_payload;\n\tif (server->wsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->wsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->wpages = (server->wsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->wtmult = nfs_block_bits(fsinfo->wtmult, NULL);\n\n\tserver->dtsize = nfs_block_size(fsinfo->dtpref, NULL);\n\tif (server->dtsize > PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES)\n\t\tserver->dtsize = PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES;\n\tif (server->dtsize > server->rsize)\n\t\tserver->dtsize = server->rsize;\n\n\tif (server->flags & NFS_MOUNT_NOAC) {\n\t\tserver->acregmin = server->acregmax = 0;\n\t\tserver->acdirmin = server->acdirmax = 0;\n\t}\n\n\tserver->maxfilesize = fsinfo->maxfilesize;\n\n\tserver->time_delta = fsinfo->time_delta;\n\n\t/* We're airborne Set socket buffersize */\n\trpc_setbufsize(server->client, server->wsize + 100, server->rsize + 100);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clp->rpc_ops->fsinfo",
          "args": [
            "server",
            "mntfh",
            "&fsinfo"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clp->rpc_ops->set_capabilities",
          "args": [
            "server",
            "mntfh"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_probe_fsinfo()\\n\""
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_probe_fsinfo(struct nfs_server *server, struct nfs_fh *mntfh, struct nfs_fattr *fattr)\n{\n\tstruct nfs_fsinfo fsinfo;\n\tstruct nfs_client *clp = server->nfs_client;\n\tint error;\n\n\tdprintk(\"--> nfs_probe_fsinfo()\\n\");\n\n\tif (clp->rpc_ops->set_capabilities != NULL) {\n\t\terror = clp->rpc_ops->set_capabilities(server, mntfh);\n\t\tif (error < 0)\n\t\t\tgoto out_error;\n\t}\n\n\tfsinfo.fattr = fattr;\n\tfsinfo.layouttype = 0;\n\terror = clp->rpc_ops->fsinfo(server, mntfh, &fsinfo);\n\tif (error < 0)\n\t\tgoto out_error;\n\n\tnfs_server_set_fsinfo(server, mntfh, &fsinfo);\n\n\t/* Get some general file system info */\n\tif (server->namelen == 0) {\n\t\tstruct nfs_pathconf pathinfo;\n\n\t\tpathinfo.fattr = fattr;\n\t\tnfs_fattr_init(fattr);\n\n\t\tif (clp->rpc_ops->pathconf(server, mntfh, &pathinfo) >= 0)\n\t\t\tserver->namelen = pathinfo.max_namelen;\n\t}\n\n\tdprintk(\"<-- nfs_probe_fsinfo() = 0\\n\");\n\treturn 0;\n\nout_error:\n\tdprintk(\"nfs_probe_fsinfo: error = %d\\n\", -error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_server_set_fsinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "828-880",
    "snippet": "static void nfs_server_set_fsinfo(struct nfs_server *server,\n\t\t\t\t  struct nfs_fh *mntfh,\n\t\t\t\t  struct nfs_fsinfo *fsinfo)\n{\n\tunsigned long max_rpc_payload;\n\n\t/* Work out a lot of parameters */\n\tif (server->rsize == 0)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtpref, NULL);\n\tif (server->wsize == 0)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtpref, NULL);\n\n\tif (fsinfo->rtmax >= 512 && server->rsize > fsinfo->rtmax)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtmax, NULL);\n\tif (fsinfo->wtmax >= 512 && server->wsize > fsinfo->wtmax)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtmax, NULL);\n\n\tmax_rpc_payload = nfs_block_size(rpc_max_payload(server->client), NULL);\n\tif (server->rsize > max_rpc_payload)\n\t\tserver->rsize = max_rpc_payload;\n\tif (server->rsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->rsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->rpages = (server->rsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->backing_dev_info.name = \"nfs\";\n\tserver->backing_dev_info.ra_pages = server->rpages * NFS_MAX_READAHEAD;\n\n\tif (server->wsize > max_rpc_payload)\n\t\tserver->wsize = max_rpc_payload;\n\tif (server->wsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->wsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->wpages = (server->wsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->wtmult = nfs_block_bits(fsinfo->wtmult, NULL);\n\n\tserver->dtsize = nfs_block_size(fsinfo->dtpref, NULL);\n\tif (server->dtsize > PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES)\n\t\tserver->dtsize = PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES;\n\tif (server->dtsize > server->rsize)\n\t\tserver->dtsize = server->rsize;\n\n\tif (server->flags & NFS_MOUNT_NOAC) {\n\t\tserver->acregmin = server->acregmax = 0;\n\t\tserver->acdirmin = server->acdirmax = 0;\n\t}\n\n\tserver->maxfilesize = fsinfo->maxfilesize;\n\n\tserver->time_delta = fsinfo->time_delta;\n\n\t/* We're airborne Set socket buffersize */\n\trpc_setbufsize(server->client, server->wsize + 100, server->rsize + 100);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_setbufsize",
          "args": [
            "server->client",
            "server->wsize + 100",
            "server->rsize + 100"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_block_size",
          "args": [
            "fsinfo->dtpref",
            "NULL"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "579-588",
          "snippet": "static inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_block_bits",
          "args": [
            "fsinfo->wtmult",
            "NULL"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "550-565",
          "snippet": "static inline\nunsigned long nfs_block_bits(unsigned long bsize, unsigned char *nrbitsp)\n{\n\t/* make sure blocksize is a power of two */\n\tif ((bsize & (bsize - 1)) || nrbitsp) {\n\t\tunsigned char\tnrbits;\n\n\t\tfor (nrbits = 31; nrbits && !(bsize & (1 << nrbits)); nrbits--)\n\t\t\t;\n\t\tbsize = 1 << nrbits;\n\t\tif (nrbitsp)\n\t\t\t*nrbitsp = nrbits;\n\t}\n\n\treturn bsize;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_bits(unsigned long bsize, unsigned char *nrbitsp)\n{\n\t/* make sure blocksize is a power of two */\n\tif ((bsize & (bsize - 1)) || nrbitsp) {\n\t\tunsigned char\tnrbits;\n\n\t\tfor (nrbits = 31; nrbits && !(bsize & (1 << nrbits)); nrbits--)\n\t\t\t;\n\t\tbsize = 1 << nrbits;\n\t\tif (nrbitsp)\n\t\t\t*nrbitsp = nrbits;\n\t}\n\n\treturn bsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_max_payload",
          "args": [
            "server->client"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_server_set_fsinfo(struct nfs_server *server,\n\t\t\t\t  struct nfs_fh *mntfh,\n\t\t\t\t  struct nfs_fsinfo *fsinfo)\n{\n\tunsigned long max_rpc_payload;\n\n\t/* Work out a lot of parameters */\n\tif (server->rsize == 0)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtpref, NULL);\n\tif (server->wsize == 0)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtpref, NULL);\n\n\tif (fsinfo->rtmax >= 512 && server->rsize > fsinfo->rtmax)\n\t\tserver->rsize = nfs_block_size(fsinfo->rtmax, NULL);\n\tif (fsinfo->wtmax >= 512 && server->wsize > fsinfo->wtmax)\n\t\tserver->wsize = nfs_block_size(fsinfo->wtmax, NULL);\n\n\tmax_rpc_payload = nfs_block_size(rpc_max_payload(server->client), NULL);\n\tif (server->rsize > max_rpc_payload)\n\t\tserver->rsize = max_rpc_payload;\n\tif (server->rsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->rsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->rpages = (server->rsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->backing_dev_info.name = \"nfs\";\n\tserver->backing_dev_info.ra_pages = server->rpages * NFS_MAX_READAHEAD;\n\n\tif (server->wsize > max_rpc_payload)\n\t\tserver->wsize = max_rpc_payload;\n\tif (server->wsize > NFS_MAX_FILE_IO_SIZE)\n\t\tserver->wsize = NFS_MAX_FILE_IO_SIZE;\n\tserver->wpages = (server->wsize + PAGE_CACHE_SIZE - 1) >> PAGE_CACHE_SHIFT;\n\n\tserver->wtmult = nfs_block_bits(fsinfo->wtmult, NULL);\n\n\tserver->dtsize = nfs_block_size(fsinfo->dtpref, NULL);\n\tif (server->dtsize > PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES)\n\t\tserver->dtsize = PAGE_CACHE_SIZE * NFS_MAX_READDIR_PAGES;\n\tif (server->dtsize > server->rsize)\n\t\tserver->dtsize = server->rsize;\n\n\tif (server->flags & NFS_MOUNT_NOAC) {\n\t\tserver->acregmin = server->acregmax = 0;\n\t\tserver->acdirmin = server->acdirmax = 0;\n\t}\n\n\tserver->maxfilesize = fsinfo->maxfilesize;\n\n\tserver->time_delta = fsinfo->time_delta;\n\n\t/* We're airborne Set socket buffersize */\n\trpc_setbufsize(server->client, server->wsize + 100, server->rsize + 100);\n}"
  },
  {
    "function_name": "nfs_init_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "742-823",
    "snippet": "static int nfs_init_server(struct nfs_server *server,\n\t\t\t   const struct nfs_parsed_mount_data *data,\n\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = data->nfs_server.hostname,\n\t\t.addr = (const struct sockaddr *)&data->nfs_server.address,\n\t\t.addrlen = data->nfs_server.addrlen,\n\t\t.nfs_mod = nfs_mod,\n\t\t.proto = data->nfs_server.protocol,\n\t\t.net = data->net,\n\t};\n\tstruct rpc_timeout timeparms;\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\tif (data->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, &timeparms, NULL, RPC_AUTH_UNIX);\n\tif (IS_ERR(clp)) {\n\t\tdprintk(\"<-- nfs_init_server() = error %ld\\n\", PTR_ERR(clp));\n\t\treturn PTR_ERR(clp);\n\t}\n\n\tserver->nfs_client = clp;\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->caps |= NFS_CAP_HARDLINKS|NFS_CAP_SYMLINKS|NFS_CAP_FILEID|\n\t\tNFS_CAP_MODE|NFS_CAP_NLINK|NFS_CAP_OWNER|NFS_CAP_OWNER_GROUP|\n\t\tNFS_CAP_ATIME|NFS_CAP_CTIME|NFS_CAP_MTIME|NFS_CAP_CHANGE_ATTR;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\t/* Start lockd here, before we might error out */\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto error;\n\n\tserver->port = data->nfs_server.port;\n\tserver->auth_info = data->auth_info;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Preserve the values of mount_server-related mount options */\n\tif (data->mount_server.addrlen) {\n\t\tmemcpy(&server->mountd_address, &data->mount_server.address,\n\t\t\tdata->mount_server.addrlen);\n\t\tserver->mountd_addrlen = data->mount_server.addrlen;\n\t}\n\tserver->mountd_version = data->mount_server.version;\n\tserver->mountd_port = data->mount_server.port;\n\tserver->mountd_protocol = data->mount_server.protocol;\n\n\tserver->namelen  = data->namlen;\n\tdprintk(\"<-- nfs_init_server() = 0 [new %p]\\n\", clp);\n\treturn 0;\n\nerror:\n\tserver->nfs_client = NULL;\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_server() = xerror %d\\n\", error);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_init_server() = xerror %d\\n\"",
            "error"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "clp"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_init_server() = 0 [new %p]\\n\"",
            "clp"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&server->mountd_address",
            "&data->mount_server.address",
            "data->mount_server.addrlen"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_init_server_rpcclient",
          "args": [
            "server",
            "&timeparms",
            "data->selected_flavor"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_server_rpcclient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "675-697",
          "snippet": "int nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_start_lockd",
          "args": [
            "server"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_lockd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "635-670",
          "snippet": "static int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nstatic int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_block_size",
          "args": [
            "data->wsize",
            "NULL"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "579-588",
          "snippet": "static inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clp"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_init_server() = error %ld\\n\"",
            "PTR_ERR(clp)"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clp"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clp"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_client",
          "args": [
            "&cl_init",
            "&timeparms",
            "NULL",
            "RPC_AUTH_UNIX"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "478-523",
          "snippet": "struct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_CS_NORESVPORT",
            "&cl_init.init_flags"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_init_timeout_values",
          "args": [
            "&timeparms",
            "data->nfs_server.protocol",
            "data->timeo",
            "data->retrans"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_init_timeout_values",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "540-576",
          "snippet": "void nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_init_server()\\n\""
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_init_server(struct nfs_server *server,\n\t\t\t   const struct nfs_parsed_mount_data *data,\n\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_client_initdata cl_init = {\n\t\t.hostname = data->nfs_server.hostname,\n\t\t.addr = (const struct sockaddr *)&data->nfs_server.address,\n\t\t.addrlen = data->nfs_server.addrlen,\n\t\t.nfs_mod = nfs_mod,\n\t\t.proto = data->nfs_server.protocol,\n\t\t.net = data->net,\n\t};\n\tstruct rpc_timeout timeparms;\n\tstruct nfs_client *clp;\n\tint error;\n\n\tdprintk(\"--> nfs_init_server()\\n\");\n\n\tnfs_init_timeout_values(&timeparms, data->nfs_server.protocol,\n\t\t\tdata->timeo, data->retrans);\n\tif (data->flags & NFS_MOUNT_NORESVPORT)\n\t\tset_bit(NFS_CS_NORESVPORT, &cl_init.init_flags);\n\n\t/* Allocate or find a client reference we can use */\n\tclp = nfs_get_client(&cl_init, &timeparms, NULL, RPC_AUTH_UNIX);\n\tif (IS_ERR(clp)) {\n\t\tdprintk(\"<-- nfs_init_server() = error %ld\\n\", PTR_ERR(clp));\n\t\treturn PTR_ERR(clp);\n\t}\n\n\tserver->nfs_client = clp;\n\n\t/* Initialise the client representation from the mount data */\n\tserver->flags = data->flags;\n\tserver->options = data->options;\n\tserver->caps |= NFS_CAP_HARDLINKS|NFS_CAP_SYMLINKS|NFS_CAP_FILEID|\n\t\tNFS_CAP_MODE|NFS_CAP_NLINK|NFS_CAP_OWNER|NFS_CAP_OWNER_GROUP|\n\t\tNFS_CAP_ATIME|NFS_CAP_CTIME|NFS_CAP_MTIME|NFS_CAP_CHANGE_ATTR;\n\n\tif (data->rsize)\n\t\tserver->rsize = nfs_block_size(data->rsize, NULL);\n\tif (data->wsize)\n\t\tserver->wsize = nfs_block_size(data->wsize, NULL);\n\n\tserver->acregmin = data->acregmin * HZ;\n\tserver->acregmax = data->acregmax * HZ;\n\tserver->acdirmin = data->acdirmin * HZ;\n\tserver->acdirmax = data->acdirmax * HZ;\n\n\t/* Start lockd here, before we might error out */\n\terror = nfs_start_lockd(server);\n\tif (error < 0)\n\t\tgoto error;\n\n\tserver->port = data->nfs_server.port;\n\tserver->auth_info = data->auth_info;\n\n\terror = nfs_init_server_rpcclient(server, &timeparms,\n\t\t\t\t\t  data->selected_flavor);\n\tif (error < 0)\n\t\tgoto error;\n\n\t/* Preserve the values of mount_server-related mount options */\n\tif (data->mount_server.addrlen) {\n\t\tmemcpy(&server->mountd_address, &data->mount_server.address,\n\t\t\tdata->mount_server.addrlen);\n\t\tserver->mountd_addrlen = data->mount_server.addrlen;\n\t}\n\tserver->mountd_version = data->mount_server.version;\n\tserver->mountd_port = data->mount_server.port;\n\tserver->mountd_protocol = data->mount_server.protocol;\n\n\tserver->namelen  = data->namlen;\n\tdprintk(\"<-- nfs_init_server() = 0 [new %p]\\n\", clp);\n\treturn 0;\n\nerror:\n\tserver->nfs_client = NULL;\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_server() = xerror %d\\n\", error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_init_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "709-736",
    "snippet": "struct nfs_client *nfs_init_client(struct nfs_client *clp,\n\t\t    const struct rpc_timeout *timeparms,\n\t\t    const char *ip_addr)\n{\n\tint error;\n\n\tif (clp->cl_cons_state == NFS_CS_READY) {\n\t\t/* the client is already initialised */\n\t\tdprintk(\"<-- nfs_init_client() = 0 [already %p]\\n\", clp);\n\t\treturn clp;\n\t}\n\n\t/*\n\t * Create a client RPC handle for doing FSSTAT with UNIX auth only\n\t * - RFC 2623, sec 2.3.2\n\t */\n\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_UNIX);\n\tif (error < 0)\n\t\tgoto error;\n\tnfs_mark_client_ready(clp, NFS_CS_READY);\n\treturn clp;\n\nerror:\n\tnfs_mark_client_ready(clp, error);\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_client() = xerror %d\\n\", error);\n\treturn ERR_PTR(error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_init_client() = xerror %d\\n\"",
            "error"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "clp"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mark_client_ready",
          "args": [
            "clp",
            "error"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_client_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "529-534",
          "snippet": "void nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nvoid nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_create_rpc_client",
          "args": [
            "clp",
            "timeparms",
            "RPC_AUTH_UNIX"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_create_rpc_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "582-620",
          "snippet": "int nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nconst struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};\n\nint nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_init_client() = 0 [already %p]\\n\"",
            "clp"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs_init_client(struct nfs_client *clp,\n\t\t    const struct rpc_timeout *timeparms,\n\t\t    const char *ip_addr)\n{\n\tint error;\n\n\tif (clp->cl_cons_state == NFS_CS_READY) {\n\t\t/* the client is already initialised */\n\t\tdprintk(\"<-- nfs_init_client() = 0 [already %p]\\n\", clp);\n\t\treturn clp;\n\t}\n\n\t/*\n\t * Create a client RPC handle for doing FSSTAT with UNIX auth only\n\t * - RFC 2623, sec 2.3.2\n\t */\n\terror = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_UNIX);\n\tif (error < 0)\n\t\tgoto error;\n\tnfs_mark_client_ready(clp, NFS_CS_READY);\n\treturn clp;\n\nerror:\n\tnfs_mark_client_ready(clp, error);\n\tnfs_put_client(clp);\n\tdprintk(\"<-- nfs_init_client() = xerror %d\\n\", error);\n\treturn ERR_PTR(error);\n}"
  },
  {
    "function_name": "nfs_init_server_rpcclient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "675-697",
    "snippet": "int nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&server->client->cl_timeout_default",
            "timeo",
            "sizeof(server->client->cl_timeout_default)"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "server->client"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: couldn't create rpc_client!\\n\"",
            "__func__"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server->client"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_clone_client_set_auth",
          "args": [
            "clp->cl_rpcclient",
            "pseudoflavour"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_init_server_rpcclient(struct nfs_server *server,\n\t\tconst struct rpc_timeout *timeo,\n\t\trpc_authflavor_t pseudoflavour)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tserver->client = rpc_clone_client_set_auth(clp->cl_rpcclient,\n\t\t\t\t\t\t\tpseudoflavour);\n\tif (IS_ERR(server->client)) {\n\t\tdprintk(\"%s: couldn't create rpc_client!\\n\", __func__);\n\t\treturn PTR_ERR(server->client);\n\t}\n\n\tmemcpy(&server->client->cl_timeout_default,\n\t\t\ttimeo,\n\t\t\tsizeof(server->client->cl_timeout_default));\n\tserver->client->cl_timeout = &server->client->cl_timeout_default;\n\tserver->client->cl_softrtry = 0;\n\tif (server->flags & NFS_MOUNT_SOFT)\n\t\tserver->client->cl_softrtry = 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_start_lockd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "635-670",
    "snippet": "static int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "host"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "host"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmclnt_init",
          "args": [
            "&nlm_init"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "nlmclnt_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clntlock.c",
          "lines": "53-78",
          "snippet": "struct nlm_host *nlmclnt_init(const struct nlmclnt_initdata *nlm_init)\n{\n\tstruct nlm_host *host;\n\tu32 nlm_version = (nlm_init->nfs_version == 2) ? 1 : 4;\n\tint status;\n\n\tstatus = lockd_up(nlm_init->net);\n\tif (status < 0)\n\t\treturn ERR_PTR(status);\n\n\thost = nlmclnt_lookup_host(nlm_init->address, nlm_init->addrlen,\n\t\t\t\t   nlm_init->protocol, nlm_version,\n\t\t\t\t   nlm_init->hostname, nlm_init->noresvport,\n\t\t\t\t   nlm_init->net);\n\tif (host == NULL)\n\t\tgoto out_nohost;\n\tif (host->h_rpcclnt == NULL && nlm_bind_host(host) == NULL)\n\t\tgoto out_nobind;\n\n\treturn host;\nout_nobind:\n\tnlmclnt_release_host(host);\nout_nohost:\n\tlockd_down(nlm_init->net);\n\treturn ERR_PTR(-ENOLCK);\n}",
          "includes": [
            "#include <linux/kthread.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kthread.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstruct nlm_host *nlmclnt_init(const struct nlmclnt_initdata *nlm_init)\n{\n\tstruct nlm_host *host;\n\tu32 nlm_version = (nlm_init->nfs_version == 2) ? 1 : 4;\n\tint status;\n\n\tstatus = lockd_up(nlm_init->net);\n\tif (status < 0)\n\t\treturn ERR_PTR(status);\n\n\thost = nlmclnt_lookup_host(nlm_init->address, nlm_init->addrlen,\n\t\t\t\t   nlm_init->protocol, nlm_version,\n\t\t\t\t   nlm_init->hostname, nlm_init->noresvport,\n\t\t\t\t   nlm_init->net);\n\tif (host == NULL)\n\t\tgoto out_nohost;\n\tif (host->h_rpcclnt == NULL && nlm_bind_host(host) == NULL)\n\t\tgoto out_nobind;\n\n\treturn host;\nout_nobind:\n\tnlmclnt_release_host(host);\nout_nohost:\n\tlockd_down(nlm_init->net);\n\treturn ERR_PTR(-ENOLCK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nstatic int nfs_start_lockd(struct nfs_server *server)\n{\n\tstruct nlm_host *host;\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nlmclnt_initdata nlm_init = {\n\t\t.hostname\t= clp->cl_hostname,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrlen\t= clp->cl_addrlen,\n\t\t.nfs_version\t= clp->rpc_ops->version,\n\t\t.noresvport\t= server->flags & NFS_MOUNT_NORESVPORT ?\n\t\t\t\t\t1 : 0,\n\t\t.net\t\t= clp->cl_net,\n\t};\n\n\tif (nlm_init.nfs_version > 3)\n\t\treturn 0;\n\tif ((server->flags & NFS_MOUNT_LOCAL_FLOCK) &&\n\t\t\t(server->flags & NFS_MOUNT_LOCAL_FCNTL))\n\t\treturn 0;\n\n\tswitch (clp->cl_proto) {\n\t\tdefault:\n\t\t\tnlm_init.protocol = IPPROTO_TCP;\n\t\t\tbreak;\n\t\tcase XPRT_TRANSPORT_UDP:\n\t\t\tnlm_init.protocol = IPPROTO_UDP;\n\t}\n\n\thost = nlmclnt_init(&nlm_init);\n\tif (IS_ERR(host))\n\t\treturn PTR_ERR(host);\n\n\tserver->nlm_host = host;\n\tserver->destroy = nfs_destroy_server;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_destroy_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "626-630",
    "snippet": "static void nfs_destroy_server(struct nfs_server *server)\n{\n\tif (server->nlm_host)\n\t\tnlmclnt_done(server->nlm_host);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmclnt_done",
          "args": [
            "server->nlm_host"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "nlmclnt_done",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clntlock.c",
          "lines": "86-92",
          "snippet": "void nlmclnt_done(struct nlm_host *host)\n{\n\tstruct net *net = host->net;\n\n\tnlmclnt_release_host(host);\n\tlockd_down(net);\n}",
          "includes": [
            "#include <linux/kthread.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kthread.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/nfs_fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid nlmclnt_done(struct nlm_host *host)\n{\n\tstruct net *net = host->net;\n\n\tnlmclnt_release_host(host);\n\tlockd_down(net);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_destroy_server(struct nfs_server *server)\n{\n\tif (server->nlm_host)\n\t\tnlmclnt_done(server->nlm_host);\n}"
  },
  {
    "function_name": "nfs_create_rpc_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "582-620",
    "snippet": "int nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "const struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clnt"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: cannot create RPC client. Error = %ld\\n\"",
            "__func__",
            "PTR_ERR(clnt)"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "clnt"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clnt"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_create",
          "args": [
            "&args"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clp->cl_rpcclient"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_CS_INFINITE_SLOTS",
            "&clp->cl_flags"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nconst struct rpc_program nfs_program = {\n\t.name\t\t\t= \"nfs\",\n\t.number\t\t\t= NFS_PROGRAM,\n\t.nrvers\t\t\t= ARRAY_SIZE(nfs_version),\n\t.version\t\t= nfs_version,\n\t.stats\t\t\t= &nfs_rpcstat,\n\t.pipe_dir_name\t\t= NFS_PIPE_DIRNAME,\n};\n\nint nfs_create_rpc_client(struct nfs_client *clp,\n\t\t\t  const struct rpc_timeout *timeparms,\n\t\t\t  rpc_authflavor_t flavor)\n{\n\tstruct rpc_clnt\t\t*clnt = NULL;\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= clp->cl_net,\n\t\t.protocol\t= clp->cl_proto,\n\t\t.address\t= (struct sockaddr *)&clp->cl_addr,\n\t\t.addrsize\t= clp->cl_addrlen,\n\t\t.timeout\t= timeparms,\n\t\t.servername\t= clp->cl_hostname,\n\t\t.program\t= &nfs_program,\n\t\t.version\t= clp->rpc_ops->version,\n\t\t.authflavor\t= flavor,\n\t};\n\n\tif (test_bit(NFS_CS_DISCRTRY, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_DISCRTRY;\n\tif (test_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NO_RETRANS_TIMEOUT;\n\tif (test_bit(NFS_CS_NORESVPORT, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\tif (test_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags))\n\t\targs.flags |= RPC_CLNT_CREATE_INFINITE_SLOTS;\n\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\treturn 0;\n\n\tclnt = rpc_create(&args);\n\tif (IS_ERR(clnt)) {\n\t\tdprintk(\"%s: cannot create RPC client. Error = %ld\\n\",\n\t\t\t\t__func__, PTR_ERR(clnt));\n\t\treturn PTR_ERR(clnt);\n\t}\n\n\tclp->cl_rpcclient = clnt;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_init_timeout_values",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "540-576",
    "snippet": "void nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_init_timeout_values(struct rpc_timeout *to, int proto,\n\t\t\t\t    unsigned int timeo, unsigned int retrans)\n{\n\tto->to_initval = timeo * HZ / 10;\n\tto->to_retries = retrans;\n\n\tswitch (proto) {\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_TCP_RETRANS;\n\t\tif (to->to_initval == 0)\n\t\t\tto->to_initval = NFS_DEF_TCP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_TCP_TIMEOUT;\n\t\tto->to_increment = to->to_initval;\n\t\tto->to_maxval = to->to_initval + (to->to_increment * to->to_retries);\n\t\tif (to->to_maxval > NFS_MAX_TCP_TIMEOUT)\n\t\t\tto->to_maxval = NFS_MAX_TCP_TIMEOUT;\n\t\tif (to->to_maxval < to->to_initval)\n\t\t\tto->to_maxval = to->to_initval;\n\t\tto->to_exponential = 0;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_UDP:\n\t\tif (to->to_retries == 0)\n\t\t\tto->to_retries = NFS_DEF_UDP_RETRANS;\n\t\tif (!to->to_initval)\n\t\t\tto->to_initval = NFS_DEF_UDP_TIMEO * HZ / 10;\n\t\tif (to->to_initval > NFS_MAX_UDP_TIMEOUT)\n\t\t\tto->to_initval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_maxval = NFS_MAX_UDP_TIMEOUT;\n\t\tto->to_exponential = 1;\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "nfs_mark_client_ready",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "529-534",
    "snippet": "void nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_all",
          "args": [
            "&nfs_client_active_wq"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nvoid nfs_mark_client_ready(struct nfs_client *clp, int state)\n{\n\tsmp_wmb();\n\tclp->cl_cons_state = state;\n\twake_up_all(&nfs_client_active_wq);\n}"
  },
  {
    "function_name": "nfs_get_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "478-523",
    "snippet": "struct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_get_client() Failed to find %s (%ld)\\n\"",
            "cl_init->hostname",
            "PTR_ERR(new)"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "new"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "new"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_ops->alloc_client",
          "args": [
            "cl_init"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4state.c",
          "lines": "1515-1554",
          "snippet": "static struct nfs4_client *alloc_client(struct xdr_netobj name)\n{\n\tstruct nfs4_client *clp;\n\tint i;\n\n\tclp = kzalloc(sizeof(struct nfs4_client), GFP_KERNEL);\n\tif (clp == NULL)\n\t\treturn NULL;\n\tclp->cl_name.data = kmemdup(name.data, name.len, GFP_KERNEL);\n\tif (clp->cl_name.data == NULL)\n\t\tgoto err_no_name;\n\tclp->cl_ownerstr_hashtbl = kmalloc(sizeof(struct list_head) *\n\t\t\tOWNER_HASH_SIZE, GFP_KERNEL);\n\tif (!clp->cl_ownerstr_hashtbl)\n\t\tgoto err_no_hashtbl;\n\tfor (i = 0; i < OWNER_HASH_SIZE; i++)\n\t\tINIT_LIST_HEAD(&clp->cl_ownerstr_hashtbl[i]);\n\tclp->cl_name.len = name.len;\n\tINIT_LIST_HEAD(&clp->cl_sessions);\n\tidr_init(&clp->cl_stateids);\n\tatomic_set(&clp->cl_refcount, 0);\n\tclp->cl_cb_state = NFSD4_CB_UNKNOWN;\n\tINIT_LIST_HEAD(&clp->cl_idhash);\n\tINIT_LIST_HEAD(&clp->cl_openowners);\n\tINIT_LIST_HEAD(&clp->cl_delegations);\n\tINIT_LIST_HEAD(&clp->cl_lru);\n\tINIT_LIST_HEAD(&clp->cl_callbacks);\n\tINIT_LIST_HEAD(&clp->cl_revoked);\n#ifdef CONFIG_NFSD_PNFS\n\tINIT_LIST_HEAD(&clp->cl_lo_states);\n#endif\n\tspin_lock_init(&clp->cl_lock);\n\trpc_init_wait_queue(&clp->cl_cb_waitq, \"Backchannel slot table\");\n\treturn clp;\nerr_no_hashtbl:\n\tkfree(clp->cl_name.data);\nerr_no_name:\n\tkfree(clp);\n\treturn NULL;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"netns.h\"",
            "#include \"current_stateid.h\"",
            "#include \"vfs.h\"",
            "#include \"xdr4cb.h\"",
            "#include \"xdr4.h\"",
            "#include <linux/jhash.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/svcauth_gss.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swap.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [
            "#define OWNER_HASH_SIZE             (1 << OWNER_HASH_BITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"netns.h\"\n#include \"current_stateid.h\"\n#include \"vfs.h\"\n#include \"xdr4cb.h\"\n#include \"xdr4.h\"\n#include <linux/jhash.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/svcauth_gss.h>\n#include <linux/ratelimit.h>\n#include <linux/pagemap.h>\n#include <linux/swap.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n\n#define OWNER_HASH_SIZE             (1 << OWNER_HASH_BITS)\n\nstatic struct nfs4_client *alloc_client(struct xdr_netobj name)\n{\n\tstruct nfs4_client *clp;\n\tint i;\n\n\tclp = kzalloc(sizeof(struct nfs4_client), GFP_KERNEL);\n\tif (clp == NULL)\n\t\treturn NULL;\n\tclp->cl_name.data = kmemdup(name.data, name.len, GFP_KERNEL);\n\tif (clp->cl_name.data == NULL)\n\t\tgoto err_no_name;\n\tclp->cl_ownerstr_hashtbl = kmalloc(sizeof(struct list_head) *\n\t\t\tOWNER_HASH_SIZE, GFP_KERNEL);\n\tif (!clp->cl_ownerstr_hashtbl)\n\t\tgoto err_no_hashtbl;\n\tfor (i = 0; i < OWNER_HASH_SIZE; i++)\n\t\tINIT_LIST_HEAD(&clp->cl_ownerstr_hashtbl[i]);\n\tclp->cl_name.len = name.len;\n\tINIT_LIST_HEAD(&clp->cl_sessions);\n\tidr_init(&clp->cl_stateids);\n\tatomic_set(&clp->cl_refcount, 0);\n\tclp->cl_cb_state = NFSD4_CB_UNKNOWN;\n\tINIT_LIST_HEAD(&clp->cl_idhash);\n\tINIT_LIST_HEAD(&clp->cl_openowners);\n\tINIT_LIST_HEAD(&clp->cl_delegations);\n\tINIT_LIST_HEAD(&clp->cl_lru);\n\tINIT_LIST_HEAD(&clp->cl_callbacks);\n\tINIT_LIST_HEAD(&clp->cl_revoked);\n#ifdef CONFIG_NFSD_PNFS\n\tINIT_LIST_HEAD(&clp->cl_lo_states);\n#endif\n\tspin_lock_init(&clp->cl_lock);\n\trpc_init_wait_queue(&clp->cl_cb_waitq, \"Backchannel slot table\");\n\treturn clp;\nerr_no_hashtbl:\n\tkfree(clp->cl_name.data);\nerr_no_name:\n\tkfree(clp);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_ops->init_client",
          "args": [
            "new",
            "timeparms",
            "ip_addr"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&new->cl_share_link",
            "&nn->nfs_client_list"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_found_client",
          "args": [
            "cl_init",
            "clp"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_found_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "449-472",
          "snippet": "static struct nfs_client *\nnfs_found_client(const struct nfs_client_initdata *cl_init,\n\t\t struct nfs_client *clp)\n{\n\tint error;\n\n\terror = nfs_wait_client_init_complete(clp);\n\tif (error < 0) {\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(-ERESTARTSYS);\n\t}\n\n\tif (clp->cl_cons_state < NFS_CS_READY) {\n\t\terror = clp->cl_cons_state;\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(error);\n\t}\n\n\tsmp_rmb();\n\n\tdprintk(\"<-- %s found nfs_client %p for %s\\n\",\n\t\t__func__, clp, cl_init->hostname ?: \"\");\n\treturn clp;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_client *\nnfs_found_client(const struct nfs_client_initdata *cl_init,\n\t\t struct nfs_client *clp)\n{\n\tint error;\n\n\terror = nfs_wait_client_init_complete(clp);\n\tif (error < 0) {\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(-ERESTARTSYS);\n\t}\n\n\tif (clp->cl_cons_state < NFS_CS_READY) {\n\t\terror = clp->cl_cons_state;\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(error);\n\t}\n\n\tsmp_rmb();\n\n\tdprintk(\"<-- %s found nfs_client %p for %s\\n\",\n\t\t__func__, clp, cl_init->hostname ?: \"\");\n\treturn clp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "new->rpc_ops->free_client",
          "args": [
            "new"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "free_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4state.c",
          "lines": "1556-1573",
          "snippet": "static void\nfree_client(struct nfs4_client *clp)\n{\n\twhile (!list_empty(&clp->cl_sessions)) {\n\t\tstruct nfsd4_session *ses;\n\t\tses = list_entry(clp->cl_sessions.next, struct nfsd4_session,\n\t\t\t\tse_perclnt);\n\t\tlist_del(&ses->se_perclnt);\n\t\tWARN_ON_ONCE(atomic_read(&ses->se_ref));\n\t\tfree_session(ses);\n\t}\n\trpc_destroy_wait_queue(&clp->cl_cb_waitq);\n\tfree_svc_cred(&clp->cl_cred);\n\tkfree(clp->cl_ownerstr_hashtbl);\n\tkfree(clp->cl_name.data);\n\tidr_destroy(&clp->cl_stateids);\n\tkfree(clp);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"netns.h\"",
            "#include \"current_stateid.h\"",
            "#include \"vfs.h\"",
            "#include \"xdr4cb.h\"",
            "#include \"xdr4.h\"",
            "#include <linux/jhash.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/svcauth_gss.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swap.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_session(struct nfsd4_session *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"netns.h\"\n#include \"current_stateid.h\"\n#include \"vfs.h\"\n#include \"xdr4cb.h\"\n#include \"xdr4.h\"\n#include <linux/jhash.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/svcauth_gss.h>\n#include <linux/ratelimit.h>\n#include <linux/pagemap.h>\n#include <linux/swap.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n\nstatic void free_session(struct nfsd4_session *);\n\nstatic void\nfree_client(struct nfs4_client *clp)\n{\n\twhile (!list_empty(&clp->cl_sessions)) {\n\t\tstruct nfsd4_session *ses;\n\t\tses = list_entry(clp->cl_sessions.next, struct nfsd4_session,\n\t\t\t\tse_perclnt);\n\t\tlist_del(&ses->se_perclnt);\n\t\tWARN_ON_ONCE(atomic_read(&ses->se_ref));\n\t\tfree_session(ses);\n\t}\n\trpc_destroy_wait_queue(&clp->cl_cb_waitq);\n\tfree_svc_cred(&clp->cl_cred);\n\tkfree(clp->cl_ownerstr_hashtbl);\n\tkfree(clp->cl_name.data);\n\tidr_destroy(&clp->cl_stateids);\n\tkfree(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_match_client",
          "args": [
            "cl_init"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_match_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "403-432",
          "snippet": "static struct nfs_client *nfs_match_client(const struct nfs_client_initdata *data)\n{\n\tstruct nfs_client *clp;\n\tconst struct sockaddr *sap = data->addr;\n\tstruct nfs_net *nn = net_generic(data->net, nfs_net_id);\n\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t        const struct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\t\t/* Don't match clients that failed to initialise properly */\n\t\tif (clp->cl_cons_state < 0)\n\t\t\tcontinue;\n\n\t\t/* Different NFS versions cannot share the same nfs_client */\n\t\tif (clp->rpc_ops != data->nfs_mod->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (clp->cl_proto != data->proto)\n\t\t\tcontinue;\n\t\t/* Match nfsv4 minorversion */\n\t\tif (clp->cl_minorversion != data->minorversion)\n\t\t\tcontinue;\n\t\t/* Match the full socket address */\n\t\tif (!nfs_sockaddr_cmp(sap, clap))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\treturn clp;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_client *nfs_match_client(const struct nfs_client_initdata *data)\n{\n\tstruct nfs_client *clp;\n\tconst struct sockaddr *sap = data->addr;\n\tstruct nfs_net *nn = net_generic(data->net, nfs_net_id);\n\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t        const struct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\t\t/* Don't match clients that failed to initialise properly */\n\t\tif (clp->cl_cons_state < 0)\n\t\t\tcontinue;\n\n\t\t/* Different NFS versions cannot share the same nfs_client */\n\t\tif (clp->rpc_ops != data->nfs_mod->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (clp->cl_proto != data->proto)\n\t\t\tcontinue;\n\t\t/* Match nfsv4 minorversion */\n\t\tif (clp->cl_minorversion != data->minorversion)\n\t\t\tcontinue;\n\t\t/* Match the full socket address */\n\t\tif (!nfs_sockaddr_cmp(sap, clap))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\treturn clp;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_get_client(%s,v%u)\\n\"",
            "cl_init->hostname",
            "rpc_ops->version"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "cl_init->net",
            "nfs_net_id"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *\nnfs_get_client(const struct nfs_client_initdata *cl_init,\n\t       const struct rpc_timeout *timeparms,\n\t       const char *ip_addr,\n\t       rpc_authflavor_t authflavour)\n{\n\tstruct nfs_client *clp, *new = NULL;\n\tstruct nfs_net *nn = net_generic(cl_init->net, nfs_net_id);\n\tconst struct nfs_rpc_ops *rpc_ops = cl_init->nfs_mod->rpc_ops;\n\n\tif (cl_init->hostname == NULL) {\n\t\tWARN_ON(1);\n\t\treturn NULL;\n\t}\n\n\tdprintk(\"--> nfs_get_client(%s,v%u)\\n\",\n\t\tcl_init->hostname, rpc_ops->version);\n\n\t/* see if the client already exists */\n\tdo {\n\t\tspin_lock(&nn->nfs_client_lock);\n\n\t\tclp = nfs_match_client(cl_init);\n\t\tif (clp) {\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tif (new)\n\t\t\t\tnew->rpc_ops->free_client(new);\n\t\t\treturn nfs_found_client(cl_init, clp);\n\t\t}\n\t\tif (new) {\n\t\t\tlist_add_tail(&new->cl_share_link,\n\t\t\t\t\t&nn->nfs_client_list);\n\t\t\tspin_unlock(&nn->nfs_client_lock);\n\t\t\tnew->cl_flags = cl_init->init_flags;\n\t\t\treturn rpc_ops->init_client(new, timeparms, ip_addr);\n\t\t}\n\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tnew = rpc_ops->alloc_client(cl_init);\n\t} while (!IS_ERR(new));\n\n\tdprintk(\"<-- nfs_get_client() Failed to find %s (%ld)\\n\",\n\t\tcl_init->hostname, PTR_ERR(new));\n\treturn new;\n}"
  },
  {
    "function_name": "nfs_found_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "449-472",
    "snippet": "static struct nfs_client *\nnfs_found_client(const struct nfs_client_initdata *cl_init,\n\t\t struct nfs_client *clp)\n{\n\tint error;\n\n\terror = nfs_wait_client_init_complete(clp);\n\tif (error < 0) {\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(-ERESTARTSYS);\n\t}\n\n\tif (clp->cl_cons_state < NFS_CS_READY) {\n\t\terror = clp->cl_cons_state;\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(error);\n\t}\n\n\tsmp_rmb();\n\n\tdprintk(\"<-- %s found nfs_client %p for %s\\n\",\n\t\t__func__, clp, cl_init->hostname ?: \"\");\n\treturn clp;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s found nfs_client %p for %s\\n\"",
            "__func__",
            "clp",
            "cl_init->hostname ?: \"\""
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_rmb",
          "args": [],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_put_client",
          "args": [
            "clp"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_put_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "267-286",
          "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ERESTARTSYS"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_wait_client_init_complete",
          "args": [
            "clp"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wait_client_init_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "439-443",
          "snippet": "int nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nint nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_client *\nnfs_found_client(const struct nfs_client_initdata *cl_init,\n\t\t struct nfs_client *clp)\n{\n\tint error;\n\n\terror = nfs_wait_client_init_complete(clp);\n\tif (error < 0) {\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(-ERESTARTSYS);\n\t}\n\n\tif (clp->cl_cons_state < NFS_CS_READY) {\n\t\terror = clp->cl_cons_state;\n\t\tnfs_put_client(clp);\n\t\treturn ERR_PTR(error);\n\t}\n\n\tsmp_rmb();\n\n\tdprintk(\"<-- %s found nfs_client %p for %s\\n\",\n\t\t__func__, clp, cl_init->hostname ?: \"\");\n\treturn clp;\n}"
  },
  {
    "function_name": "nfs_wait_client_init_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "439-443",
    "snippet": "int nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_event_killable",
          "args": [
            "nfs_client_active_wq",
            "nfs_client_init_is_complete(clp)"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_client_init_is_complete",
          "args": [
            "clp"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_client_init_is_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "434-437",
          "snippet": "static bool nfs_client_init_is_complete(const struct nfs_client *clp)\n{\n\treturn clp->cl_cons_state <= NFS_CS_READY;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool nfs_client_init_is_complete(const struct nfs_client *clp)\n{\n\treturn clp->cl_cons_state <= NFS_CS_READY;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(nfs_client_active_wq);\n\nint nfs_wait_client_init_complete(const struct nfs_client *clp)\n{\n\treturn wait_event_killable(nfs_client_active_wq,\n\t\t\tnfs_client_init_is_complete(clp));\n}"
  },
  {
    "function_name": "nfs_client_init_is_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "434-437",
    "snippet": "static bool nfs_client_init_is_complete(const struct nfs_client *clp)\n{\n\treturn clp->cl_cons_state <= NFS_CS_READY;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool nfs_client_init_is_complete(const struct nfs_client *clp)\n{\n\treturn clp->cl_cons_state <= NFS_CS_READY;\n}"
  },
  {
    "function_name": "nfs_match_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "403-432",
    "snippet": "static struct nfs_client *nfs_match_client(const struct nfs_client_initdata *data)\n{\n\tstruct nfs_client *clp;\n\tconst struct sockaddr *sap = data->addr;\n\tstruct nfs_net *nn = net_generic(data->net, nfs_net_id);\n\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t        const struct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\t\t/* Don't match clients that failed to initialise properly */\n\t\tif (clp->cl_cons_state < 0)\n\t\t\tcontinue;\n\n\t\t/* Different NFS versions cannot share the same nfs_client */\n\t\tif (clp->rpc_ops != data->nfs_mod->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (clp->cl_proto != data->proto)\n\t\t\tcontinue;\n\t\t/* Match nfsv4 minorversion */\n\t\tif (clp->cl_minorversion != data->minorversion)\n\t\t\tcontinue;\n\t\t/* Match the full socket address */\n\t\tif (!nfs_sockaddr_cmp(sap, clap))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\treturn clp;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&clp->cl_count"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sockaddr_cmp",
          "args": [
            "sap",
            "clap"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "384-397",
          "snippet": "static int nfs_sockaddr_cmp(const struct sockaddr *sa1,\n\t\t\t    const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_cmp_ip4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_cmp_ip6(sa1, sa2);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp(const struct sockaddr *sa1,\n\t\t\t    const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_cmp_ip4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_cmp_ip6(sa1, sa2);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "clp",
            "&nn->nfs_client_list",
            "cl_share_link"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "data->net",
            "nfs_net_id"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_client *nfs_match_client(const struct nfs_client_initdata *data)\n{\n\tstruct nfs_client *clp;\n\tconst struct sockaddr *sap = data->addr;\n\tstruct nfs_net *nn = net_generic(data->net, nfs_net_id);\n\n\tlist_for_each_entry(clp, &nn->nfs_client_list, cl_share_link) {\n\t        const struct sockaddr *clap = (struct sockaddr *)&clp->cl_addr;\n\t\t/* Don't match clients that failed to initialise properly */\n\t\tif (clp->cl_cons_state < 0)\n\t\t\tcontinue;\n\n\t\t/* Different NFS versions cannot share the same nfs_client */\n\t\tif (clp->rpc_ops != data->nfs_mod->rpc_ops)\n\t\t\tcontinue;\n\n\t\tif (clp->cl_proto != data->proto)\n\t\t\tcontinue;\n\t\t/* Match nfsv4 minorversion */\n\t\tif (clp->cl_minorversion != data->minorversion)\n\t\t\tcontinue;\n\t\t/* Match the full socket address */\n\t\tif (!nfs_sockaddr_cmp(sap, clap))\n\t\t\tcontinue;\n\n\t\tatomic_inc(&clp->cl_count);\n\t\treturn clp;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "nfs_sockaddr_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "384-397",
    "snippet": "static int nfs_sockaddr_cmp(const struct sockaddr *sa1,\n\t\t\t    const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_cmp_ip4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_cmp_ip6(sa1, sa2);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_sockaddr_cmp_ip6",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_cmp_ip6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "338-346",
          "snippet": "static int nfs_sockaddr_cmp_ip6(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2) &&\n\t\t(sin1->sin6_port == sin2->sin6_port);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp_ip6(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2) &&\n\t\t(sin1->sin6_port == sin2->sin6_port);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sockaddr_cmp_ip4",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_cmp_ip4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "348-356",
          "snippet": "static int nfs_sockaddr_cmp_ip4(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2) &&\n\t\t(sin1->sin_port == sin2->sin_port);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp_ip4(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2) &&\n\t\t(sin1->sin_port == sin2->sin_port);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp(const struct sockaddr *sa1,\n\t\t\t    const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_cmp_ip4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_cmp_ip6(sa1, sa2);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_sockaddr_match_ipaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "363-376",
    "snippet": "int nfs_sockaddr_match_ipaddr(const struct sockaddr *sa1,\n\t\t\t      const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_sockaddr_match_ipaddr6",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_match_ipaddr6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "315-319",
          "snippet": "static int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sockaddr_match_ipaddr4",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_match_ipaddr4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "329-336",
          "snippet": "static int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_sockaddr_match_ipaddr(const struct sockaddr *sa1,\n\t\t\t      const struct sockaddr *sa2)\n{\n\tif (sa1->sa_family != sa2->sa_family)\n\t\treturn 0;\n\n\tswitch (sa1->sa_family) {\n\tcase AF_INET:\n\t\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2);\n\tcase AF_INET6:\n\t\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_sockaddr_cmp_ip4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "348-356",
    "snippet": "static int nfs_sockaddr_cmp_ip4(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2) &&\n\t\t(sin1->sin_port == sin2->sin_port);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_sockaddr_match_ipaddr4",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_match_ipaddr4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "329-336",
          "snippet": "static int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp_ip4(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr4(sa1, sa2) &&\n\t\t(sin1->sin_port == sin2->sin_port);\n}"
  },
  {
    "function_name": "nfs_sockaddr_cmp_ip6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "338-346",
    "snippet": "static int nfs_sockaddr_cmp_ip6(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2) &&\n\t\t(sin1->sin6_port == sin2->sin6_port);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_sockaddr_match_ipaddr6",
          "args": [
            "sa1",
            "sa2"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sockaddr_match_ipaddr6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "315-319",
          "snippet": "static int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_cmp_ip6(const struct sockaddr *sa1,\n\t\t\t\tconst struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\treturn nfs_sockaddr_match_ipaddr6(sa1, sa2) &&\n\t\t(sin1->sin6_port == sin2->sin6_port);\n}"
  },
  {
    "function_name": "nfs_sockaddr_match_ipaddr4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "329-336",
    "snippet": "static int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr4(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in *sin1 = (const struct sockaddr_in *)sa1;\n\tconst struct sockaddr_in *sin2 = (const struct sockaddr_in *)sa2;\n\n\treturn sin1->sin_addr.s_addr == sin2->sin_addr.s_addr;\n}"
  },
  {
    "function_name": "nfs_sockaddr_match_ipaddr6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "315-319",
    "snippet": "static int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_sockaddr_match_ipaddr6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "301-313",
    "snippet": "static int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\treturn 0;\n\telse if (ipv6_addr_type(&sin1->sin6_addr) & IPV6_ADDR_LINKLOCAL)\n\t\treturn sin1->sin6_scope_id == sin2->sin6_scope_id;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ipv6_addr_type",
          "args": [
            "&sin1->sin6_addr"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ipv6_addr_equal",
          "args": [
            "&sin1->sin6_addr",
            "&sin2->sin6_addr"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_sockaddr_match_ipaddr6(const struct sockaddr *sa1,\n\t\t\t\t      const struct sockaddr *sa2)\n{\n\tconst struct sockaddr_in6 *sin1 = (const struct sockaddr_in6 *)sa1;\n\tconst struct sockaddr_in6 *sin2 = (const struct sockaddr_in6 *)sa2;\n\n\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\treturn 0;\n\telse if (ipv6_addr_type(&sin1->sin6_addr) & IPV6_ADDR_LINKLOCAL)\n\t\treturn sin1->sin6_scope_id == sin2->sin6_scope_id;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_put_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "267-286",
    "snippet": "void nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clp->rpc_ops->free_client",
          "args": [
            "clp"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "free_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/nfs4state.c",
          "lines": "1556-1573",
          "snippet": "static void\nfree_client(struct nfs4_client *clp)\n{\n\twhile (!list_empty(&clp->cl_sessions)) {\n\t\tstruct nfsd4_session *ses;\n\t\tses = list_entry(clp->cl_sessions.next, struct nfsd4_session,\n\t\t\t\tse_perclnt);\n\t\tlist_del(&ses->se_perclnt);\n\t\tWARN_ON_ONCE(atomic_read(&ses->se_ref));\n\t\tfree_session(ses);\n\t}\n\trpc_destroy_wait_queue(&clp->cl_cb_waitq);\n\tfree_svc_cred(&clp->cl_cred);\n\tkfree(clp->cl_ownerstr_hashtbl);\n\tkfree(clp->cl_name.data);\n\tidr_destroy(&clp->cl_stateids);\n\tkfree(clp);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"netns.h\"",
            "#include \"current_stateid.h\"",
            "#include \"vfs.h\"",
            "#include \"xdr4cb.h\"",
            "#include \"xdr4.h\"",
            "#include <linux/jhash.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/svcauth_gss.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swap.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_session(struct nfsd4_session *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"netns.h\"\n#include \"current_stateid.h\"\n#include \"vfs.h\"\n#include \"xdr4cb.h\"\n#include \"xdr4.h\"\n#include <linux/jhash.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/svcauth_gss.h>\n#include <linux/ratelimit.h>\n#include <linux/pagemap.h>\n#include <linux/swap.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n\nstatic void free_session(struct nfsd4_session *);\n\nstatic void\nfree_client(struct nfs4_client *clp)\n{\n\twhile (!list_empty(&clp->cl_sessions)) {\n\t\tstruct nfsd4_session *ses;\n\t\tses = list_entry(clp->cl_sessions.next, struct nfsd4_session,\n\t\t\t\tse_perclnt);\n\t\tlist_del(&ses->se_perclnt);\n\t\tWARN_ON_ONCE(atomic_read(&ses->se_ref));\n\t\tfree_session(ses);\n\t}\n\trpc_destroy_wait_queue(&clp->cl_cb_waitq);\n\tfree_svc_cred(&clp->cl_cred);\n\tkfree(clp->cl_ownerstr_hashtbl);\n\tkfree(clp->cl_name.data);\n\tidr_destroy(&clp->cl_stateids);\n\tkfree(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!list_empty(&clp->cl_superblocks)"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&clp->cl_superblocks"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nn->nfs_client_lock"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_cb_idr_remove_locked",
          "args": [
            "clp"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_cb_idr_remove_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "228-230",
          "snippet": "static void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&clp->cl_share_link"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_lock",
          "args": [
            "&clp->cl_count",
            "&nn->nfs_client_lock"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_put_client({%d})\\n\"",
            "atomic_read(&clp->cl_count)"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&clp->cl_count"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_put_client(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn;\n\n\tif (!clp)\n\t\treturn;\n\n\tdprintk(\"--> nfs_put_client({%d})\\n\", atomic_read(&clp->cl_count));\n\tnn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (atomic_dec_and_lock(&clp->cl_count, &nn->nfs_client_lock)) {\n\t\tlist_del(&clp->cl_share_link);\n\t\tnfs_cb_idr_remove_locked(clp);\n\t\tspin_unlock(&nn->nfs_client_lock);\n\n\t\tWARN_ON_ONCE(!list_empty(&clp->cl_superblocks));\n\n\t\tclp->rpc_ops->free_client(clp);\n\t}\n}"
  },
  {
    "function_name": "nfs_free_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "241-261",
    "snippet": "void nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_free_client()\\n\""
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_acceptor"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp->cl_hostname"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_nfs_version",
          "args": [
            "clp->cl_nfs_mod"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "118-121",
          "snippet": "void put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_net",
          "args": [
            "clp->cl_net"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "clp->cl_machine_cred"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_shutdown_client",
          "args": [
            "clp->cl_rpcclient"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "clp->cl_rpcclient"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fscache_release_client_cookie",
          "args": [
            "clp"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_release_client_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "50-57",
          "snippet": "void nfs_fscache_release_client_cookie(struct nfs_client *clp)\n{\n\tdfprintk(FSCACHE, \"NFS: releasing client cookie (0x%p/0x%p)\\n\",\n\t\t clp, clp->fscache);\n\n\tfscache_relinquish_cookie(clp->fscache, 0);\n\tclp->fscache = NULL;\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid nfs_fscache_release_client_cookie(struct nfs_client *clp)\n{\n\tdfprintk(FSCACHE, \"NFS: releasing client cookie (0x%p/0x%p)\\n\",\n\t\t clp, clp->fscache);\n\n\tfscache_relinquish_cookie(clp->fscache, 0);\n\tclp->fscache = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_free_client(%u)\\n\"",
            "clp->rpc_ops->version"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_client(struct nfs_client *clp)\n{\n\tdprintk(\"--> nfs_free_client(%u)\\n\", clp->rpc_ops->version);\n\n\tnfs_fscache_release_client_cookie(clp);\n\n\t/* -EIO all pending I/O */\n\tif (!IS_ERR(clp->cl_rpcclient))\n\t\trpc_shutdown_client(clp->cl_rpcclient);\n\n\tif (clp->cl_machine_cred != NULL)\n\t\tput_rpccred(clp->cl_machine_cred);\n\n\tput_net(clp->cl_net);\n\tput_nfs_version(clp->cl_nfs_mod);\n\tkfree(clp->cl_hostname);\n\tkfree(clp->cl_acceptor);\n\tkfree(clp);\n\n\tdprintk(\"<-- nfs_free_client()\\n\");\n}"
  },
  {
    "function_name": "pnfs_init_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "232-234",
    "snippet": "static void pnfs_init_server(struct nfs_server *server)\n{\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void pnfs_init_server(struct nfs_server *server)\n{\n}"
  },
  {
    "function_name": "nfs_cb_idr_remove_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "228-230",
    "snippet": "static void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n}"
  },
  {
    "function_name": "nfs_cleanup_cb_ident_idr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "224-226",
    "snippet": "void nfs_cleanup_cb_ident_idr(struct net *net)\n{\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_cleanup_cb_ident_idr(struct net *net)\n{\n}"
  },
  {
    "function_name": "pnfs_init_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "218-221",
    "snippet": "static void pnfs_init_server(struct nfs_server *server)\n{\n\trpc_init_wait_queue(&server->roc_rpcwaitq, \"pNFS ROC\");\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_init_wait_queue",
          "args": [
            "&server->roc_rpcwaitq",
            "\"pNFS ROC\""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void pnfs_init_server(struct nfs_server *server)\n{\n\trpc_init_wait_queue(&server->roc_rpcwaitq, \"pNFS ROC\");\n}"
  },
  {
    "function_name": "nfs_cb_idr_remove_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "210-216",
    "snippet": "static void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->cl_cb_ident)\n\t\tidr_remove(&nn->cb_ident_idr, clp->cl_cb_ident);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "idr_remove",
          "args": [
            "&nn->cb_ident_idr",
            "clp->cl_cb_ident"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "clp->cl_net",
            "nfs_net_id"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_cb_idr_remove_locked(struct nfs_client *clp)\n{\n\tstruct nfs_net *nn = net_generic(clp->cl_net, nfs_net_id);\n\n\tif (clp->cl_cb_ident)\n\t\tidr_remove(&nn->cb_ident_idr, clp->cl_cb_ident);\n}"
  },
  {
    "function_name": "nfs_cleanup_cb_ident_idr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "202-207",
    "snippet": "void nfs_cleanup_cb_ident_idr(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tidr_destroy(&nn->cb_ident_idr);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "idr_destroy",
          "args": [
            "&nn->cb_ident_idr"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfs_net_id"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_cleanup_cb_ident_idr(struct net *net)\n{\n\tstruct nfs_net *nn = net_generic(net, nfs_net_id);\n\n\tidr_destroy(&nn->cb_ident_idr);\n}"
  },
  {
    "function_name": "nfs_alloc_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "151-198",
    "snippet": "struct nfs_client *nfs_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tstruct nfs_client *clp;\n\tstruct rpc_cred *cred;\n\tint err = -ENOMEM;\n\n\tif ((clp = kzalloc(sizeof(*clp), GFP_KERNEL)) == NULL)\n\t\tgoto error_0;\n\n\tclp->cl_nfs_mod = cl_init->nfs_mod;\n\tif (!try_module_get(clp->cl_nfs_mod->owner))\n\t\tgoto error_dealloc;\n\n\tclp->rpc_ops = clp->cl_nfs_mod->rpc_ops;\n\n\tatomic_set(&clp->cl_count, 1);\n\tclp->cl_cons_state = NFS_CS_INITING;\n\n\tmemcpy(&clp->cl_addr, cl_init->addr, cl_init->addrlen);\n\tclp->cl_addrlen = cl_init->addrlen;\n\n\tif (cl_init->hostname) {\n\t\terr = -ENOMEM;\n\t\tclp->cl_hostname = kstrdup(cl_init->hostname, GFP_KERNEL);\n\t\tif (!clp->cl_hostname)\n\t\t\tgoto error_cleanup;\n\t}\n\n\tINIT_LIST_HEAD(&clp->cl_superblocks);\n\tclp->cl_rpcclient = ERR_PTR(-EINVAL);\n\n\tclp->cl_proto = cl_init->proto;\n\tclp->cl_net = get_net(cl_init->net);\n\n\tcred = rpc_lookup_machine_cred(\"*\");\n\tif (!IS_ERR(cred))\n\t\tclp->cl_machine_cred = cred;\n\tnfs_fscache_get_client_cookie(clp);\n\n\treturn clp;\n\nerror_cleanup:\n\tput_nfs_version(clp->cl_nfs_mod);\nerror_dealloc:\n\tkfree(clp);\nerror_0:\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "clp"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_nfs_version",
          "args": [
            "clp->cl_nfs_mod"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "118-121",
          "snippet": "void put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fscache_get_client_cookie",
          "args": [
            "clp"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_get_client_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "37-45",
          "snippet": "void nfs_fscache_get_client_cookie(struct nfs_client *clp)\n{\n\t/* create a cache index for looking up filehandles */\n\tclp->fscache = fscache_acquire_cookie(nfs_fscache_netfs.primary_index,\n\t\t\t\t\t      &nfs_fscache_server_index_def,\n\t\t\t\t\t      clp, true);\n\tdfprintk(FSCACHE, \"NFS: get client cookie (0x%p/0x%p)\\n\",\n\t\t clp, clp->fscache);\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid nfs_fscache_get_client_cookie(struct nfs_client *clp)\n{\n\t/* create a cache index for looking up filehandles */\n\tclp->fscache = fscache_acquire_cookie(nfs_fscache_netfs.primary_index,\n\t\t\t\t\t      &nfs_fscache_server_index_def,\n\t\t\t\t\t      clp, true);\n\tdfprintk(FSCACHE, \"NFS: get client cookie (0x%p/0x%p)\\n\",\n\t\t clp, clp->fscache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cred"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_lookup_machine_cred",
          "args": [
            "\"*\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_net",
          "args": [
            "cl_init->net"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&clp->cl_superblocks"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "cl_init->hostname",
            "GFP_KERNEL"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&clp->cl_addr",
            "cl_init->addr",
            "cl_init->addrlen"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&clp->cl_count",
            "1"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "clp->cl_nfs_mod->owner"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*clp)",
            "GFP_KERNEL"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_client *nfs_alloc_client(const struct nfs_client_initdata *cl_init)\n{\n\tstruct nfs_client *clp;\n\tstruct rpc_cred *cred;\n\tint err = -ENOMEM;\n\n\tif ((clp = kzalloc(sizeof(*clp), GFP_KERNEL)) == NULL)\n\t\tgoto error_0;\n\n\tclp->cl_nfs_mod = cl_init->nfs_mod;\n\tif (!try_module_get(clp->cl_nfs_mod->owner))\n\t\tgoto error_dealloc;\n\n\tclp->rpc_ops = clp->cl_nfs_mod->rpc_ops;\n\n\tatomic_set(&clp->cl_count, 1);\n\tclp->cl_cons_state = NFS_CS_INITING;\n\n\tmemcpy(&clp->cl_addr, cl_init->addr, cl_init->addrlen);\n\tclp->cl_addrlen = cl_init->addrlen;\n\n\tif (cl_init->hostname) {\n\t\terr = -ENOMEM;\n\t\tclp->cl_hostname = kstrdup(cl_init->hostname, GFP_KERNEL);\n\t\tif (!clp->cl_hostname)\n\t\t\tgoto error_cleanup;\n\t}\n\n\tINIT_LIST_HEAD(&clp->cl_superblocks);\n\tclp->cl_rpcclient = ERR_PTR(-EINVAL);\n\n\tclp->cl_proto = cl_init->proto;\n\tclp->cl_net = get_net(cl_init->net);\n\n\tcred = rpc_lookup_machine_cred(\"*\");\n\tif (!IS_ERR(cred))\n\t\tclp->cl_machine_cred = cred;\n\tnfs_fscache_get_client_cookie(clp);\n\n\treturn clp;\n\nerror_cleanup:\n\tput_nfs_version(clp->cl_nfs_mod);\nerror_dealloc:\n\tkfree(clp);\nerror_0:\n\treturn ERR_PTR(err);\n}"
  },
  {
    "function_name": "unregister_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "134-142",
    "snippet": "void unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(nfs_version_lock);",
      "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&nfs->list"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid unregister_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tnfs_version[nfs->rpc_ops->version] = NULL;\n\tlist_del(&nfs->list);\n\n\tspin_unlock(&nfs_version_lock);\n}"
  },
  {
    "function_name": "register_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "123-131",
    "snippet": "void register_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tlist_add(&nfs->list, &nfs_versions);\n\tnfs_version[nfs->rpc_ops->version] = nfs->rpc_vers;\n\n\tspin_unlock(&nfs_version_lock);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(nfs_version_lock);",
      "static LIST_HEAD(nfs_versions);",
      "static const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&nfs->list",
            "&nfs_versions"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic LIST_HEAD(nfs_versions);\nstatic const struct rpc_version *nfs_version[5] = {\n\t[2] = NULL,\n\t[3] = NULL,\n\t[4] = NULL,\n};\n\nvoid register_nfs_version(struct nfs_subversion *nfs)\n{\n\tspin_lock(&nfs_version_lock);\n\n\tlist_add(&nfs->list, &nfs_versions);\n\tnfs_version[nfs->rpc_ops->version] = nfs->rpc_vers;\n\n\tspin_unlock(&nfs_version_lock);\n}"
  },
  {
    "function_name": "put_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "118-121",
    "snippet": "void put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "nfs->owner"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}"
  },
  {
    "function_name": "get_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "102-116",
    "snippet": "struct nfs_subversion *get_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs = find_nfs_version(version);\n\n\tif (IS_ERR(nfs)) {\n\t\tmutex_lock(&nfs_version_mutex);\n\t\trequest_module(\"nfsv%d\", version);\n\t\tnfs = find_nfs_version(version);\n\t\tmutex_unlock(&nfs_version_mutex);\n\t}\n\n\tif (!IS_ERR(nfs) && !try_module_get(nfs->owner))\n\t\treturn ERR_PTR(-EAGAIN);\n\treturn nfs;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(nfs_version_mutex);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EAGAIN"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "nfs->owner"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nfs"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&nfs_version_mutex"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_nfs_version",
          "args": [
            "version"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "find_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "86-100",
          "snippet": "static struct nfs_subversion *find_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs;\n\tspin_lock(&nfs_version_lock);\n\n\tlist_for_each_entry(nfs, &nfs_versions, list) {\n\t\tif (nfs->rpc_ops->version == version) {\n\t\t\tspin_unlock(&nfs_version_lock);\n\t\t\treturn nfs;\n\t\t}\n\t}\n\n\tspin_unlock(&nfs_version_lock);\n\treturn ERR_PTR(-EPROTONOSUPPORT);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(nfs_version_lock);",
            "static LIST_HEAD(nfs_versions);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic LIST_HEAD(nfs_versions);\n\nstatic struct nfs_subversion *find_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs;\n\tspin_lock(&nfs_version_lock);\n\n\tlist_for_each_entry(nfs, &nfs_versions, list) {\n\t\tif (nfs->rpc_ops->version == version) {\n\t\t\tspin_unlock(&nfs_version_lock);\n\t\t\treturn nfs;\n\t\t}\n\t}\n\n\tspin_unlock(&nfs_version_lock);\n\treturn ERR_PTR(-EPROTONOSUPPORT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"nfsv%d\"",
            "version"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&nfs_version_mutex"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nfs"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_MUTEX(nfs_version_mutex);\n\nstruct nfs_subversion *get_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs = find_nfs_version(version);\n\n\tif (IS_ERR(nfs)) {\n\t\tmutex_lock(&nfs_version_mutex);\n\t\trequest_module(\"nfsv%d\", version);\n\t\tnfs = find_nfs_version(version);\n\t\tmutex_unlock(&nfs_version_mutex);\n\t}\n\n\tif (!IS_ERR(nfs) && !try_module_get(nfs->owner))\n\t\treturn ERR_PTR(-EAGAIN);\n\treturn nfs;\n}"
  },
  {
    "function_name": "find_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
    "lines": "86-100",
    "snippet": "static struct nfs_subversion *find_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs;\n\tspin_lock(&nfs_version_lock);\n\n\tlist_for_each_entry(nfs, &nfs_versions, list) {\n\t\tif (nfs->rpc_ops->version == version) {\n\t\t\tspin_unlock(&nfs_version_lock);\n\t\t\treturn nfs;\n\t\t}\n\t}\n\n\tspin_unlock(&nfs_version_lock);\n\treturn ERR_PTR(-EPROTONOSUPPORT);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/pid_namespace.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <net/ipv6.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(nfs_version_lock);",
      "static LIST_HEAD(nfs_versions);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EPROTONOSUPPORT"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nfs",
            "&nfs_versions",
            "list"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&nfs_version_lock"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(nfs_version_lock);\nstatic LIST_HEAD(nfs_versions);\n\nstatic struct nfs_subversion *find_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs;\n\tspin_lock(&nfs_version_lock);\n\n\tlist_for_each_entry(nfs, &nfs_versions, list) {\n\t\tif (nfs->rpc_ops->version == version) {\n\t\t\tspin_unlock(&nfs_version_lock);\n\t\t\treturn nfs;\n\t\t}\n\t}\n\n\tspin_unlock(&nfs_version_lock);\n\treturn ERR_PTR(-EPROTONOSUPPORT);\n}"
  }
]