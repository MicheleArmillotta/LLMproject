[
  {
    "function_name": "ufs_is_data_ptr_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "585-592",
    "snippet": "static inline int ufs_is_data_ptr_zero(struct ufs_sb_private_info *uspi,\n\t\t\t\t       void *p)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\treturn *(__fs64 *)p == 0;\n\telse\n\t\treturn *(__fs32 *)p == 0;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\n\nstatic inline int ufs_is_data_ptr_zero(struct ufs_sb_private_info *uspi,\n\t\t\t\t       void *p)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\treturn *(__fs64 *)p == 0;\n\telse\n\t\treturn *(__fs32 *)p == 0;\n}"
  },
  {
    "function_name": "ufs_data_ptr_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "576-583",
    "snippet": "static inline void ufs_data_ptr_clear(struct ufs_sb_private_info *uspi,\n\t\t\t\t      void *p)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\t*(__fs64 *)p = 0;\n\telse\n\t\t*(__fs32 *)p = 0;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\n\nstatic inline void ufs_data_ptr_clear(struct ufs_sb_private_info *uspi,\n\t\t\t\t      void *p)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\t*(__fs64 *)p = 0;\n\telse\n\t\t*(__fs32 *)p = 0;\n}"
  },
  {
    "function_name": "ufs_cpu_to_data_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "568-574",
    "snippet": "static inline void ufs_cpu_to_data_ptr(struct super_block *sb, void *p, u64 val)\n{\n\tif (UFS_SB(sb)->s_uspi->fs_magic == UFS2_MAGIC)\n\t\t*(__fs64 *)p = cpu_to_fs64(sb, val);\n\telse\n\t\t*(__fs32 *)p = cpu_to_fs32(sb, val);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_fs32",
          "args": [
            "sb",
            "val"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "52-59",
          "snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_fs64",
          "args": [
            "sb",
            "val"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "34-41",
          "snippet": "static inline __fs64\ncpu_to_fs64(struct super_block *sbp, u64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs64)cpu_to_le64(n);\n\telse\n\t\treturn (__force __fs64)cpu_to_be64(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs64\ncpu_to_fs64(struct super_block *sbp, u64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs64)cpu_to_le64(n);\n\telse\n\t\treturn (__force __fs64)cpu_to_be64(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\n\nstatic inline void ufs_cpu_to_data_ptr(struct super_block *sb, void *p, u64 val)\n{\n\tif (UFS_SB(sb)->s_uspi->fs_magic == UFS2_MAGIC)\n\t\t*(__fs64 *)p = cpu_to_fs64(sb, val);\n\telse\n\t\t*(__fs32 *)p = cpu_to_fs32(sb, val);\n}"
  },
  {
    "function_name": "ufs_data_ptr_to_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "561-566",
    "snippet": "static inline u64 ufs_data_ptr_to_cpu(struct super_block *sb, void *p)\n{\n\treturn UFS_SB(sb)->s_uspi->fs_magic == UFS2_MAGIC ?\n\t\tfs64_to_cpu(sb, *(__fs64 *)p) :\n\t\tfs32_to_cpu(sb, *(__fs32 *)p);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "*(__fs32 *)p"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "*(__fs64 *)p"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "25-32",
          "snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\n\nstatic inline u64 ufs_data_ptr_to_cpu(struct super_block *sb, void *p)\n{\n\treturn UFS_SB(sb)->s_uspi->fs_magic == UFS2_MAGIC ?\n\t\tfs64_to_cpu(sb, *(__fs64 *)p) :\n\t\tfs32_to_cpu(sb, *(__fs32 *)p);\n}"
  },
  {
    "function_name": "ufs_get_direct_data_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "551-559",
    "snippet": "static inline void *ufs_get_direct_data_ptr(struct ufs_sb_private_info *uspi,\n\t\t\t\t\t    struct ufs_inode_info *ufsi,\n\t\t\t\t\t    unsigned blk)\n{\n\tBUG_ON(blk > UFS_TIND_BLOCK);\n\treturn uspi->fs_magic == UFS2_MAGIC ?\n\t\t(void *)&ufsi->i_u1.u2_i_data[blk] :\n\t\t(void *)&ufsi->i_u1.i_data[blk];\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern dev_t ufs_get_inode_dev(struct super_block *, struct ufs_inode_info *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "blk > UFS_TIND_BLOCK"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern dev_t ufs_get_inode_dev(struct super_block *, struct ufs_inode_info *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\n\nstatic inline void *ufs_get_direct_data_ptr(struct ufs_sb_private_info *uspi,\n\t\t\t\t\t    struct ufs_inode_info *ufsi,\n\t\t\t\t\t    unsigned blk)\n{\n\tBUG_ON(blk > UFS_TIND_BLOCK);\n\treturn uspi->fs_magic == UFS2_MAGIC ?\n\t\t(void *)&ufsi->i_u1.u2_i_data[blk] :\n\t\t(void *)&ufsi->i_u1.i_data[blk];\n}"
  },
  {
    "function_name": "ufs_fragacct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "529-549",
    "snippet": "static inline void ufs_fragacct (struct super_block * sb, unsigned blockmap,\n\t__fs32 * fraglist, int cnt)\n{\n\tstruct ufs_sb_private_info * uspi;\n\tunsigned fragsize, pos;\n\t\n\tuspi = UFS_SB(sb)->s_uspi;\n\t\n\tfragsize = 0;\n\tfor (pos = 0; pos < uspi->s_fpb; pos++) {\n\t\tif (blockmap & (1 << pos)) {\n\t\t\tfragsize++;\n\t\t}\n\t\telse if (fragsize > 0) {\n\t\t\tfs32_add(sb, &fraglist[fragsize], cnt);\n\t\t\tfragsize = 0;\n\t\t}\n\t}\n\tif (fragsize > 0 && fragsize < uspi->s_fpb)\n\t\tfs32_add(sb, &fraglist[fragsize], cnt);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs32_add",
          "args": [
            "sb",
            "&fraglist[fragsize]",
            "cnt"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "61-68",
          "snippet": "static inline void\nfs32_add(struct super_block *sbp, __fs32 *n, int d)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\tle32_add_cpu((__le32 *)n, d);\n\telse\n\t\tbe32_add_cpu((__be32 *)n, d);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nfs32_add(struct super_block *sbp, __fs32 *n, int d)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\tle32_add_cpu((__le32 *)n, d);\n\telse\n\t\tbe32_add_cpu((__be32 *)n, d);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\n\nstatic inline void ufs_fragacct (struct super_block * sb, unsigned blockmap,\n\t__fs32 * fraglist, int cnt)\n{\n\tstruct ufs_sb_private_info * uspi;\n\tunsigned fragsize, pos;\n\t\n\tuspi = UFS_SB(sb)->s_uspi;\n\t\n\tfragsize = 0;\n\tfor (pos = 0; pos < uspi->s_fpb; pos++) {\n\t\tif (blockmap & (1 << pos)) {\n\t\t\tfragsize++;\n\t\t}\n\t\telse if (fragsize > 0) {\n\t\t\tfs32_add(sb, &fraglist[fragsize], cnt);\n\t\t\tfragsize = 0;\n\t\t}\n\t}\n\tif (fragsize > 0 && fragsize < uspi->s_fpb)\n\t\tfs32_add(sb, &fraglist[fragsize], cnt);\n}"
  },
  {
    "function_name": "_ubh_setblock_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "510-527",
    "snippet": "static inline void _ubh_setblock_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \t*ubh_get_addr(ubh, begin + block) = 0xff;\n\t    \treturn;\n\tcase 4:\n\t\t*ubh_get_addr(ubh, begin + (block >> 1)) |= (0x0f << ((block & 0x01) << 2));\n\t\treturn;\n\tcase 2:\n\t\t*ubh_get_addr(ubh, begin + (block >> 2)) |= (0x03 << ((block & 0x03) << 1));\n\t\treturn;\n\tcase 1:\n\t\t*ubh_get_addr(ubh, begin + (block >> 3)) |= (0x01 << ((block & 0x07)));\n\t\treturn;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [
      "#define ubh_get_addr ubh_get_addr8"
    ],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 3)"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 2)"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 1)"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + block"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\n#define ubh_get_addr ubh_get_addr8\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline void _ubh_setblock_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \t*ubh_get_addr(ubh, begin + block) = 0xff;\n\t    \treturn;\n\tcase 4:\n\t\t*ubh_get_addr(ubh, begin + (block >> 1)) |= (0x0f << ((block & 0x01) << 2));\n\t\treturn;\n\tcase 2:\n\t\t*ubh_get_addr(ubh, begin + (block >> 2)) |= (0x03 << ((block & 0x03) << 1));\n\t\treturn;\n\tcase 1:\n\t\t*ubh_get_addr(ubh, begin + (block >> 3)) |= (0x01 << ((block & 0x07)));\n\t\treturn;\n\t}\n}"
  },
  {
    "function_name": "_ubh_clrblock_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "490-507",
    "snippet": "static inline void _ubh_clrblock_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \t*ubh_get_addr (ubh, begin + block) = 0x00;\n\t    \treturn; \n\tcase 4:\n\t\t*ubh_get_addr (ubh, begin + (block >> 1)) &= ~(0x0f << ((block & 0x01) << 2));\n\t\treturn;\n\tcase 2:\n\t\t*ubh_get_addr (ubh, begin + (block >> 2)) &= ~(0x03 << ((block & 0x03) << 1));\n\t\treturn;\n\tcase 1:\n\t\t*ubh_get_addr (ubh, begin + (block >> 3)) &= ~(0x01 << ((block & 0x07)));\n\t\treturn;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [
      "#define ubh_get_addr ubh_get_addr8"
    ],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 3)"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 2)"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 1)"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + block"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\n#define ubh_get_addr ubh_get_addr8\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline void _ubh_clrblock_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \t*ubh_get_addr (ubh, begin + block) = 0x00;\n\t    \treturn; \n\tcase 4:\n\t\t*ubh_get_addr (ubh, begin + (block >> 1)) &= ~(0x0f << ((block & 0x01) << 2));\n\t\treturn;\n\tcase 2:\n\t\t*ubh_get_addr (ubh, begin + (block >> 2)) &= ~(0x03 << ((block & 0x03) << 1));\n\t\treturn;\n\tcase 1:\n\t\t*ubh_get_addr (ubh, begin + (block >> 3)) &= ~(0x01 << ((block & 0x07)));\n\t\treturn;\n\t}\n}"
  },
  {
    "function_name": "_ubh_isblockset_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "473-487",
    "snippet": "static inline int _ubh_isblockset_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \treturn (*ubh_get_addr (ubh, begin + block) == 0xff);\n\tcase 4:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 1)) == (0x0f << ((block & 0x01) << 2)));\n\tcase 2:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 2)) == (0x03 << ((block & 0x03) << 1)));\n\tcase 1:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 3)) == (0x01 << (block & 0x07)));\n\t}\n\treturn 0;\t\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [
      "#define ubh_get_addr ubh_get_addr8"
    ],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 3)"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 2)"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + (block >> 1)"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr",
          "args": [
            "ubh",
            "begin + block"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\n#define ubh_get_addr ubh_get_addr8\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline int _ubh_isblockset_(struct ufs_sb_private_info * uspi,\n\tstruct ufs_buffer_head * ubh, unsigned begin, unsigned block)\n{\n\tswitch (uspi->s_fpb) {\n\tcase 8:\n\t    \treturn (*ubh_get_addr (ubh, begin + block) == 0xff);\n\tcase 4:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 1)) == (0x0f << ((block & 0x01) << 2)));\n\tcase 2:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 2)) == (0x03 << ((block & 0x03) << 1)));\n\tcase 1:\n\t\treturn (*ubh_get_addr (ubh, begin + (block >> 3)) == (0x01 << (block & 0x07)));\n\t}\n\treturn 0;\t\n}"
  },
  {
    "function_name": "_ubh_find_last_zero_bit_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "444-468",
    "snippet": "static inline unsigned _ubh_find_last_zero_bit_(\n\tstruct ufs_sb_private_info * uspi, struct ufs_buffer_head * ubh,\n\tunsigned begin, unsigned start, unsigned end)\n{\n\tunsigned base, count, pos, size;\n\n\tsize = start - end;\n\tbegin <<= 3;\n\tstart += begin;\n\tbase = start >> uspi->s_bpfshift;\n\tstart &= uspi->s_bpfmask;\n\tfor (;;) {\n\t\tcount = min_t(unsigned int,\n\t\t\t    size + (uspi->s_bpf - start), uspi->s_bpf)\n\t\t\t- (uspi->s_bpf - start);\n\t\tsize -= count;\n\t\tpos = find_last_zero_bit (ubh->bh[base]->b_data,\n\t\t\tstart, start - count);\n\t\tif (pos > start - count || !size)\n\t\t\tbreak;\n\t\tbase--;\n\t\tstart = uspi->s_bpf;\n\t}\n\treturn (base << uspi->s_bpfshift) + pos - begin;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_last_zero_bit",
          "args": [
            "ubh->bh[base]->b_data",
            "start",
            "start - count"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "find_last_zero_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
          "lines": "420-441",
          "snippet": "static inline unsigned find_last_zero_bit (unsigned char * bitmap,\n\tunsigned size, unsigned offset)\n{\n\tunsigned bit, i;\n\tunsigned char * mapp;\n\tunsigned char map;\n\n\tmapp = bitmap + (size >> 3);\n\tmap = *mapp--;\n\tbit = 1 << (size & 7);\n\tfor (i = size; i > offset; i--) {\n\t\tif ((map & bit) == 0)\n\t\t\tbreak;\n\t\tif ((i & 7) != 0) {\n\t\t\tbit >>= 1;\n\t\t} else {\n\t\t\tmap = *mapp--;\n\t\t\tbit = 1 << 7;\n\t\t}\n\t}\n\treturn i;\n}",
          "includes": [
            "#include \"swab.h\"",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline unsigned find_last_zero_bit (unsigned char * bitmap,\n\tunsigned size, unsigned offset)\n{\n\tunsigned bit, i;\n\tunsigned char * mapp;\n\tunsigned char map;\n\n\tmapp = bitmap + (size >> 3);\n\tmap = *mapp--;\n\tbit = 1 << (size & 7);\n\tfor (i = size; i > offset; i--) {\n\t\tif ((map & bit) == 0)\n\t\t\tbreak;\n\t\tif ((i & 7) != 0) {\n\t\t\tbit >>= 1;\n\t\t} else {\n\t\t\tmap = *mapp--;\n\t\t\tbit = 1 << 7;\n\t\t}\n\t}\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedint",
            "size + (uspi->s_bpf - start)",
            "uspi->s_bpf"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline unsigned _ubh_find_last_zero_bit_(\n\tstruct ufs_sb_private_info * uspi, struct ufs_buffer_head * ubh,\n\tunsigned begin, unsigned start, unsigned end)\n{\n\tunsigned base, count, pos, size;\n\n\tsize = start - end;\n\tbegin <<= 3;\n\tstart += begin;\n\tbase = start >> uspi->s_bpfshift;\n\tstart &= uspi->s_bpfmask;\n\tfor (;;) {\n\t\tcount = min_t(unsigned int,\n\t\t\t    size + (uspi->s_bpf - start), uspi->s_bpf)\n\t\t\t- (uspi->s_bpf - start);\n\t\tsize -= count;\n\t\tpos = find_last_zero_bit (ubh->bh[base]->b_data,\n\t\t\tstart, start - count);\n\t\tif (pos > start - count || !size)\n\t\t\tbreak;\n\t\tbase--;\n\t\tstart = uspi->s_bpf;\n\t}\n\treturn (base << uspi->s_bpfshift) + pos - begin;\n}"
  },
  {
    "function_name": "find_last_zero_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "420-441",
    "snippet": "static inline unsigned find_last_zero_bit (unsigned char * bitmap,\n\tunsigned size, unsigned offset)\n{\n\tunsigned bit, i;\n\tunsigned char * mapp;\n\tunsigned char map;\n\n\tmapp = bitmap + (size >> 3);\n\tmap = *mapp--;\n\tbit = 1 << (size & 7);\n\tfor (i = size; i > offset; i--) {\n\t\tif ((map & bit) == 0)\n\t\t\tbreak;\n\t\tif ((i & 7) != 0) {\n\t\t\tbit >>= 1;\n\t\t} else {\n\t\t\tmap = *mapp--;\n\t\t\tbit = 1 << 7;\n\t\t}\n\t}\n\treturn i;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline unsigned find_last_zero_bit (unsigned char * bitmap,\n\tunsigned size, unsigned offset)\n{\n\tunsigned bit, i;\n\tunsigned char * mapp;\n\tunsigned char map;\n\n\tmapp = bitmap + (size >> 3);\n\tmap = *mapp--;\n\tbit = 1 << (size & 7);\n\tfor (i = size; i > offset; i--) {\n\t\tif ((map & bit) == 0)\n\t\t\tbreak;\n\t\tif ((i & 7) != 0) {\n\t\t\tbit >>= 1;\n\t\t} else {\n\t\t\tmap = *mapp--;\n\t\t\tbit = 1 << 7;\n\t\t}\n\t}\n\treturn i;\n}"
  },
  {
    "function_name": "_ubh_find_next_zero_bit_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "397-418",
    "snippet": "static inline unsigned _ubh_find_next_zero_bit_(\n\tstruct ufs_sb_private_info * uspi, struct ufs_buffer_head * ubh,\n\tunsigned begin, unsigned size, unsigned offset)\n{\n\tunsigned base, count, pos;\n\n\tsize -= offset;\n\tbegin <<= 3;\n\toffset += begin;\n\tbase = offset >> uspi->s_bpfshift;\n\toffset &= uspi->s_bpfmask;\n\tfor (;;) {\n\t\tcount = min_t(unsigned int, size + offset, uspi->s_bpf);\n\t\tsize -= count - offset;\n\t\tpos = find_next_zero_bit_le(ubh->bh[base]->b_data, count, offset);\n\t\tif (pos < count || !size)\n\t\t\tbreak;\n\t\tbase++;\n\t\toffset = 0;\n\t}\n\treturn (base << uspi->s_bpfshift) + pos - begin;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_next_zero_bit_le",
          "args": [
            "ubh->bh[base]->b_data",
            "count",
            "offset"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedint",
            "size + offset",
            "uspi->s_bpf"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline unsigned _ubh_find_next_zero_bit_(\n\tstruct ufs_sb_private_info * uspi, struct ufs_buffer_head * ubh,\n\tunsigned begin, unsigned size, unsigned offset)\n{\n\tunsigned base, count, pos;\n\n\tsize -= offset;\n\tbegin <<= 3;\n\toffset += begin;\n\tbase = offset >> uspi->s_bpfshift;\n\toffset &= uspi->s_bpfmask;\n\tfor (;;) {\n\t\tcount = min_t(unsigned int, size + offset, uspi->s_bpf);\n\t\tsize -= count - offset;\n\t\tpos = find_next_zero_bit_le(ubh->bh[base]->b_data, count, offset);\n\t\tif (pos < count || !size)\n\t\t\tbreak;\n\t\tbase++;\n\t\toffset = 0;\n\t}\n\treturn (base << uspi->s_bpfshift) + pos - begin;\n}"
  },
  {
    "function_name": "ufs_freespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "357-363",
    "snippet": "static inline u64\nufs_freespace(struct ufs_sb_private_info *uspi, int percentreserved)\n{\n\treturn ufs_blkstofrags(uspi->cs_total.cs_nbfree) +\n\t\tuspi->cs_total.cs_nffree -\n\t\t(uspi->s_dsize * (percentreserved) / 100);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ufs_blkstofrags",
          "args": [
            "uspi->cs_total.cs_nbfree"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\n\nstatic inline u64\nufs_freespace(struct ufs_sb_private_info *uspi, int percentreserved)\n{\n\treturn ufs_blkstofrags(uspi->cs_total.cs_nbfree) +\n\t\tuspi->cs_total.cs_nffree -\n\t\t(uspi->s_dsize * (percentreserved) / 100);\n}"
  },
  {
    "function_name": "ubh_get_data_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "340-348",
    "snippet": "static inline void *ubh_get_data_ptr(struct ufs_sb_private_info *uspi,\n\t\t\t\t     struct ufs_buffer_head *ubh,\n\t\t\t\t     u64 blk)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\treturn ubh_get_addr64(ubh, blk);\n\telse\n\t\treturn ubh_get_addr32(ubh, blk);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);",
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ubh_get_addr32",
          "args": [
            "ubh",
            "blk"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubh_get_addr64",
          "args": [
            "ubh",
            "blk"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline void *ubh_get_data_ptr(struct ufs_sb_private_info *uspi,\n\t\t\t\t     struct ufs_buffer_head *ubh,\n\t\t\t\t     u64 blk)\n{\n\tif (uspi->fs_magic == UFS2_MAGIC)\n\t\treturn ubh_get_addr64(ubh, blk);\n\telse\n\t\treturn ubh_get_addr32(ubh, blk);\n}"
  },
  {
    "function_name": "get_usb_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "294-302",
    "snippet": "static inline void *get_usb_offset(struct ufs_sb_private_info *uspi,\n\t\t\t\t   unsigned int offset)\n{\n\tunsigned int index;\n\t\n\tindex = offset >> uspi->s_fshift;\n\toffset &= ~uspi->s_fmask;\n\treturn uspi->s_ubh.bh[index]->b_data + offset;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern struct page *ufs_get_locked_page(struct address_space *mapping,\n\t\t\t\t\tpgoff_t index);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern struct page *ufs_get_locked_page(struct address_space *mapping,\n\t\t\t\t\tpgoff_t index);\n\nstatic inline void *get_usb_offset(struct ufs_sb_private_info *uspi,\n\t\t\t\t   unsigned int offset)\n{\n\tunsigned int index;\n\t\n\tindex = offset >> uspi->s_fshift;\n\toffset &= ~uspi->s_fmask;\n\treturn uspi->s_ubh.bh[index]->b_data + offset;\n}"
  },
  {
    "function_name": "ufs_put_locked_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "283-287",
    "snippet": "static inline void ufs_put_locked_page(struct page *page)\n{\n       unlock_page(page);\n       page_cache_release(page);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_cache_release",
          "args": [
            "page"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_unlock_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/aops.c",
          "lines": "1127-1148",
          "snippet": "static void ocfs2_unlock_pages(struct ocfs2_write_ctxt *wc)\n{\n\tint i;\n\n\t/*\n\t * w_target_locked is only set to true in the page_mkwrite() case.\n\t * The intent is to allow us to lock the target page from write_begin()\n\t * to write_end(). The caller must hold a ref on w_target_page.\n\t */\n\tif (wc->w_target_locked) {\n\t\tBUG_ON(!wc->w_target_page);\n\t\tfor (i = 0; i < wc->w_num_pages; i++) {\n\t\t\tif (wc->w_target_page == wc->w_pages[i]) {\n\t\t\t\twc->w_pages[i] = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tmark_page_accessed(wc->w_target_page);\n\t\tpage_cache_release(wc->w_target_page);\n\t}\n\tocfs2_unlock_and_free_pages(wc->w_pages, wc->w_num_pages);\n}",
          "includes": [
            "#include \"sysfile.h\"",
            "#include \"namei.h\"",
            "#include \"dir.h\"",
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"refcounttree.h\"",
            "#include \"symlink.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"aops.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/mpage.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/swap.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfile.h\"\n#include \"namei.h\"\n#include \"dir.h\"\n#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"refcounttree.h\"\n#include \"symlink.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"aops.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/blkdev.h>\n#include <linux/quotaops.h>\n#include <linux/mpage.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/swap.h>\n#include <asm/byteorder.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_unlock_pages(struct ocfs2_write_ctxt *wc)\n{\n\tint i;\n\n\t/*\n\t * w_target_locked is only set to true in the page_mkwrite() case.\n\t * The intent is to allow us to lock the target page from write_begin()\n\t * to write_end(). The caller must hold a ref on w_target_page.\n\t */\n\tif (wc->w_target_locked) {\n\t\tBUG_ON(!wc->w_target_page);\n\t\tfor (i = 0; i < wc->w_num_pages; i++) {\n\t\t\tif (wc->w_target_page == wc->w_pages[i]) {\n\t\t\t\twc->w_pages[i] = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tmark_page_accessed(wc->w_target_page);\n\t\tpage_cache_release(wc->w_target_page);\n\t}\n\tocfs2_unlock_and_free_pages(wc->w_pages, wc->w_num_pages);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void ufs_put_locked_page(struct page *page)\n{\n       unlock_page(page);\n       page_cache_release(page);\n}"
  },
  {
    "function_name": "ufs_set_inode_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "239-256",
    "snippet": "static inline void\nufs_set_inode_gid(struct super_block *sb, struct ufs_inode *inode, u32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\tinode->ui_u3.ui_44.ui_gid = cpu_to_fs32(sb, value);\n\t\tinode->ui_u1.oldids.ui_sgid =  cpu_to_fs16(sb, value);\n\t\tbreak;\n\tcase UFS_UID_EFT:\n\t\tinode->ui_u3.ui_sun.ui_gid = cpu_to_fs32(sb, value);\n\t\tif (value > 0xFFFF)\n\t\t\tvalue = 0xFFFF;\n\t\t/* Fall through */\n\tdefault:\n\t\tinode->ui_u1.oldids.ui_sgid =  cpu_to_fs16(sb, value);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_fs16",
          "args": [
            "sb",
            "value"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "88-95",
          "snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_fs32",
          "args": [
            "sb",
            "value"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "52-59",
          "snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void\nufs_set_inode_gid(struct super_block *sb, struct ufs_inode *inode, u32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\tinode->ui_u3.ui_44.ui_gid = cpu_to_fs32(sb, value);\n\t\tinode->ui_u1.oldids.ui_sgid =  cpu_to_fs16(sb, value);\n\t\tbreak;\n\tcase UFS_UID_EFT:\n\t\tinode->ui_u3.ui_sun.ui_gid = cpu_to_fs32(sb, value);\n\t\tif (value > 0xFFFF)\n\t\t\tvalue = 0xFFFF;\n\t\t/* Fall through */\n\tdefault:\n\t\tinode->ui_u1.oldids.ui_sgid =  cpu_to_fs16(sb, value);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "ufs_get_inode_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "224-237",
    "snippet": "static inline u32\nufs_get_inode_gid(struct super_block *sb, struct ufs_inode *inode)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_44.ui_gid);\n\tcase UFS_UID_EFT:\n\t\tif (inode->ui_u1.oldids.ui_suid == 0xFFFF)\n\t\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_sun.ui_gid);\n\t\t/* Fall through */\n\tdefault:\n\t\treturn fs16_to_cpu(sb, inode->ui_u1.oldids.ui_sgid);\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sb",
            "inode->ui_u1.oldids.ui_sgid"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "79-86",
          "snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "inode->ui_u3.ui_sun.ui_gid"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline u32\nufs_get_inode_gid(struct super_block *sb, struct ufs_inode *inode)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_44.ui_gid);\n\tcase UFS_UID_EFT:\n\t\tif (inode->ui_u1.oldids.ui_suid == 0xFFFF)\n\t\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_sun.ui_gid);\n\t\t/* Fall through */\n\tdefault:\n\t\treturn fs16_to_cpu(sb, inode->ui_u1.oldids.ui_sgid);\n\t}\n}"
  },
  {
    "function_name": "ufs_set_inode_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "205-222",
    "snippet": "static inline void\nufs_set_inode_uid(struct super_block *sb, struct ufs_inode *inode, u32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\tinode->ui_u3.ui_44.ui_uid = cpu_to_fs32(sb, value);\n\t\tinode->ui_u1.oldids.ui_suid = cpu_to_fs16(sb, value);\n\t\tbreak;\n\tcase UFS_UID_EFT:\n\t\tinode->ui_u3.ui_sun.ui_uid = cpu_to_fs32(sb, value);\n\t\tif (value > 0xFFFF)\n\t\t\tvalue = 0xFFFF;\n\t\t/* Fall through */\n\tdefault:\n\t\tinode->ui_u1.oldids.ui_suid = cpu_to_fs16(sb, value);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_fs16",
          "args": [
            "sb",
            "value"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "88-95",
          "snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_fs32",
          "args": [
            "sb",
            "value"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "52-59",
          "snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void\nufs_set_inode_uid(struct super_block *sb, struct ufs_inode *inode, u32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\tinode->ui_u3.ui_44.ui_uid = cpu_to_fs32(sb, value);\n\t\tinode->ui_u1.oldids.ui_suid = cpu_to_fs16(sb, value);\n\t\tbreak;\n\tcase UFS_UID_EFT:\n\t\tinode->ui_u3.ui_sun.ui_uid = cpu_to_fs32(sb, value);\n\t\tif (value > 0xFFFF)\n\t\t\tvalue = 0xFFFF;\n\t\t/* Fall through */\n\tdefault:\n\t\tinode->ui_u1.oldids.ui_suid = cpu_to_fs16(sb, value);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "ufs_get_inode_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "190-203",
    "snippet": "static inline u32\nufs_get_inode_uid(struct super_block *sb, struct ufs_inode *inode)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_44.ui_uid);\n\tcase UFS_UID_EFT:\n\t\tif (inode->ui_u1.oldids.ui_suid == 0xFFFF)\n\t\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_sun.ui_uid);\n\t\t/* Fall through */\n\tdefault:\n\t\treturn fs16_to_cpu(sb, inode->ui_u1.oldids.ui_suid);\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sb",
            "inode->ui_u1.oldids.ui_suid"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "79-86",
          "snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "inode->ui_u3.ui_sun.ui_uid"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline u32\nufs_get_inode_uid(struct super_block *sb, struct ufs_inode *inode)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_UID_MASK) {\n\tcase UFS_UID_44BSD:\n\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_44.ui_uid);\n\tcase UFS_UID_EFT:\n\t\tif (inode->ui_u1.oldids.ui_suid == 0xFFFF)\n\t\t\treturn fs32_to_cpu(sb, inode->ui_u3.ui_sun.ui_uid);\n\t\t/* Fall through */\n\tdefault:\n\t\treturn fs16_to_cpu(sb, inode->ui_u1.oldids.ui_suid);\n\t}\n}"
  },
  {
    "function_name": "ufs_set_de_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "154-188",
    "snippet": "static inline void\nufs_set_de_type(struct super_block *sb, struct ufs_dir_entry *de, int mode)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) != UFS_DE_44BSD)\n\t\treturn;\n\n\t/*\n\t * TODO turn this into a table lookup\n\t */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFSOCK:\n\t\tde->d_u.d_44.d_type = DT_SOCK;\n\t\tbreak;\n\tcase S_IFLNK:\n\t\tde->d_u.d_44.d_type = DT_LNK;\n\t\tbreak;\n\tcase S_IFREG:\n\t\tde->d_u.d_44.d_type = DT_REG;\n\t\tbreak;\n\tcase S_IFBLK:\n\t\tde->d_u.d_44.d_type = DT_BLK;\n\t\tbreak;\n\tcase S_IFDIR:\n\t\tde->d_u.d_44.d_type = DT_DIR;\n\t\tbreak;\n\tcase S_IFCHR:\n\t\tde->d_u.d_44.d_type = DT_CHR;\n\t\tbreak;\n\tcase S_IFIFO:\n\t\tde->d_u.d_44.d_type = DT_FIFO;\n\t\tbreak;\n\tdefault:\n\t\tde->d_u.d_44.d_type = DT_UNKNOWN;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void\nufs_set_de_type(struct super_block *sb, struct ufs_dir_entry *de, int mode)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) != UFS_DE_44BSD)\n\t\treturn;\n\n\t/*\n\t * TODO turn this into a table lookup\n\t */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFSOCK:\n\t\tde->d_u.d_44.d_type = DT_SOCK;\n\t\tbreak;\n\tcase S_IFLNK:\n\t\tde->d_u.d_44.d_type = DT_LNK;\n\t\tbreak;\n\tcase S_IFREG:\n\t\tde->d_u.d_44.d_type = DT_REG;\n\t\tbreak;\n\tcase S_IFBLK:\n\t\tde->d_u.d_44.d_type = DT_BLK;\n\t\tbreak;\n\tcase S_IFDIR:\n\t\tde->d_u.d_44.d_type = DT_DIR;\n\t\tbreak;\n\tcase S_IFCHR:\n\t\tde->d_u.d_44.d_type = DT_CHR;\n\t\tbreak;\n\tcase S_IFIFO:\n\t\tde->d_u.d_44.d_type = DT_FIFO;\n\t\tbreak;\n\tdefault:\n\t\tde->d_u.d_44.d_type = DT_UNKNOWN;\n\t}\n}"
  },
  {
    "function_name": "ufs_set_de_namlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "145-152",
    "snippet": "static inline void\nufs_set_de_namlen(struct super_block *sb, struct ufs_dir_entry *de, u16 value)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) == UFS_DE_OLD)\n\t\tde->d_u.d_namlen = cpu_to_fs16(sb, value);\n\telse\n\t\tde->d_u.d_44.d_namlen = value; /* XXX this seems wrong */\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_fs16",
          "args": [
            "sb",
            "value"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "88-95",
          "snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs16\ncpu_to_fs16(struct super_block *sbp, u16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs16)cpu_to_le16(n);\n\telse\n\t\treturn (__force __fs16)cpu_to_be16(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void\nufs_set_de_namlen(struct super_block *sb, struct ufs_dir_entry *de, u16 value)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) == UFS_DE_OLD)\n\t\tde->d_u.d_namlen = cpu_to_fs16(sb, value);\n\telse\n\t\tde->d_u.d_44.d_namlen = value; /* XXX this seems wrong */\n}"
  },
  {
    "function_name": "ufs_get_de_namlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "136-143",
    "snippet": "static inline u16\nufs_get_de_namlen(struct super_block *sb, struct ufs_dir_entry *de)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) == UFS_DE_OLD)\n\t\treturn fs16_to_cpu(sb, de->d_u.d_namlen);\n\telse\n\t\treturn de->d_u.d_44.d_namlen; /* XXX this seems wrong */\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs16_to_cpu",
          "args": [
            "sb",
            "de->d_u.d_namlen"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "fs16_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "79-86",
          "snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u16\nfs16_to_cpu(struct super_block *sbp, __fs16 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le16_to_cpu((__force __le16)n);\n\telse\n\t\treturn be16_to_cpu((__force __be16)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline u16\nufs_get_de_namlen(struct super_block *sb, struct ufs_dir_entry *de)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_DE_MASK) == UFS_DE_OLD)\n\t\treturn fs16_to_cpu(sb, de->d_u.d_namlen);\n\telse\n\t\treturn de->d_u.d_44.d_namlen; /* XXX this seems wrong */\n}"
  },
  {
    "function_name": "ufs_get_fs_qfmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "112-134",
    "snippet": "static inline u64\nufs_get_fs_qfmask(struct super_block *sb, struct ufs_super_block_third *usb3)\n{\n\t__fs64 tmp;\n\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\tcase UFS_ST_SUN:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sun.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sun.fs_qfmask[1];\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sunx86.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sunx86.fs_qfmask[1];\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_44.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_44.fs_qfmask[1];\n\t\tbreak;\n\t}\n\n\treturn fs64_to_cpu(sb, tmp);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "tmp"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "25-32",
          "snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\n\nstatic inline u64\nufs_get_fs_qfmask(struct super_block *sb, struct ufs_super_block_third *usb3)\n{\n\t__fs64 tmp;\n\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\tcase UFS_ST_SUN:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sun.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sun.fs_qfmask[1];\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sunx86.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sunx86.fs_qfmask[1];\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_44.fs_qfmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_44.fs_qfmask[1];\n\t\tbreak;\n\t}\n\n\treturn fs64_to_cpu(sb, tmp);\n}"
  },
  {
    "function_name": "ufs_get_fs_qbmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "88-110",
    "snippet": "static inline u64\nufs_get_fs_qbmask(struct super_block *sb, struct ufs_super_block_third *usb3)\n{\n\t__fs64 tmp;\n\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\tcase UFS_ST_SUN:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sun.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sun.fs_qbmask[1];\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sunx86.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sunx86.fs_qbmask[1];\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_44.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_44.fs_qbmask[1];\n\t\tbreak;\n\t}\n\n\treturn fs64_to_cpu(sb, tmp);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);",
      "extern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs64_to_cpu",
          "args": [
            "sb",
            "tmp"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "fs64_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "25-32",
          "snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u64\nfs64_to_cpu(struct super_block *sbp, __fs64 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le64_to_cpu((__force __le64)n);\n\telse\n\t\treturn be64_to_cpu((__force __be64)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern struct ufs_buffer_head * _ubh_bread_(struct ufs_sb_private_info *, struct super_block *, u64 , u64);\nextern struct ufs_buffer_head * ubh_bread_uspi(struct ufs_sb_private_info *, struct super_block *, u64, u64);\n\nstatic inline u64\nufs_get_fs_qbmask(struct super_block *sb, struct ufs_super_block_third *usb3)\n{\n\t__fs64 tmp;\n\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\tcase UFS_ST_SUN:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sun.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sun.fs_qbmask[1];\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_sunx86.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_sunx86.fs_qbmask[1];\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\t((__fs32 *)&tmp)[0] = usb3->fs_un2.fs_44.fs_qbmask[0];\n\t\t((__fs32 *)&tmp)[1] = usb3->fs_un2.fs_44.fs_qbmask[1];\n\t\tbreak;\n\t}\n\n\treturn fs64_to_cpu(sb, tmp);\n}"
  },
  {
    "function_name": "ufs_get_fs_npsect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "78-86",
    "snippet": "static inline u32\nufs_get_fs_npsect(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t  struct ufs_super_block_third *usb3)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_ST_MASK) == UFS_ST_SUNx86)\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_sunx86.fs_npsect);\n\telse\n\t\treturn fs32_to_cpu(sb, usb1->fs_u1.fs_sun.fs_npsect);\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "usb1->fs_u1.fs_sun.fs_npsect"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline u32\nufs_get_fs_npsect(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t  struct ufs_super_block_third *usb3)\n{\n\tif ((UFS_SB(sb)->s_flags & UFS_ST_MASK) == UFS_ST_SUNx86)\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_sunx86.fs_npsect);\n\telse\n\t\treturn fs32_to_cpu(sb, usb1->fs_u1.fs_sun.fs_npsect);\n}"
  },
  {
    "function_name": "ufs_set_fs_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "55-76",
    "snippet": "static inline void\nufs_set_fs_state(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t struct ufs_super_block_third *usb3, s32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\t\tif (fs32_to_cpu(sb, usb3->fs_postblformat) == UFS_42POSTBLFMT) {\n\t\t\tusb1->fs_u0.fs_sun.fs_state = cpu_to_fs32(sb, value);\n\t\t\tbreak;\n\t\t}\n\t\t/* Fall Through to UFS_ST_SUN */\n\tcase UFS_ST_SUN:\n\t\tusb3->fs_un2.fs_sun.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\tusb1->fs_u1.fs_sunx86.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\tusb3->fs_un2.fs_44.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_fs32",
          "args": [
            "sb",
            "value"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_to_fs32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "52-59",
          "snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __fs32\ncpu_to_fs32(struct super_block *sbp, u32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn (__force __fs32)cpu_to_le32(n);\n\telse\n\t\treturn (__force __fs32)cpu_to_be32(n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "usb3->fs_postblformat"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline void\nufs_set_fs_state(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t struct ufs_super_block_third *usb3, s32 value)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\t\tif (fs32_to_cpu(sb, usb3->fs_postblformat) == UFS_42POSTBLFMT) {\n\t\t\tusb1->fs_u0.fs_sun.fs_state = cpu_to_fs32(sb, value);\n\t\t\tbreak;\n\t\t}\n\t\t/* Fall Through to UFS_ST_SUN */\n\tcase UFS_ST_SUN:\n\t\tusb3->fs_un2.fs_sun.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\tcase UFS_ST_SUNx86:\n\t\tusb1->fs_u1.fs_sunx86.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\tcase UFS_ST_44BSD:\n\t\tusb3->fs_un2.fs_44.fs_state = cpu_to_fs32(sb, value);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "ufs_get_fs_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "36-53",
    "snippet": "static inline s32\nufs_get_fs_state(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t struct ufs_super_block_third *usb3)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\t\tif (fs32_to_cpu(sb, usb3->fs_postblformat) == UFS_42POSTBLFMT)\n\t\t\treturn fs32_to_cpu(sb, usb1->fs_u0.fs_sun.fs_state);\n\t\t/* Fall Through to UFS_ST_SUN */\n\tcase UFS_ST_SUN:\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_sun.fs_state);\n\tcase UFS_ST_SUNx86:\n\t\treturn fs32_to_cpu(sb, usb1->fs_u1.fs_sunx86.fs_state);\n\tcase UFS_ST_44BSD:\n\tdefault:\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_44.fs_state);\n\t}\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs32_to_cpu",
          "args": [
            "sb",
            "usb3->fs_un2.fs_44.fs_state"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "fs32_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/swab.h",
          "lines": "43-50",
          "snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline u32\nfs32_to_cpu(struct super_block *sbp, __fs32 n)\n{\n\tif (UFS_SB(sbp)->s_bytesex == BYTESEX_LE)\n\t\treturn le32_to_cpu((__force __le32)n);\n\telse\n\t\treturn be32_to_cpu((__force __be32)n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "UFS_SB",
          "args": [
            "sb"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nstatic inline s32\nufs_get_fs_state(struct super_block *sb, struct ufs_super_block_first *usb1,\n\t\t struct ufs_super_block_third *usb3)\n{\n\tswitch (UFS_SB(sb)->s_flags & UFS_ST_MASK) {\n\tcase UFS_ST_SUNOS:\n\t\tif (fs32_to_cpu(sb, usb3->fs_postblformat) == UFS_42POSTBLFMT)\n\t\t\treturn fs32_to_cpu(sb, usb1->fs_u0.fs_sun.fs_state);\n\t\t/* Fall Through to UFS_ST_SUN */\n\tcase UFS_ST_SUN:\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_sun.fs_state);\n\tcase UFS_ST_SUNx86:\n\t\treturn fs32_to_cpu(sb, usb1->fs_u1.fs_sunx86.fs_state);\n\tcase UFS_ST_44BSD:\n\tdefault:\n\t\treturn fs32_to_cpu(sb, usb3->fs_un2.fs_44.fs_state);\n\t}\n}"
  },
  {
    "function_name": "USPI_UBH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "26-29",
    "snippet": "static inline struct ufs_buffer_head *USPI_UBH(struct ufs_sb_private_info *spi)\n{\n\treturn &spi->s_ubh;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_brelse_uspi (struct ufs_sb_private_info *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_brelse_uspi (struct ufs_sb_private_info *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline struct ufs_buffer_head *USPI_UBH(struct ufs_sb_private_info *spi)\n{\n\treturn &spi->s_ubh;\n}"
  },
  {
    "function_name": "UCPI_UBH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ufs/util.h",
    "lines": "22-25",
    "snippet": "static inline struct ufs_buffer_head *UCPI_UBH(struct ufs_cg_private_info *cpi)\n{\n\treturn &cpi->c_ubh;\n}",
    "includes": [
      "#include \"swab.h\"",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern void ubh_brelse (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);",
      "extern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);",
      "extern void ubh_sync_block(struct ufs_buffer_head *);",
      "extern void ubh_bforget (struct ufs_buffer_head *);",
      "extern int  ubh_buffer_dirty (struct ufs_buffer_head *);",
      "extern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);",
      "extern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"swab.h\"\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n\nextern void ubh_brelse (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_dirty (struct ufs_buffer_head *);\nextern void ubh_mark_buffer_uptodate (struct ufs_buffer_head *, int);\nextern void ubh_sync_block(struct ufs_buffer_head *);\nextern void ubh_bforget (struct ufs_buffer_head *);\nextern int  ubh_buffer_dirty (struct ufs_buffer_head *);\nextern void _ubh_ubhcpymem_(struct ufs_sb_private_info *, unsigned char *, struct ufs_buffer_head *, unsigned);\nextern void _ubh_memcpyubh_(struct ufs_sb_private_info *, struct ufs_buffer_head *, unsigned char *, unsigned);\n\nstatic inline struct ufs_buffer_head *UCPI_UBH(struct ufs_cg_private_info *cpi)\n{\n\treturn &cpi->c_ubh;\n}"
  }
]