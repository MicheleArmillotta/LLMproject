[
  {
    "function_name": "exit_gfs2_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
    "lines": "226-250",
    "snippet": "static void __exit exit_gfs2_fs(void)\n{\n\tunregister_shrinker(&gfs2_qd_shrinker);\n\tgfs2_glock_exit();\n\tgfs2_unregister_debugfs();\n\tunregister_filesystem(&gfs2_fs_type);\n\tunregister_filesystem(&gfs2meta_fs_type);\n\tdestroy_workqueue(gfs_recovery_wq);\n\tdestroy_workqueue(gfs2_control_wq);\n\tdestroy_workqueue(gfs2_freeze_wq);\n\tlist_lru_destroy(&gfs2_qd_lru);\n\n\trcu_barrier();\n\n\tmempool_destroy(gfs2_page_pool);\n\tkmem_cache_destroy(gfs2_rsrv_cachep);\n\tkmem_cache_destroy(gfs2_quotad_cachep);\n\tkmem_cache_destroy(gfs2_rgrpd_cachep);\n\tkmem_cache_destroy(gfs2_bufdata_cachep);\n\tkmem_cache_destroy(gfs2_inode_cachep);\n\tkmem_cache_destroy(gfs2_glock_aspace_cachep);\n\tkmem_cache_destroy(gfs2_glock_cachep);\n\n\tgfs2_sys_uninit();\n}",
    "includes": [
      "#include \"glops.h\"",
      "#include \"dir.h\"",
      "#include \"recovery.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"util.h\"",
      "#include \"sys.h\"",
      "#include \"super.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/mempool.h>",
      "#include <linux/atomic.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *gfs2_control_wq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_sys_uninit",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_sys_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "707-710",
          "snippet": "void gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kset *gfs2_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\n\nvoid gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_glock_cachep"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_glock_aspace_cachep"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_inode_cachep"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_bufdata_cachep"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_rgrpd_cachep"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_quotad_cachep"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_rsrv_cachep"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mempool_destroy",
          "args": [
            "gfs2_page_pool"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "logfs_mempool_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/logfs.h",
          "lines": "730-734",
          "snippet": "static inline void logfs_mempool_destroy(mempool_t *pool)\n{\n\tif (pool)\n\t\tmempool_destroy(pool);\n}",
          "includes": [
            "#include \"logfs_abi.h\"",
            "#include <linux/mtd/mtd.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mempool.h>",
            "#include <linux/kernel.h>",
            "#include <linux/fs.h>",
            "#include <linux/crc32.h>",
            "#include <linux/btree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"logfs_abi.h\"\n#include <linux/mtd/mtd.h>\n#include <linux/pagemap.h>\n#include <linux/mempool.h>\n#include <linux/kernel.h>\n#include <linux/fs.h>\n#include <linux/crc32.h>\n#include <linux/btree.h>\n\nstatic inline void logfs_mempool_destroy(mempool_t *pool)\n{\n\tif (pool)\n\t\tmempool_destroy(pool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_barrier",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_lru_destroy",
          "args": [
            "&gfs2_qd_lru"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "gfs2_freeze_wq"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&gfs2meta_fs_type"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_unregister_debugfs",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_unregister_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "2106-2110",
          "snippet": "void gfs2_unregister_debugfs(void)\n{\n\tdebugfs_remove(gfs2_root);\n\tgfs2_root = NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *gfs2_root;",
            "static struct dentry *gfs2_root;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *gfs2_root;\nstatic struct dentry *gfs2_root;\n\nvoid gfs2_unregister_debugfs(void)\n{\n\tdebugfs_remove(gfs2_root);\n\tgfs2_root = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_exit",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1828-1833",
          "snippet": "void gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;",
            "struct workqueue_struct *gfs2_delete_workqueue;",
            "static struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\nstruct workqueue_struct *gfs2_delete_workqueue;\nstatic struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};\n\nvoid gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&gfs2_qd_shrinker"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct workqueue_struct *gfs2_control_wq;\n\nstatic void __exit exit_gfs2_fs(void)\n{\n\tunregister_shrinker(&gfs2_qd_shrinker);\n\tgfs2_glock_exit();\n\tgfs2_unregister_debugfs();\n\tunregister_filesystem(&gfs2_fs_type);\n\tunregister_filesystem(&gfs2meta_fs_type);\n\tdestroy_workqueue(gfs_recovery_wq);\n\tdestroy_workqueue(gfs2_control_wq);\n\tdestroy_workqueue(gfs2_freeze_wq);\n\tlist_lru_destroy(&gfs2_qd_lru);\n\n\trcu_barrier();\n\n\tmempool_destroy(gfs2_page_pool);\n\tkmem_cache_destroy(gfs2_rsrv_cachep);\n\tkmem_cache_destroy(gfs2_quotad_cachep);\n\tkmem_cache_destroy(gfs2_rgrpd_cachep);\n\tkmem_cache_destroy(gfs2_bufdata_cachep);\n\tkmem_cache_destroy(gfs2_inode_cachep);\n\tkmem_cache_destroy(gfs2_glock_aspace_cachep);\n\tkmem_cache_destroy(gfs2_glock_cachep);\n\n\tgfs2_sys_uninit();\n}"
  },
  {
    "function_name": "init_gfs2_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
    "lines": "76-219",
    "snippet": "static int __init init_gfs2_fs(void)\n{\n\tint error;\n\n\tgfs2_str2qstr(&gfs2_qdot, \".\");\n\tgfs2_str2qstr(&gfs2_qdotdot, \"..\");\n\tgfs2_quota_hash_init();\n\n\terror = gfs2_sys_init();\n\tif (error)\n\t\treturn error;\n\n\terror = list_lru_init(&gfs2_qd_lru);\n\tif (error)\n\t\tgoto fail_lru;\n\n\terror = gfs2_glock_init();\n\tif (error)\n\t\tgoto fail;\n\n\terror = -ENOMEM;\n\tgfs2_glock_cachep = kmem_cache_create(\"gfs2_glock\",\n\t\t\t\t\t      sizeof(struct gfs2_glock),\n\t\t\t\t\t      0, 0,\n\t\t\t\t\t      gfs2_init_glock_once);\n\tif (!gfs2_glock_cachep)\n\t\tgoto fail;\n\n\tgfs2_glock_aspace_cachep = kmem_cache_create(\"gfs2_glock(aspace)\",\n\t\t\t\t\tsizeof(struct gfs2_glock) +\n\t\t\t\t\tsizeof(struct address_space),\n\t\t\t\t\t0, 0, gfs2_init_gl_aspace_once);\n\n\tif (!gfs2_glock_aspace_cachep)\n\t\tgoto fail;\n\n\tgfs2_inode_cachep = kmem_cache_create(\"gfs2_inode\",\n\t\t\t\t\t      sizeof(struct gfs2_inode),\n\t\t\t\t\t      0,  SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t          SLAB_MEM_SPREAD,\n\t\t\t\t\t      gfs2_init_inode_once);\n\tif (!gfs2_inode_cachep)\n\t\tgoto fail;\n\n\tgfs2_bufdata_cachep = kmem_cache_create(\"gfs2_bufdata\",\n\t\t\t\t\t\tsizeof(struct gfs2_bufdata),\n\t\t\t\t\t        0, 0, NULL);\n\tif (!gfs2_bufdata_cachep)\n\t\tgoto fail;\n\n\tgfs2_rgrpd_cachep = kmem_cache_create(\"gfs2_rgrpd\",\n\t\t\t\t\t      sizeof(struct gfs2_rgrpd),\n\t\t\t\t\t      0, 0, NULL);\n\tif (!gfs2_rgrpd_cachep)\n\t\tgoto fail;\n\n\tgfs2_quotad_cachep = kmem_cache_create(\"gfs2_quotad\",\n\t\t\t\t\t       sizeof(struct gfs2_quota_data),\n\t\t\t\t\t       0, 0, NULL);\n\tif (!gfs2_quotad_cachep)\n\t\tgoto fail;\n\n\tgfs2_rsrv_cachep = kmem_cache_create(\"gfs2_mblk\",\n\t\t\t\t\t     sizeof(struct gfs2_blkreserv),\n\t\t\t\t\t       0, 0, NULL);\n\tif (!gfs2_rsrv_cachep)\n\t\tgoto fail;\n\n\tregister_shrinker(&gfs2_qd_shrinker);\n\n\terror = register_filesystem(&gfs2_fs_type);\n\tif (error)\n\t\tgoto fail;\n\n\terror = register_filesystem(&gfs2meta_fs_type);\n\tif (error)\n\t\tgoto fail_unregister;\n\n\terror = -ENOMEM;\n\tgfs_recovery_wq = alloc_workqueue(\"gfs_recovery\",\n\t\t\t\t\t  WQ_MEM_RECLAIM | WQ_FREEZABLE, 0);\n\tif (!gfs_recovery_wq)\n\t\tgoto fail_wq;\n\n\tgfs2_control_wq = alloc_workqueue(\"gfs2_control\",\n\t\t\t\t\t  WQ_UNBOUND | WQ_FREEZABLE, 0);\n\tif (!gfs2_control_wq)\n\t\tgoto fail_recovery;\n\n\tgfs2_freeze_wq = alloc_workqueue(\"freeze_workqueue\", 0, 0);\n\n\tif (!gfs2_freeze_wq)\n\t\tgoto fail_control;\n\n\tgfs2_page_pool = mempool_create_page_pool(64, 0);\n\tif (!gfs2_page_pool)\n\t\tgoto fail_freeze;\n\n\tgfs2_register_debugfs();\n\n\tpr_info(\"GFS2 installed\\n\");\n\n\treturn 0;\n\nfail_freeze:\n\tdestroy_workqueue(gfs2_freeze_wq);\nfail_control:\n\tdestroy_workqueue(gfs2_control_wq);\nfail_recovery:\n\tdestroy_workqueue(gfs_recovery_wq);\nfail_wq:\n\tunregister_filesystem(&gfs2meta_fs_type);\nfail_unregister:\n\tunregister_filesystem(&gfs2_fs_type);\nfail:\n\tlist_lru_destroy(&gfs2_qd_lru);\nfail_lru:\n\tunregister_shrinker(&gfs2_qd_shrinker);\n\tgfs2_glock_exit();\n\n\tif (gfs2_rsrv_cachep)\n\t\tkmem_cache_destroy(gfs2_rsrv_cachep);\n\n\tif (gfs2_quotad_cachep)\n\t\tkmem_cache_destroy(gfs2_quotad_cachep);\n\n\tif (gfs2_rgrpd_cachep)\n\t\tkmem_cache_destroy(gfs2_rgrpd_cachep);\n\n\tif (gfs2_bufdata_cachep)\n\t\tkmem_cache_destroy(gfs2_bufdata_cachep);\n\n\tif (gfs2_inode_cachep)\n\t\tkmem_cache_destroy(gfs2_inode_cachep);\n\n\tif (gfs2_glock_aspace_cachep)\n\t\tkmem_cache_destroy(gfs2_glock_aspace_cachep);\n\n\tif (gfs2_glock_cachep)\n\t\tkmem_cache_destroy(gfs2_glock_cachep);\n\n\tgfs2_sys_uninit();\n\treturn error;\n}",
    "includes": [
      "#include \"glops.h\"",
      "#include \"dir.h\"",
      "#include \"recovery.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"util.h\"",
      "#include \"sys.h\"",
      "#include \"super.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/mempool.h>",
      "#include <linux/atomic.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *gfs2_control_wq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_sys_uninit",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_sys_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "707-710",
          "snippet": "void gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kset *gfs2_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\n\nvoid gfs2_sys_uninit(void)\n{\n\tkset_unregister(gfs2_kset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_glock_cachep"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_glock_aspace_cachep"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_inode_cachep"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_bufdata_cachep"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_rgrpd_cachep"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_quotad_cachep"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "gfs2_rsrv_cachep"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_exit",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1828-1833",
          "snippet": "void gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;",
            "struct workqueue_struct *gfs2_delete_workqueue;",
            "static struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\nstruct workqueue_struct *gfs2_delete_workqueue;\nstatic struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};\n\nvoid gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&gfs2_qd_shrinker"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_lru_destroy",
          "args": [
            "&gfs2_qd_lru"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&gfs2_fs_type"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "gfs_recovery_wq"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"GFS2 installed\\n\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_register_debugfs",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_register_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "2100-2104",
          "snippet": "int gfs2_register_debugfs(void)\n{\n\tgfs2_root = debugfs_create_dir(\"gfs2\", NULL);\n\treturn gfs2_root ? 0 : -ENOMEM;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *gfs2_root;",
            "static struct dentry *gfs2_root;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *gfs2_root;\nstatic struct dentry *gfs2_root;\n\nint gfs2_register_debugfs(void)\n{\n\tgfs2_root = debugfs_create_dir(\"gfs2\", NULL);\n\treturn gfs2_root ? 0 : -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mempool_create_page_pool",
          "args": [
            "64",
            "0"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"freeze_workqueue\"",
            "0",
            "0"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"gfs2_control\"",
            "WQ_UNBOUND | WQ_FREEZABLE",
            "0"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"gfs_recovery\"",
            "WQ_MEM_RECLAIM | WQ_FREEZABLE",
            "0"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_mblk\"",
            "sizeof(struct gfs2_blkreserv)",
            "0",
            "0",
            "NULL"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_quotad\"",
            "sizeof(struct gfs2_quota_data)",
            "0",
            "0",
            "NULL"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_rgrpd\"",
            "sizeof(struct gfs2_rgrpd)",
            "0",
            "0",
            "NULL"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_bufdata\"",
            "sizeof(struct gfs2_bufdata)",
            "0",
            "0",
            "NULL"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_inode\"",
            "sizeof(struct gfs2_inode)",
            "0",
            "SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t          SLAB_MEM_SPREAD",
            "gfs2_init_inode_once"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_glock(aspace)\"",
            "sizeof(struct gfs2_glock) +\n\t\t\t\t\tsizeof(struct address_space)",
            "0",
            "0",
            "gfs2_init_gl_aspace_once"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"gfs2_glock\"",
            "sizeof(struct gfs2_glock)",
            "0",
            "0",
            "gfs2_init_glock_once"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_init",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1804-1826",
          "snippet": "int __init gfs2_glock_init(void)\n{\n\tunsigned i;\n\tfor(i = 0; i < GFS2_GL_HASH_SIZE; i++) {\n\t\tINIT_HLIST_BL_HEAD(&gl_hash_table[i]);\n\t}\n\n\tglock_workqueue = alloc_workqueue(\"glock_workqueue\", WQ_MEM_RECLAIM |\n\t\t\t\t\t  WQ_HIGHPRI | WQ_FREEZABLE, 0);\n\tif (!glock_workqueue)\n\t\treturn -ENOMEM;\n\tgfs2_delete_workqueue = alloc_workqueue(\"delete_workqueue\",\n\t\t\t\t\t\tWQ_MEM_RECLAIM | WQ_FREEZABLE,\n\t\t\t\t\t\t0);\n\tif (!gfs2_delete_workqueue) {\n\t\tdestroy_workqueue(glock_workqueue);\n\t\treturn -ENOMEM;\n\t}\n\n\tregister_shrinker(&glock_shrinker);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
          ],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;",
            "struct workqueue_struct *gfs2_delete_workqueue;",
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];",
            "static struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic struct workqueue_struct *glock_workqueue;\nstruct workqueue_struct *gfs2_delete_workqueue;\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\nstatic struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};\n\nint __init gfs2_glock_init(void)\n{\n\tunsigned i;\n\tfor(i = 0; i < GFS2_GL_HASH_SIZE; i++) {\n\t\tINIT_HLIST_BL_HEAD(&gl_hash_table[i]);\n\t}\n\n\tglock_workqueue = alloc_workqueue(\"glock_workqueue\", WQ_MEM_RECLAIM |\n\t\t\t\t\t  WQ_HIGHPRI | WQ_FREEZABLE, 0);\n\tif (!glock_workqueue)\n\t\treturn -ENOMEM;\n\tgfs2_delete_workqueue = alloc_workqueue(\"delete_workqueue\",\n\t\t\t\t\t\tWQ_MEM_RECLAIM | WQ_FREEZABLE,\n\t\t\t\t\t\t0);\n\tif (!gfs2_delete_workqueue) {\n\t\tdestroy_workqueue(glock_workqueue);\n\t\treturn -ENOMEM;\n\t}\n\n\tregister_shrinker(&glock_shrinker);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_lru_init",
          "args": [
            "&gfs2_qd_lru"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_sys_init",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_sys_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "699-705",
          "snippet": "int gfs2_sys_init(void)\n{\n\tgfs2_kset = kset_create_and_add(\"gfs2\", &gfs2_uevent_ops, fs_kobj);\n\tif (!gfs2_kset)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kset *gfs2_kset;",
            "static const struct kset_uevent_ops gfs2_uevent_ops = {\n\t.uevent = gfs2_uevent,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic struct kset *gfs2_kset;\nstatic const struct kset_uevent_ops gfs2_uevent_ops = {\n\t.uevent = gfs2_uevent,\n};\n\nint gfs2_sys_init(void)\n{\n\tgfs2_kset = kset_create_and_add(\"gfs2\", &gfs2_uevent_ops, fs_kobj);\n\tif (!gfs2_kset)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_quota_hash_init",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_quota_hash_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1646-1652",
          "snippet": "void __init gfs2_quota_hash_init(void)\n{\n\tunsigned i;\n\n\tfor(i = 0; i < GFS2_QD_HASH_SIZE; i++)\n\t\tINIT_HLIST_BL_HEAD(&qd_hash_table[i]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_QD_HASH_SIZE       (1 << GFS2_QD_HASH_SHIFT)"
          ],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_QD_HASH_SIZE       (1 << GFS2_QD_HASH_SHIFT)\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nvoid __init gfs2_quota_hash_init(void)\n{\n\tunsigned i;\n\n\tfor(i = 0; i < GFS2_QD_HASH_SIZE; i++)\n\t\tINIT_HLIST_BL_HEAD(&qd_hash_table[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_str2qstr",
          "args": [
            "&gfs2_qdotdot",
            "\"..\""
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_str2qstr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/dir.h",
          "lines": "63-68",
          "snippet": "static inline void gfs2_str2qstr(struct qstr *name, const char *fname)\n{\n\tname->name = fname;\n\tname->len = strlen(fname);\n\tname->hash = gfs2_disk_hash(name->name, name->len);\n}",
          "includes": [
            "#include <linux/crc32.h>",
            "#include <linux/dcache.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crc32.h>\n#include <linux/dcache.h>\n\nstatic inline void gfs2_str2qstr(struct qstr *name, const char *fname)\n{\n\tname->name = fname;\n\tname->len = strlen(fname);\n\tname->hash = gfs2_disk_hash(name->name, name->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct workqueue_struct *gfs2_control_wq;\n\nstatic int __init init_gfs2_fs(void)\n{\n\tint error;\n\n\tgfs2_str2qstr(&gfs2_qdot, \".\");\n\tgfs2_str2qstr(&gfs2_qdotdot, \"..\");\n\tgfs2_quota_hash_init();\n\n\terror = gfs2_sys_init();\n\tif (error)\n\t\treturn error;\n\n\terror = list_lru_init(&gfs2_qd_lru);\n\tif (error)\n\t\tgoto fail_lru;\n\n\terror = gfs2_glock_init();\n\tif (error)\n\t\tgoto fail;\n\n\terror = -ENOMEM;\n\tgfs2_glock_cachep = kmem_cache_create(\"gfs2_glock\",\n\t\t\t\t\t      sizeof(struct gfs2_glock),\n\t\t\t\t\t      0, 0,\n\t\t\t\t\t      gfs2_init_glock_once);\n\tif (!gfs2_glock_cachep)\n\t\tgoto fail;\n\n\tgfs2_glock_aspace_cachep = kmem_cache_create(\"gfs2_glock(aspace)\",\n\t\t\t\t\tsizeof(struct gfs2_glock) +\n\t\t\t\t\tsizeof(struct address_space),\n\t\t\t\t\t0, 0, gfs2_init_gl_aspace_once);\n\n\tif (!gfs2_glock_aspace_cachep)\n\t\tgoto fail;\n\n\tgfs2_inode_cachep = kmem_cache_create(\"gfs2_inode\",\n\t\t\t\t\t      sizeof(struct gfs2_inode),\n\t\t\t\t\t      0,  SLAB_RECLAIM_ACCOUNT|\n\t\t\t\t\t          SLAB_MEM_SPREAD,\n\t\t\t\t\t      gfs2_init_inode_once);\n\tif (!gfs2_inode_cachep)\n\t\tgoto fail;\n\n\tgfs2_bufdata_cachep = kmem_cache_create(\"gfs2_bufdata\",\n\t\t\t\t\t\tsizeof(struct gfs2_bufdata),\n\t\t\t\t\t        0, 0, NULL);\n\tif (!gfs2_bufdata_cachep)\n\t\tgoto fail;\n\n\tgfs2_rgrpd_cachep = kmem_cache_create(\"gfs2_rgrpd\",\n\t\t\t\t\t      sizeof(struct gfs2_rgrpd),\n\t\t\t\t\t      0, 0, NULL);\n\tif (!gfs2_rgrpd_cachep)\n\t\tgoto fail;\n\n\tgfs2_quotad_cachep = kmem_cache_create(\"gfs2_quotad\",\n\t\t\t\t\t       sizeof(struct gfs2_quota_data),\n\t\t\t\t\t       0, 0, NULL);\n\tif (!gfs2_quotad_cachep)\n\t\tgoto fail;\n\n\tgfs2_rsrv_cachep = kmem_cache_create(\"gfs2_mblk\",\n\t\t\t\t\t     sizeof(struct gfs2_blkreserv),\n\t\t\t\t\t       0, 0, NULL);\n\tif (!gfs2_rsrv_cachep)\n\t\tgoto fail;\n\n\tregister_shrinker(&gfs2_qd_shrinker);\n\n\terror = register_filesystem(&gfs2_fs_type);\n\tif (error)\n\t\tgoto fail;\n\n\terror = register_filesystem(&gfs2meta_fs_type);\n\tif (error)\n\t\tgoto fail_unregister;\n\n\terror = -ENOMEM;\n\tgfs_recovery_wq = alloc_workqueue(\"gfs_recovery\",\n\t\t\t\t\t  WQ_MEM_RECLAIM | WQ_FREEZABLE, 0);\n\tif (!gfs_recovery_wq)\n\t\tgoto fail_wq;\n\n\tgfs2_control_wq = alloc_workqueue(\"gfs2_control\",\n\t\t\t\t\t  WQ_UNBOUND | WQ_FREEZABLE, 0);\n\tif (!gfs2_control_wq)\n\t\tgoto fail_recovery;\n\n\tgfs2_freeze_wq = alloc_workqueue(\"freeze_workqueue\", 0, 0);\n\n\tif (!gfs2_freeze_wq)\n\t\tgoto fail_control;\n\n\tgfs2_page_pool = mempool_create_page_pool(64, 0);\n\tif (!gfs2_page_pool)\n\t\tgoto fail_freeze;\n\n\tgfs2_register_debugfs();\n\n\tpr_info(\"GFS2 installed\\n\");\n\n\treturn 0;\n\nfail_freeze:\n\tdestroy_workqueue(gfs2_freeze_wq);\nfail_control:\n\tdestroy_workqueue(gfs2_control_wq);\nfail_recovery:\n\tdestroy_workqueue(gfs_recovery_wq);\nfail_wq:\n\tunregister_filesystem(&gfs2meta_fs_type);\nfail_unregister:\n\tunregister_filesystem(&gfs2_fs_type);\nfail:\n\tlist_lru_destroy(&gfs2_qd_lru);\nfail_lru:\n\tunregister_shrinker(&gfs2_qd_shrinker);\n\tgfs2_glock_exit();\n\n\tif (gfs2_rsrv_cachep)\n\t\tkmem_cache_destroy(gfs2_rsrv_cachep);\n\n\tif (gfs2_quotad_cachep)\n\t\tkmem_cache_destroy(gfs2_quotad_cachep);\n\n\tif (gfs2_rgrpd_cachep)\n\t\tkmem_cache_destroy(gfs2_rgrpd_cachep);\n\n\tif (gfs2_bufdata_cachep)\n\t\tkmem_cache_destroy(gfs2_bufdata_cachep);\n\n\tif (gfs2_inode_cachep)\n\t\tkmem_cache_destroy(gfs2_inode_cachep);\n\n\tif (gfs2_glock_aspace_cachep)\n\t\tkmem_cache_destroy(gfs2_glock_aspace_cachep);\n\n\tif (gfs2_glock_cachep)\n\t\tkmem_cache_destroy(gfs2_glock_cachep);\n\n\tgfs2_sys_uninit();\n\treturn error;\n}"
  },
  {
    "function_name": "gfs2_init_gl_aspace_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
    "lines": "61-68",
    "snippet": "static void gfs2_init_gl_aspace_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\tstruct address_space *mapping = (struct address_space *)(gl + 1);\n\n\tgfs2_init_glock_once(gl);\n\taddress_space_init_once(mapping);\n}",
    "includes": [
      "#include \"glops.h\"",
      "#include \"dir.h\"",
      "#include \"recovery.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"util.h\"",
      "#include \"sys.h\"",
      "#include \"super.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/mempool.h>",
      "#include <linux/atomic.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "address_space_init_once",
          "args": [
            "mapping"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "address_space_init_once",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "338-347",
          "snippet": "void address_space_init_once(struct address_space *mapping)\n{\n\tmemset(mapping, 0, sizeof(*mapping));\n\tINIT_RADIX_TREE(&mapping->page_tree, GFP_ATOMIC);\n\tspin_lock_init(&mapping->tree_lock);\n\tinit_rwsem(&mapping->i_mmap_rwsem);\n\tINIT_LIST_HEAD(&mapping->private_list);\n\tspin_lock_init(&mapping->private_lock);\n\tmapping->i_mmap = RB_ROOT;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nvoid address_space_init_once(struct address_space *mapping)\n{\n\tmemset(mapping, 0, sizeof(*mapping));\n\tINIT_RADIX_TREE(&mapping->page_tree, GFP_ATOMIC);\n\tspin_lock_init(&mapping->tree_lock);\n\tinit_rwsem(&mapping->i_mmap_rwsem);\n\tINIT_LIST_HEAD(&mapping->private_list);\n\tspin_lock_init(&mapping->private_lock);\n\tmapping->i_mmap = RB_ROOT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_init_glock_once",
          "args": [
            "gl"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_init_glock_once",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
          "lines": "48-59",
          "snippet": "static void gfs2_init_glock_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\n\tINIT_HLIST_BL_NODE(&gl->gl_list);\n\tspin_lock_init(&gl->gl_spin);\n\tINIT_LIST_HEAD(&gl->gl_holders);\n\tINIT_LIST_HEAD(&gl->gl_lru);\n\tINIT_LIST_HEAD(&gl->gl_ail_list);\n\tatomic_set(&gl->gl_ail_count, 0);\n\tatomic_set(&gl->gl_revokes, 0);\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"dir.h\"",
            "#include \"recovery.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"util.h\"",
            "#include \"sys.h\"",
            "#include \"super.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/mempool.h>",
            "#include <linux/atomic.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic void gfs2_init_glock_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\n\tINIT_HLIST_BL_NODE(&gl->gl_list);\n\tspin_lock_init(&gl->gl_spin);\n\tINIT_LIST_HEAD(&gl->gl_holders);\n\tINIT_LIST_HEAD(&gl->gl_lru);\n\tINIT_LIST_HEAD(&gl->gl_ail_list);\n\tatomic_set(&gl->gl_ail_count, 0);\n\tatomic_set(&gl->gl_revokes, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic void gfs2_init_gl_aspace_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\tstruct address_space *mapping = (struct address_space *)(gl + 1);\n\n\tgfs2_init_glock_once(gl);\n\taddress_space_init_once(mapping);\n}"
  },
  {
    "function_name": "gfs2_init_glock_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
    "lines": "48-59",
    "snippet": "static void gfs2_init_glock_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\n\tINIT_HLIST_BL_NODE(&gl->gl_list);\n\tspin_lock_init(&gl->gl_spin);\n\tINIT_LIST_HEAD(&gl->gl_holders);\n\tINIT_LIST_HEAD(&gl->gl_lru);\n\tINIT_LIST_HEAD(&gl->gl_ail_list);\n\tatomic_set(&gl->gl_ail_count, 0);\n\tatomic_set(&gl->gl_revokes, 0);\n}",
    "includes": [
      "#include \"glops.h\"",
      "#include \"dir.h\"",
      "#include \"recovery.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"util.h\"",
      "#include \"sys.h\"",
      "#include \"super.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/mempool.h>",
      "#include <linux/atomic.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&gl->gl_revokes",
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&gl->gl_ail_count",
            "0"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&gl->gl_ail_list"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_NODE",
          "args": [
            "&gl->gl_list"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic void gfs2_init_glock_once(void *foo)\n{\n\tstruct gfs2_glock *gl = foo;\n\n\tINIT_HLIST_BL_NODE(&gl->gl_list);\n\tspin_lock_init(&gl->gl_spin);\n\tINIT_LIST_HEAD(&gl->gl_holders);\n\tINIT_LIST_HEAD(&gl->gl_lru);\n\tINIT_LIST_HEAD(&gl->gl_ail_list);\n\tatomic_set(&gl->gl_ail_count, 0);\n\tatomic_set(&gl->gl_revokes, 0);\n}"
  },
  {
    "function_name": "gfs2_init_inode_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/main.c",
    "lines": "37-46",
    "snippet": "static void gfs2_init_inode_once(void *foo)\n{\n\tstruct gfs2_inode *ip = foo;\n\n\tinode_init_once(&ip->i_inode);\n\tinit_rwsem(&ip->i_rw_mutex);\n\tINIT_LIST_HEAD(&ip->i_trunc_list);\n\tip->i_res = NULL;\n\tip->i_hash_cache = NULL;\n}",
    "includes": [
      "#include \"glops.h\"",
      "#include \"dir.h\"",
      "#include \"recovery.h\"",
      "#include \"quota.h\"",
      "#include \"glock.h\"",
      "#include \"util.h\"",
      "#include \"sys.h\"",
      "#include \"super.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/mempool.h>",
      "#include <linux/atomic.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ip->i_trunc_list"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_rwsem",
          "args": [
            "&ip->i_rw_mutex"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_init_once",
          "args": [
            "&ip->i_inode"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "inode_init_once",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "355-367",
          "snippet": "void inode_init_once(struct inode *inode)\n{\n\tmemset(inode, 0, sizeof(*inode));\n\tINIT_HLIST_NODE(&inode->i_hash);\n\tINIT_LIST_HEAD(&inode->i_devices);\n\tINIT_LIST_HEAD(&inode->i_wb_list);\n\tINIT_LIST_HEAD(&inode->i_lru);\n\taddress_space_init_once(&inode->i_data);\n\ti_size_ordered_init(inode);\n#ifdef CONFIG_FSNOTIFY\n\tINIT_HLIST_HEAD(&inode->i_fsnotify_marks);\n#endif\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid inode_init_once(struct inode *inode)\n{\n\tmemset(inode, 0, sizeof(*inode));\n\tINIT_HLIST_NODE(&inode->i_hash);\n\tINIT_LIST_HEAD(&inode->i_devices);\n\tINIT_LIST_HEAD(&inode->i_wb_list);\n\tINIT_LIST_HEAD(&inode->i_lru);\n\taddress_space_init_once(&inode->i_data);\n\ti_size_ordered_init(inode);\n#ifdef CONFIG_FSNOTIFY\n\tINIT_HLIST_HEAD(&inode->i_fsnotify_marks);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"glops.h\"\n#include \"dir.h\"\n#include \"recovery.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"util.h\"\n#include \"sys.h\"\n#include \"super.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/mempool.h>\n#include <linux/atomic.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic void gfs2_init_inode_once(void *foo)\n{\n\tstruct gfs2_inode *ip = foo;\n\n\tinode_init_once(&ip->i_inode);\n\tinit_rwsem(&ip->i_rw_mutex);\n\tINIT_LIST_HEAD(&ip->i_trunc_list);\n\tip->i_res = NULL;\n\tip->i_hash_cache = NULL;\n}"
  }
]