[
  {
    "function_name": "vxfs_read_olt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
    "lines": "76-130",
    "snippet": "int\nvxfs_read_olt(struct super_block *sbp, u_long bsize)\n{\n\tstruct vxfs_sb_info\t*infp = VXFS_SBI(sbp);\n\tstruct buffer_head\t*bp;\n\tstruct vxfs_olt\t\t*op;\n\tchar\t\t\t*oaddr, *eaddr;\n\n\n\tbp = sb_bread(sbp, vxfs_oblock(sbp, infp->vsi_oltext, bsize));\n\tif (!bp || !bp->b_data)\n\t\tgoto fail;\n\n\top = (struct vxfs_olt *)bp->b_data;\n\tif (op->olt_magic != VXFS_OLT_MAGIC) {\n\t\tprintk(KERN_NOTICE \"vxfs: ivalid olt magic number\\n\");\n\t\tgoto fail;\n\t}\n\n\t/*\n\t * It is in theory possible that vsi_oltsize is > 1.\n\t * I've not seen any such filesystem yet and I'm lazy..  --hch\n\t */\n\tif (infp->vsi_oltsize > 1) {\n\t\tprintk(KERN_NOTICE \"vxfs: oltsize > 1 detected.\\n\");\n\t\tprintk(KERN_NOTICE \"vxfs: please notify hch@infradead.org\\n\");\n\t\tgoto fail;\n\t}\n\n\toaddr = bp->b_data + op->olt_size;\n\teaddr = bp->b_data + (infp->vsi_oltsize * sbp->s_blocksize);\n\n\twhile (oaddr < eaddr) {\n\t\tstruct vxfs_oltcommon\t*ocp =\n\t\t\t(struct vxfs_oltcommon *)oaddr;\n\t\t\n\t\tswitch (ocp->olt_type) {\n\t\tcase VXFS_OLT_FSHEAD:\n\t\t\tvxfs_get_fshead((struct vxfs_oltfshead *)oaddr, infp);\n\t\t\tbreak;\n\t\tcase VXFS_OLT_ILIST:\n\t\t\tvxfs_get_ilist((struct vxfs_oltilist *)oaddr, infp);\n\t\t\tbreak;\n\t\t}\n\n\t\toaddr += ocp->olt_size;\n\t}\n\n\tbrelse(bp);\n\treturn 0;\n\nfail:\n\tbrelse(bp);\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_olt.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bp"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_get_ilist",
          "args": [
            "(struct vxfs_oltilist *)oaddr",
            "infp"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_get_ilist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
          "lines": "49-54",
          "snippet": "static inline void\nvxfs_get_ilist(struct vxfs_oltilist *ilistp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_iext);\n\tinfp->vsi_iext = ilistp->olt_iext[0]; \n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_olt.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nvxfs_get_ilist(struct vxfs_oltilist *ilistp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_iext);\n\tinfp->vsi_iext = ilistp->olt_iext[0]; \n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_get_fshead",
          "args": [
            "(struct vxfs_oltfshead *)oaddr",
            "infp"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_get_fshead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
          "lines": "42-47",
          "snippet": "static inline void\nvxfs_get_fshead(struct vxfs_oltfshead *fshp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_fshino);\n\tinfp->vsi_fshino = fshp->olt_fsino[0];\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_olt.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nvxfs_get_fshead(struct vxfs_oltfshead *fshp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_fshino);\n\tinfp->vsi_fshino = fshp->olt_fsino[0];\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"vxfs: please notify hch@infradead.org\\n\""
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sbp",
            "vxfs_oblock(sbp, infp->vsi_oltext, bsize)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_oblock",
          "args": [
            "sbp",
            "infp->vsi_oltext",
            "bsize"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_oblock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
          "lines": "56-61",
          "snippet": "static inline u_long\nvxfs_oblock(struct super_block *sbp, daddr_t block, u_long bsize)\n{\n\tBUG_ON(sbp->s_blocksize % bsize);\n\treturn (block * (sbp->s_blocksize / bsize));\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_olt.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline u_long\nvxfs_oblock(struct super_block *sbp, daddr_t block, u_long bsize)\n{\n\tBUG_ON(sbp->s_blocksize % bsize);\n\treturn (block * (sbp->s_blocksize / bsize));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_SBI",
          "args": [
            "sbp"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nint\nvxfs_read_olt(struct super_block *sbp, u_long bsize)\n{\n\tstruct vxfs_sb_info\t*infp = VXFS_SBI(sbp);\n\tstruct buffer_head\t*bp;\n\tstruct vxfs_olt\t\t*op;\n\tchar\t\t\t*oaddr, *eaddr;\n\n\n\tbp = sb_bread(sbp, vxfs_oblock(sbp, infp->vsi_oltext, bsize));\n\tif (!bp || !bp->b_data)\n\t\tgoto fail;\n\n\top = (struct vxfs_olt *)bp->b_data;\n\tif (op->olt_magic != VXFS_OLT_MAGIC) {\n\t\tprintk(KERN_NOTICE \"vxfs: ivalid olt magic number\\n\");\n\t\tgoto fail;\n\t}\n\n\t/*\n\t * It is in theory possible that vsi_oltsize is > 1.\n\t * I've not seen any such filesystem yet and I'm lazy..  --hch\n\t */\n\tif (infp->vsi_oltsize > 1) {\n\t\tprintk(KERN_NOTICE \"vxfs: oltsize > 1 detected.\\n\");\n\t\tprintk(KERN_NOTICE \"vxfs: please notify hch@infradead.org\\n\");\n\t\tgoto fail;\n\t}\n\n\toaddr = bp->b_data + op->olt_size;\n\teaddr = bp->b_data + (infp->vsi_oltsize * sbp->s_blocksize);\n\n\twhile (oaddr < eaddr) {\n\t\tstruct vxfs_oltcommon\t*ocp =\n\t\t\t(struct vxfs_oltcommon *)oaddr;\n\t\t\n\t\tswitch (ocp->olt_type) {\n\t\tcase VXFS_OLT_FSHEAD:\n\t\t\tvxfs_get_fshead((struct vxfs_oltfshead *)oaddr, infp);\n\t\t\tbreak;\n\t\tcase VXFS_OLT_ILIST:\n\t\t\tvxfs_get_ilist((struct vxfs_oltilist *)oaddr, infp);\n\t\t\tbreak;\n\t\t}\n\n\t\toaddr += ocp->olt_size;\n\t}\n\n\tbrelse(bp);\n\treturn 0;\n\nfail:\n\tbrelse(bp);\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "vxfs_oblock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
    "lines": "56-61",
    "snippet": "static inline u_long\nvxfs_oblock(struct super_block *sbp, daddr_t block, u_long bsize)\n{\n\tBUG_ON(sbp->s_blocksize % bsize);\n\treturn (block * (sbp->s_blocksize / bsize));\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_olt.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "sbp->s_blocksize % bsize"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline u_long\nvxfs_oblock(struct super_block *sbp, daddr_t block, u_long bsize)\n{\n\tBUG_ON(sbp->s_blocksize % bsize);\n\treturn (block * (sbp->s_blocksize / bsize));\n}"
  },
  {
    "function_name": "vxfs_get_ilist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
    "lines": "49-54",
    "snippet": "static inline void\nvxfs_get_ilist(struct vxfs_oltilist *ilistp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_iext);\n\tinfp->vsi_iext = ilistp->olt_iext[0]; \n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_olt.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "infp->vsi_iext"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nvxfs_get_ilist(struct vxfs_oltilist *ilistp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_iext);\n\tinfp->vsi_iext = ilistp->olt_iext[0]; \n}"
  },
  {
    "function_name": "vxfs_get_fshead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_olt.c",
    "lines": "42-47",
    "snippet": "static inline void\nvxfs_get_fshead(struct vxfs_oltfshead *fshp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_fshino);\n\tinfp->vsi_fshino = fshp->olt_fsino[0];\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_olt.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "infp->vsi_fshino"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_olt.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nvxfs_get_fshead(struct vxfs_oltfshead *fshp, struct vxfs_sb_info *infp)\n{\n\tBUG_ON(infp->vsi_fshino);\n\tinfp->vsi_fshino = fshp->olt_fsino[0];\n}"
  }
]