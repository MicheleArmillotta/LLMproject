[
  {
    "function_name": "do_compat_pselect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1348-1397",
    "snippet": "static long do_compat_pselect(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct compat_timespec __user *tsp, compat_sigset_t __user *sigmask,\n\tcompat_size_t sigsetsize)\n{\n\tcompat_sigset_t ss32;\n\tsigset_t ksigmask, sigsaved;\n\tstruct compat_timespec ts;\n\tstruct timespec end_time, *to = NULL;\n\tint ret;\n\n\tif (tsp) {\n\t\tif (copy_from_user(&ts, tsp, sizeof(ts)))\n\t\t\treturn -EFAULT;\n\n\t\tto = &end_time;\n\t\tif (poll_select_set_timeout(to, ts.tv_sec, ts.tv_nsec))\n\t\t\treturn -EINVAL;\n\t}\n\n\tif (sigmask) {\n\t\tif (sigsetsize != sizeof(compat_sigset_t))\n\t\t\treturn -EINVAL;\n\t\tif (copy_from_user(&ss32, sigmask, sizeof(ss32)))\n\t\t\treturn -EFAULT;\n\t\tsigset_from_compat(&ksigmask, &ss32);\n\n\t\tsigdelsetmask(&ksigmask, sigmask(SIGKILL)|sigmask(SIGSTOP));\n\t\tsigprocmask(SIG_SETMASK, &ksigmask, &sigsaved);\n\t}\n\n\tret = compat_core_sys_select(n, inp, outp, exp, to);\n\tret = poll_select_copy_remaining(&end_time, tsp, 0, ret);\n\n\tif (ret == -ERESTARTNOHAND) {\n\t\t/*\n\t\t * Don't restore the signal mask yet. Let do_signal() deliver\n\t\t * the signal on the way back to userspace, before the signal\n\t\t * mask is restored.\n\t\t */\n\t\tif (sigmask) {\n\t\t\tmemcpy(&current->saved_sigmask, &sigsaved,\n\t\t\t\t\tsizeof(sigsaved));\n\t\t\tset_restore_sigmask();\n\t\t}\n\t} else if (sigmask)\n\t\tsigprocmask(SIG_SETMASK, &sigsaved, NULL);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_SETMASK",
            "&sigsaved",
            "NULL"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_restore_sigmask",
          "args": [],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&current->saved_sigmask",
            "&sigsaved",
            "sizeof(sigsaved)"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poll_select_copy_remaining",
          "args": [
            "&end_time",
            "tsp",
            "0",
            "ret"
          ],
          "line": 1380
        },
        "resolved": true,
        "details": {
          "function_name": "poll_select_copy_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "1106-1155",
          "snippet": "static int poll_select_copy_remaining(struct timespec *end_time, void __user *p,\n\t\t\t\t      int timeval, int ret)\n{\n\tstruct timespec ts;\n\n\tif (!p)\n\t\treturn ret;\n\n\tif (current->personality & STICKY_TIMEOUTS)\n\t\tgoto sticky;\n\n\t/* No update for zero timeout */\n\tif (!end_time->tv_sec && !end_time->tv_nsec)\n\t\treturn ret;\n\n\tktime_get_ts(&ts);\n\tts = timespec_sub(*end_time, ts);\n\tif (ts.tv_sec < 0)\n\t\tts.tv_sec = ts.tv_nsec = 0;\n\n\tif (timeval) {\n\t\tstruct compat_timeval rtv;\n\n\t\trtv.tv_sec = ts.tv_sec;\n\t\trtv.tv_usec = ts.tv_nsec / NSEC_PER_USEC;\n\n\t\tif (!copy_to_user(p, &rtv, sizeof(rtv)))\n\t\t\treturn ret;\n\t} else {\n\t\tstruct compat_timespec rts;\n\n\t\trts.tv_sec = ts.tv_sec;\n\t\trts.tv_nsec = ts.tv_nsec;\n\n\t\tif (!copy_to_user(p, &rts, sizeof(rts)))\n\t\t\treturn ret;\n\t}\n\t/*\n\t * If an application puts its timeval in read-only memory, we\n\t * don't want the Linux-specific update to the timeval to\n\t * cause a fault after the select has completed\n\t * successfully. However, because we're not updating the\n\t * timeval, we can't restart the system call.\n\t */\n\nsticky:\n\tif (ret == -ERESTARTNOHAND)\n\t\tret = -EINTR;\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int poll_select_copy_remaining(struct timespec *end_time, void __user *p,\n\t\t\t\t      int timeval, int ret)\n{\n\tstruct timespec ts;\n\n\tif (!p)\n\t\treturn ret;\n\n\tif (current->personality & STICKY_TIMEOUTS)\n\t\tgoto sticky;\n\n\t/* No update for zero timeout */\n\tif (!end_time->tv_sec && !end_time->tv_nsec)\n\t\treturn ret;\n\n\tktime_get_ts(&ts);\n\tts = timespec_sub(*end_time, ts);\n\tif (ts.tv_sec < 0)\n\t\tts.tv_sec = ts.tv_nsec = 0;\n\n\tif (timeval) {\n\t\tstruct compat_timeval rtv;\n\n\t\trtv.tv_sec = ts.tv_sec;\n\t\trtv.tv_usec = ts.tv_nsec / NSEC_PER_USEC;\n\n\t\tif (!copy_to_user(p, &rtv, sizeof(rtv)))\n\t\t\treturn ret;\n\t} else {\n\t\tstruct compat_timespec rts;\n\n\t\trts.tv_sec = ts.tv_sec;\n\t\trts.tv_nsec = ts.tv_nsec;\n\n\t\tif (!copy_to_user(p, &rts, sizeof(rts)))\n\t\t\treturn ret;\n\t}\n\t/*\n\t * If an application puts its timeval in read-only memory, we\n\t * don't want the Linux-specific update to the timeval to\n\t * cause a fault after the select has completed\n\t * successfully. However, because we're not updating the\n\t * timeval, we can't restart the system call.\n\t */\n\nsticky:\n\tif (ret == -ERESTARTNOHAND)\n\t\tret = -EINTR;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_core_sys_select",
          "args": [
            "n",
            "inp",
            "outp",
            "exp",
            "to"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "compat_core_sys_select",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "1234-1303",
          "snippet": "int compat_core_sys_select(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct timespec *end_time)\n{\n\tfd_set_bits fds;\n\tvoid *bits;\n\tint size, max_fds, ret = -EINVAL;\n\tstruct fdtable *fdt;\n\tlong stack_fds[SELECT_STACK_ALLOC/sizeof(long)];\n\n\tif (n < 0)\n\t\tgoto out_nofds;\n\n\t/* max_fds can increase, so grab it once to avoid race */\n\trcu_read_lock();\n\tfdt = files_fdtable(current->files);\n\tmax_fds = fdt->max_fds;\n\trcu_read_unlock();\n\tif (n > max_fds)\n\t\tn = max_fds;\n\n\t/*\n\t * We need 6 bitmaps (in/out/ex for both incoming and outgoing),\n\t * since we used fdset we need to allocate memory in units of\n\t * long-words.\n\t */\n\tsize = FDS_BYTES(n);\n\tbits = stack_fds;\n\tif (size > sizeof(stack_fds) / 6) {\n\t\tbits = kmalloc(6 * size, GFP_KERNEL);\n\t\tret = -ENOMEM;\n\t\tif (!bits)\n\t\t\tgoto out_nofds;\n\t}\n\tfds.in      = (unsigned long *)  bits;\n\tfds.out     = (unsigned long *) (bits +   size);\n\tfds.ex      = (unsigned long *) (bits + 2*size);\n\tfds.res_in  = (unsigned long *) (bits + 3*size);\n\tfds.res_out = (unsigned long *) (bits + 4*size);\n\tfds.res_ex  = (unsigned long *) (bits + 5*size);\n\n\tif ((ret = compat_get_fd_set(n, inp, fds.in)) ||\n\t    (ret = compat_get_fd_set(n, outp, fds.out)) ||\n\t    (ret = compat_get_fd_set(n, exp, fds.ex)))\n\t\tgoto out;\n\tzero_fd_set(n, fds.res_in);\n\tzero_fd_set(n, fds.res_out);\n\tzero_fd_set(n, fds.res_ex);\n\n\tret = do_select(n, &fds, end_time);\n\n\tif (ret < 0)\n\t\tgoto out;\n\tif (!ret) {\n\t\tret = -ERESTARTNOHAND;\n\t\tif (signal_pending(current))\n\t\t\tgoto out;\n\t\tret = 0;\n\t}\n\n\tif (compat_set_fd_set(n, inp, fds.res_in) ||\n\t    compat_set_fd_set(n, outp, fds.res_out) ||\n\t    compat_set_fd_set(n, exp, fds.res_ex))\n\t\tret = -EFAULT;\nout:\n\tif (bits != stack_fds)\n\t\tkfree(bits);\nout_nofds:\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_core_sys_select(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct timespec *end_time)\n{\n\tfd_set_bits fds;\n\tvoid *bits;\n\tint size, max_fds, ret = -EINVAL;\n\tstruct fdtable *fdt;\n\tlong stack_fds[SELECT_STACK_ALLOC/sizeof(long)];\n\n\tif (n < 0)\n\t\tgoto out_nofds;\n\n\t/* max_fds can increase, so grab it once to avoid race */\n\trcu_read_lock();\n\tfdt = files_fdtable(current->files);\n\tmax_fds = fdt->max_fds;\n\trcu_read_unlock();\n\tif (n > max_fds)\n\t\tn = max_fds;\n\n\t/*\n\t * We need 6 bitmaps (in/out/ex for both incoming and outgoing),\n\t * since we used fdset we need to allocate memory in units of\n\t * long-words.\n\t */\n\tsize = FDS_BYTES(n);\n\tbits = stack_fds;\n\tif (size > sizeof(stack_fds) / 6) {\n\t\tbits = kmalloc(6 * size, GFP_KERNEL);\n\t\tret = -ENOMEM;\n\t\tif (!bits)\n\t\t\tgoto out_nofds;\n\t}\n\tfds.in      = (unsigned long *)  bits;\n\tfds.out     = (unsigned long *) (bits +   size);\n\tfds.ex      = (unsigned long *) (bits + 2*size);\n\tfds.res_in  = (unsigned long *) (bits + 3*size);\n\tfds.res_out = (unsigned long *) (bits + 4*size);\n\tfds.res_ex  = (unsigned long *) (bits + 5*size);\n\n\tif ((ret = compat_get_fd_set(n, inp, fds.in)) ||\n\t    (ret = compat_get_fd_set(n, outp, fds.out)) ||\n\t    (ret = compat_get_fd_set(n, exp, fds.ex)))\n\t\tgoto out;\n\tzero_fd_set(n, fds.res_in);\n\tzero_fd_set(n, fds.res_out);\n\tzero_fd_set(n, fds.res_ex);\n\n\tret = do_select(n, &fds, end_time);\n\n\tif (ret < 0)\n\t\tgoto out;\n\tif (!ret) {\n\t\tret = -ERESTARTNOHAND;\n\t\tif (signal_pending(current))\n\t\t\tgoto out;\n\t\tret = 0;\n\t}\n\n\tif (compat_set_fd_set(n, inp, fds.res_in) ||\n\t    compat_set_fd_set(n, outp, fds.res_out) ||\n\t    compat_set_fd_set(n, exp, fds.res_ex))\n\t\tret = -EFAULT;\nout:\n\tif (bits != stack_fds)\n\t\tkfree(bits);\nout_nofds:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_SETMASK",
            "&ksigmask",
            "&sigsaved"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigdelsetmask",
          "args": [
            "&ksigmask",
            "sigmask(SIGKILL)|sigmask(SIGSTOP)"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigmask",
          "args": [
            "SIGSTOP"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigmask",
          "args": [
            "SIGKILL"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigset_from_compat",
          "args": [
            "&ksigmask",
            "&ss32"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&ss32",
            "sigmask",
            "sizeof(ss32)"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "poll_select_set_timeout",
          "args": [
            "to",
            "ts.tv_sec",
            "ts.tv_nsec"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "poll_select_set_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/select.c",
          "lines": "272-287",
          "snippet": "int poll_select_set_timeout(struct timespec *to, long sec, long nsec)\n{\n\tstruct timespec ts = {.tv_sec = sec, .tv_nsec = nsec};\n\n\tif (!timespec_valid(&ts))\n\t\treturn -EINVAL;\n\n\t/* Optimize for the zero timeout value here */\n\tif (!sec && !nsec) {\n\t\tto->tv_sec = to->tv_nsec = 0;\n\t} else {\n\t\tktime_get_ts(to);\n\t\t*to = timespec_add_safe(*to, ts);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <net/busy_poll.h>",
            "#include <linux/freezer.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/personality.h> /* for STICKY_TIMEOUTS */",
            "#include <linux/poll.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <net/busy_poll.h>\n#include <linux/freezer.h>\n#include <linux/sched/rt.h>\n#include <linux/hrtimer.h>\n#include <linux/rcupdate.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/personality.h> /* for STICKY_TIMEOUTS */\n#include <linux/poll.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nint poll_select_set_timeout(struct timespec *to, long sec, long nsec)\n{\n\tstruct timespec ts = {.tv_sec = sec, .tv_nsec = nsec};\n\n\tif (!timespec_valid(&ts))\n\t\treturn -EINVAL;\n\n\t/* Optimize for the zero timeout value here */\n\tif (!sec && !nsec) {\n\t\tto->tv_sec = to->tv_nsec = 0;\n\t} else {\n\t\tktime_get_ts(to);\n\t\t*to = timespec_add_safe(*to, ts);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic long do_compat_pselect(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct compat_timespec __user *tsp, compat_sigset_t __user *sigmask,\n\tcompat_size_t sigsetsize)\n{\n\tcompat_sigset_t ss32;\n\tsigset_t ksigmask, sigsaved;\n\tstruct compat_timespec ts;\n\tstruct timespec end_time, *to = NULL;\n\tint ret;\n\n\tif (tsp) {\n\t\tif (copy_from_user(&ts, tsp, sizeof(ts)))\n\t\t\treturn -EFAULT;\n\n\t\tto = &end_time;\n\t\tif (poll_select_set_timeout(to, ts.tv_sec, ts.tv_nsec))\n\t\t\treturn -EINVAL;\n\t}\n\n\tif (sigmask) {\n\t\tif (sigsetsize != sizeof(compat_sigset_t))\n\t\t\treturn -EINVAL;\n\t\tif (copy_from_user(&ss32, sigmask, sizeof(ss32)))\n\t\t\treturn -EFAULT;\n\t\tsigset_from_compat(&ksigmask, &ss32);\n\n\t\tsigdelsetmask(&ksigmask, sigmask(SIGKILL)|sigmask(SIGSTOP));\n\t\tsigprocmask(SIG_SETMASK, &ksigmask, &sigsaved);\n\t}\n\n\tret = compat_core_sys_select(n, inp, outp, exp, to);\n\tret = poll_select_copy_remaining(&end_time, tsp, 0, ret);\n\n\tif (ret == -ERESTARTNOHAND) {\n\t\t/*\n\t\t * Don't restore the signal mask yet. Let do_signal() deliver\n\t\t * the signal on the way back to userspace, before the signal\n\t\t * mask is restored.\n\t\t */\n\t\tif (sigmask) {\n\t\t\tmemcpy(&current->saved_sigmask, &sigsaved,\n\t\t\t\t\tsizeof(sigsaved));\n\t\t\tset_restore_sigmask();\n\t\t}\n\t} else if (sigmask)\n\t\tsigprocmask(SIG_SETMASK, &sigsaved, NULL);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "compat_core_sys_select",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1234-1303",
    "snippet": "int compat_core_sys_select(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct timespec *end_time)\n{\n\tfd_set_bits fds;\n\tvoid *bits;\n\tint size, max_fds, ret = -EINVAL;\n\tstruct fdtable *fdt;\n\tlong stack_fds[SELECT_STACK_ALLOC/sizeof(long)];\n\n\tif (n < 0)\n\t\tgoto out_nofds;\n\n\t/* max_fds can increase, so grab it once to avoid race */\n\trcu_read_lock();\n\tfdt = files_fdtable(current->files);\n\tmax_fds = fdt->max_fds;\n\trcu_read_unlock();\n\tif (n > max_fds)\n\t\tn = max_fds;\n\n\t/*\n\t * We need 6 bitmaps (in/out/ex for both incoming and outgoing),\n\t * since we used fdset we need to allocate memory in units of\n\t * long-words.\n\t */\n\tsize = FDS_BYTES(n);\n\tbits = stack_fds;\n\tif (size > sizeof(stack_fds) / 6) {\n\t\tbits = kmalloc(6 * size, GFP_KERNEL);\n\t\tret = -ENOMEM;\n\t\tif (!bits)\n\t\t\tgoto out_nofds;\n\t}\n\tfds.in      = (unsigned long *)  bits;\n\tfds.out     = (unsigned long *) (bits +   size);\n\tfds.ex      = (unsigned long *) (bits + 2*size);\n\tfds.res_in  = (unsigned long *) (bits + 3*size);\n\tfds.res_out = (unsigned long *) (bits + 4*size);\n\tfds.res_ex  = (unsigned long *) (bits + 5*size);\n\n\tif ((ret = compat_get_fd_set(n, inp, fds.in)) ||\n\t    (ret = compat_get_fd_set(n, outp, fds.out)) ||\n\t    (ret = compat_get_fd_set(n, exp, fds.ex)))\n\t\tgoto out;\n\tzero_fd_set(n, fds.res_in);\n\tzero_fd_set(n, fds.res_out);\n\tzero_fd_set(n, fds.res_ex);\n\n\tret = do_select(n, &fds, end_time);\n\n\tif (ret < 0)\n\t\tgoto out;\n\tif (!ret) {\n\t\tret = -ERESTARTNOHAND;\n\t\tif (signal_pending(current))\n\t\t\tgoto out;\n\t\tret = 0;\n\t}\n\n\tif (compat_set_fd_set(n, inp, fds.res_in) ||\n\t    compat_set_fd_set(n, outp, fds.res_out) ||\n\t    compat_set_fd_set(n, exp, fds.res_ex))\n\t\tret = -EFAULT;\nout:\n\tif (bits != stack_fds)\n\t\tkfree(bits);\nout_nofds:\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "bits"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_set_fd_set",
          "args": [
            "n",
            "exp",
            "fds.res_ex"
          ],
          "line": 1296
        },
        "resolved": true,
        "details": {
          "function_name": "compat_set_fd_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "1194-1218",
          "snippet": "static\nint compat_set_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t      unsigned long *fdset)\n{\n\tunsigned long odd;\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\n\tif (!ufdset)\n\t\treturn 0;\n\n\todd = nr & 1UL;\n\tnr &= ~1UL;\n\twhile (nr) {\n\t\tunsigned long h, l;\n\t\tl = *fdset++;\n\t\th = l >> 32;\n\t\tif (__put_user(l, ufdset) || __put_user(h, ufdset+1))\n\t\t\treturn -EFAULT;\n\t\tufdset += 2;\n\t\tnr -= 2;\n\t}\n\tif (odd && __put_user(*fdset, ufdset))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [
            "#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\n#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))\n\nstatic\nint compat_set_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t      unsigned long *fdset)\n{\n\tunsigned long odd;\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\n\tif (!ufdset)\n\t\treturn 0;\n\n\todd = nr & 1UL;\n\tnr &= ~1UL;\n\twhile (nr) {\n\t\tunsigned long h, l;\n\t\tl = *fdset++;\n\t\th = l >> 32;\n\t\tif (__put_user(l, ufdset) || __put_user(h, ufdset+1))\n\t\t\treturn -EFAULT;\n\t\tufdset += 2;\n\t\tnr -= 2;\n\t}\n\tif (odd && __put_user(*fdset, ufdset))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "signal_pending",
          "args": [
            "current"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_select",
          "args": [
            "n",
            "&fds",
            "end_time"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "do_select",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/select.c",
          "lines": "399-537",
          "snippet": "int do_select(int n, fd_set_bits *fds, struct timespec *end_time)\n{\n\tktime_t expire, *to = NULL;\n\tstruct poll_wqueues table;\n\tpoll_table *wait;\n\tint retval, i, timed_out = 0;\n\tunsigned long slack = 0;\n\tunsigned int busy_flag = net_busy_loop_on() ? POLL_BUSY_LOOP : 0;\n\tunsigned long busy_end = 0;\n\n\trcu_read_lock();\n\tretval = max_select_fd(n, fds);\n\trcu_read_unlock();\n\n\tif (retval < 0)\n\t\treturn retval;\n\tn = retval;\n\n\tpoll_initwait(&table);\n\twait = &table.pt;\n\tif (end_time && !end_time->tv_sec && !end_time->tv_nsec) {\n\t\twait->_qproc = NULL;\n\t\ttimed_out = 1;\n\t}\n\n\tif (end_time && !timed_out)\n\t\tslack = select_estimate_accuracy(end_time);\n\n\tretval = 0;\n\tfor (;;) {\n\t\tunsigned long *rinp, *routp, *rexp, *inp, *outp, *exp;\n\t\tbool can_busy_loop = false;\n\n\t\tinp = fds->in; outp = fds->out; exp = fds->ex;\n\t\trinp = fds->res_in; routp = fds->res_out; rexp = fds->res_ex;\n\n\t\tfor (i = 0; i < n; ++rinp, ++routp, ++rexp) {\n\t\t\tunsigned long in, out, ex, all_bits, bit = 1, mask, j;\n\t\t\tunsigned long res_in = 0, res_out = 0, res_ex = 0;\n\n\t\t\tin = *inp++; out = *outp++; ex = *exp++;\n\t\t\tall_bits = in | out | ex;\n\t\t\tif (all_bits == 0) {\n\t\t\t\ti += BITS_PER_LONG;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (j = 0; j < BITS_PER_LONG; ++j, ++i, bit <<= 1) {\n\t\t\t\tstruct fd f;\n\t\t\t\tif (i >= n)\n\t\t\t\t\tbreak;\n\t\t\t\tif (!(bit & all_bits))\n\t\t\t\t\tcontinue;\n\t\t\t\tf = fdget(i);\n\t\t\t\tif (f.file) {\n\t\t\t\t\tconst struct file_operations *f_op;\n\t\t\t\t\tf_op = f.file->f_op;\n\t\t\t\t\tmask = DEFAULT_POLLMASK;\n\t\t\t\t\tif (f_op->poll) {\n\t\t\t\t\t\twait_key_set(wait, in, out,\n\t\t\t\t\t\t\t     bit, busy_flag);\n\t\t\t\t\t\tmask = (*f_op->poll)(f.file, wait);\n\t\t\t\t\t}\n\t\t\t\t\tfdput(f);\n\t\t\t\t\tif ((mask & POLLIN_SET) && (in & bit)) {\n\t\t\t\t\t\tres_in |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\tif ((mask & POLLOUT_SET) && (out & bit)) {\n\t\t\t\t\t\tres_out |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\tif ((mask & POLLEX_SET) && (ex & bit)) {\n\t\t\t\t\t\tres_ex |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\t/* got something, stop busy polling */\n\t\t\t\t\tif (retval) {\n\t\t\t\t\t\tcan_busy_loop = false;\n\t\t\t\t\t\tbusy_flag = 0;\n\n\t\t\t\t\t/*\n\t\t\t\t\t * only remember a returned\n\t\t\t\t\t * POLL_BUSY_LOOP if we asked for it\n\t\t\t\t\t */\n\t\t\t\t\t} else if (busy_flag & mask)\n\t\t\t\t\t\tcan_busy_loop = true;\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (res_in)\n\t\t\t\t*rinp = res_in;\n\t\t\tif (res_out)\n\t\t\t\t*routp = res_out;\n\t\t\tif (res_ex)\n\t\t\t\t*rexp = res_ex;\n\t\t\tcond_resched();\n\t\t}\n\t\twait->_qproc = NULL;\n\t\tif (retval || timed_out || signal_pending(current))\n\t\t\tbreak;\n\t\tif (table.error) {\n\t\t\tretval = table.error;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* only if found POLL_BUSY_LOOP sockets && not out of time */\n\t\tif (can_busy_loop && !need_resched()) {\n\t\t\tif (!busy_end) {\n\t\t\t\tbusy_end = busy_loop_end_time();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!busy_loop_timeout(busy_end))\n\t\t\t\tcontinue;\n\t\t}\n\t\tbusy_flag = 0;\n\n\t\t/*\n\t\t * If this is the first loop and we have a timeout\n\t\t * given, then we convert to ktime_t and set the to\n\t\t * pointer to the expiry value.\n\t\t */\n\t\tif (end_time && !to) {\n\t\t\texpire = timespec_to_ktime(*end_time);\n\t\t\tto = &expire;\n\t\t}\n\n\t\tif (!poll_schedule_timeout(&table, TASK_INTERRUPTIBLE,\n\t\t\t\t\t   to, slack))\n\t\t\ttimed_out = 1;\n\t}\n\n\tpoll_freewait(&table);\n\n\treturn retval;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <net/busy_poll.h>",
            "#include <linux/freezer.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/personality.h> /* for STICKY_TIMEOUTS */",
            "#include <linux/poll.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define POLLEX_SET (POLLPRI)",
            "#define POLLOUT_SET (POLLWRBAND | POLLWRNORM | POLLOUT | POLLERR)",
            "#define POLLIN_SET (POLLRDNORM | POLLRDBAND | POLLIN | POLLHUP | POLLERR)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <net/busy_poll.h>\n#include <linux/freezer.h>\n#include <linux/sched/rt.h>\n#include <linux/hrtimer.h>\n#include <linux/rcupdate.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/personality.h> /* for STICKY_TIMEOUTS */\n#include <linux/poll.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\n#define POLLEX_SET (POLLPRI)\n#define POLLOUT_SET (POLLWRBAND | POLLWRNORM | POLLOUT | POLLERR)\n#define POLLIN_SET (POLLRDNORM | POLLRDBAND | POLLIN | POLLHUP | POLLERR)\n\nint do_select(int n, fd_set_bits *fds, struct timespec *end_time)\n{\n\tktime_t expire, *to = NULL;\n\tstruct poll_wqueues table;\n\tpoll_table *wait;\n\tint retval, i, timed_out = 0;\n\tunsigned long slack = 0;\n\tunsigned int busy_flag = net_busy_loop_on() ? POLL_BUSY_LOOP : 0;\n\tunsigned long busy_end = 0;\n\n\trcu_read_lock();\n\tretval = max_select_fd(n, fds);\n\trcu_read_unlock();\n\n\tif (retval < 0)\n\t\treturn retval;\n\tn = retval;\n\n\tpoll_initwait(&table);\n\twait = &table.pt;\n\tif (end_time && !end_time->tv_sec && !end_time->tv_nsec) {\n\t\twait->_qproc = NULL;\n\t\ttimed_out = 1;\n\t}\n\n\tif (end_time && !timed_out)\n\t\tslack = select_estimate_accuracy(end_time);\n\n\tretval = 0;\n\tfor (;;) {\n\t\tunsigned long *rinp, *routp, *rexp, *inp, *outp, *exp;\n\t\tbool can_busy_loop = false;\n\n\t\tinp = fds->in; outp = fds->out; exp = fds->ex;\n\t\trinp = fds->res_in; routp = fds->res_out; rexp = fds->res_ex;\n\n\t\tfor (i = 0; i < n; ++rinp, ++routp, ++rexp) {\n\t\t\tunsigned long in, out, ex, all_bits, bit = 1, mask, j;\n\t\t\tunsigned long res_in = 0, res_out = 0, res_ex = 0;\n\n\t\t\tin = *inp++; out = *outp++; ex = *exp++;\n\t\t\tall_bits = in | out | ex;\n\t\t\tif (all_bits == 0) {\n\t\t\t\ti += BITS_PER_LONG;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (j = 0; j < BITS_PER_LONG; ++j, ++i, bit <<= 1) {\n\t\t\t\tstruct fd f;\n\t\t\t\tif (i >= n)\n\t\t\t\t\tbreak;\n\t\t\t\tif (!(bit & all_bits))\n\t\t\t\t\tcontinue;\n\t\t\t\tf = fdget(i);\n\t\t\t\tif (f.file) {\n\t\t\t\t\tconst struct file_operations *f_op;\n\t\t\t\t\tf_op = f.file->f_op;\n\t\t\t\t\tmask = DEFAULT_POLLMASK;\n\t\t\t\t\tif (f_op->poll) {\n\t\t\t\t\t\twait_key_set(wait, in, out,\n\t\t\t\t\t\t\t     bit, busy_flag);\n\t\t\t\t\t\tmask = (*f_op->poll)(f.file, wait);\n\t\t\t\t\t}\n\t\t\t\t\tfdput(f);\n\t\t\t\t\tif ((mask & POLLIN_SET) && (in & bit)) {\n\t\t\t\t\t\tres_in |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\tif ((mask & POLLOUT_SET) && (out & bit)) {\n\t\t\t\t\t\tres_out |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\tif ((mask & POLLEX_SET) && (ex & bit)) {\n\t\t\t\t\t\tres_ex |= bit;\n\t\t\t\t\t\tretval++;\n\t\t\t\t\t\twait->_qproc = NULL;\n\t\t\t\t\t}\n\t\t\t\t\t/* got something, stop busy polling */\n\t\t\t\t\tif (retval) {\n\t\t\t\t\t\tcan_busy_loop = false;\n\t\t\t\t\t\tbusy_flag = 0;\n\n\t\t\t\t\t/*\n\t\t\t\t\t * only remember a returned\n\t\t\t\t\t * POLL_BUSY_LOOP if we asked for it\n\t\t\t\t\t */\n\t\t\t\t\t} else if (busy_flag & mask)\n\t\t\t\t\t\tcan_busy_loop = true;\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (res_in)\n\t\t\t\t*rinp = res_in;\n\t\t\tif (res_out)\n\t\t\t\t*routp = res_out;\n\t\t\tif (res_ex)\n\t\t\t\t*rexp = res_ex;\n\t\t\tcond_resched();\n\t\t}\n\t\twait->_qproc = NULL;\n\t\tif (retval || timed_out || signal_pending(current))\n\t\t\tbreak;\n\t\tif (table.error) {\n\t\t\tretval = table.error;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* only if found POLL_BUSY_LOOP sockets && not out of time */\n\t\tif (can_busy_loop && !need_resched()) {\n\t\t\tif (!busy_end) {\n\t\t\t\tbusy_end = busy_loop_end_time();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!busy_loop_timeout(busy_end))\n\t\t\t\tcontinue;\n\t\t}\n\t\tbusy_flag = 0;\n\n\t\t/*\n\t\t * If this is the first loop and we have a timeout\n\t\t * given, then we convert to ktime_t and set the to\n\t\t * pointer to the expiry value.\n\t\t */\n\t\tif (end_time && !to) {\n\t\t\texpire = timespec_to_ktime(*end_time);\n\t\t\tto = &expire;\n\t\t}\n\n\t\tif (!poll_schedule_timeout(&table, TASK_INTERRUPTIBLE,\n\t\t\t\t\t   to, slack))\n\t\t\ttimed_out = 1;\n\t}\n\n\tpoll_freewait(&table);\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zero_fd_set",
          "args": [
            "n",
            "fds.res_ex"
          ],
          "line": 1281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zero_fd_set",
          "args": [
            "n",
            "fds.res_out"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zero_fd_set",
          "args": [
            "n",
            "fds.res_in"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_get_fd_set",
          "args": [
            "n",
            "exp",
            "fds.ex"
          ],
          "line": 1277
        },
        "resolved": true,
        "details": {
          "function_name": "compat_get_fd_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "1161-1192",
          "snippet": "static\nint compat_get_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t\tunsigned long *fdset)\n{\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\tif (ufdset) {\n\t\tunsigned long odd;\n\n\t\tif (!access_ok(VERIFY_WRITE, ufdset, nr*sizeof(compat_ulong_t)))\n\t\t\treturn -EFAULT;\n\n\t\todd = nr & 1UL;\n\t\tnr &= ~1UL;\n\t\twhile (nr) {\n\t\t\tunsigned long h, l;\n\t\t\tif (__get_user(l, ufdset) || __get_user(h, ufdset+1))\n\t\t\t\treturn -EFAULT;\n\t\t\tufdset += 2;\n\t\t\t*fdset++ = h << 32 | l;\n\t\t\tnr -= 2;\n\t\t}\n\t\tif (odd && __get_user(*fdset, ufdset))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\t/* Tricky, must clear full unsigned long in the\n\t\t * kernel fdset at the end, this makes sure that\n\t\t * actually happens.\n\t\t */\n\t\tmemset(fdset, 0, ((nr + 1) & ~1)*sizeof(compat_ulong_t));\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [
            "#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\n#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))\n\nstatic\nint compat_get_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t\tunsigned long *fdset)\n{\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\tif (ufdset) {\n\t\tunsigned long odd;\n\n\t\tif (!access_ok(VERIFY_WRITE, ufdset, nr*sizeof(compat_ulong_t)))\n\t\t\treturn -EFAULT;\n\n\t\todd = nr & 1UL;\n\t\tnr &= ~1UL;\n\t\twhile (nr) {\n\t\t\tunsigned long h, l;\n\t\t\tif (__get_user(l, ufdset) || __get_user(h, ufdset+1))\n\t\t\t\treturn -EFAULT;\n\t\t\tufdset += 2;\n\t\t\t*fdset++ = h << 32 | l;\n\t\t\tnr -= 2;\n\t\t}\n\t\tif (odd && __get_user(*fdset, ufdset))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\t/* Tricky, must clear full unsigned long in the\n\t\t * kernel fdset at the end, this makes sure that\n\t\t * actually happens.\n\t\t */\n\t\tmemset(fdset, 0, ((nr + 1) & ~1)*sizeof(compat_ulong_t));\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "6 * size",
            "GFP_KERNEL"
          ],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FDS_BYTES",
          "args": [
            "n"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files_fdtable",
          "args": [
            "current->files"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_core_sys_select(int n, compat_ulong_t __user *inp,\n\tcompat_ulong_t __user *outp, compat_ulong_t __user *exp,\n\tstruct timespec *end_time)\n{\n\tfd_set_bits fds;\n\tvoid *bits;\n\tint size, max_fds, ret = -EINVAL;\n\tstruct fdtable *fdt;\n\tlong stack_fds[SELECT_STACK_ALLOC/sizeof(long)];\n\n\tif (n < 0)\n\t\tgoto out_nofds;\n\n\t/* max_fds can increase, so grab it once to avoid race */\n\trcu_read_lock();\n\tfdt = files_fdtable(current->files);\n\tmax_fds = fdt->max_fds;\n\trcu_read_unlock();\n\tif (n > max_fds)\n\t\tn = max_fds;\n\n\t/*\n\t * We need 6 bitmaps (in/out/ex for both incoming and outgoing),\n\t * since we used fdset we need to allocate memory in units of\n\t * long-words.\n\t */\n\tsize = FDS_BYTES(n);\n\tbits = stack_fds;\n\tif (size > sizeof(stack_fds) / 6) {\n\t\tbits = kmalloc(6 * size, GFP_KERNEL);\n\t\tret = -ENOMEM;\n\t\tif (!bits)\n\t\t\tgoto out_nofds;\n\t}\n\tfds.in      = (unsigned long *)  bits;\n\tfds.out     = (unsigned long *) (bits +   size);\n\tfds.ex      = (unsigned long *) (bits + 2*size);\n\tfds.res_in  = (unsigned long *) (bits + 3*size);\n\tfds.res_out = (unsigned long *) (bits + 4*size);\n\tfds.res_ex  = (unsigned long *) (bits + 5*size);\n\n\tif ((ret = compat_get_fd_set(n, inp, fds.in)) ||\n\t    (ret = compat_get_fd_set(n, outp, fds.out)) ||\n\t    (ret = compat_get_fd_set(n, exp, fds.ex)))\n\t\tgoto out;\n\tzero_fd_set(n, fds.res_in);\n\tzero_fd_set(n, fds.res_out);\n\tzero_fd_set(n, fds.res_ex);\n\n\tret = do_select(n, &fds, end_time);\n\n\tif (ret < 0)\n\t\tgoto out;\n\tif (!ret) {\n\t\tret = -ERESTARTNOHAND;\n\t\tif (signal_pending(current))\n\t\t\tgoto out;\n\t\tret = 0;\n\t}\n\n\tif (compat_set_fd_set(n, inp, fds.res_in) ||\n\t    compat_set_fd_set(n, outp, fds.res_out) ||\n\t    compat_set_fd_set(n, exp, fds.res_ex))\n\t\tret = -EFAULT;\nout:\n\tif (bits != stack_fds)\n\t\tkfree(bits);\nout_nofds:\n\treturn ret;\n}"
  },
  {
    "function_name": "compat_set_fd_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1194-1218",
    "snippet": "static\nint compat_set_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t      unsigned long *fdset)\n{\n\tunsigned long odd;\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\n\tif (!ufdset)\n\t\treturn 0;\n\n\todd = nr & 1UL;\n\tnr &= ~1UL;\n\twhile (nr) {\n\t\tunsigned long h, l;\n\t\tl = *fdset++;\n\t\th = l >> 32;\n\t\tif (__put_user(l, ufdset) || __put_user(h, ufdset+1))\n\t\t\treturn -EFAULT;\n\t\tufdset += 2;\n\t\tnr -= 2;\n\t}\n\tif (odd && __put_user(*fdset, ufdset))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [
      "#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "*fdset",
            "ufdset"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "h",
            "ufdset+1"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "l",
            "ufdset"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nr",
            "__COMPAT_NFDBITS"
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\n#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))\n\nstatic\nint compat_set_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t      unsigned long *fdset)\n{\n\tunsigned long odd;\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\n\tif (!ufdset)\n\t\treturn 0;\n\n\todd = nr & 1UL;\n\tnr &= ~1UL;\n\twhile (nr) {\n\t\tunsigned long h, l;\n\t\tl = *fdset++;\n\t\th = l >> 32;\n\t\tif (__put_user(l, ufdset) || __put_user(h, ufdset+1))\n\t\t\treturn -EFAULT;\n\t\tufdset += 2;\n\t\tnr -= 2;\n\t}\n\tif (odd && __put_user(*fdset, ufdset))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "compat_get_fd_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1161-1192",
    "snippet": "static\nint compat_get_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t\tunsigned long *fdset)\n{\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\tif (ufdset) {\n\t\tunsigned long odd;\n\n\t\tif (!access_ok(VERIFY_WRITE, ufdset, nr*sizeof(compat_ulong_t)))\n\t\t\treturn -EFAULT;\n\n\t\todd = nr & 1UL;\n\t\tnr &= ~1UL;\n\t\twhile (nr) {\n\t\t\tunsigned long h, l;\n\t\t\tif (__get_user(l, ufdset) || __get_user(h, ufdset+1))\n\t\t\t\treturn -EFAULT;\n\t\t\tufdset += 2;\n\t\t\t*fdset++ = h << 32 | l;\n\t\t\tnr -= 2;\n\t\t}\n\t\tif (odd && __get_user(*fdset, ufdset))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\t/* Tricky, must clear full unsigned long in the\n\t\t * kernel fdset at the end, this makes sure that\n\t\t * actually happens.\n\t\t */\n\t\tmemset(fdset, 0, ((nr + 1) & ~1)*sizeof(compat_ulong_t));\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [
      "#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fdset",
            "0",
            "((nr + 1) & ~1)*sizeof(compat_ulong_t)"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "*fdset",
            "ufdset"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "h",
            "ufdset+1"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "l",
            "ufdset"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ufdset",
            "nr*sizeof(compat_ulong_t)"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nr",
            "__COMPAT_NFDBITS"
          ],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\n#define __COMPAT_NFDBITS       (8 * sizeof(compat_ulong_t))\n\nstatic\nint compat_get_fd_set(unsigned long nr, compat_ulong_t __user *ufdset,\n\t\t\tunsigned long *fdset)\n{\n\tnr = DIV_ROUND_UP(nr, __COMPAT_NFDBITS);\n\tif (ufdset) {\n\t\tunsigned long odd;\n\n\t\tif (!access_ok(VERIFY_WRITE, ufdset, nr*sizeof(compat_ulong_t)))\n\t\t\treturn -EFAULT;\n\n\t\todd = nr & 1UL;\n\t\tnr &= ~1UL;\n\t\twhile (nr) {\n\t\t\tunsigned long h, l;\n\t\t\tif (__get_user(l, ufdset) || __get_user(h, ufdset+1))\n\t\t\t\treturn -EFAULT;\n\t\t\tufdset += 2;\n\t\t\t*fdset++ = h << 32 | l;\n\t\t\tnr -= 2;\n\t\t}\n\t\tif (odd && __get_user(*fdset, ufdset))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\t/* Tricky, must clear full unsigned long in the\n\t\t * kernel fdset at the end, this makes sure that\n\t\t * actually happens.\n\t\t */\n\t\tmemset(fdset, 0, ((nr + 1) & ~1)*sizeof(compat_ulong_t));\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "poll_select_copy_remaining",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1106-1155",
    "snippet": "static int poll_select_copy_remaining(struct timespec *end_time, void __user *p,\n\t\t\t\t      int timeval, int ret)\n{\n\tstruct timespec ts;\n\n\tif (!p)\n\t\treturn ret;\n\n\tif (current->personality & STICKY_TIMEOUTS)\n\t\tgoto sticky;\n\n\t/* No update for zero timeout */\n\tif (!end_time->tv_sec && !end_time->tv_nsec)\n\t\treturn ret;\n\n\tktime_get_ts(&ts);\n\tts = timespec_sub(*end_time, ts);\n\tif (ts.tv_sec < 0)\n\t\tts.tv_sec = ts.tv_nsec = 0;\n\n\tif (timeval) {\n\t\tstruct compat_timeval rtv;\n\n\t\trtv.tv_sec = ts.tv_sec;\n\t\trtv.tv_usec = ts.tv_nsec / NSEC_PER_USEC;\n\n\t\tif (!copy_to_user(p, &rtv, sizeof(rtv)))\n\t\t\treturn ret;\n\t} else {\n\t\tstruct compat_timespec rts;\n\n\t\trts.tv_sec = ts.tv_sec;\n\t\trts.tv_nsec = ts.tv_nsec;\n\n\t\tif (!copy_to_user(p, &rts, sizeof(rts)))\n\t\t\treturn ret;\n\t}\n\t/*\n\t * If an application puts its timeval in read-only memory, we\n\t * don't want the Linux-specific update to the timeval to\n\t * cause a fault after the select has completed\n\t * successfully. However, because we're not updating the\n\t * timeval, we can't restart the system call.\n\t */\n\nsticky:\n\tif (ret == -ERESTARTNOHAND)\n\t\tret = -EINTR;\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "p",
            "&rts",
            "sizeof(rts)"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "p",
            "&rtv",
            "sizeof(rtv)"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec_sub",
          "args": [
            "*end_time",
            "ts"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_get_ts",
          "args": [
            "&ts"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int poll_select_copy_remaining(struct timespec *end_time, void __user *p,\n\t\t\t\t      int timeval, int ret)\n{\n\tstruct timespec ts;\n\n\tif (!p)\n\t\treturn ret;\n\n\tif (current->personality & STICKY_TIMEOUTS)\n\t\tgoto sticky;\n\n\t/* No update for zero timeout */\n\tif (!end_time->tv_sec && !end_time->tv_nsec)\n\t\treturn ret;\n\n\tktime_get_ts(&ts);\n\tts = timespec_sub(*end_time, ts);\n\tif (ts.tv_sec < 0)\n\t\tts.tv_sec = ts.tv_nsec = 0;\n\n\tif (timeval) {\n\t\tstruct compat_timeval rtv;\n\n\t\trtv.tv_sec = ts.tv_sec;\n\t\trtv.tv_usec = ts.tv_nsec / NSEC_PER_USEC;\n\n\t\tif (!copy_to_user(p, &rtv, sizeof(rtv)))\n\t\t\treturn ret;\n\t} else {\n\t\tstruct compat_timespec rts;\n\n\t\trts.tv_sec = ts.tv_sec;\n\t\trts.tv_nsec = ts.tv_nsec;\n\n\t\tif (!copy_to_user(p, &rts, sizeof(rts)))\n\t\t\treturn ret;\n\t}\n\t/*\n\t * If an application puts its timeval in read-only memory, we\n\t * don't want the Linux-specific update to the timeval to\n\t * cause a fault after the select has completed\n\t * successfully. However, because we're not updating the\n\t * timeval, we can't restart the system call.\n\t */\n\nsticky:\n\tif (ret == -ERESTARTNOHAND)\n\t\tret = -EINTR;\n\treturn ret;\n}"
  },
  {
    "function_name": "compat_filldir64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "1007-1049",
    "snippet": "static int compat_filldir64(struct dir_context *ctx, const char *name,\n\t\t\t    int namlen, loff_t offset, u64 ino,\n\t\t\t    unsigned int d_type)\n{\n\tstruct linux_dirent64 __user *dirent;\n\tstruct compat_getdents_callback64 *buf =\n\t\tcontainer_of(ctx, struct compat_getdents_callback64, ctx);\n\tint reclen = ALIGN(offsetof(struct linux_dirent64, d_name) + namlen + 1,\n\t\tsizeof(u64));\n\tu64 off;\n\n\tbuf->error = -EINVAL;\t/* only used if we fail.. */\n\tif (reclen > buf->count)\n\t\treturn -EINVAL;\n\tdirent = buf->previous;\n\n\tif (dirent) {\n\t\tif (__put_user_unaligned(offset, &dirent->d_off))\n\t\t\tgoto efault;\n\t}\n\tdirent = buf->current_dir;\n\tif (__put_user_unaligned(ino, &dirent->d_ino))\n\t\tgoto efault;\n\toff = 0;\n\tif (__put_user_unaligned(off, &dirent->d_off))\n\t\tgoto efault;\n\tif (__put_user(reclen, &dirent->d_reclen))\n\t\tgoto efault;\n\tif (__put_user(d_type, &dirent->d_type))\n\t\tgoto efault;\n\tif (copy_to_user(dirent->d_name, name, namlen))\n\t\tgoto efault;\n\tif (__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\tbuf->previous = dirent;\n\tdirent = (void __user *)dirent + reclen;\n\tbuf->current_dir = dirent;\n\tbuf->count -= reclen;\n\treturn 0;\nefault:\n\tbuf->error = -EFAULT;\n\treturn -EFAULT;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "0",
            "dirent->d_name + namlen"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "dirent->d_name",
            "name",
            "namlen"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "d_type",
            "&dirent->d_type"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "reclen",
            "&dirent->d_reclen"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user_unaligned",
          "args": [
            "off",
            "&dirent->d_off"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user_unaligned",
          "args": [
            "ino",
            "&dirent->d_ino"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user_unaligned",
          "args": [
            "offset",
            "&dirent->d_off"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "offsetof(struct linux_dirent64, d_name) + namlen + 1",
            "sizeof(u64)"
          ],
          "line": 1014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ctx",
            "structcompat_getdents_callback64",
            "ctx"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int compat_filldir64(struct dir_context *ctx, const char *name,\n\t\t\t    int namlen, loff_t offset, u64 ino,\n\t\t\t    unsigned int d_type)\n{\n\tstruct linux_dirent64 __user *dirent;\n\tstruct compat_getdents_callback64 *buf =\n\t\tcontainer_of(ctx, struct compat_getdents_callback64, ctx);\n\tint reclen = ALIGN(offsetof(struct linux_dirent64, d_name) + namlen + 1,\n\t\tsizeof(u64));\n\tu64 off;\n\n\tbuf->error = -EINVAL;\t/* only used if we fail.. */\n\tif (reclen > buf->count)\n\t\treturn -EINVAL;\n\tdirent = buf->previous;\n\n\tif (dirent) {\n\t\tif (__put_user_unaligned(offset, &dirent->d_off))\n\t\t\tgoto efault;\n\t}\n\tdirent = buf->current_dir;\n\tif (__put_user_unaligned(ino, &dirent->d_ino))\n\t\tgoto efault;\n\toff = 0;\n\tif (__put_user_unaligned(off, &dirent->d_off))\n\t\tgoto efault;\n\tif (__put_user(reclen, &dirent->d_reclen))\n\t\tgoto efault;\n\tif (__put_user(d_type, &dirent->d_type))\n\t\tgoto efault;\n\tif (copy_to_user(dirent->d_name, name, namlen))\n\t\tgoto efault;\n\tif (__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\tbuf->previous = dirent;\n\tdirent = (void __user *)dirent + reclen;\n\tbuf->current_dir = dirent;\n\tbuf->count -= reclen;\n\treturn 0;\nefault:\n\tbuf->error = -EFAULT;\n\treturn -EFAULT;\n}"
  },
  {
    "function_name": "compat_filldir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "920-962",
    "snippet": "static int compat_filldir(struct dir_context *ctx, const char *name, int namlen,\n\t\tloff_t offset, u64 ino, unsigned int d_type)\n{\n\tstruct compat_linux_dirent __user * dirent;\n\tstruct compat_getdents_callback *buf =\n\t\tcontainer_of(ctx, struct compat_getdents_callback, ctx);\n\tcompat_ulong_t d_ino;\n\tint reclen = ALIGN(offsetof(struct compat_linux_dirent, d_name) +\n\t\tnamlen + 2, sizeof(compat_long_t));\n\n\tbuf->error = -EINVAL;\t/* only used if we fail.. */\n\tif (reclen > buf->count)\n\t\treturn -EINVAL;\n\td_ino = ino;\n\tif (sizeof(d_ino) < sizeof(ino) && d_ino != ino) {\n\t\tbuf->error = -EOVERFLOW;\n\t\treturn -EOVERFLOW;\n\t}\n\tdirent = buf->previous;\n\tif (dirent) {\n\t\tif (__put_user(offset, &dirent->d_off))\n\t\t\tgoto efault;\n\t}\n\tdirent = buf->current_dir;\n\tif (__put_user(d_ino, &dirent->d_ino))\n\t\tgoto efault;\n\tif (__put_user(reclen, &dirent->d_reclen))\n\t\tgoto efault;\n\tif (copy_to_user(dirent->d_name, name, namlen))\n\t\tgoto efault;\n\tif (__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\tif (__put_user(d_type, (char  __user *) dirent + reclen - 1))\n\t\tgoto efault;\n\tbuf->previous = dirent;\n\tdirent = (void __user *)dirent + reclen;\n\tbuf->current_dir = dirent;\n\tbuf->count -= reclen;\n\treturn 0;\nefault:\n\tbuf->error = -EFAULT;\n\treturn -EFAULT;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "d_type",
            "(char  __user *) dirent + reclen - 1"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "0",
            "dirent->d_name + namlen"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "dirent->d_name",
            "name",
            "namlen"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "reclen",
            "&dirent->d_reclen"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "d_ino",
            "&dirent->d_ino"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "offset",
            "&dirent->d_off"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "offsetof(struct compat_linux_dirent, d_name) +\n\t\tnamlen + 2",
            "sizeof(compat_long_t)"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ctx",
            "structcompat_getdents_callback",
            "ctx"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int compat_filldir(struct dir_context *ctx, const char *name, int namlen,\n\t\tloff_t offset, u64 ino, unsigned int d_type)\n{\n\tstruct compat_linux_dirent __user * dirent;\n\tstruct compat_getdents_callback *buf =\n\t\tcontainer_of(ctx, struct compat_getdents_callback, ctx);\n\tcompat_ulong_t d_ino;\n\tint reclen = ALIGN(offsetof(struct compat_linux_dirent, d_name) +\n\t\tnamlen + 2, sizeof(compat_long_t));\n\n\tbuf->error = -EINVAL;\t/* only used if we fail.. */\n\tif (reclen > buf->count)\n\t\treturn -EINVAL;\n\td_ino = ino;\n\tif (sizeof(d_ino) < sizeof(ino) && d_ino != ino) {\n\t\tbuf->error = -EOVERFLOW;\n\t\treturn -EOVERFLOW;\n\t}\n\tdirent = buf->previous;\n\tif (dirent) {\n\t\tif (__put_user(offset, &dirent->d_off))\n\t\t\tgoto efault;\n\t}\n\tdirent = buf->current_dir;\n\tif (__put_user(d_ino, &dirent->d_ino))\n\t\tgoto efault;\n\tif (__put_user(reclen, &dirent->d_reclen))\n\t\tgoto efault;\n\tif (copy_to_user(dirent->d_name, name, namlen))\n\t\tgoto efault;\n\tif (__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\tif (__put_user(d_type, (char  __user *) dirent + reclen - 1))\n\t\tgoto efault;\n\tbuf->previous = dirent;\n\tdirent = (void __user *)dirent + reclen;\n\tbuf->current_dir = dirent;\n\tbuf->count -= reclen;\n\treturn 0;\nefault:\n\tbuf->error = -EFAULT;\n\treturn -EFAULT;\n}"
  },
  {
    "function_name": "compat_fillonedir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "850-882",
    "snippet": "static int compat_fillonedir(struct dir_context *ctx, const char *name,\n\t\t\t     int namlen, loff_t offset, u64 ino,\n\t\t\t     unsigned int d_type)\n{\n\tstruct compat_readdir_callback *buf =\n\t\tcontainer_of(ctx, struct compat_readdir_callback, ctx);\n\tstruct compat_old_linux_dirent __user *dirent;\n\tcompat_ulong_t d_ino;\n\n\tif (buf->result)\n\t\treturn -EINVAL;\n\td_ino = ino;\n\tif (sizeof(d_ino) < sizeof(ino) && d_ino != ino) {\n\t\tbuf->result = -EOVERFLOW;\n\t\treturn -EOVERFLOW;\n\t}\n\tbuf->result++;\n\tdirent = buf->dirent;\n\tif (!access_ok(VERIFY_WRITE, dirent,\n\t\t\t(unsigned long)(dirent->d_name + namlen + 1) -\n\t\t\t\t(unsigned long)dirent))\n\t\tgoto efault;\n\tif (\t__put_user(d_ino, &dirent->d_ino) ||\n\t\t__put_user(offset, &dirent->d_offset) ||\n\t\t__put_user(namlen, &dirent->d_namlen) ||\n\t\t__copy_to_user(dirent->d_name, name, namlen) ||\n\t\t__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\treturn 0;\nefault:\n\tbuf->result = -EFAULT;\n\treturn -EFAULT;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "0",
            "dirent->d_name + namlen"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__copy_to_user",
          "args": [
            "dirent->d_name",
            "name",
            "namlen"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "namlen",
            "&dirent->d_namlen"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "offset",
            "&dirent->d_offset"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "d_ino",
            "&dirent->d_ino"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "dirent",
            "(unsigned long)(dirent->d_name + namlen + 1) -\n\t\t\t\t(unsigned long)dirent"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ctx",
            "structcompat_readdir_callback",
            "ctx"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int compat_fillonedir(struct dir_context *ctx, const char *name,\n\t\t\t     int namlen, loff_t offset, u64 ino,\n\t\t\t     unsigned int d_type)\n{\n\tstruct compat_readdir_callback *buf =\n\t\tcontainer_of(ctx, struct compat_readdir_callback, ctx);\n\tstruct compat_old_linux_dirent __user *dirent;\n\tcompat_ulong_t d_ino;\n\n\tif (buf->result)\n\t\treturn -EINVAL;\n\td_ino = ino;\n\tif (sizeof(d_ino) < sizeof(ino) && d_ino != ino) {\n\t\tbuf->result = -EOVERFLOW;\n\t\treturn -EOVERFLOW;\n\t}\n\tbuf->result++;\n\tdirent = buf->dirent;\n\tif (!access_ok(VERIFY_WRITE, dirent,\n\t\t\t(unsigned long)(dirent->d_name + namlen + 1) -\n\t\t\t\t(unsigned long)dirent))\n\t\tgoto efault;\n\tif (\t__put_user(d_ino, &dirent->d_ino) ||\n\t\t__put_user(offset, &dirent->d_offset) ||\n\t\t__put_user(namlen, &dirent->d_namlen) ||\n\t\t__copy_to_user(dirent->d_name, name, namlen) ||\n\t\t__put_user(0, dirent->d_name + namlen))\n\t\tgoto efault;\n\treturn 0;\nefault:\n\tbuf->result = -EFAULT;\n\treturn -EFAULT;\n}"
  },
  {
    "function_name": "do_nfs4_super_data_conv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "754-784",
    "snippet": "static int do_nfs4_super_data_conv(void *raw_data)\n{\n\tint version = *(compat_uint_t *) raw_data;\n\n\tif (version == 1) {\n\t\tstruct compat_nfs4_mount_data_v1 *raw = raw_data;\n\t\tstruct nfs4_mount_data *real = raw_data;\n\n\t\t/* copy the fields backwards */\n\t\treal->auth_flavours = compat_ptr(raw->auth_flavours);\n\t\treal->auth_flavourlen = raw->auth_flavourlen;\n\t\treal->proto = raw->proto;\n\t\treal->host_addr = compat_ptr(raw->host_addr);\n\t\treal->host_addrlen = raw->host_addrlen;\n\t\tcompat_nfs_string(&real->hostname, &raw->hostname);\n\t\tcompat_nfs_string(&real->mnt_path, &raw->mnt_path);\n\t\tcompat_nfs_string(&real->client_addr, &raw->client_addr);\n\t\treal->acdirmax = raw->acdirmax;\n\t\treal->acdirmin = raw->acdirmin;\n\t\treal->acregmax = raw->acregmax;\n\t\treal->acregmin = raw->acregmin;\n\t\treal->retrans = raw->retrans;\n\t\treal->timeo = raw->timeo;\n\t\treal->wsize = raw->wsize;\n\t\treal->rsize = raw->rsize;\n\t\treal->flags = raw->flags;\n\t\treal->version = raw->version;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compat_nfs_string",
          "args": [
            "&real->client_addr",
            "&raw->client_addr"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "compat_nfs_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "726-731",
          "snippet": "static inline void compat_nfs_string(struct nfs_string *dst,\n\t\t\t\t     struct compat_nfs_string *src)\n{\n\tdst->data = compat_ptr(src->data);\n\tdst->len = src->len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic inline void compat_nfs_string(struct nfs_string *dst,\n\t\t\t\t     struct compat_nfs_string *src)\n{\n\tdst->data = compat_ptr(src->data);\n\tdst->len = src->len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "raw->host_addr"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "raw->auth_flavours"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int do_nfs4_super_data_conv(void *raw_data)\n{\n\tint version = *(compat_uint_t *) raw_data;\n\n\tif (version == 1) {\n\t\tstruct compat_nfs4_mount_data_v1 *raw = raw_data;\n\t\tstruct nfs4_mount_data *real = raw_data;\n\n\t\t/* copy the fields backwards */\n\t\treal->auth_flavours = compat_ptr(raw->auth_flavours);\n\t\treal->auth_flavourlen = raw->auth_flavourlen;\n\t\treal->proto = raw->proto;\n\t\treal->host_addr = compat_ptr(raw->host_addr);\n\t\treal->host_addrlen = raw->host_addrlen;\n\t\tcompat_nfs_string(&real->hostname, &raw->hostname);\n\t\tcompat_nfs_string(&real->mnt_path, &raw->mnt_path);\n\t\tcompat_nfs_string(&real->client_addr, &raw->client_addr);\n\t\treal->acdirmax = raw->acdirmax;\n\t\treal->acdirmin = raw->acdirmin;\n\t\treal->acregmax = raw->acregmax;\n\t\treal->acregmin = raw->acregmin;\n\t\treal->retrans = raw->retrans;\n\t\treal->timeo = raw->timeo;\n\t\treal->wsize = raw->wsize;\n\t\treal->rsize = raw->rsize;\n\t\treal->flags = raw->flags;\n\t\treal->version = raw->version;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "compat_nfs_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "726-731",
    "snippet": "static inline void compat_nfs_string(struct nfs_string *dst,\n\t\t\t\t     struct compat_nfs_string *src)\n{\n\tdst->data = compat_ptr(src->data);\n\tdst->len = src->len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "src->data"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic inline void compat_nfs_string(struct nfs_string *dst,\n\t\t\t\t     struct compat_nfs_string *src)\n{\n\tdst->data = compat_ptr(src->data);\n\tdst->len = src->len;\n}"
  },
  {
    "function_name": "do_ncp_super_data_conv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "684-718",
    "snippet": "static void *do_ncp_super_data_conv(void *raw_data)\n{\n\tint version = *(unsigned int *)raw_data;\n\n\tif (version == 3) {\n\t\tstruct compat_ncp_mount_data *c_n = raw_data;\n\t\tstruct ncp_mount_data *n = raw_data;\n\n\t\tn->dir_mode = c_n->dir_mode;\n\t\tn->file_mode = c_n->file_mode;\n\t\tn->gid = c_n->gid;\n\t\tn->uid = c_n->uid;\n\t\tmemmove (n->mounted_vol, c_n->mounted_vol, (sizeof (c_n->mounted_vol) + 3 * sizeof (unsigned int)));\n\t\tn->wdog_pid = c_n->wdog_pid;\n\t\tn->mounted_uid = c_n->mounted_uid;\n\t} else if (version == 4) {\n\t\tstruct compat_ncp_mount_data_v4 *c_n = raw_data;\n\t\tstruct ncp_mount_data_v4 *n = raw_data;\n\n\t\tn->dir_mode = c_n->dir_mode;\n\t\tn->file_mode = c_n->file_mode;\n\t\tn->gid = c_n->gid;\n\t\tn->uid = c_n->uid;\n\t\tn->retry_count = c_n->retry_count;\n\t\tn->time_out = c_n->time_out;\n\t\tn->ncp_fd = c_n->ncp_fd;\n\t\tn->wdog_pid = c_n->wdog_pid;\n\t\tn->mounted_uid = c_n->mounted_uid;\n\t\tn->flags = c_n->flags;\n\t} else if (version != 5) {\n\t\treturn NULL;\n\t}\n\n\treturn raw_data;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "n->mounted_vol",
            "c_n->mounted_vol",
            "(sizeof (c_n->mounted_vol) + 3 * sizeof (unsigned int))"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic void *do_ncp_super_data_conv(void *raw_data)\n{\n\tint version = *(unsigned int *)raw_data;\n\n\tif (version == 3) {\n\t\tstruct compat_ncp_mount_data *c_n = raw_data;\n\t\tstruct ncp_mount_data *n = raw_data;\n\n\t\tn->dir_mode = c_n->dir_mode;\n\t\tn->file_mode = c_n->file_mode;\n\t\tn->gid = c_n->gid;\n\t\tn->uid = c_n->uid;\n\t\tmemmove (n->mounted_vol, c_n->mounted_vol, (sizeof (c_n->mounted_vol) + 3 * sizeof (unsigned int)));\n\t\tn->wdog_pid = c_n->wdog_pid;\n\t\tn->mounted_uid = c_n->mounted_uid;\n\t} else if (version == 4) {\n\t\tstruct compat_ncp_mount_data_v4 *c_n = raw_data;\n\t\tstruct ncp_mount_data_v4 *n = raw_data;\n\n\t\tn->dir_mode = c_n->dir_mode;\n\t\tn->file_mode = c_n->file_mode;\n\t\tn->gid = c_n->gid;\n\t\tn->uid = c_n->uid;\n\t\tn->retry_count = c_n->retry_count;\n\t\tn->time_out = c_n->time_out;\n\t\tn->ncp_fd = c_n->ncp_fd;\n\t\tn->wdog_pid = c_n->wdog_pid;\n\t\tn->mounted_uid = c_n->mounted_uid;\n\t\tn->flags = c_n->flags;\n\t} else if (version != 5) {\n\t\treturn NULL;\n\t}\n\n\treturn raw_data;\n}"
  },
  {
    "function_name": "copy_iocb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "619-632",
    "snippet": "static inline long\ncopy_iocb(long nr, u32 __user *ptr32, struct iocb __user * __user *ptr64)\n{\n\tcompat_uptr_t uptr;\n\tint i;\n\n\tfor (i = 0; i < nr; ++i) {\n\t\tif (get_user(uptr, ptr32 + i))\n\t\t\treturn -EFAULT;\n\t\tif (put_user(compat_ptr(uptr), ptr64 + i))\n\t\t\treturn -EFAULT;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(uptr)",
            "ptr64 + i"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "uptr"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "uptr",
            "ptr32 + i"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic inline long\ncopy_iocb(long nr, u32 __user *ptr32, struct iocb __user * __user *ptr64)\n{\n\tcompat_uptr_t uptr;\n\tint i;\n\n\tfor (i = 0; i < nr; ++i) {\n\t\tif (get_user(uptr, ptr32 + i))\n\t\t\treturn -EFAULT;\n\t\tif (put_user(compat_ptr(uptr), ptr64 + i))\n\t\t\treturn -EFAULT;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "compat_rw_copy_check_uvector",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "546-617",
    "snippet": "ssize_t compat_rw_copy_check_uvector(int type,\n\t\tconst struct compat_iovec __user *uvector, unsigned long nr_segs,\n\t\tunsigned long fast_segs, struct iovec *fast_pointer,\n\t\tstruct iovec **ret_pointer)\n{\n\tcompat_ssize_t tot_len;\n\tstruct iovec *iov = *ret_pointer = fast_pointer;\n\tssize_t ret = 0;\n\tint seg;\n\n\t/*\n\t * SuS says \"The readv() function *may* fail if the iovcnt argument\n\t * was less than or equal to 0, or greater than {IOV_MAX}.  Linux has\n\t * traditionally returned zero for zero segments, so...\n\t */\n\tif (nr_segs == 0)\n\t\tgoto out;\n\n\tret = -EINVAL;\n\tif (nr_segs > UIO_MAXIOV || nr_segs < 0)\n\t\tgoto out;\n\tif (nr_segs > fast_segs) {\n\t\tret = -ENOMEM;\n\t\tiov = kmalloc(nr_segs*sizeof(struct iovec), GFP_KERNEL);\n\t\tif (iov == NULL)\n\t\t\tgoto out;\n\t}\n\t*ret_pointer = iov;\n\n\tret = -EFAULT;\n\tif (!access_ok(VERIFY_READ, uvector, nr_segs*sizeof(*uvector)))\n\t\tgoto out;\n\n\t/*\n\t * Single unix specification:\n\t * We should -EINVAL if an element length is not >= 0 and fitting an\n\t * ssize_t.\n\t *\n\t * In Linux, the total length is limited to MAX_RW_COUNT, there is\n\t * no overflow possibility.\n\t */\n\ttot_len = 0;\n\tret = -EINVAL;\n\tfor (seg = 0; seg < nr_segs; seg++) {\n\t\tcompat_uptr_t buf;\n\t\tcompat_ssize_t len;\n\n\t\tif (__get_user(len, &uvector->iov_len) ||\n\t\t   __get_user(buf, &uvector->iov_base)) {\n\t\t\tret = -EFAULT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len < 0)\t/* size_t not fitting in compat_ssize_t .. */\n\t\t\tgoto out;\n\t\tif (type >= 0 &&\n\t\t    !access_ok(vrfy_dir(type), compat_ptr(buf), len)) {\n\t\t\tret = -EFAULT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len > MAX_RW_COUNT - tot_len)\n\t\t\tlen = MAX_RW_COUNT - tot_len;\n\t\ttot_len += len;\n\t\tiov->iov_base = compat_ptr(buf);\n\t\tiov->iov_len = (compat_size_t) len;\n\t\tuvector++;\n\t\tiov++;\n\t}\n\tret = tot_len;\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "buf"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "vrfy_dir(type)",
            "compat_ptr(buf)",
            "len"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "buf"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vrfy_dir",
          "args": [
            "type"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "buf",
            "&uvector->iov_base"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "len",
            "&uvector->iov_len"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_READ",
            "uvector",
            "nr_segs*sizeof(*uvector)"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "nr_segs*sizeof(struct iovec)",
            "GFP_KERNEL"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nssize_t compat_rw_copy_check_uvector(int type,\n\t\tconst struct compat_iovec __user *uvector, unsigned long nr_segs,\n\t\tunsigned long fast_segs, struct iovec *fast_pointer,\n\t\tstruct iovec **ret_pointer)\n{\n\tcompat_ssize_t tot_len;\n\tstruct iovec *iov = *ret_pointer = fast_pointer;\n\tssize_t ret = 0;\n\tint seg;\n\n\t/*\n\t * SuS says \"The readv() function *may* fail if the iovcnt argument\n\t * was less than or equal to 0, or greater than {IOV_MAX}.  Linux has\n\t * traditionally returned zero for zero segments, so...\n\t */\n\tif (nr_segs == 0)\n\t\tgoto out;\n\n\tret = -EINVAL;\n\tif (nr_segs > UIO_MAXIOV || nr_segs < 0)\n\t\tgoto out;\n\tif (nr_segs > fast_segs) {\n\t\tret = -ENOMEM;\n\t\tiov = kmalloc(nr_segs*sizeof(struct iovec), GFP_KERNEL);\n\t\tif (iov == NULL)\n\t\t\tgoto out;\n\t}\n\t*ret_pointer = iov;\n\n\tret = -EFAULT;\n\tif (!access_ok(VERIFY_READ, uvector, nr_segs*sizeof(*uvector)))\n\t\tgoto out;\n\n\t/*\n\t * Single unix specification:\n\t * We should -EINVAL if an element length is not >= 0 and fitting an\n\t * ssize_t.\n\t *\n\t * In Linux, the total length is limited to MAX_RW_COUNT, there is\n\t * no overflow possibility.\n\t */\n\ttot_len = 0;\n\tret = -EINVAL;\n\tfor (seg = 0; seg < nr_segs; seg++) {\n\t\tcompat_uptr_t buf;\n\t\tcompat_ssize_t len;\n\n\t\tif (__get_user(len, &uvector->iov_len) ||\n\t\t   __get_user(buf, &uvector->iov_base)) {\n\t\t\tret = -EFAULT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len < 0)\t/* size_t not fitting in compat_ssize_t .. */\n\t\t\tgoto out;\n\t\tif (type >= 0 &&\n\t\t    !access_ok(vrfy_dir(type), compat_ptr(buf), len)) {\n\t\t\tret = -EFAULT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (len > MAX_RW_COUNT - tot_len)\n\t\t\tlen = MAX_RW_COUNT - tot_len;\n\t\ttot_len += len;\n\t\tiov->iov_base = compat_ptr(buf);\n\t\tiov->iov_len = (compat_size_t) len;\n\t\tuvector++;\n\t\tiov++;\n\t}\n\tret = tot_len;\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "convert_fcntl_cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "402-415",
    "snippet": "static unsigned int\nconvert_fcntl_cmd(unsigned int cmd)\n{\n\tswitch (cmd) {\n\tcase F_GETLK64:\n\t\treturn F_GETLK;\n\tcase F_SETLK64:\n\t\treturn F_SETLK;\n\tcase F_SETLKW64:\n\t\treturn F_SETLKW;\n\t}\n\n\treturn cmd;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic unsigned int\nconvert_fcntl_cmd(unsigned int cmd)\n{\n\tswitch (cmd) {\n\tcase F_GETLK64:\n\t\treturn F_GETLK;\n\tcase F_SETLK64:\n\t\treturn F_SETLK;\n\tcase F_SETLKW64:\n\t\treturn F_SETLKW;\n\t}\n\n\treturn cmd;\n}"
  },
  {
    "function_name": "put_compat_flock64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "389-399",
    "snippet": "static int put_compat_flock64(struct flock *kfl, struct compat_flock64 __user *ufl)\n{\n\tif (!access_ok(VERIFY_WRITE, ufl, sizeof(*ufl)) ||\n\t    __put_user(kfl->l_type, &ufl->l_type) ||\n\t    __put_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __put_user(kfl->l_start, &ufl->l_start) ||\n\t    __put_user(kfl->l_len, &ufl->l_len) ||\n\t    __put_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_pid",
            "&ufl->l_pid"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_len",
            "&ufl->l_len"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_start",
            "&ufl->l_start"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_whence",
            "&ufl->l_whence"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_type",
            "&ufl->l_type"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ufl",
            "sizeof(*ufl)"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int put_compat_flock64(struct flock *kfl, struct compat_flock64 __user *ufl)\n{\n\tif (!access_ok(VERIFY_WRITE, ufl, sizeof(*ufl)) ||\n\t    __put_user(kfl->l_type, &ufl->l_type) ||\n\t    __put_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __put_user(kfl->l_start, &ufl->l_start) ||\n\t    __put_user(kfl->l_len, &ufl->l_len) ||\n\t    __put_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "get_compat_flock64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "375-385",
    "snippet": "static int get_compat_flock64(struct flock *kfl, struct compat_flock64 __user *ufl)\n{\n\tif (!access_ok(VERIFY_READ, ufl, sizeof(*ufl)) ||\n\t    __get_user(kfl->l_type, &ufl->l_type) ||\n\t    __get_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __get_user(kfl->l_start, &ufl->l_start) ||\n\t    __get_user(kfl->l_len, &ufl->l_len) ||\n\t    __get_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_pid",
            "&ufl->l_pid"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_len",
            "&ufl->l_len"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_start",
            "&ufl->l_start"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_whence",
            "&ufl->l_whence"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_type",
            "&ufl->l_type"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_READ",
            "ufl",
            "sizeof(*ufl)"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int get_compat_flock64(struct flock *kfl, struct compat_flock64 __user *ufl)\n{\n\tif (!access_ok(VERIFY_READ, ufl, sizeof(*ufl)) ||\n\t    __get_user(kfl->l_type, &ufl->l_type) ||\n\t    __get_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __get_user(kfl->l_start, &ufl->l_start) ||\n\t    __get_user(kfl->l_len, &ufl->l_len) ||\n\t    __get_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "put_compat_flock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "362-372",
    "snippet": "static int put_compat_flock(struct flock *kfl, struct compat_flock __user *ufl)\n{\n\tif (!access_ok(VERIFY_WRITE, ufl, sizeof(*ufl)) ||\n\t    __put_user(kfl->l_type, &ufl->l_type) ||\n\t    __put_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __put_user(kfl->l_start, &ufl->l_start) ||\n\t    __put_user(kfl->l_len, &ufl->l_len) ||\n\t    __put_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_pid",
            "&ufl->l_pid"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_len",
            "&ufl->l_len"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_start",
            "&ufl->l_start"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_whence",
            "&ufl->l_whence"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kfl->l_type",
            "&ufl->l_type"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ufl",
            "sizeof(*ufl)"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int put_compat_flock(struct flock *kfl, struct compat_flock __user *ufl)\n{\n\tif (!access_ok(VERIFY_WRITE, ufl, sizeof(*ufl)) ||\n\t    __put_user(kfl->l_type, &ufl->l_type) ||\n\t    __put_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __put_user(kfl->l_start, &ufl->l_start) ||\n\t    __put_user(kfl->l_len, &ufl->l_len) ||\n\t    __put_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "get_compat_flock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "350-360",
    "snippet": "static int get_compat_flock(struct flock *kfl, struct compat_flock __user *ufl)\n{\n\tif (!access_ok(VERIFY_READ, ufl, sizeof(*ufl)) ||\n\t    __get_user(kfl->l_type, &ufl->l_type) ||\n\t    __get_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __get_user(kfl->l_start, &ufl->l_start) ||\n\t    __get_user(kfl->l_len, &ufl->l_len) ||\n\t    __get_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_pid",
            "&ufl->l_pid"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_len",
            "&ufl->l_len"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_start",
            "&ufl->l_start"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_whence",
            "&ufl->l_whence"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "kfl->l_type",
            "&ufl->l_type"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_READ",
            "ufl",
            "sizeof(*ufl)"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int get_compat_flock(struct flock *kfl, struct compat_flock __user *ufl)\n{\n\tif (!access_ok(VERIFY_READ, ufl, sizeof(*ufl)) ||\n\t    __get_user(kfl->l_type, &ufl->l_type) ||\n\t    __get_user(kfl->l_whence, &ufl->l_whence) ||\n\t    __get_user(kfl->l_start, &ufl->l_start) ||\n\t    __get_user(kfl->l_len, &ufl->l_len) ||\n\t    __get_user(kfl->l_pid, &ufl->l_pid))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "put_compat_statfs64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "268-299",
    "snippet": "static int put_compat_statfs64(struct compat_statfs64 __user *ubuf, struct kstatfs *kbuf)\n{\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__clear_user",
          "args": [
            "ubuf->f_spare",
            "sizeof(ubuf->f_spare)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_flags",
            "&ubuf->f_flags"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_frsize",
            "&ubuf->f_frsize"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_fsid.val[1]",
            "&ubuf->f_fsid.val[1]"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_fsid.val[0]",
            "&ubuf->f_fsid.val[0]"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_namelen",
            "&ubuf->f_namelen"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_ffree",
            "&ubuf->f_ffree"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_files",
            "&ubuf->f_files"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bavail",
            "&ubuf->f_bavail"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bfree",
            "&ubuf->f_bfree"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_blocks",
            "&ubuf->f_blocks"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bsize",
            "&ubuf->f_bsize"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_type",
            "&ubuf->f_type"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ubuf",
            "sizeof(*ubuf)"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int put_compat_statfs64(struct compat_statfs64 __user *ubuf, struct kstatfs *kbuf)\n{\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "put_compat_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "212-244",
    "snippet": "static int put_compat_statfs(struct compat_statfs __user *ubuf, struct kstatfs *kbuf)\n{\n\t\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__clear_user",
          "args": [
            "ubuf->f_spare",
            "sizeof(ubuf->f_spare)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_flags",
            "&ubuf->f_flags"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_frsize",
            "&ubuf->f_frsize"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_fsid.val[1]",
            "&ubuf->f_fsid.val[1]"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_fsid.val[0]",
            "&ubuf->f_fsid.val[0]"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_namelen",
            "&ubuf->f_namelen"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_ffree",
            "&ubuf->f_ffree"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_files",
            "&ubuf->f_files"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bavail",
            "&ubuf->f_bavail"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bfree",
            "&ubuf->f_bfree"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_blocks",
            "&ubuf->f_blocks"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_bsize",
            "&ubuf->f_bsize"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "kbuf->f_type",
            "&ubuf->f_type"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ubuf",
            "sizeof(*ubuf)"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int put_compat_statfs(struct compat_statfs __user *ubuf, struct kstatfs *kbuf)\n{\n\t\n\tif (sizeof ubuf->f_blocks == 4) {\n\t\tif ((kbuf->f_blocks | kbuf->f_bfree | kbuf->f_bavail |\n\t\t     kbuf->f_bsize | kbuf->f_frsize) & 0xffffffff00000000ULL)\n\t\t\treturn -EOVERFLOW;\n\t\t/* f_files and f_ffree may be -1; it's okay\n\t\t * to stuff that into 32 bits */\n\t\tif (kbuf->f_files != 0xffffffffffffffffULL\n\t\t && (kbuf->f_files & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t\tif (kbuf->f_ffree != 0xffffffffffffffffULL\n\t\t && (kbuf->f_ffree & 0xffffffff00000000ULL))\n\t\t\treturn -EOVERFLOW;\n\t}\n\tif (!access_ok(VERIFY_WRITE, ubuf, sizeof(*ubuf)) ||\n\t    __put_user(kbuf->f_type, &ubuf->f_type) ||\n\t    __put_user(kbuf->f_bsize, &ubuf->f_bsize) ||\n\t    __put_user(kbuf->f_blocks, &ubuf->f_blocks) ||\n\t    __put_user(kbuf->f_bfree, &ubuf->f_bfree) ||\n\t    __put_user(kbuf->f_bavail, &ubuf->f_bavail) ||\n\t    __put_user(kbuf->f_files, &ubuf->f_files) ||\n\t    __put_user(kbuf->f_ffree, &ubuf->f_ffree) ||\n\t    __put_user(kbuf->f_namelen, &ubuf->f_namelen) ||\n\t    __put_user(kbuf->f_fsid.val[0], &ubuf->f_fsid.val[0]) ||\n\t    __put_user(kbuf->f_fsid.val[1], &ubuf->f_fsid.val[1]) ||\n\t    __put_user(kbuf->f_frsize, &ubuf->f_frsize) ||\n\t    __put_user(kbuf->f_flags, &ubuf->f_flags) ||\n\t    __clear_user(ubuf->f_spare, sizeof(ubuf->f_spare)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "cp_compat_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "129-160",
    "snippet": "static int cp_compat_stat(struct kstat *stat, struct compat_stat __user *ubuf)\n{\n\tstruct compat_stat tmp;\n\n\tif (!old_valid_dev(stat->dev) || !old_valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n\tif ((u64) stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(ubuf, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "ubuf",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_GID",
          "args": [
            "tmp.st_gid",
            "from_kgid_munged(current_user_ns(), stat->gid)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_UID",
          "args": [
            "tmp.st_uid",
            "from_kuid_munged(current_user_ns(), stat->uid)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tmp",
            "0",
            "sizeof(tmp)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_valid_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_valid_dev",
          "args": [
            "stat->dev"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nstatic int cp_compat_stat(struct kstat *stat, struct compat_stat __user *ubuf)\n{\n\tstruct compat_stat tmp;\n\n\tif (!old_valid_dev(stat->dev) || !old_valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n\tif ((u64) stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(ubuf, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "compat_printk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
    "lines": "59-69",
    "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/ioctls.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/aio.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/mm.h>",
      "#include <linux/poll.h>",
      "#include <linux/signal.h>",
      "#include <linux/highmem.h>",
      "#include <linux/security.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/personality.h>",
      "#include <linux/highuid.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/dirent.h>",
      "#include <linux/ctype.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/ncp_mount.h>",
      "#include <linux/init.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/vfs.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/namei.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>",
      "#include <linux/compat.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int compat_log = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintk",
          "args": [
            "fmt",
            "ap"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
  }
]