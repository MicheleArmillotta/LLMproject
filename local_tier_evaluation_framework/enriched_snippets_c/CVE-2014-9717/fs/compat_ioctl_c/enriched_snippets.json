[
  {
    "function_name": "nit_sys32_ioctl(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "1630-1635",
    "snippet": "tatic int __init init_sys32_ioctl(void)\n{\n\tsort(ioctl_pointer, ARRAY_SIZE(ioctl_pointer), sizeof(*ioctl_pointer),\n\t\tinit_sys32_ioctl_cmp, NULL);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\nCOMPATIBLE_IOCTL(0x4B50)   /* KDGHWCLK - not in the kernel, but don't complain */\nCOMPATIBLE_IOCTL(0x4B51)   /* KDSHWCLK - not in the kernel, but don't complain */\n\n/* Big T */\nCOMPATIBLE_IOCTL(TCGETA)\nCOMPATIBLE_IOCTL(TCSETA)\nCOMPATIBLE_IOCTL(TCSETAW)\nCOMPATIBLE_IOCTL(TCSETAF)\nCOMPATIBLE_IOCTL(TCSBRK)\nCOMPATIBLE_IOCTL(TCXONC)\nCOMPATIBLE_IOCTL(TCFLSH)\nCOMPATIBLE_IOCTL(TCGETS)\nCOMPATIBLE_IOCTL(TCSETS)\nCOMPATIBLE_IOCTL(TCSETSW)\nCOMPATIBLE_IOCTL(TCSETSF)\nCOMPATIBLE_IOCTL(TIOCLINUX)\nCOMPATIBLE_IOCTL(TIOCSBRK)\nCOMPATIBLE_IOCTL(TIOCGDEV)\nCOMPATIBLE_IOCTL(TIOCCBRK)\nCOMPATIBLE_IOCTL(TIOCGSID)\nCOMPATIBLE_IOCTL(TIOCGICOUNT)\nCOMPATIBLE_IOCTL(TIOCGPKT)\nCOMPATIBLE_IOCTL(TIOCGPTLCK)\nCOMPATIBLE_IOCTL(TIOCGEXCL)\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCGETD)\nCOMPATIBLE_IOCTL(TIOCSETD)\nCOMPATIBLE_IOCTL(TIOCEXCL)\nCOMPATIBLE_IOCTL(TIOCNXCL)\nCOMPATIBLE_IOCTL(TIOCCONS)\nCOMPATIBLE_IOCTL(TIOCGSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSWINSZ)\nCOMPATIBLE_IOCTL(TIOCGWINSZ)\nCOMPATIBLE_IOCTL(TIOCMGET)\nCOMPATIBLE_IOCTL(TIOCMBIC)\nCOMPATIBLE_IOCTL(TIOCMBIS)\nCOMPATIBLE_IOCTL(TIOCMSET)\nCOMPATIBLE_IOCTL(TIOCPKT)\nCOMPATIBLE_IOCTL(TIOCNOTTY)\nCOMPATIBLE_IOCTL(TIOCSTI)\nCOMPATIBLE_IOCTL(TIOCOUTQ)\nCOMPATIBLE_IOCTL(TIOCSPGRP)\nCOMPATIBLE_IOCTL(TIOCGPGRP)\nCOMPATIBLE_IOCTL(TIOCGPTN)\nCOMPATIBLE_IOCTL(TIOCSPTLCK)\nCOMPATIBLE_IOCTL(TIOCSERGETLSR)\nCOMPATIBLE_IOCTL(TIOCSIG)\n#ifdef TIOCSRS485\nCOMPATIBLE_IOCTL(TIOCSRS485)\n#endif\n#ifdef TIOCGRS485\nCOMPATIBLE_IOCTL(TIOCGRS485)\n#endif\n#ifdef TCGETS2\nCOMPATIBLE_IOCTL(TCGETS2)\nCOMPATIBLE_IOCTL(TCSETS2)\nCOMPATIBLE_IOCTL(TCSETSW2)\nCOMPATIBLE_IOCTL(TCSETSF2)\n#endif\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(KDGETKEYCODE)\nCOMPATIBLE_IOCTL(KDSETKEYCODE)\nCOMPATIBLE_IOCTL(KDGKBTYPE)\nCOMPATIBLE_IOCTL(KDGETMODE)\nCOMPATIBLE_IOCTL(KDGKBMODE)\nCOMPATIBLE_IOCTL(KDGKBMETA)\nCOMPATIBLE_IOCTL(KDGKBENT)\nCOMPATIBLE_IOCTL(KDSKBENT)\nCOMPATIBLE_IOCTL(KDGKBSENT)\nCOMPATIBLE_IOCTL(KDSKBSENT)\nCOMPATIBLE_IOCTL(KDGKBDIACR)\nCOMPATIBLE_IOCTL(KDSKBDIACR)\nCOMPATIBLE_IOCTL(KDGKBDIACRUC)\nCOMPATIBLE_IOCTL(KDSKBDIACRUC)\nCOMPATIBLE_IOCTL(KDKBDREP)\nCOMPATIBLE_IOCTL(KDGKBLED)\nCOMPATIBLE_IOCTL(KDGETLED)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* ppdev */\nCOMPATIBLE_IOCTL(PPSETMODE)\nCOMPATIBLE_IOCTL(PPRSTATUS)\nCOMPATIBLE_IOCTL(PPRCONTROL)\nCOMPATIBLE_IOCTL(PPWCONTROL)\nCOMPATIBLE_IOCTL(PPFCONTROL)\nCOMPATIBLE_IOCTL(PPRDATA)\nCOMPATIBLE_IOCTL(PPWDATA)\nCOMPATIBLE_IOCTL(PPCLAIM)\nCOMPATIBLE_IOCTL(PPRELEASE)\nCOMPATIBLE_IOCTL(PPYIELD)\nCOMPATIBLE_IOCTL(PPEXCL)\nCOMPATIBLE_IOCTL(PPDATADIR)\nCOMPATIBLE_IOCTL(PPNEGOT)\nCOMPATIBLE_IOCTL(PPWCTLONIRQ)\nCOMPATIBLE_IOCTL(PPCLRIRQ)\nCOMPATIBLE_IOCTL(PPSETPHASE)\nCOMPATIBLE_IOCTL(PPGETMODES)\nCOMPATIBLE_IOCTL(PPGETMODE)\nCOMPATIBLE_IOCTL(PPGETPHASE)\nCOMPATIBLE_IOCTL(PPGETFLAGS)\nCOMPATIBLE_IOCTL(PPSETFLAGS)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\nCOMPATIBLE_IOCTL(BNEPCONNADD)\nCOMPATIBLE_IOCTL(BNEPCONNDEL)\nCOMPATIBLE_IOCTL(BNEPGETCONNLIST)\nCOMPATIBLE_IOCTL(BNEPGETCONNINFO)\nCOMPATIBLE_IOCTL(CMTPCONNADD)\nCOMPATIBLE_IOCTL(CMTPCONNDEL)\nCOMPATIBLE_IOCTL(CMTPGETCONNLIST)\nCOMPATIBLE_IOCTL(CMTPGETCONNINFO)\nCOMPATIBLE_IOCTL(HIDPCONNADD)\nCOMPATIBLE_IOCTL(HIDPCONNDEL)\nCOMPATIBLE_IOCTL(HIDPGETCONNLIST)\nCOMPATIBLE_IOCTL(HIDPGETCONNINFO)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Siemens Gigaset */\nCOMPATIBLE_IOCTL(GIGASET_REDIR)\nCOMPATIBLE_IOCTL(GIGASET_CONFIG)\nCOMPATIBLE_IOCTL(GIGASET_BRKCHARS)\nCOMPATIBLE_IOCTL(GIGASET_VERSION)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* NBD */\nCOMPATIBLE_IOCTL(NBD_DO_IT)\nCOMPATIBLE_IOCTL(NBD_CLEAR_SOCK)\nCOMPATIBLE_IOCTL(NBD_CLEAR_QUE)\nCOMPATIBLE_IOCTL(NBD_PRINT_DEBUG)\nCOMPATIBLE_IOCTL(NBD_DISCONNECT)\n/* i2c */\nCOMPATIBLE_IOCTL(I2C_SLAVE)\nCOMPATIBLE_IOCTL(I2C_SLAVE_FORCE)\nCOMPATIBLE_IOCTL(I2C_TENBIT)\nCOMPATIBLE_IOCTL(I2C_PEC)\nCOMPATIBLE_IOCTL(I2C_RETRIES)\nCOMPATIBLE_IOCTL(I2C_TIMEOUT)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* dvb */\nCOMPATIBLE_IOCTL(AUDIO_STOP)\nCOMPATIBLE_IOCTL(AUDIO_PLAY)\nCOMPATIBLE_IOCTL(AUDIO_PAUSE)\nCOMPATIBLE_IOCTL(AUDIO_CONTINUE)\nCOMPATIBLE_IOCTL(AUDIO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(AUDIO_SET_MUTE)\nCOMPATIBLE_IOCTL(AUDIO_SET_AV_SYNC)\nCOMPATIBLE_IOCTL(AUDIO_SET_BYPASS_MODE)\nCOMPATIBLE_IOCTL(AUDIO_CHANNEL_SELECT)\nCOMPATIBLE_IOCTL(AUDIO_GET_STATUS)\nCOMPATIBLE_IOCTL(AUDIO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(AUDIO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(AUDIO_SET_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_MIXER)\nCOMPATIBLE_IOCTL(AUDIO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(AUDIO_SET_EXT_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(AUDIO_SET_KARAOKE)\nCOMPATIBLE_IOCTL(DMX_START)\nCOMPATIBLE_IOCTL(DMX_STOP)\nCOMPATIBLE_IOCTL(DMX_SET_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_PES_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_BUFFER_SIZE)\nCOMPATIBLE_IOCTL(DMX_GET_PES_PIDS)\nCOMPATIBLE_IOCTL(DMX_GET_CAPS)\nCOMPATIBLE_IOCTL(DMX_SET_SOURCE)\nCOMPATIBLE_IOCTL(DMX_GET_STC)\nCOMPATIBLE_IOCTL(FE_GET_INFO)\nCOMPATIBLE_IOCTL(FE_DISEQC_RESET_OVERLOAD)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_MASTER_CMD)\nCOMPATIBLE_IOCTL(FE_DISEQC_RECV_SLAVE_REPLY)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_BURST)\nCOMPATIBLE_IOCTL(FE_SET_TONE)\nCOMPATIBLE_IOCTL(FE_SET_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_ENABLE_HIGH_LNB_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_READ_STATUS)\nCOMPATIBLE_IOCTL(FE_READ_BER)\nCOMPATIBLE_IOCTL(FE_READ_SIGNAL_STRENGTH)\nCOMPATIBLE_IOCTL(FE_READ_SNR)\nCOMPATIBLE_IOCTL(FE_READ_UNCORRECTED_BLOCKS)\nCOMPATIBLE_IOCTL(FE_SET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_EVENT)\nCOMPATIBLE_IOCTL(FE_DISHNETWORK_SEND_LEGACY_CMD)\nCOMPATIBLE_IOCTL(VIDEO_STOP)\nCOMPATIBLE_IOCTL(VIDEO_PLAY)\nCOMPATIBLE_IOCTL(VIDEO_FREEZE)\nCOMPATIBLE_IOCTL(VIDEO_CONTINUE)\nCOMPATIBLE_IOCTL(VIDEO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(VIDEO_SET_BLANK)\nCOMPATIBLE_IOCTL(VIDEO_GET_STATUS)\nCOMPATIBLE_IOCTL(VIDEO_SET_DISPLAY_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_FAST_FORWARD)\nCOMPATIBLE_IOCTL(VIDEO_SLOWMOTION)\nCOMPATIBLE_IOCTL(VIDEO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(VIDEO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(VIDEO_SET_ID)\nCOMPATIBLE_IOCTL(VIDEO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(VIDEO_SET_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SYSTEM)\nCOMPATIBLE_IOCTL(VIDEO_SET_HIGHLIGHT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SPU)\nCOMPATIBLE_IOCTL(VIDEO_GET_NAVI)\nCOMPATIBLE_IOCTL(VIDEO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(VIDEO_GET_SIZE)\nCOMPATIBLE_IOCTL(VIDEO_GET_FRAME_RATE)\n\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n#ifdef TIOCGLTC\nCOMPATIBLE_IOCTL(TIOCGLTC)\nCOMPATIBLE_IOCTL(TIOCSLTC)\n#endif\n#ifdef TIOCSTART\n/*\n * For these two we have definitions in ioctls.h and/or termios.h on\n * some architectures but no actual implemention.  Some applications\n * like bash call them if they are defined in the headers, so we provide\n * entries here to avoid syslog message spew.\n */\nCOMPATIBLE_IOCTL(TIOCSTART)\nCOMPATIBLE_IOCTL(TIOCSTOP)\n#endif\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ort(",
          "args": [
            "octl_pointer,",
            "RRAY_SIZE(ioctl_pointer),",
            "izeof(*ioctl_pointer),",
            "nit_sys32_ioctl_cmp,",
            "ULL)"
          ],
          "line": 1632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RRAY_SIZE(",
          "args": [
            "octl_pointer)"
          ],
          "line": 1632
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\nCOMPATIBLE_IOCTL(0x4B50)   /* KDGHWCLK - not in the kernel, but don't complain */\nCOMPATIBLE_IOCTL(0x4B51)   /* KDSHWCLK - not in the kernel, but don't complain */\n\n/* Big T */\nCOMPATIBLE_IOCTL(TCGETA)\nCOMPATIBLE_IOCTL(TCSETA)\nCOMPATIBLE_IOCTL(TCSETAW)\nCOMPATIBLE_IOCTL(TCSETAF)\nCOMPATIBLE_IOCTL(TCSBRK)\nCOMPATIBLE_IOCTL(TCXONC)\nCOMPATIBLE_IOCTL(TCFLSH)\nCOMPATIBLE_IOCTL(TCGETS)\nCOMPATIBLE_IOCTL(TCSETS)\nCOMPATIBLE_IOCTL(TCSETSW)\nCOMPATIBLE_IOCTL(TCSETSF)\nCOMPATIBLE_IOCTL(TIOCLINUX)\nCOMPATIBLE_IOCTL(TIOCSBRK)\nCOMPATIBLE_IOCTL(TIOCGDEV)\nCOMPATIBLE_IOCTL(TIOCCBRK)\nCOMPATIBLE_IOCTL(TIOCGSID)\nCOMPATIBLE_IOCTL(TIOCGICOUNT)\nCOMPATIBLE_IOCTL(TIOCGPKT)\nCOMPATIBLE_IOCTL(TIOCGPTLCK)\nCOMPATIBLE_IOCTL(TIOCGEXCL)\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCGETD)\nCOMPATIBLE_IOCTL(TIOCSETD)\nCOMPATIBLE_IOCTL(TIOCEXCL)\nCOMPATIBLE_IOCTL(TIOCNXCL)\nCOMPATIBLE_IOCTL(TIOCCONS)\nCOMPATIBLE_IOCTL(TIOCGSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSWINSZ)\nCOMPATIBLE_IOCTL(TIOCGWINSZ)\nCOMPATIBLE_IOCTL(TIOCMGET)\nCOMPATIBLE_IOCTL(TIOCMBIC)\nCOMPATIBLE_IOCTL(TIOCMBIS)\nCOMPATIBLE_IOCTL(TIOCMSET)\nCOMPATIBLE_IOCTL(TIOCPKT)\nCOMPATIBLE_IOCTL(TIOCNOTTY)\nCOMPATIBLE_IOCTL(TIOCSTI)\nCOMPATIBLE_IOCTL(TIOCOUTQ)\nCOMPATIBLE_IOCTL(TIOCSPGRP)\nCOMPATIBLE_IOCTL(TIOCGPGRP)\nCOMPATIBLE_IOCTL(TIOCGPTN)\nCOMPATIBLE_IOCTL(TIOCSPTLCK)\nCOMPATIBLE_IOCTL(TIOCSERGETLSR)\nCOMPATIBLE_IOCTL(TIOCSIG)\n#ifdef TIOCSRS485\nCOMPATIBLE_IOCTL(TIOCSRS485)\n#endif\n#ifdef TIOCGRS485\nCOMPATIBLE_IOCTL(TIOCGRS485)\n#endif\n#ifdef TCGETS2\nCOMPATIBLE_IOCTL(TCGETS2)\nCOMPATIBLE_IOCTL(TCSETS2)\nCOMPATIBLE_IOCTL(TCSETSW2)\nCOMPATIBLE_IOCTL(TCSETSF2)\n#endif\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(KDGETKEYCODE)\nCOMPATIBLE_IOCTL(KDSETKEYCODE)\nCOMPATIBLE_IOCTL(KDGKBTYPE)\nCOMPATIBLE_IOCTL(KDGETMODE)\nCOMPATIBLE_IOCTL(KDGKBMODE)\nCOMPATIBLE_IOCTL(KDGKBMETA)\nCOMPATIBLE_IOCTL(KDGKBENT)\nCOMPATIBLE_IOCTL(KDSKBENT)\nCOMPATIBLE_IOCTL(KDGKBSENT)\nCOMPATIBLE_IOCTL(KDSKBSENT)\nCOMPATIBLE_IOCTL(KDGKBDIACR)\nCOMPATIBLE_IOCTL(KDSKBDIACR)\nCOMPATIBLE_IOCTL(KDGKBDIACRUC)\nCOMPATIBLE_IOCTL(KDSKBDIACRUC)\nCOMPATIBLE_IOCTL(KDKBDREP)\nCOMPATIBLE_IOCTL(KDGKBLED)\nCOMPATIBLE_IOCTL(KDGETLED)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* ppdev */\nCOMPATIBLE_IOCTL(PPSETMODE)\nCOMPATIBLE_IOCTL(PPRSTATUS)\nCOMPATIBLE_IOCTL(PPRCONTROL)\nCOMPATIBLE_IOCTL(PPWCONTROL)\nCOMPATIBLE_IOCTL(PPFCONTROL)\nCOMPATIBLE_IOCTL(PPRDATA)\nCOMPATIBLE_IOCTL(PPWDATA)\nCOMPATIBLE_IOCTL(PPCLAIM)\nCOMPATIBLE_IOCTL(PPRELEASE)\nCOMPATIBLE_IOCTL(PPYIELD)\nCOMPATIBLE_IOCTL(PPEXCL)\nCOMPATIBLE_IOCTL(PPDATADIR)\nCOMPATIBLE_IOCTL(PPNEGOT)\nCOMPATIBLE_IOCTL(PPWCTLONIRQ)\nCOMPATIBLE_IOCTL(PPCLRIRQ)\nCOMPATIBLE_IOCTL(PPSETPHASE)\nCOMPATIBLE_IOCTL(PPGETMODES)\nCOMPATIBLE_IOCTL(PPGETMODE)\nCOMPATIBLE_IOCTL(PPGETPHASE)\nCOMPATIBLE_IOCTL(PPGETFLAGS)\nCOMPATIBLE_IOCTL(PPSETFLAGS)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\nCOMPATIBLE_IOCTL(BNEPCONNADD)\nCOMPATIBLE_IOCTL(BNEPCONNDEL)\nCOMPATIBLE_IOCTL(BNEPGETCONNLIST)\nCOMPATIBLE_IOCTL(BNEPGETCONNINFO)\nCOMPATIBLE_IOCTL(CMTPCONNADD)\nCOMPATIBLE_IOCTL(CMTPCONNDEL)\nCOMPATIBLE_IOCTL(CMTPGETCONNLIST)\nCOMPATIBLE_IOCTL(CMTPGETCONNINFO)\nCOMPATIBLE_IOCTL(HIDPCONNADD)\nCOMPATIBLE_IOCTL(HIDPCONNDEL)\nCOMPATIBLE_IOCTL(HIDPGETCONNLIST)\nCOMPATIBLE_IOCTL(HIDPGETCONNINFO)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Siemens Gigaset */\nCOMPATIBLE_IOCTL(GIGASET_REDIR)\nCOMPATIBLE_IOCTL(GIGASET_CONFIG)\nCOMPATIBLE_IOCTL(GIGASET_BRKCHARS)\nCOMPATIBLE_IOCTL(GIGASET_VERSION)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* NBD */\nCOMPATIBLE_IOCTL(NBD_DO_IT)\nCOMPATIBLE_IOCTL(NBD_CLEAR_SOCK)\nCOMPATIBLE_IOCTL(NBD_CLEAR_QUE)\nCOMPATIBLE_IOCTL(NBD_PRINT_DEBUG)\nCOMPATIBLE_IOCTL(NBD_DISCONNECT)\n/* i2c */\nCOMPATIBLE_IOCTL(I2C_SLAVE)\nCOMPATIBLE_IOCTL(I2C_SLAVE_FORCE)\nCOMPATIBLE_IOCTL(I2C_TENBIT)\nCOMPATIBLE_IOCTL(I2C_PEC)\nCOMPATIBLE_IOCTL(I2C_RETRIES)\nCOMPATIBLE_IOCTL(I2C_TIMEOUT)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* dvb */\nCOMPATIBLE_IOCTL(AUDIO_STOP)\nCOMPATIBLE_IOCTL(AUDIO_PLAY)\nCOMPATIBLE_IOCTL(AUDIO_PAUSE)\nCOMPATIBLE_IOCTL(AUDIO_CONTINUE)\nCOMPATIBLE_IOCTL(AUDIO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(AUDIO_SET_MUTE)\nCOMPATIBLE_IOCTL(AUDIO_SET_AV_SYNC)\nCOMPATIBLE_IOCTL(AUDIO_SET_BYPASS_MODE)\nCOMPATIBLE_IOCTL(AUDIO_CHANNEL_SELECT)\nCOMPATIBLE_IOCTL(AUDIO_GET_STATUS)\nCOMPATIBLE_IOCTL(AUDIO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(AUDIO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(AUDIO_SET_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_MIXER)\nCOMPATIBLE_IOCTL(AUDIO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(AUDIO_SET_EXT_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(AUDIO_SET_KARAOKE)\nCOMPATIBLE_IOCTL(DMX_START)\nCOMPATIBLE_IOCTL(DMX_STOP)\nCOMPATIBLE_IOCTL(DMX_SET_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_PES_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_BUFFER_SIZE)\nCOMPATIBLE_IOCTL(DMX_GET_PES_PIDS)\nCOMPATIBLE_IOCTL(DMX_GET_CAPS)\nCOMPATIBLE_IOCTL(DMX_SET_SOURCE)\nCOMPATIBLE_IOCTL(DMX_GET_STC)\nCOMPATIBLE_IOCTL(FE_GET_INFO)\nCOMPATIBLE_IOCTL(FE_DISEQC_RESET_OVERLOAD)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_MASTER_CMD)\nCOMPATIBLE_IOCTL(FE_DISEQC_RECV_SLAVE_REPLY)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_BURST)\nCOMPATIBLE_IOCTL(FE_SET_TONE)\nCOMPATIBLE_IOCTL(FE_SET_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_ENABLE_HIGH_LNB_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_READ_STATUS)\nCOMPATIBLE_IOCTL(FE_READ_BER)\nCOMPATIBLE_IOCTL(FE_READ_SIGNAL_STRENGTH)\nCOMPATIBLE_IOCTL(FE_READ_SNR)\nCOMPATIBLE_IOCTL(FE_READ_UNCORRECTED_BLOCKS)\nCOMPATIBLE_IOCTL(FE_SET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_EVENT)\nCOMPATIBLE_IOCTL(FE_DISHNETWORK_SEND_LEGACY_CMD)\nCOMPATIBLE_IOCTL(VIDEO_STOP)\nCOMPATIBLE_IOCTL(VIDEO_PLAY)\nCOMPATIBLE_IOCTL(VIDEO_FREEZE)\nCOMPATIBLE_IOCTL(VIDEO_CONTINUE)\nCOMPATIBLE_IOCTL(VIDEO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(VIDEO_SET_BLANK)\nCOMPATIBLE_IOCTL(VIDEO_GET_STATUS)\nCOMPATIBLE_IOCTL(VIDEO_SET_DISPLAY_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_FAST_FORWARD)\nCOMPATIBLE_IOCTL(VIDEO_SLOWMOTION)\nCOMPATIBLE_IOCTL(VIDEO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(VIDEO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(VIDEO_SET_ID)\nCOMPATIBLE_IOCTL(VIDEO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(VIDEO_SET_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SYSTEM)\nCOMPATIBLE_IOCTL(VIDEO_SET_HIGHLIGHT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SPU)\nCOMPATIBLE_IOCTL(VIDEO_GET_NAVI)\nCOMPATIBLE_IOCTL(VIDEO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(VIDEO_GET_SIZE)\nCOMPATIBLE_IOCTL(VIDEO_GET_FRAME_RATE)\n\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n#ifdef TIOCGLTC\nCOMPATIBLE_IOCTL(TIOCGLTC)\nCOMPATIBLE_IOCTL(TIOCSLTC)\n#endif\n#ifdef TIOCSTART\n/*\n * For these two we have definitions in ioctls.h and/or termios.h on\n * some architectures but no actual implemention.  Some applications\n * like bash call them if they are defined in the headers, so we provide\n * entries here to avoid syslog message spew.\n */\nCOMPATIBLE_IOCTL(TIOCSTART)\nCOMPATIBLE_IOCTL(TIOCSTOP)\n#endif\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};\n\ntatic int __init init_sys32_ioctl(void)\n{\n\tsort(ioctl_pointer, ARRAY_SIZE(ioctl_pointer), sizeof(*ioctl_pointer),\n\t\tinit_sys32_ioctl_cmp, NULL);\n\treturn 0;\n}"
  },
  {
    "function_name": "nit_sys32_ioctl_cmp(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "1618-1628",
    "snippet": "tatic int __init init_sys32_ioctl_cmp(const void *p, const void *q)\n{\n\tunsigned int a, b;\n\ta = *(unsigned int *)p;\n\tb = *(unsigned int *)q;\n\tif (a > b)\n\t\treturn 1;\n\tif (a < b)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\ntatic int __init init_sys32_ioctl_cmp(const void *p, const void *q)\n{\n\tunsigned int a, b;\n\ta = *(unsigned int *)p;\n\tb = *(unsigned int *)q;\n\tif (a > b)\n\t\treturn 1;\n\tif (a < b)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "ompat_ioctl_check_table(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "1519-1539",
    "snippet": "tatic int compat_ioctl_check_table(unsigned int xcmd)\n{\n\tint i;\n\tconst int max = ARRAY_SIZE(ioctl_pointer) - 1;\n\n\tBUILD_BUG_ON(max >= (1 << 16));\n\n\t/* guess initial offset into table, assuming a\n\t   normalized distribution */\n\ti = ((xcmd >> 16) * max) >> 16;\n\n\t/* do linear search up first, until greater or equal */\n\twhile (ioctl_pointer[i] < xcmd && i < max)\n\t\ti++;\n\n\t/* then do linear search down */\n\twhile (ioctl_pointer[i] > xcmd && i > 0)\n\t\ti--;\n\n\treturn ioctl_pointer[i] == xcmd;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\nCOMPATIBLE_IOCTL(0x4B50)   /* KDGHWCLK - not in the kernel, but don't complain */\nCOMPATIBLE_IOCTL(0x4B51)   /* KDSHWCLK - not in the kernel, but don't complain */\n\n/* Big T */\nCOMPATIBLE_IOCTL(TCGETA)\nCOMPATIBLE_IOCTL(TCSETA)\nCOMPATIBLE_IOCTL(TCSETAW)\nCOMPATIBLE_IOCTL(TCSETAF)\nCOMPATIBLE_IOCTL(TCSBRK)\nCOMPATIBLE_IOCTL(TCXONC)\nCOMPATIBLE_IOCTL(TCFLSH)\nCOMPATIBLE_IOCTL(TCGETS)\nCOMPATIBLE_IOCTL(TCSETS)\nCOMPATIBLE_IOCTL(TCSETSW)\nCOMPATIBLE_IOCTL(TCSETSF)\nCOMPATIBLE_IOCTL(TIOCLINUX)\nCOMPATIBLE_IOCTL(TIOCSBRK)\nCOMPATIBLE_IOCTL(TIOCGDEV)\nCOMPATIBLE_IOCTL(TIOCCBRK)\nCOMPATIBLE_IOCTL(TIOCGSID)\nCOMPATIBLE_IOCTL(TIOCGICOUNT)\nCOMPATIBLE_IOCTL(TIOCGPKT)\nCOMPATIBLE_IOCTL(TIOCGPTLCK)\nCOMPATIBLE_IOCTL(TIOCGEXCL)\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCGETD)\nCOMPATIBLE_IOCTL(TIOCSETD)\nCOMPATIBLE_IOCTL(TIOCEXCL)\nCOMPATIBLE_IOCTL(TIOCNXCL)\nCOMPATIBLE_IOCTL(TIOCCONS)\nCOMPATIBLE_IOCTL(TIOCGSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSWINSZ)\nCOMPATIBLE_IOCTL(TIOCGWINSZ)\nCOMPATIBLE_IOCTL(TIOCMGET)\nCOMPATIBLE_IOCTL(TIOCMBIC)\nCOMPATIBLE_IOCTL(TIOCMBIS)\nCOMPATIBLE_IOCTL(TIOCMSET)\nCOMPATIBLE_IOCTL(TIOCPKT)\nCOMPATIBLE_IOCTL(TIOCNOTTY)\nCOMPATIBLE_IOCTL(TIOCSTI)\nCOMPATIBLE_IOCTL(TIOCOUTQ)\nCOMPATIBLE_IOCTL(TIOCSPGRP)\nCOMPATIBLE_IOCTL(TIOCGPGRP)\nCOMPATIBLE_IOCTL(TIOCGPTN)\nCOMPATIBLE_IOCTL(TIOCSPTLCK)\nCOMPATIBLE_IOCTL(TIOCSERGETLSR)\nCOMPATIBLE_IOCTL(TIOCSIG)\n#ifdef TIOCSRS485\nCOMPATIBLE_IOCTL(TIOCSRS485)\n#endif\n#ifdef TIOCGRS485\nCOMPATIBLE_IOCTL(TIOCGRS485)\n#endif\n#ifdef TCGETS2\nCOMPATIBLE_IOCTL(TCGETS2)\nCOMPATIBLE_IOCTL(TCSETS2)\nCOMPATIBLE_IOCTL(TCSETSW2)\nCOMPATIBLE_IOCTL(TCSETSF2)\n#endif\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(KDGETKEYCODE)\nCOMPATIBLE_IOCTL(KDSETKEYCODE)\nCOMPATIBLE_IOCTL(KDGKBTYPE)\nCOMPATIBLE_IOCTL(KDGETMODE)\nCOMPATIBLE_IOCTL(KDGKBMODE)\nCOMPATIBLE_IOCTL(KDGKBMETA)\nCOMPATIBLE_IOCTL(KDGKBENT)\nCOMPATIBLE_IOCTL(KDSKBENT)\nCOMPATIBLE_IOCTL(KDGKBSENT)\nCOMPATIBLE_IOCTL(KDSKBSENT)\nCOMPATIBLE_IOCTL(KDGKBDIACR)\nCOMPATIBLE_IOCTL(KDSKBDIACR)\nCOMPATIBLE_IOCTL(KDGKBDIACRUC)\nCOMPATIBLE_IOCTL(KDSKBDIACRUC)\nCOMPATIBLE_IOCTL(KDKBDREP)\nCOMPATIBLE_IOCTL(KDGKBLED)\nCOMPATIBLE_IOCTL(KDGETLED)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* ppdev */\nCOMPATIBLE_IOCTL(PPSETMODE)\nCOMPATIBLE_IOCTL(PPRSTATUS)\nCOMPATIBLE_IOCTL(PPRCONTROL)\nCOMPATIBLE_IOCTL(PPWCONTROL)\nCOMPATIBLE_IOCTL(PPFCONTROL)\nCOMPATIBLE_IOCTL(PPRDATA)\nCOMPATIBLE_IOCTL(PPWDATA)\nCOMPATIBLE_IOCTL(PPCLAIM)\nCOMPATIBLE_IOCTL(PPRELEASE)\nCOMPATIBLE_IOCTL(PPYIELD)\nCOMPATIBLE_IOCTL(PPEXCL)\nCOMPATIBLE_IOCTL(PPDATADIR)\nCOMPATIBLE_IOCTL(PPNEGOT)\nCOMPATIBLE_IOCTL(PPWCTLONIRQ)\nCOMPATIBLE_IOCTL(PPCLRIRQ)\nCOMPATIBLE_IOCTL(PPSETPHASE)\nCOMPATIBLE_IOCTL(PPGETMODES)\nCOMPATIBLE_IOCTL(PPGETMODE)\nCOMPATIBLE_IOCTL(PPGETPHASE)\nCOMPATIBLE_IOCTL(PPGETFLAGS)\nCOMPATIBLE_IOCTL(PPSETFLAGS)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\nCOMPATIBLE_IOCTL(BNEPCONNADD)\nCOMPATIBLE_IOCTL(BNEPCONNDEL)\nCOMPATIBLE_IOCTL(BNEPGETCONNLIST)\nCOMPATIBLE_IOCTL(BNEPGETCONNINFO)\nCOMPATIBLE_IOCTL(CMTPCONNADD)\nCOMPATIBLE_IOCTL(CMTPCONNDEL)\nCOMPATIBLE_IOCTL(CMTPGETCONNLIST)\nCOMPATIBLE_IOCTL(CMTPGETCONNINFO)\nCOMPATIBLE_IOCTL(HIDPCONNADD)\nCOMPATIBLE_IOCTL(HIDPCONNDEL)\nCOMPATIBLE_IOCTL(HIDPGETCONNLIST)\nCOMPATIBLE_IOCTL(HIDPGETCONNINFO)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Siemens Gigaset */\nCOMPATIBLE_IOCTL(GIGASET_REDIR)\nCOMPATIBLE_IOCTL(GIGASET_CONFIG)\nCOMPATIBLE_IOCTL(GIGASET_BRKCHARS)\nCOMPATIBLE_IOCTL(GIGASET_VERSION)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* NBD */\nCOMPATIBLE_IOCTL(NBD_DO_IT)\nCOMPATIBLE_IOCTL(NBD_CLEAR_SOCK)\nCOMPATIBLE_IOCTL(NBD_CLEAR_QUE)\nCOMPATIBLE_IOCTL(NBD_PRINT_DEBUG)\nCOMPATIBLE_IOCTL(NBD_DISCONNECT)\n/* i2c */\nCOMPATIBLE_IOCTL(I2C_SLAVE)\nCOMPATIBLE_IOCTL(I2C_SLAVE_FORCE)\nCOMPATIBLE_IOCTL(I2C_TENBIT)\nCOMPATIBLE_IOCTL(I2C_PEC)\nCOMPATIBLE_IOCTL(I2C_RETRIES)\nCOMPATIBLE_IOCTL(I2C_TIMEOUT)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* dvb */\nCOMPATIBLE_IOCTL(AUDIO_STOP)\nCOMPATIBLE_IOCTL(AUDIO_PLAY)\nCOMPATIBLE_IOCTL(AUDIO_PAUSE)\nCOMPATIBLE_IOCTL(AUDIO_CONTINUE)\nCOMPATIBLE_IOCTL(AUDIO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(AUDIO_SET_MUTE)\nCOMPATIBLE_IOCTL(AUDIO_SET_AV_SYNC)\nCOMPATIBLE_IOCTL(AUDIO_SET_BYPASS_MODE)\nCOMPATIBLE_IOCTL(AUDIO_CHANNEL_SELECT)\nCOMPATIBLE_IOCTL(AUDIO_GET_STATUS)\nCOMPATIBLE_IOCTL(AUDIO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(AUDIO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(AUDIO_SET_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_MIXER)\nCOMPATIBLE_IOCTL(AUDIO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(AUDIO_SET_EXT_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(AUDIO_SET_KARAOKE)\nCOMPATIBLE_IOCTL(DMX_START)\nCOMPATIBLE_IOCTL(DMX_STOP)\nCOMPATIBLE_IOCTL(DMX_SET_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_PES_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_BUFFER_SIZE)\nCOMPATIBLE_IOCTL(DMX_GET_PES_PIDS)\nCOMPATIBLE_IOCTL(DMX_GET_CAPS)\nCOMPATIBLE_IOCTL(DMX_SET_SOURCE)\nCOMPATIBLE_IOCTL(DMX_GET_STC)\nCOMPATIBLE_IOCTL(FE_GET_INFO)\nCOMPATIBLE_IOCTL(FE_DISEQC_RESET_OVERLOAD)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_MASTER_CMD)\nCOMPATIBLE_IOCTL(FE_DISEQC_RECV_SLAVE_REPLY)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_BURST)\nCOMPATIBLE_IOCTL(FE_SET_TONE)\nCOMPATIBLE_IOCTL(FE_SET_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_ENABLE_HIGH_LNB_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_READ_STATUS)\nCOMPATIBLE_IOCTL(FE_READ_BER)\nCOMPATIBLE_IOCTL(FE_READ_SIGNAL_STRENGTH)\nCOMPATIBLE_IOCTL(FE_READ_SNR)\nCOMPATIBLE_IOCTL(FE_READ_UNCORRECTED_BLOCKS)\nCOMPATIBLE_IOCTL(FE_SET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_EVENT)\nCOMPATIBLE_IOCTL(FE_DISHNETWORK_SEND_LEGACY_CMD)\nCOMPATIBLE_IOCTL(VIDEO_STOP)\nCOMPATIBLE_IOCTL(VIDEO_PLAY)\nCOMPATIBLE_IOCTL(VIDEO_FREEZE)\nCOMPATIBLE_IOCTL(VIDEO_CONTINUE)\nCOMPATIBLE_IOCTL(VIDEO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(VIDEO_SET_BLANK)\nCOMPATIBLE_IOCTL(VIDEO_GET_STATUS)\nCOMPATIBLE_IOCTL(VIDEO_SET_DISPLAY_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_FAST_FORWARD)\nCOMPATIBLE_IOCTL(VIDEO_SLOWMOTION)\nCOMPATIBLE_IOCTL(VIDEO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(VIDEO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(VIDEO_SET_ID)\nCOMPATIBLE_IOCTL(VIDEO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(VIDEO_SET_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SYSTEM)\nCOMPATIBLE_IOCTL(VIDEO_SET_HIGHLIGHT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SPU)\nCOMPATIBLE_IOCTL(VIDEO_GET_NAVI)\nCOMPATIBLE_IOCTL(VIDEO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(VIDEO_GET_SIZE)\nCOMPATIBLE_IOCTL(VIDEO_GET_FRAME_RATE)\n\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n#ifdef TIOCGLTC\nCOMPATIBLE_IOCTL(TIOCGLTC)\nCOMPATIBLE_IOCTL(TIOCSLTC)\n#endif\n#ifdef TIOCSTART\n/*\n * For these two we have definitions in ioctls.h and/or termios.h on\n * some architectures but no actual implemention.  Some applications\n * like bash call them if they are defined in the headers, so we provide\n * entries here to avoid syslog message spew.\n */\nCOMPATIBLE_IOCTL(TIOCSTART)\nCOMPATIBLE_IOCTL(TIOCSTOP)\n#endif\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "UILD_BUG_ON(",
          "args": [
            "ax >= (1 << 16))"
          ],
          "line": 1524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RRAY_SIZE(",
          "args": [
            "octl_pointer)"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\nCOMPATIBLE_IOCTL(0x4B50)   /* KDGHWCLK - not in the kernel, but don't complain */\nCOMPATIBLE_IOCTL(0x4B51)   /* KDSHWCLK - not in the kernel, but don't complain */\n\n/* Big T */\nCOMPATIBLE_IOCTL(TCGETA)\nCOMPATIBLE_IOCTL(TCSETA)\nCOMPATIBLE_IOCTL(TCSETAW)\nCOMPATIBLE_IOCTL(TCSETAF)\nCOMPATIBLE_IOCTL(TCSBRK)\nCOMPATIBLE_IOCTL(TCXONC)\nCOMPATIBLE_IOCTL(TCFLSH)\nCOMPATIBLE_IOCTL(TCGETS)\nCOMPATIBLE_IOCTL(TCSETS)\nCOMPATIBLE_IOCTL(TCSETSW)\nCOMPATIBLE_IOCTL(TCSETSF)\nCOMPATIBLE_IOCTL(TIOCLINUX)\nCOMPATIBLE_IOCTL(TIOCSBRK)\nCOMPATIBLE_IOCTL(TIOCGDEV)\nCOMPATIBLE_IOCTL(TIOCCBRK)\nCOMPATIBLE_IOCTL(TIOCGSID)\nCOMPATIBLE_IOCTL(TIOCGICOUNT)\nCOMPATIBLE_IOCTL(TIOCGPKT)\nCOMPATIBLE_IOCTL(TIOCGPTLCK)\nCOMPATIBLE_IOCTL(TIOCGEXCL)\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCGETD)\nCOMPATIBLE_IOCTL(TIOCSETD)\nCOMPATIBLE_IOCTL(TIOCEXCL)\nCOMPATIBLE_IOCTL(TIOCNXCL)\nCOMPATIBLE_IOCTL(TIOCCONS)\nCOMPATIBLE_IOCTL(TIOCGSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSSOFTCAR)\nCOMPATIBLE_IOCTL(TIOCSWINSZ)\nCOMPATIBLE_IOCTL(TIOCGWINSZ)\nCOMPATIBLE_IOCTL(TIOCMGET)\nCOMPATIBLE_IOCTL(TIOCMBIC)\nCOMPATIBLE_IOCTL(TIOCMBIS)\nCOMPATIBLE_IOCTL(TIOCMSET)\nCOMPATIBLE_IOCTL(TIOCPKT)\nCOMPATIBLE_IOCTL(TIOCNOTTY)\nCOMPATIBLE_IOCTL(TIOCSTI)\nCOMPATIBLE_IOCTL(TIOCOUTQ)\nCOMPATIBLE_IOCTL(TIOCSPGRP)\nCOMPATIBLE_IOCTL(TIOCGPGRP)\nCOMPATIBLE_IOCTL(TIOCGPTN)\nCOMPATIBLE_IOCTL(TIOCSPTLCK)\nCOMPATIBLE_IOCTL(TIOCSERGETLSR)\nCOMPATIBLE_IOCTL(TIOCSIG)\n#ifdef TIOCSRS485\nCOMPATIBLE_IOCTL(TIOCSRS485)\n#endif\n#ifdef TIOCGRS485\nCOMPATIBLE_IOCTL(TIOCGRS485)\n#endif\n#ifdef TCGETS2\nCOMPATIBLE_IOCTL(TCGETS2)\nCOMPATIBLE_IOCTL(TCSETS2)\nCOMPATIBLE_IOCTL(TCSETSW2)\nCOMPATIBLE_IOCTL(TCSETSF2)\n#endif\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(KDGETKEYCODE)\nCOMPATIBLE_IOCTL(KDSETKEYCODE)\nCOMPATIBLE_IOCTL(KDGKBTYPE)\nCOMPATIBLE_IOCTL(KDGETMODE)\nCOMPATIBLE_IOCTL(KDGKBMODE)\nCOMPATIBLE_IOCTL(KDGKBMETA)\nCOMPATIBLE_IOCTL(KDGKBENT)\nCOMPATIBLE_IOCTL(KDSKBENT)\nCOMPATIBLE_IOCTL(KDGKBSENT)\nCOMPATIBLE_IOCTL(KDSKBSENT)\nCOMPATIBLE_IOCTL(KDGKBDIACR)\nCOMPATIBLE_IOCTL(KDSKBDIACR)\nCOMPATIBLE_IOCTL(KDGKBDIACRUC)\nCOMPATIBLE_IOCTL(KDSKBDIACRUC)\nCOMPATIBLE_IOCTL(KDKBDREP)\nCOMPATIBLE_IOCTL(KDGKBLED)\nCOMPATIBLE_IOCTL(KDGETLED)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* ppdev */\nCOMPATIBLE_IOCTL(PPSETMODE)\nCOMPATIBLE_IOCTL(PPRSTATUS)\nCOMPATIBLE_IOCTL(PPRCONTROL)\nCOMPATIBLE_IOCTL(PPWCONTROL)\nCOMPATIBLE_IOCTL(PPFCONTROL)\nCOMPATIBLE_IOCTL(PPRDATA)\nCOMPATIBLE_IOCTL(PPWDATA)\nCOMPATIBLE_IOCTL(PPCLAIM)\nCOMPATIBLE_IOCTL(PPRELEASE)\nCOMPATIBLE_IOCTL(PPYIELD)\nCOMPATIBLE_IOCTL(PPEXCL)\nCOMPATIBLE_IOCTL(PPDATADIR)\nCOMPATIBLE_IOCTL(PPNEGOT)\nCOMPATIBLE_IOCTL(PPWCTLONIRQ)\nCOMPATIBLE_IOCTL(PPCLRIRQ)\nCOMPATIBLE_IOCTL(PPSETPHASE)\nCOMPATIBLE_IOCTL(PPGETMODES)\nCOMPATIBLE_IOCTL(PPGETMODE)\nCOMPATIBLE_IOCTL(PPGETPHASE)\nCOMPATIBLE_IOCTL(PPGETFLAGS)\nCOMPATIBLE_IOCTL(PPSETFLAGS)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\nCOMPATIBLE_IOCTL(BNEPCONNADD)\nCOMPATIBLE_IOCTL(BNEPCONNDEL)\nCOMPATIBLE_IOCTL(BNEPGETCONNLIST)\nCOMPATIBLE_IOCTL(BNEPGETCONNINFO)\nCOMPATIBLE_IOCTL(CMTPCONNADD)\nCOMPATIBLE_IOCTL(CMTPCONNDEL)\nCOMPATIBLE_IOCTL(CMTPGETCONNLIST)\nCOMPATIBLE_IOCTL(CMTPGETCONNINFO)\nCOMPATIBLE_IOCTL(HIDPCONNADD)\nCOMPATIBLE_IOCTL(HIDPCONNDEL)\nCOMPATIBLE_IOCTL(HIDPGETCONNLIST)\nCOMPATIBLE_IOCTL(HIDPGETCONNINFO)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Siemens Gigaset */\nCOMPATIBLE_IOCTL(GIGASET_REDIR)\nCOMPATIBLE_IOCTL(GIGASET_CONFIG)\nCOMPATIBLE_IOCTL(GIGASET_BRKCHARS)\nCOMPATIBLE_IOCTL(GIGASET_VERSION)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* NBD */\nCOMPATIBLE_IOCTL(NBD_DO_IT)\nCOMPATIBLE_IOCTL(NBD_CLEAR_SOCK)\nCOMPATIBLE_IOCTL(NBD_CLEAR_QUE)\nCOMPATIBLE_IOCTL(NBD_PRINT_DEBUG)\nCOMPATIBLE_IOCTL(NBD_DISCONNECT)\n/* i2c */\nCOMPATIBLE_IOCTL(I2C_SLAVE)\nCOMPATIBLE_IOCTL(I2C_SLAVE_FORCE)\nCOMPATIBLE_IOCTL(I2C_TENBIT)\nCOMPATIBLE_IOCTL(I2C_PEC)\nCOMPATIBLE_IOCTL(I2C_RETRIES)\nCOMPATIBLE_IOCTL(I2C_TIMEOUT)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* dvb */\nCOMPATIBLE_IOCTL(AUDIO_STOP)\nCOMPATIBLE_IOCTL(AUDIO_PLAY)\nCOMPATIBLE_IOCTL(AUDIO_PAUSE)\nCOMPATIBLE_IOCTL(AUDIO_CONTINUE)\nCOMPATIBLE_IOCTL(AUDIO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(AUDIO_SET_MUTE)\nCOMPATIBLE_IOCTL(AUDIO_SET_AV_SYNC)\nCOMPATIBLE_IOCTL(AUDIO_SET_BYPASS_MODE)\nCOMPATIBLE_IOCTL(AUDIO_CHANNEL_SELECT)\nCOMPATIBLE_IOCTL(AUDIO_GET_STATUS)\nCOMPATIBLE_IOCTL(AUDIO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(AUDIO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(AUDIO_SET_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_MIXER)\nCOMPATIBLE_IOCTL(AUDIO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(AUDIO_SET_EXT_ID)\nCOMPATIBLE_IOCTL(AUDIO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(AUDIO_SET_KARAOKE)\nCOMPATIBLE_IOCTL(DMX_START)\nCOMPATIBLE_IOCTL(DMX_STOP)\nCOMPATIBLE_IOCTL(DMX_SET_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_PES_FILTER)\nCOMPATIBLE_IOCTL(DMX_SET_BUFFER_SIZE)\nCOMPATIBLE_IOCTL(DMX_GET_PES_PIDS)\nCOMPATIBLE_IOCTL(DMX_GET_CAPS)\nCOMPATIBLE_IOCTL(DMX_SET_SOURCE)\nCOMPATIBLE_IOCTL(DMX_GET_STC)\nCOMPATIBLE_IOCTL(FE_GET_INFO)\nCOMPATIBLE_IOCTL(FE_DISEQC_RESET_OVERLOAD)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_MASTER_CMD)\nCOMPATIBLE_IOCTL(FE_DISEQC_RECV_SLAVE_REPLY)\nCOMPATIBLE_IOCTL(FE_DISEQC_SEND_BURST)\nCOMPATIBLE_IOCTL(FE_SET_TONE)\nCOMPATIBLE_IOCTL(FE_SET_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_ENABLE_HIGH_LNB_VOLTAGE)\nCOMPATIBLE_IOCTL(FE_READ_STATUS)\nCOMPATIBLE_IOCTL(FE_READ_BER)\nCOMPATIBLE_IOCTL(FE_READ_SIGNAL_STRENGTH)\nCOMPATIBLE_IOCTL(FE_READ_SNR)\nCOMPATIBLE_IOCTL(FE_READ_UNCORRECTED_BLOCKS)\nCOMPATIBLE_IOCTL(FE_SET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_FRONTEND)\nCOMPATIBLE_IOCTL(FE_GET_EVENT)\nCOMPATIBLE_IOCTL(FE_DISHNETWORK_SEND_LEGACY_CMD)\nCOMPATIBLE_IOCTL(VIDEO_STOP)\nCOMPATIBLE_IOCTL(VIDEO_PLAY)\nCOMPATIBLE_IOCTL(VIDEO_FREEZE)\nCOMPATIBLE_IOCTL(VIDEO_CONTINUE)\nCOMPATIBLE_IOCTL(VIDEO_SELECT_SOURCE)\nCOMPATIBLE_IOCTL(VIDEO_SET_BLANK)\nCOMPATIBLE_IOCTL(VIDEO_GET_STATUS)\nCOMPATIBLE_IOCTL(VIDEO_SET_DISPLAY_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_FAST_FORWARD)\nCOMPATIBLE_IOCTL(VIDEO_SLOWMOTION)\nCOMPATIBLE_IOCTL(VIDEO_GET_CAPABILITIES)\nCOMPATIBLE_IOCTL(VIDEO_CLEAR_BUFFER)\nCOMPATIBLE_IOCTL(VIDEO_SET_ID)\nCOMPATIBLE_IOCTL(VIDEO_SET_STREAMTYPE)\nCOMPATIBLE_IOCTL(VIDEO_SET_FORMAT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SYSTEM)\nCOMPATIBLE_IOCTL(VIDEO_SET_HIGHLIGHT)\nCOMPATIBLE_IOCTL(VIDEO_SET_SPU)\nCOMPATIBLE_IOCTL(VIDEO_GET_NAVI)\nCOMPATIBLE_IOCTL(VIDEO_SET_ATTRIBUTES)\nCOMPATIBLE_IOCTL(VIDEO_GET_SIZE)\nCOMPATIBLE_IOCTL(VIDEO_GET_FRAME_RATE)\n\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n#ifdef TIOCGLTC\nCOMPATIBLE_IOCTL(TIOCGLTC)\nCOMPATIBLE_IOCTL(TIOCSLTC)\n#endif\n#ifdef TIOCSTART\n/*\n * For these two we have definitions in ioctls.h and/or termios.h on\n * some architectures but no actual implemention.  Some applications\n * like bash call them if they are defined in the headers, so we provide\n * entries here to avoid syslog message spew.\n */\nCOMPATIBLE_IOCTL(TIOCSTART)\nCOMPATIBLE_IOCTL(TIOCSTOP)\n#endif\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};\n\ntatic int compat_ioctl_check_table(unsigned int xcmd)\n{\n\tint i;\n\tconst int max = ARRAY_SIZE(ioctl_pointer) - 1;\n\n\tBUILD_BUG_ON(max >= (1 << 16));\n\n\t/* guess initial offset into table, assuming a\n\t   normalized distribution */\n\ti = ((xcmd >> 16) * max) >> 16;\n\n\t/* do linear search up first, until greater or equal */\n\twhile (ioctl_pointer[i] < xcmd && i < max)\n\t\ti++;\n\n\t/* then do linear search down */\n\twhile (ioctl_pointer[i] > xcmd && i > 0)\n\t\ti--;\n\n\treturn ioctl_pointer[i] == xcmd;\n}"
  },
  {
    "function_name": "o_ioctl_trans(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "1436-1517",
    "snippet": "tatic long do_ioctl_trans(int fd, unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(fd, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(fd, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(fd, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(fd, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(fd, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(fd, cmd, argp);\n#endif\n\t/* Serial */\n\tcase TIOCGSERIAL:\n\tcase TIOCSSERIAL:\n\t\treturn serial_struct_ioctl(fd, cmd, argp);\n\t/* i2c */\n\tcase I2C_FUNCS:\n\t\treturn w_long(fd, cmd, argp);\n\tcase I2C_RDWR:\n\t\treturn do_i2c_rdwr_ioctl(fd, cmd, argp);\n\tcase I2C_SMBUS:\n\t\treturn do_i2c_smbus_ioctl(fd, cmd, argp);\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(fd, cmd, argp);\n\n\t/* dvb */\n\tcase VIDEO_GET_EVENT:\n\t\treturn do_video_get_event(fd, cmd, argp);\n\tcase VIDEO_STILLPICTURE:\n\t\treturn do_video_stillpicture(fd, cmd, argp);\n\tcase VIDEO_SET_SPU_PALETTE:\n\t\treturn do_video_set_spu_palette(fd, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* Big T */\n\tcase TCSBRKP:\n\tcase TIOCMIWAIT:\n\tcase TIOCSCTTY:\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t/* Big K */\n\tcase KDSIGACCEPT:\n\tcase KIOCSOUND:\n\tcase KDMKTONE:\n\tcase KDSETMODE:\n\tcase KDSKBMODE:\n\tcase KDSKBMETA:\n\tcase KDSKBLED:\n\tcase KDSETLED:\n\t/* NBD */\n\tcase NBD_SET_SOCK:\n\tcase NBD_SET_BLKSIZE:\n\tcase NBD_SET_SIZE:\n\tcase NBD_SET_SIZE_BLOCKS:\n\t\treturn do_vfs_ioctl(file, fd, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
      "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
      "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
      "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
      "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
      "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
      "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
      "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
      "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
      "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o_vfs_ioctl(",
          "args": [
            "ile,",
            "d,",
            "md,",
            "rg)"
          ],
          "line": 1513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o_video_set_spu_palette(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o_video_stillpicture(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o_video_get_event(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tc_ioctl(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o_i2c_smbus_ioctl(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o_i2c_rdwr_ioctl(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_long(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "erial_struct_ioctl(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t_ioctl_trans(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_grt_trans(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ioctl_trans(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pp_sock_fprog_ioctl_trans(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pp_scompress(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pp_gidle(",
          "args": [
            "d,",
            "md,",
            "rgp)"
          ],
          "line": 1443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ompat_ptr(",
          "args": [
            "rg)"
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\ntatic long do_ioctl_trans(int fd, unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(fd, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(fd, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(fd, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(fd, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(fd, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(fd, cmd, argp);\n#endif\n\t/* Serial */\n\tcase TIOCGSERIAL:\n\tcase TIOCSSERIAL:\n\t\treturn serial_struct_ioctl(fd, cmd, argp);\n\t/* i2c */\n\tcase I2C_FUNCS:\n\t\treturn w_long(fd, cmd, argp);\n\tcase I2C_RDWR:\n\t\treturn do_i2c_rdwr_ioctl(fd, cmd, argp);\n\tcase I2C_SMBUS:\n\t\treturn do_i2c_smbus_ioctl(fd, cmd, argp);\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(fd, cmd, argp);\n\n\t/* dvb */\n\tcase VIDEO_GET_EVENT:\n\t\treturn do_video_get_event(fd, cmd, argp);\n\tcase VIDEO_STILLPICTURE:\n\t\treturn do_video_stillpicture(fd, cmd, argp);\n\tcase VIDEO_SET_SPU_PALETTE:\n\t\treturn do_video_set_spu_palette(fd, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* Big T */\n\tcase TCSBRKP:\n\tcase TIOCMIWAIT:\n\tcase TIOCSCTTY:\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t/* Big K */\n\tcase KDSIGACCEPT:\n\tcase KIOCSOUND:\n\tcase KDMKTONE:\n\tcase KDSETMODE:\n\tcase KDSKBMODE:\n\tcase KDSKBMETA:\n\tcase KDSKBLED:\n\tcase KDSETLED:\n\t/* NBD */\n\tcase NBD_SET_SOCK:\n\tcase NBD_SET_BLKSIZE:\n\tcase NBD_SET_SIZE:\n\tcase NBD_SET_SIZE_BLOCKS:\n\t\treturn do_vfs_ioctl(file, fd, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
  },
  {
    "function_name": "compat_ioctl_preallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "789-804",
    "snippet": "static int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl_preallocate",
          "args": [
            "file",
            "p"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "compat_ioctl_preallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
          "lines": "789-804",
          "snippet": "static int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_pad",
            "&p32->l_pad",
            "4*sizeof(u32)"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_pid",
            "&p32->l_pid",
            "sizeof(u32)"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_sysid",
            "&p32->l_sysid",
            "sizeof(s32)"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_len",
            "&p32->l_len",
            "sizeof(s64)"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_start",
            "&p32->l_start",
            "sizeof(s64)"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_whence",
            "&p32->l_whence",
            "sizeof(s16)"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_type",
            "&p32->l_type",
            "sizeof(s16)"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*p)"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}"
  },
  {
    "function_name": "rtc_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "744-770",
    "snippet": "static int rtc_ioctl(unsigned fd, unsigned cmd, void __user *argp)\n{\n\tmm_segment_t oldfs = get_fs();\n\tcompat_ulong_t val32;\n\tunsigned long kval;\n\tint ret;\n\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tset_fs(KERNEL_DS);\n\t\tret = sys_ioctl(fd, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)&kval);\n\t\tset_fs(oldfs);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tval32 = kval;\n\t\treturn put_user(val32, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn sys_ioctl(fd, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn sys_ioctl(fd, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
      "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
      "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
      "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "RTC_EPOCH_SET",
            "(unsigned long)argp"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "RTC_IRQP_SET",
            "(unsigned long)argp"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "val32",
            "(unsigned int __user *)argp"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "oldfs"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "(cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ",
            "(unsigned long)&kval"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n\nstatic int rtc_ioctl(unsigned fd, unsigned cmd, void __user *argp)\n{\n\tmm_segment_t oldfs = get_fs();\n\tcompat_ulong_t val32;\n\tunsigned long kval;\n\tint ret;\n\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tset_fs(KERNEL_DS);\n\t\tret = sys_ioctl(fd, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)&kval);\n\t\tset_fs(oldfs);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tval32 = kval;\n\t\treturn put_user(val32, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn sys_ioctl(fd, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn sys_ioctl(fd, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
  },
  {
    "function_name": "do_i2c_smbus_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "713-737",
    "snippet": "static int do_i2c_smbus_ioctl(unsigned int fd, unsigned int cmd,\n\t\t\tstruct i2c_smbus_ioctl_data32   __user *udata)\n{\n\tstruct i2c_smbus_ioctl_data\t__user *tdata;\n\tcompat_caddr_t\t\t\tdatap;\n\n\ttdata = compat_alloc_user_space(sizeof(*tdata));\n\tif (tdata == NULL)\n\t\treturn -ENOMEM;\n\tif (!access_ok(VERIFY_WRITE, tdata, sizeof(*tdata)))\n\t\treturn -EFAULT;\n\n\tif (!access_ok(VERIFY_READ, udata, sizeof(*udata)))\n\t\treturn -EFAULT;\n\n\tif (__copy_in_user(&tdata->read_write, &udata->read_write, 2 * sizeof(u8)))\n\t\treturn -EFAULT;\n\tif (__copy_in_user(&tdata->size, &udata->size, 2 * sizeof(u32)))\n\t\treturn -EFAULT;\n\tif (__get_user(datap, &udata->data) ||\n\t    __put_user(compat_ptr(datap), &tdata->data))\n\t\treturn -EFAULT;\n\n\treturn sys_ioctl(fd, cmd, (unsigned long)tdata);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)tdata"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "compat_ptr(datap)",
            "&tdata->data"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "datap"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "datap",
            "&udata->data"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__copy_in_user",
          "args": [
            "&tdata->size",
            "&udata->size",
            "2 * sizeof(u32)"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__copy_in_user",
          "args": [
            "&tdata->read_write",
            "&udata->read_write",
            "2 * sizeof(u8)"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_READ",
            "udata",
            "sizeof(*udata)"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "tdata",
            "sizeof(*tdata)"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*tdata)"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_i2c_smbus_ioctl(unsigned int fd, unsigned int cmd,\n\t\t\tstruct i2c_smbus_ioctl_data32   __user *udata)\n{\n\tstruct i2c_smbus_ioctl_data\t__user *tdata;\n\tcompat_caddr_t\t\t\tdatap;\n\n\ttdata = compat_alloc_user_space(sizeof(*tdata));\n\tif (tdata == NULL)\n\t\treturn -ENOMEM;\n\tif (!access_ok(VERIFY_WRITE, tdata, sizeof(*tdata)))\n\t\treturn -EFAULT;\n\n\tif (!access_ok(VERIFY_READ, udata, sizeof(*udata)))\n\t\treturn -EFAULT;\n\n\tif (__copy_in_user(&tdata->read_write, &udata->read_write, 2 * sizeof(u8)))\n\t\treturn -EFAULT;\n\tif (__copy_in_user(&tdata->size, &udata->size, 2 * sizeof(u32)))\n\t\treturn -EFAULT;\n\tif (__get_user(datap, &udata->data) ||\n\t    __put_user(compat_ptr(datap), &tdata->data))\n\t\treturn -EFAULT;\n\n\treturn sys_ioctl(fd, cmd, (unsigned long)tdata);\n}"
  },
  {
    "function_name": "do_i2c_rdwr_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "676-711",
    "snippet": "static int do_i2c_rdwr_ioctl(unsigned int fd, unsigned int cmd,\n\t\t\tstruct i2c_rdwr_ioctl_data32    __user *udata)\n{\n\tstruct i2c_rdwr_aligned\t\t__user *tdata;\n\tstruct i2c_msg\t\t\t__user *tmsgs;\n\tstruct i2c_msg32\t\t__user *umsgs;\n\tcompat_caddr_t\t\t\tdatap;\n\tu32\t\t\t\tnmsgs;\n\tint\t\t\t\ti;\n\n\tif (get_user(nmsgs, &udata->nmsgs))\n\t\treturn -EFAULT;\n\tif (nmsgs > I2C_RDRW_IOCTL_MAX_MSGS)\n\t\treturn -EINVAL;\n\n\tif (get_user(datap, &udata->msgs))\n\t\treturn -EFAULT;\n\tumsgs = compat_ptr(datap);\n\n\ttdata = compat_alloc_user_space(sizeof(*tdata) +\n\t\t\t\t      nmsgs * sizeof(struct i2c_msg));\n\ttmsgs = &tdata->msgs[0];\n\n\tif (put_user(nmsgs, &tdata->cmd.nmsgs) ||\n\t    put_user(tmsgs, &tdata->cmd.msgs))\n\t\treturn -EFAULT;\n\n\tfor (i = 0; i < nmsgs; i++) {\n\t\tif (copy_in_user(&tmsgs[i].addr, &umsgs[i].addr, 3*sizeof(u16)))\n\t\t\treturn -EFAULT;\n\t\tif (get_user(datap, &umsgs[i].buf) ||\n\t\t    put_user(compat_ptr(datap), &tmsgs[i].buf))\n\t\t\treturn -EFAULT;\n\t}\n\treturn sys_ioctl(fd, cmd, (unsigned long)tdata);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)tdata"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(datap)",
            "&tmsgs[i].buf"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "datap"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "datap",
            "&umsgs[i].buf"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&tmsgs[i].addr",
            "&umsgs[i].addr",
            "3*sizeof(u16)"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "tmsgs",
            "&tdata->cmd.msgs"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "nmsgs",
            "&tdata->cmd.nmsgs"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*tdata) +\n\t\t\t\t      nmsgs * sizeof(struct i2c_msg)"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "datap"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_i2c_rdwr_ioctl(unsigned int fd, unsigned int cmd,\n\t\t\tstruct i2c_rdwr_ioctl_data32    __user *udata)\n{\n\tstruct i2c_rdwr_aligned\t\t__user *tdata;\n\tstruct i2c_msg\t\t\t__user *tmsgs;\n\tstruct i2c_msg32\t\t__user *umsgs;\n\tcompat_caddr_t\t\t\tdatap;\n\tu32\t\t\t\tnmsgs;\n\tint\t\t\t\ti;\n\n\tif (get_user(nmsgs, &udata->nmsgs))\n\t\treturn -EFAULT;\n\tif (nmsgs > I2C_RDRW_IOCTL_MAX_MSGS)\n\t\treturn -EINVAL;\n\n\tif (get_user(datap, &udata->msgs))\n\t\treturn -EFAULT;\n\tumsgs = compat_ptr(datap);\n\n\ttdata = compat_alloc_user_space(sizeof(*tdata) +\n\t\t\t\t      nmsgs * sizeof(struct i2c_msg));\n\ttmsgs = &tdata->msgs[0];\n\n\tif (put_user(nmsgs, &tdata->cmd.nmsgs) ||\n\t    put_user(tmsgs, &tdata->cmd.msgs))\n\t\treturn -EFAULT;\n\n\tfor (i = 0; i < nmsgs; i++) {\n\t\tif (copy_in_user(&tmsgs[i].addr, &umsgs[i].addr, 3*sizeof(u16)))\n\t\t\treturn -EFAULT;\n\t\tif (get_user(datap, &umsgs[i].buf) ||\n\t\t    put_user(compat_ptr(datap), &tmsgs[i].buf))\n\t\t\treturn -EFAULT;\n\t}\n\treturn sys_ioctl(fd, cmd, (unsigned long)tdata);\n}"
  },
  {
    "function_name": "serial_struct_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "607-646",
    "snippet": "static int serial_struct_ioctl(unsigned fd, unsigned cmd,\n\t\t\tstruct serial_struct32 __user *ss32)\n{\n        typedef struct serial_struct32 SS32;\n        int err;\n        struct serial_struct ss;\n        mm_segment_t oldseg = get_fs();\n        __u32 udata;\n\tunsigned int base;\n\n        if (cmd == TIOCSSERIAL) {\n                if (!access_ok(VERIFY_READ, ss32, sizeof(SS32)))\n                        return -EFAULT;\n                if (__copy_from_user(&ss, ss32, offsetof(SS32, iomem_base)))\n\t\t\treturn -EFAULT;\n                if (__get_user(udata, &ss32->iomem_base))\n\t\t\treturn -EFAULT;\n                ss.iomem_base = compat_ptr(udata);\n                if (__get_user(ss.iomem_reg_shift, &ss32->iomem_reg_shift) ||\n\t\t    __get_user(ss.port_high, &ss32->port_high))\n\t\t\treturn -EFAULT;\n                ss.iomap_base = 0UL;\n        }\n        set_fs(KERNEL_DS);\n                err = sys_ioctl(fd,cmd,(unsigned long)(&ss));\n        set_fs(oldseg);\n        if (cmd == TIOCGSERIAL && err >= 0) {\n                if (!access_ok(VERIFY_WRITE, ss32, sizeof(SS32)))\n                        return -EFAULT;\n                if (__copy_to_user(ss32,&ss,offsetof(SS32,iomem_base)))\n\t\t\treturn -EFAULT;\n\t\tbase = (unsigned long)ss.iomem_base  >> 32 ?\n\t\t\t0xffffffff : (unsigned)(unsigned long)ss.iomem_base;\n\t\tif (__put_user(base, &ss32->iomem_base) ||\n\t\t    __put_user(ss.iomem_reg_shift, &ss32->iomem_reg_shift) ||\n\t\t    __put_user(ss.port_high, &ss32->port_high))\n\t\t\treturn -EFAULT;\n        }\n        return err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "ss.port_high",
            "&ss32->port_high"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "ss.iomem_reg_shift",
            "&ss32->iomem_reg_shift"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "base",
            "&ss32->iomem_base"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__copy_to_user",
          "args": [
            "ss32",
            "&ss",
            "offsetof(SS32,iomem_base)"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_WRITE",
            "ss32",
            "sizeof(SS32)"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "oldseg"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)(&ss)"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "ss.port_high",
            "&ss32->port_high"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "ss.iomem_reg_shift",
            "&ss32->iomem_reg_shift"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "udata"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_user",
          "args": [
            "udata",
            "&ss32->iomem_base"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__copy_from_user",
          "args": [
            "&ss",
            "ss32",
            "offsetof(SS32, iomem_base)"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "VERIFY_READ",
            "ss32",
            "sizeof(SS32)"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int serial_struct_ioctl(unsigned fd, unsigned cmd,\n\t\t\tstruct serial_struct32 __user *ss32)\n{\n        typedef struct serial_struct32 SS32;\n        int err;\n        struct serial_struct ss;\n        mm_segment_t oldseg = get_fs();\n        __u32 udata;\n\tunsigned int base;\n\n        if (cmd == TIOCSSERIAL) {\n                if (!access_ok(VERIFY_READ, ss32, sizeof(SS32)))\n                        return -EFAULT;\n                if (__copy_from_user(&ss, ss32, offsetof(SS32, iomem_base)))\n\t\t\treturn -EFAULT;\n                if (__get_user(udata, &ss32->iomem_base))\n\t\t\treturn -EFAULT;\n                ss.iomem_base = compat_ptr(udata);\n                if (__get_user(ss.iomem_reg_shift, &ss32->iomem_reg_shift) ||\n\t\t    __get_user(ss.port_high, &ss32->port_high))\n\t\t\treturn -EFAULT;\n                ss.iomap_base = 0UL;\n        }\n        set_fs(KERNEL_DS);\n                err = sys_ioctl(fd,cmd,(unsigned long)(&ss));\n        set_fs(oldseg);\n        if (cmd == TIOCGSERIAL && err >= 0) {\n                if (!access_ok(VERIFY_WRITE, ss32, sizeof(SS32)))\n                        return -EFAULT;\n                if (__copy_to_user(ss32,&ss,offsetof(SS32,iomem_base)))\n\t\t\treturn -EFAULT;\n\t\tbase = (unsigned long)ss.iomem_base  >> 32 ?\n\t\t\t0xffffffff : (unsigned)(unsigned long)ss.iomem_base;\n\t\tif (__put_user(base, &ss32->iomem_base) ||\n\t\t    __put_user(ss.iomem_reg_shift, &ss32->iomem_reg_shift) ||\n\t\t    __put_user(ss.port_high, &ss32->port_high))\n\t\t\treturn -EFAULT;\n        }\n        return err;\n}"
  },
  {
    "function_name": "mt_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "515-558",
    "snippet": "static int mt_ioctl_trans(unsigned int fd, unsigned int cmd, void __user *argp)\n{\n\tmm_segment_t old_fs = get_fs();\n\tstruct mtget get;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos pos;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tkarg = &pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tkarg = &get;\n\t\tbreak;\n\t}\n\tset_fs (KERNEL_DS);\n\terr = sys_ioctl (fd, kcmd, (unsigned long)karg);\n\tset_fs (old_fs);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = __put_user(pos.mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = __put_user(get.mt_type, &umget32->mt_type);\n\t\terr |= __put_user(get.mt_resid, &umget32->mt_resid);\n\t\terr |= __put_user(get.mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= __put_user(get.mt_gstat, &umget32->mt_gstat);\n\t\terr |= __put_user(get.mt_erreg, &umget32->mt_erreg);\n\t\terr |= __put_user(get.mt_fileno, &umget32->mt_fileno);\n\t\terr |= __put_user(get.mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
      "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_blkno",
            "&umget32->mt_blkno"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_fileno",
            "&umget32->mt_fileno"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_erreg",
            "&umget32->mt_erreg"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_gstat",
            "&umget32->mt_gstat"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_dsreg",
            "&umget32->mt_dsreg"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_resid",
            "&umget32->mt_resid"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "get.mt_type",
            "&umget32->mt_type"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__put_user",
          "args": [
            "pos.mt_blkno",
            "&upos32->mt_blkno"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "old_fs"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "kcmd",
            "(unsigned long)karg"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n\nstatic int mt_ioctl_trans(unsigned int fd, unsigned int cmd, void __user *argp)\n{\n\tmm_segment_t old_fs = get_fs();\n\tstruct mtget get;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos pos;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tkarg = &pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tkarg = &get;\n\t\tbreak;\n\t}\n\tset_fs (KERNEL_DS);\n\terr = sys_ioctl (fd, kcmd, (unsigned long)karg);\n\tset_fs (old_fs);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = __put_user(pos.mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = __put_user(get.mt_type, &umget32->mt_type);\n\t\terr |= __put_user(get.mt_resid, &umget32->mt_resid);\n\t\terr |= __put_user(get.mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= __put_user(get.mt_gstat, &umget32->mt_gstat);\n\t\terr |= __put_user(get.mt_erreg, &umget32->mt_erreg);\n\t\terr |= __put_user(get.mt_fileno, &umget32->mt_fileno);\n\t\terr |= __put_user(get.mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}"
  },
  {
    "function_name": "ppp_scompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "475-496",
    "snippet": "static int ppp_scompress(unsigned int fd, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn sys_ioctl(fd, PPPIOCSCOMPRESS, (unsigned long) odata);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "PPPIOCSCOMPRESS",
            "(unsigned long) odata"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&odata->length",
            "&odata32->length",
            "sizeof(__u32) + sizeof(int)"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "datap",
            "&odata->ptr"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "data",
            "&odata32->ptr"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*odata)"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_scompress(unsigned int fd, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn sys_ioctl(fd, PPPIOCSCOMPRESS, (unsigned long) odata);\n}"
  },
  {
    "function_name": "ppp_gidle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "454-473",
    "snippet": "static int ppp_gidle(unsigned int fd, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = sys_ioctl(fd, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "recv",
            "&idle32->recv_idle"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "xmit",
            "&idle32->xmit_idle"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "recv",
            "&idle->recv_idle"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "PPPIOCGIDLE",
            "(unsigned long) idle"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*idle)"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_gidle(unsigned int fd, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = sys_ioctl(fd, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "ppp_sock_fprog_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "415-439",
    "snippet": "static int ppp_sock_fprog_ioctl_trans(unsigned int fd, unsigned int cmd,\n\t\t\tstruct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn sys_ioctl(fd, cmd, (unsigned long) u_fprog64);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long) u_fprog64"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "fptr64",
            "&u_fprog64->filter"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "flen",
            "&u_fprog64->len"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "fptr32"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "fptr32",
            "&u_fprog32->filter"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(struct sock_fprog)"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic int ppp_sock_fprog_ioctl_trans(unsigned int fd, unsigned int cmd,\n\t\t\tstruct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn sys_ioctl(fd, cmd, (unsigned long) u_fprog64);\n}"
  },
  {
    "function_name": "sg_grt_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "383-404",
    "snippet": "static int sg_grt_trans(unsigned int fd, unsigned int cmd, struct\n\t\t\tcompat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = sys_ioctl(fd,cmd,(unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "d",
            "&o[i].duration"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "(u32)(unsigned long)(ptr)",
            "&o[i].usr_ptr"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "d",
            "&r[i].duration"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "o + i",
            "r + i",
            "offsetof(sg_req_info_t, usr_ptr)"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)r"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(sg_req_info_t)*SG_MAX_QUEUE"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_grt_trans(unsigned int fd, unsigned int cmd, struct\n\t\t\tcompat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = sys_ioctl(fd,cmd,(unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "sg_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "279-370",
    "snippet": "static int sg_ioctl_trans(unsigned int fd, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn sys_ioctl(fd, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio32->status",
            "&sgio->status",
            "(4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "(u32)(unsigned long)datap",
            "&sgio32->usr_ptr"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "datap",
            "&sgio->usr_ptr"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio32->pack_id",
            "&sgio->pack_id",
            "sizeof(int)"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long) sgio"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(data)",
            "&sgio->usr_ptr"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio->timeout",
            "&sgio32->timeout",
            "3 * sizeof(int)"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "sbp",
            "&sgio->sbp"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "cmdp",
            "&sgio->cmdp"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "dxferp",
            "&sgio->dxferp"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sg_build_iovec",
          "args": [
            "sgio",
            "dxferp",
            "iovec_count"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "sg_build_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
          "lines": "258-277",
          "snippet": "static int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/sort.h>",
            "#include <linux/dvb/video.h>",
            "#include <linux/dvb/frontend.h>",
            "#include <linux/dvb/dmx.h>",
            "#include <linux/dvb/audio.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/filter.h>",
            "#include <linux/random.h>",
            "#include <linux/nbd.h>",
            "#include <linux/usbdevice_fs.h>",
            "#include <linux/usb.h>",
            "#include <linux/atm_suni.h>",
            "#include <linux/sonet.h>",
            "#include <linux/atm_tcp.h>",
            "#include <linux/atmsvc.h>",
            "#include <linux/atmmpc.h>",
            "#include <linux/atmlec.h>",
            "#include <linux/atmioc.h>",
            "#include <linux/atmdev.h>",
            "#include <linux/atmclip.h>",
            "#include <linux/atmarp.h>",
            "#include <linux/atm.h>",
            "#include <linux/ppdev.h>",
            "#include <linux/lp.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/if_bonding.h>",
            "#include <linux/mii.h>",
            "#include <linux/ethtool.h>",
            "#include <asm/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include <linux/gfp.h>",
            "#include <linux/atalk.h>",
            "#include <linux/i2c-dev.h>",
            "#include <linux/i2c.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/if_tun.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/elevator.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/netdevice.h>",
            "#include <linux/videodev2.h>",
            "#include <linux/fb.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/auto_fs4.h>",
            "#include <linux/auto_fs.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/ppp_defs.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/falloc.h>",
            "#include <linux/vt.h>",
            "#include <linux/netlink.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/ipv6_route.h>",
            "#include <linux/in6.h>",
            "#include <linux/route.h>",
            "#include <linux/kd.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if_bridge.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio->interface_id",
            "&sgio32->interface_id",
            "(2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t))"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "0"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)sgio32"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_ioctl_trans(unsigned int fd, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn sys_ioctl(fd, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "sg_build_iovec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "258-277",
    "snippet": "static int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "iov",
            "&sgio->dxferp"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "len",
            "&iov[i].iov_len"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(base)",
            "&iov[i].iov_base"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "base"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "len",
            "&iov32[i].iov_len"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_video_set_spu_palette",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "203-224",
    "snippet": "static int do_video_set_spu_palette(unsigned int fd, unsigned int cmd,\n\t\tstruct compat_video_spu_palette __user *up)\n{\n\tstruct video_spu_palette __user *up_native;\n\tcompat_uptr_t palp;\n\tint length, err;\n\n\terr  = get_user(palp, &up->palette);\n\terr |= get_user(length, &up->length);\n\tif (err)\n\t\treturn -EFAULT;\n\n\tup_native = compat_alloc_user_space(sizeof(struct video_spu_palette));\n\terr  = put_user(compat_ptr(palp), &up_native->palette);\n\terr |= put_user(length, &up_native->length);\n\tif (err)\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) up_native);\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long) up_native"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "length",
            "&up_native->length"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(palp)",
            "&up_native->palette"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "palp"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(struct video_spu_palette)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "length",
            "&up->length"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_video_set_spu_palette(unsigned int fd, unsigned int cmd,\n\t\tstruct compat_video_spu_palette __user *up)\n{\n\tstruct video_spu_palette __user *up_native;\n\tcompat_uptr_t palp;\n\tint length, err;\n\n\terr  = get_user(palp, &up->palette);\n\terr |= get_user(length, &up->length);\n\tif (err)\n\t\treturn -EFAULT;\n\n\tup_native = compat_alloc_user_space(sizeof(struct video_spu_palette));\n\terr  = put_user(compat_ptr(palp), &up_native->palette);\n\terr |= put_user(length, &up_native->length);\n\tif (err)\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) up_native);\n\n\treturn err;\n}"
  },
  {
    "function_name": "do_video_stillpicture",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "172-196",
    "snippet": "static int do_video_stillpicture(unsigned int fd, unsigned int cmd,\n\tstruct compat_video_still_picture __user *up)\n{\n\tstruct video_still_picture __user *up_native;\n\tcompat_uptr_t fp;\n\tint32_t size;\n\tint err;\n\n\terr  = get_user(fp, &up->iFrame);\n\terr |= get_user(size, &up->size);\n\tif (err)\n\t\treturn -EFAULT;\n\n\tup_native =\n\t\tcompat_alloc_user_space(sizeof(struct video_still_picture));\n\n\terr =  put_user(compat_ptr(fp), &up_native->iFrame);\n\terr |= put_user(size, &up_native->size);\n\tif (err)\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) up_native);\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long) up_native"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "size",
            "&up_native->size"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(fp)",
            "&up_native->iFrame"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "fp"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(struct video_still_picture)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "size",
            "&up->size"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exec.c",
          "lines": "399-418",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_video_stillpicture(unsigned int fd, unsigned int cmd,\n\tstruct compat_video_still_picture __user *up)\n{\n\tstruct video_still_picture __user *up_native;\n\tcompat_uptr_t fp;\n\tint32_t size;\n\tint err;\n\n\terr  = get_user(fp, &up->iFrame);\n\terr |= get_user(size, &up->size);\n\tif (err)\n\t\treturn -EFAULT;\n\n\tup_native =\n\t\tcompat_alloc_user_space(sizeof(struct video_still_picture));\n\n\terr =  put_user(compat_ptr(fp), &up_native->iFrame);\n\terr |= put_user(size, &up_native->size);\n\tif (err)\n\t\treturn -EFAULT;\n\n\terr = sys_ioctl(fd, cmd, (unsigned long) up_native);\n\n\treturn err;\n}"
  },
  {
    "function_name": "do_video_get_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "142-165",
    "snippet": "static int do_video_get_event(unsigned int fd, unsigned int cmd,\n\t\tstruct compat_video_event __user *up)\n{\n\tstruct video_event kevent;\n\tmm_segment_t old_fs = get_fs();\n\tint err;\n\n\tset_fs(KERNEL_DS);\n\terr = sys_ioctl(fd, cmd, (unsigned long) &kevent);\n\tset_fs(old_fs);\n\n\tif (!err) {\n\t\terr  = put_user(kevent.type, &up->type);\n\t\terr |= put_user(kevent.timestamp, &up->timestamp);\n\t\terr |= put_user(kevent.u.size.w, &up->u.size.w);\n\t\terr |= put_user(kevent.u.size.h, &up->u.size.h);\n\t\terr |= put_user(kevent.u.size.aspect_ratio,\n\t\t\t\t&up->u.size.aspect_ratio);\n\t\tif (err)\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "kevent.u.size.aspect_ratio",
            "&up->u.size.aspect_ratio"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "kevent.u.size.h",
            "&up->u.size.h"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "kevent.u.size.w",
            "&up->u.size.w"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "kevent.timestamp",
            "&up->timestamp"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "kevent.type",
            "&up->type"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "old_fs"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long) &kevent"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_video_get_event(unsigned int fd, unsigned int cmd,\n\t\tstruct compat_video_event __user *up)\n{\n\tstruct video_event kevent;\n\tmm_segment_t old_fs = get_fs();\n\tint err;\n\n\tset_fs(KERNEL_DS);\n\terr = sys_ioctl(fd, cmd, (unsigned long) &kevent);\n\tset_fs(old_fs);\n\n\tif (!err) {\n\t\terr  = put_user(kevent.type, &up->type);\n\t\terr |= put_user(kevent.timestamp, &up->timestamp);\n\t\terr |= put_user(kevent.u.size.w, &up->u.size.w);\n\t\terr |= put_user(kevent.u.size.h, &up->u.size.h);\n\t\terr |= put_user(kevent.u.size.aspect_ratio,\n\t\t\t\t&up->u.size.aspect_ratio);\n\t\tif (err)\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "w_long",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat_ioctl.c",
    "lines": "118-131",
    "snippet": "static int w_long(unsigned int fd, unsigned int cmd,\n\t\tcompat_ulong_t __user *argp)\n{\n\tmm_segment_t old_fs = get_fs();\n\tint err;\n\tunsigned long val;\n\n\tset_fs (KERNEL_DS);\n\terr = sys_ioctl(fd, cmd, (unsigned long)&val);\n\tset_fs (old_fs);\n\tif (!err && put_user(val, argp))\n\t\treturn -EFAULT;\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/sort.h>",
      "#include <linux/dvb/video.h>",
      "#include <linux/dvb/frontend.h>",
      "#include <linux/dvb/dmx.h>",
      "#include <linux/dvb/audio.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/filter.h>",
      "#include <linux/random.h>",
      "#include <linux/nbd.h>",
      "#include <linux/usbdevice_fs.h>",
      "#include <linux/usb.h>",
      "#include <linux/atm_suni.h>",
      "#include <linux/sonet.h>",
      "#include <linux/atm_tcp.h>",
      "#include <linux/atmsvc.h>",
      "#include <linux/atmmpc.h>",
      "#include <linux/atmlec.h>",
      "#include <linux/atmioc.h>",
      "#include <linux/atmdev.h>",
      "#include <linux/atmclip.h>",
      "#include <linux/atmarp.h>",
      "#include <linux/atm.h>",
      "#include <linux/ppdev.h>",
      "#include <linux/lp.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/if_bonding.h>",
      "#include <linux/mii.h>",
      "#include <linux/ethtool.h>",
      "#include <asm/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include <linux/gfp.h>",
      "#include <linux/atalk.h>",
      "#include <linux/i2c-dev.h>",
      "#include <linux/i2c.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/if_tun.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/elevator.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/netdevice.h>",
      "#include <linux/videodev2.h>",
      "#include <linux/fb.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/auto_fs4.h>",
      "#include <linux/auto_fs.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/ppp_defs.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/falloc.h>",
      "#include <linux/vt.h>",
      "#include <linux/netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/ipv6_route.h>",
      "#include <linux/in6.h>",
      "#include <linux/route.h>",
      "#include <linux/kd.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if_bridge.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "val",
            "argp"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "old_fs"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sys_ioctl",
          "args": [
            "fd",
            "cmd",
            "(unsigned long)&val"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/sort.h>\n#include <linux/dvb/video.h>\n#include <linux/dvb/frontend.h>\n#include <linux/dvb/dmx.h>\n#include <linux/dvb/audio.h>\n#include <linux/hiddev.h>\n#include <linux/filter.h>\n#include <linux/random.h>\n#include <linux/nbd.h>\n#include <linux/usbdevice_fs.h>\n#include <linux/usb.h>\n#include <linux/atm_suni.h>\n#include <linux/sonet.h>\n#include <linux/atm_tcp.h>\n#include <linux/atmsvc.h>\n#include <linux/atmmpc.h>\n#include <linux/atmlec.h>\n#include <linux/atmioc.h>\n#include <linux/atmdev.h>\n#include <linux/atmclip.h>\n#include <linux/atmarp.h>\n#include <linux/atm.h>\n#include <linux/ppdev.h>\n#include <linux/lp.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/if_bonding.h>\n#include <linux/mii.h>\n#include <linux/ethtool.h>\n#include <asm/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include <linux/gfp.h>\n#include <linux/atalk.h>\n#include <linux/i2c-dev.h>\n#include <linux/i2c.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/if_tun.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/elevator.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/netdevice.h>\n#include <linux/videodev2.h>\n#include <linux/fb.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/auto_fs4.h>\n#include <linux/auto_fs.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/ppp_defs.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/falloc.h>\n#include <linux/vt.h>\n#include <linux/netlink.h>\n#include <linux/skbuff.h>\n#include <linux/ipv6_route.h>\n#include <linux/in6.h>\n#include <linux/route.h>\n#include <linux/kd.h>\n#include <linux/raid/md_u.h>\n#include <linux/if_bridge.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int w_long(unsigned int fd, unsigned int cmd,\n\t\tcompat_ulong_t __user *argp)\n{\n\tmm_segment_t old_fs = get_fs();\n\tint err;\n\tunsigned long val;\n\n\tset_fs (KERNEL_DS);\n\terr = sys_ioctl(fd, cmd, (unsigned long)&val);\n\tset_fs (old_fs);\n\tif (!err && put_user(val, argp))\n\t\treturn -EFAULT;\n\treturn err;\n}"
  }
]