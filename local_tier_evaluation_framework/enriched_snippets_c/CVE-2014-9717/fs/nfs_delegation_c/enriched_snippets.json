[
  {
    "function_name": "nfs4_copy_delegation_stateid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "885-902",
    "snippet": "bool nfs4_copy_delegation_stateid(nfs4_stateid *dst, struct inode *inode,\n\t\tfmode_t flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation;\n\tbool ret;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(nfsi->delegation);\n\tret = (delegation != NULL && (delegation->type & flags) == flags);\n\tif (ret) {\n\t\tnfs4_stateid_copy(dst, &delegation->stateid);\n\t\tnfs_mark_delegation_referenced(delegation);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_delegation_referenced",
          "args": [
            "delegation"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_delegation_referenced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "39-42",
          "snippet": "void nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_copy",
          "args": [
            "dst",
            "&delegation->stateid"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "496-499",
          "snippet": "static inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "nfsi->delegation"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nbool nfs4_copy_delegation_stateid(nfs4_stateid *dst, struct inode *inode,\n\t\tfmode_t flags)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation;\n\tbool ret;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(nfsi->delegation);\n\tret = (delegation != NULL && (delegation->type & flags) == flags);\n\tif (ret) {\n\t\tnfs4_stateid_copy(dst, &delegation->stateid);\n\t\tnfs_mark_delegation_referenced(delegation);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_delegations_present",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "861-874",
    "snippet": "int nfs_delegations_present(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\tint ret = 0;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tif (!list_empty(&server->delegations)) {\n\t\t\tret = 1;\n\t\t\tbreak;\n\t\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&server->delegations"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs_delegations_present(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\tint ret = 0;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tif (!list_empty(&server->delegations)) {\n\t\t\tret = 1;\n\t\t\tbreak;\n\t\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_delegation_reap_unclaimed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "813-852",
    "snippet": "void nfs_delegation_reap_unclaimed(struct nfs_client *clp)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct nfs_server *server;\n\tstruct inode *inode;\n\nrestart:\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tlist_for_each_entry_rcu(delegation, &server->delegations,\n\t\t\t\t\t\t\t\tsuper_list) {\n\t\t\tif (test_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t\t&delegation->flags))\n\t\t\t\tcontinue;\n\t\t\tif (test_bit(NFS_DELEGATION_NEED_RECLAIM,\n\t\t\t\t\t\t&delegation->flags) == 0)\n\t\t\t\tcontinue;\n\t\t\tif (!nfs_sb_active(server->super))\n\t\t\t\tcontinue;\n\t\t\tinode = nfs_delegation_grab_inode(delegation);\n\t\t\tif (inode == NULL) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\tnfs_sb_deactive(server->super);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tdelegation = nfs_start_delegation_return_locked(NFS_I(inode));\n\t\t\trcu_read_unlock();\n\t\t\tif (delegation != NULL) {\n\t\t\t\tdelegation = nfs_detach_delegation(NFS_I(inode),\n\t\t\t\t\tdelegation, server);\n\t\t\t\tif (delegation != NULL)\n\t\t\t\t\tnfs_free_delegation(delegation);\n\t\t\t}\n\t\t\tiput(inode);\n\t\t\tnfs_sb_deactive(server->super);\n\t\t\tgoto restart;\n\t\t}\n\t}\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_sb_deactive",
          "args": [
            "server->super"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_deactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "419-425",
          "snippet": "void nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_iput_and_deactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "527-535",
          "snippet": "static inline void nfs_iput_and_deactive(struct inode *inode)\n{\n\tif (inode != NULL) {\n\t\tstruct super_block *sb = inode->i_sb;\n\n\t\tiput(inode);\n\t\tnfs_sb_deactive(sb);\n\t}\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern struct inode *nfs_alloc_inode(struct super_block *sb);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "void nfs_initialise_sb(struct super_block *);",
            "void nfs_kill_super(struct super_block *);",
            "extern bool nfs_sb_active(struct super_block *sb);",
            "extern void nfs_sb_deactive(struct super_block *sb);",
            "void nfs_umount_begin(struct super_block *);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern struct inode *nfs_alloc_inode(struct super_block *sb);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nvoid nfs_initialise_sb(struct super_block *);\nvoid nfs_kill_super(struct super_block *);\nextern bool nfs_sb_active(struct super_block *sb);\nextern void nfs_sb_deactive(struct super_block *sb);\nvoid nfs_umount_begin(struct super_block *);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline void nfs_iput_and_deactive(struct inode *inode)\n{\n\tif (inode != NULL) {\n\t\tstruct super_block *sb = inode->i_sb;\n\n\t\tiput(inode);\n\t\tnfs_sb_deactive(sb);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_delegation",
          "args": [
            "delegation"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "25-32",
          "snippet": "static void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_detach_delegation",
          "args": [
            "NFS_I(inode)",
            "delegation",
            "server"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_detach_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "282-292",
          "snippet": "static struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_start_delegation_return_locked",
          "args": [
            "NFS_I(inode)"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_delegation_return_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "222-236",
          "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_grab_inode",
          "args": [
            "delegation"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_grab_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "211-220",
          "snippet": "static struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sb_active",
          "args": [
            "server->super"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "407-416",
          "snippet": "bool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATION_NEED_RECLAIM",
            "&delegation->flags"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_delegation_reap_unclaimed(struct nfs_client *clp)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct nfs_server *server;\n\tstruct inode *inode;\n\nrestart:\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tlist_for_each_entry_rcu(delegation, &server->delegations,\n\t\t\t\t\t\t\t\tsuper_list) {\n\t\t\tif (test_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t\t&delegation->flags))\n\t\t\t\tcontinue;\n\t\t\tif (test_bit(NFS_DELEGATION_NEED_RECLAIM,\n\t\t\t\t\t\t&delegation->flags) == 0)\n\t\t\t\tcontinue;\n\t\t\tif (!nfs_sb_active(server->super))\n\t\t\t\tcontinue;\n\t\t\tinode = nfs_delegation_grab_inode(delegation);\n\t\t\tif (inode == NULL) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\tnfs_sb_deactive(server->super);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tdelegation = nfs_start_delegation_return_locked(NFS_I(inode));\n\t\t\trcu_read_unlock();\n\t\t\tif (delegation != NULL) {\n\t\t\t\tdelegation = nfs_detach_delegation(NFS_I(inode),\n\t\t\t\t\tdelegation, server);\n\t\t\t\tif (delegation != NULL)\n\t\t\t\t\tnfs_free_delegation(delegation);\n\t\t\t}\n\t\t\tiput(inode);\n\t\t\tnfs_sb_deactive(server->super);\n\t\t\tgoto restart;\n\t\t}\n\t}\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "nfs_delegation_mark_reclaim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "798-806",
    "snippet": "void nfs_delegation_mark_reclaim(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_delegation_mark_reclaim_server(server);\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_mark_reclaim_server",
          "args": [
            "server"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_mark_reclaim_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "785-791",
          "snippet": "static void nfs_delegation_mark_reclaim_server(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list)\n\t\tset_bit(NFS_DELEGATION_NEED_RECLAIM, &delegation->flags);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_mark_reclaim_server(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list)\n\t\tset_bit(NFS_DELEGATION_NEED_RECLAIM, &delegation->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_delegation_mark_reclaim(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_delegation_mark_reclaim_server(server);\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "nfs_delegation_mark_reclaim_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "785-791",
    "snippet": "static void nfs_delegation_mark_reclaim_server(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list)\n\t\tset_bit(NFS_DELEGATION_NEED_RECLAIM, &delegation->flags);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_DELEGATION_NEED_RECLAIM",
            "&delegation->flags"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_mark_reclaim_server(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list)\n\t\tset_bit(NFS_DELEGATION_NEED_RECLAIM, &delegation->flags);\n}"
  },
  {
    "function_name": "nfs_delegation_find_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "769-783",
    "snippet": "struct inode *nfs_delegation_find_inode(struct nfs_client *clp,\n\t\t\t\t\tconst struct nfs_fh *fhandle)\n{\n\tstruct nfs_server *server;\n\tstruct inode *res = NULL;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tres = nfs_delegation_find_inode_server(server, fhandle);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\trcu_read_unlock();\n\treturn res;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_find_inode_server",
          "args": [
            "server",
            "fhandle"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_find_inode_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "741-759",
          "snippet": "static struct inode *\nnfs_delegation_find_inode_server(struct nfs_server *server,\n\t\t\t\t const struct nfs_fh *fhandle)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct inode *res = NULL;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL &&\n\t\t    nfs_compare_fh(fhandle, &NFS_I(delegation->inode)->fh) == 0) {\n\t\t\tres = igrab(delegation->inode);\n\t\t}\n\t\tspin_unlock(&delegation->lock);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct inode *\nnfs_delegation_find_inode_server(struct nfs_server *server,\n\t\t\t\t const struct nfs_fh *fhandle)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct inode *res = NULL;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL &&\n\t\t    nfs_compare_fh(fhandle, &NFS_I(delegation->inode)->fh) == 0) {\n\t\t\tres = igrab(delegation->inode);\n\t\t}\n\t\tspin_unlock(&delegation->lock);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstruct inode *nfs_delegation_find_inode(struct nfs_client *clp,\n\t\t\t\t\tconst struct nfs_fh *fhandle)\n{\n\tstruct nfs_server *server;\n\tstruct inode *res = NULL;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tres = nfs_delegation_find_inode_server(server, fhandle);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\trcu_read_unlock();\n\treturn res;\n}"
  },
  {
    "function_name": "nfs_delegation_find_inode_server",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "741-759",
    "snippet": "static struct inode *\nnfs_delegation_find_inode_server(struct nfs_server *server,\n\t\t\t\t const struct nfs_fh *fhandle)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct inode *res = NULL;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL &&\n\t\t    nfs_compare_fh(fhandle, &NFS_I(delegation->inode)->fh) == 0) {\n\t\t\tres = igrab(delegation->inode);\n\t\t}\n\t\tspin_unlock(&delegation->lock);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\treturn res;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "igrab",
          "args": [
            "delegation->inode"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_igrab_and_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "517-525",
          "snippet": "static inline struct inode *nfs_igrab_and_active(struct inode *inode)\n{\n\tinode = igrab(inode);\n\tif (inode != NULL && !nfs_sb_active(inode->i_sb)) {\n\t\tiput(inode);\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline struct inode *nfs_igrab_and_active(struct inode *inode)\n{\n\tinode = igrab(inode);\n\tif (inode != NULL && !nfs_sb_active(inode->i_sb)) {\n\t\tiput(inode);\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_compare_fh",
          "args": [
            "fhandle",
            "&NFS_I(delegation->inode)->fh"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "delegation->inode"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct inode *\nnfs_delegation_find_inode_server(struct nfs_server *server,\n\t\t\t\t const struct nfs_fh *fhandle)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct inode *res = NULL;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL &&\n\t\t    nfs_compare_fh(fhandle, &NFS_I(delegation->inode)->fh) == 0) {\n\t\t\tres = igrab(delegation->inode);\n\t\t}\n\t\tspin_unlock(&delegation->lock);\n\t\tif (res != NULL)\n\t\t\tbreak;\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "nfs_async_inode_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "715-739",
    "snippet": "int nfs_async_inode_return_delegation(struct inode *inode,\n\t\t\t\t      const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_delegation *delegation;\n\n\tfilemap_flush(inode->i_mapping);\n\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation == NULL)\n\t\tgoto out_enoent;\n\n\tif (!clp->cl_mvops->match_stateid(&delegation->stateid, stateid))\n\t\tgoto out_enoent;\n\tnfs_mark_return_delegation(server, delegation);\n\trcu_read_unlock();\n\n\tnfs_delegation_run_state_manager(clp);\n\treturn 0;\nout_enoent:\n\trcu_read_unlock();\n\treturn -ENOENT;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_run_state_manager",
          "args": [
            "clp"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_run_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "579-583",
          "snippet": "static void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_return_delegation",
          "args": [
            "server",
            "delegation"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "550-555",
          "snippet": "static void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clp->cl_mvops->match_stateid",
          "args": [
            "&delegation->stateid",
            "stateid"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "NFS_I(inode)->delegation"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filemap_flush",
          "args": [
            "inode->i_mapping"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs_async_inode_return_delegation(struct inode *inode,\n\t\t\t\t      const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_delegation *delegation;\n\n\tfilemap_flush(inode->i_mapping);\n\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation == NULL)\n\t\tgoto out_enoent;\n\n\tif (!clp->cl_mvops->match_stateid(&delegation->stateid, stateid))\n\t\tgoto out_enoent;\n\tnfs_mark_return_delegation(server, delegation);\n\trcu_read_unlock();\n\n\tnfs_delegation_run_state_manager(clp);\n\treturn 0;\nout_enoent:\n\trcu_read_unlock();\n\treturn -ENOENT;\n}"
  },
  {
    "function_name": "nfs_expire_unreferenced_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "696-706",
    "snippet": "void nfs_expire_unreferenced_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unreferenced_delegations(server);\n\trcu_read_unlock();\n\n\tnfs_delegation_run_state_manager(clp);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_delegation_run_state_manager",
          "args": [
            "clp"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_run_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "579-583",
          "snippet": "static void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_return_unreferenced_delegations",
          "args": [
            "server"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_unreferenced_delegations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "680-689",
          "snippet": "static void nfs_mark_return_unreferenced_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif (test_and_clear_bit(NFS_DELEGATION_REFERENCED, &delegation->flags))\n\t\t\tcontinue;\n\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_unreferenced_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif (test_and_clear_bit(NFS_DELEGATION_REFERENCED, &delegation->flags))\n\t\t\tcontinue;\n\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_expire_unreferenced_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unreferenced_delegations(server);\n\trcu_read_unlock();\n\n\tnfs_delegation_run_state_manager(clp);\n}"
  },
  {
    "function_name": "nfs_mark_return_unreferenced_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "680-689",
    "snippet": "static void nfs_mark_return_unreferenced_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif (test_and_clear_bit(NFS_DELEGATION_REFERENCED, &delegation->flags))\n\t\t\tcontinue;\n\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_return_if_closed_delegation",
          "args": [
            "server",
            "delegation"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_if_closed_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "543-548",
          "snippet": "static void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "NFS_DELEGATION_REFERENCED",
            "&delegation->flags"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_unreferenced_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif (test_and_clear_bit(NFS_DELEGATION_REFERENCED, &delegation->flags))\n\t\t\tcontinue;\n\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}"
  },
  {
    "function_name": "nfs_expire_unused_delegation_types",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "674-678",
    "snippet": "void nfs_expire_unused_delegation_types(struct nfs_client *clp, fmode_t flags)\n{\n\tnfs_client_mark_return_unused_delegation_types(clp, flags);\n\tnfs_delegation_run_state_manager(clp);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_delegation_run_state_manager",
          "args": [
            "clp"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_run_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "579-583",
          "snippet": "static void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_client_mark_return_unused_delegation_types",
          "args": [
            "clp",
            "flags"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_client_mark_return_unused_delegation_types",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "632-641",
          "snippet": "static void nfs_client_mark_return_unused_delegation_types(struct nfs_client *clp,\n\t\t\t\t\t\t\tfmode_t flags)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unused_delegation_types(server, flags);\n\trcu_read_unlock();\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_client_mark_return_unused_delegation_types(struct nfs_client *clp,\n\t\t\t\t\t\t\tfmode_t flags)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unused_delegation_types(server, flags);\n\trcu_read_unlock();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_expire_unused_delegation_types(struct nfs_client *clp, fmode_t flags)\n{\n\tnfs_client_mark_return_unused_delegation_types(clp, flags);\n\tnfs_delegation_run_state_manager(clp);\n}"
  },
  {
    "function_name": "nfs_remove_bad_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "655-665",
    "snippet": "void nfs_remove_bad_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tnfs_revoke_delegation(inode);\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation) {\n\t\tnfs_inode_find_state_and_recover(inode, &delegation->stateid);\n\t\tnfs_free_delegation(delegation);\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_delegation",
          "args": [
            "delegation"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "25-32",
          "snippet": "static void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_find_state_and_recover",
          "args": [
            "inode",
            "&delegation->stateid"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_find_state_and_recover",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1336-1360",
          "snippet": "void nfs_inode_find_state_and_recover(struct inode *inode,\n\t\tconst nfs4_stateid *stateid)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state *state;\n\tbool found = false;\n\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tnfs4_state_mark_reclaim_nograce(clp, state);\n\t\tfound = true;\n\t}\n\tspin_unlock(&inode->i_lock);\n\tif (found)\n\t\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid nfs_inode_find_state_and_recover(struct inode *inode,\n\t\tconst nfs4_stateid *stateid)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state *state;\n\tbool found = false;\n\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tnfs4_state_mark_reclaim_nograce(clp, state);\n\t\tfound = true;\n\t}\n\tspin_unlock(&inode->i_lock);\n\tif (found)\n\t\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_detach_delegation",
          "args": [
            "inode"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_detach_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "294-305",
          "snippet": "static struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_revoke_delegation",
          "args": [
            "inode"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_revoke_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "643-653",
          "snippet": "static void nfs_revoke_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tset_bit(NFS_DELEGATION_REVOKED, &delegation->flags);\n\t\tnfs_mark_return_delegation(NFS_SERVER(inode), delegation);\n\t}\n\trcu_read_unlock();\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_revoke_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tset_bit(NFS_DELEGATION_REVOKED, &delegation->flags);\n\t\tnfs_mark_return_delegation(NFS_SERVER(inode), delegation);\n\t}\n\trcu_read_unlock();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_remove_bad_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tnfs_revoke_delegation(inode);\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation) {\n\t\tnfs_inode_find_state_and_recover(inode, &delegation->stateid);\n\t\tnfs_free_delegation(delegation);\n\t}\n}"
  },
  {
    "function_name": "nfs_revoke_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "643-653",
    "snippet": "static void nfs_revoke_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tset_bit(NFS_DELEGATION_REVOKED, &delegation->flags);\n\t\tnfs_mark_return_delegation(NFS_SERVER(inode), delegation);\n\t}\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_return_delegation",
          "args": [
            "NFS_SERVER(inode)",
            "delegation"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "550-555",
          "snippet": "static void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_DELEGATION_REVOKED",
            "&delegation->flags"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "NFS_I(inode)->delegation"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_revoke_delegation(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tset_bit(NFS_DELEGATION_REVOKED, &delegation->flags);\n\t\tnfs_mark_return_delegation(NFS_SERVER(inode), delegation);\n\t}\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "nfs_client_mark_return_unused_delegation_types",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "632-641",
    "snippet": "static void nfs_client_mark_return_unused_delegation_types(struct nfs_client *clp,\n\t\t\t\t\t\t\tfmode_t flags)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unused_delegation_types(server, flags);\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_return_unused_delegation_types",
          "args": [
            "server",
            "flags"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_unused_delegation_types",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "619-630",
          "snippet": "static void nfs_mark_return_unused_delegation_types(struct nfs_server *server,\n\t\t\t\t\t\t fmode_t flags)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif ((delegation->type == (FMODE_READ|FMODE_WRITE)) && !(flags & FMODE_WRITE))\n\t\t\tcontinue;\n\t\tif (delegation->type & flags)\n\t\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_unused_delegation_types(struct nfs_server *server,\n\t\t\t\t\t\t fmode_t flags)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif ((delegation->type == (FMODE_READ|FMODE_WRITE)) && !(flags & FMODE_WRITE))\n\t\t\tcontinue;\n\t\tif (delegation->type & flags)\n\t\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_client_mark_return_unused_delegation_types(struct nfs_client *clp,\n\t\t\t\t\t\t\tfmode_t flags)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_mark_return_unused_delegation_types(server, flags);\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "nfs_mark_return_unused_delegation_types",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "619-630",
    "snippet": "static void nfs_mark_return_unused_delegation_types(struct nfs_server *server,\n\t\t\t\t\t\t fmode_t flags)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif ((delegation->type == (FMODE_READ|FMODE_WRITE)) && !(flags & FMODE_WRITE))\n\t\t\tcontinue;\n\t\tif (delegation->type & flags)\n\t\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_return_if_closed_delegation",
          "args": [
            "server",
            "delegation"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_if_closed_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "543-548",
          "snippet": "static void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_unused_delegation_types(struct nfs_server *server,\n\t\t\t\t\t\t fmode_t flags)\n{\n\tstruct nfs_delegation *delegation;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tif ((delegation->type == (FMODE_READ|FMODE_WRITE)) && !(flags & FMODE_WRITE))\n\t\t\tcontinue;\n\t\tif (delegation->type & flags)\n\t\t\tnfs_mark_return_if_closed_delegation(server, delegation);\n\t}\n}"
  },
  {
    "function_name": "nfs_server_return_all_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "601-617",
    "snippet": "void nfs_server_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tbool need_wait;\n\n\tif (clp == NULL)\n\t\treturn;\n\n\trcu_read_lock();\n\tneed_wait = nfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n\n\tif (need_wait) {\n\t\tnfs4_schedule_state_manager(clp);\n\t\tnfs4_wait_clnt_recover(clp);\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_wait_clnt_recover",
          "args": [
            "clp"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_clnt_recover",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1241-1257",
          "snippet": "int nfs4_wait_clnt_recover(struct nfs_client *clp)\n{\n\tint res;\n\n\tmight_sleep();\n\n\tatomic_inc(&clp->cl_count);\n\tres = wait_on_bit_action(&clp->cl_state, NFS4CLNT_MANAGER_RUNNING,\n\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\tif (res)\n\t\tgoto out;\n\tif (clp->cl_cons_state < 0)\n\t\tres = clp->cl_cons_state;\nout:\n\tnfs_put_client(clp);\n\treturn res;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint nfs4_wait_clnt_recover(struct nfs_client *clp)\n{\n\tint res;\n\n\tmight_sleep();\n\n\tatomic_inc(&clp->cl_count);\n\tres = wait_on_bit_action(&clp->cl_state, NFS4CLNT_MANAGER_RUNNING,\n\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\tif (res)\n\t\tgoto out;\n\tif (clp->cl_cons_state < 0)\n\t\tres = clp->cl_cons_state;\nout:\n\tnfs_put_client(clp);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_schedule_state_manager",
          "args": [
            "clp"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_schedule_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1147-1172",
          "snippet": "void nfs4_schedule_state_manager(struct nfs_client *clp)\n{\n\tstruct task_struct *task;\n\tchar buf[INET6_ADDRSTRLEN + sizeof(\"-manager\") + 1];\n\n\tif (test_and_set_bit(NFS4CLNT_MANAGER_RUNNING, &clp->cl_state) != 0)\n\t\treturn;\n\t__module_get(THIS_MODULE);\n\tatomic_inc(&clp->cl_count);\n\n\t/* The rcu_read_lock() is not strictly necessary, as the state\n\t * manager is the only thread that ever changes the rpc_xprt\n\t * after it's initialized.  At this point, we're single threaded. */\n\trcu_read_lock();\n\tsnprintf(buf, sizeof(buf), \"%s-manager\",\n\t\t\trpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\ttask = kthread_run(nfs4_run_state_manager, clp, \"%s\", buf);\n\tif (IS_ERR(task)) {\n\t\tprintk(KERN_ERR \"%s: kthread_run: %ld\\n\",\n\t\t\t__func__, PTR_ERR(task));\n\t\tnfs4_clear_state_manager_bit(clp);\n\t\tnfs_put_client(clp);\n\t\tmodule_put(THIS_MODULE);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_run_state_manager(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_run_state_manager(void *);\n\nvoid nfs4_schedule_state_manager(struct nfs_client *clp)\n{\n\tstruct task_struct *task;\n\tchar buf[INET6_ADDRSTRLEN + sizeof(\"-manager\") + 1];\n\n\tif (test_and_set_bit(NFS4CLNT_MANAGER_RUNNING, &clp->cl_state) != 0)\n\t\treturn;\n\t__module_get(THIS_MODULE);\n\tatomic_inc(&clp->cl_count);\n\n\t/* The rcu_read_lock() is not strictly necessary, as the state\n\t * manager is the only thread that ever changes the rpc_xprt\n\t * after it's initialized.  At this point, we're single threaded. */\n\trcu_read_lock();\n\tsnprintf(buf, sizeof(buf), \"%s-manager\",\n\t\t\trpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\ttask = kthread_run(nfs4_run_state_manager, clp, \"%s\", buf);\n\tif (IS_ERR(task)) {\n\t\tprintk(KERN_ERR \"%s: kthread_run: %ld\\n\",\n\t\t\t__func__, PTR_ERR(task));\n\t\tnfs4_clear_state_manager_bit(clp);\n\t\tnfs_put_client(clp);\n\t\tmodule_put(THIS_MODULE);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_mark_return_all_delegations",
          "args": [
            "server"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_mark_return_all_delegations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "557-567",
          "snippet": "static bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_server_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\tbool need_wait;\n\n\tif (clp == NULL)\n\t\treturn;\n\n\trcu_read_lock();\n\tneed_wait = nfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n\n\tif (need_wait) {\n\t\tnfs4_schedule_state_manager(clp);\n\t\tnfs4_wait_clnt_recover(clp);\n\t}\n}"
  },
  {
    "function_name": "nfs_expire_all_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "590-594",
    "snippet": "void nfs_expire_all_delegations(struct nfs_client *clp)\n{\n\tnfs_client_mark_return_all_delegations(clp);\n\tnfs_delegation_run_state_manager(clp);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_delegation_run_state_manager",
          "args": [
            "clp"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_run_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "579-583",
          "snippet": "static void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_client_mark_return_all_delegations",
          "args": [
            "clp"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_client_mark_return_all_delegations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "569-577",
          "snippet": "static void nfs_client_mark_return_all_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_client_mark_return_all_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_expire_all_delegations(struct nfs_client *clp)\n{\n\tnfs_client_mark_return_all_delegations(clp);\n\tnfs_delegation_run_state_manager(clp);\n}"
  },
  {
    "function_name": "nfs_delegation_run_state_manager",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "579-583",
    "snippet": "static void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_schedule_state_manager",
          "args": [
            "clp"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_schedule_state_manager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1147-1172",
          "snippet": "void nfs4_schedule_state_manager(struct nfs_client *clp)\n{\n\tstruct task_struct *task;\n\tchar buf[INET6_ADDRSTRLEN + sizeof(\"-manager\") + 1];\n\n\tif (test_and_set_bit(NFS4CLNT_MANAGER_RUNNING, &clp->cl_state) != 0)\n\t\treturn;\n\t__module_get(THIS_MODULE);\n\tatomic_inc(&clp->cl_count);\n\n\t/* The rcu_read_lock() is not strictly necessary, as the state\n\t * manager is the only thread that ever changes the rpc_xprt\n\t * after it's initialized.  At this point, we're single threaded. */\n\trcu_read_lock();\n\tsnprintf(buf, sizeof(buf), \"%s-manager\",\n\t\t\trpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\ttask = kthread_run(nfs4_run_state_manager, clp, \"%s\", buf);\n\tif (IS_ERR(task)) {\n\t\tprintk(KERN_ERR \"%s: kthread_run: %ld\\n\",\n\t\t\t__func__, PTR_ERR(task));\n\t\tnfs4_clear_state_manager_bit(clp);\n\t\tnfs_put_client(clp);\n\t\tmodule_put(THIS_MODULE);\n\t}\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_run_state_manager(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_run_state_manager(void *);\n\nvoid nfs4_schedule_state_manager(struct nfs_client *clp)\n{\n\tstruct task_struct *task;\n\tchar buf[INET6_ADDRSTRLEN + sizeof(\"-manager\") + 1];\n\n\tif (test_and_set_bit(NFS4CLNT_MANAGER_RUNNING, &clp->cl_state) != 0)\n\t\treturn;\n\t__module_get(THIS_MODULE);\n\tatomic_inc(&clp->cl_count);\n\n\t/* The rcu_read_lock() is not strictly necessary, as the state\n\t * manager is the only thread that ever changes the rpc_xprt\n\t * after it's initialized.  At this point, we're single threaded. */\n\trcu_read_lock();\n\tsnprintf(buf, sizeof(buf), \"%s-manager\",\n\t\t\trpc_peeraddr2str(clp->cl_rpcclient, RPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\ttask = kthread_run(nfs4_run_state_manager, clp, \"%s\", buf);\n\tif (IS_ERR(task)) {\n\t\tprintk(KERN_ERR \"%s: kthread_run: %ld\\n\",\n\t\t\t__func__, PTR_ERR(task));\n\t\tnfs4_clear_state_manager_bit(clp);\n\t\tnfs_put_client(clp);\n\t\tmodule_put(THIS_MODULE);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS4CLNT_DELEGRETURN",
            "&clp->cl_state"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_delegation_run_state_manager(struct nfs_client *clp)\n{\n\tif (test_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state))\n\t\tnfs4_schedule_state_manager(clp);\n}"
  },
  {
    "function_name": "nfs_client_mark_return_all_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "569-577",
    "snippet": "static void nfs_client_mark_return_all_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_server_mark_return_all_delegations",
          "args": [
            "server"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_server_mark_return_all_delegations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "557-567",
          "snippet": "static bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_client_mark_return_all_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_server *server;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link)\n\t\tnfs_server_mark_return_all_delegations(server);\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "nfs_server_mark_return_all_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "557-567",
    "snippet": "static bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mark_return_delegation",
          "args": [
            "server",
            "delegation"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "550-555",
          "snippet": "static void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic bool nfs_server_mark_return_all_delegations(struct nfs_server *server)\n{\n\tstruct nfs_delegation *delegation;\n\tbool ret = false;\n\n\tlist_for_each_entry_rcu(delegation, &server->delegations, super_list) {\n\t\tnfs_mark_return_delegation(server, delegation);\n\t\tret = true;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_mark_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "550-555",
    "snippet": "static void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS4CLNT_DELEGRETURN",
            "&server->nfs_client->cl_state"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
  },
  {
    "function_name": "nfs_mark_return_if_closed_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "543-548",
    "snippet": "static void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS4CLNT_DELEGRETURN",
            "&server->nfs_client->cl_state"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_mark_return_if_closed_delegation(struct nfs_server *server,\n\t\tstruct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags);\n\tset_bit(NFS4CLNT_DELEGRETURN, &server->nfs_client->cl_state);\n}"
  },
  {
    "function_name": "nfs4_inode_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "530-541",
    "snippet": "int nfs4_inode_return_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation;\n\tint err = 0;\n\n\tnfs_wb_all(inode);\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation != NULL)\n\t\terr = nfs_end_delegation_return(inode, delegation, 1);\n\treturn err;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_end_delegation_return",
          "args": [
            "inode",
            "delegation",
            "1"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_end_delegation_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "403-433",
          "snippet": "static int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_start_delegation_return",
          "args": [
            "nfsi"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_delegation_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "238-247",
          "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_wb_all",
          "args": [
            "inode"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_wb_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/write.c",
          "lines": "1841-1857",
          "snippet": "int nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4_fs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"nfs4_fs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include <asm/uaccess.h>\n#include <linux/export.h>\n#include <linux/backing-dev.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nfs_init_cinfo_from_inode(struct nfs_commit_info *cinfo,\n\t\t\t\t      struct inode *inode);\n\nint nfs_wb_all(struct inode *inode)\n{\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_ALL,\n\t\t.nr_to_write = LONG_MAX,\n\t\t.range_start = 0,\n\t\t.range_end = LLONG_MAX,\n\t};\n\tint ret;\n\n\ttrace_nfs_writeback_inode_enter(inode);\n\n\tret = sync_inode(inode, &wbc);\n\n\ttrace_nfs_writeback_inode_exit(inode, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs4_inode_return_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation;\n\tint err = 0;\n\n\tnfs_wb_all(inode);\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation != NULL)\n\t\terr = nfs_end_delegation_return(inode, delegation, 1);\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_inode_return_delegation_noreclaim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "511-518",
    "snippet": "void nfs_inode_return_delegation_noreclaim(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation != NULL)\n\t\tnfs_do_return_delegation(inode, delegation, 0);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_do_return_delegation",
          "args": [
            "inode",
            "delegation",
            "0"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "198-209",
          "snippet": "static int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_inode_detach_delegation",
          "args": [
            "inode"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_detach_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "294-305",
          "snippet": "static struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_inode_return_delegation_noreclaim(struct inode *inode)\n{\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_inode_detach_delegation(inode);\n\tif (delegation != NULL)\n\t\tnfs_do_return_delegation(inode, delegation, 0);\n}"
  },
  {
    "function_name": "nfs_client_return_marked_delegations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "466-502",
    "snippet": "int nfs_client_return_marked_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct nfs_server *server;\n\tstruct inode *inode;\n\tint err = 0;\n\nrestart:\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tlist_for_each_entry_rcu(delegation, &server->delegations,\n\t\t\t\t\t\t\t\tsuper_list) {\n\t\t\tif (!nfs_delegation_need_return(delegation))\n\t\t\t\tcontinue;\n\t\t\tif (!nfs_sb_active(server->super))\n\t\t\t\tcontinue;\n\t\t\tinode = nfs_delegation_grab_inode(delegation);\n\t\t\tif (inode == NULL) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\tnfs_sb_deactive(server->super);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tdelegation = nfs_start_delegation_return_locked(NFS_I(inode));\n\t\t\trcu_read_unlock();\n\n\t\t\terr = nfs_end_delegation_return(inode, delegation, 0);\n\t\t\tiput(inode);\n\t\t\tnfs_sb_deactive(server->super);\n\t\t\tif (!err)\n\t\t\t\tgoto restart;\n\t\t\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n\t\t\treturn err;\n\t\t}\n\t}\n\trcu_read_unlock();\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS4CLNT_DELEGRETURN",
            "&clp->cl_state"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sb_deactive",
          "args": [
            "server->super"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_deactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "419-425",
          "snippet": "void nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_iput_and_deactive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "527-535",
          "snippet": "static inline void nfs_iput_and_deactive(struct inode *inode)\n{\n\tif (inode != NULL) {\n\t\tstruct super_block *sb = inode->i_sb;\n\n\t\tiput(inode);\n\t\tnfs_sb_deactive(sb);\n\t}\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern struct inode *nfs_alloc_inode(struct super_block *sb);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "void nfs_initialise_sb(struct super_block *);",
            "void nfs_kill_super(struct super_block *);",
            "extern bool nfs_sb_active(struct super_block *sb);",
            "extern void nfs_sb_deactive(struct super_block *sb);",
            "void nfs_umount_begin(struct super_block *);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern struct inode *nfs_alloc_inode(struct super_block *sb);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nvoid nfs_initialise_sb(struct super_block *);\nvoid nfs_kill_super(struct super_block *);\nextern bool nfs_sb_active(struct super_block *sb);\nextern void nfs_sb_deactive(struct super_block *sb);\nvoid nfs_umount_begin(struct super_block *);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline void nfs_iput_and_deactive(struct inode *inode)\n{\n\tif (inode != NULL) {\n\t\tstruct super_block *sb = inode->i_sb;\n\n\t\tiput(inode);\n\t\tnfs_sb_deactive(sb);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_end_delegation_return",
          "args": [
            "inode",
            "delegation",
            "0"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_end_delegation_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "403-433",
          "snippet": "static int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_start_delegation_return_locked",
          "args": [
            "NFS_I(inode)"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_delegation_return_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "222-236",
          "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_grab_inode",
          "args": [
            "delegation"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_grab_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "211-220",
          "snippet": "static struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_sb_active",
          "args": [
            "server->super"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_sb_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "407-416",
          "snippet": "bool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_delegation_need_return",
          "args": [
            "delegation"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_need_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "435-454",
          "snippet": "static bool nfs_delegation_need_return(struct nfs_delegation *delegation)\n{\n\tbool ret = false;\n\n\tif (test_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tgoto out;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN, &delegation->flags))\n\t\tret = true;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags) && !ret) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&delegation->lock);\n\t\tinode = delegation->inode;\n\t\tif (inode && list_empty(&NFS_I(inode)->open_files))\n\t\t\tret = true;\n\t\tspin_unlock(&delegation->lock);\n\t}\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic bool nfs_delegation_need_return(struct nfs_delegation *delegation)\n{\n\tbool ret = false;\n\n\tif (test_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tgoto out;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN, &delegation->flags))\n\t\tret = true;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags) && !ret) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&delegation->lock);\n\t\tinode = delegation->inode;\n\t\tif (inode && list_empty(&NFS_I(inode)->open_files))\n\t\t\tret = true;\n\t\tspin_unlock(&delegation->lock);\n\t}\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "delegation",
            "&server->delegations",
            "super_list"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "server",
            "&clp->cl_superblocks",
            "client_link"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs_client_return_marked_delegations(struct nfs_client *clp)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct nfs_server *server;\n\tstruct inode *inode;\n\tint err = 0;\n\nrestart:\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(server, &clp->cl_superblocks, client_link) {\n\t\tlist_for_each_entry_rcu(delegation, &server->delegations,\n\t\t\t\t\t\t\t\tsuper_list) {\n\t\t\tif (!nfs_delegation_need_return(delegation))\n\t\t\t\tcontinue;\n\t\t\tif (!nfs_sb_active(server->super))\n\t\t\t\tcontinue;\n\t\t\tinode = nfs_delegation_grab_inode(delegation);\n\t\t\tif (inode == NULL) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\tnfs_sb_deactive(server->super);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tdelegation = nfs_start_delegation_return_locked(NFS_I(inode));\n\t\t\trcu_read_unlock();\n\n\t\t\terr = nfs_end_delegation_return(inode, delegation, 0);\n\t\t\tiput(inode);\n\t\t\tnfs_sb_deactive(server->super);\n\t\t\tif (!err)\n\t\t\t\tgoto restart;\n\t\t\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n\t\t\treturn err;\n\t\t}\n\t}\n\trcu_read_unlock();\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_delegation_need_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "435-454",
    "snippet": "static bool nfs_delegation_need_return(struct nfs_delegation *delegation)\n{\n\tbool ret = false;\n\n\tif (test_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tgoto out;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN, &delegation->flags))\n\t\tret = true;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags) && !ret) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&delegation->lock);\n\t\tinode = delegation->inode;\n\t\tif (inode && list_empty(&NFS_I(inode)->open_files))\n\t\t\tret = true;\n\t\tspin_unlock(&delegation->lock);\n\t}\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&NFS_I(inode)->open_files"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "NFS_DELEGATION_RETURN_IF_CLOSED",
            "&delegation->flags"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&delegation->flags"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic bool nfs_delegation_need_return(struct nfs_delegation *delegation)\n{\n\tbool ret = false;\n\n\tif (test_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tgoto out;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN, &delegation->flags))\n\t\tret = true;\n\tif (test_and_clear_bit(NFS_DELEGATION_RETURN_IF_CLOSED, &delegation->flags) && !ret) {\n\t\tstruct inode *inode;\n\n\t\tspin_lock(&delegation->lock);\n\t\tinode = delegation->inode;\n\t\tif (inode && list_empty(&NFS_I(inode)->open_files))\n\t\t\tret = true;\n\t\tspin_unlock(&delegation->lock);\n\t}\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_end_delegation_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "403-433",
    "snippet": "static int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_do_return_delegation",
          "args": [
            "inode",
            "delegation",
            "issync"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "198-209",
          "snippet": "static int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_detach_delegation",
          "args": [
            "nfsi",
            "delegation",
            "NFS_SERVER(inode)"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_detach_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "282-292",
          "snippet": "static struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_abort_delegation_return",
          "args": [
            "delegation",
            "clp"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_abort_delegation_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "249-259",
          "snippet": "static void\nnfs_abort_delegation_return(struct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\n\tspin_lock(&delegation->lock);\n\tclear_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tspin_unlock(&delegation->lock);\n\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void\nnfs_abort_delegation_return(struct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\n\tspin_lock(&delegation->lock);\n\tclear_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tspin_unlock(&delegation->lock);\n\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_wait_clnt_recover",
          "args": [
            "clp"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_clnt_recover",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1241-1257",
          "snippet": "int nfs4_wait_clnt_recover(struct nfs_client *clp)\n{\n\tint res;\n\n\tmight_sleep();\n\n\tatomic_inc(&clp->cl_count);\n\tres = wait_on_bit_action(&clp->cl_state, NFS4CLNT_MANAGER_RUNNING,\n\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\tif (res)\n\t\tgoto out;\n\tif (clp->cl_cons_state < 0)\n\t\tres = clp->cl_cons_state;\nout:\n\tnfs_put_client(clp);\n\treturn res;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint nfs4_wait_clnt_recover(struct nfs_client *clp)\n{\n\tint res;\n\n\tmight_sleep();\n\n\tatomic_inc(&clp->cl_count);\n\tres = wait_on_bit_action(&clp->cl_state, NFS4CLNT_MANAGER_RUNNING,\n\t\t\t\t nfs_wait_bit_killable, TASK_KILLABLE);\n\tif (res)\n\t\tgoto out;\n\tif (clp->cl_cons_state < 0)\n\t\tres = clp->cl_cons_state;\nout:\n\tnfs_put_client(clp);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_delegation_claim_opens",
          "args": [
            "inode",
            "&delegation->stateid"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_claim_opens",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "116-156",
          "snippet": "static int nfs_delegation_claim_opens(struct inode *inode, const nfs4_stateid *stateid)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state_owner *sp;\n\tstruct nfs4_state *state;\n\tunsigned int seq;\n\tint err;\n\nagain:\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_valid_open_stateid(state))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tget_nfs_open_context(ctx);\n\t\tspin_unlock(&inode->i_lock);\n\t\tsp = state->owner;\n\t\t/* Block nfs4_proc_unlck */\n\t\tmutex_lock(&sp->so_delegreturn_mutex);\n\t\tseq = raw_seqcount_begin(&sp->so_reclaim_seqcount);\n\t\terr = nfs4_open_delegation_recall(ctx, state, stateid);\n\t\tif (!err)\n\t\t\terr = nfs_delegation_claim_locks(ctx, state, stateid);\n\t\tif (!err && read_seqcount_retry(&sp->so_reclaim_seqcount, seq))\n\t\t\terr = -EAGAIN;\n\t\tmutex_unlock(&sp->so_delegreturn_mutex);\n\t\tput_nfs_open_context(ctx);\n\t\tif (err != 0)\n\t\t\treturn err;\n\t\tgoto again;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_delegation_claim_opens(struct inode *inode, const nfs4_stateid *stateid)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state_owner *sp;\n\tstruct nfs4_state *state;\n\tunsigned int seq;\n\tint err;\n\nagain:\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_valid_open_stateid(state))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tget_nfs_open_context(ctx);\n\t\tspin_unlock(&inode->i_lock);\n\t\tsp = state->owner;\n\t\t/* Block nfs4_proc_unlck */\n\t\tmutex_lock(&sp->so_delegreturn_mutex);\n\t\tseq = raw_seqcount_begin(&sp->so_reclaim_seqcount);\n\t\terr = nfs4_open_delegation_recall(ctx, state, stateid);\n\t\tif (!err)\n\t\t\terr = nfs_delegation_claim_locks(ctx, state, stateid);\n\t\tif (!err && read_seqcount_retry(&sp->so_reclaim_seqcount, seq))\n\t\t\terr = -EAGAIN;\n\t\tmutex_unlock(&sp->so_delegreturn_mutex);\n\t\tput_nfs_open_context(ctx);\n\t\tif (err != 0)\n\t\t\treturn err;\n\t\tgoto again;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATION_REVOKED",
            "&delegation->flags"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_end_delegation_return(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tstruct nfs_client *clp = NFS_SERVER(inode)->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tint err = 0;\n\n\tif (delegation == NULL)\n\t\treturn 0;\n\tdo {\n\t\tif (test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\t\tbreak;\n\t\terr = nfs_delegation_claim_opens(inode, &delegation->stateid);\n\t\tif (!issync || err != -EAGAIN)\n\t\t\tbreak;\n\t\t/*\n\t\t * Guard against state recovery\n\t\t */\n\t\terr = nfs4_wait_clnt_recover(clp);\n\t} while (err == 0);\n\n\tif (err) {\n\t\tnfs_abort_delegation_return(delegation, clp);\n\t\tgoto out;\n\t}\n\tif (!nfs_detach_delegation(nfsi, delegation, NFS_SERVER(inode)))\n\t\tgoto out;\n\n\terr = nfs_do_return_delegation(inode, delegation, issync);\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "nfs_inode_set_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "326-398",
    "snippet": "int nfs_inode_set_delegation(struct inode *inode, struct rpc_cred *cred, struct nfs_openres *res)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation, *old_delegation;\n\tstruct nfs_delegation *freeme = NULL;\n\tint status = 0;\n\n\tdelegation = kmalloc(sizeof(*delegation), GFP_NOFS);\n\tif (delegation == NULL)\n\t\treturn -ENOMEM;\n\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\tdelegation->type = res->delegation_type;\n\tdelegation->maxsize = res->maxsize;\n\tdelegation->change_attr = inode->i_version;\n\tdelegation->cred = get_rpccred(cred);\n\tdelegation->inode = inode;\n\tdelegation->flags = 1<<NFS_DELEGATION_REFERENCED;\n\tspin_lock_init(&delegation->lock);\n\n\tspin_lock(&clp->cl_lock);\n\told_delegation = rcu_dereference_protected(nfsi->delegation,\n\t\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\tif (old_delegation != NULL) {\n\t\t/* Is this an update of the existing delegation? */\n\t\tif (nfs4_stateid_match_other(&old_delegation->stateid,\n\t\t\t\t\t&delegation->stateid)) {\n\t\t\tnfs_update_inplace_delegation(old_delegation,\n\t\t\t\t\tdelegation);\n\t\t\tgoto out;\n\t\t}\n\t\t/*\n\t\t * Deal with broken servers that hand out two\n\t\t * delegations for the same file.\n\t\t * Allow for upgrades to a WRITE delegation, but\n\t\t * nothing else.\n\t\t */\n\t\tdfprintk(FILE, \"%s: server %s handed out \"\n\t\t\t\t\"a duplicate delegation!\\n\",\n\t\t\t\t__func__, clp->cl_hostname);\n\t\tif (delegation->type == old_delegation->type ||\n\t\t    !(delegation->type & FMODE_WRITE)) {\n\t\t\tfreeme = delegation;\n\t\t\tdelegation = NULL;\n\t\t\tgoto out;\n\t\t}\n\t\tif (test_and_set_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t&old_delegation->flags))\n\t\t\tgoto out;\n\t\tfreeme = nfs_detach_delegation_locked(nfsi,\n\t\t\t\told_delegation, clp);\n\t\tif (freeme == NULL)\n\t\t\tgoto out;\n\t}\n\tlist_add_rcu(&delegation->super_list, &server->delegations);\n\trcu_assign_pointer(nfsi->delegation, delegation);\n\tdelegation = NULL;\n\n\t/* Ensure we revalidate the attributes and page cache! */\n\tspin_lock(&inode->i_lock);\n\tnfsi->cache_validity |= NFS_INO_REVAL_FORCED;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs4_set_delegation(inode, res->delegation_type);\n\nout:\n\tspin_unlock(&clp->cl_lock);\n\tif (delegation != NULL)\n\t\tnfs_free_delegation(delegation);\n\tif (freeme != NULL)\n\t\tnfs_do_return_delegation(inode, freeme, 0);\n\treturn status;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_do_return_delegation",
          "args": [
            "inode",
            "freeme",
            "0"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_do_return_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "198-209",
          "snippet": "static int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_delegation",
          "args": [
            "delegation"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "25-32",
          "snippet": "static void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_nfs4_set_delegation",
          "args": [
            "inode",
            "res->delegation_type"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_assign_pointer",
          "args": [
            "nfsi->delegation",
            "delegation"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&delegation->super_list",
            "&server->delegations"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_detach_delegation_locked",
          "args": [
            "nfsi",
            "old_delegation",
            "clp"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_detach_delegation_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "261-280",
          "snippet": "static struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&old_delegation->flags"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "FILE",
            "\"%s: server %s handed out \"\n\t\t\t\t\"a duplicate delegation!\\n\"",
            "__func__",
            "clp->cl_hostname"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_update_inplace_delegation",
          "args": [
            "old_delegation",
            "delegation"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_update_inplace_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "307-316",
          "snippet": "static void\nnfs_update_inplace_delegation(struct nfs_delegation *delegation,\n\t\tconst struct nfs_delegation *update)\n{\n\tif (nfs4_stateid_is_newer(&update->stateid, &delegation->stateid)) {\n\t\tdelegation->stateid.seqid = update->stateid.seqid;\n\t\tsmp_wmb();\n\t\tdelegation->type = update->type;\n\t}\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void\nnfs_update_inplace_delegation(struct nfs_delegation *delegation,\n\t\tconst struct nfs_delegation *update)\n{\n\tif (nfs4_stateid_is_newer(&update->stateid, &delegation->stateid)) {\n\t\tdelegation->stateid.seqid = update->stateid.seqid;\n\t\tsmp_wmb();\n\t\tdelegation->type = update->type;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_match_other",
          "args": [
            "&old_delegation->stateid",
            "&delegation->stateid"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_match_other",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "506-509",
          "snippet": "static inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference_protected",
          "args": [
            "nfsi->delegation",
            "lockdep_is_held(&clp->cl_lock)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_is_held",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&delegation->lock"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_rpccred",
          "args": [
            "cred"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_copy",
          "args": [
            "&delegation->stateid",
            "&res->delegation"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "496-499",
          "snippet": "static inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*delegation)",
            "GFP_NOFS"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs_inode_set_delegation(struct inode *inode, struct rpc_cred *cred, struct nfs_openres *res)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation, *old_delegation;\n\tstruct nfs_delegation *freeme = NULL;\n\tint status = 0;\n\n\tdelegation = kmalloc(sizeof(*delegation), GFP_NOFS);\n\tif (delegation == NULL)\n\t\treturn -ENOMEM;\n\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\tdelegation->type = res->delegation_type;\n\tdelegation->maxsize = res->maxsize;\n\tdelegation->change_attr = inode->i_version;\n\tdelegation->cred = get_rpccred(cred);\n\tdelegation->inode = inode;\n\tdelegation->flags = 1<<NFS_DELEGATION_REFERENCED;\n\tspin_lock_init(&delegation->lock);\n\n\tspin_lock(&clp->cl_lock);\n\told_delegation = rcu_dereference_protected(nfsi->delegation,\n\t\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\tif (old_delegation != NULL) {\n\t\t/* Is this an update of the existing delegation? */\n\t\tif (nfs4_stateid_match_other(&old_delegation->stateid,\n\t\t\t\t\t&delegation->stateid)) {\n\t\t\tnfs_update_inplace_delegation(old_delegation,\n\t\t\t\t\tdelegation);\n\t\t\tgoto out;\n\t\t}\n\t\t/*\n\t\t * Deal with broken servers that hand out two\n\t\t * delegations for the same file.\n\t\t * Allow for upgrades to a WRITE delegation, but\n\t\t * nothing else.\n\t\t */\n\t\tdfprintk(FILE, \"%s: server %s handed out \"\n\t\t\t\t\"a duplicate delegation!\\n\",\n\t\t\t\t__func__, clp->cl_hostname);\n\t\tif (delegation->type == old_delegation->type ||\n\t\t    !(delegation->type & FMODE_WRITE)) {\n\t\t\tfreeme = delegation;\n\t\t\tdelegation = NULL;\n\t\t\tgoto out;\n\t\t}\n\t\tif (test_and_set_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t&old_delegation->flags))\n\t\t\tgoto out;\n\t\tfreeme = nfs_detach_delegation_locked(nfsi,\n\t\t\t\told_delegation, clp);\n\t\tif (freeme == NULL)\n\t\t\tgoto out;\n\t}\n\tlist_add_rcu(&delegation->super_list, &server->delegations);\n\trcu_assign_pointer(nfsi->delegation, delegation);\n\tdelegation = NULL;\n\n\t/* Ensure we revalidate the attributes and page cache! */\n\tspin_lock(&inode->i_lock);\n\tnfsi->cache_validity |= NFS_INO_REVAL_FORCED;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs4_set_delegation(inode, res->delegation_type);\n\nout:\n\tspin_unlock(&clp->cl_lock);\n\tif (delegation != NULL)\n\t\tnfs_free_delegation(delegation);\n\tif (freeme != NULL)\n\t\tnfs_do_return_delegation(inode, freeme, 0);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs_update_inplace_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "307-316",
    "snippet": "static void\nnfs_update_inplace_delegation(struct nfs_delegation *delegation,\n\t\tconst struct nfs_delegation *update)\n{\n\tif (nfs4_stateid_is_newer(&update->stateid, &delegation->stateid)) {\n\t\tdelegation->stateid.seqid = update->stateid.seqid;\n\t\tsmp_wmb();\n\t\tdelegation->type = update->type;\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_wmb",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_is_newer",
          "args": [
            "&update->stateid",
            "&delegation->stateid"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_is_newer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "511-514",
          "snippet": "static inline bool nfs4_stateid_is_newer(const nfs4_stateid *s1, const nfs4_stateid *s2)\n{\n\treturn (s32)(be32_to_cpu(s1->seqid) - be32_to_cpu(s2->seqid)) > 0;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_is_newer(const nfs4_stateid *s1, const nfs4_stateid *s2)\n{\n\treturn (s32)(be32_to_cpu(s1->seqid) - be32_to_cpu(s2->seqid)) > 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void\nnfs_update_inplace_delegation(struct nfs_delegation *delegation,\n\t\tconst struct nfs_delegation *update)\n{\n\tif (nfs4_stateid_is_newer(&update->stateid, &delegation->stateid)) {\n\t\tdelegation->stateid.seqid = update->stateid.seqid;\n\t\tsmp_wmb();\n\t\tdelegation->type = update->type;\n\t}\n}"
  },
  {
    "function_name": "nfs_inode_detach_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "294-305",
    "snippet": "static struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_detach_delegation",
          "args": [
            "nfsi",
            "delegation",
            "server"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_detach_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "282-292",
          "snippet": "static struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_start_delegation_return",
          "args": [
            "nfsi"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_delegation_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "238-247",
          "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SERVER",
          "args": [
            "inode"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_inode_detach_delegation(struct inode *inode)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_delegation *delegation;\n\n\tdelegation = nfs_start_delegation_return(nfsi);\n\tif (delegation == NULL)\n\t\treturn NULL;\n\treturn nfs_detach_delegation(nfsi, delegation, server);\n}"
  },
  {
    "function_name": "nfs_detach_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "282-292",
    "snippet": "static struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_detach_delegation_locked",
          "args": [
            "nfsi",
            "delegation",
            "clp"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_detach_delegation_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "261-280",
          "snippet": "static struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *nfs_detach_delegation(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_server *server)\n{\n\tstruct nfs_client *clp = server->nfs_client;\n\n\tspin_lock(&clp->cl_lock);\n\tdelegation = nfs_detach_delegation_locked(nfsi, delegation, clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn delegation;\n}"
  },
  {
    "function_name": "nfs_detach_delegation_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "261-280",
    "snippet": "static struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_assign_pointer",
          "args": [
            "nfsi->delegation",
            "NULL"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&delegation->super_list"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&delegation->flags"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference_protected",
          "args": [
            "nfsi->delegation",
            "lockdep_is_held(&clp->cl_lock)"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_is_held",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_detach_delegation_locked(struct nfs_inode *nfsi,\n\t\tstruct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\tstruct nfs_delegation *deleg_cur =\n\t\trcu_dereference_protected(nfsi->delegation,\n\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\n\tif (deleg_cur == NULL || delegation != deleg_cur)\n\t\treturn NULL;\n\n\tspin_lock(&delegation->lock);\n\tset_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tlist_del_rcu(&delegation->super_list);\n\tdelegation->inode = NULL;\n\trcu_assign_pointer(nfsi->delegation, NULL);\n\tspin_unlock(&delegation->lock);\n\treturn delegation;\n}"
  },
  {
    "function_name": "nfs_abort_delegation_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "249-259",
    "snippet": "static void\nnfs_abort_delegation_return(struct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\n\tspin_lock(&delegation->lock);\n\tclear_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tspin_unlock(&delegation->lock);\n\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS4CLNT_DELEGRETURN",
            "&clp->cl_state"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&delegation->flags"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void\nnfs_abort_delegation_return(struct nfs_delegation *delegation,\n\t\tstruct nfs_client *clp)\n{\n\n\tspin_lock(&delegation->lock);\n\tclear_bit(NFS_DELEGATION_RETURNING, &delegation->flags);\n\tset_bit(NFS_DELEGATION_RETURN, &delegation->flags);\n\tspin_unlock(&delegation->lock);\n\tset_bit(NFS4CLNT_DELEGRETURN, &clp->cl_state);\n}"
  },
  {
    "function_name": "nfs_start_delegation_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "238-247",
    "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_start_delegation_return_locked",
          "args": [
            "nfsi"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_start_delegation_return_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "222-236",
          "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *delegation;\n\n\trcu_read_lock();\n\tdelegation = nfs_start_delegation_return_locked(nfsi);\n\trcu_read_unlock();\n\treturn delegation;\n}"
  },
  {
    "function_name": "nfs_start_delegation_return_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "222-236",
    "snippet": "static struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&delegation->flags"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "nfsi->delegation"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct nfs_delegation *\nnfs_start_delegation_return_locked(struct nfs_inode *nfsi)\n{\n\tstruct nfs_delegation *ret = NULL;\n\tstruct nfs_delegation *delegation = rcu_dereference(nfsi->delegation);\n\n\tif (delegation == NULL)\n\t\tgoto out;\n\tspin_lock(&delegation->lock);\n\tif (!test_and_set_bit(NFS_DELEGATION_RETURNING, &delegation->flags))\n\t\tret = delegation;\n\tspin_unlock(&delegation->lock);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_delegation_grab_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "211-220",
    "snippet": "static struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "igrab",
          "args": [
            "delegation->inode"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_igrab_and_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "517-525",
          "snippet": "static inline struct inode *nfs_igrab_and_active(struct inode *inode)\n{\n\tinode = igrab(inode);\n\tif (inode != NULL && !nfs_sb_active(inode->i_sb)) {\n\t\tiput(inode);\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);",
            "extern void nfs_destroy_inode(struct inode *);",
            "extern int nfs_drop_inode(struct inode *);",
            "extern void nfs_clear_inode(struct inode *);",
            "extern void nfs_evict_inode(struct inode *);",
            "void nfs_zap_acl_cache(struct inode *inode);",
            "int nfs_key_timeout_notify(struct file *filp, struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nextern struct rpc_clnt *nfs4_find_or_create_ds_client(struct nfs_client *,\n\t\t\t\t\t\tstruct inode *);\nextern void nfs_destroy_inode(struct inode *);\nextern int nfs_drop_inode(struct inode *);\nextern void nfs_clear_inode(struct inode *);\nextern void nfs_evict_inode(struct inode *);\nvoid nfs_zap_acl_cache(struct inode *inode);\nint nfs_key_timeout_notify(struct file *filp, struct inode *inode);\n\nstatic inline struct inode *nfs_igrab_and_active(struct inode *inode)\n{\n\tinode = igrab(inode);\n\tif (inode != NULL && !nfs_sb_active(inode->i_sb)) {\n\t\tiput(inode);\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic struct inode *nfs_delegation_grab_inode(struct nfs_delegation *delegation)\n{\n\tstruct inode *inode = NULL;\n\n\tspin_lock(&delegation->lock);\n\tif (delegation->inode != NULL)\n\t\tinode = igrab(delegation->inode);\n\tspin_unlock(&delegation->lock);\n\treturn inode;\n}"
  },
  {
    "function_name": "nfs_do_return_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "198-209",
    "snippet": "static int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_delegation",
          "args": [
            "delegation"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "25-32",
          "snippet": "static void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_proc_delegreturn",
          "args": [
            "inode",
            "delegation->cred",
            "&delegation->stateid",
            "issync"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_proc_delegreturn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "5270-5287",
          "snippet": "int nfs4_proc_delegreturn(struct inode *inode, struct rpc_cred *cred, const nfs4_stateid *stateid, int issync)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs4_exception exception = { };\n\tint err;\n\tdo {\n\t\terr = _nfs4_proc_delegreturn(inode, cred, stateid, issync);\n\t\ttrace_nfs4_delegreturn(inode, err);\n\t\tswitch (err) {\n\t\t\tcase -NFS4ERR_STALE_STATEID:\n\t\t\tcase -NFS4ERR_EXPIRED:\n\t\t\tcase 0:\n\t\t\t\treturn 0;\n\t\t}\n\t\terr = nfs4_handle_exception(server, err, &exception);\n\t} while (exception.retry);\n\treturn err;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nint nfs4_proc_delegreturn(struct inode *inode, struct rpc_cred *cred, const nfs4_stateid *stateid, int issync)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs4_exception exception = { };\n\tint err;\n\tdo {\n\t\terr = _nfs4_proc_delegreturn(inode, cred, stateid, issync);\n\t\ttrace_nfs4_delegreturn(inode, err);\n\t\tswitch (err) {\n\t\t\tcase -NFS4ERR_STALE_STATEID:\n\t\t\tcase -NFS4ERR_EXPIRED:\n\t\t\tcase 0:\n\t\t\t\treturn 0;\n\t\t}\n\t\terr = nfs4_handle_exception(server, err, &exception);\n\t} while (exception.retry);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATION_REVOKED",
            "&delegation->flags"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_do_return_delegation(struct inode *inode, struct nfs_delegation *delegation, int issync)\n{\n\tint res = 0;\n\n\tif (!test_bit(NFS_DELEGATION_REVOKED, &delegation->flags))\n\t\tres = nfs4_proc_delegreturn(inode,\n\t\t\t\tdelegation->cred,\n\t\t\t\t&delegation->stateid,\n\t\t\t\tissync);\n\tnfs_free_delegation(delegation);\n\treturn res;\n}"
  },
  {
    "function_name": "nfs_inode_reclaim_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "165-196",
    "snippet": "void nfs_inode_reclaim_delegation(struct inode *inode, struct rpc_cred *cred,\n\t\t\t\t  struct nfs_openres *res)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct rpc_cred *oldcred = NULL;\n\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL) {\n\t\t\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\t\t\tdelegation->type = res->delegation_type;\n\t\t\tdelegation->maxsize = res->maxsize;\n\t\t\toldcred = delegation->cred;\n\t\t\tdelegation->cred = get_rpccred(cred);\n\t\t\tclear_bit(NFS_DELEGATION_NEED_RECLAIM,\n\t\t\t\t  &delegation->flags);\n\t\t\tspin_unlock(&delegation->lock);\n\t\t\trcu_read_unlock();\n\t\t\tput_rpccred(oldcred);\n\t\t\ttrace_nfs4_reclaim_delegation(inode, res->delegation_type);\n\t\t} else {\n\t\t\t/* We appear to have raced with a delegation return. */\n\t\t\tspin_unlock(&delegation->lock);\n\t\t\trcu_read_unlock();\n\t\t\tnfs_inode_set_delegation(inode, cred, res);\n\t\t}\n\t} else {\n\t\trcu_read_unlock();\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_inode_set_delegation",
          "args": [
            "inode",
            "cred",
            "res"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_inode_set_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "326-398",
          "snippet": "int nfs_inode_set_delegation(struct inode *inode, struct rpc_cred *cred, struct nfs_openres *res)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation, *old_delegation;\n\tstruct nfs_delegation *freeme = NULL;\n\tint status = 0;\n\n\tdelegation = kmalloc(sizeof(*delegation), GFP_NOFS);\n\tif (delegation == NULL)\n\t\treturn -ENOMEM;\n\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\tdelegation->type = res->delegation_type;\n\tdelegation->maxsize = res->maxsize;\n\tdelegation->change_attr = inode->i_version;\n\tdelegation->cred = get_rpccred(cred);\n\tdelegation->inode = inode;\n\tdelegation->flags = 1<<NFS_DELEGATION_REFERENCED;\n\tspin_lock_init(&delegation->lock);\n\n\tspin_lock(&clp->cl_lock);\n\told_delegation = rcu_dereference_protected(nfsi->delegation,\n\t\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\tif (old_delegation != NULL) {\n\t\t/* Is this an update of the existing delegation? */\n\t\tif (nfs4_stateid_match_other(&old_delegation->stateid,\n\t\t\t\t\t&delegation->stateid)) {\n\t\t\tnfs_update_inplace_delegation(old_delegation,\n\t\t\t\t\tdelegation);\n\t\t\tgoto out;\n\t\t}\n\t\t/*\n\t\t * Deal with broken servers that hand out two\n\t\t * delegations for the same file.\n\t\t * Allow for upgrades to a WRITE delegation, but\n\t\t * nothing else.\n\t\t */\n\t\tdfprintk(FILE, \"%s: server %s handed out \"\n\t\t\t\t\"a duplicate delegation!\\n\",\n\t\t\t\t__func__, clp->cl_hostname);\n\t\tif (delegation->type == old_delegation->type ||\n\t\t    !(delegation->type & FMODE_WRITE)) {\n\t\t\tfreeme = delegation;\n\t\t\tdelegation = NULL;\n\t\t\tgoto out;\n\t\t}\n\t\tif (test_and_set_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t&old_delegation->flags))\n\t\t\tgoto out;\n\t\tfreeme = nfs_detach_delegation_locked(nfsi,\n\t\t\t\told_delegation, clp);\n\t\tif (freeme == NULL)\n\t\t\tgoto out;\n\t}\n\tlist_add_rcu(&delegation->super_list, &server->delegations);\n\trcu_assign_pointer(nfsi->delegation, delegation);\n\tdelegation = NULL;\n\n\t/* Ensure we revalidate the attributes and page cache! */\n\tspin_lock(&inode->i_lock);\n\tnfsi->cache_validity |= NFS_INO_REVAL_FORCED;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs4_set_delegation(inode, res->delegation_type);\n\nout:\n\tspin_unlock(&clp->cl_lock);\n\tif (delegation != NULL)\n\t\tnfs_free_delegation(delegation);\n\tif (freeme != NULL)\n\t\tnfs_do_return_delegation(inode, freeme, 0);\n\treturn status;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs_inode_set_delegation(struct inode *inode, struct rpc_cred *cred, struct nfs_openres *res)\n{\n\tstruct nfs_server *server = NFS_SERVER(inode);\n\tstruct nfs_client *clp = server->nfs_client;\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_delegation *delegation, *old_delegation;\n\tstruct nfs_delegation *freeme = NULL;\n\tint status = 0;\n\n\tdelegation = kmalloc(sizeof(*delegation), GFP_NOFS);\n\tif (delegation == NULL)\n\t\treturn -ENOMEM;\n\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\tdelegation->type = res->delegation_type;\n\tdelegation->maxsize = res->maxsize;\n\tdelegation->change_attr = inode->i_version;\n\tdelegation->cred = get_rpccred(cred);\n\tdelegation->inode = inode;\n\tdelegation->flags = 1<<NFS_DELEGATION_REFERENCED;\n\tspin_lock_init(&delegation->lock);\n\n\tspin_lock(&clp->cl_lock);\n\told_delegation = rcu_dereference_protected(nfsi->delegation,\n\t\t\t\t\tlockdep_is_held(&clp->cl_lock));\n\tif (old_delegation != NULL) {\n\t\t/* Is this an update of the existing delegation? */\n\t\tif (nfs4_stateid_match_other(&old_delegation->stateid,\n\t\t\t\t\t&delegation->stateid)) {\n\t\t\tnfs_update_inplace_delegation(old_delegation,\n\t\t\t\t\tdelegation);\n\t\t\tgoto out;\n\t\t}\n\t\t/*\n\t\t * Deal with broken servers that hand out two\n\t\t * delegations for the same file.\n\t\t * Allow for upgrades to a WRITE delegation, but\n\t\t * nothing else.\n\t\t */\n\t\tdfprintk(FILE, \"%s: server %s handed out \"\n\t\t\t\t\"a duplicate delegation!\\n\",\n\t\t\t\t__func__, clp->cl_hostname);\n\t\tif (delegation->type == old_delegation->type ||\n\t\t    !(delegation->type & FMODE_WRITE)) {\n\t\t\tfreeme = delegation;\n\t\t\tdelegation = NULL;\n\t\t\tgoto out;\n\t\t}\n\t\tif (test_and_set_bit(NFS_DELEGATION_RETURNING,\n\t\t\t\t\t&old_delegation->flags))\n\t\t\tgoto out;\n\t\tfreeme = nfs_detach_delegation_locked(nfsi,\n\t\t\t\told_delegation, clp);\n\t\tif (freeme == NULL)\n\t\t\tgoto out;\n\t}\n\tlist_add_rcu(&delegation->super_list, &server->delegations);\n\trcu_assign_pointer(nfsi->delegation, delegation);\n\tdelegation = NULL;\n\n\t/* Ensure we revalidate the attributes and page cache! */\n\tspin_lock(&inode->i_lock);\n\tnfsi->cache_validity |= NFS_INO_REVAL_FORCED;\n\tspin_unlock(&inode->i_lock);\n\ttrace_nfs4_set_delegation(inode, res->delegation_type);\n\nout:\n\tspin_unlock(&clp->cl_lock);\n\tif (delegation != NULL)\n\t\tnfs_free_delegation(delegation);\n\tif (freeme != NULL)\n\t\tnfs_do_return_delegation(inode, freeme, 0);\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&delegation->lock"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_nfs4_reclaim_delegation",
          "args": [
            "inode",
            "res->delegation_type"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "oldcred"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS_DELEGATION_NEED_RECLAIM",
            "&delegation->flags"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_rpccred",
          "args": [
            "cred"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_copy",
          "args": [
            "&delegation->stateid",
            "&res->delegation"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "496-499",
          "snippet": "static inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline void nfs4_stateid_copy(nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\tmemcpy(dst, src, sizeof(*dst));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&delegation->lock"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "NFS_I(inode)->delegation"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_inode_reclaim_delegation(struct inode *inode, struct rpc_cred *cred,\n\t\t\t\t  struct nfs_openres *res)\n{\n\tstruct nfs_delegation *delegation;\n\tstruct rpc_cred *oldcred = NULL;\n\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL) {\n\t\tspin_lock(&delegation->lock);\n\t\tif (delegation->inode != NULL) {\n\t\t\tnfs4_stateid_copy(&delegation->stateid, &res->delegation);\n\t\t\tdelegation->type = res->delegation_type;\n\t\t\tdelegation->maxsize = res->maxsize;\n\t\t\toldcred = delegation->cred;\n\t\t\tdelegation->cred = get_rpccred(cred);\n\t\t\tclear_bit(NFS_DELEGATION_NEED_RECLAIM,\n\t\t\t\t  &delegation->flags);\n\t\t\tspin_unlock(&delegation->lock);\n\t\t\trcu_read_unlock();\n\t\t\tput_rpccred(oldcred);\n\t\t\ttrace_nfs4_reclaim_delegation(inode, res->delegation_type);\n\t\t} else {\n\t\t\t/* We appear to have raced with a delegation return. */\n\t\t\tspin_unlock(&delegation->lock);\n\t\t\trcu_read_unlock();\n\t\t\tnfs_inode_set_delegation(inode, cred, res);\n\t\t}\n\t} else {\n\t\trcu_read_unlock();\n\t}\n}"
  },
  {
    "function_name": "nfs_delegation_claim_opens",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "116-156",
    "snippet": "static int nfs_delegation_claim_opens(struct inode *inode, const nfs4_stateid *stateid)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state_owner *sp;\n\tstruct nfs4_state *state;\n\tunsigned int seq;\n\tint err;\n\nagain:\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_valid_open_stateid(state))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tget_nfs_open_context(ctx);\n\t\tspin_unlock(&inode->i_lock);\n\t\tsp = state->owner;\n\t\t/* Block nfs4_proc_unlck */\n\t\tmutex_lock(&sp->so_delegreturn_mutex);\n\t\tseq = raw_seqcount_begin(&sp->so_reclaim_seqcount);\n\t\terr = nfs4_open_delegation_recall(ctx, state, stateid);\n\t\tif (!err)\n\t\t\terr = nfs_delegation_claim_locks(ctx, state, stateid);\n\t\tif (!err && read_seqcount_retry(&sp->so_reclaim_seqcount, seq))\n\t\t\terr = -EAGAIN;\n\t\tmutex_unlock(&sp->so_delegreturn_mutex);\n\t\tput_nfs_open_context(ctx);\n\t\tif (err != 0)\n\t\t\treturn err;\n\t\tgoto again;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "833-836",
          "snippet": "void put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_open_context(struct nfs_open_context *ctx)\n{\n\t__put_nfs_open_context(ctx, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sp->so_delegreturn_mutex"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_seqcount_retry",
          "args": [
            "&sp->so_reclaim_seqcount",
            "seq"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_delegation_claim_locks",
          "args": [
            "ctx",
            "state",
            "stateid"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_delegation_claim_locks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "84-114",
          "snippet": "static int nfs_delegation_claim_locks(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct inode *inode = state->inode;\n\tstruct file_lock *fl;\n\tstruct file_lock_context *flctx = inode->i_flctx;\n\tstruct list_head *list;\n\tint status = 0;\n\n\tif (flctx == NULL)\n\t\tgoto out;\n\n\tlist = &flctx->flc_posix;\n\tspin_lock(&flctx->flc_lock);\nrestart:\n\tlist_for_each_entry(fl, list, fl_list) {\n\t\tif (nfs_file_open_context(fl->fl_file) != ctx)\n\t\t\tcontinue;\n\t\tspin_unlock(&flctx->flc_lock);\n\t\tstatus = nfs4_lock_delegation_recall(fl, state, stateid);\n\t\tif (status < 0)\n\t\t\tgoto out;\n\t\tspin_lock(&flctx->flc_lock);\n\t}\n\tif (list == &flctx->flc_posix) {\n\t\tlist = &flctx->flc_flock;\n\t\tgoto restart;\n\t}\n\tspin_unlock(&flctx->flc_lock);\nout:\n\treturn status;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_delegation_claim_locks(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct inode *inode = state->inode;\n\tstruct file_lock *fl;\n\tstruct file_lock_context *flctx = inode->i_flctx;\n\tstruct list_head *list;\n\tint status = 0;\n\n\tif (flctx == NULL)\n\t\tgoto out;\n\n\tlist = &flctx->flc_posix;\n\tspin_lock(&flctx->flc_lock);\nrestart:\n\tlist_for_each_entry(fl, list, fl_list) {\n\t\tif (nfs_file_open_context(fl->fl_file) != ctx)\n\t\t\tcontinue;\n\t\tspin_unlock(&flctx->flc_lock);\n\t\tstatus = nfs4_lock_delegation_recall(fl, state, stateid);\n\t\tif (status < 0)\n\t\t\tgoto out;\n\t\tspin_lock(&flctx->flc_lock);\n\t}\n\tif (list == &flctx->flc_posix) {\n\t\tlist = &flctx->flc_flock;\n\t\tgoto restart;\n\t}\n\tspin_unlock(&flctx->flc_lock);\nout:\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_open_delegation_recall",
          "args": [
            "ctx",
            "state",
            "stateid"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_open_delegation_recall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1729-1743",
          "snippet": "int nfs4_open_delegation_recall(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(state->inode);\n\tstruct nfs4_opendata *opendata;\n\tint err;\n\n\topendata = nfs4_open_recoverdata_alloc(ctx, state,\n\t\t\tNFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tif (IS_ERR(opendata))\n\t\treturn PTR_ERR(opendata);\n\tnfs4_stateid_copy(&opendata->o_arg.u.delegation, stateid);\n\terr = nfs4_open_recover(opendata, state);\n\tnfs4_opendata_put(opendata);\n\treturn nfs4_handle_delegation_recall_error(server, state, stateid, err);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);\n\nint nfs4_open_delegation_recall(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(state->inode);\n\tstruct nfs4_opendata *opendata;\n\tint err;\n\n\topendata = nfs4_open_recoverdata_alloc(ctx, state,\n\t\t\tNFS4_OPEN_CLAIM_DELEG_CUR_FH);\n\tif (IS_ERR(opendata))\n\t\treturn PTR_ERR(opendata);\n\tnfs4_stateid_copy(&opendata->o_arg.u.delegation, stateid);\n\terr = nfs4_open_recover(opendata, state);\n\tnfs4_opendata_put(opendata);\n\treturn nfs4_handle_delegation_recall_error(server, state, stateid, err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_seqcount_begin",
          "args": [
            "&sp->so_reclaim_seqcount"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sp->so_delegreturn_mutex"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_nfs_open_context",
          "args": [
            "ctx"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_open_context",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "803-808",
          "snippet": "struct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_open_context *get_nfs_open_context(struct nfs_open_context *ctx)\n{\n\tif (ctx != NULL)\n\t\tatomic_inc(&ctx->lock_context.count);\n\treturn ctx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_stateid_match",
          "args": [
            "&state->stateid",
            "stateid"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_stateid_match_other",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "506-509",
          "snippet": "static inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_stateid_match_other(const nfs4_stateid *dst, const nfs4_stateid *src)\n{\n\treturn memcmp(dst->other, src->other, NFS4_STATEID_OTHER_SIZE) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_valid_open_stateid",
          "args": [
            "state"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_valid_open_stateid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "516-519",
          "snippet": "static inline bool nfs4_valid_open_stateid(const struct nfs4_state *state)\n{\n\treturn test_bit(NFS_STATE_RECOVERY_FAILED, &state->flags) == 0;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool nfs4_valid_open_stateid(const struct nfs4_state *state)\n{\n\treturn test_bit(NFS_STATE_RECOVERY_FAILED, &state->flags) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATED_STATE",
            "&state->flags"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "ctx",
            "&nfsi->open_files",
            "list"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_delegation_claim_opens(struct inode *inode, const nfs4_stateid *stateid)\n{\n\tstruct nfs_inode *nfsi = NFS_I(inode);\n\tstruct nfs_open_context *ctx;\n\tstruct nfs4_state_owner *sp;\n\tstruct nfs4_state *state;\n\tunsigned int seq;\n\tint err;\n\nagain:\n\tspin_lock(&inode->i_lock);\n\tlist_for_each_entry(ctx, &nfsi->open_files, list) {\n\t\tstate = ctx->state;\n\t\tif (state == NULL)\n\t\t\tcontinue;\n\t\tif (!test_bit(NFS_DELEGATED_STATE, &state->flags))\n\t\t\tcontinue;\n\t\tif (!nfs4_valid_open_stateid(state))\n\t\t\tcontinue;\n\t\tif (!nfs4_stateid_match(&state->stateid, stateid))\n\t\t\tcontinue;\n\t\tget_nfs_open_context(ctx);\n\t\tspin_unlock(&inode->i_lock);\n\t\tsp = state->owner;\n\t\t/* Block nfs4_proc_unlck */\n\t\tmutex_lock(&sp->so_delegreturn_mutex);\n\t\tseq = raw_seqcount_begin(&sp->so_reclaim_seqcount);\n\t\terr = nfs4_open_delegation_recall(ctx, state, stateid);\n\t\tif (!err)\n\t\t\terr = nfs_delegation_claim_locks(ctx, state, stateid);\n\t\tif (!err && read_seqcount_retry(&sp->so_reclaim_seqcount, seq))\n\t\t\terr = -EAGAIN;\n\t\tmutex_unlock(&sp->so_delegreturn_mutex);\n\t\tput_nfs_open_context(ctx);\n\t\tif (err != 0)\n\t\t\treturn err;\n\t\tgoto again;\n\t}\n\tspin_unlock(&inode->i_lock);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_delegation_claim_locks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "84-114",
    "snippet": "static int nfs_delegation_claim_locks(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct inode *inode = state->inode;\n\tstruct file_lock *fl;\n\tstruct file_lock_context *flctx = inode->i_flctx;\n\tstruct list_head *list;\n\tint status = 0;\n\n\tif (flctx == NULL)\n\t\tgoto out;\n\n\tlist = &flctx->flc_posix;\n\tspin_lock(&flctx->flc_lock);\nrestart:\n\tlist_for_each_entry(fl, list, fl_list) {\n\t\tif (nfs_file_open_context(fl->fl_file) != ctx)\n\t\t\tcontinue;\n\t\tspin_unlock(&flctx->flc_lock);\n\t\tstatus = nfs4_lock_delegation_recall(fl, state, stateid);\n\t\tif (status < 0)\n\t\t\tgoto out;\n\t\tspin_lock(&flctx->flc_lock);\n\t}\n\tif (list == &flctx->flc_posix) {\n\t\tlist = &flctx->flc_flock;\n\t\tgoto restart;\n\t}\n\tspin_unlock(&flctx->flc_lock);\nout:\n\treturn status;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&flctx->flc_lock"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&flctx->flc_lock"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_lock_delegation_recall",
          "args": [
            "fl",
            "state",
            "stateid"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_lock_delegation_recall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "6014-6024",
          "snippet": "int nfs4_lock_delegation_recall(struct file_lock *fl, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(state->inode);\n\tint err;\n\n\terr = nfs4_set_lock_state(state, fl);\n\tif (err != 0)\n\t\treturn err;\n\terr = _nfs4_do_setlk(state, F_SETLK, fl, NFS_LOCK_NEW);\n\treturn nfs4_handle_delegation_recall_error(server, state, stateid, err);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_async_handle_error(struct rpc_task *, const struct nfs_server *, struct nfs4_state *, long *);\n\nint nfs4_lock_delegation_recall(struct file_lock *fl, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct nfs_server *server = NFS_SERVER(state->inode);\n\tint err;\n\n\terr = nfs4_set_lock_state(state, fl);\n\tif (err != 0)\n\t\treturn err;\n\terr = _nfs4_do_setlk(state, F_SETLK, fl, NFS_LOCK_NEW);\n\treturn nfs4_handle_delegation_recall_error(server, state, stateid, err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_file_open_context",
          "args": [
            "fl->fl_file"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "fl",
            "list",
            "fl_list"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int nfs_delegation_claim_locks(struct nfs_open_context *ctx, struct nfs4_state *state, const nfs4_stateid *stateid)\n{\n\tstruct inode *inode = state->inode;\n\tstruct file_lock *fl;\n\tstruct file_lock_context *flctx = inode->i_flctx;\n\tstruct list_head *list;\n\tint status = 0;\n\n\tif (flctx == NULL)\n\t\tgoto out;\n\n\tlist = &flctx->flc_posix;\n\tspin_lock(&flctx->flc_lock);\nrestart:\n\tlist_for_each_entry(fl, list, fl_list) {\n\t\tif (nfs_file_open_context(fl->fl_file) != ctx)\n\t\t\tcontinue;\n\t\tspin_unlock(&flctx->flc_lock);\n\t\tstatus = nfs4_lock_delegation_recall(fl, state, stateid);\n\t\tif (status < 0)\n\t\t\tgoto out;\n\t\tspin_lock(&flctx->flc_lock);\n\t}\n\tif (list == &flctx->flc_posix) {\n\t\tlist = &flctx->flc_flock;\n\t\tgoto restart;\n\t}\n\tspin_unlock(&flctx->flc_lock);\nout:\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_check_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "79-82",
    "snippet": "int nfs4_check_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn nfs4_do_check_delegation(inode, flags, false);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_do_check_delegation",
          "args": [
            "inode",
            "flags",
            "false"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_do_check_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "44-61",
          "snippet": "static int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs4_check_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn nfs4_do_check_delegation(inode, flags, false);\n}"
  },
  {
    "function_name": "nfs4_have_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "70-73",
    "snippet": "int nfs4_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn nfs4_do_check_delegation(inode, flags, true);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_do_check_delegation",
          "args": [
            "inode",
            "flags",
            "true"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_do_check_delegation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "44-61",
          "snippet": "static int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nint nfs4_have_delegation(struct inode *inode, fmode_t flags)\n{\n\treturn nfs4_do_check_delegation(inode, flags, true);\n}"
  },
  {
    "function_name": "nfs4_do_check_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "44-61",
    "snippet": "static int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mark_delegation_referenced",
          "args": [
            "delegation"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mark_delegation_referenced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
          "lines": "39-42",
          "snippet": "void nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "NFS_DELEGATION_RETURNING",
            "&delegation->flags"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "NFS_I(inode)->delegation"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_I",
          "args": [
            "inode"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic int\nnfs4_do_check_delegation(struct inode *inode, fmode_t flags, bool mark)\n{\n\tstruct nfs_delegation *delegation;\n\tint ret = 0;\n\n\tflags &= FMODE_READ|FMODE_WRITE;\n\trcu_read_lock();\n\tdelegation = rcu_dereference(NFS_I(inode)->delegation);\n\tif (delegation != NULL && (delegation->type & flags) == flags &&\n\t    !test_bit(NFS_DELEGATION_RETURNING, &delegation->flags)) {\n\t\tif (mark)\n\t\t\tnfs_mark_delegation_referenced(delegation);\n\t\tret = 1;\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_mark_delegation_referenced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "39-42",
    "snippet": "void nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "NFS_DELEGATION_REFERENCED",
            "&delegation->flags"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nvoid nfs_mark_delegation_referenced(struct nfs_delegation *delegation)\n{\n\tset_bit(NFS_DELEGATION_REFERENCED, &delegation->flags);\n}"
  },
  {
    "function_name": "nfs_free_delegation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/delegation.c",
    "lines": "25-32",
    "snippet": "static void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"internal.h\"",
      "#include \"delegation.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree_rcu",
          "args": [
            "delegation",
            "rcu"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "delegation->cred"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/nfs_xdr.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/completion.h>\n\nstatic void nfs_free_delegation(struct nfs_delegation *delegation)\n{\n\tif (delegation->cred) {\n\t\tput_rpccred(delegation->cred);\n\t\tdelegation->cred = NULL;\n\t}\n\tkfree_rcu(delegation, rcu);\n}"
  }
]