[
  {
    "function_name": "ulist_add_merge_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.h",
    "lines": "62-73",
    "snippet": "static inline int ulist_add_merge_ptr(struct ulist *ulist, u64 val, void *aux,\n\t\t\t\t      void **old_aux, gfp_t gfp_mask)\n{\n#if BITS_PER_LONG == 32\n\tu64 old64 = (uintptr_t)*old_aux;\n\tint ret = ulist_add_merge(ulist, val, (uintptr_t)aux, &old64, gfp_mask);\n\t*old_aux = (void *)((uintptr_t)old64);\n\treturn ret;\n#else\n\treturn ulist_add_merge(ulist, val, (u64)aux, (u64 *)old_aux, gfp_mask);\n#endif\n}",
    "includes": [
      "#include <linux/rbtree.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ulist_add_merge",
          "args": [
            "ulist",
            "val",
            "(u64)aux",
            "(u64 *)old_aux",
            "gfp_mask"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_add_merge_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.h",
          "lines": "62-73",
          "snippet": "static inline int ulist_add_merge_ptr(struct ulist *ulist, u64 val, void *aux,\n\t\t\t\t      void **old_aux, gfp_t gfp_mask)\n{\n#if BITS_PER_LONG == 32\n\tu64 old64 = (uintptr_t)*old_aux;\n\tint ret = ulist_add_merge(ulist, val, (uintptr_t)aux, &old64, gfp_mask);\n\t*old_aux = (void *)((uintptr_t)old64);\n\treturn ret;\n#else\n\treturn ulist_add_merge(ulist, val, (u64)aux, (u64 *)old_aux, gfp_mask);\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rbtree.h>\n#include <linux/list.h>\n\nstatic inline int ulist_add_merge_ptr(struct ulist *ulist, u64 val, void *aux,\n\t\t\t\t      void **old_aux, gfp_t gfp_mask)\n{\n#if BITS_PER_LONG == 32\n\tu64 old64 = (uintptr_t)*old_aux;\n\tint ret = ulist_add_merge(ulist, val, (uintptr_t)aux, &old64, gfp_mask);\n\t*old_aux = (void *)((uintptr_t)old64);\n\treturn ret;\n#else\n\treturn ulist_add_merge(ulist, val, (u64)aux, (u64 *)old_aux, gfp_mask);\n#endif\n}"
  }
]