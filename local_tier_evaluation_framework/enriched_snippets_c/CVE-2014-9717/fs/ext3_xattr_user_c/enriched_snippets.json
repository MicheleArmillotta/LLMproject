[
  {
    "function_name": "ext3_xattr_user_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/xattr_user.c",
    "lines": "41-51",
    "snippet": "static int\next3_xattr_user_set(struct dentry *dentry, const char *name,\n\t\tconst void *value, size_t size, int flags, int type)\n{\n\tif (strcmp(name, \"\") == 0)\n\t\treturn -EINVAL;\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn -EOPNOTSUPP;\n\treturn ext3_xattr_set(dentry->d_inode, EXT3_XATTR_INDEX_USER,\n\t\t\t      name, value, size, flags);\n}",
    "includes": [
      "#include \"xattr.h\"",
      "#include \"ext3.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ext3_xattr_set",
          "args": [
            "dentry->d_inode",
            "EXT3_XATTR_INDEX_USER",
            "name",
            "value",
            "size",
            "flags"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "ext3_xattr_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/xattr.h",
          "lines": "88-93",
          "snippet": "static inline int\next3_xattr_set(struct inode *inode, int name_index, const char *name,\n\t       const void *value, size_t size, int flags)\n{\n\treturn -EOPNOTSUPP;\n}",
          "includes": [
            "#include <linux/xattr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/xattr.h>\n\nstatic inline int\next3_xattr_set(struct inode *inode, int name_index, const char *name,\n\t       const void *value, size_t size, int flags)\n{\n\treturn -EOPNOTSUPP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_opt",
          "args": [
            "dentry->d_sb",
            "XATTR_USER"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"\""
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xattr.h\"\n#include \"ext3.h\"\n\nstatic int\next3_xattr_user_set(struct dentry *dentry, const char *name,\n\t\tconst void *value, size_t size, int flags, int type)\n{\n\tif (strcmp(name, \"\") == 0)\n\t\treturn -EINVAL;\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn -EOPNOTSUPP;\n\treturn ext3_xattr_set(dentry->d_inode, EXT3_XATTR_INDEX_USER,\n\t\t\t      name, value, size, flags);\n}"
  },
  {
    "function_name": "ext3_xattr_user_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/xattr_user.c",
    "lines": "29-39",
    "snippet": "static int\next3_xattr_user_get(struct dentry *dentry, const char *name, void *buffer,\n\t\tsize_t size, int type)\n{\n\tif (strcmp(name, \"\") == 0)\n\t\treturn -EINVAL;\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn -EOPNOTSUPP;\n\treturn ext3_xattr_get(dentry->d_inode, EXT3_XATTR_INDEX_USER,\n\t\t\t      name, buffer, size);\n}",
    "includes": [
      "#include \"xattr.h\"",
      "#include \"ext3.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ext3_xattr_get",
          "args": [
            "dentry->d_inode",
            "EXT3_XATTR_INDEX_USER",
            "name",
            "buffer",
            "size"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "ext3_xattr_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/xattr.c",
          "lines": "313-327",
          "snippet": "int\next3_xattr_get(struct inode *inode, int name_index, const char *name,\n\t       void *buffer, size_t buffer_size)\n{\n\tint error;\n\n\tdown_read(&EXT3_I(inode)->xattr_sem);\n\terror = ext3_xattr_ibody_get(inode, name_index, name, buffer,\n\t\t\t\t     buffer_size);\n\tif (error == -ENODATA)\n\t\terror = ext3_xattr_block_get(inode, name_index, name, buffer,\n\t\t\t\t\t     buffer_size);\n\tup_read(&EXT3_I(inode)->xattr_sem);\n\treturn error;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include <linux/quotaops.h>",
            "#include <linux/mbcache.h>",
            "#include \"ext3.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int ext3_xattr_list(struct dentry *dentry, char *buffer,\n\t\t\t   size_t buffer_size);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include <linux/quotaops.h>\n#include <linux/mbcache.h>\n#include \"ext3.h\"\n\nstatic int ext3_xattr_list(struct dentry *dentry, char *buffer,\n\t\t\t   size_t buffer_size);\n\nint\next3_xattr_get(struct inode *inode, int name_index, const char *name,\n\t       void *buffer, size_t buffer_size)\n{\n\tint error;\n\n\tdown_read(&EXT3_I(inode)->xattr_sem);\n\terror = ext3_xattr_ibody_get(inode, name_index, name, buffer,\n\t\t\t\t     buffer_size);\n\tif (error == -ENODATA)\n\t\terror = ext3_xattr_block_get(inode, name_index, name, buffer,\n\t\t\t\t\t     buffer_size);\n\tup_read(&EXT3_I(inode)->xattr_sem);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_opt",
          "args": [
            "dentry->d_sb",
            "XATTR_USER"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"\""
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xattr.h\"\n#include \"ext3.h\"\n\nstatic int\next3_xattr_user_get(struct dentry *dentry, const char *name, void *buffer,\n\t\tsize_t size, int type)\n{\n\tif (strcmp(name, \"\") == 0)\n\t\treturn -EINVAL;\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn -EOPNOTSUPP;\n\treturn ext3_xattr_get(dentry->d_inode, EXT3_XATTR_INDEX_USER,\n\t\t\t      name, buffer, size);\n}"
  },
  {
    "function_name": "ext3_xattr_user_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext3/xattr_user.c",
    "lines": "11-27",
    "snippet": "static size_t\next3_xattr_user_list(struct dentry *dentry, char *list, size_t list_size,\n\t\tconst char *name, size_t name_len, int type)\n{\n\tconst size_t prefix_len = XATTR_USER_PREFIX_LEN;\n\tconst size_t total_len = prefix_len + name_len + 1;\n\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn 0;\n\n\tif (list && total_len <= list_size) {\n\t\tmemcpy(list, XATTR_USER_PREFIX, prefix_len);\n\t\tmemcpy(list+prefix_len, name, name_len);\n\t\tlist[prefix_len + name_len] = '\\0';\n\t}\n\treturn total_len;\n}",
    "includes": [
      "#include \"xattr.h\"",
      "#include \"ext3.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "list+prefix_len",
            "name",
            "name_len"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "list",
            "XATTR_USER_PREFIX",
            "prefix_len"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_opt",
          "args": [
            "dentry->d_sb",
            "XATTR_USER"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"xattr.h\"\n#include \"ext3.h\"\n\nstatic size_t\next3_xattr_user_list(struct dentry *dentry, char *list, size_t list_size,\n\t\tconst char *name, size_t name_len, int type)\n{\n\tconst size_t prefix_len = XATTR_USER_PREFIX_LEN;\n\tconst size_t total_len = prefix_len + name_len + 1;\n\n\tif (!test_opt(dentry->d_sb, XATTR_USER))\n\t\treturn 0;\n\n\tif (list && total_len <= list_size) {\n\t\tmemcpy(list, XATTR_USER_PREFIX, prefix_len);\n\t\tmemcpy(list+prefix_len, name, name_len);\n\t\tlist[prefix_len + name_len] = '\\0';\n\t}\n\treturn total_len;\n}"
  }
]