[
  {
    "function_name": "nfs4_ff_layout_ds_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "122-126",
    "snippet": "static inline int\nnfs4_ff_layout_ds_version(struct pnfs_layout_segment *lseg, u32 ds_idx)\n{\n\treturn FF_LAYOUT_COMP(lseg, ds_idx)->mirror_ds->ds_versions[0].version;\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FF_LAYOUT_COMP",
          "args": [
            "lseg",
            "ds_idx"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "FF_LAYOUT_COMP",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
          "lines": "102-108",
          "snippet": "static inline struct nfs4_ff_layout_mirror *\nFF_LAYOUT_COMP(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt)\n\t\treturn NULL;\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array[idx];\n}",
          "includes": [
            "#include \"../pnfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_mirror *\nFF_LAYOUT_COMP(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt)\n\t\treturn NULL;\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array[idx];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline int\nnfs4_ff_layout_ds_version(struct pnfs_layout_segment *lseg, u32 ds_idx)\n{\n\treturn FF_LAYOUT_COMP(lseg, ds_idx)->mirror_ds->ds_versions[0].version;\n}"
  },
  {
    "function_name": "ff_layout_test_devid_unavailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "116-120",
    "snippet": "static inline bool\nff_layout_test_devid_unavailable(struct nfs4_deviceid_node *node)\n{\n\treturn nfs4_test_deviceid_unavailable(node);\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_test_deviceid_unavailable",
          "args": [
            "node"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_test_deviceid_unavailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/pnfs_dev.c",
          "lines": "289-302",
          "snippet": "bool\nnfs4_test_deviceid_unavailable(struct nfs4_deviceid_node *node)\n{\n\tif (test_bit(NFS_DEVICEID_UNAVAILABLE, &node->flags)) {\n\t\tunsigned long start, end;\n\n\t\tend = jiffies;\n\t\tstart = end - PNFS_DEVICE_RETRY_TIMEOUT;\n\t\tif (time_in_range(node->timestamp_unavailable, start, end))\n\t\t\treturn true;\n\t\tclear_bit(NFS_DEVICEID_UNAVAILABLE, &node->flags);\n\t}\n\treturn false;\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4session.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define PNFS_DEVICE_RETRY_TIMEOUT (120*HZ)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"internal.h\"\n#include \"nfs4session.h\"\n#include <linux/nfs_fs.h>\n#include <linux/export.h>\n\n#define PNFS_DEVICE_RETRY_TIMEOUT (120*HZ)\n\nbool\nnfs4_test_deviceid_unavailable(struct nfs4_deviceid_node *node)\n{\n\tif (test_bit(NFS_DEVICEID_UNAVAILABLE, &node->flags)) {\n\t\tunsigned long start, end;\n\n\t\tend = jiffies;\n\t\tstart = end - PNFS_DEVICE_RETRY_TIMEOUT;\n\t\tif (time_in_range(node->timestamp_unavailable, start, end))\n\t\t\treturn true;\n\t\tclear_bit(NFS_DEVICEID_UNAVAILABLE, &node->flags);\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline bool\nff_layout_test_devid_unavailable(struct nfs4_deviceid_node *node)\n{\n\treturn nfs4_test_deviceid_unavailable(node);\n}"
  },
  {
    "function_name": "FF_LAYOUT_MIRROR_COUNT",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "110-114",
    "snippet": "static inline u32\nFF_LAYOUT_MIRROR_COUNT(struct pnfs_layout_segment *lseg)\n{\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array_cnt;\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FF_LAYOUT_LSEG",
          "args": [
            "lseg"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "FF_LAYOUT_LSEG",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
          "lines": "78-84",
          "snippet": "static inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}",
          "includes": [
            "#include \"../pnfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline u32\nFF_LAYOUT_MIRROR_COUNT(struct pnfs_layout_segment *lseg)\n{\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array_cnt;\n}"
  },
  {
    "function_name": "FF_LAYOUT_COMP",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "102-108",
    "snippet": "static inline struct nfs4_ff_layout_mirror *\nFF_LAYOUT_COMP(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt)\n\t\treturn NULL;\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array[idx];\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FF_LAYOUT_LSEG",
          "args": [
            "lseg"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "FF_LAYOUT_LSEG",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
          "lines": "78-84",
          "snippet": "static inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}",
          "includes": [
            "#include \"../pnfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_mirror *\nFF_LAYOUT_COMP(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt)\n\t\treturn NULL;\n\treturn FF_LAYOUT_LSEG(lseg)->mirror_array[idx];\n}"
  },
  {
    "function_name": "FF_LAYOUT_MIRROR_DS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "96-100",
    "snippet": "static inline struct nfs4_ff_layout_ds *\nFF_LAYOUT_MIRROR_DS(struct nfs4_deviceid_node *node)\n{\n\treturn container_of(node, struct nfs4_ff_layout_ds, id_node);\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "node",
            "structnfs4_ff_layout_ds",
            "id_node"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_ds *\nFF_LAYOUT_MIRROR_DS(struct nfs4_deviceid_node *node)\n{\n\treturn container_of(node, struct nfs4_ff_layout_ds, id_node);\n}"
  },
  {
    "function_name": "FF_LAYOUT_DEVID_NODE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "86-94",
    "snippet": "static inline struct nfs4_deviceid_node *\nFF_LAYOUT_DEVID_NODE(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt ||\n\t    FF_LAYOUT_LSEG(lseg)->mirror_array[idx] == NULL ||\n\t    FF_LAYOUT_LSEG(lseg)->mirror_array[idx]->mirror_ds == NULL)\n\t\treturn NULL;\n\treturn &FF_LAYOUT_LSEG(lseg)->mirror_array[idx]->mirror_ds->id_node;\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FF_LAYOUT_LSEG",
          "args": [
            "lseg"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "FF_LAYOUT_LSEG",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
          "lines": "78-84",
          "snippet": "static inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}",
          "includes": [
            "#include \"../pnfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_deviceid_node *\nFF_LAYOUT_DEVID_NODE(struct pnfs_layout_segment *lseg, u32 idx)\n{\n\tif (idx >= FF_LAYOUT_LSEG(lseg)->mirror_array_cnt ||\n\t    FF_LAYOUT_LSEG(lseg)->mirror_array[idx] == NULL ||\n\t    FF_LAYOUT_LSEG(lseg)->mirror_array[idx]->mirror_ds == NULL)\n\t\treturn NULL;\n\treturn &FF_LAYOUT_LSEG(lseg)->mirror_array[idx]->mirror_ds->id_node;\n}"
  },
  {
    "function_name": "FF_LAYOUT_LSEG",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "78-84",
    "snippet": "static inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "lseg",
            "structnfs4_ff_layout_segment",
            "generic_hdr"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_ff_layout_segment *\nFF_LAYOUT_LSEG(struct pnfs_layout_segment *lseg)\n{\n\treturn container_of(lseg,\n\t\t\t    struct nfs4_ff_layout_segment,\n\t\t\t    generic_hdr);\n}"
  },
  {
    "function_name": "FF_LAYOUT_FROM_HDR",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/flexfilelayout/flexfilelayout.h",
    "lines": "72-76",
    "snippet": "static inline struct nfs4_flexfile_layout *\nFF_LAYOUT_FROM_HDR(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct nfs4_flexfile_layout, generic_hdr);\n}",
    "includes": [
      "#include \"../pnfs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "lo",
            "structnfs4_flexfile_layout",
            "generic_hdr"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../pnfs.h\"\n\nstatic inline struct nfs4_flexfile_layout *\nFF_LAYOUT_FROM_HDR(struct pnfs_layout_hdr *lo)\n{\n\treturn container_of(lo, struct nfs4_flexfile_layout, generic_hdr);\n}"
  }
]