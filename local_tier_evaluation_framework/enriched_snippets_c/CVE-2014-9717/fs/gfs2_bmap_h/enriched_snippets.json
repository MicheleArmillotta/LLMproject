[
  {
    "function_name": "gfs2_write_calc_reserv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/bmap.h",
    "lines": "29-45",
    "snippet": "static inline void gfs2_write_calc_reserv(const struct gfs2_inode *ip,\n\t\t\t\t\t  unsigned int len,\n\t\t\t\t\t  unsigned int *data_blocks,\n\t\t\t\t\t  unsigned int *ind_blocks)\n{\n\tconst struct gfs2_sbd *sdp = GFS2_SB(&ip->i_inode);\n\tunsigned int tmp;\n\n\tBUG_ON(gfs2_is_dir(ip));\n\t*data_blocks = (len >> sdp->sd_sb.sb_bsize_shift) + 3;\n\t*ind_blocks = 3 * (sdp->sd_max_height - 1);\n\n\tfor (tmp = *data_blocks; tmp > sdp->sd_diptrs;) {\n\t\ttmp = DIV_ROUND_UP(tmp, sdp->sd_inptrs);\n\t\t*ind_blocks += tmp;\n\t}\n}",
    "includes": [
      "#include \"inode.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "tmp",
            "sdp->sd_inptrs"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "gfs2_is_dir(ip)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_is_dir",
          "args": [
            "ip"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_is_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.h",
          "lines": "45-48",
          "snippet": "static inline int gfs2_is_dir(const struct gfs2_inode *ip)\n{\n\treturn S_ISDIR(ip->i_inode.i_mode);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int gfs2_is_dir(const struct gfs2_inode *ip)\n{\n\treturn S_ISDIR(ip->i_inode.i_mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_SB",
          "args": [
            "&ip->i_inode"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "413-416",
          "snippet": "static inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_sbd *GFS2_SB(const struct inode *inode)\n{\n\treturn inode->i_sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"inode.h\"\n\nstatic inline void gfs2_write_calc_reserv(const struct gfs2_inode *ip,\n\t\t\t\t\t  unsigned int len,\n\t\t\t\t\t  unsigned int *data_blocks,\n\t\t\t\t\t  unsigned int *ind_blocks)\n{\n\tconst struct gfs2_sbd *sdp = GFS2_SB(&ip->i_inode);\n\tunsigned int tmp;\n\n\tBUG_ON(gfs2_is_dir(ip));\n\t*data_blocks = (len >> sdp->sd_sb.sb_bsize_shift) + 3;\n\t*ind_blocks = 3 * (sdp->sd_max_height - 1);\n\n\tfor (tmp = *data_blocks; tmp > sdp->sd_diptrs;) {\n\t\ttmp = DIV_ROUND_UP(tmp, sdp->sd_inptrs);\n\t\t*ind_blocks += tmp;\n\t}\n}"
  }
]