[
  {
    "function_name": "nilfs_direct_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "365-369",
    "snippet": "int nilfs_direct_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_direct_ops;\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct nilfs_bmap_operations nilfs_direct_ops = {\n\t.bop_lookup\t\t=\tnilfs_direct_lookup,\n\t.bop_lookup_contig\t=\tnilfs_direct_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_direct_insert,\n\t.bop_delete\t\t=\tnilfs_direct_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_direct_propagate,\n\n\t.bop_lookup_dirty_buffers\t=\tNULL,\n\n\t.bop_assign\t\t=\tnilfs_direct_assign,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tnilfs_direct_last_key,\n\t.bop_check_insert\t=\tnilfs_direct_check_insert,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tnilfs_direct_gather_data,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic const struct nilfs_bmap_operations nilfs_direct_ops = {\n\t.bop_lookup\t\t=\tnilfs_direct_lookup,\n\t.bop_lookup_contig\t=\tnilfs_direct_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_direct_insert,\n\t.bop_delete\t\t=\tnilfs_direct_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_direct_propagate,\n\n\t.bop_lookup_dirty_buffers\t=\tNULL,\n\n\t.bop_assign\t\t=\tnilfs_direct_assign,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tnilfs_direct_last_key,\n\t.bop_check_insert\t=\tnilfs_direct_check_insert,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tnilfs_direct_gather_data,\n};\n\nint nilfs_direct_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_direct_ops;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_direct_assign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "318-342",
    "snippet": "static int nilfs_direct_assign(struct nilfs_bmap *bmap,\n\t\t\t       struct buffer_head **bh,\n\t\t\t       sector_t blocknr,\n\t\t\t       union nilfs_binfo *binfo)\n{\n\t__u64 key;\n\t__u64 ptr;\n\n\tkey = nilfs_bmap_data_get_key(bmap, *bh);\n\tif (unlikely(key > NILFS_DIRECT_KEY_MAX)) {\n\t\tprintk(KERN_CRIT \"%s: invalid key: %llu\\n\", __func__,\n\t\t       (unsigned long long)key);\n\t\treturn -EINVAL;\n\t}\n\tptr = nilfs_direct_get_ptr(bmap, key);\n\tif (unlikely(ptr == NILFS_BMAP_INVALID_PTR)) {\n\t\tprintk(KERN_CRIT \"%s: invalid pointer: %llu\\n\", __func__,\n\t\t       (unsigned long long)ptr);\n\t\treturn -EINVAL;\n\t}\n\n\treturn NILFS_BMAP_USE_VBN(bmap) ?\n\t\tnilfs_direct_assign_v(bmap, key, ptr, bh, blocknr, binfo) :\n\t\tnilfs_direct_assign_p(bmap, key, ptr, bh, blocknr, binfo);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_direct_assign_p",
          "args": [
            "bmap",
            "key",
            "ptr",
            "bh",
            "blocknr",
            "binfo"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_assign_p",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "304-316",
          "snippet": "static int nilfs_direct_assign_p(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tnilfs_direct_set_ptr(direct, key, blocknr);\n\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_assign_p(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tnilfs_direct_set_ptr(direct, key, blocknr);\n\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_assign_v",
          "args": [
            "bmap",
            "key",
            "ptr",
            "bh",
            "blocknr",
            "binfo"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_assign_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "284-302",
          "snippet": "static int nilfs_direct_assign_v(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(direct);\n\tunion nilfs_bmap_ptr_req req;\n\tint ret;\n\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (!ret) {\n\t\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\t\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\t\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_assign_v(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(direct);\n\tunion nilfs_bmap_ptr_req req;\n\tint ret;\n\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (!ret) {\n\t\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\t\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\t\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "bmap"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"%s: invalid pointer: %llu\\n\"",
            "__func__",
            "(unsigned long long)ptr"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ptr == NILFS_BMAP_INVALID_PTR"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "bmap",
            "key"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "key > NILFS_DIRECT_KEY_MAX"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_data_get_key",
          "args": [
            "bmap",
            "*bh"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_data_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "429-441",
          "snippet": "__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_assign(struct nilfs_bmap *bmap,\n\t\t\t       struct buffer_head **bh,\n\t\t\t       sector_t blocknr,\n\t\t\t       union nilfs_binfo *binfo)\n{\n\t__u64 key;\n\t__u64 ptr;\n\n\tkey = nilfs_bmap_data_get_key(bmap, *bh);\n\tif (unlikely(key > NILFS_DIRECT_KEY_MAX)) {\n\t\tprintk(KERN_CRIT \"%s: invalid key: %llu\\n\", __func__,\n\t\t       (unsigned long long)key);\n\t\treturn -EINVAL;\n\t}\n\tptr = nilfs_direct_get_ptr(bmap, key);\n\tif (unlikely(ptr == NILFS_BMAP_INVALID_PTR)) {\n\t\tprintk(KERN_CRIT \"%s: invalid pointer: %llu\\n\", __func__,\n\t\t       (unsigned long long)ptr);\n\t\treturn -EINVAL;\n\t}\n\n\treturn NILFS_BMAP_USE_VBN(bmap) ?\n\t\tnilfs_direct_assign_v(bmap, key, ptr, bh, blocknr, binfo) :\n\t\tnilfs_direct_assign_p(bmap, key, ptr, bh, blocknr, binfo);\n}"
  },
  {
    "function_name": "nilfs_direct_assign_p",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "304-316",
    "snippet": "static int nilfs_direct_assign_p(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tnilfs_direct_set_ptr(direct, key, blocknr);\n\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = 0;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_set_ptr",
          "args": [
            "direct",
            "key",
            "blocknr"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "42-46",
          "snippet": "static inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_assign_p(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tnilfs_direct_set_ptr(direct, key, blocknr);\n\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = 0;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_direct_assign_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "284-302",
    "snippet": "static int nilfs_direct_assign_v(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(direct);\n\tunion nilfs_bmap_ptr_req req;\n\tint ret;\n\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (!ret) {\n\t\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\t\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\t\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptr"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_start",
          "args": [
            "dat",
            "&req.bpr_req",
            "blocknr"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "139-153",
          "snippet": "void nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_start",
          "args": [
            "dat",
            "&req.bpr_req"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "130-137",
          "snippet": "int nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "direct"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_assign_v(struct nilfs_bmap *direct,\n\t\t\t\t __u64 key, __u64 ptr,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(direct);\n\tunion nilfs_bmap_ptr_req req;\n\tint ret;\n\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (!ret) {\n\t\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\t\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\t\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_direct_propagate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "253-282",
    "snippet": "static int nilfs_direct_propagate(struct nilfs_bmap *bmap,\n\t\t\t\t  struct buffer_head *bh)\n{\n\tstruct nilfs_palloc_req oldreq, newreq;\n\tstruct inode *dat;\n\t__u64 key;\n\t__u64 ptr;\n\tint ret;\n\n\tif (!NILFS_BMAP_USE_VBN(bmap))\n\t\treturn 0;\n\n\tdat = nilfs_bmap_get_dat(bmap);\n\tkey = nilfs_bmap_data_get_key(bmap, bh);\n\tptr = nilfs_direct_get_ptr(bmap, key);\n\tif (!buffer_nilfs_volatile(bh)) {\n\t\toldreq.pr_entry_nr = ptr;\n\t\tnewreq.pr_entry_nr = ptr;\n\t\tret = nilfs_dat_prepare_update(dat, &oldreq, &newreq);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_dat_commit_update(dat, &oldreq, &newreq,\n\t\t\t\t\tbmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n\t\tset_buffer_nilfs_volatile(bh);\n\t\tnilfs_direct_set_ptr(bmap, key, newreq.pr_entry_nr);\n\t} else\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_mark_dirty",
          "args": [
            "dat",
            "ptr"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "277-287",
          "snippet": "int nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_set_ptr",
          "args": [
            "bmap",
            "key",
            "newreq.pr_entry_nr"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "42-46",
          "snippet": "static inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "bh"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_update",
          "args": [
            "dat",
            "&oldreq",
            "&newreq",
            "bmap->b_ptr_type == NILFS_BMAP_PTR_VS"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "247-253",
          "snippet": "void nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_update",
          "args": [
            "dat",
            "&oldreq",
            "&newreq"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "232-245",
          "snippet": "int nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "bh"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "bmap",
            "key"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_data_get_key",
          "args": [
            "bmap",
            "bh"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_data_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "429-441",
          "snippet": "__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "bmap"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "bmap"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_propagate(struct nilfs_bmap *bmap,\n\t\t\t\t  struct buffer_head *bh)\n{\n\tstruct nilfs_palloc_req oldreq, newreq;\n\tstruct inode *dat;\n\t__u64 key;\n\t__u64 ptr;\n\tint ret;\n\n\tif (!NILFS_BMAP_USE_VBN(bmap))\n\t\treturn 0;\n\n\tdat = nilfs_bmap_get_dat(bmap);\n\tkey = nilfs_bmap_data_get_key(bmap, bh);\n\tptr = nilfs_direct_get_ptr(bmap, key);\n\tif (!buffer_nilfs_volatile(bh)) {\n\t\toldreq.pr_entry_nr = ptr;\n\t\tnewreq.pr_entry_nr = ptr;\n\t\tret = nilfs_dat_prepare_update(dat, &oldreq, &newreq);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_dat_commit_update(dat, &oldreq, &newreq,\n\t\t\t\t\tbmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n\t\tset_buffer_nilfs_volatile(bh);\n\t\tnilfs_direct_set_ptr(bmap, key, newreq.pr_entry_nr);\n\t} else\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_direct_delete_and_convert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "220-251",
    "snippet": "int nilfs_direct_delete_and_convert(struct nilfs_bmap *bmap,\n\t\t\t\t    __u64 key, __u64 *keys, __u64 *ptrs, int n)\n{\n\t__le64 *dptrs;\n\tint ret, i, j;\n\n\t/* no need to allocate any resource for conversion */\n\n\t/* delete */\n\tret = bmap->b_ops->bop_delete(bmap, key);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/* free resources */\n\tif (bmap->b_ops->bop_clear != NULL)\n\t\tbmap->b_ops->bop_clear(bmap);\n\n\t/* convert */\n\tdptrs = nilfs_direct_dptrs(bmap);\n\tfor (i = 0, j = 0; i < NILFS_DIRECT_NBLOCKS; i++) {\n\t\tif ((j < n) && (i == keys[j])) {\n\t\t\tdptrs[i] = (i != key) ?\n\t\t\t\tcpu_to_le64(ptrs[j]) :\n\t\t\t\tNILFS_BMAP_INVALID_PTR;\n\t\t\tj++;\n\t\t} else\n\t\t\tdptrs[i] = NILFS_BMAP_INVALID_PTR;\n\t}\n\n\tnilfs_direct_init(bmap);\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_direct_init",
          "args": [
            "bmap"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "365-369",
          "snippet": "int nilfs_direct_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_direct_ops;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct nilfs_bmap_operations nilfs_direct_ops = {\n\t.bop_lookup\t\t=\tnilfs_direct_lookup,\n\t.bop_lookup_contig\t=\tnilfs_direct_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_direct_insert,\n\t.bop_delete\t\t=\tnilfs_direct_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_direct_propagate,\n\n\t.bop_lookup_dirty_buffers\t=\tNULL,\n\n\t.bop_assign\t\t=\tnilfs_direct_assign,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tnilfs_direct_last_key,\n\t.bop_check_insert\t=\tnilfs_direct_check_insert,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tnilfs_direct_gather_data,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic const struct nilfs_bmap_operations nilfs_direct_ops = {\n\t.bop_lookup\t\t=\tnilfs_direct_lookup,\n\t.bop_lookup_contig\t=\tnilfs_direct_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_direct_insert,\n\t.bop_delete\t\t=\tnilfs_direct_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_direct_propagate,\n\n\t.bop_lookup_dirty_buffers\t=\tNULL,\n\n\t.bop_assign\t\t=\tnilfs_direct_assign,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tnilfs_direct_last_key,\n\t.bop_check_insert\t=\tnilfs_direct_check_insert,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tnilfs_direct_gather_data,\n};\n\nint nilfs_direct_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_direct_ops;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptrs[j]"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_dptrs",
          "args": [
            "bmap"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "30-34",
          "snippet": "static inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bmap->b_ops->bop_clear",
          "args": [
            "bmap"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bmap->b_ops->bop_delete",
          "args": [
            "bmap",
            "key"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nint nilfs_direct_delete_and_convert(struct nilfs_bmap *bmap,\n\t\t\t\t    __u64 key, __u64 *keys, __u64 *ptrs, int n)\n{\n\t__le64 *dptrs;\n\tint ret, i, j;\n\n\t/* no need to allocate any resource for conversion */\n\n\t/* delete */\n\tret = bmap->b_ops->bop_delete(bmap, key);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/* free resources */\n\tif (bmap->b_ops->bop_clear != NULL)\n\t\tbmap->b_ops->bop_clear(bmap);\n\n\t/* convert */\n\tdptrs = nilfs_direct_dptrs(bmap);\n\tfor (i = 0, j = 0; i < NILFS_DIRECT_NBLOCKS; i++) {\n\t\tif ((j < n) && (i == keys[j])) {\n\t\t\tdptrs[i] = (i != key) ?\n\t\t\t\tcpu_to_le64(ptrs[j]) :\n\t\t\t\tNILFS_BMAP_INVALID_PTR;\n\t\t\tj++;\n\t\t} else\n\t\t\tdptrs[i] = NILFS_BMAP_INVALID_PTR;\n\t}\n\n\tnilfs_direct_init(bmap);\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_direct_gather_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "199-218",
    "snippet": "static int nilfs_direct_gather_data(struct nilfs_bmap *direct,\n\t\t\t\t    __u64 *keys, __u64 *ptrs, int nitems)\n{\n\t__u64 key;\n\t__u64 ptr;\n\tint n;\n\n\tif (nitems > NILFS_DIRECT_NBLOCKS)\n\t\tnitems = NILFS_DIRECT_NBLOCKS;\n\tn = 0;\n\tfor (key = 0; key < nitems; key++) {\n\t\tptr = nilfs_direct_get_ptr(direct, key);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR) {\n\t\t\tkeys[n] = key;\n\t\t\tptrs[n] = ptr;\n\t\t\tn++;\n\t\t}\n\t}\n\treturn n;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "direct",
            "key"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_gather_data(struct nilfs_bmap *direct,\n\t\t\t\t    __u64 *keys, __u64 *ptrs, int nitems)\n{\n\t__u64 key;\n\t__u64 ptr;\n\tint n;\n\n\tif (nitems > NILFS_DIRECT_NBLOCKS)\n\t\tnitems = NILFS_DIRECT_NBLOCKS;\n\tn = 0;\n\tfor (key = 0; key < nitems; key++) {\n\t\tptr = nilfs_direct_get_ptr(direct, key);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR) {\n\t\t\tkeys[n] = key;\n\t\t\tptrs[n] = ptr;\n\t\t\tn++;\n\t\t}\n\t}\n\treturn n;\n}"
  },
  {
    "function_name": "nilfs_direct_check_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "194-197",
    "snippet": "static int nilfs_direct_check_insert(const struct nilfs_bmap *bmap, __u64 key)\n{\n\treturn key > NILFS_DIRECT_KEY_MAX;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_check_insert(const struct nilfs_bmap *bmap, __u64 key)\n{\n\treturn key > NILFS_DIRECT_KEY_MAX;\n}"
  },
  {
    "function_name": "nilfs_direct_last_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "176-192",
    "snippet": "static int nilfs_direct_last_key(const struct nilfs_bmap *direct, __u64 *keyp)\n{\n\t__u64 key, lastkey;\n\n\tlastkey = NILFS_DIRECT_KEY_MAX + 1;\n\tfor (key = NILFS_DIRECT_KEY_MIN; key <= NILFS_DIRECT_KEY_MAX; key++)\n\t\tif (nilfs_direct_get_ptr(direct, key) !=\n\t\t    NILFS_BMAP_INVALID_PTR)\n\t\t\tlastkey = key;\n\n\tif (lastkey == NILFS_DIRECT_KEY_MAX + 1)\n\t\treturn -ENOENT;\n\n\t*keyp = lastkey;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "direct",
            "key"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_last_key(const struct nilfs_bmap *direct, __u64 *keyp)\n{\n\t__u64 key, lastkey;\n\n\tlastkey = NILFS_DIRECT_KEY_MAX + 1;\n\tfor (key = NILFS_DIRECT_KEY_MIN; key <= NILFS_DIRECT_KEY_MAX; key++)\n\t\tif (nilfs_direct_get_ptr(direct, key) !=\n\t\t    NILFS_BMAP_INVALID_PTR)\n\t\t\tlastkey = key;\n\n\tif (lastkey == NILFS_DIRECT_KEY_MAX + 1)\n\t\treturn -ENOENT;\n\n\t*keyp = lastkey;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_direct_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "154-174",
    "snippet": "static int nilfs_direct_delete(struct nilfs_bmap *bmap, __u64 key)\n{\n\tunion nilfs_bmap_ptr_req req;\n\tstruct inode *dat;\n\tint ret;\n\n\tif (key > NILFS_DIRECT_KEY_MAX ||\n\t    nilfs_direct_get_ptr(bmap, key) == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\tdat = NILFS_BMAP_USE_VBN(bmap) ? nilfs_bmap_get_dat(bmap) : NULL;\n\treq.bpr_ptr = nilfs_direct_get_ptr(bmap, key);\n\n\tret = nilfs_bmap_prepare_end_ptr(bmap, &req, dat);\n\tif (!ret) {\n\t\tnilfs_bmap_commit_end_ptr(bmap, &req, dat);\n\t\tnilfs_direct_set_ptr(bmap, key, NILFS_BMAP_INVALID_PTR);\n\t\tnilfs_inode_sub_blocks(bmap->b_inode, 1);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_inode_sub_blocks",
          "args": [
            "bmap->b_inode",
            "1"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_inode_sub_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "63-70",
          "snippet": "void nilfs_inode_sub_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_sub_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_sub(n, &root->blocks_count);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_inode_sub_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_sub_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_sub(n, &root->blocks_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_set_ptr",
          "args": [
            "bmap",
            "key",
            "NILFS_BMAP_INVALID_PTR"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "42-46",
          "snippet": "static inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_commit_end_ptr",
          "args": [
            "bmap",
            "&req",
            "dat"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_commit_end_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "220-227",
          "snippet": "static inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */\n\nstatic inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_prepare_end_ptr",
          "args": [
            "bmap",
            "&req",
            "dat"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_prepare_end_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "213-218",
          "snippet": "static inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "bmap",
            "key"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "bmap"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "bmap"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_delete(struct nilfs_bmap *bmap, __u64 key)\n{\n\tunion nilfs_bmap_ptr_req req;\n\tstruct inode *dat;\n\tint ret;\n\n\tif (key > NILFS_DIRECT_KEY_MAX ||\n\t    nilfs_direct_get_ptr(bmap, key) == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\tdat = NILFS_BMAP_USE_VBN(bmap) ? nilfs_bmap_get_dat(bmap) : NULL;\n\treq.bpr_ptr = nilfs_direct_get_ptr(bmap, key);\n\n\tret = nilfs_bmap_prepare_end_ptr(bmap, &req, dat);\n\tif (!ret) {\n\t\tnilfs_bmap_commit_end_ptr(bmap, &req, dat);\n\t\tnilfs_direct_set_ptr(bmap, key, NILFS_BMAP_INVALID_PTR);\n\t\tnilfs_inode_sub_blocks(bmap->b_inode, 1);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_direct_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "118-152",
    "snippet": "static int nilfs_direct_insert(struct nilfs_bmap *bmap, __u64 key, __u64 ptr)\n{\n\tunion nilfs_bmap_ptr_req req;\n\tstruct inode *dat = NULL;\n\tstruct buffer_head *bh;\n\tint ret;\n\n\tif (key > NILFS_DIRECT_KEY_MAX)\n\t\treturn -ENOENT;\n\tif (nilfs_direct_get_ptr(bmap, key) != NILFS_BMAP_INVALID_PTR)\n\t\treturn -EEXIST;\n\n\tif (NILFS_BMAP_USE_VBN(bmap)) {\n\t\treq.bpr_ptr = nilfs_direct_find_target_v(bmap, key);\n\t\tdat = nilfs_bmap_get_dat(bmap);\n\t}\n\tret = nilfs_bmap_prepare_alloc_ptr(bmap, &req, dat);\n\tif (!ret) {\n\t\t/* ptr must be a pointer to a buffer head. */\n\t\tbh = (struct buffer_head *)((unsigned long)ptr);\n\t\tset_buffer_nilfs_volatile(bh);\n\n\t\tnilfs_bmap_commit_alloc_ptr(bmap, &req, dat);\n\t\tnilfs_direct_set_ptr(bmap, key, req.bpr_ptr);\n\n\t\tif (!nilfs_bmap_dirty(bmap))\n\t\t\tnilfs_bmap_set_dirty(bmap);\n\n\t\tif (NILFS_BMAP_USE_VBN(bmap))\n\t\t\tnilfs_bmap_set_target_v(bmap, key, req.bpr_ptr);\n\n\t\tnilfs_inode_add_blocks(bmap->b_inode, 1);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_inode_add_blocks",
          "args": [
            "bmap->b_inode",
            "1"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_inode_add_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "54-61",
          "snippet": "void nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_set_target_v",
          "args": [
            "bmap",
            "key",
            "req.bpr_ptr"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "237-242",
          "snippet": "static inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "bmap"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_set_dirty",
          "args": [
            "bmap"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "258-261",
          "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_dirty",
          "args": [
            "bmap"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "252-255",
          "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_set_ptr",
          "args": [
            "bmap",
            "key",
            "req.bpr_ptr"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "42-46",
          "snippet": "static inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_commit_alloc_ptr",
          "args": [
            "bmap",
            "&req",
            "dat"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_commit_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "195-201",
          "snippet": "static inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "bh"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_prepare_alloc_ptr",
          "args": [
            "bmap",
            "&req",
            "dat"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_prepare_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "184-193",
          "snippet": "static inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "bmap"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_find_target_v",
          "args": [
            "bmap",
            "key"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_find_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "104-116",
          "snippet": "static __u64\nnilfs_direct_find_target_v(const struct nilfs_bmap *direct, __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(direct, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse\n\t\t/* block group */\n\t\treturn nilfs_bmap_find_target_in_group(direct);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic __u64\nnilfs_direct_find_target_v(const struct nilfs_bmap *direct, __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(direct, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse\n\t\t/* block group */\n\t\treturn nilfs_bmap_find_target_in_group(direct);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "bmap"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "bmap",
            "key"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_insert(struct nilfs_bmap *bmap, __u64 key, __u64 ptr)\n{\n\tunion nilfs_bmap_ptr_req req;\n\tstruct inode *dat = NULL;\n\tstruct buffer_head *bh;\n\tint ret;\n\n\tif (key > NILFS_DIRECT_KEY_MAX)\n\t\treturn -ENOENT;\n\tif (nilfs_direct_get_ptr(bmap, key) != NILFS_BMAP_INVALID_PTR)\n\t\treturn -EEXIST;\n\n\tif (NILFS_BMAP_USE_VBN(bmap)) {\n\t\treq.bpr_ptr = nilfs_direct_find_target_v(bmap, key);\n\t\tdat = nilfs_bmap_get_dat(bmap);\n\t}\n\tret = nilfs_bmap_prepare_alloc_ptr(bmap, &req, dat);\n\tif (!ret) {\n\t\t/* ptr must be a pointer to a buffer head. */\n\t\tbh = (struct buffer_head *)((unsigned long)ptr);\n\t\tset_buffer_nilfs_volatile(bh);\n\n\t\tnilfs_bmap_commit_alloc_ptr(bmap, &req, dat);\n\t\tnilfs_direct_set_ptr(bmap, key, req.bpr_ptr);\n\n\t\tif (!nilfs_bmap_dirty(bmap))\n\t\t\tnilfs_bmap_set_dirty(bmap);\n\n\t\tif (NILFS_BMAP_USE_VBN(bmap))\n\t\t\tnilfs_bmap_set_target_v(bmap, key, req.bpr_ptr);\n\n\t\tnilfs_inode_add_blocks(bmap->b_inode, 1);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_direct_find_target_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "104-116",
    "snippet": "static __u64\nnilfs_direct_find_target_v(const struct nilfs_bmap *direct, __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(direct, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse\n\t\t/* block group */\n\t\treturn nilfs_bmap_find_target_in_group(direct);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_find_target_in_group",
          "args": [
            "direct"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_find_target_in_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "457-466",
          "snippet": "__u64 nilfs_bmap_find_target_in_group(const struct nilfs_bmap *bmap)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(bmap);\n\tunsigned long entries_per_group = nilfs_palloc_entries_per_group(dat);\n\tunsigned long group = bmap->b_inode->i_ino / entries_per_group;\n\n\treturn group * entries_per_group +\n\t\t(bmap->b_inode->i_ino % NILFS_BMAP_GROUP_DIV) *\n\t\t(entries_per_group / NILFS_BMAP_GROUP_DIV);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_GROUP_DIV\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n#define NILFS_BMAP_GROUP_DIV\t8\n\n__u64 nilfs_bmap_find_target_in_group(const struct nilfs_bmap *bmap)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(bmap);\n\tunsigned long entries_per_group = nilfs_palloc_entries_per_group(dat);\n\tunsigned long group = bmap->b_inode->i_ino / entries_per_group;\n\n\treturn group * entries_per_group +\n\t\t(bmap->b_inode->i_ino % NILFS_BMAP_GROUP_DIV) *\n\t\t(entries_per_group / NILFS_BMAP_GROUP_DIV);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_find_target_seq",
          "args": [
            "direct",
            "key"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_find_target_seq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "443-454",
          "snippet": "__u64 nilfs_bmap_find_target_seq(const struct nilfs_bmap *bmap, __u64 key)\n{\n\t__s64 diff;\n\n\tdiff = key - bmap->b_last_allocated_key;\n\tif ((nilfs_bmap_keydiff_abs(diff) < NILFS_INODE_BMAP_SIZE) &&\n\t    (bmap->b_last_allocated_ptr != NILFS_BMAP_INVALID_PTR) &&\n\t    (bmap->b_last_allocated_ptr + diff > 0))\n\t\treturn bmap->b_last_allocated_ptr + diff;\n\telse\n\t\treturn NILFS_BMAP_INVALID_PTR;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_find_target_seq(const struct nilfs_bmap *bmap, __u64 key)\n{\n\t__s64 diff;\n\n\tdiff = key - bmap->b_last_allocated_key;\n\tif ((nilfs_bmap_keydiff_abs(diff) < NILFS_INODE_BMAP_SIZE) &&\n\t    (bmap->b_last_allocated_ptr != NILFS_BMAP_INVALID_PTR) &&\n\t    (bmap->b_last_allocated_ptr + diff > 0))\n\t\treturn bmap->b_last_allocated_ptr + diff;\n\telse\n\t\treturn NILFS_BMAP_INVALID_PTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic __u64\nnilfs_direct_find_target_v(const struct nilfs_bmap *direct, __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(direct, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse\n\t\t/* block group */\n\t\treturn nilfs_bmap_find_target_in_group(direct);\n}"
  },
  {
    "function_name": "nilfs_direct_lookup_contig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "63-102",
    "snippet": "static int nilfs_direct_lookup_contig(const struct nilfs_bmap *direct,\n\t\t\t\t      __u64 key, __u64 *ptrp,\n\t\t\t\t      unsigned maxblocks)\n{\n\tstruct inode *dat = NULL;\n\t__u64 ptr, ptr2;\n\tsector_t blocknr;\n\tint ret, cnt;\n\n\tif (key > NILFS_DIRECT_KEY_MAX)\n\t\treturn -ENOENT;\n\tptr = nilfs_direct_get_ptr(direct, key);\n\tif (ptr == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\tif (NILFS_BMAP_USE_VBN(direct)) {\n\t\tdat = nilfs_bmap_get_dat(direct);\n\t\tret = nilfs_dat_translate(dat, ptr, &blocknr);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tptr = blocknr;\n\t}\n\n\tmaxblocks = min_t(unsigned, maxblocks, NILFS_DIRECT_KEY_MAX - key + 1);\n\tfor (cnt = 1; cnt < maxblocks &&\n\t\t     (ptr2 = nilfs_direct_get_ptr(direct, key + cnt)) !=\n\t\t     NILFS_BMAP_INVALID_PTR;\n\t     cnt++) {\n\t\tif (dat) {\n\t\t\tret = nilfs_dat_translate(dat, ptr2, &blocknr);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t\tptr2 = blocknr;\n\t\t}\n\t\tif (ptr2 != ptr + cnt)\n\t\t\tbreak;\n\t}\n\t*ptrp = ptr;\n\treturn cnt;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_translate",
          "args": [
            "dat",
            "ptr2",
            "&blocknr"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_translate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "397-431",
          "snippet": "int nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "direct",
            "key + cnt"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsigned",
            "maxblocks",
            "NILFS_DIRECT_KEY_MAX - key + 1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "direct"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "direct"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_lookup_contig(const struct nilfs_bmap *direct,\n\t\t\t\t      __u64 key, __u64 *ptrp,\n\t\t\t\t      unsigned maxblocks)\n{\n\tstruct inode *dat = NULL;\n\t__u64 ptr, ptr2;\n\tsector_t blocknr;\n\tint ret, cnt;\n\n\tif (key > NILFS_DIRECT_KEY_MAX)\n\t\treturn -ENOENT;\n\tptr = nilfs_direct_get_ptr(direct, key);\n\tif (ptr == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\tif (NILFS_BMAP_USE_VBN(direct)) {\n\t\tdat = nilfs_bmap_get_dat(direct);\n\t\tret = nilfs_dat_translate(dat, ptr, &blocknr);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tptr = blocknr;\n\t}\n\n\tmaxblocks = min_t(unsigned, maxblocks, NILFS_DIRECT_KEY_MAX - key + 1);\n\tfor (cnt = 1; cnt < maxblocks &&\n\t\t     (ptr2 = nilfs_direct_get_ptr(direct, key + cnt)) !=\n\t\t     NILFS_BMAP_INVALID_PTR;\n\t     cnt++) {\n\t\tif (dat) {\n\t\t\tret = nilfs_dat_translate(dat, ptr2, &blocknr);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t\tptr2 = blocknr;\n\t\t}\n\t\tif (ptr2 != ptr + cnt)\n\t\t\tbreak;\n\t}\n\t*ptrp = ptr;\n\treturn cnt;\n}"
  },
  {
    "function_name": "nilfs_direct_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "48-61",
    "snippet": "static int nilfs_direct_lookup(const struct nilfs_bmap *direct,\n\t\t\t       __u64 key, int level, __u64 *ptrp)\n{\n\t__u64 ptr;\n\n\tif (key > NILFS_DIRECT_KEY_MAX || level != 1)\n\t\treturn -ENOENT;\n\tptr = nilfs_direct_get_ptr(direct, key);\n\tif (ptr == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\t*ptrp = ptr;\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_direct_get_ptr",
          "args": [
            "direct",
            "key"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "36-40",
          "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic int nilfs_direct_lookup(const struct nilfs_bmap *direct,\n\t\t\t       __u64 key, int level, __u64 *ptrp)\n{\n\t__u64 ptr;\n\n\tif (key > NILFS_DIRECT_KEY_MAX || level != 1)\n\t\treturn -ENOENT;\n\tptr = nilfs_direct_get_ptr(direct, key);\n\tif (ptr == NILFS_BMAP_INVALID_PTR)\n\t\treturn -ENOENT;\n\n\t*ptrp = ptr;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_direct_set_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "42-46",
    "snippet": "static inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptr"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_direct_dptrs",
          "args": [
            "direct"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "30-34",
          "snippet": "static inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline void nilfs_direct_set_ptr(struct nilfs_bmap *direct,\n\t\t\t\t\t__u64 key, __u64 ptr)\n{\n\t*(nilfs_direct_dptrs(direct) + key) = cpu_to_le64(ptr);\n}"
  },
  {
    "function_name": "nilfs_direct_get_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "36-40",
    "snippet": "static inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "*(nilfs_direct_dptrs(direct) + key)"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_direct_dptrs",
          "args": [
            "direct"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_direct_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
          "lines": "30-34",
          "snippet": "static inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"direct.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __u64\nnilfs_direct_get_ptr(const struct nilfs_bmap *direct, __u64 key)\n{\n\treturn le64_to_cpu(*(nilfs_direct_dptrs(direct) + key));\n}"
  },
  {
    "function_name": "nilfs_direct_dptrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/direct.c",
    "lines": "30-34",
    "snippet": "static inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"direct.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"direct.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n\nstatic inline __le64 *nilfs_direct_dptrs(const struct nilfs_bmap *direct)\n{\n\treturn (__le64 *)\n\t\t((struct nilfs_direct_node *)direct->b_u.u_data + 1);\n}"
  }
]