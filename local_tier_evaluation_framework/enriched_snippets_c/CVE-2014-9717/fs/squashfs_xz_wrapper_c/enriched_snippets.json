[
  {
    "function_name": "squashfs_xz_uncompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/xz_wrapper.c",
    "lines": "132-183",
    "snippet": "static int squashfs_xz_uncompress(struct squashfs_sb_info *msblk, void *strm,\n\tstruct buffer_head **bh, int b, int offset, int length,\n\tstruct squashfs_page_actor *output)\n{\n\tenum xz_ret xz_err;\n\tint avail, total = 0, k = 0;\n\tstruct squashfs_xz *stream = strm;\n\n\txz_dec_reset(stream->state);\n\tstream->buf.in_pos = 0;\n\tstream->buf.in_size = 0;\n\tstream->buf.out_pos = 0;\n\tstream->buf.out_size = PAGE_CACHE_SIZE;\n\tstream->buf.out = squashfs_first_page(output);\n\n\tdo {\n\t\tif (stream->buf.in_pos == stream->buf.in_size && k < b) {\n\t\t\tavail = min(length, msblk->devblksize - offset);\n\t\t\tlength -= avail;\n\t\t\tstream->buf.in = bh[k]->b_data + offset;\n\t\t\tstream->buf.in_size = avail;\n\t\t\tstream->buf.in_pos = 0;\n\t\t\toffset = 0;\n\t\t}\n\n\t\tif (stream->buf.out_pos == stream->buf.out_size) {\n\t\t\tstream->buf.out = squashfs_next_page(output);\n\t\t\tif (stream->buf.out != NULL) {\n\t\t\t\tstream->buf.out_pos = 0;\n\t\t\t\ttotal += PAGE_CACHE_SIZE;\n\t\t\t}\n\t\t}\n\n\t\txz_err = xz_dec_run(stream->state, &stream->buf);\n\n\t\tif (stream->buf.in_pos == stream->buf.in_size && k < b)\n\t\t\tput_bh(bh[k++]);\n\t} while (xz_err == XZ_OK);\n\n\tsquashfs_finish_page(output);\n\n\tif (xz_err != XZ_STREAM_END || k < b)\n\t\tgoto out;\n\n\treturn total + stream->buf.out_pos;\n\nout:\n\tfor (; k < b; k++)\n\t\tput_bh(bh[k]);\n\n\treturn -EIO;\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include \"decompressor.h\"",
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/bitops.h>",
      "#include <linux/xz.h>",
      "#include <linux/slab.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_bh",
          "args": [
            "bh[k]"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squashfs_finish_page",
          "args": [
            "output"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_finish_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.h",
          "lines": "76-79",
          "snippet": "static inline void squashfs_finish_page(struct squashfs_page_actor *actor)\n{\n\tactor->squashfs_finish_page(actor);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void squashfs_finish_page(struct squashfs_page_actor *actor)\n{\n\tactor->squashfs_finish_page(actor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_bh",
          "args": [
            "bh[k++]"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xz_dec_run",
          "args": [
            "stream->state",
            "&stream->buf"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squashfs_next_page",
          "args": [
            "output"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.h",
          "lines": "72-75",
          "snippet": "static inline void *squashfs_next_page(struct squashfs_page_actor *actor)\n{\n\treturn actor->squashfs_next_page(actor);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void *squashfs_next_page(struct squashfs_page_actor *actor)\n{\n\treturn actor->squashfs_next_page(actor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "length",
            "msblk->devblksize - offset"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "squashfs_first_page",
          "args": [
            "output"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "squashfs_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.h",
          "lines": "68-71",
          "snippet": "static inline void *squashfs_first_page(struct squashfs_page_actor *actor)\n{\n\treturn actor->squashfs_first_page(actor);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void *squashfs_first_page(struct squashfs_page_actor *actor)\n{\n\treturn actor->squashfs_first_page(actor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xz_dec_reset",
          "args": [
            "stream->state"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include \"decompressor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/bitops.h>\n#include <linux/xz.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n\nstatic int squashfs_xz_uncompress(struct squashfs_sb_info *msblk, void *strm,\n\tstruct buffer_head **bh, int b, int offset, int length,\n\tstruct squashfs_page_actor *output)\n{\n\tenum xz_ret xz_err;\n\tint avail, total = 0, k = 0;\n\tstruct squashfs_xz *stream = strm;\n\n\txz_dec_reset(stream->state);\n\tstream->buf.in_pos = 0;\n\tstream->buf.in_size = 0;\n\tstream->buf.out_pos = 0;\n\tstream->buf.out_size = PAGE_CACHE_SIZE;\n\tstream->buf.out = squashfs_first_page(output);\n\n\tdo {\n\t\tif (stream->buf.in_pos == stream->buf.in_size && k < b) {\n\t\t\tavail = min(length, msblk->devblksize - offset);\n\t\t\tlength -= avail;\n\t\t\tstream->buf.in = bh[k]->b_data + offset;\n\t\t\tstream->buf.in_size = avail;\n\t\t\tstream->buf.in_pos = 0;\n\t\t\toffset = 0;\n\t\t}\n\n\t\tif (stream->buf.out_pos == stream->buf.out_size) {\n\t\t\tstream->buf.out = squashfs_next_page(output);\n\t\t\tif (stream->buf.out != NULL) {\n\t\t\t\tstream->buf.out_pos = 0;\n\t\t\t\ttotal += PAGE_CACHE_SIZE;\n\t\t\t}\n\t\t}\n\n\t\txz_err = xz_dec_run(stream->state, &stream->buf);\n\n\t\tif (stream->buf.in_pos == stream->buf.in_size && k < b)\n\t\t\tput_bh(bh[k++]);\n\t} while (xz_err == XZ_OK);\n\n\tsquashfs_finish_page(output);\n\n\tif (xz_err != XZ_STREAM_END || k < b)\n\t\tgoto out;\n\n\treturn total + stream->buf.out_pos;\n\nout:\n\tfor (; k < b; k++)\n\t\tput_bh(bh[k]);\n\n\treturn -EIO;\n}"
  },
  {
    "function_name": "squashfs_xz_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/xz_wrapper.c",
    "lines": "121-129",
    "snippet": "static void squashfs_xz_free(void *strm)\n{\n\tstruct squashfs_xz *stream = strm;\n\n\tif (stream) {\n\t\txz_dec_end(stream->state);\n\t\tkfree(stream);\n\t}\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include \"decompressor.h\"",
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/bitops.h>",
      "#include <linux/xz.h>",
      "#include <linux/slab.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "stream"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xz_dec_end",
          "args": [
            "stream->state"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include \"decompressor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/bitops.h>\n#include <linux/xz.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n\nstatic void squashfs_xz_free(void *strm)\n{\n\tstruct squashfs_xz *stream = strm;\n\n\tif (stream) {\n\t\txz_dec_end(stream->state);\n\t\tkfree(stream);\n\t}\n}"
  },
  {
    "function_name": "squashfs_xz_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/xz_wrapper.c",
    "lines": "94-118",
    "snippet": "static void *squashfs_xz_init(struct squashfs_sb_info *msblk, void *buff)\n{\n\tstruct comp_opts *comp_opts = buff;\n\tstruct squashfs_xz *stream;\n\tint err;\n\n\tstream = kmalloc(sizeof(*stream), GFP_KERNEL);\n\tif (stream == NULL) {\n\t\terr = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\tstream->state = xz_dec_init(XZ_PREALLOC, comp_opts->dict_size);\n\tif (stream->state == NULL) {\n\t\tkfree(stream);\n\t\terr = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\treturn stream;\n\nfailed:\n\tERROR(\"Failed to initialise xz decompressor\\n\");\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include \"decompressor.h\"",
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/bitops.h>",
      "#include <linux/xz.h>",
      "#include <linux/slab.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Failed to initialise xz decompressor\\n\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "stream"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xz_dec_init",
          "args": [
            "XZ_PREALLOC",
            "comp_opts->dict_size"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*stream)",
            "GFP_KERNEL"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include \"decompressor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/bitops.h>\n#include <linux/xz.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n\nstatic void *squashfs_xz_init(struct squashfs_sb_info *msblk, void *buff)\n{\n\tstruct comp_opts *comp_opts = buff;\n\tstruct squashfs_xz *stream;\n\tint err;\n\n\tstream = kmalloc(sizeof(*stream), GFP_KERNEL);\n\tif (stream == NULL) {\n\t\terr = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\tstream->state = xz_dec_init(XZ_PREALLOC, comp_opts->dict_size);\n\tif (stream->state == NULL) {\n\t\tkfree(stream);\n\t\terr = -ENOMEM;\n\t\tgoto failed;\n\t}\n\n\treturn stream;\n\nfailed:\n\tERROR(\"Failed to initialise xz decompressor\\n\");\n\treturn ERR_PTR(err);\n}"
  },
  {
    "function_name": "squashfs_xz_comp_opts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/xz_wrapper.c",
    "lines": "51-91",
    "snippet": "static void *squashfs_xz_comp_opts(struct squashfs_sb_info *msblk,\n\tvoid *buff, int len)\n{\n\tstruct disk_comp_opts *comp_opts = buff;\n\tstruct comp_opts *opts;\n\tint err = 0, n;\n\n\topts = kmalloc(sizeof(*opts), GFP_KERNEL);\n\tif (opts == NULL) {\n\t\terr = -ENOMEM;\n\t\tgoto out2;\n\t}\n\n\tif (comp_opts) {\n\t\t/* check compressor options are the expected length */\n\t\tif (len < sizeof(*comp_opts)) {\n\t\t\terr = -EIO;\n\t\t\tgoto out;\n\t\t}\n\n\t\topts->dict_size = le32_to_cpu(comp_opts->dictionary_size);\n\n\t\t/* the dictionary size should be 2^n or 2^n+2^(n+1) */\n\t\tn = ffs(opts->dict_size) - 1;\n\t\tif (opts->dict_size != (1 << n) && opts->dict_size != (1 << n) +\n\t\t\t\t\t\t(1 << (n + 1))) {\n\t\t\terr = -EIO;\n\t\t\tgoto out;\n\t\t}\n\t} else\n\t\t/* use defaults */\n\t\topts->dict_size = max_t(int, msblk->block_size,\n\t\t\t\t\t\t\tSQUASHFS_METADATA_SIZE);\n\n\treturn opts;\n\nout:\n\tkfree(opts);\nout2:\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include \"decompressor.h\"",
      "#include \"squashfs.h\"",
      "#include \"squashfs_fs_sb.h\"",
      "#include \"squashfs_fs.h\"",
      "#include <linux/bitops.h>",
      "#include <linux/xz.h>",
      "#include <linux/slab.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "opts"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max_t",
          "args": [
            "int",
            "msblk->block_size",
            "SQUASHFS_METADATA_SIZE"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ffs",
          "args": [
            "opts->dict_size"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "unsigned_offsets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "40-43",
          "snippet": "static inline int unsigned_offsets(struct file *file)\n{\n\treturn file->f_mode & FMODE_UNSIGNED_OFFSET;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline int unsigned_offsets(struct file *file)\n{\n\treturn file->f_mode & FMODE_UNSIGNED_OFFSET;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "comp_opts->dictionary_size"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*opts)",
            "GFP_KERNEL"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include \"decompressor.h\"\n#include \"squashfs.h\"\n#include \"squashfs_fs_sb.h\"\n#include \"squashfs_fs.h\"\n#include <linux/bitops.h>\n#include <linux/xz.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n\nstatic void *squashfs_xz_comp_opts(struct squashfs_sb_info *msblk,\n\tvoid *buff, int len)\n{\n\tstruct disk_comp_opts *comp_opts = buff;\n\tstruct comp_opts *opts;\n\tint err = 0, n;\n\n\topts = kmalloc(sizeof(*opts), GFP_KERNEL);\n\tif (opts == NULL) {\n\t\terr = -ENOMEM;\n\t\tgoto out2;\n\t}\n\n\tif (comp_opts) {\n\t\t/* check compressor options are the expected length */\n\t\tif (len < sizeof(*comp_opts)) {\n\t\t\terr = -EIO;\n\t\t\tgoto out;\n\t\t}\n\n\t\topts->dict_size = le32_to_cpu(comp_opts->dictionary_size);\n\n\t\t/* the dictionary size should be 2^n or 2^n+2^(n+1) */\n\t\tn = ffs(opts->dict_size) - 1;\n\t\tif (opts->dict_size != (1 << n) && opts->dict_size != (1 << n) +\n\t\t\t\t\t\t(1 << (n + 1))) {\n\t\t\terr = -EIO;\n\t\t\tgoto out;\n\t\t}\n\t} else\n\t\t/* use defaults */\n\t\topts->dict_size = max_t(int, msblk->block_size,\n\t\t\t\t\t\t\tSQUASHFS_METADATA_SIZE);\n\n\treturn opts;\n\nout:\n\tkfree(opts);\nout2:\n\treturn ERR_PTR(err);\n}"
  }
]