[
  {
    "function_name": "cifs_toupper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/cifs/winucase.c",
    "lines": "639-663",
    "snippet": "wchar_t\ncifs_toupper(wchar_t in)\n{\n\tunsigned char idx;\n\tconst wchar_t *tbl;\n\twchar_t out;\n\n\t/* grab upper byte */\n\tidx = (in & 0xff00) >> 8;\n\n\t/* find pointer to 2nd layer table */\n\ttbl = toplevel[idx];\n\tif (!tbl)\n\t\treturn in;\n\n\t/* grab lower byte */\n\tidx = in & 0xff;\n\n\t/* look up character in table */\n\tout = tbl[idx];\n\tif (out)\n\t\treturn out;\n\n\treturn in;\n}",
    "includes": [
      "#include <linux/nls.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "wchar_t cifs_toupper(wchar_t in);",
      "static const wchar_t *const toplevel[256] = {\n\tt2_00, t2_01, t2_02, t2_03, t2_04, t2_05,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL, t2_1d, t2_1e, t2_1f,\n\tNULL, t2_21,  NULL,  NULL, t2_24,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL, t2_2c, t2_2d,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_a6, t2_a7,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_ff,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/nls.h>\n\nwchar_t cifs_toupper(wchar_t in);\nstatic const wchar_t *const toplevel[256] = {\n\tt2_00, t2_01, t2_02, t2_03, t2_04, t2_05,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL, t2_1d, t2_1e, t2_1f,\n\tNULL, t2_21,  NULL,  NULL, t2_24,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL, t2_2c, t2_2d,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_a6, t2_a7,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL,\n\tNULL,  NULL,  NULL,  NULL,  NULL,  NULL,  NULL, t2_ff,\n};\n\nwchar_t\ncifs_toupper(wchar_t in)\n{\n\tunsigned char idx;\n\tconst wchar_t *tbl;\n\twchar_t out;\n\n\t/* grab upper byte */\n\tidx = (in & 0xff00) >> 8;\n\n\t/* find pointer to 2nd layer table */\n\ttbl = toplevel[idx];\n\tif (!tbl)\n\t\treturn in;\n\n\t/* grab lower byte */\n\tidx = in & 0xff;\n\n\t/* look up character in table */\n\tout = tbl[idx];\n\tif (out)\n\t\treturn out;\n\n\treturn in;\n}"
  }
]