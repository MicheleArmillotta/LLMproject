[
  {
    "function_name": "nfs4_init_ds_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "539-562",
    "snippet": "int nfs4_init_ds_session(struct nfs_client *clp, unsigned long lease_time)\n{\n\tstruct nfs4_session *session = clp->cl_session;\n\tint ret;\n\n\tspin_lock(&clp->cl_lock);\n\tif (test_and_clear_bit(NFS4_SESSION_INITING, &session->session_state)) {\n\t\t/*\n\t\t * Do not set NFS_CS_CHECK_LEASE_TIME instead set the\n\t\t * DS lease to be equal to the MDS lease.\n\t\t */\n\t\tclp->cl_lease_time = lease_time;\n\t\tclp->cl_last_renewal = jiffies;\n\t}\n\tspin_unlock(&clp->cl_lock);\n\n\tret = nfs41_check_session_ready(clp);\n\tif (ret)\n\t\treturn ret;\n\t/* Test for the DS role */\n\tif (!is_ds_client(clp))\n\t\treturn -ENODEV;\n\treturn 0;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_ds_client",
          "args": [
            "clp"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "is_ds_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4_fs.h",
          "lines": "354-358",
          "snippet": "static inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn false;\n}",
          "includes": [
            "#include <linux/seqlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seqlock.h>\n\nstatic inline bool\nis_ds_client(struct nfs_client *clp)\n{\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_check_session_ready",
          "args": [
            "clp"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_check_session_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "515-528",
          "snippet": "static int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "NFS4_SESSION_INITING",
            "&session->session_state"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&clp->cl_lock"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_init_ds_session(struct nfs_client *clp, unsigned long lease_time)\n{\n\tstruct nfs4_session *session = clp->cl_session;\n\tint ret;\n\n\tspin_lock(&clp->cl_lock);\n\tif (test_and_clear_bit(NFS4_SESSION_INITING, &session->session_state)) {\n\t\t/*\n\t\t * Do not set NFS_CS_CHECK_LEASE_TIME instead set the\n\t\t * DS lease to be equal to the MDS lease.\n\t\t */\n\t\tclp->cl_lease_time = lease_time;\n\t\tclp->cl_last_renewal = jiffies;\n\t}\n\tspin_unlock(&clp->cl_lock);\n\n\tret = nfs41_check_session_ready(clp);\n\tif (ret)\n\t\treturn ret;\n\t/* Test for the DS role */\n\tif (!is_ds_client(clp))\n\t\treturn -ENODEV;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_init_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "530-537",
    "snippet": "int nfs4_init_session(struct nfs_client *clp)\n{\n\tif (!nfs4_has_session(clp))\n\t\treturn 0;\n\n\tclear_bit(NFS4_SESSION_INITING, &clp->cl_session->session_state);\n\treturn nfs41_check_session_ready(clp);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs41_check_session_ready",
          "args": [
            "clp"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_check_session_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "515-528",
          "snippet": "static int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "NFS4_SESSION_INITING",
            "&clp->cl_session->session_state"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "clp"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_init_session(struct nfs_client *clp)\n{\n\tif (!nfs4_has_session(clp))\n\t\treturn 0;\n\n\tclear_bit(NFS4_SESSION_INITING, &clp->cl_session->session_state);\n\treturn nfs41_check_session_ready(clp);\n}"
  },
  {
    "function_name": "nfs41_check_session_ready",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "515-528",
    "snippet": "static int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_rmb",
          "args": [],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_client_recover_expired_lease",
          "args": [
            "clp"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_client_recover_expired_lease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "1259-1275",
          "snippet": "int nfs4_client_recover_expired_lease(struct nfs_client *clp)\n{\n\tunsigned int loop;\n\tint ret;\n\n\tfor (loop = NFS4_MAX_LOOP_ON_RECOVER; loop != 0; loop--) {\n\t\tret = nfs4_wait_clnt_recover(clp);\n\t\tif (ret != 0)\n\t\t\tbreak;\n\t\tif (!test_bit(NFS4CLNT_LEASE_EXPIRED, &clp->cl_state) &&\n\t\t    !test_bit(NFS4CLNT_CHECK_LEASE,&clp->cl_state))\n\t\t\tbreak;\n\t\tnfs4_schedule_state_manager(clp);\n\t\tret = -EIO;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint nfs4_client_recover_expired_lease(struct nfs_client *clp)\n{\n\tunsigned int loop;\n\tint ret;\n\n\tfor (loop = NFS4_MAX_LOOP_ON_RECOVER; loop != 0; loop--) {\n\t\tret = nfs4_wait_clnt_recover(clp);\n\t\tif (ret != 0)\n\t\t\tbreak;\n\t\tif (!test_bit(NFS4CLNT_LEASE_EXPIRED, &clp->cl_state) &&\n\t\t    !test_bit(NFS4CLNT_CHECK_LEASE,&clp->cl_state))\n\t\t\tbreak;\n\t\tnfs4_schedule_state_manager(clp);\n\t\tret = -EIO;\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs41_check_session_ready(struct nfs_client *clp)\n{\n\tint ret;\n\t\n\tif (clp->cl_cons_state == NFS_CS_SESSION_INITING) {\n\t\tret = nfs4_client_recover_expired_lease(clp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\tif (clp->cl_cons_state < NFS_CS_READY)\n\t\treturn -EPROTONOSUPPORT;\n\tsmp_rmb();\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_destroy_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "488-506",
    "snippet": "void nfs4_destroy_session(struct nfs4_session *session)\n{\n\tstruct rpc_xprt *xprt;\n\tstruct rpc_cred *cred;\n\n\tcred = nfs4_get_clid_cred(session->clp);\n\tnfs4_proc_destroy_session(session, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\n\trcu_read_lock();\n\txprt = rcu_dereference(session->clp->cl_rpcclient->cl_xprt);\n\trcu_read_unlock();\n\tdprintk(\"%s Destroy backchannel for xprt %p\\n\",\n\t\t__func__, xprt);\n\txprt_destroy_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\tnfs4_destroy_session_slot_tables(session);\n\tkfree(session);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "session"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_destroy_session_slot_tables",
          "args": [
            "session"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_destroy_session_slot_tables",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "482-486",
          "snippet": "static void nfs4_destroy_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_shutdown_slot_table(&session->fc_slot_table);\n\tnfs4_shutdown_slot_table(&session->bc_slot_table);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_destroy_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_shutdown_slot_table(&session->fc_slot_table);\n\tnfs4_shutdown_slot_table(&session->bc_slot_table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xprt_destroy_backchannel",
          "args": [
            "xprt",
            "NFS41_BC_MIN_CALLBACKS"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s Destroy backchannel for xprt %p\\n\"",
            "__func__",
            "xprt"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "session->clp->cl_rpcclient->cl_xprt"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_rpccred",
          "args": [
            "cred"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_proc_destroy_session",
          "args": [
            "session",
            "cred"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_proc_destroy_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "7323-7348",
          "snippet": "int nfs4_proc_destroy_session(struct nfs4_session *session,\n\t\tstruct rpc_cred *cred)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs4_procedures[NFSPROC4_CLNT_DESTROY_SESSION],\n\t\t.rpc_argp = session,\n\t\t.rpc_cred = cred,\n\t};\n\tint status = 0;\n\n\tdprintk(\"--> nfs4_proc_destroy_session\\n\");\n\n\t/* session is still being setup */\n\tif (!test_and_clear_bit(NFS4_SESSION_ESTABLISHED, &session->session_state))\n\t\treturn 0;\n\n\tstatus = rpc_call_sync(session->clp->cl_rpcclient, &msg, RPC_TASK_TIMEOUT);\n\ttrace_nfs4_destroy_session(session->clp, status);\n\n\tif (status)\n\t\tdprintk(\"NFS: Got error %d from the server on DESTROY_SESSION. \"\n\t\t\t\"Session has been destroyed regardless...\\n\", status);\n\n\tdprintk(\"<-- nfs4_proc_destroy_session\\n\");\n\treturn status;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nint nfs4_proc_destroy_session(struct nfs4_session *session,\n\t\tstruct rpc_cred *cred)\n{\n\tstruct rpc_message msg = {\n\t\t.rpc_proc = &nfs4_procedures[NFSPROC4_CLNT_DESTROY_SESSION],\n\t\t.rpc_argp = session,\n\t\t.rpc_cred = cred,\n\t};\n\tint status = 0;\n\n\tdprintk(\"--> nfs4_proc_destroy_session\\n\");\n\n\t/* session is still being setup */\n\tif (!test_and_clear_bit(NFS4_SESSION_ESTABLISHED, &session->session_state))\n\t\treturn 0;\n\n\tstatus = rpc_call_sync(session->clp->cl_rpcclient, &msg, RPC_TASK_TIMEOUT);\n\ttrace_nfs4_destroy_session(session->clp, status);\n\n\tif (status)\n\t\tdprintk(\"NFS: Got error %d from the server on DESTROY_SESSION. \"\n\t\t\t\"Session has been destroyed regardless...\\n\", status);\n\n\tdprintk(\"<-- nfs4_proc_destroy_session\\n\");\n\treturn status;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_get_clid_cred",
          "args": [
            "session->clp"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_get_clid_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4state.c",
          "lines": "376-384",
          "snippet": "struct rpc_cred *nfs4_get_clid_cred(struct nfs_client *clp)\n{\n\tstruct rpc_cred *cred;\n\n\tspin_lock(&clp->cl_lock);\n\tcred = nfs4_get_machine_cred_locked(clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn cred;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/bitops.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/sunrpc/clnt.h>\n#include <linux/jiffies.h>\n#include <linux/bitops.h>\n#include <linux/workqueue.h>\n#include <linux/ratelimit.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/nfs_idmap.h>\n#include <linux/nfs_fs.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstruct rpc_cred *nfs4_get_clid_cred(struct nfs_client *clp)\n{\n\tstruct rpc_cred *cred;\n\n\tspin_lock(&clp->cl_lock);\n\tcred = nfs4_get_machine_cred_locked(clp);\n\tspin_unlock(&clp->cl_lock);\n\treturn cred;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_destroy_session(struct nfs4_session *session)\n{\n\tstruct rpc_xprt *xprt;\n\tstruct rpc_cred *cred;\n\n\tcred = nfs4_get_clid_cred(session->clp);\n\tnfs4_proc_destroy_session(session, cred);\n\tif (cred)\n\t\tput_rpccred(cred);\n\n\trcu_read_lock();\n\txprt = rcu_dereference(session->clp->cl_rpcclient->cl_xprt);\n\trcu_read_unlock();\n\tdprintk(\"%s Destroy backchannel for xprt %p\\n\",\n\t\t__func__, xprt);\n\txprt_destroy_backchannel(xprt, NFS41_BC_MIN_CALLBACKS);\n\tnfs4_destroy_session_slot_tables(session);\n\tkfree(session);\n}"
  },
  {
    "function_name": "nfs4_destroy_session_slot_tables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "482-486",
    "snippet": "static void nfs4_destroy_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_shutdown_slot_table(&session->fc_slot_table);\n\tnfs4_shutdown_slot_table(&session->bc_slot_table);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_shutdown_slot_table",
          "args": [
            "&session->bc_slot_table"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shutdown_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "247-251",
          "snippet": "void nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_destroy_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_shutdown_slot_table(&session->fc_slot_table);\n\tnfs4_shutdown_slot_table(&session->bc_slot_table);\n}"
  },
  {
    "function_name": "nfs4_alloc_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "466-480",
    "snippet": "struct nfs4_session *nfs4_alloc_session(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session;\n\n\tsession = kzalloc(sizeof(struct nfs4_session), GFP_NOFS);\n\tif (!session)\n\t\treturn NULL;\n\n\tnfs4_init_slot_table(&session->fc_slot_table, \"ForeChannel Slot table\");\n\tnfs4_init_slot_table(&session->bc_slot_table, \"BackChannel Slot table\");\n\tsession->session_state = 1<<NFS4_SESSION_INITING;\n\n\tsession->clp = clp;\n\treturn session;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_init_slot_table",
          "args": [
            "&session->bc_slot_table",
            "\"BackChannel Slot table\""
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "26-32",
          "snippet": "static void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct nfs4_session)",
            "GFP_NOFS"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstruct nfs4_session *nfs4_alloc_session(struct nfs_client *clp)\n{\n\tstruct nfs4_session *session;\n\n\tsession = kzalloc(sizeof(struct nfs4_session), GFP_NOFS);\n\tif (!session)\n\t\treturn NULL;\n\n\tnfs4_init_slot_table(&session->fc_slot_table, \"ForeChannel Slot table\");\n\tnfs4_init_slot_table(&session->bc_slot_table, \"BackChannel Slot table\");\n\tsession->session_state = 1<<NFS4_SESSION_INITING;\n\n\tsession->clp = clp;\n\treturn session;\n}"
  },
  {
    "function_name": "nfs4_setup_session_slot_tables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "443-464",
    "snippet": "int nfs4_setup_session_slot_tables(struct nfs4_session *ses)\n{\n\tstruct nfs4_slot_table *tbl;\n\tint status;\n\n\tdprintk(\"--> %s\\n\", __func__);\n\t/* Fore channel */\n\ttbl = &ses->fc_slot_table;\n\ttbl->session = ses;\n\tstatus = nfs4_realloc_slot_table(tbl, ses->fc_attrs.max_reqs, 1);\n\tif (status || !(ses->flags & SESSION4_BACK_CHAN)) /* -ENOMEM */\n\t\treturn status;\n\t/* Back channel */\n\ttbl = &ses->bc_slot_table;\n\ttbl->session = ses;\n\tstatus = nfs4_realloc_slot_table(tbl, ses->bc_attrs.max_reqs, 0);\n\tif (status && tbl->slots == NULL)\n\t\t/* Fore and back channel share a connection so get\n\t\t * both slot tables or neither */\n\t\tnfs4_release_session_slot_tables(ses);\n\treturn status;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_release_session_slot_tables",
          "args": [
            "ses"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_release_session_slot_tables",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "434-438",
          "snippet": "static void nfs4_release_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_release_slot_table(&session->fc_slot_table);\n\tnfs4_release_slot_table(&session->bc_slot_table);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_release_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_release_slot_table(&session->fc_slot_table);\n\tnfs4_release_slot_table(&session->bc_slot_table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_realloc_slot_table",
          "args": [
            "tbl",
            "ses->bc_attrs.max_reqs",
            "0"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_realloc_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "208-232",
          "snippet": "static int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> %s\\n\"",
            "__func__"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_setup_session_slot_tables(struct nfs4_session *ses)\n{\n\tstruct nfs4_slot_table *tbl;\n\tint status;\n\n\tdprintk(\"--> %s\\n\", __func__);\n\t/* Fore channel */\n\ttbl = &ses->fc_slot_table;\n\ttbl->session = ses;\n\tstatus = nfs4_realloc_slot_table(tbl, ses->fc_attrs.max_reqs, 1);\n\tif (status || !(ses->flags & SESSION4_BACK_CHAN)) /* -ENOMEM */\n\t\treturn status;\n\t/* Back channel */\n\ttbl = &ses->bc_slot_table;\n\ttbl->session = ses;\n\tstatus = nfs4_realloc_slot_table(tbl, ses->bc_attrs.max_reqs, 0);\n\tif (status && tbl->slots == NULL)\n\t\t/* Fore and back channel share a connection so get\n\t\t * both slot tables or neither */\n\t\tnfs4_release_session_slot_tables(ses);\n\treturn status;\n}"
  },
  {
    "function_name": "nfs4_release_session_slot_tables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "434-438",
    "snippet": "static void nfs4_release_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_release_slot_table(&session->fc_slot_table);\n\tnfs4_release_slot_table(&session->bc_slot_table);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_release_slot_table",
          "args": [
            "&session->bc_slot_table"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_release_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "237-240",
          "snippet": "static void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_release_session_slot_tables(struct nfs4_session *session)\n{\n\tnfs4_release_slot_table(&session->fc_slot_table);\n\tnfs4_release_slot_table(&session->bc_slot_table);\n}"
  },
  {
    "function_name": "nfs41_update_target_slotid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "421-432",
    "snippet": "void nfs41_update_target_slotid(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot,\n\t\tstruct nfs4_sequence_res *res)\n{\n\tspin_lock(&tbl->slot_tbl_lock);\n\tif (!nfs41_is_outlier_target_slotid(tbl, res->sr_target_highest_slotid))\n\t\tnfs41_set_target_slotid_locked(tbl, res->sr_target_highest_slotid);\n\tif (tbl->generation == slot->generation)\n\t\tnfs41_set_server_slotid_locked(tbl, res->sr_highest_slotid);\n\tnfs41_set_max_slotid_locked(tbl, res->sr_target_highest_slotid);\n\tspin_unlock(&tbl->slot_tbl_lock);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_set_max_slotid_locked",
          "args": [
            "tbl",
            "res->sr_target_highest_slotid"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_set_max_slotid_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "324-336",
          "snippet": "static void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_set_server_slotid_locked",
          "args": [
            "tbl",
            "res->sr_highest_slotid"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_set_server_slotid_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "359-369",
          "snippet": "static void nfs41_set_server_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 highest_slotid)\n{\n\tif (tbl->server_highest_slotid == highest_slotid)\n\t\treturn;\n\tif (tbl->highest_used_slotid > highest_slotid)\n\t\treturn;\n\t/* Deallocate slots */\n\tnfs4_shrink_slot_table(tbl, highest_slotid + 1);\n\ttbl->server_highest_slotid = highest_slotid;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_server_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 highest_slotid)\n{\n\tif (tbl->server_highest_slotid == highest_slotid)\n\t\treturn;\n\tif (tbl->highest_used_slotid > highest_slotid)\n\t\treturn;\n\t/* Deallocate slots */\n\tnfs4_shrink_slot_table(tbl, highest_slotid + 1);\n\ttbl->server_highest_slotid = highest_slotid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_set_target_slotid_locked",
          "args": [
            "tbl",
            "res->sr_target_highest_slotid"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_set_target_slotid_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "339-346",
          "snippet": "static void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_is_outlier_target_slotid",
          "args": [
            "tbl",
            "res->sr_target_highest_slotid"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_is_outlier_target_slotid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "400-419",
          "snippet": "static bool nfs41_is_outlier_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 new_target)\n{\n\ts32 d_target, d2_target;\n\tbool ret = true;\n\n\td_target = nfs41_derivative_target_slotid(new_target,\n\t\t\ttbl->target_highest_slotid);\n\td2_target = nfs41_derivative_target_slotid(d_target,\n\t\t\ttbl->d_target_highest_slotid);\n\t/* Is first derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d_target, tbl->d_target_highest_slotid))\n\t\tret = false;\n\t/* Is second derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d2_target, tbl->d2_target_highest_slotid))\n\t\tret = false;\n\ttbl->d_target_highest_slotid = d_target;\n\ttbl->d2_target_highest_slotid = d2_target;\n\treturn ret;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_is_outlier_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 new_target)\n{\n\ts32 d_target, d2_target;\n\tbool ret = true;\n\n\td_target = nfs41_derivative_target_slotid(new_target,\n\t\t\ttbl->target_highest_slotid);\n\td2_target = nfs41_derivative_target_slotid(d_target,\n\t\t\ttbl->d_target_highest_slotid);\n\t/* Is first derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d_target, tbl->d_target_highest_slotid))\n\t\tret = false;\n\t/* Is second derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d2_target, tbl->d2_target_highest_slotid))\n\t\tret = false;\n\ttbl->d_target_highest_slotid = d_target;\n\ttbl->d2_target_highest_slotid = d2_target;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs41_update_target_slotid(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot,\n\t\tstruct nfs4_sequence_res *res)\n{\n\tspin_lock(&tbl->slot_tbl_lock);\n\tif (!nfs41_is_outlier_target_slotid(tbl, res->sr_target_highest_slotid))\n\t\tnfs41_set_target_slotid_locked(tbl, res->sr_target_highest_slotid);\n\tif (tbl->generation == slot->generation)\n\t\tnfs41_set_server_slotid_locked(tbl, res->sr_highest_slotid);\n\tnfs41_set_max_slotid_locked(tbl, res->sr_target_highest_slotid);\n\tspin_unlock(&tbl->slot_tbl_lock);\n}"
  },
  {
    "function_name": "nfs41_is_outlier_target_slotid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "400-419",
    "snippet": "static bool nfs41_is_outlier_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 new_target)\n{\n\ts32 d_target, d2_target;\n\tbool ret = true;\n\n\td_target = nfs41_derivative_target_slotid(new_target,\n\t\t\ttbl->target_highest_slotid);\n\td2_target = nfs41_derivative_target_slotid(d_target,\n\t\t\ttbl->d_target_highest_slotid);\n\t/* Is first derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d_target, tbl->d_target_highest_slotid))\n\t\tret = false;\n\t/* Is second derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d2_target, tbl->d2_target_highest_slotid))\n\t\tret = false;\n\ttbl->d_target_highest_slotid = d_target;\n\ttbl->d2_target_highest_slotid = d2_target;\n\treturn ret;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs41_same_sign_or_zero_s32",
          "args": [
            "d2_target",
            "tbl->d2_target_highest_slotid"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_same_sign_or_zero_s32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "390-395",
          "snippet": "static bool nfs41_same_sign_or_zero_s32(s32 s1, s32 s2)\n{\n\tif (!s1 || !s2)\n\t\treturn true;\n\treturn nfs41_sign_s32(s1) == nfs41_sign_s32(s2);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_same_sign_or_zero_s32(s32 s1, s32 s2)\n{\n\tif (!s1 || !s2)\n\t\treturn true;\n\treturn nfs41_sign_s32(s1) == nfs41_sign_s32(s2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_derivative_target_slotid",
          "args": [
            "d_target",
            "tbl->d_target_highest_slotid"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_derivative_target_slotid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "371-379",
          "snippet": "static s32 nfs41_derivative_target_slotid(s32 s1, s32 s2)\n{\n\ts1 -= s2;\n\tif (s1 == 0)\n\t\treturn 0;\n\tif (s1 < 0)\n\t\treturn (s1 - 1) >> 1;\n\treturn (s1 + 1) >> 1;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic s32 nfs41_derivative_target_slotid(s32 s1, s32 s2)\n{\n\ts1 -= s2;\n\tif (s1 == 0)\n\t\treturn 0;\n\tif (s1 < 0)\n\t\treturn (s1 - 1) >> 1;\n\treturn (s1 + 1) >> 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_is_outlier_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 new_target)\n{\n\ts32 d_target, d2_target;\n\tbool ret = true;\n\n\td_target = nfs41_derivative_target_slotid(new_target,\n\t\t\ttbl->target_highest_slotid);\n\td2_target = nfs41_derivative_target_slotid(d_target,\n\t\t\ttbl->d_target_highest_slotid);\n\t/* Is first derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d_target, tbl->d_target_highest_slotid))\n\t\tret = false;\n\t/* Is second derivative same sign? */\n\tif (nfs41_same_sign_or_zero_s32(d2_target, tbl->d2_target_highest_slotid))\n\t\tret = false;\n\ttbl->d_target_highest_slotid = d_target;\n\ttbl->d2_target_highest_slotid = d2_target;\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs41_same_sign_or_zero_s32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "390-395",
    "snippet": "static bool nfs41_same_sign_or_zero_s32(s32 s1, s32 s2)\n{\n\tif (!s1 || !s2)\n\t\treturn true;\n\treturn nfs41_sign_s32(s1) == nfs41_sign_s32(s2);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs41_sign_s32",
          "args": [
            "s2"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_sign_s32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "381-388",
          "snippet": "static int nfs41_sign_s32(s32 s1)\n{\n\tif (s1 > 0)\n\t\treturn 1;\n\tif (s1 < 0)\n\t\treturn -1;\n\treturn 0;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs41_sign_s32(s32 s1)\n{\n\tif (s1 > 0)\n\t\treturn 1;\n\tif (s1 < 0)\n\t\treturn -1;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_same_sign_or_zero_s32(s32 s1, s32 s2)\n{\n\tif (!s1 || !s2)\n\t\treturn true;\n\treturn nfs41_sign_s32(s1) == nfs41_sign_s32(s2);\n}"
  },
  {
    "function_name": "nfs41_sign_s32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "381-388",
    "snippet": "static int nfs41_sign_s32(s32 s1)\n{\n\tif (s1 > 0)\n\t\treturn 1;\n\tif (s1 < 0)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs41_sign_s32(s32 s1)\n{\n\tif (s1 > 0)\n\t\treturn 1;\n\tif (s1 < 0)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs41_derivative_target_slotid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "371-379",
    "snippet": "static s32 nfs41_derivative_target_slotid(s32 s1, s32 s2)\n{\n\ts1 -= s2;\n\tif (s1 == 0)\n\t\treturn 0;\n\tif (s1 < 0)\n\t\treturn (s1 - 1) >> 1;\n\treturn (s1 + 1) >> 1;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic s32 nfs41_derivative_target_slotid(s32 s1, s32 s2)\n{\n\ts1 -= s2;\n\tif (s1 == 0)\n\t\treturn 0;\n\tif (s1 < 0)\n\t\treturn (s1 - 1) >> 1;\n\treturn (s1 + 1) >> 1;\n}"
  },
  {
    "function_name": "nfs41_set_server_slotid_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "359-369",
    "snippet": "static void nfs41_set_server_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 highest_slotid)\n{\n\tif (tbl->server_highest_slotid == highest_slotid)\n\t\treturn;\n\tif (tbl->highest_used_slotid > highest_slotid)\n\t\treturn;\n\t/* Deallocate slots */\n\tnfs4_shrink_slot_table(tbl, highest_slotid + 1);\n\ttbl->server_highest_slotid = highest_slotid;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_shrink_slot_table",
          "args": [
            "tbl",
            "highest_slotid + 1"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shrink_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "37-53",
          "snippet": "static void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_server_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 highest_slotid)\n{\n\tif (tbl->server_highest_slotid == highest_slotid)\n\t\treturn;\n\tif (tbl->highest_used_slotid > highest_slotid)\n\t\treturn;\n\t/* Deallocate slots */\n\tnfs4_shrink_slot_table(tbl, highest_slotid + 1);\n\ttbl->server_highest_slotid = highest_slotid;\n}"
  },
  {
    "function_name": "nfs41_set_target_slotid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "348-357",
    "snippet": "void nfs41_set_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs41_set_target_slotid_locked(tbl, target_highest_slotid);\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\tnfs41_set_max_slotid_locked(tbl, target_highest_slotid);\n\tspin_unlock(&tbl->slot_tbl_lock);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_set_max_slotid_locked",
          "args": [
            "tbl",
            "target_highest_slotid"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_set_max_slotid_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "324-336",
          "snippet": "static void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs41_set_target_slotid_locked",
          "args": [
            "tbl",
            "target_highest_slotid"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_set_target_slotid_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "339-346",
          "snippet": "static void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs41_set_target_slotid(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs41_set_target_slotid_locked(tbl, target_highest_slotid);\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\tnfs41_set_max_slotid_locked(tbl, target_highest_slotid);\n\tspin_unlock(&tbl->slot_tbl_lock);\n}"
  },
  {
    "function_name": "nfs41_set_target_slotid_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "339-346",
    "snippet": "static void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_target_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tif (tbl->target_highest_slotid == target_highest_slotid)\n\t\treturn;\n\ttbl->target_highest_slotid = target_highest_slotid;\n\ttbl->generation++;\n}"
  },
  {
    "function_name": "nfs41_set_max_slotid_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "324-336",
    "snippet": "static void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs41_wake_slot_table",
          "args": [
            "tbl"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_wake_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "314-320",
          "snippet": "void nfs41_wake_slot_table(struct nfs4_slot_table *tbl)\n{\n\tfor (;;) {\n\t\tif (!nfs41_try_wake_next_slot_table_entry(tbl))\n\t\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs41_wake_slot_table(struct nfs4_slot_table *tbl)\n{\n\tfor (;;) {\n\t\tif (!nfs41_try_wake_next_slot_table_entry(tbl))\n\t\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "NFS4_MAX_SLOT_TABLE - 1",
            "target_highest_slotid"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs41_set_max_slotid_locked(struct nfs4_slot_table *tbl,\n\t\tu32 target_highest_slotid)\n{\n\tu32 max_slotid;\n\n\tmax_slotid = min(NFS4_MAX_SLOT_TABLE - 1, target_highest_slotid);\n\tif (max_slotid > tbl->server_highest_slotid)\n\t\tmax_slotid = tbl->server_highest_slotid;\n\tif (max_slotid > tbl->target_highest_slotid)\n\t\tmax_slotid = tbl->target_highest_slotid;\n\ttbl->max_slotid = max_slotid;\n\tnfs41_wake_slot_table(tbl);\n}"
  },
  {
    "function_name": "nfs41_wake_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "314-320",
    "snippet": "void nfs41_wake_slot_table(struct nfs4_slot_table *tbl)\n{\n\tfor (;;) {\n\t\tif (!nfs41_try_wake_next_slot_table_entry(tbl))\n\t\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs41_try_wake_next_slot_table_entry",
          "args": [
            "tbl"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "nfs41_try_wake_next_slot_table_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "302-312",
          "snippet": "static bool nfs41_try_wake_next_slot_table_entry(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *slot = nfs4_alloc_slot(tbl);\n\tif (!IS_ERR(slot)) {\n\t\tbool ret = __nfs41_wake_and_assign_slot(tbl, slot);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tnfs4_free_slot(tbl, slot);\n\t}\n\treturn false;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_try_wake_next_slot_table_entry(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *slot = nfs4_alloc_slot(tbl);\n\tif (!IS_ERR(slot)) {\n\t\tbool ret = __nfs41_wake_and_assign_slot(tbl, slot);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tnfs4_free_slot(tbl, slot);\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs41_wake_slot_table(struct nfs4_slot_table *tbl)\n{\n\tfor (;;) {\n\t\tif (!nfs41_try_wake_next_slot_table_entry(tbl))\n\t\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "nfs41_try_wake_next_slot_table_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "302-312",
    "snippet": "static bool nfs41_try_wake_next_slot_table_entry(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *slot = nfs4_alloc_slot(tbl);\n\tif (!IS_ERR(slot)) {\n\t\tbool ret = __nfs41_wake_and_assign_slot(tbl, slot);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tnfs4_free_slot(tbl, slot);\n\t}\n\treturn false;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_free_slot",
          "args": [
            "tbl",
            "slot"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_free_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "81-100",
          "snippet": "void nfs4_free_slot(struct nfs4_slot_table *tbl, struct nfs4_slot *slot)\n{\n\tu32 slotid = slot->slot_nr;\n\n\t/* clear used bit in bitmap */\n\t__clear_bit(slotid, tbl->used_slots);\n\n\t/* update highest_used_slotid when it is freed */\n\tif (slotid == tbl->highest_used_slotid) {\n\t\tu32 new_max = find_last_bit(tbl->used_slots, slotid);\n\t\tif (new_max < slotid)\n\t\t\ttbl->highest_used_slotid = new_max;\n\t\telse {\n\t\t\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\t\t\tnfs4_slot_tbl_drain_complete(tbl);\n\t\t}\n\t}\n\tdprintk(\"%s: slotid %u highest_used_slotid %u\\n\", __func__,\n\t\tslotid, tbl->highest_used_slotid);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_free_slot(struct nfs4_slot_table *tbl, struct nfs4_slot *slot)\n{\n\tu32 slotid = slot->slot_nr;\n\n\t/* clear used bit in bitmap */\n\t__clear_bit(slotid, tbl->used_slots);\n\n\t/* update highest_used_slotid when it is freed */\n\tif (slotid == tbl->highest_used_slotid) {\n\t\tu32 new_max = find_last_bit(tbl->used_slots, slotid);\n\t\tif (new_max < slotid)\n\t\t\ttbl->highest_used_slotid = new_max;\n\t\telse {\n\t\t\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\t\t\tnfs4_slot_tbl_drain_complete(tbl);\n\t\t}\n\t}\n\tdprintk(\"%s: slotid %u highest_used_slotid %u\\n\", __func__,\n\t\tslotid, tbl->highest_used_slotid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nfs41_wake_and_assign_slot",
          "args": [
            "tbl",
            "slot"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs41_wake_and_assign_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "286-292",
          "snippet": "static bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "slot"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_alloc_slot",
          "args": [
            "tbl"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_alloc_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "147-172",
          "snippet": "struct nfs4_slot *nfs4_alloc_slot(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *ret = ERR_PTR(-EBUSY);\n\tu32 slotid;\n\n\tdprintk(\"--> %s used_slots=%04lx highest_used=%u max_slots=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\ttbl->max_slotid + 1);\n\tslotid = find_first_zero_bit(tbl->used_slots, tbl->max_slotid + 1);\n\tif (slotid > tbl->max_slotid)\n\t\tgoto out;\n\tret = nfs4_find_or_create_slot(tbl, slotid, 1, GFP_NOWAIT);\n\tif (IS_ERR(ret))\n\t\tgoto out;\n\t__set_bit(slotid, tbl->used_slots);\n\tif (slotid > tbl->highest_used_slotid ||\n\t\t\ttbl->highest_used_slotid == NFS4_NO_SLOT)\n\t\ttbl->highest_used_slotid = slotid;\n\tret->generation = tbl->generation;\n\nout:\n\tdprintk(\"<-- %s used_slots=%04lx highest_used=%u slotid=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\t!IS_ERR(ret) ? ret->slot_nr : NFS4_NO_SLOT);\n\treturn ret;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstruct nfs4_slot *nfs4_alloc_slot(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *ret = ERR_PTR(-EBUSY);\n\tu32 slotid;\n\n\tdprintk(\"--> %s used_slots=%04lx highest_used=%u max_slots=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\ttbl->max_slotid + 1);\n\tslotid = find_first_zero_bit(tbl->used_slots, tbl->max_slotid + 1);\n\tif (slotid > tbl->max_slotid)\n\t\tgoto out;\n\tret = nfs4_find_or_create_slot(tbl, slotid, 1, GFP_NOWAIT);\n\tif (IS_ERR(ret))\n\t\tgoto out;\n\t__set_bit(slotid, tbl->used_slots);\n\tif (slotid > tbl->highest_used_slotid ||\n\t\t\ttbl->highest_used_slotid == NFS4_NO_SLOT)\n\t\ttbl->highest_used_slotid = slotid;\n\tret->generation = tbl->generation;\n\nout:\n\tdprintk(\"<-- %s used_slots=%04lx highest_used=%u slotid=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\t!IS_ERR(ret) ? ret->slot_nr : NFS4_NO_SLOT);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_try_wake_next_slot_table_entry(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *slot = nfs4_alloc_slot(tbl);\n\tif (!IS_ERR(slot)) {\n\t\tbool ret = __nfs41_wake_and_assign_slot(tbl, slot);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\tnfs4_free_slot(tbl, slot);\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "nfs41_wake_and_assign_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "294-300",
    "snippet": "bool nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (slot->slot_nr > tbl->max_slotid)\n\t\treturn false;\n\treturn __nfs41_wake_and_assign_slot(tbl, slot);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nfs41_wake_and_assign_slot",
          "args": [
            "tbl",
            "slot"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "__nfs41_wake_and_assign_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "286-292",
          "snippet": "static bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nbool nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (slot->slot_nr > tbl->max_slotid)\n\t\treturn false;\n\treturn __nfs41_wake_and_assign_slot(tbl, slot);\n}"
  },
  {
    "function_name": "__nfs41_wake_and_assign_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "286-292",
    "snippet": "static bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_wake_up_first",
          "args": [
            "&tbl->slot_tbl_waitq",
            "nfs41_assign_slot",
            "slot"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool __nfs41_wake_and_assign_slot(struct nfs4_slot_table *tbl,\n\t\tstruct nfs4_slot *slot)\n{\n\tif (rpc_wake_up_first(&tbl->slot_tbl_waitq, nfs41_assign_slot, slot))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "nfs41_assign_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "268-284",
    "snippet": "static bool nfs41_assign_slot(struct rpc_task *task, void *pslot)\n{\n\tstruct nfs4_sequence_args *args = task->tk_msg.rpc_argp;\n\tstruct nfs4_sequence_res *res = task->tk_msg.rpc_resp;\n\tstruct nfs4_slot *slot = pslot;\n\tstruct nfs4_slot_table *tbl = slot->table;\n\n\tif (nfs4_slot_tbl_draining(tbl) && !args->sa_privileged)\n\t\treturn false;\n\tslot->generation = tbl->generation;\n\targs->sa_slot = slot;\n\tres->sr_timestamp = jiffies;\n\tres->sr_slot = slot;\n\tres->sr_status_flags = 0;\n\tres->sr_status = 1;\n\treturn true;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_slot_tbl_draining",
          "args": [
            "tbl"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_slot_tbl_draining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "86-89",
          "snippet": "static inline bool nfs4_slot_tbl_draining(struct nfs4_slot_table *tbl)\n{\n\treturn !!test_bit(NFS4_SLOT_TBL_DRAINING, &tbl->slot_tbl_state);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline bool nfs4_slot_tbl_draining(struct nfs4_slot_table *tbl)\n{\n\treturn !!test_bit(NFS4_SLOT_TBL_DRAINING, &tbl->slot_tbl_state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic bool nfs41_assign_slot(struct rpc_task *task, void *pslot)\n{\n\tstruct nfs4_sequence_args *args = task->tk_msg.rpc_argp;\n\tstruct nfs4_sequence_res *res = task->tk_msg.rpc_resp;\n\tstruct nfs4_slot *slot = pslot;\n\tstruct nfs4_slot_table *tbl = slot->table;\n\n\tif (nfs4_slot_tbl_draining(tbl) && !args->sa_privileged)\n\t\treturn false;\n\tslot->generation = tbl->generation;\n\targs->sa_slot = slot;\n\tres->sr_timestamp = jiffies;\n\tres->sr_slot = slot;\n\tres->sr_status_flags = 0;\n\tres->sr_status = 1;\n\treturn true;\n}"
  },
  {
    "function_name": "nfs4_setup_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "261-266",
    "snippet": "int nfs4_setup_slot_table(struct nfs4_slot_table *tbl, unsigned int max_reqs,\n\t\tconst char *queue)\n{\n\tnfs4_init_slot_table(tbl, queue);\n\treturn nfs4_realloc_slot_table(tbl, max_reqs, 0);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_realloc_slot_table",
          "args": [
            "tbl",
            "max_reqs",
            "0"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_realloc_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "208-232",
          "snippet": "static int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_init_slot_table",
          "args": [
            "tbl",
            "queue"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_init_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "26-32",
          "snippet": "static void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint nfs4_setup_slot_table(struct nfs4_slot_table *tbl, unsigned int max_reqs,\n\t\tconst char *queue)\n{\n\tnfs4_init_slot_table(tbl, queue);\n\treturn nfs4_realloc_slot_table(tbl, max_reqs, 0);\n}"
  },
  {
    "function_name": "nfs4_shutdown_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "247-251",
    "snippet": "void nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_destroy_wait_queue",
          "args": [
            "&tbl->slot_tbl_waitq"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_release_slot_table",
          "args": [
            "tbl"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_release_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "237-240",
          "snippet": "static void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_shutdown_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_release_slot_table(tbl);\n\trpc_destroy_wait_queue(&tbl->slot_tbl_waitq);\n}"
  },
  {
    "function_name": "nfs4_release_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "237-240",
    "snippet": "static void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_shrink_slot_table",
          "args": [
            "tbl",
            "0"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shrink_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "37-53",
          "snippet": "static void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_release_slot_table(struct nfs4_slot_table *tbl)\n{\n\tnfs4_shrink_slot_table(tbl, 0);\n}"
  },
  {
    "function_name": "nfs4_realloc_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "208-232",
    "snippet": "static int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s: return %d\\n\"",
            "__func__",
            "ret"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: tbl=%p slots=%p max_slots=%u\\n\"",
            "__func__",
            "tbl",
            "tbl->slots",
            "tbl->max_slots"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_reset_slot_table",
          "args": [
            "tbl",
            "max_reqs - 1",
            "ivalue"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_reset_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "184-203",
          "snippet": "static void nfs4_reset_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 server_highest_slotid,\n\t\tu32 ivalue)\n{\n\tstruct nfs4_slot **p;\n\n\tnfs4_shrink_slot_table(tbl, server_highest_slotid + 1);\n\tp = &tbl->slots;\n\twhile (*p) {\n\t\t(*p)->seq_nr = ivalue;\n\t\t(*p)->interrupted = 0;\n\t\tp = &(*p)->next;\n\t}\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\ttbl->target_highest_slotid = server_highest_slotid;\n\ttbl->server_highest_slotid = server_highest_slotid;\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\ttbl->max_slotid = server_highest_slotid;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_reset_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 server_highest_slotid,\n\t\tu32 ivalue)\n{\n\tstruct nfs4_slot **p;\n\n\tnfs4_shrink_slot_table(tbl, server_highest_slotid + 1);\n\tp = &tbl->slots;\n\twhile (*p) {\n\t\t(*p)->seq_nr = ivalue;\n\t\t(*p)->interrupted = 0;\n\t\tp = &(*p)->next;\n\t}\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\ttbl->target_highest_slotid = server_highest_slotid;\n\ttbl->server_highest_slotid = server_highest_slotid;\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\ttbl->max_slotid = server_highest_slotid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_grow_slot_table",
          "args": [
            "tbl",
            "max_reqs",
            "ivalue"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_grow_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "174-182",
          "snippet": "static int nfs4_grow_slot_table(struct nfs4_slot_table *tbl,\n\t\t u32 max_reqs, u32 ivalue)\n{\n\tif (max_reqs <= tbl->max_slots)\n\t\treturn 0;\n\tif (!IS_ERR(nfs4_find_or_create_slot(tbl, max_reqs - 1, ivalue, GFP_NOFS)))\n\t\treturn 0;\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_grow_slot_table(struct nfs4_slot_table *tbl,\n\t\t u32 max_reqs, u32 ivalue)\n{\n\tif (max_reqs <= tbl->max_slots)\n\t\treturn 0;\n\tif (!IS_ERR(nfs4_find_or_create_slot(tbl, max_reqs - 1, ivalue, GFP_NOFS)))\n\t\treturn 0;\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\"",
            "__func__",
            "max_reqs",
            "tbl->max_slots"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_realloc_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 max_reqs, u32 ivalue)\n{\n\tint ret;\n\n\tdprintk(\"--> %s: max_reqs=%u, tbl->max_slots %u\\n\", __func__,\n\t\tmax_reqs, tbl->max_slots);\n\n\tif (max_reqs > NFS4_MAX_SLOT_TABLE)\n\t\tmax_reqs = NFS4_MAX_SLOT_TABLE;\n\n\tret = nfs4_grow_slot_table(tbl, max_reqs, ivalue);\n\tif (ret)\n\t\tgoto out;\n\n\tspin_lock(&tbl->slot_tbl_lock);\n\tnfs4_reset_slot_table(tbl, max_reqs - 1, ivalue);\n\tspin_unlock(&tbl->slot_tbl_lock);\n\n\tdprintk(\"%s: tbl=%p slots=%p max_slots=%u\\n\", __func__,\n\t\ttbl, tbl->slots, tbl->max_slots);\nout:\n\tdprintk(\"<-- %s: return %d\\n\", __func__, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs4_reset_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "184-203",
    "snippet": "static void nfs4_reset_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 server_highest_slotid,\n\t\tu32 ivalue)\n{\n\tstruct nfs4_slot **p;\n\n\tnfs4_shrink_slot_table(tbl, server_highest_slotid + 1);\n\tp = &tbl->slots;\n\twhile (*p) {\n\t\t(*p)->seq_nr = ivalue;\n\t\t(*p)->interrupted = 0;\n\t\tp = &(*p)->next;\n\t}\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\ttbl->target_highest_slotid = server_highest_slotid;\n\ttbl->server_highest_slotid = server_highest_slotid;\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\ttbl->max_slotid = server_highest_slotid;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_shrink_slot_table",
          "args": [
            "tbl",
            "server_highest_slotid + 1"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_shrink_slot_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "37-53",
          "snippet": "static void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_reset_slot_table(struct nfs4_slot_table *tbl,\n\t\tu32 server_highest_slotid,\n\t\tu32 ivalue)\n{\n\tstruct nfs4_slot **p;\n\n\tnfs4_shrink_slot_table(tbl, server_highest_slotid + 1);\n\tp = &tbl->slots;\n\twhile (*p) {\n\t\t(*p)->seq_nr = ivalue;\n\t\t(*p)->interrupted = 0;\n\t\tp = &(*p)->next;\n\t}\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\ttbl->target_highest_slotid = server_highest_slotid;\n\ttbl->server_highest_slotid = server_highest_slotid;\n\ttbl->d_target_highest_slotid = 0;\n\ttbl->d2_target_highest_slotid = 0;\n\ttbl->max_slotid = server_highest_slotid;\n}"
  },
  {
    "function_name": "nfs4_grow_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "174-182",
    "snippet": "static int nfs4_grow_slot_table(struct nfs4_slot_table *tbl,\n\t\t u32 max_reqs, u32 ivalue)\n{\n\tif (max_reqs <= tbl->max_slots)\n\t\treturn 0;\n\tif (!IS_ERR(nfs4_find_or_create_slot(tbl, max_reqs - 1, ivalue, GFP_NOFS)))\n\t\treturn 0;\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nfs4_find_or_create_slot(tbl, max_reqs - 1, ivalue, GFP_NOFS)"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_find_or_create_slot",
          "args": [
            "tbl",
            "max_reqs - 1",
            "ivalue",
            "GFP_NOFS"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_find_or_create_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "116-136",
          "snippet": "static struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic int nfs4_grow_slot_table(struct nfs4_slot_table *tbl,\n\t\t u32 max_reqs, u32 ivalue)\n{\n\tif (max_reqs <= tbl->max_slots)\n\t\treturn 0;\n\tif (!IS_ERR(nfs4_find_or_create_slot(tbl, max_reqs - 1, ivalue, GFP_NOFS)))\n\t\treturn 0;\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "nfs4_alloc_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "147-172",
    "snippet": "struct nfs4_slot *nfs4_alloc_slot(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *ret = ERR_PTR(-EBUSY);\n\tu32 slotid;\n\n\tdprintk(\"--> %s used_slots=%04lx highest_used=%u max_slots=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\ttbl->max_slotid + 1);\n\tslotid = find_first_zero_bit(tbl->used_slots, tbl->max_slotid + 1);\n\tif (slotid > tbl->max_slotid)\n\t\tgoto out;\n\tret = nfs4_find_or_create_slot(tbl, slotid, 1, GFP_NOWAIT);\n\tif (IS_ERR(ret))\n\t\tgoto out;\n\t__set_bit(slotid, tbl->used_slots);\n\tif (slotid > tbl->highest_used_slotid ||\n\t\t\ttbl->highest_used_slotid == NFS4_NO_SLOT)\n\t\ttbl->highest_used_slotid = slotid;\n\tret->generation = tbl->generation;\n\nout:\n\tdprintk(\"<-- %s used_slots=%04lx highest_used=%u slotid=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\t!IS_ERR(ret) ? ret->slot_nr : NFS4_NO_SLOT);\n\treturn ret;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- %s used_slots=%04lx highest_used=%u slotid=%u\\n\"",
            "__func__",
            "tbl->used_slots[0]",
            "tbl->highest_used_slotid",
            "!IS_ERR(ret) ? ret->slot_nr : NFS4_NO_SLOT"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "ret"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "slotid",
            "tbl->used_slots"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "ret"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_find_or_create_slot",
          "args": [
            "tbl",
            "slotid",
            "1",
            "GFP_NOWAIT"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_find_or_create_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "116-136",
          "snippet": "static struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_zero_bit",
          "args": [
            "tbl->used_slots",
            "tbl->max_slotid + 1"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "minix_find_first_zero_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/minix/minix.h",
          "lines": "124-140",
          "snippet": "static inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}",
          "includes": [
            "#include <linux/minix_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define minix_find_first_zero_bit\tfind_first_zero_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/minix_fs.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n\n#define minix_find_first_zero_bit\tfind_first_zero_bit_le\n\nstatic inline int minix_find_first_zero_bit(const void *vaddr, unsigned size)\n{\n\tconst unsigned short *p = vaddr, *addr = vaddr;\n\tunsigned short num;\n\n\tif (!size)\n\t\treturn 0;\n\n\tsize >>= 4;\n\twhile (*p++ == 0xffff) {\n\t\tif (--size == 0)\n\t\t\treturn (p - addr) << 4;\n\t}\n\n\tnum = *--p;\n\treturn ((p - addr) << 4) + ffz(num);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> %s used_slots=%04lx highest_used=%u max_slots=%u\\n\"",
            "__func__",
            "tbl->used_slots[0]",
            "tbl->highest_used_slotid",
            "tbl->max_slotid + 1"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EBUSY"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstruct nfs4_slot *nfs4_alloc_slot(struct nfs4_slot_table *tbl)\n{\n\tstruct nfs4_slot *ret = ERR_PTR(-EBUSY);\n\tu32 slotid;\n\n\tdprintk(\"--> %s used_slots=%04lx highest_used=%u max_slots=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\ttbl->max_slotid + 1);\n\tslotid = find_first_zero_bit(tbl->used_slots, tbl->max_slotid + 1);\n\tif (slotid > tbl->max_slotid)\n\t\tgoto out;\n\tret = nfs4_find_or_create_slot(tbl, slotid, 1, GFP_NOWAIT);\n\tif (IS_ERR(ret))\n\t\tgoto out;\n\t__set_bit(slotid, tbl->used_slots);\n\tif (slotid > tbl->highest_used_slotid ||\n\t\t\ttbl->highest_used_slotid == NFS4_NO_SLOT)\n\t\ttbl->highest_used_slotid = slotid;\n\tret->generation = tbl->generation;\n\nout:\n\tdprintk(\"<-- %s used_slots=%04lx highest_used=%u slotid=%u\\n\",\n\t\t__func__, tbl->used_slots[0], tbl->highest_used_slotid,\n\t\t!IS_ERR(ret) ? ret->slot_nr : NFS4_NO_SLOT);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs4_find_or_create_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "116-136",
    "snippet": "static struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_new_slot",
          "args": [
            "tbl",
            "tbl->max_slots",
            "seq_init",
            "gfp_mask"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_new_slot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "102-114",
          "snippet": "static struct nfs4_slot *nfs4_new_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot *slot;\n\n\tslot = kzalloc(sizeof(*slot), gfp_mask);\n\tif (slot) {\n\t\tslot->table = tbl;\n\t\tslot->slot_nr = slotid;\n\t\tslot->seq_nr = seq_init;\n\t}\n\treturn slot;\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic struct nfs4_slot *nfs4_new_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot *slot;\n\n\tslot = kzalloc(sizeof(*slot), gfp_mask);\n\tif (slot) {\n\t\tslot->table = tbl;\n\t\tslot->slot_nr = slotid;\n\t\tslot->seq_nr = seq_init;\n\t}\n\treturn slot;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic struct nfs4_slot *nfs4_find_or_create_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot **p, *slot;\n\n\tp = &tbl->slots;\n\tfor (;;) {\n\t\tif (*p == NULL) {\n\t\t\t*p = nfs4_new_slot(tbl, tbl->max_slots,\n\t\t\t\t\tseq_init, gfp_mask);\n\t\t\tif (*p == NULL)\n\t\t\t\tbreak;\n\t\t\ttbl->max_slots++;\n\t\t}\n\t\tslot = *p;\n\t\tif (slot->slot_nr == slotid)\n\t\t\treturn slot;\n\t\tp = &slot->next;\n\t}\n\treturn ERR_PTR(-ENOMEM);\n}"
  },
  {
    "function_name": "nfs4_new_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "102-114",
    "snippet": "static struct nfs4_slot *nfs4_new_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot *slot;\n\n\tslot = kzalloc(sizeof(*slot), gfp_mask);\n\tif (slot) {\n\t\tslot->table = tbl;\n\t\tslot->slot_nr = slotid;\n\t\tslot->seq_nr = seq_init;\n\t}\n\treturn slot;\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*slot)",
            "gfp_mask"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic struct nfs4_slot *nfs4_new_slot(struct nfs4_slot_table  *tbl,\n\t\tu32 slotid, u32 seq_init, gfp_t gfp_mask)\n{\n\tstruct nfs4_slot *slot;\n\n\tslot = kzalloc(sizeof(*slot), gfp_mask);\n\tif (slot) {\n\t\tslot->table = tbl;\n\t\tslot->slot_nr = slotid;\n\t\tslot->seq_nr = seq_init;\n\t}\n\treturn slot;\n}"
  },
  {
    "function_name": "nfs4_free_slot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "81-100",
    "snippet": "void nfs4_free_slot(struct nfs4_slot_table *tbl, struct nfs4_slot *slot)\n{\n\tu32 slotid = slot->slot_nr;\n\n\t/* clear used bit in bitmap */\n\t__clear_bit(slotid, tbl->used_slots);\n\n\t/* update highest_used_slotid when it is freed */\n\tif (slotid == tbl->highest_used_slotid) {\n\t\tu32 new_max = find_last_bit(tbl->used_slots, slotid);\n\t\tif (new_max < slotid)\n\t\t\ttbl->highest_used_slotid = new_max;\n\t\telse {\n\t\t\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\t\t\tnfs4_slot_tbl_drain_complete(tbl);\n\t\t}\n\t}\n\tdprintk(\"%s: slotid %u highest_used_slotid %u\\n\", __func__,\n\t\tslotid, tbl->highest_used_slotid);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: slotid %u highest_used_slotid %u\\n\"",
            "__func__",
            "slotid",
            "tbl->highest_used_slotid"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs4_slot_tbl_drain_complete",
          "args": [
            "tbl"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_slot_tbl_drain_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "60-64",
          "snippet": "void nfs4_slot_tbl_drain_complete(struct nfs4_slot_table *tbl)\n{\n\tif (nfs4_slot_tbl_draining(tbl))\n\t\tcomplete(&tbl->complete);\n}",
          "includes": [
            "#include \"callback.h\"",
            "#include \"nfs4session.h\"",
            "#include \"internal.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/module.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_slot_tbl_drain_complete(struct nfs4_slot_table *tbl)\n{\n\tif (nfs4_slot_tbl_draining(tbl))\n\t\tcomplete(&tbl->complete);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_last_bit",
          "args": [
            "tbl->used_slots",
            "slotid"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__clear_bit",
          "args": [
            "slotid",
            "tbl->used_slots"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_free_slot(struct nfs4_slot_table *tbl, struct nfs4_slot *slot)\n{\n\tu32 slotid = slot->slot_nr;\n\n\t/* clear used bit in bitmap */\n\t__clear_bit(slotid, tbl->used_slots);\n\n\t/* update highest_used_slotid when it is freed */\n\tif (slotid == tbl->highest_used_slotid) {\n\t\tu32 new_max = find_last_bit(tbl->used_slots, slotid);\n\t\tif (new_max < slotid)\n\t\t\ttbl->highest_used_slotid = new_max;\n\t\telse {\n\t\t\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\t\t\tnfs4_slot_tbl_drain_complete(tbl);\n\t\t}\n\t}\n\tdprintk(\"%s: slotid %u highest_used_slotid %u\\n\", __func__,\n\t\tslotid, tbl->highest_used_slotid);\n}"
  },
  {
    "function_name": "nfs4_slot_tbl_drain_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "60-64",
    "snippet": "void nfs4_slot_tbl_drain_complete(struct nfs4_slot_table *tbl)\n{\n\tif (nfs4_slot_tbl_draining(tbl))\n\t\tcomplete(&tbl->complete);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&tbl->complete"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_slot_tbl_drain_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
          "lines": "60-64",
          "snippet": "void nfs4_slot_tbl_drain_complete(struct nfs4_slot_table *tbl)\n{\n\tif (nfs4_slot_tbl_draining(tbl))\n\t\tcomplete(&tbl->complete);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_slot_tbl_draining",
          "args": [
            "tbl"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_slot_tbl_draining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "86-89",
          "snippet": "static inline bool nfs4_slot_tbl_draining(struct nfs4_slot_table *tbl)\n{\n\treturn !!test_bit(NFS4_SLOT_TBL_DRAINING, &tbl->slot_tbl_state);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline bool nfs4_slot_tbl_draining(struct nfs4_slot_table *tbl)\n{\n\treturn !!test_bit(NFS4_SLOT_TBL_DRAINING, &tbl->slot_tbl_state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nvoid nfs4_slot_tbl_drain_complete(struct nfs4_slot_table *tbl)\n{\n\tif (nfs4_slot_tbl_draining(tbl))\n\t\tcomplete(&tbl->complete);\n}"
  },
  {
    "function_name": "nfs4_shrink_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "37-53",
    "snippet": "static void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "slot"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_shrink_slot_table(struct nfs4_slot_table  *tbl, u32 newsize)\n{\n\tstruct nfs4_slot **p;\n\tif (newsize >= tbl->max_slots)\n\t\treturn;\n\n\tp = &tbl->slots;\n\twhile (newsize--)\n\t\tp = &(*p)->next;\n\twhile (*p) {\n\t\tstruct nfs4_slot *slot = *p;\n\n\t\t*p = slot->next;\n\t\tkfree(slot);\n\t\ttbl->max_slots--;\n\t}\n}"
  },
  {
    "function_name": "nfs4_init_slot_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.c",
    "lines": "26-32",
    "snippet": "static void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}",
    "includes": [
      "#include \"callback.h\"",
      "#include \"nfs4session.h\"",
      "#include \"internal.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <linux/module.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs4.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/bc_xprt.h>",
      "#include <linux/sunrpc/sched.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&tbl->complete"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_init_priority_wait_queue",
          "args": [
            "&tbl->slot_tbl_waitq",
            "queue"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&tbl->slot_tbl_lock"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"callback.h\"\n#include \"nfs4session.h\"\n#include \"internal.h\"\n#include \"nfs4_fs.h\"\n#include <linux/module.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nstatic void nfs4_init_slot_table(struct nfs4_slot_table *tbl, const char *queue)\n{\n\ttbl->highest_used_slotid = NFS4_NO_SLOT;\n\tspin_lock_init(&tbl->slot_tbl_lock);\n\trpc_init_priority_wait_queue(&tbl->slot_tbl_waitq, queue);\n\tinit_completion(&tbl->complete);\n}"
  }
]