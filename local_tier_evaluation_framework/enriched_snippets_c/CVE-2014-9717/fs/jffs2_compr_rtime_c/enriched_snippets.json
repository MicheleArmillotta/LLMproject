[
  {
    "function_name": "fs2_rtime_exit(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rtime.c",
    "lines": "127-130",
    "snippet": "id jffs2_rtime_exit(void)\n{\n    jffs2_unregister_compressor(&jffs2_rtime_comp);\n}",
    "includes": [
      "nclude \"compr.h\"\n\n/",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/string.h>\n#i",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_rtime_comp = {\n    .priority = JFFS2_RTIME_PRIORITY,\n    .name = \"rtime\",\n    .compr = JFFS2_COMPR_RTIME,\n    .compress = &jffs2_rtime_compress,\n    .decompress = &jffs2_rtime_decompress,\n#ifdef JFFS2_RTIME_DISABLED\n    .disabled = 1,\n#else\n    .disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_unregister_compressor(&",
          "args": [
            "ffs2_rtime_comp);"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\n\n/\nnclude <linux/jffs2.h>\n#i\nnclude <linux/string.h>\n#i\nnclude <linux/errno.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\natic struct jffs2_compressor jffs2_rtime_comp = {\n    .priority = JFFS2_RTIME_PRIORITY,\n    .name = \"rtime\",\n    .compr = JFFS2_COMPR_RTIME,\n    .compress = &jffs2_rtime_compress,\n    .decompress = &jffs2_rtime_decompress,\n#ifdef JFFS2_RTIME_DISABLED\n    .disabled = 1,\n#else\n    .disabled = 0,\n#endif\n};\n\nid jffs2_rtime_exit(void)\n{\n    jffs2_unregister_compressor(&jffs2_rtime_comp);\n}"
  },
  {
    "function_name": "fs2_rtime_init(v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rtime.c",
    "lines": "122-125",
    "snippet": "t jffs2_rtime_init(void)\n{\n    return jffs2_register_compressor(&jffs2_rtime_comp);\n}",
    "includes": [
      "nclude \"compr.h\"\n\n/",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/string.h>\n#i",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [
      "atic struct jffs2_compressor jffs2_rtime_comp = {\n    .priority = JFFS2_RTIME_PRIORITY,\n    .name = \"rtime\",\n    .compr = JFFS2_COMPR_RTIME,\n    .compress = &jffs2_rtime_compress,\n    .decompress = &jffs2_rtime_decompress,\n#ifdef JFFS2_RTIME_DISABLED\n    .disabled = 1,\n#else\n    .disabled = 0,\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fs2_register_compressor(&",
          "args": [
            "ffs2_rtime_comp);"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\n\n/\nnclude <linux/jffs2.h>\n#i\nnclude <linux/string.h>\n#i\nnclude <linux/errno.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\natic struct jffs2_compressor jffs2_rtime_comp = {\n    .priority = JFFS2_RTIME_PRIORITY,\n    .name = \"rtime\",\n    .compr = JFFS2_COMPR_RTIME,\n    .compress = &jffs2_rtime_compress,\n    .decompress = &jffs2_rtime_decompress,\n#ifdef JFFS2_RTIME_DISABLED\n    .disabled = 1,\n#else\n    .disabled = 0,\n#endif\n};\n\nt jffs2_rtime_init(void)\n{\n    return jffs2_register_compressor(&jffs2_rtime_comp);\n}"
  },
  {
    "function_name": "fs2_rtime_decompress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rtime.c",
    "lines": "73-107",
    "snippet": "atic int jffs2_rtime_decompress(unsigned char *data_in,\n\t\t\t\t  unsigned char *cpage_out,\n\t\t\t\t  uint32_t srclen, uint32_t destlen)\n{\n\tunsigned short positions[256];\n\tint outpos = 0;\n\tint pos=0;\n\n\tmemset(positions,0,sizeof(positions));\n\n\twhile (outpos<destlen) {\n\t\tunsigned char value;\n\t\tint backoffs;\n\t\tint repeat;\n\n\t\tvalue = data_in[pos++];\n\t\tcpage_out[outpos++] = value; /* first the verbatim copied byte */\n\t\trepeat = data_in[pos++];\n\t\tbackoffs = positions[value];\n\n\t\tpositions[value]=outpos;\n\t\tif (repeat) {\n\t\t\tif (backoffs + repeat >= outpos) {\n\t\t\t\twhile(repeat) {\n\t\t\t\t\tcpage_out[outpos++] = cpage_out[backoffs++];\n\t\t\t\t\trepeat--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmemcpy(&cpage_out[outpos],&cpage_out[backoffs],repeat);\n\t\t\t\toutpos+=repeat;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"\n\n/",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/string.h>\n#i",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mcpy(&",
          "args": [
            "page_out[outpos],&",
            "page_out[backoffs],r",
            "peat);"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mset(p",
          "args": [
            "sitions,0",
            "s",
            "zeof(positions));"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\n\n/\nnclude <linux/jffs2.h>\n#i\nnclude <linux/string.h>\n#i\nnclude <linux/errno.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\natic int jffs2_rtime_decompress(unsigned char *data_in,\n\t\t\t\t  unsigned char *cpage_out,\n\t\t\t\t  uint32_t srclen, uint32_t destlen)\n{\n\tunsigned short positions[256];\n\tint outpos = 0;\n\tint pos=0;\n\n\tmemset(positions,0,sizeof(positions));\n\n\twhile (outpos<destlen) {\n\t\tunsigned char value;\n\t\tint backoffs;\n\t\tint repeat;\n\n\t\tvalue = data_in[pos++];\n\t\tcpage_out[outpos++] = value; /* first the verbatim copied byte */\n\t\trepeat = data_in[pos++];\n\t\tbackoffs = positions[value];\n\n\t\tpositions[value]=outpos;\n\t\tif (repeat) {\n\t\t\tif (backoffs + repeat >= outpos) {\n\t\t\t\twhile(repeat) {\n\t\t\t\t\tcpage_out[outpos++] = cpage_out[backoffs++];\n\t\t\t\t\trepeat--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmemcpy(&cpage_out[outpos],&cpage_out[backoffs],repeat);\n\t\t\t\toutpos+=repeat;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "fs2_rtime_compress(u",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/jffs2/compr_rtime.c",
    "lines": "32-70",
    "snippet": "atic int jffs2_rtime_compress(unsigned char *data_in,\n\t\t\t\tunsigned char *cpage_out,\n\t\t\t\tuint32_t *sourcelen, uint32_t *dstlen)\n{\n\tunsigned short positions[256];\n\tint outpos = 0;\n\tint pos=0;\n\n\tmemset(positions,0,sizeof(positions));\n\n\twhile (pos < (*sourcelen) && outpos <= (*dstlen)-2) {\n\t\tint backpos, runlen=0;\n\t\tunsigned char value;\n\n\t\tvalue = data_in[pos];\n\n\t\tcpage_out[outpos++] = data_in[pos++];\n\n\t\tbackpos = positions[value];\n\t\tpositions[value]=pos;\n\n\t\twhile ((backpos < pos) && (pos < (*sourcelen)) &&\n\t\t       (data_in[pos]==data_in[backpos++]) && (runlen<255)) {\n\t\t\tpos++;\n\t\t\trunlen++;\n\t\t}\n\t\tcpage_out[outpos++] = runlen;\n\t}\n\n\tif (outpos >= pos) {\n\t\t/* We failed */\n\t\treturn -1;\n\t}\n\n\t/* Tell the caller how much we managed to compress, and how much space it took */\n\t*sourcelen = pos;\n\t*dstlen = outpos;\n\treturn 0;\n}",
    "includes": [
      "nclude \"compr.h\"\n\n/",
      "nclude <linux/jffs2.h>\n#i",
      "nclude <linux/string.h>\n#i",
      "nclude <linux/errno.h>\n#i",
      "nclude <linux/types.h>\n#i",
      "nclude <linux/kernel.h>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mset(p",
          "args": [
            "sitions,0",
            "s",
            "zeof(positions));"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"compr.h\"\n\n/\nnclude <linux/jffs2.h>\n#i\nnclude <linux/string.h>\n#i\nnclude <linux/errno.h>\n#i\nnclude <linux/types.h>\n#i\nnclude <linux/kernel.h>\n#i\n\natic int jffs2_rtime_compress(unsigned char *data_in,\n\t\t\t\tunsigned char *cpage_out,\n\t\t\t\tuint32_t *sourcelen, uint32_t *dstlen)\n{\n\tunsigned short positions[256];\n\tint outpos = 0;\n\tint pos=0;\n\n\tmemset(positions,0,sizeof(positions));\n\n\twhile (pos < (*sourcelen) && outpos <= (*dstlen)-2) {\n\t\tint backpos, runlen=0;\n\t\tunsigned char value;\n\n\t\tvalue = data_in[pos];\n\n\t\tcpage_out[outpos++] = data_in[pos++];\n\n\t\tbackpos = positions[value];\n\t\tpositions[value]=pos;\n\n\t\twhile ((backpos < pos) && (pos < (*sourcelen)) &&\n\t\t       (data_in[pos]==data_in[backpos++]) && (runlen<255)) {\n\t\t\tpos++;\n\t\t\trunlen++;\n\t\t}\n\t\tcpage_out[outpos++] = runlen;\n\t}\n\n\tif (outpos >= pos) {\n\t\t/* We failed */\n\t\treturn -1;\n\t}\n\n\t/* Tell the caller how much we managed to compress, and how much space it took */\n\t*sourcelen = pos;\n\t*dstlen = outpos;\n\treturn 0;\n}"
  }
]