[
  {
    "function_name": "hfsplus_show_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
    "lines": "216-238",
    "snippet": "int hfsplus_show_options(struct seq_file *seq, struct dentry *root)\n{\n\tstruct hfsplus_sb_info *sbi = HFSPLUS_SB(root->d_sb);\n\n\tif (sbi->creator != HFSPLUS_DEF_CR_TYPE)\n\t\tseq_printf(seq, \",creator=%.4s\", (char *)&sbi->creator);\n\tif (sbi->type != HFSPLUS_DEF_CR_TYPE)\n\t\tseq_printf(seq, \",type=%.4s\", (char *)&sbi->type);\n\tseq_printf(seq, \",umask=%o,uid=%u,gid=%u\", sbi->umask,\n\t\t\tfrom_kuid_munged(&init_user_ns, sbi->uid),\n\t\t\tfrom_kgid_munged(&init_user_ns, sbi->gid));\n\tif (sbi->part >= 0)\n\t\tseq_printf(seq, \",part=%u\", sbi->part);\n\tif (sbi->session >= 0)\n\t\tseq_printf(seq, \",session=%u\", sbi->session);\n\tif (sbi->nls)\n\t\tseq_printf(seq, \",nls=%s\", sbi->nls->charset);\n\tif (test_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags))\n\t\tseq_puts(seq, \",nodecompose\");\n\tif (test_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags))\n\t\tseq_puts(seq, \",nobarrier\");\n\treturn 0;\n}",
    "includes": [
      "#include \"hfsplus_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>",
      "#include <linux/nls.h>",
      "#include <linux/parser.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "seq",
            "\",nobarrier\""
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HFSPLUS_SB_NOBARRIER",
            "&sbi->flags"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",nls=%s\"",
            "sbi->nls->charset"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "&init_user_ns",
            "sbi->gid"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "&init_user_ns",
            "sbi->uid"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HFSPLUS_SB",
          "args": [
            "root->d_sb"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "HFSPLUS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/hfsplus_fs.h",
          "lines": "202-205",
          "snippet": "static inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"hfsplus_raw.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/mutex.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_raw.h\"\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/fs.h>\n\nstatic inline struct hfsplus_sb_info *HFSPLUS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nint hfsplus_show_options(struct seq_file *seq, struct dentry *root)\n{\n\tstruct hfsplus_sb_info *sbi = HFSPLUS_SB(root->d_sb);\n\n\tif (sbi->creator != HFSPLUS_DEF_CR_TYPE)\n\t\tseq_printf(seq, \",creator=%.4s\", (char *)&sbi->creator);\n\tif (sbi->type != HFSPLUS_DEF_CR_TYPE)\n\t\tseq_printf(seq, \",type=%.4s\", (char *)&sbi->type);\n\tseq_printf(seq, \",umask=%o,uid=%u,gid=%u\", sbi->umask,\n\t\t\tfrom_kuid_munged(&init_user_ns, sbi->uid),\n\t\t\tfrom_kgid_munged(&init_user_ns, sbi->gid));\n\tif (sbi->part >= 0)\n\t\tseq_printf(seq, \",part=%u\", sbi->part);\n\tif (sbi->session >= 0)\n\t\tseq_printf(seq, \",session=%u\", sbi->session);\n\tif (sbi->nls)\n\t\tseq_printf(seq, \",nls=%s\", sbi->nls->charset);\n\tif (test_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags))\n\t\tseq_puts(seq, \",nodecompose\");\n\tif (test_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags))\n\t\tseq_puts(seq, \",nobarrier\");\n\treturn 0;\n}"
  },
  {
    "function_name": "hfsplus_parse_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
    "lines": "99-214",
    "snippet": "int hfsplus_parse_options(char *input, struct hfsplus_sb_info *sbi)\n{\n\tchar *p;\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint tmp, token;\n\n\tif (!input)\n\t\tgoto done;\n\n\twhile ((p = strsep(&input, \",\")) != NULL) {\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase opt_creator:\n\t\t\tif (match_fourchar(&args[0], &sbi->creator)) {\n\t\t\t\tpr_err(\"creator requires a 4 character value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_type:\n\t\t\tif (match_fourchar(&args[0], &sbi->type)) {\n\t\t\t\tpr_err(\"type requires a 4 character value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_umask:\n\t\t\tif (match_octal(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"umask requires a value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->umask = (umode_t)tmp;\n\t\t\tbreak;\n\t\tcase opt_uid:\n\t\t\tif (match_int(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"uid requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->uid = make_kuid(current_user_ns(), (uid_t)tmp);\n\t\t\tif (!uid_valid(sbi->uid)) {\n\t\t\t\tpr_err(\"invalid uid specified\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_gid:\n\t\t\tif (match_int(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"gid requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->gid = make_kgid(current_user_ns(), (gid_t)tmp);\n\t\t\tif (!gid_valid(sbi->gid)) {\n\t\t\t\tpr_err(\"invalid gid specified\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_part:\n\t\t\tif (match_int(&args[0], &sbi->part)) {\n\t\t\t\tpr_err(\"part requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_session:\n\t\t\tif (match_int(&args[0], &sbi->session)) {\n\t\t\t\tpr_err(\"session requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_nls:\n\t\t\tif (sbi->nls) {\n\t\t\t\tpr_err(\"unable to change nls mapping\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tp = match_strdup(&args[0]);\n\t\t\tif (p)\n\t\t\t\tsbi->nls = load_nls(p);\n\t\t\tif (!sbi->nls) {\n\t\t\t\tpr_err(\"unable to load nls mapping \\\"%s\\\"\\n\",\n\t\t\t\t       p);\n\t\t\t\tkfree(p);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\tcase opt_decompose:\n\t\t\tclear_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_nodecompose:\n\t\t\tset_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_barrier:\n\t\t\tclear_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_nobarrier:\n\t\t\tset_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_force:\n\t\t\tset_bit(HFSPLUS_SB_FORCE, &sbi->flags);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn 0;\n\t\t}\n\t}\n\ndone:\n\tif (!sbi->nls) {\n\t\t/* try utf8 first, as this is the old default behaviour */\n\t\tsbi->nls = load_nls(\"utf8\");\n\t\tif (!sbi->nls)\n\t\t\tsbi->nls = load_nls_default();\n\t\tif (!sbi->nls)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"hfsplus_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>",
      "#include <linux/nls.h>",
      "#include <linux/parser.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t tokens = {\n\t{ opt_creator, \"creator=%s\" },\n\t{ opt_type, \"type=%s\" },\n\t{ opt_umask, \"umask=%o\" },\n\t{ opt_uid, \"uid=%u\" },\n\t{ opt_gid, \"gid=%u\" },\n\t{ opt_part, \"part=%u\" },\n\t{ opt_session, \"session=%u\" },\n\t{ opt_nls, \"nls=%s\" },\n\t{ opt_decompose, \"decompose\" },\n\t{ opt_nodecompose, \"nodecompose\" },\n\t{ opt_barrier, \"barrier\" },\n\t{ opt_nobarrier, \"nobarrier\" },\n\t{ opt_force, \"force\" },\n\t{ opt_err, NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "load_nls_default",
          "args": [],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "load_nls_default",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_base.c",
          "lines": "532-541",
          "snippet": "struct nls_table *load_nls_default(void)\n{\n\tstruct nls_table *default_nls;\n\t\n\tdefault_nls = load_nls(CONFIG_NLS_DEFAULT);\n\tif (default_nls != NULL)\n\t\treturn default_nls;\n\telse\n\t\treturn &default_table;\n}",
          "includes": [
            "#include <asm/byteorder.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kmod.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct nls_table default_table;",
            "static struct nls_table default_table = {\n\t.charset\t= \"default\",\n\t.uni2char\t= uni2char,\n\t.char2uni\t= char2uni,\n\t.charset2lower\t= charset2lower,\n\t.charset2upper\t= charset2upper,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n#include <linux/spinlock.h>\n#include <linux/kmod.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nstatic struct nls_table default_table;\nstatic struct nls_table default_table = {\n\t.charset\t= \"default\",\n\t.uni2char\t= uni2char,\n\t.char2uni\t= char2uni,\n\t.charset2lower\t= charset2lower,\n\t.charset2upper\t= charset2upper,\n};\n\nstruct nls_table *load_nls_default(void)\n{\n\tstruct nls_table *default_nls;\n\t\n\tdefault_nls = load_nls(CONFIG_NLS_DEFAULT);\n\tif (default_nls != NULL)\n\t\treturn default_nls;\n\telse\n\t\treturn &default_table;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_nls",
          "args": [
            "\"utf8\""
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "unload_nls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_base.c",
          "lines": "296-300",
          "snippet": "void unload_nls(struct nls_table *nls)\n{\n\tif (nls)\n\t\tmodule_put(nls->owner);\n}",
          "includes": [
            "#include <asm/byteorder.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kmod.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n#include <linux/spinlock.h>\n#include <linux/kmod.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid unload_nls(struct nls_table *nls)\n{\n\tif (nls)\n\t\tmodule_put(nls->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "HFSPLUS_SB_FORCE",
            "&sbi->flags"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "HFSPLUS_SB_NOBARRIER",
            "&sbi->flags"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "p"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "p"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"unable to load nls mapping \\\"%s\\\"\\n\"",
            "p"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "&args[0]"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"unable to change nls mapping\\n\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"session requires an argument\\n\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_int",
          "args": [
            "&args[0]",
            "&sbi->session"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"part requires an argument\\n\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_int",
          "args": [
            "&args[0]",
            "&sbi->part"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"invalid gid specified\\n\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "sbi->gid"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "current_user_ns()",
            "(gid_t)tmp"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"gid requires an argument\\n\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_int",
          "args": [
            "&args[0]",
            "&tmp"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"invalid uid specified\\n\""
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "sbi->uid"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "current_user_ns()",
            "(uid_t)tmp"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"uid requires an argument\\n\""
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_int",
          "args": [
            "&args[0]",
            "&tmp"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"umask requires a value\\n\""
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_octal",
          "args": [
            "&args[0]",
            "&tmp"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"type requires a 4 character value\\n\""
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_fourchar",
          "args": [
            "&args[0]",
            "&sbi->type"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "match_fourchar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
          "lines": "63-69",
          "snippet": "static inline int match_fourchar(substring_t *arg, u32 *result)\n{\n\tif (arg->to - arg->from != 4)\n\t\treturn -EINVAL;\n\tmemcpy(result, arg->from, 4);\n\treturn 0;\n}",
          "includes": [
            "#include \"hfsplus_fs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/mount.h>",
            "#include <linux/nls.h>",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nstatic inline int match_fourchar(substring_t *arg, u32 *result)\n{\n\tif (arg->to - arg->from != 4)\n\t\treturn -EINVAL;\n\tmemcpy(result, arg->from, 4);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"creator requires a 4 character value\\n\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "p",
            "tokens",
            "args"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&input",
            "\",\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nstatic const match_table_t tokens = {\n\t{ opt_creator, \"creator=%s\" },\n\t{ opt_type, \"type=%s\" },\n\t{ opt_umask, \"umask=%o\" },\n\t{ opt_uid, \"uid=%u\" },\n\t{ opt_gid, \"gid=%u\" },\n\t{ opt_part, \"part=%u\" },\n\t{ opt_session, \"session=%u\" },\n\t{ opt_nls, \"nls=%s\" },\n\t{ opt_decompose, \"decompose\" },\n\t{ opt_nodecompose, \"nodecompose\" },\n\t{ opt_barrier, \"barrier\" },\n\t{ opt_nobarrier, \"nobarrier\" },\n\t{ opt_force, \"force\" },\n\t{ opt_err, NULL }\n};\n\nint hfsplus_parse_options(char *input, struct hfsplus_sb_info *sbi)\n{\n\tchar *p;\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint tmp, token;\n\n\tif (!input)\n\t\tgoto done;\n\n\twhile ((p = strsep(&input, \",\")) != NULL) {\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase opt_creator:\n\t\t\tif (match_fourchar(&args[0], &sbi->creator)) {\n\t\t\t\tpr_err(\"creator requires a 4 character value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_type:\n\t\t\tif (match_fourchar(&args[0], &sbi->type)) {\n\t\t\t\tpr_err(\"type requires a 4 character value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_umask:\n\t\t\tif (match_octal(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"umask requires a value\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->umask = (umode_t)tmp;\n\t\t\tbreak;\n\t\tcase opt_uid:\n\t\t\tif (match_int(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"uid requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->uid = make_kuid(current_user_ns(), (uid_t)tmp);\n\t\t\tif (!uid_valid(sbi->uid)) {\n\t\t\t\tpr_err(\"invalid uid specified\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_gid:\n\t\t\tif (match_int(&args[0], &tmp)) {\n\t\t\t\tpr_err(\"gid requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsbi->gid = make_kgid(current_user_ns(), (gid_t)tmp);\n\t\t\tif (!gid_valid(sbi->gid)) {\n\t\t\t\tpr_err(\"invalid gid specified\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_part:\n\t\t\tif (match_int(&args[0], &sbi->part)) {\n\t\t\t\tpr_err(\"part requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_session:\n\t\t\tif (match_int(&args[0], &sbi->session)) {\n\t\t\t\tpr_err(\"session requires an argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opt_nls:\n\t\t\tif (sbi->nls) {\n\t\t\t\tpr_err(\"unable to change nls mapping\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tp = match_strdup(&args[0]);\n\t\t\tif (p)\n\t\t\t\tsbi->nls = load_nls(p);\n\t\t\tif (!sbi->nls) {\n\t\t\t\tpr_err(\"unable to load nls mapping \\\"%s\\\"\\n\",\n\t\t\t\t       p);\n\t\t\t\tkfree(p);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\tcase opt_decompose:\n\t\t\tclear_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_nodecompose:\n\t\t\tset_bit(HFSPLUS_SB_NODECOMPOSE, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_barrier:\n\t\t\tclear_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_nobarrier:\n\t\t\tset_bit(HFSPLUS_SB_NOBARRIER, &sbi->flags);\n\t\t\tbreak;\n\t\tcase opt_force:\n\t\t\tset_bit(HFSPLUS_SB_FORCE, &sbi->flags);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn 0;\n\t\t}\n\t}\n\ndone:\n\tif (!sbi->nls) {\n\t\t/* try utf8 first, as this is the old default behaviour */\n\t\tsbi->nls = load_nls(\"utf8\");\n\t\tif (!sbi->nls)\n\t\t\tsbi->nls = load_nls_default();\n\t\tif (!sbi->nls)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "hfsplus_parse_options_remount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
    "lines": "71-95",
    "snippet": "int hfsplus_parse_options_remount(char *input, int *force)\n{\n\tchar *p;\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint token;\n\n\tif (!input)\n\t\treturn 1;\n\n\twhile ((p = strsep(&input, \",\")) != NULL) {\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase opt_force:\n\t\t\t*force = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"hfsplus_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>",
      "#include <linux/nls.h>",
      "#include <linux/parser.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t tokens = {\n\t{ opt_creator, \"creator=%s\" },\n\t{ opt_type, \"type=%s\" },\n\t{ opt_umask, \"umask=%o\" },\n\t{ opt_uid, \"uid=%u\" },\n\t{ opt_gid, \"gid=%u\" },\n\t{ opt_part, \"part=%u\" },\n\t{ opt_session, \"session=%u\" },\n\t{ opt_nls, \"nls=%s\" },\n\t{ opt_decompose, \"decompose\" },\n\t{ opt_nodecompose, \"nodecompose\" },\n\t{ opt_barrier, \"barrier\" },\n\t{ opt_nobarrier, \"nobarrier\" },\n\t{ opt_force, \"force\" },\n\t{ opt_err, NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "p",
            "tokens",
            "args"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&input",
            "\",\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nstatic const match_table_t tokens = {\n\t{ opt_creator, \"creator=%s\" },\n\t{ opt_type, \"type=%s\" },\n\t{ opt_umask, \"umask=%o\" },\n\t{ opt_uid, \"uid=%u\" },\n\t{ opt_gid, \"gid=%u\" },\n\t{ opt_part, \"part=%u\" },\n\t{ opt_session, \"session=%u\" },\n\t{ opt_nls, \"nls=%s\" },\n\t{ opt_decompose, \"decompose\" },\n\t{ opt_nodecompose, \"nodecompose\" },\n\t{ opt_barrier, \"barrier\" },\n\t{ opt_nobarrier, \"nobarrier\" },\n\t{ opt_force, \"force\" },\n\t{ opt_err, NULL }\n};\n\nint hfsplus_parse_options_remount(char *input, int *force)\n{\n\tchar *p;\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint token;\n\n\tif (!input)\n\t\treturn 1;\n\n\twhile ((p = strsep(&input, \",\")) != NULL) {\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(p, tokens, args);\n\t\tswitch (token) {\n\t\tcase opt_force:\n\t\t\t*force = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "match_fourchar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
    "lines": "63-69",
    "snippet": "static inline int match_fourchar(substring_t *arg, u32 *result)\n{\n\tif (arg->to - arg->from != 4)\n\t\treturn -EINVAL;\n\tmemcpy(result, arg->from, 4);\n\treturn 0;\n}",
    "includes": [
      "#include \"hfsplus_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>",
      "#include <linux/nls.h>",
      "#include <linux/parser.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "result",
            "arg->from",
            "4"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nstatic inline int match_fourchar(substring_t *arg, u32 *result)\n{\n\tif (arg->to - arg->from != 4)\n\t\treturn -EINVAL;\n\tmemcpy(result, arg->from, 4);\n\treturn 0;\n}"
  },
  {
    "function_name": "hfsplus_fill_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfsplus/options.c",
    "lines": "48-60",
    "snippet": "void hfsplus_fill_defaults(struct hfsplus_sb_info *opts)\n{\n\tif (!opts)\n\t\treturn;\n\n\topts->creator = HFSPLUS_DEF_CR_TYPE;\n\topts->type = HFSPLUS_DEF_CR_TYPE;\n\topts->umask = current_umask();\n\topts->uid = current_uid();\n\topts->gid = current_gid();\n\topts->part = -1;\n\topts->session = -1;\n}",
    "includes": [
      "#include \"hfsplus_fs.h\"",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>",
      "#include <linux/nls.h>",
      "#include <linux/parser.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_gid",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_uid",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_umask",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "current_umask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fs_struct.c",
          "lines": "154-157",
          "snippet": "int current_umask(void)\n{\n\treturn current->fs->umask;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/fs_struct.h>",
            "#include <linux/slab.h>",
            "#include <linux/path.h>",
            "#include <linux/fs.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/fs_struct.h>\n#include <linux/slab.h>\n#include <linux/path.h>\n#include <linux/fs.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n\nint current_umask(void)\n{\n\treturn current->fs->umask;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hfsplus_fs.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n#include <linux/nls.h>\n#include <linux/parser.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/string.h>\n\nvoid hfsplus_fill_defaults(struct hfsplus_sb_info *opts)\n{\n\tif (!opts)\n\t\treturn;\n\n\topts->creator = HFSPLUS_DEF_CR_TYPE;\n\topts->type = HFSPLUS_DEF_CR_TYPE;\n\topts->umask = current_umask();\n\topts->uid = current_uid();\n\topts->gid = current_gid();\n\topts->part = -1;\n\topts->session = -1;\n}"
  }
]