[
  {
    "function_name": "isofs_fh_to_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
    "lines": "173-185",
    "snippet": "static struct dentry *isofs_fh_to_parent(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct isofs_fid *ifid = (struct isofs_fid *)fid;\n\n\tif (fh_len < 2 || fh_type != 2)\n\t\treturn NULL;\n\n\treturn isofs_export_iget(sb,\n\t\t\tfh_len > 2 ? ifid->parent_block : 0,\n\t\t\tifid->parent_offset,\n\t\t\tfh_len > 4 ? ifid->parent_generation : 0);\n}",
    "includes": [
      "#include \"isofs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isofs_export_iget",
          "args": [
            "sb",
            "fh_len > 2 ? ifid->parent_block : 0",
            "ifid->parent_offset",
            "fh_len > 4 ? ifid->parent_generation : 0"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "isofs_export_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
          "lines": "18-36",
          "snippet": "static struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}",
          "includes": [
            "#include \"isofs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *isofs_fh_to_parent(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct isofs_fid *ifid = (struct isofs_fid *)fid;\n\n\tif (fh_len < 2 || fh_type != 2)\n\t\treturn NULL;\n\n\treturn isofs_export_iget(sb,\n\t\t\tfh_len > 2 ? ifid->parent_block : 0,\n\t\t\tifid->parent_offset,\n\t\t\tfh_len > 4 ? ifid->parent_generation : 0);\n}"
  },
  {
    "function_name": "isofs_fh_to_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
    "lines": "161-171",
    "snippet": "static struct dentry *isofs_fh_to_dentry(struct super_block *sb,\n\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct isofs_fid *ifid = (struct isofs_fid *)fid;\n\n\tif (fh_len < 3 || fh_type > 2)\n\t\treturn NULL;\n\n\treturn isofs_export_iget(sb, ifid->block, ifid->offset,\n\t\t\tifid->generation);\n}",
    "includes": [
      "#include \"isofs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isofs_export_iget",
          "args": [
            "sb",
            "ifid->block",
            "ifid->offset",
            "ifid->generation"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "isofs_export_iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
          "lines": "18-36",
          "snippet": "static struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}",
          "includes": [
            "#include \"isofs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *isofs_fh_to_dentry(struct super_block *sb,\n\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct isofs_fid *ifid = (struct isofs_fid *)fid;\n\n\tif (fh_len < 3 || fh_type > 2)\n\t\treturn NULL;\n\n\treturn isofs_export_iget(sb, ifid->block, ifid->offset,\n\t\t\tifid->generation);\n}"
  },
  {
    "function_name": "isofs_export_encode_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
    "lines": "109-150",
    "snippet": "static int\nisofs_export_encode_fh(struct inode *inode,\n\t\t       __u32 *fh32,\n\t\t       int *max_len,\n\t\t       struct inode *parent)\n{\n\tstruct iso_inode_info * ei = ISOFS_I(inode);\n\tint len = *max_len;\n\tint type = 1;\n\t__u16 *fh16 = (__u16*)fh32;\n\n\t/*\n\t * WARNING: max_len is 5 for NFSv2.  Because of this\n\t * limitation, we use the lower 16 bits of fh32[1] to hold the\n\t * offset of the inode and the upper 16 bits of fh32[1] to\n\t * hold the offset of the parent.\n\t */\n\tif (parent && (len < 5)) {\n\t\t*max_len = 5;\n\t\treturn FILEID_INVALID;\n\t} else if (len < 3) {\n\t\t*max_len = 3;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tlen = 3;\n\tfh32[0] = ei->i_iget5_block;\n \tfh16[2] = (__u16)ei->i_iget5_offset;  /* fh16 [sic] */\n\tfh16[3] = 0;  /* avoid leaking uninitialized data */\n\tfh32[2] = inode->i_generation;\n\tif (parent) {\n\t\tstruct iso_inode_info *eparent;\n\t\teparent = ISOFS_I(parent);\n\t\tfh32[3] = eparent->i_iget5_block;\n\t\tfh16[3] = (__u16)eparent->i_iget5_offset;  /* fh16 [sic] */\n\t\tfh32[4] = parent->i_generation;\n\t\tlen = 5;\n\t\ttype = 2;\n\t}\n\t*max_len = len;\n\treturn type;\n}",
    "includes": [
      "#include \"isofs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ISOFS_I",
          "args": [
            "parent"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "ISOFS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "67-70",
          "snippet": "static inline struct iso_inode_info *ISOFS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct iso_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);",
            "extern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);",
            "int get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);",
            "int get_acorn_filename(struct iso_directory_record *, char *, struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nextern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);\nextern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);\nint get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);\nint get_acorn_filename(struct iso_directory_record *, char *, struct inode *);\n\nstatic inline struct iso_inode_info *ISOFS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct iso_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n\nstatic int\nisofs_export_encode_fh(struct inode *inode,\n\t\t       __u32 *fh32,\n\t\t       int *max_len,\n\t\t       struct inode *parent)\n{\n\tstruct iso_inode_info * ei = ISOFS_I(inode);\n\tint len = *max_len;\n\tint type = 1;\n\t__u16 *fh16 = (__u16*)fh32;\n\n\t/*\n\t * WARNING: max_len is 5 for NFSv2.  Because of this\n\t * limitation, we use the lower 16 bits of fh32[1] to hold the\n\t * offset of the inode and the upper 16 bits of fh32[1] to\n\t * hold the offset of the parent.\n\t */\n\tif (parent && (len < 5)) {\n\t\t*max_len = 5;\n\t\treturn FILEID_INVALID;\n\t} else if (len < 3) {\n\t\t*max_len = 3;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tlen = 3;\n\tfh32[0] = ei->i_iget5_block;\n \tfh16[2] = (__u16)ei->i_iget5_offset;  /* fh16 [sic] */\n\tfh16[3] = 0;  /* avoid leaking uninitialized data */\n\tfh32[2] = inode->i_generation;\n\tif (parent) {\n\t\tstruct iso_inode_info *eparent;\n\t\teparent = ISOFS_I(parent);\n\t\tfh32[3] = eparent->i_iget5_block;\n\t\tfh16[3] = (__u16)eparent->i_iget5_offset;  /* fh16 [sic] */\n\t\tfh32[4] = parent->i_generation;\n\t\tlen = 5;\n\t\ttype = 2;\n\t}\n\t*max_len = len;\n\treturn type;\n}"
  },
  {
    "function_name": "isofs_export_get_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
    "lines": "43-107",
    "snippet": "static struct dentry *isofs_export_get_parent(struct dentry *child)\n{\n\tunsigned long parent_block = 0;\n\tunsigned long parent_offset = 0;\n\tstruct inode *child_inode = child->d_inode;\n\tstruct iso_inode_info *e_child_inode = ISOFS_I(child_inode);\n\tstruct iso_directory_record *de = NULL;\n\tstruct buffer_head * bh = NULL;\n\tstruct dentry *rv = NULL;\n\n\t/* \"child\" must always be a directory. */\n\tif (!S_ISDIR(child_inode->i_mode)) {\n\t\tprintk(KERN_ERR \"isofs: isofs_export_get_parent(): \"\n\t\t       \"child is not a directory!\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* It is an invariant that the directory offset is zero.  If\n\t * it is not zero, it means the directory failed to be\n\t * normalized for some reason. */\n\tif (e_child_inode->i_iget5_offset != 0) {\n\t\tprintk(KERN_ERR \"isofs: isofs_export_get_parent(): \"\n\t\t       \"child directory not normalized!\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* The child inode has been normalized such that its\n\t * i_iget5_block value points to the \".\" entry.  Fortunately,\n\t * the \"..\" entry is located in the same block. */\n\tparent_block = e_child_inode->i_iget5_block;\n\n\t/* Get the block in question. */\n\tbh = sb_bread(child_inode->i_sb, parent_block);\n\tif (bh == NULL) {\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* This is the \".\" entry. */\n\tde = (struct iso_directory_record*)bh->b_data;\n\n\t/* The \"..\" entry is always the second entry. */\n\tparent_offset = (unsigned long)isonum_711(de->length);\n\tde = (struct iso_directory_record*)(bh->b_data + parent_offset);\n\n\t/* Verify it is in fact the \"..\" entry. */\n\tif ((isonum_711(de->name_len) != 1) || (de->name[0] != 1)) {\n\t\tprintk(KERN_ERR \"isofs: Unable to find the \\\"..\\\" \"\n\t\t       \"directory for NFS.\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* Normalize */\n\tisofs_normalize_block_and_offset(de, &parent_block, &parent_offset);\n\n\trv = d_obtain_alias(isofs_iget(child_inode->i_sb, parent_block,\n\t\t\t\t     parent_offset));\n out:\n\tif (bh)\n\t\tbrelse(bh);\n\treturn rv;\n}",
    "includes": [
      "#include \"isofs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_obtain_alias",
          "args": [
            "isofs_iget(child_inode->i_sb, parent_block,\n\t\t\t\t     parent_offset)"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "d_obtain_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1977-1980",
          "snippet": "struct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isofs_iget",
          "args": [
            "child_inode->i_sb",
            "parent_block",
            "parent_offset"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "isofs_iget_reloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "133-138",
          "snippet": "static inline struct inode *isofs_iget_reloc(struct super_block *sb,\n\t\t\t\t\t     unsigned long block,\n\t\t\t\t\t     unsigned long offset)\n{\n\treturn __isofs_iget(sb, block, offset, 1);\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);",
            "extern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);",
            "int get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);",
            "int get_acorn_filename(struct iso_directory_record *, char *, struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nextern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);\nextern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);\nint get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);\nint get_acorn_filename(struct iso_directory_record *, char *, struct inode *);\n\nstatic inline struct inode *isofs_iget_reloc(struct super_block *sb,\n\t\t\t\t\t     unsigned long block,\n\t\t\t\t\t     unsigned long offset)\n{\n\treturn __isofs_iget(sb, block, offset, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isofs_normalize_block_and_offset",
          "args": [
            "de",
            "&parent_block",
            "&parent_offset"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "isofs_normalize_block_and_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "182-193",
          "snippet": "static inline void\nisofs_normalize_block_and_offset(struct iso_directory_record* de,\n\t\t\t\t unsigned long *block,\n\t\t\t\t unsigned long *offset)\n{\n\t/* Only directories are normalized. */\n\tif (de->flags[0] & 2) {\n\t\t*offset = 0;\n\t\t*block = (unsigned long)isonum_733(de->extent)\n\t\t\t+ (unsigned long)isonum_711(de->ext_attr_length);\n\t}\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct dentry *isofs_lookup(struct inode *, struct dentry *, unsigned int flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nextern struct dentry *isofs_lookup(struct inode *, struct dentry *, unsigned int flags);\n\nstatic inline void\nisofs_normalize_block_and_offset(struct iso_directory_record* de,\n\t\t\t\t unsigned long *block,\n\t\t\t\t unsigned long *offset)\n{\n\t/* Only directories are normalized. */\n\tif (de->flags[0] & 2) {\n\t\t*offset = 0;\n\t\t*block = (unsigned long)isonum_733(de->extent)\n\t\t\t+ (unsigned long)isonum_711(de->ext_attr_length);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"isofs: Unable to find the \\\"..\\\" \"\n\t\t       \"directory for NFS.\\n\""
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isonum_711",
          "args": [
            "de->name_len"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "isonum_711",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "72-75",
          "snippet": "static inline int isonum_711(char *p)\n{\n\treturn *(u8 *)p;\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int isonum_711(char *p)\n{\n\treturn *(u8 *)p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "child_inode->i_sb",
            "parent_block"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "child_inode->i_mode"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISOFS_I",
          "args": [
            "child_inode"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "ISOFS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "67-70",
          "snippet": "static inline struct iso_inode_info *ISOFS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct iso_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);",
            "extern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);",
            "int get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);",
            "int get_acorn_filename(struct iso_directory_record *, char *, struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nextern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);\nextern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);\nint get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);\nint get_acorn_filename(struct iso_directory_record *, char *, struct inode *);\n\nstatic inline struct iso_inode_info *ISOFS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct iso_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *isofs_export_get_parent(struct dentry *child)\n{\n\tunsigned long parent_block = 0;\n\tunsigned long parent_offset = 0;\n\tstruct inode *child_inode = child->d_inode;\n\tstruct iso_inode_info *e_child_inode = ISOFS_I(child_inode);\n\tstruct iso_directory_record *de = NULL;\n\tstruct buffer_head * bh = NULL;\n\tstruct dentry *rv = NULL;\n\n\t/* \"child\" must always be a directory. */\n\tif (!S_ISDIR(child_inode->i_mode)) {\n\t\tprintk(KERN_ERR \"isofs: isofs_export_get_parent(): \"\n\t\t       \"child is not a directory!\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* It is an invariant that the directory offset is zero.  If\n\t * it is not zero, it means the directory failed to be\n\t * normalized for some reason. */\n\tif (e_child_inode->i_iget5_offset != 0) {\n\t\tprintk(KERN_ERR \"isofs: isofs_export_get_parent(): \"\n\t\t       \"child directory not normalized!\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* The child inode has been normalized such that its\n\t * i_iget5_block value points to the \".\" entry.  Fortunately,\n\t * the \"..\" entry is located in the same block. */\n\tparent_block = e_child_inode->i_iget5_block;\n\n\t/* Get the block in question. */\n\tbh = sb_bread(child_inode->i_sb, parent_block);\n\tif (bh == NULL) {\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* This is the \".\" entry. */\n\tde = (struct iso_directory_record*)bh->b_data;\n\n\t/* The \"..\" entry is always the second entry. */\n\tparent_offset = (unsigned long)isonum_711(de->length);\n\tde = (struct iso_directory_record*)(bh->b_data + parent_offset);\n\n\t/* Verify it is in fact the \"..\" entry. */\n\tif ((isonum_711(de->name_len) != 1) || (de->name[0] != 1)) {\n\t\tprintk(KERN_ERR \"isofs: Unable to find the \\\"..\\\" \"\n\t\t       \"directory for NFS.\\n\");\n\t\trv = ERR_PTR(-EACCES);\n\t\tgoto out;\n\t}\n\n\t/* Normalize */\n\tisofs_normalize_block_and_offset(de, &parent_block, &parent_offset);\n\n\trv = d_obtain_alias(isofs_iget(child_inode->i_sb, parent_block,\n\t\t\t\t     parent_offset));\n out:\n\tif (bh)\n\t\tbrelse(bh);\n\treturn rv;\n}"
  },
  {
    "function_name": "isofs_export_iget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/export.c",
    "lines": "18-36",
    "snippet": "static struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}",
    "includes": [
      "#include \"isofs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_obtain_alias",
          "args": [
            "inode"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "d_obtain_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1977-1980",
          "snippet": "struct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ESTALE"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "inode"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isofs_iget",
          "args": [
            "sb",
            "block",
            "offset"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "isofs_iget_reloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "133-138",
          "snippet": "static inline struct inode *isofs_iget_reloc(struct super_block *sb,\n\t\t\t\t\t     unsigned long block,\n\t\t\t\t\t     unsigned long offset)\n{\n\treturn __isofs_iget(sb, block, offset, 1);\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);",
            "extern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);",
            "int get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);",
            "int get_acorn_filename(struct iso_directory_record *, char *, struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nextern int get_rock_ridge_filename(struct iso_directory_record *, char *, struct inode *);\nextern int isofs_name_translate(struct iso_directory_record *, char *, struct inode *);\nint get_joliet_filename(struct iso_directory_record *, unsigned char *, struct inode *);\nint get_acorn_filename(struct iso_directory_record *, char *, struct inode *);\n\nstatic inline struct inode *isofs_iget_reloc(struct super_block *sb,\n\t\t\t\t\t     unsigned long block,\n\t\t\t\t\t     unsigned long offset)\n{\n\treturn __isofs_iget(sb, block, offset, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ESTALE"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n\nstatic struct dentry *\nisofs_export_iget(struct super_block *sb,\n\t\t  unsigned long block,\n\t\t  unsigned long offset,\n\t\t  __u32 generation)\n{\n\tstruct inode *inode;\n\n\tif (block == 0)\n\t\treturn ERR_PTR(-ESTALE);\n\tinode = isofs_iget(sb, block, offset);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\tif (generation && inode->i_generation != generation) {\n\t\tiput(inode);\n\t\treturn ERR_PTR(-ESTALE);\n\t}\n\treturn d_obtain_alias(inode);\n}"
  }
]