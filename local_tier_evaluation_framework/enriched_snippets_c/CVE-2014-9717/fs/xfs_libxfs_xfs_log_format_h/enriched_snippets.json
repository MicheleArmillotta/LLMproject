[
  {
    "function_name": "xfs_blft_from_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "509-513",
    "snippet": "static inline __uint16_t\nxfs_blft_from_flags(struct xfs_buf_log_format *blf)\n{\n\treturn (blf->blf_flags & XFS_BLFT_MASK) >> XFS_BLFT_SHIFT;\n}",
    "includes": [],
    "macros_used": [
      "#define XFS_BLFT_MASK\t(((1 << XFS_BLFT_BITS) - 1) << XFS_BLFT_SHIFT)",
      "#define XFS_BLFT_SHIFT\t11"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define XFS_BLFT_MASK\t(((1 << XFS_BLFT_BITS) - 1) << XFS_BLFT_SHIFT)\n#define XFS_BLFT_SHIFT\t11\n\nstatic inline __uint16_t\nxfs_blft_from_flags(struct xfs_buf_log_format *blf)\n{\n\treturn (blf->blf_flags & XFS_BLFT_MASK) >> XFS_BLFT_SHIFT;\n}"
  },
  {
    "function_name": "xfs_blft_to_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "501-507",
    "snippet": "static inline void\nxfs_blft_to_flags(struct xfs_buf_log_format *blf, enum xfs_blft type)\n{\n\tASSERT(type > XFS_BLFT_UNKNOWN_BUF && type < XFS_BLFT_MAX_BUF);\n\tblf->blf_flags &= ~XFS_BLFT_MASK;\n\tblf->blf_flags |= ((type << XFS_BLFT_SHIFT) & XFS_BLFT_MASK);\n}",
    "includes": [],
    "macros_used": [
      "#define XFS_BLFT_MASK\t(((1 << XFS_BLFT_BITS) - 1) << XFS_BLFT_SHIFT)",
      "#define XFS_BLFT_SHIFT\t11"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "type > XFS_BLFT_UNKNOWN_BUF && type < XFS_BLFT_MAX_BUF"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#define XFS_BLFT_MASK\t(((1 << XFS_BLFT_BITS) - 1) << XFS_BLFT_SHIFT)\n#define XFS_BLFT_SHIFT\t11\n\nstatic inline void\nxfs_blft_to_flags(struct xfs_buf_log_format *blf, enum xfs_blft type)\n{\n\tASSERT(type > XFS_BLFT_UNKNOWN_BUF && type < XFS_BLFT_MAX_BUF);\n\tblf->blf_flags &= ~XFS_BLFT_MASK;\n\tblf->blf_flags |= ((type << XFS_BLFT_SHIFT) & XFS_BLFT_MASK);\n}"
  },
  {
    "function_name": "xfs_icdinode_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "412-417",
    "snippet": "static inline uint xfs_icdinode_size(int version)\n{\n\tif (version == 3)\n\t\treturn sizeof(struct xfs_icdinode);\n\treturn offsetof(struct xfs_icdinode, di_next_unlinked);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline uint xfs_icdinode_size(int version)\n{\n\tif (version == 3)\n\t\treturn sizeof(struct xfs_icdinode);\n\treturn offsetof(struct xfs_icdinode, di_next_unlinked);\n}"
  },
  {
    "function_name": "xfs_ilog_fdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "346-349",
    "snippet": "static inline int xfs_ilog_fdata(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DDATA : XFS_ILOG_ADATA);\n}",
    "includes": [],
    "macros_used": [
      "#define\tXFS_ILOG_ADATA\t0x040\t/* log i_af.if_data */",
      "#define\tXFS_ILOG_DDATA\t0x002\t/* log i_df.if_data */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define\tXFS_ILOG_ADATA\t0x040\t/* log i_af.if_data */\n#define\tXFS_ILOG_DDATA\t0x002\t/* log i_df.if_data */\n\nstatic inline int xfs_ilog_fdata(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DDATA : XFS_ILOG_ADATA);\n}"
  },
  {
    "function_name": "xfs_ilog_fext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "341-344",
    "snippet": "static inline int xfs_ilog_fext(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DEXT : XFS_ILOG_AEXT);\n}",
    "includes": [],
    "macros_used": [
      "#define\tXFS_ILOG_AEXT\t0x080\t/* log i_af.if_extents */",
      "#define\tXFS_ILOG_DEXT\t0x004\t/* log i_df.if_extents */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define\tXFS_ILOG_AEXT\t0x080\t/* log i_af.if_extents */\n#define\tXFS_ILOG_DEXT\t0x004\t/* log i_df.if_extents */\n\nstatic inline int xfs_ilog_fext(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DEXT : XFS_ILOG_AEXT);\n}"
  },
  {
    "function_name": "xfs_ilog_fbroot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "336-339",
    "snippet": "static inline int xfs_ilog_fbroot(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DBROOT : XFS_ILOG_ABROOT);\n}",
    "includes": [],
    "macros_used": [
      "#define\tXFS_ILOG_ABROOT\t0x100\t/* log i_af.i_broot */",
      "#define\tXFS_ILOG_DBROOT\t0x008\t/* log i_df.i_broot */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define\tXFS_ILOG_ABROOT\t0x100\t/* log i_af.i_broot */\n#define\tXFS_ILOG_DBROOT\t0x008\t/* log i_df.i_broot */\n\nstatic inline int xfs_ilog_fbroot(int w)\n{\n\treturn (w == XFS_DATA_FORK ? XFS_ILOG_DBROOT : XFS_ILOG_ABROOT);\n}"
  },
  {
    "function_name": "xlog_get_cycle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "77-83",
    "snippet": "static inline uint xlog_get_cycle(char *ptr)\n{\n\tif (be32_to_cpu(*(__be32 *)ptr) == XLOG_HEADER_MAGIC_NUM)\n\t\treturn be32_to_cpu(*((__be32 *)ptr + 1));\n\telse\n\t\treturn be32_to_cpu(*(__be32 *)ptr);\n}",
    "includes": [],
    "macros_used": [
      "#define XLOG_HEADER_MAGIC_NUM\t0xFEEDbabe\t/* Invalid cycle number */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*(__be32 *)ptr"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*((__be32 *)ptr + 1)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "*(__be32 *)ptr"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#define XLOG_HEADER_MAGIC_NUM\t0xFEEDbabe\t/* Invalid cycle number */\n\nstatic inline uint xlog_get_cycle(char *ptr)\n{\n\tif (be32_to_cpu(*(__be32 *)ptr) == XLOG_HEADER_MAGIC_NUM)\n\t\treturn be32_to_cpu(*((__be32 *)ptr + 1));\n\telse\n\t\treturn be32_to_cpu(*(__be32 *)ptr);\n}"
  },
  {
    "function_name": "xlog_assign_lsn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_log_format.h",
    "lines": "72-75",
    "snippet": "static inline xfs_lsn_t xlog_assign_lsn(uint cycle, uint block)\n{\n\treturn ((xfs_lsn_t)cycle << 32) | block;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline xfs_lsn_t xlog_assign_lsn(uint cycle, uint block)\n{\n\treturn ((xfs_lsn_t)cycle << 32) | block;\n}"
  }
]