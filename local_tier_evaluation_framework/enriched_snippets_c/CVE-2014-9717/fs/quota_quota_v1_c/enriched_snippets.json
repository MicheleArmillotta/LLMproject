[
  {
    "function_name": "exit_v1_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "228-231",
    "snippet": "static void __exit exit_v1_quota_format(void)\n{\n        unregister_quota_format(&v1_quota_format);\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct quota_format_type v1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_OLD,\n\t.qf_ops\t\t= &v1_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_quota_format",
          "args": [
            "&v1_quota_format"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "171-182",
          "snippet": "void unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static struct quota_format_type *quota_formats;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nvoid unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic struct quota_format_type v1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_OLD,\n\t.qf_ops\t\t= &v1_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\n\nstatic void __exit exit_v1_quota_format(void)\n{\n        unregister_quota_format(&v1_quota_format);\n}"
  },
  {
    "function_name": "init_v1_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "223-226",
    "snippet": "static int __init init_v1_quota_format(void)\n{\n        return register_quota_format(&v1_quota_format);\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct quota_format_type v1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_OLD,\n\t.qf_ops\t\t= &v1_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_quota_format",
          "args": [
            "&v1_quota_format"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "171-182",
          "snippet": "void unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static struct quota_format_type *quota_formats;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nvoid unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic struct quota_format_type v1_quota_format = {\n\t.qf_fmt_id\t= QFMT_VFS_OLD,\n\t.qf_ops\t\t= &v1_format_ops,\n\t.qf_owner\t= THIS_MODULE\n};\n\nstatic int __init init_v1_quota_format(void)\n{\n        return register_quota_format(&v1_quota_format);\n}"
  },
  {
    "function_name": "v1_write_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "182-206",
    "snippet": "static int v1_write_file_info(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct v1_disk_dqblk dqblk;\n\tint ret;\n\n\tdqopt->info[type].dqi_flags &= ~DQF_INFO_DIRTY;\n\tret = sb->s_op->quota_read(sb, type, (char *)&dqblk,\n\t\t\t\tsizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tdqblk.dqb_itime = dqopt->info[type].dqi_igrace;\n\tdqblk.dqb_btime = dqopt->info[type].dqi_bgrace;\n\tret = sb->s_op->quota_write(sb, type, (char *)&dqblk,\n\t      sizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret == sizeof(struct v1_disk_dqblk))\n\t\tret = 0;\n\telse if (ret > 0)\n\t\tret = -EIO;\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_op->quota_write",
          "args": [
            "sb",
            "type",
            "(char *)&dqblk",
            "sizeof(struct v1_disk_dqblk)",
            "v1_dqoff(0)"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v1_dqoff",
          "args": [
            "0"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->s_op->quota_read",
          "args": [
            "sb",
            "type",
            "(char *)&dqblk",
            "sizeof(struct v1_disk_dqblk)",
            "v1_dqoff(0)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v1_dqoff",
          "args": [
            "0"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v1_write_file_info(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct v1_disk_dqblk dqblk;\n\tint ret;\n\n\tdqopt->info[type].dqi_flags &= ~DQF_INFO_DIRTY;\n\tret = sb->s_op->quota_read(sb, type, (char *)&dqblk,\n\t\t\t\tsizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tdqblk.dqb_itime = dqopt->info[type].dqi_igrace;\n\tdqblk.dqb_btime = dqopt->info[type].dqi_bgrace;\n\tret = sb->s_op->quota_write(sb, type, (char *)&dqblk,\n\t      sizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret == sizeof(struct v1_disk_dqblk))\n\t\tret = 0;\n\telse if (ret > 0)\n\t\tret = -EIO;\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "v1_read_file_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "157-180",
    "snippet": "static int v1_read_file_info(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct v1_disk_dqblk dqblk;\n\tint ret;\n\n\tret = sb->s_op->quota_read(sb, type, (char *)&dqblk,\n\t\t\t\tsizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tret = 0;\n\t/* limits are stored as unsigned 32-bit data */\n\tdqopt->info[type].dqi_max_spc_limit = 0xffffffffULL << QUOTABLOCK_BITS;\n\tdqopt->info[type].dqi_max_ino_limit = 0xffffffff;\n\tdqopt->info[type].dqi_igrace =\n\t\t\tdqblk.dqb_itime ? dqblk.dqb_itime : MAX_IQ_TIME;\n\tdqopt->info[type].dqi_bgrace =\n\t\t\tdqblk.dqb_btime ? dqblk.dqb_btime : MAX_DQ_TIME;\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb->s_op->quota_read",
          "args": [
            "sb",
            "type",
            "(char *)&dqblk",
            "sizeof(struct v1_disk_dqblk)",
            "v1_dqoff(0)"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v1_dqoff",
          "args": [
            "0"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic int v1_read_file_info(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct v1_disk_dqblk dqblk;\n\tint ret;\n\n\tret = sb->s_op->quota_read(sb, type, (char *)&dqblk,\n\t\t\t\tsizeof(struct v1_disk_dqblk), v1_dqoff(0));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tret = 0;\n\t/* limits are stored as unsigned 32-bit data */\n\tdqopt->info[type].dqi_max_spc_limit = 0xffffffffULL << QUOTABLOCK_BITS;\n\tdqopt->info[type].dqi_max_ino_limit = 0xffffffff;\n\tdqopt->info[type].dqi_igrace =\n\t\t\tdqblk.dqb_itime ? dqblk.dqb_itime : MAX_IQ_TIME;\n\tdqopt->info[type].dqi_bgrace =\n\t\t\tdqblk.dqb_btime ? dqblk.dqb_btime : MAX_DQ_TIME;\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "v1_check_quota_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "125-155",
    "snippet": "static int v1_check_quota_file(struct super_block *sb, int type)\n{\n\tstruct inode *inode = sb_dqopt(sb)->files[type];\n\tulong blocks;\n\tsize_t off; \n\tstruct v2_disk_dqheader dqhead;\n\tssize_t size;\n\tloff_t isize;\n\tstatic const uint quota_magics[] = V2_INITQMAGICS;\n\n\tisize = i_size_read(inode);\n\tif (!isize)\n\t\treturn 0;\n\tblocks = isize >> BLOCK_SIZE_BITS;\n\toff = isize & (BLOCK_SIZE - 1);\n\tif ((blocks % sizeof(struct v1_disk_dqblk) * BLOCK_SIZE + off) %\n\t    sizeof(struct v1_disk_dqblk))\n\t\treturn 0;\n\t/* Doublecheck whether we didn't get file with new format - with old\n\t * quotactl() this could happen */\n\tsize = sb->s_op->quota_read(sb, type, (char *)&dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader))\n\t\treturn 1;\t/* Probably not new format */\n\tif (le32_to_cpu(dqhead.dqh_magic) != quota_magics[type])\n\t\treturn 1;\t/* Definitely not new format */\n\tprintk(KERN_INFO\n\t       \"VFS: %s: Refusing to turn on old quota format on given file.\"\n\t       \" It probably contains newer quota format.\\n\", sb->s_id);\n        return 0;\t\t/* Seems like a new format file -> refuse it */\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO\n\t       \"VFS: %s: Refusing to turn on old quota format on given file.\"\n\t       \" It probably contains newer quota format.\\n\"",
            "sb->s_id"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "dqhead.dqh_magic"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_op->quota_read",
          "args": [
            "sb",
            "type",
            "(char *)&dqhead",
            "sizeof(struct v2_disk_dqheader)",
            "0"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v1_check_quota_file(struct super_block *sb, int type)\n{\n\tstruct inode *inode = sb_dqopt(sb)->files[type];\n\tulong blocks;\n\tsize_t off; \n\tstruct v2_disk_dqheader dqhead;\n\tssize_t size;\n\tloff_t isize;\n\tstatic const uint quota_magics[] = V2_INITQMAGICS;\n\n\tisize = i_size_read(inode);\n\tif (!isize)\n\t\treturn 0;\n\tblocks = isize >> BLOCK_SIZE_BITS;\n\toff = isize & (BLOCK_SIZE - 1);\n\tif ((blocks % sizeof(struct v1_disk_dqblk) * BLOCK_SIZE + off) %\n\t    sizeof(struct v1_disk_dqblk))\n\t\treturn 0;\n\t/* Doublecheck whether we didn't get file with new format - with old\n\t * quotactl() this could happen */\n\tsize = sb->s_op->quota_read(sb, type, (char *)&dqhead,\n\t\t\t\t    sizeof(struct v2_disk_dqheader), 0);\n\tif (size != sizeof(struct v2_disk_dqheader))\n\t\treturn 1;\t/* Probably not new format */\n\tif (le32_to_cpu(dqhead.dqh_magic) != quota_magics[type])\n\t\treturn 1;\t/* Definitely not new format */\n\tprintk(KERN_INFO\n\t       \"VFS: %s: Refusing to turn on old quota format on given file.\"\n\t       \" It probably contains newer quota format.\\n\", sb->s_id);\n        return 0;\t\t/* Seems like a new format file -> refuse it */\n}"
  },
  {
    "function_name": "v1_commit_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "80-111",
    "snippet": "static int v1_commit_dqblk(struct dquot *dquot)\n{\n\tshort type = dquot->dq_id.type;\n\tssize_t ret;\n\tstruct v1_disk_dqblk dqblk;\n\n\tv1_mem2disk_dqblk(&dqblk, &dquot->dq_dqb);\n\tif (((type == USRQUOTA) && uid_eq(dquot->dq_id.uid, GLOBAL_ROOT_UID)) ||\n\t    ((type == GRPQUOTA) && gid_eq(dquot->dq_id.gid, GLOBAL_ROOT_GID))) {\n\t\tdqblk.dqb_btime =\n\t\t\tsb_dqopt(dquot->dq_sb)->info[type].dqi_bgrace;\n\t\tdqblk.dqb_itime =\n\t\t\tsb_dqopt(dquot->dq_sb)->info[type].dqi_igrace;\n\t}\n\tret = 0;\n\tif (sb_dqopt(dquot->dq_sb)->files[type])\n\t\tret = dquot->dq_sb->s_op->quota_write(dquot->dq_sb, type,\n\t\t\t(char *)&dqblk, sizeof(struct v1_disk_dqblk),\n\t\t\tv1_dqoff(from_kqid(&init_user_ns, dquot->dq_id)));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tquota_error(dquot->dq_sb, \"dquota write failed\");\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tdqstats_inc(DQST_WRITES);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_WRITES"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "dquot->dq_sb",
            "\"dquota write failed\""
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot->dq_sb->s_op->quota_write",
          "args": [
            "dquot->dq_sb",
            "type",
            "(char *)&dqblk",
            "sizeof(struct v1_disk_dqblk)",
            "v1_dqoff(from_kqid(&init_user_ns, dquot->dq_id))"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v1_dqoff",
          "args": [
            "from_kqid(&init_user_ns, dquot->dq_id)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "dquot->dq_id.gid",
            "GLOBAL_ROOT_GID"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "dquot->dq_id.uid",
            "GLOBAL_ROOT_UID"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v1_mem2disk_dqblk",
          "args": [
            "&dqblk",
            "&dquot->dq_dqb"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "v1_mem2disk_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
          "lines": "43-53",
          "snippet": "static void v1_mem2disk_dqblk(struct v1_disk_dqblk *d, struct mem_dqblk *m)\n{\n\td->dqb_ihardlimit = m->dqb_ihardlimit;\n\td->dqb_isoftlimit = m->dqb_isoftlimit;\n\td->dqb_curinodes = m->dqb_curinodes;\n\td->dqb_bhardlimit = v1_stoqb(m->dqb_bhardlimit);\n\td->dqb_bsoftlimit = v1_stoqb(m->dqb_bsoftlimit);\n\td->dqb_curblocks = v1_stoqb(m->dqb_curspace);\n\td->dqb_itime = m->dqb_itime;\n\td->dqb_btime = m->dqb_btime;\n}",
          "includes": [
            "#include \"quotaio_v1.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v1.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v1_mem2disk_dqblk(struct v1_disk_dqblk *d, struct mem_dqblk *m)\n{\n\td->dqb_ihardlimit = m->dqb_ihardlimit;\n\td->dqb_isoftlimit = m->dqb_isoftlimit;\n\td->dqb_curinodes = m->dqb_curinodes;\n\td->dqb_bhardlimit = v1_stoqb(m->dqb_bhardlimit);\n\td->dqb_bsoftlimit = v1_stoqb(m->dqb_bsoftlimit);\n\td->dqb_curblocks = v1_stoqb(m->dqb_curspace);\n\td->dqb_itime = m->dqb_itime;\n\td->dqb_btime = m->dqb_btime;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v1_commit_dqblk(struct dquot *dquot)\n{\n\tshort type = dquot->dq_id.type;\n\tssize_t ret;\n\tstruct v1_disk_dqblk dqblk;\n\n\tv1_mem2disk_dqblk(&dqblk, &dquot->dq_dqb);\n\tif (((type == USRQUOTA) && uid_eq(dquot->dq_id.uid, GLOBAL_ROOT_UID)) ||\n\t    ((type == GRPQUOTA) && gid_eq(dquot->dq_id.gid, GLOBAL_ROOT_GID))) {\n\t\tdqblk.dqb_btime =\n\t\t\tsb_dqopt(dquot->dq_sb)->info[type].dqi_bgrace;\n\t\tdqblk.dqb_itime =\n\t\t\tsb_dqopt(dquot->dq_sb)->info[type].dqi_igrace;\n\t}\n\tret = 0;\n\tif (sb_dqopt(dquot->dq_sb)->files[type])\n\t\tret = dquot->dq_sb->s_op->quota_write(dquot->dq_sb, type,\n\t\t\t(char *)&dqblk, sizeof(struct v1_disk_dqblk),\n\t\t\tv1_dqoff(from_kqid(&init_user_ns, dquot->dq_id)));\n\tif (ret != sizeof(struct v1_disk_dqblk)) {\n\t\tquota_error(dquot->dq_sb, \"dquota write failed\");\n\t\tif (ret >= 0)\n\t\t\tret = -EIO;\n\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tdqstats_inc(DQST_WRITES);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "v1_read_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "55-78",
    "snippet": "static int v1_read_dqblk(struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct v1_disk_dqblk dqblk;\n\n\tif (!sb_dqopt(dquot->dq_sb)->files[type])\n\t\treturn -EINVAL;\n\n\t/* Set structure to 0s in case read fails/is after end of file */\n\tmemset(&dqblk, 0, sizeof(struct v1_disk_dqblk));\n\tdquot->dq_sb->s_op->quota_read(dquot->dq_sb, type, (char *)&dqblk,\n\t\t\tsizeof(struct v1_disk_dqblk),\n\t\t\tv1_dqoff(from_kqid(&init_user_ns, dquot->dq_id)));\n\n\tv1_disk2mem_dqblk(&dquot->dq_dqb, &dqblk);\n\tif (dquot->dq_dqb.dqb_bhardlimit == 0 &&\n\t    dquot->dq_dqb.dqb_bsoftlimit == 0 &&\n\t    dquot->dq_dqb.dqb_ihardlimit == 0 &&\n\t    dquot->dq_dqb.dqb_isoftlimit == 0)\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tdqstats_inc(DQST_READS);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_READS"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "v1_disk2mem_dqblk",
          "args": [
            "&dquot->dq_dqb",
            "&dqblk"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "v1_disk2mem_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
          "lines": "31-41",
          "snippet": "static void v1_disk2mem_dqblk(struct mem_dqblk *m, struct v1_disk_dqblk *d)\n{\n\tm->dqb_ihardlimit = d->dqb_ihardlimit;\n\tm->dqb_isoftlimit = d->dqb_isoftlimit;\n\tm->dqb_curinodes = d->dqb_curinodes;\n\tm->dqb_bhardlimit = v1_qbtos(d->dqb_bhardlimit);\n\tm->dqb_bsoftlimit = v1_qbtos(d->dqb_bsoftlimit);\n\tm->dqb_curspace = v1_qbtos(d->dqb_curblocks);\n\tm->dqb_itime = d->dqb_itime;\n\tm->dqb_btime = d->dqb_btime;\n}",
          "includes": [
            "#include \"quotaio_v1.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v1.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v1_disk2mem_dqblk(struct mem_dqblk *m, struct v1_disk_dqblk *d)\n{\n\tm->dqb_ihardlimit = d->dqb_ihardlimit;\n\tm->dqb_isoftlimit = d->dqb_isoftlimit;\n\tm->dqb_curinodes = d->dqb_curinodes;\n\tm->dqb_bhardlimit = v1_qbtos(d->dqb_bhardlimit);\n\tm->dqb_bsoftlimit = v1_qbtos(d->dqb_bsoftlimit);\n\tm->dqb_curspace = v1_qbtos(d->dqb_curblocks);\n\tm->dqb_itime = d->dqb_itime;\n\tm->dqb_btime = d->dqb_btime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot->dq_sb->s_op->quota_read",
          "args": [
            "dquot->dq_sb",
            "type",
            "(char *)&dqblk",
            "sizeof(struct v1_disk_dqblk)",
            "v1_dqoff(from_kqid(&init_user_ns, dquot->dq_id))"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v1_dqoff",
          "args": [
            "from_kqid(&init_user_ns, dquot->dq_id)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&dqblk",
            "0",
            "sizeof(struct v1_disk_dqblk)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic int v1_read_dqblk(struct dquot *dquot)\n{\n\tint type = dquot->dq_id.type;\n\tstruct v1_disk_dqblk dqblk;\n\n\tif (!sb_dqopt(dquot->dq_sb)->files[type])\n\t\treturn -EINVAL;\n\n\t/* Set structure to 0s in case read fails/is after end of file */\n\tmemset(&dqblk, 0, sizeof(struct v1_disk_dqblk));\n\tdquot->dq_sb->s_op->quota_read(dquot->dq_sb, type, (char *)&dqblk,\n\t\t\tsizeof(struct v1_disk_dqblk),\n\t\t\tv1_dqoff(from_kqid(&init_user_ns, dquot->dq_id)));\n\n\tv1_disk2mem_dqblk(&dquot->dq_dqb, &dqblk);\n\tif (dquot->dq_dqb.dqb_bhardlimit == 0 &&\n\t    dquot->dq_dqb.dqb_bsoftlimit == 0 &&\n\t    dquot->dq_dqb.dqb_ihardlimit == 0 &&\n\t    dquot->dq_dqb.dqb_isoftlimit == 0)\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tdqstats_inc(DQST_READS);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "v1_mem2disk_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "43-53",
    "snippet": "static void v1_mem2disk_dqblk(struct v1_disk_dqblk *d, struct mem_dqblk *m)\n{\n\td->dqb_ihardlimit = m->dqb_ihardlimit;\n\td->dqb_isoftlimit = m->dqb_isoftlimit;\n\td->dqb_curinodes = m->dqb_curinodes;\n\td->dqb_bhardlimit = v1_stoqb(m->dqb_bhardlimit);\n\td->dqb_bsoftlimit = v1_stoqb(m->dqb_bsoftlimit);\n\td->dqb_curblocks = v1_stoqb(m->dqb_curspace);\n\td->dqb_itime = m->dqb_itime;\n\td->dqb_btime = m->dqb_btime;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v1_stoqb",
          "args": [
            "m->dqb_curspace"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "v1_stoqb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
          "lines": "21-24",
          "snippet": "static inline qsize_t v1_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v1.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v1.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)",
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v1_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v1_mem2disk_dqblk(struct v1_disk_dqblk *d, struct mem_dqblk *m)\n{\n\td->dqb_ihardlimit = m->dqb_ihardlimit;\n\td->dqb_isoftlimit = m->dqb_isoftlimit;\n\td->dqb_curinodes = m->dqb_curinodes;\n\td->dqb_bhardlimit = v1_stoqb(m->dqb_bhardlimit);\n\td->dqb_bsoftlimit = v1_stoqb(m->dqb_bsoftlimit);\n\td->dqb_curblocks = v1_stoqb(m->dqb_curspace);\n\td->dqb_itime = m->dqb_itime;\n\td->dqb_btime = m->dqb_btime;\n}"
  },
  {
    "function_name": "v1_disk2mem_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "31-41",
    "snippet": "static void v1_disk2mem_dqblk(struct mem_dqblk *m, struct v1_disk_dqblk *d)\n{\n\tm->dqb_ihardlimit = d->dqb_ihardlimit;\n\tm->dqb_isoftlimit = d->dqb_isoftlimit;\n\tm->dqb_curinodes = d->dqb_curinodes;\n\tm->dqb_bhardlimit = v1_qbtos(d->dqb_bhardlimit);\n\tm->dqb_bsoftlimit = v1_qbtos(d->dqb_bsoftlimit);\n\tm->dqb_curspace = v1_qbtos(d->dqb_curblocks);\n\tm->dqb_itime = d->dqb_itime;\n\tm->dqb_btime = d->dqb_btime;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v1_qbtos",
          "args": [
            "d->dqb_curblocks"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "v1_qbtos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
          "lines": "26-29",
          "snippet": "static inline qsize_t v1_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}",
          "includes": [
            "#include \"quotaio_v1.h\"",
            "#include <asm/byteorder.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/dqblk_v1.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define QUOTABLOCK_BITS 10"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v1_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\nstatic void v1_disk2mem_dqblk(struct mem_dqblk *m, struct v1_disk_dqblk *d)\n{\n\tm->dqb_ihardlimit = d->dqb_ihardlimit;\n\tm->dqb_isoftlimit = d->dqb_isoftlimit;\n\tm->dqb_curinodes = d->dqb_curinodes;\n\tm->dqb_bhardlimit = v1_qbtos(d->dqb_bhardlimit);\n\tm->dqb_bsoftlimit = v1_qbtos(d->dqb_bsoftlimit);\n\tm->dqb_curspace = v1_qbtos(d->dqb_curblocks);\n\tm->dqb_itime = d->dqb_itime;\n\tm->dqb_btime = d->dqb_btime;\n}"
  },
  {
    "function_name": "v1_qbtos",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "26-29",
    "snippet": "static inline qsize_t v1_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v1_qbtos(qsize_t blocks)\n{\n\treturn blocks << QUOTABLOCK_BITS;\n}"
  },
  {
    "function_name": "v1_stoqb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota_v1.c",
    "lines": "21-24",
    "snippet": "static inline qsize_t v1_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}",
    "includes": [
      "#include \"quotaio_v1.h\"",
      "#include <asm/byteorder.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/kernel.h>",
      "#include <linux/dqblk_v1.h>",
      "#include <linux/quotaops.h>",
      "#include <linux/quota.h>",
      "#include <linux/fs.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)",
      "#define QUOTABLOCK_BITS 10"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"quotaio_v1.h\"\n#include <asm/byteorder.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/dqblk_v1.h>\n#include <linux/quotaops.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n\n#define QUOTABLOCK_SIZE (1 << QUOTABLOCK_BITS)\n#define QUOTABLOCK_BITS 10\n\nstatic inline qsize_t v1_stoqb(qsize_t space)\n{\n\treturn (space + QUOTABLOCK_SIZE - 1) >> QUOTABLOCK_BITS;\n}"
  }
]