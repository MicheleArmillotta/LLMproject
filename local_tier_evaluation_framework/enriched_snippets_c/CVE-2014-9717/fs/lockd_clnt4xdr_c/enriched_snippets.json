[
  {
    "function_name": "nlm4_xdr_dec_res",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "546-558",
    "snippet": "static int nlm4_xdr_dec_res(struct rpc_rqst *req,\n\t\t\t    struct xdr_stream *xdr,\n\t\t\t    struct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_cookie(xdr, &result->cookie);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nlm4_stat(xdr, &result->status);\nout:\n\treturn error;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_nlm4_stat",
          "args": [
            "xdr",
            "&result->status"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "decode_nlm4_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "232-250",
          "snippet": "static int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_cookie",
          "args": [
            "xdr",
            "&result->cookie"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "159-190",
          "snippet": "static int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int nlm4_xdr_dec_res(struct rpc_rqst *req,\n\t\t\t    struct xdr_stream *xdr,\n\t\t\t    struct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_cookie(xdr, &result->cookie);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nlm4_stat(xdr, &result->status);\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "nlm4_xdr_dec_testres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "526-538",
    "snippet": "static int nlm4_xdr_dec_testres(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_cookie(xdr, &result->cookie);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nlm4_testrply(xdr, result);\nout:\n\treturn error;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_nlm4_testrply",
          "args": [
            "xdr",
            "result"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "decode_nlm4_testrply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "512-524",
          "snippet": "static int decode_nlm4_testrply(struct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_nlm4_stat(xdr, &result->status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (result->status == nlm_lck_denied)\n\t\terror = decode_nlm4_holder(xdr, result);\nout:\n\treturn error;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_testrply(struct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_nlm4_stat(xdr, &result->status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (result->status == nlm_lck_denied)\n\t\terror = decode_nlm4_holder(xdr, result);\nout:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_cookie",
          "args": [
            "xdr",
            "&result->cookie"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "decode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "159-190",
          "snippet": "static int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int nlm4_xdr_dec_testres(struct rpc_rqst *req,\n\t\t\t\tstruct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_cookie(xdr, &result->cookie);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nlm4_testrply(xdr, result);\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "decode_nlm4_testrply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "512-524",
    "snippet": "static int decode_nlm4_testrply(struct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_nlm4_stat(xdr, &result->status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (result->status == nlm_lck_denied)\n\t\terror = decode_nlm4_holder(xdr, result);\nout:\n\treturn error;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_nlm4_holder",
          "args": [
            "xdr",
            "result"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "decode_nlm4_holder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "278-323",
          "snippet": "static int decode_nlm4_holder(struct xdr_stream *xdr, struct nlm_res *result)\n{\n\tstruct nlm_lock *lock = &result->lock;\n\tstruct file_lock *fl = &lock->fl;\n\tu64 l_offset, l_len;\n\tu32 exclusive;\n\tint error;\n\t__be32 *p;\n\ts32 end;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(fl);\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\texclusive = be32_to_cpup(p++);\n\tlock->svid = be32_to_cpup(p);\n\tfl->fl_pid = (pid_t)lock->svid;\n\n\terror = decode_netobj(xdr, &lock->oh);\n\tif (unlikely(error))\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 8 + 8);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = exclusive != 0 ? F_WRLCK : F_RDLCK;\n\tp = xdr_decode_hyper(p, &l_offset);\n\txdr_decode_hyper(p, &l_len);\n\tend = l_offset + l_len - 1;\n\n\tfl->fl_start = (loff_t)l_offset;\n\tif (l_len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = (loff_t)end;\n\terror = 0;\nout:\n\treturn error;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_holder(struct xdr_stream *xdr, struct nlm_res *result)\n{\n\tstruct nlm_lock *lock = &result->lock;\n\tstruct file_lock *fl = &lock->fl;\n\tu64 l_offset, l_len;\n\tu32 exclusive;\n\tint error;\n\t__be32 *p;\n\ts32 end;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(fl);\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\texclusive = be32_to_cpup(p++);\n\tlock->svid = be32_to_cpup(p);\n\tfl->fl_pid = (pid_t)lock->svid;\n\n\terror = decode_netobj(xdr, &lock->oh);\n\tif (unlikely(error))\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 8 + 8);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = exclusive != 0 ? F_WRLCK : F_RDLCK;\n\tp = xdr_decode_hyper(p, &l_offset);\n\txdr_decode_hyper(p, &l_len);\n\tend = l_offset + l_len - 1;\n\n\tfl->fl_start = (loff_t)l_offset;\n\tif (l_len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = (loff_t)end;\n\terror = 0;\nout:\n\treturn error;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_nlm4_stat",
          "args": [
            "xdr",
            "&result->status"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "decode_nlm4_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "232-250",
          "snippet": "static int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_testrply(struct xdr_stream *xdr,\n\t\t\t\tstruct nlm_res *result)\n{\n\tint error;\n\n\terror = decode_nlm4_stat(xdr, &result->status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (result->status == nlm_lck_denied)\n\t\terror = decode_nlm4_holder(xdr, result);\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_testres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "480-488",
    "snippet": "static void nlm4_xdr_enc_testres(struct rpc_rqst *req,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t const struct nlm_res *result)\n{\n\tencode_cookie(xdr, &result->cookie);\n\tencode_nlm4_stat(xdr, result->status);\n\tif (result->status == nlm_lck_denied)\n\t\tencode_nlm4_holder(xdr, result);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nlm4_holder",
          "args": [
            "xdr",
            "result"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_holder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "261-276",
          "snippet": "static void encode_nlm4_holder(struct xdr_stream *xdr,\n\t\t\t       const struct nlm_res *result)\n{\n\tconst struct nlm_lock *lock = &result->lock;\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_bool(xdr, lock->fl.fl_type == F_RDLCK);\n\tencode_int32(xdr, lock->svid);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_holder(struct xdr_stream *xdr,\n\t\t\t       const struct nlm_res *result)\n{\n\tconst struct nlm_lock *lock = &result->lock;\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_bool(xdr, lock->fl.fl_type == F_RDLCK);\n\tencode_int32(xdr, lock->svid);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nlm4_stat",
          "args": [
            "xdr",
            "result->status"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "222-230",
          "snippet": "static void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&result->cookie"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_testres(struct rpc_rqst *req,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t const struct nlm_res *result)\n{\n\tencode_cookie(xdr, &result->cookie);\n\tencode_nlm4_stat(xdr, result->status);\n\tif (result->status == nlm_lck_denied)\n\t\tencode_nlm4_holder(xdr, result);\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_res",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "459-465",
    "snippet": "static void nlm4_xdr_enc_res(struct rpc_rqst *req,\n\t\t\t     struct xdr_stream *xdr,\n\t\t\t     const struct nlm_res *result)\n{\n\tencode_cookie(xdr, &result->cookie);\n\tencode_nlm4_stat(xdr, result->status);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nlm4_stat",
          "args": [
            "xdr",
            "result->status"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "222-230",
          "snippet": "static void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&result->cookie"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_res(struct rpc_rqst *req,\n\t\t\t     struct xdr_stream *xdr,\n\t\t\t     const struct nlm_res *result)\n{\n\tencode_cookie(xdr, &result->cookie);\n\tencode_nlm4_stat(xdr, result->status);\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_unlockargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "443-451",
    "snippet": "static void nlm4_xdr_enc_unlockargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_nlm4_lock(xdr, lock);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nlm4_lock",
          "args": [
            "xdr",
            "lock"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "348-364",
          "snippet": "static void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&args->cookie"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_unlockargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_nlm4_lock(xdr, lock);\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_cancargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "425-435",
    "snippet": "static void nlm4_xdr_enc_cancargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, args->block);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nlm4_lock",
          "args": [
            "xdr",
            "lock"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "348-364",
          "snippet": "static void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_bool",
          "args": [
            "xdr",
            "lock->fl.fl_type == F_WRLCK"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "encode_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "99-105",
          "snippet": "static void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&args->cookie"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_cancargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, args->block);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_lockargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "403-415",
    "snippet": "static void nlm4_xdr_enc_lockargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, args->block);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n\tencode_bool(xdr, args->reclaim);\n\tencode_int32(xdr, args->state);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_int32",
          "args": [
            "xdr",
            "args->state"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "encode_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "107-113",
          "snippet": "static void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_bool",
          "args": [
            "xdr",
            "args->reclaim"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "encode_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "99-105",
          "snippet": "static void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_nlm4_lock",
          "args": [
            "xdr",
            "lock"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "348-364",
          "snippet": "static void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&args->cookie"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_lockargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, args->block);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n\tencode_bool(xdr, args->reclaim);\n\tencode_int32(xdr, args->state);\n}"
  },
  {
    "function_name": "nlm4_xdr_enc_testargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "382-391",
    "snippet": "static void nlm4_xdr_enc_testargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_nlm4_lock",
          "args": [
            "xdr",
            "lock"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "encode_nlm4_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "348-364",
          "snippet": "static void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_bool",
          "args": [
            "xdr",
            "lock->fl.fl_type == F_WRLCK"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "encode_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "99-105",
          "snippet": "static void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_cookie",
          "args": [
            "xdr",
            "&args->cookie"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "encode_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "153-157",
          "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_xdr_enc_testargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nlm_args *args)\n{\n\tconst struct nlm_lock *lock = &args->lock;\n\n\tencode_cookie(xdr, &args->cookie);\n\tencode_bool(xdr, lock->fl.fl_type == F_WRLCK);\n\tencode_nlm4_lock(xdr, lock);\n}"
  },
  {
    "function_name": "encode_nlm4_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "348-364",
    "snippet": "static void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "l_len"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "l_offset"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_compute_offsets",
          "args": [
            "lock",
            "&l_offset",
            "&l_len"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_compute_offsets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "64-74",
          "snippet": "static void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "lock->svid"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 8 + 8"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_netobj",
          "args": [
            "xdr",
            "lock->oh.data",
            "lock->oh.len"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "encode_netobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "118-125",
          "snippet": "static void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fh",
          "args": [
            "xdr",
            "&lock->fh"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "195-198",
          "snippet": "static void encode_fh(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\tencode_netobj(xdr, (u8 *)&fh->data, fh->size);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_fh(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\tencode_netobj(xdr, (u8 *)&fh->data, fh->size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_caller_name",
          "args": [
            "xdr",
            "lock->caller"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "encode_caller_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "328-336",
          "snippet": "static void encode_caller_name(struct xdr_stream *xdr, const char *name)\n{\n\t/* NB: client-side does not set lock->len */\n\tu32 length = strlen(name);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_caller_name(struct xdr_stream *xdr, const char *name)\n{\n\t/* NB: client-side does not set lock->len */\n\tu32 length = strlen(name);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_lock(struct xdr_stream *xdr,\n\t\t\t     const struct nlm_lock *lock)\n{\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_caller_name(xdr, lock->caller);\n\tencode_fh(xdr, &lock->fh);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 8 + 8);\n\t*p++ = cpu_to_be32(lock->svid);\n\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
  },
  {
    "function_name": "encode_caller_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "328-336",
    "snippet": "static void encode_caller_name(struct xdr_stream *xdr, const char *name)\n{\n\t/* NB: client-side does not set lock->len */\n\tu32 length = strlen(name);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "name",
            "length"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + length"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_caller_name(struct xdr_stream *xdr, const char *name)\n{\n\t/* NB: client-side does not set lock->len */\n\tu32 length = strlen(name);\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}"
  },
  {
    "function_name": "decode_nlm4_holder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "278-323",
    "snippet": "static int decode_nlm4_holder(struct xdr_stream *xdr, struct nlm_res *result)\n{\n\tstruct nlm_lock *lock = &result->lock;\n\tstruct file_lock *fl = &lock->fl;\n\tu64 l_offset, l_len;\n\tu32 exclusive;\n\tint error;\n\t__be32 *p;\n\ts32 end;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(fl);\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\texclusive = be32_to_cpup(p++);\n\tlock->svid = be32_to_cpup(p);\n\tfl->fl_pid = (pid_t)lock->svid;\n\n\terror = decode_netobj(xdr, &lock->oh);\n\tif (unlikely(error))\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 8 + 8);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = exclusive != 0 ? F_WRLCK : F_RDLCK;\n\tp = xdr_decode_hyper(p, &l_offset);\n\txdr_decode_hyper(p, &l_len);\n\tend = l_offset + l_len - 1;\n\n\tfl->fl_start = (loff_t)l_offset;\n\tif (l_len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = (loff_t)end;\n\terror = 0;\nout:\n\treturn error;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "79-84",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&l_len"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_hyper",
          "args": [
            "p",
            "&l_offset"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "8 + 8"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_netobj",
          "args": [
            "xdr",
            "&lock->oh"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "decode_netobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "127-148",
          "snippet": "static int decode_netobj(struct xdr_stream *xdr,\n\t\t\t struct xdr_netobj *obj)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\tif (unlikely(length > XDR_MAX_NETOBJ))\n\t\tgoto out_size;\n\tobj->len = length;\n\tobj->data = (u8 *)p;\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned netobj was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_netobj(struct xdr_stream *xdr,\n\t\t\t struct xdr_netobj *obj)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\tif (unlikely(length > XDR_MAX_NETOBJ))\n\t\tgoto out_size;\n\tobj->len = length;\n\tobj->data = (u8 *)p;\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned netobj was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4 + 4"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locks_init_lock",
          "args": [
            "fl"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "locks_init_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "311-315",
          "snippet": "void locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nvoid locks_init_lock(struct file_lock *fl)\n{\n\tmemset(fl, 0, sizeof(struct file_lock));\n\tlocks_init_lock_heads(fl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "lock",
            "0",
            "sizeof(*lock)"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_holder(struct xdr_stream *xdr, struct nlm_res *result)\n{\n\tstruct nlm_lock *lock = &result->lock;\n\tstruct file_lock *fl = &lock->fl;\n\tu64 l_offset, l_len;\n\tu32 exclusive;\n\tint error;\n\t__be32 *p;\n\ts32 end;\n\n\tmemset(lock, 0, sizeof(*lock));\n\tlocks_init_lock(fl);\n\n\tp = xdr_inline_decode(xdr, 4 + 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\texclusive = be32_to_cpup(p++);\n\tlock->svid = be32_to_cpup(p);\n\tfl->fl_pid = (pid_t)lock->svid;\n\n\terror = decode_netobj(xdr, &lock->oh);\n\tif (unlikely(error))\n\t\tgoto out;\n\n\tp = xdr_inline_decode(xdr, 8 + 8);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfl->fl_flags = FL_POSIX;\n\tfl->fl_type  = exclusive != 0 ? F_WRLCK : F_RDLCK;\n\tp = xdr_decode_hyper(p, &l_offset);\n\txdr_decode_hyper(p, &l_len);\n\tend = l_offset + l_len - 1;\n\n\tfl->fl_start = (loff_t)l_offset;\n\tif (l_len == 0 || end < 0)\n\t\tfl->fl_end = OFFSET_MAX;\n\telse\n\t\tfl->fl_end = (loff_t)end;\n\terror = 0;\nout:\n\treturn error;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_nlm4_holder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "261-276",
    "snippet": "static void encode_nlm4_holder(struct xdr_stream *xdr,\n\t\t\t       const struct nlm_res *result)\n{\n\tconst struct nlm_lock *lock = &result->lock;\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_bool(xdr, lock->fl.fl_type == F_RDLCK);\n\tencode_int32(xdr, lock->svid);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "l_len"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_hyper",
          "args": [
            "p",
            "l_offset"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm4_compute_offsets",
          "args": [
            "lock",
            "&l_offset",
            "&l_len"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "nlm4_compute_offsets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "64-74",
          "snippet": "static void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 4"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_netobj",
          "args": [
            "xdr",
            "lock->oh.data",
            "lock->oh.len"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "encode_netobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "118-125",
          "snippet": "static void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_int32",
          "args": [
            "xdr",
            "lock->svid"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "encode_int32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "107-113",
          "snippet": "static void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_bool",
          "args": [
            "xdr",
            "lock->fl.fl_type == F_RDLCK"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "encode_bool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "99-105",
          "snippet": "static void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_holder(struct xdr_stream *xdr,\n\t\t\t       const struct nlm_res *result)\n{\n\tconst struct nlm_lock *lock = &result->lock;\n\tu64 l_offset, l_len;\n\t__be32 *p;\n\n\tencode_bool(xdr, lock->fl.fl_type == F_RDLCK);\n\tencode_int32(xdr, lock->svid);\n\tencode_netobj(xdr, lock->oh.data, lock->oh.len);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\tnlm4_compute_offsets(lock, &l_offset, &l_len);\n\tp = xdr_encode_hyper(p, l_offset);\n\txdr_encode_hyper(p, l_len);\n}"
  },
  {
    "function_name": "decode_nlm4_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "232-250",
    "snippet": "static int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "79-84",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: server returned invalid nlm4_stats value: %u\\n\"",
            "__func__",
            "be32_to_cpup(p)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ntohl(*p) > ntohl(nlm4_failed)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "nlm4_failed"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "*p"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_nlm4_stat(struct xdr_stream *xdr, __be32 *stat)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (unlikely(ntohl(*p) > ntohl(nlm4_failed)))\n\t\tgoto out_bad_xdr;\n\t*stat = *p;\n\treturn 0;\nout_bad_xdr:\n\tdprintk(\"%s: server returned invalid nlm4_stats value: %u\\n\",\n\t\t\t__func__, be32_to_cpup(p));\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_nlm4_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "222-230",
    "snippet": "static void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "be32_to_cpu(stat) > NLM_FAILED"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "stat"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_nlm4_stat(struct xdr_stream *xdr,\n\t\t\t     const __be32 stat)\n{\n\t__be32 *p;\n\n\tBUG_ON(be32_to_cpu(stat) > NLM_FAILED);\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = stat;\n}"
  },
  {
    "function_name": "encode_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "195-198",
    "snippet": "static void encode_fh(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\tencode_netobj(xdr, (u8 *)&fh->data, fh->size);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_netobj",
          "args": [
            "xdr",
            "(u8 *)&fh->data",
            "fh->size"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "encode_netobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "118-125",
          "snippet": "static void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_fh(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\tencode_netobj(xdr, (u8 *)&fh->data, fh->size);\n}"
  },
  {
    "function_name": "decode_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "159-190",
    "snippet": "static int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "79-84",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned cookie was too long: %u\\n\"",
            "length"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cookie->data",
            "0",
            "4"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cookie->data",
            "p",
            "length"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "length"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_cookie(struct xdr_stream *xdr,\n\t\t\t     struct nlm_cookie *cookie)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\t/* apparently HPUX can return empty cookies */\n\tif (length == 0)\n\t\tgoto out_hpux;\n\tif (length > NLM_MAXCOOKIELEN)\n\t\tgoto out_size;\n\tp = xdr_inline_decode(xdr, length);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcookie->len = length;\n\tmemcpy(cookie->data, p, length);\n\treturn 0;\nout_hpux:\n\tcookie->len = 4;\n\tmemset(cookie->data, 0, 4);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned cookie was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "153-157",
    "snippet": "static void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_netobj",
          "args": [
            "xdr",
            "(u8 *)&cookie->data",
            "cookie->len"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "encode_netobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "118-125",
          "snippet": "static void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_cookie(struct xdr_stream *xdr,\n\t\t\t  const struct nlm_cookie *cookie)\n{\n\tencode_netobj(xdr, (u8 *)&cookie->data, cookie->len);\n}"
  },
  {
    "function_name": "decode_netobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "127-148",
    "snippet": "static int decode_netobj(struct xdr_stream *xdr,\n\t\t\t struct xdr_netobj *obj)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\tif (unlikely(length > XDR_MAX_NETOBJ))\n\t\tgoto out_size;\n\tobj->len = length;\n\tobj->data = (u8 *)p;\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned netobj was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "79-84",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned netobj was too long: %u\\n\"",
            "length"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "length > XDR_MAX_NETOBJ"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic int decode_netobj(struct xdr_stream *xdr,\n\t\t\t struct xdr_netobj *obj)\n{\n\tu32 length;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p++);\n\tif (unlikely(length > XDR_MAX_NETOBJ))\n\t\tgoto out_size;\n\tobj->len = length;\n\tobj->data = (u8 *)p;\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned netobj was too long: %u\\n\", length);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_netobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "118-125",
    "snippet": "static void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "data",
            "length"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + length"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_netobj(struct xdr_stream *xdr,\n\t\t\t  const u8 *data, const unsigned int length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, data, length);\n}"
  },
  {
    "function_name": "encode_int32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "107-113",
    "snippet": "static void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "value"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_int32(struct xdr_stream *xdr, const s32 value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(value);\n}"
  },
  {
    "function_name": "encode_bool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "99-105",
    "snippet": "static void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void encode_bool(struct xdr_stream *xdr, const int value)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = value ? xdr_one : xdr_zero;\n}"
  },
  {
    "function_name": "print_overflow_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "79-84",
    "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\"",
            "func",
            "xdr->end - xdr->p"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"lockd: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
  },
  {
    "function_name": "nlm4_compute_offsets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "64-74",
    "snippet": "static void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loff_t_to_s64",
          "args": [
            "fl->fl_end - fl->fl_start + 1"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "loff_t_to_s64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
          "lines": "51-62",
          "snippet": "static s64 loff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\n\tif (offset >= NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset <= -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}",
          "includes": [
            "#include <uapi/linux/nfs3.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/xdr.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic s64 loff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\n\tif (offset >= NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset <= -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic void nlm4_compute_offsets(const struct nlm_lock *lock,\n\t\t\t\t u64 *l_offset, u64 *l_len)\n{\n\tconst struct file_lock *fl = &lock->fl;\n\n\t*l_offset = loff_t_to_s64(fl->fl_start);\n\tif (fl->fl_end == OFFSET_MAX)\n\t\t*l_len = 0;\n\telse\n\t\t*l_len = loff_t_to_s64(fl->fl_end - fl->fl_start + 1);\n}"
  },
  {
    "function_name": "loff_t_to_s64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/clnt4xdr.c",
    "lines": "51-62",
    "snippet": "static s64 loff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\n\tif (offset >= NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset <= -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}",
    "includes": [
      "#include <uapi/linux/nfs3.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/xdr.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfs3.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/xdr.h>\n#include <linux/types.h>\n\nstatic s64 loff_t_to_s64(loff_t offset)\n{\n\ts64 res;\n\n\tif (offset >= NLM4_OFFSET_MAX)\n\t\tres = NLM4_OFFSET_MAX;\n\telse if (offset <= -NLM4_OFFSET_MAX)\n\t\tres = -NLM4_OFFSET_MAX;\n\telse\n\t\tres = offset;\n\treturn res;\n}"
  }
]