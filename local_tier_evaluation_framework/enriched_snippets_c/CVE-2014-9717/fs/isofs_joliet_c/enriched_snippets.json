[
  {
    "function_name": "get_joliet_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/joliet.c",
    "lines": "40-69",
    "snippet": "int\nget_joliet_filename(struct iso_directory_record * de, unsigned char *outname, struct inode * inode)\n{\n\tunsigned char utf8;\n\tstruct nls_table *nls;\n\tunsigned char len = 0;\n\n\tutf8 = ISOFS_SB(inode->i_sb)->s_utf8;\n\tnls = ISOFS_SB(inode->i_sb)->s_nls_iocharset;\n\n\tif (utf8) {\n\t\tlen = utf16s_to_utf8s((const wchar_t *) de->name,\n\t\t\t\tde->name_len[0] >> 1, UTF16_BIG_ENDIAN,\n\t\t\t\toutname, PAGE_SIZE);\n\t} else {\n\t\tlen = uni16_to_x8(outname, (__be16 *) de->name,\n\t\t\t\tde->name_len[0] >> 1, nls);\n\t}\n\tif ((len > 2) && (outname[len-2] == ';') && (outname[len-1] == '1'))\n\t\tlen -= 2;\n\n\t/*\n\t * Windows doesn't like periods at the end of a name,\n\t * so neither do we\n\t */\n\twhile (len >= 2 && (outname[len-1] == '.'))\n\t\tlen--;\n\n\treturn len;\n}",
    "includes": [
      "#include \"isofs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uni16_to_x8",
          "args": [
            "outname",
            "(__be16 *) de->name",
            "de->name_len[0] >> 1",
            "nls"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "uni16_to_x8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/joliet.c",
          "lines": "16-38",
          "snippet": "static int\nuni16_to_x8(unsigned char *ascii, __be16 *uni, int len, struct nls_table *nls)\n{\n\t__be16 *ip, ch;\n\tunsigned char *op;\n\n\tip = uni;\n\top = ascii;\n\n\twhile ((ch = get_unaligned(ip)) && len) {\n\t\tint llen;\n\t\tllen = nls->uni2char(be16_to_cpu(ch), op, NLS_MAX_CHARSET_SIZE);\n\t\tif (llen > 0)\n\t\t\top += llen;\n\t\telse\n\t\t\t*op++ = '?';\n\t\tip++;\n\n\t\tlen--;\n\t}\n\t*op = 0;\n\treturn (op - ascii);\n}",
          "includes": [
            "#include \"isofs.h\"",
            "#include <linux/nls.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"isofs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic int\nuni16_to_x8(unsigned char *ascii, __be16 *uni, int len, struct nls_table *nls)\n{\n\t__be16 *ip, ch;\n\tunsigned char *op;\n\n\tip = uni;\n\top = ascii;\n\n\twhile ((ch = get_unaligned(ip)) && len) {\n\t\tint llen;\n\t\tllen = nls->uni2char(be16_to_cpu(ch), op, NLS_MAX_CHARSET_SIZE);\n\t\tif (llen > 0)\n\t\t\top += llen;\n\t\telse\n\t\t\t*op++ = '?';\n\t\tip++;\n\n\t\tlen--;\n\t}\n\t*op = 0;\n\treturn (op - ascii);\n}"
        }
      },
      {
        "call_info": {
          "callee": "utf16s_to_utf8s",
          "args": [
            "(const wchar_t *) de->name",
            "de->name_len[0] >> 1",
            "UTF16_BIG_ENDIAN",
            "outname",
            "PAGE_SIZE"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "utf16s_to_utf8s",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_base.c",
          "lines": "186-232",
          "snippet": "int utf16s_to_utf8s(const wchar_t *pwcs, int inlen, enum utf16_endian endian,\n\t\tu8 *s, int maxout)\n{\n\tu8 *op;\n\tint size;\n\tunsigned long u, v;\n\n\top = s;\n\twhile (inlen > 0 && maxout > 0) {\n\t\tu = get_utf16(*pwcs, endian);\n\t\tif (!u)\n\t\t\tbreak;\n\t\tpwcs++;\n\t\tinlen--;\n\t\tif (u > 0x7f) {\n\t\t\tif ((u & SURROGATE_MASK) == SURROGATE_PAIR) {\n\t\t\t\tif (u & SURROGATE_LOW) {\n\t\t\t\t\t/* Ignore character and move on */\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (inlen <= 0)\n\t\t\t\t\tbreak;\n\t\t\t\tv = get_utf16(*pwcs, endian);\n\t\t\t\tif ((v & SURROGATE_MASK) != SURROGATE_PAIR ||\n\t\t\t\t\t\t!(v & SURROGATE_LOW)) {\n\t\t\t\t\t/* Ignore character and move on */\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tu = PLANE_SIZE + ((u & SURROGATE_BITS) << 10)\n\t\t\t\t\t\t+ (v & SURROGATE_BITS);\n\t\t\t\tpwcs++;\n\t\t\t\tinlen--;\n\t\t\t}\n\t\t\tsize = utf32_to_utf8(u, op, maxout);\n\t\t\tif (size == -1) {\n\t\t\t\t/* Ignore character and move on */\n\t\t\t} else {\n\t\t\t\top += size;\n\t\t\t\tmaxout -= size;\n\t\t\t}\n\t\t} else {\n\t\t\t*op++ = (u8) u;\n\t\t\tmaxout--;\n\t\t}\n\t}\n\treturn op - s;\n}",
          "includes": [
            "#include <asm/byteorder.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/kmod.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define SURROGATE_BITS\t0x000003ff",
            "#define SURROGATE_LOW\t0x00000400",
            "#define SURROGATE_PAIR\t0x0000d800",
            "#define SURROGATE_MASK\t0xfffff800",
            "#define PLANE_SIZE\t0x00010000"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/byteorder.h>\n#include <linux/spinlock.h>\n#include <linux/kmod.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\n#define SURROGATE_BITS\t0x000003ff\n#define SURROGATE_LOW\t0x00000400\n#define SURROGATE_PAIR\t0x0000d800\n#define SURROGATE_MASK\t0xfffff800\n#define PLANE_SIZE\t0x00010000\n\nint utf16s_to_utf8s(const wchar_t *pwcs, int inlen, enum utf16_endian endian,\n\t\tu8 *s, int maxout)\n{\n\tu8 *op;\n\tint size;\n\tunsigned long u, v;\n\n\top = s;\n\twhile (inlen > 0 && maxout > 0) {\n\t\tu = get_utf16(*pwcs, endian);\n\t\tif (!u)\n\t\t\tbreak;\n\t\tpwcs++;\n\t\tinlen--;\n\t\tif (u > 0x7f) {\n\t\t\tif ((u & SURROGATE_MASK) == SURROGATE_PAIR) {\n\t\t\t\tif (u & SURROGATE_LOW) {\n\t\t\t\t\t/* Ignore character and move on */\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (inlen <= 0)\n\t\t\t\t\tbreak;\n\t\t\t\tv = get_utf16(*pwcs, endian);\n\t\t\t\tif ((v & SURROGATE_MASK) != SURROGATE_PAIR ||\n\t\t\t\t\t\t!(v & SURROGATE_LOW)) {\n\t\t\t\t\t/* Ignore character and move on */\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tu = PLANE_SIZE + ((u & SURROGATE_BITS) << 10)\n\t\t\t\t\t\t+ (v & SURROGATE_BITS);\n\t\t\t\tpwcs++;\n\t\t\t\tinlen--;\n\t\t\t}\n\t\t\tsize = utf32_to_utf8(u, op, maxout);\n\t\t\tif (size == -1) {\n\t\t\t\t/* Ignore character and move on */\n\t\t\t} else {\n\t\t\t\top += size;\n\t\t\t\tmaxout -= size;\n\t\t\t}\n\t\t} else {\n\t\t\t*op++ = (u8) u;\n\t\t\tmaxout--;\n\t\t}\n\t}\n\treturn op - s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISOFS_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "ISOFS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/isofs.h",
          "lines": "62-65",
          "snippet": "static inline struct isofs_sb_info *ISOFS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <asm/unaligned.h>",
            "#include <linux/iso_fs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unaligned.h>\n#include <linux/iso_fs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline struct isofs_sb_info *ISOFS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nint\nget_joliet_filename(struct iso_directory_record * de, unsigned char *outname, struct inode * inode)\n{\n\tunsigned char utf8;\n\tstruct nls_table *nls;\n\tunsigned char len = 0;\n\n\tutf8 = ISOFS_SB(inode->i_sb)->s_utf8;\n\tnls = ISOFS_SB(inode->i_sb)->s_nls_iocharset;\n\n\tif (utf8) {\n\t\tlen = utf16s_to_utf8s((const wchar_t *) de->name,\n\t\t\t\tde->name_len[0] >> 1, UTF16_BIG_ENDIAN,\n\t\t\t\toutname, PAGE_SIZE);\n\t} else {\n\t\tlen = uni16_to_x8(outname, (__be16 *) de->name,\n\t\t\t\tde->name_len[0] >> 1, nls);\n\t}\n\tif ((len > 2) && (outname[len-2] == ';') && (outname[len-1] == '1'))\n\t\tlen -= 2;\n\n\t/*\n\t * Windows doesn't like periods at the end of a name,\n\t * so neither do we\n\t */\n\twhile (len >= 2 && (outname[len-1] == '.'))\n\t\tlen--;\n\n\treturn len;\n}"
  },
  {
    "function_name": "uni16_to_x8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/isofs/joliet.c",
    "lines": "16-38",
    "snippet": "static int\nuni16_to_x8(unsigned char *ascii, __be16 *uni, int len, struct nls_table *nls)\n{\n\t__be16 *ip, ch;\n\tunsigned char *op;\n\n\tip = uni;\n\top = ascii;\n\n\twhile ((ch = get_unaligned(ip)) && len) {\n\t\tint llen;\n\t\tllen = nls->uni2char(be16_to_cpu(ch), op, NLS_MAX_CHARSET_SIZE);\n\t\tif (llen > 0)\n\t\t\top += llen;\n\t\telse\n\t\t\t*op++ = '?';\n\t\tip++;\n\n\t\tlen--;\n\t}\n\t*op = 0;\n\treturn (op - ascii);\n}",
    "includes": [
      "#include \"isofs.h\"",
      "#include <linux/nls.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nls->uni2char",
          "args": [
            "be16_to_cpu(ch)",
            "op",
            "NLS_MAX_CHARSET_SIZE"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "uni2char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nls/nls_cp932.c",
          "lines": "7837-7875",
          "snippet": "static int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}",
          "includes": [
            "#include <linux/errno.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};",
            "static const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/errno.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const unsigned char u2c_00hi[256 - 0xA0][2] = {\n\t{0x00, 0x00}, {0x00, 0x00}, {0x81, 0x91}, {0x81, 0x92},/* 0xA0-0xA3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x98},/* 0xA4-0xA7 */\n\t{0x81, 0x4E}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xA8-0xAB */\n\t{0x81, 0xCA}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xAC-0xAF */\n\t{0x81, 0x8B}, {0x81, 0x7D}, {0x00, 0x00}, {0x00, 0x00},/* 0xB0-0xB3 */\n\t{0x81, 0x4C}, {0x00, 0x00}, {0x81, 0xF7}, {0x00, 0x00},/* 0xB4-0xB7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xB8-0xBB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xBC-0xBF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC0-0xC3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC4-0xC7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xC8-0xCB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xCC-0xCF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD0-0xD3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x7E},/* 0xD4-0xD7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xD8-0xDB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xDC-0xDF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE0-0xE3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE4-0xE7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xE8-0xEB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xEC-0xEF */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF0-0xF3 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x81, 0x80},/* 0xF4-0xF7 */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xF8-0xFB */\n\t{0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00}, {0x00, 0x00},/* 0xFC-0xFF */\n};\nstatic const unsigned char *const page_uni2charset[256] = {\n\tNULL,   NULL,   NULL,   u2c_03, u2c_04, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_20, u2c_21, u2c_22, u2c_23, u2c_24, u2c_25, u2c_26, NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tu2c_30, NULL,   u2c_32, u2c_33, NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   u2c_4E, u2c_4F, \n\tu2c_50, u2c_51, u2c_52, u2c_53, u2c_54, u2c_55, u2c_56, u2c_57, \n\tu2c_58, u2c_59, u2c_5A, u2c_5B, u2c_5C, u2c_5D, u2c_5E, u2c_5F, \n\tu2c_60, u2c_61, u2c_62, u2c_63, u2c_64, u2c_65, u2c_66, u2c_67, \n\tu2c_68, u2c_69, u2c_6A, u2c_6B, u2c_6C, u2c_6D, u2c_6E, u2c_6F, \n\tu2c_70, u2c_71, u2c_72, u2c_73, u2c_74, u2c_75, u2c_76, u2c_77, \n\tu2c_78, u2c_79, u2c_7A, u2c_7B, u2c_7C, u2c_7D, u2c_7E, u2c_7F, \n\tu2c_80, u2c_81, u2c_82, u2c_83, u2c_84, u2c_85, u2c_86, u2c_87, \n\tu2c_88, u2c_89, u2c_8A, u2c_8B, u2c_8C, u2c_8D, u2c_8E, u2c_8F, \n\tu2c_90, u2c_91, u2c_92, u2c_93, u2c_94, u2c_95, u2c_96, u2c_97, \n\tu2c_98, u2c_99, u2c_9A, u2c_9B, u2c_9C, u2c_9D, u2c_9E, u2c_9F, \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   u2c_DC, NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   NULL,   \n\tNULL,   u2c_F9, u2c_FA, NULL,   NULL,   NULL,   NULL,   u2c_FF, };\n\nstatic int uni2char(const wchar_t uni,\n\t\t    unsigned char *out, int boundlen)\n{\n\tconst unsigned char *uni2charset;\n\tunsigned char cl = uni&0xFF;\n\tunsigned char ch = (uni>>8)&0xFF;\n\n\tif (boundlen <= 0)\n\t\treturn -ENAMETOOLONG;\n\n\tif (ch == 0xFF && 0x61 <= cl && cl <= 0x9F) {\n\t\tout[0] = cl + 0x40;\n\t\treturn 1;\n\t}\n\tuni2charset = page_uni2charset[ch];\n\tif (uni2charset) {\n\t\tif (boundlen < 2)\n\t\t\treturn -ENAMETOOLONG;\n\n\t\tout[0] = uni2charset[cl*2];\n\t\tout[1] = uni2charset[cl*2+1];\n\t\tif (out[0] == 0x00 && out[1] == 0x00)\n\t\t\treturn -EINVAL;\n\t\treturn 2;\n\t} else if (ch == 0) {\n\t\tif (cl <= 0x7F) {\n\t\t\tout[0] = cl;\n\t\t\treturn 1;\n\t\t} else if (0xA0 <= cl) {\n\t\t\tout[0] = u2c_00hi[cl - 0xA0][0];\n\t\t\tout[1] = u2c_00hi[cl - 0xA0][1];\n\t\t\tif (out[0] && out[1])\n\t\t\t\treturn 2;\n\t\t}\n\t\treturn -EINVAL;\n\t}\n\telse\n\t\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be16_to_cpu",
          "args": [
            "ch"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_unaligned",
          "args": [
            "ip"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "get_unaligned_le8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/struct-funcs.c",
          "lines": "24-27",
          "snippet": "static inline u8 get_unaligned_le8(const void *p)\n{\n       return *(u8 *)p;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/highmem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/highmem.h>\n\nstatic inline u8 get_unaligned_le8(const void *p)\n{\n       return *(u8 *)p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"isofs.h\"\n#include <linux/nls.h>\n#include <linux/types.h>\n\nstatic int\nuni16_to_x8(unsigned char *ascii, __be16 *uni, int len, struct nls_table *nls)\n{\n\t__be16 *ip, ch;\n\tunsigned char *op;\n\n\tip = uni;\n\top = ascii;\n\n\twhile ((ch = get_unaligned(ip)) && len) {\n\t\tint llen;\n\t\tllen = nls->uni2char(be16_to_cpu(ch), op, NLS_MAX_CHARSET_SIZE);\n\t\tif (llen > 0)\n\t\t\top += llen;\n\t\telse\n\t\t\t*op++ = '?';\n\t\tip++;\n\n\t\tlen--;\n\t}\n\t*op = 0;\n\treturn (op - ascii);\n}"
  }
]