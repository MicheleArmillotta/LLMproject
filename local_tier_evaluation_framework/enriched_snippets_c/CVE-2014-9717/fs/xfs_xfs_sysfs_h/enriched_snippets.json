[
  {
    "function_name": "xfs_sysfs_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
    "lines": "51-58",
    "snippet": "static inline void\nxfs_sysfs_del(\n\tstruct xfs_kobj\t*kobj)\n{\n\tkobject_del(&kobj->kobject);\n\tkobject_put(&kobj->kobject);\n\twait_for_completion(&kobj->complete);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&kobj->complete"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&kobj->kobject"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&kobj->kobject"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void\nxfs_sysfs_del(\n\tstruct xfs_kobj\t*kobj)\n{\n\tkobject_del(&kobj->kobject);\n\tkobject_put(&kobj->kobject);\n\twait_for_completion(&kobj->complete);\n}"
  },
  {
    "function_name": "xfs_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
    "lines": "39-49",
    "snippet": "static inline int\nxfs_sysfs_init(\n\tstruct xfs_kobj\t\t*kobj,\n\tstruct kobj_type\t*ktype,\n\tstruct xfs_kobj\t\t*parent_kobj,\n\tconst char\t\t*name)\n{\n\tinit_completion(&kobj->complete);\n\treturn kobject_init_and_add(&kobj->kobject, ktype,\n\t\t\t\t    &parent_kobj->kobject, \"%s\", name);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&kobj->kobject",
            "ktype",
            "&parent_kobj->kobject",
            "\"%s\"",
            "name"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&kobj->complete"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int\nxfs_sysfs_init(\n\tstruct xfs_kobj\t\t*kobj,\n\tstruct kobj_type\t*ktype,\n\tstruct xfs_kobj\t\t*parent_kobj,\n\tconst char\t\t*name)\n{\n\tinit_completion(&kobj->complete);\n\treturn kobject_init_and_add(&kobj->kobject, ktype,\n\t\t\t\t    &parent_kobj->kobject, \"%s\", name);\n}"
  },
  {
    "function_name": "xfs_sysfs_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
    "lines": "32-37",
    "snippet": "static inline void\nxfs_sysfs_release(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\tcomplete(&kobj->complete);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&kobj->complete"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "dio_aio_complete_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/direct-io.c",
          "lines": "275-280",
          "snippet": "static void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}",
          "includes": [
            "#include <linux/aio.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/atomic.h>",
            "#include <linux/uio.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/err.h>",
            "#include <linux/wait.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/aio.h>\n#include <linux/prefetch.h>\n#include <linux/atomic.h>\n#include <linux/uio.h>\n#include <linux/rwsem.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/err.h>\n#include <linux/wait.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_kobj",
          "args": [
            "kobject"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "to_kobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
          "lines": "26-30",
          "snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void\nxfs_sysfs_release(struct kobject *kobject)\n{\n\tstruct xfs_kobj *kobj = to_kobj(kobject);\n\tcomplete(&kobj->complete);\n}"
  },
  {
    "function_name": "to_kobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_sysfs.h",
    "lines": "26-30",
    "snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobject",
            "structxfs_kobj",
            "kobject"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline struct xfs_kobj *\nto_kobj(struct kobject *kobject)\n{\n\treturn container_of(kobject, struct xfs_kobj, kobject);\n}"
  }
]