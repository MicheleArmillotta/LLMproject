[
  {
    "function_name": "param_set_portnr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2839-2851",
    "snippet": "static int param_set_portnr(const char *val, const struct kernel_param *kp)\n{\n\tunsigned long num;\n\tint ret;\n\n\tif (!val)\n\t\treturn -EINVAL;\n\tret = kstrtoul(val, 0, &num);\n\tif (ret == -EINVAL || num > NFS_CALLBACK_MAXPORTNR)\n\t\treturn -EINVAL;\n\t*((unsigned int *)kp->arg) = num;\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_CALLBACK_MAXPORTNR (65535U)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoul",
          "args": [
            "val",
            "0",
            "&num"
          ],
          "line": 2846
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_CALLBACK_MAXPORTNR (65535U)\n\nstatic int param_set_portnr(const char *val, const struct kernel_param *kp)\n{\n\tunsigned long num;\n\tint ret;\n\n\tif (!val)\n\t\treturn -EINVAL;\n\tret = kstrtoul(val, 0, &num);\n\tif (ret == -EINVAL || num > NFS_CALLBACK_MAXPORTNR)\n\t\treturn -EINVAL;\n\t*((unsigned int *)kp->arg) = num;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs4_validate_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2715-2811",
    "snippet": "static int nfs4_validate_mount_data(void *options,\n\t\t\t\t    struct nfs_parsed_mount_data *args,\n\t\t\t\t    const char *dev_name)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tstruct nfs4_mount_data *data = (struct nfs4_mount_data *)options;\n\tchar *c;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = 4;\n\n\tswitch (data->version) {\n\tcase 1:\n\t\tif (data->host_addrlen > sizeof(args->nfs_server.address))\n\t\t\tgoto out_no_address;\n\t\tif (data->host_addrlen == 0)\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.addrlen = data->host_addrlen;\n\t\tif (copy_from_user(sap, data->host_addr, data->host_addrlen))\n\t\t\treturn -EFAULT;\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.port = ntohs(((struct sockaddr_in *)sap)->sin_port);\n\n\t\tif (data->auth_flavourlen) {\n\t\t\trpc_authflavor_t pseudoflavor;\n\t\t\tif (data->auth_flavourlen > 1)\n\t\t\t\tgoto out_inval_auth;\n\t\t\tif (copy_from_user(&pseudoflavor,\n\t\t\t\t\t   data->auth_flavours,\n\t\t\t\t\t   sizeof(pseudoflavor)))\n\t\t\t\treturn -EFAULT;\n\t\t\targs->selected_flavor = pseudoflavor;\n\t\t} else\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\n\t\tc = strndup_user(data->hostname.data, NFS4_MAXNAMLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.hostname = c;\n\n\t\tc = strndup_user(data->mnt_path.data, NFS4_MAXPATHLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.export_path = c;\n\t\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", c);\n\n\t\tc = strndup_user(data->client_addr.data, 16);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->client_address = c;\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs4_fill_super\n\t\t * can deal with.\n\t\t */\n\n\t\targs->flags\t= data->flags & NFS4_MOUNT_FLAGMASK;\n\t\targs->rsize\t= data->rsize;\n\t\targs->wsize\t= data->wsize;\n\t\targs->timeo\t= data->timeo;\n\t\targs->retrans\t= data->retrans;\n\t\targs->acregmin\t= data->acregmin;\n\t\targs->acregmax\t= data->acregmax;\n\t\targs->acdirmin\t= data->acdirmin;\n\t\targs->acdirmax\t= data->acdirmax;\n\t\targs->nfs_server.protocol = data->proto;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_inval_auth:\n\tdfprintk(MOUNT, \"NFS4: Invalid number of RPC auth flavours %d\\n\",\n\t\t data->auth_flavourlen);\n\treturn -EINVAL;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_TEXT_DATA\t\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFSv4: Unsupported transport protocol udp\\n\""
          ],
          "line": 2809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS4: mount program didn't pass remote address\\n\""
          ],
          "line": 2805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS4: Invalid number of RPC auth flavours %d\\n\"",
            "data->auth_flavourlen"
          ],
          "line": 2800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS4: mount program didn't pass any mount data\\n\""
          ],
          "line": 2796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_validate_transport_protocol",
          "args": [
            "args"
          ],
          "line": 2784
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_validate_transport_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "991-1001",
          "snippet": "static void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "c"
          ],
          "line": 2766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "c"
          ],
          "line": 2765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strndup_user",
          "args": [
            "data->client_addr.data",
            "16"
          ],
          "line": 2764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: MNTPATH: '%s'\\n\"",
            "c"
          ],
          "line": 2762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "c"
          ],
          "line": 2760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "c"
          ],
          "line": 2759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strndup_user",
          "args": [
            "data->mnt_path.data",
            "NFS4_MAXPATHLEN"
          ],
          "line": 2758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "c"
          ],
          "line": 2755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "c"
          ],
          "line": 2754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strndup_user",
          "args": [
            "data->hostname.data",
            "NFS4_MAXNAMLEN"
          ],
          "line": 2753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&pseudoflavor",
            "data->auth_flavours",
            "sizeof(pseudoflavor)"
          ],
          "line": 2745
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "((struct sockaddr_in *)sap)->sin_port"
          ],
          "line": 2739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_verify_server_address",
          "args": [
            "sap"
          ],
          "line": 2737
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_verify_server_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "957-972",
          "snippet": "static int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_TEXT_DATA\t\t1\n\nstatic int nfs4_validate_mount_data(void *options,\n\t\t\t\t    struct nfs_parsed_mount_data *args,\n\t\t\t\t    const char *dev_name)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tstruct nfs4_mount_data *data = (struct nfs4_mount_data *)options;\n\tchar *c;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = 4;\n\n\tswitch (data->version) {\n\tcase 1:\n\t\tif (data->host_addrlen > sizeof(args->nfs_server.address))\n\t\t\tgoto out_no_address;\n\t\tif (data->host_addrlen == 0)\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.addrlen = data->host_addrlen;\n\t\tif (copy_from_user(sap, data->host_addr, data->host_addrlen))\n\t\t\treturn -EFAULT;\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.port = ntohs(((struct sockaddr_in *)sap)->sin_port);\n\n\t\tif (data->auth_flavourlen) {\n\t\t\trpc_authflavor_t pseudoflavor;\n\t\t\tif (data->auth_flavourlen > 1)\n\t\t\t\tgoto out_inval_auth;\n\t\t\tif (copy_from_user(&pseudoflavor,\n\t\t\t\t\t   data->auth_flavours,\n\t\t\t\t\t   sizeof(pseudoflavor)))\n\t\t\t\treturn -EFAULT;\n\t\t\targs->selected_flavor = pseudoflavor;\n\t\t} else\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\n\t\tc = strndup_user(data->hostname.data, NFS4_MAXNAMLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.hostname = c;\n\n\t\tc = strndup_user(data->mnt_path.data, NFS4_MAXPATHLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.export_path = c;\n\t\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", c);\n\n\t\tc = strndup_user(data->client_addr.data, 16);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->client_address = c;\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs4_fill_super\n\t\t * can deal with.\n\t\t */\n\n\t\targs->flags\t= data->flags & NFS4_MOUNT_FLAGMASK;\n\t\targs->rsize\t= data->rsize;\n\t\targs->wsize\t= data->wsize;\n\t\targs->timeo\t= data->timeo;\n\t\targs->retrans\t= data->retrans;\n\t\targs->acregmin\t= data->acregmin;\n\t\targs->acregmax\t= data->acregmax;\n\t\targs->acdirmin\t= data->acdirmin;\n\t\targs->acdirmax\t= data->acdirmax;\n\t\targs->nfs_server.protocol = data->proto;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_inval_auth:\n\tdfprintk(MOUNT, \"NFS4: Invalid number of RPC auth flavours %d\\n\",\n\t\t data->auth_flavourlen);\n\treturn -EINVAL;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "nfs4_validate_mount_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2706-2710",
    "snippet": "static void nfs4_validate_mount_flags(struct nfs_parsed_mount_data *args)\n{\n\targs->flags &= ~(NFS_MOUNT_NONLM|NFS_MOUNT_NOACL|NFS_MOUNT_VER3|\n\t\t\t NFS_MOUNT_LOCAL_FLOCK|NFS_MOUNT_LOCAL_FCNTL);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs4_validate_mount_flags(struct nfs_parsed_mount_data *args)\n{\n\targs->flags &= ~(NFS_MOUNT_NONLM|NFS_MOUNT_NOACL|NFS_MOUNT_VER3|\n\t\t\t NFS_MOUNT_LOCAL_FLOCK|NFS_MOUNT_LOCAL_FCNTL);\n}"
  },
  {
    "function_name": "nfs_xdev_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2672-2702",
    "snippet": "static struct dentry *\nnfs_xdev_mount(struct file_system_type *fs_type, int flags,\n\t\tconst char *dev_name, void *raw_data)\n{\n\tstruct nfs_clone_mount *data = raw_data;\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_clone_super,\n\t\t.set_security = nfs_clone_sb_security,\n\t\t.cloned = data,\n\t};\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tstruct nfs_subversion *nfs_mod = NFS_SB(data->sb)->nfs_client->cl_nfs_mod;\n\n\tdprintk(\"--> nfs_xdev_mount()\\n\");\n\n\tmount_info.mntfh = mount_info.cloned->fh;\n\n\t/* create a new volume representation */\n\tserver = nfs_mod->rpc_ops->clone_server(NFS_SB(data->sb), data->fh, data->fattr, data->authflavor);\n\n\tif (IS_ERR(server))\n\t\tmntroot = ERR_CAST(server);\n\telse\n\t\tmntroot = nfs_fs_mount_common(server, flags,\n\t\t\t\tdev_name, &mount_info, nfs_mod);\n\n\tdprintk(\"<-- nfs_xdev_mount() = %ld\\n\",\n\t\t\tIS_ERR(mntroot) ? PTR_ERR(mntroot) : 0L);\n\treturn mntroot;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"<-- nfs_xdev_mount() = %ld\\n\"",
            "IS_ERR(mntroot) ? PTR_ERR(mntroot) : 0L"
          ],
          "line": 2699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "mntroot"
          ],
          "line": 2700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "mntroot"
          ],
          "line": 2700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_fs_mount_common",
          "args": [
            "server",
            "flags",
            "dev_name",
            "&mount_info",
            "nfs_mod"
          ],
          "line": 2696
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_mount_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2535-2608",
          "snippet": "struct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "server"
          ],
          "line": 2694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server"
          ],
          "line": 2693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->clone_server",
          "args": [
            "NFS_SB(data->sb)",
            "data->fh",
            "data->fattr",
            "data->authflavor"
          ],
          "line": 2691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "data->sb"
          ],
          "line": 2691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"--> nfs_xdev_mount()\\n\""
          ],
          "line": 2686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "data->sb"
          ],
          "line": 2684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2683
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);\n\nstatic struct dentry *\nnfs_xdev_mount(struct file_system_type *fs_type, int flags,\n\t\tconst char *dev_name, void *raw_data)\n{\n\tstruct nfs_clone_mount *data = raw_data;\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_clone_super,\n\t\t.set_security = nfs_clone_sb_security,\n\t\t.cloned = data,\n\t};\n\tstruct nfs_server *server;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tstruct nfs_subversion *nfs_mod = NFS_SB(data->sb)->nfs_client->cl_nfs_mod;\n\n\tdprintk(\"--> nfs_xdev_mount()\\n\");\n\n\tmount_info.mntfh = mount_info.cloned->fh;\n\n\t/* create a new volume representation */\n\tserver = nfs_mod->rpc_ops->clone_server(NFS_SB(data->sb), data->fh, data->fattr, data->authflavor);\n\n\tif (IS_ERR(server))\n\t\tmntroot = ERR_CAST(server);\n\telse\n\t\tmntroot = nfs_fs_mount_common(server, flags,\n\t\t\t\tdev_name, &mount_info, nfs_mod);\n\n\tdprintk(\"<-- nfs_xdev_mount() = %ld\\n\",\n\t\t\tIS_ERR(mntroot) ? PTR_ERR(mntroot) : 0L);\n\treturn mntroot;\n}"
  },
  {
    "function_name": "nfs_kill_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2655-2666",
    "snippet": "void nfs_kill_super(struct super_block *s)\n{\n\tstruct nfs_server *server = NFS_SB(s);\n\tdev_t dev = s->s_dev;\n\n\tgeneric_shutdown_super(s);\n\n\tnfs_fscache_release_super_cookie(s);\n\n\tnfs_free_server(server);\n\tfree_anon_bdev(dev);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_anon_bdev",
          "args": [
            "dev"
          ],
          "line": 2665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 2664
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fscache_release_super_cookie",
          "args": [
            "s"
          ],
          "line": 2662
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_release_super_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "159-176",
          "snippet": "void nfs_fscache_release_super_cookie(struct super_block *sb)\n{\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\n\tdfprintk(FSCACHE, \"NFS: releasing superblock cookie (0x%p/0x%p)\\n\",\n\t\t nfss, nfss->fscache);\n\n\tfscache_relinquish_cookie(nfss->fscache, 0);\n\tnfss->fscache = NULL;\n\n\tif (nfss->fscache_key) {\n\t\tspin_lock(&nfs_fscache_keys_lock);\n\t\trb_erase(&nfss->fscache_key->node, &nfs_fscache_keys);\n\t\tspin_unlock(&nfs_fscache_keys_lock);\n\t\tkfree(nfss->fscache_key);\n\t\tnfss->fscache_key = NULL;\n\t}\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rb_root nfs_fscache_keys = RB_ROOT;",
            "static DEFINE_SPINLOCK(nfs_fscache_keys_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstatic struct rb_root nfs_fscache_keys = RB_ROOT;\nstatic DEFINE_SPINLOCK(nfs_fscache_keys_lock);\n\nvoid nfs_fscache_release_super_cookie(struct super_block *sb)\n{\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\n\tdfprintk(FSCACHE, \"NFS: releasing superblock cookie (0x%p/0x%p)\\n\",\n\t\t nfss, nfss->fscache);\n\n\tfscache_relinquish_cookie(nfss->fscache, 0);\n\tnfss->fscache = NULL;\n\n\tif (nfss->fscache_key) {\n\t\tspin_lock(&nfs_fscache_keys_lock);\n\t\trb_erase(&nfss->fscache_key->node, &nfs_fscache_keys);\n\t\tspin_unlock(&nfs_fscache_keys_lock);\n\t\tkfree(nfss->fscache_key);\n\t\tnfss->fscache_key = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "generic_shutdown_super",
          "args": [
            "s"
          ],
          "line": 2660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "s"
          ],
          "line": 2657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_kill_super(struct super_block *s)\n{\n\tstruct nfs_server *server = NFS_SB(s);\n\tdev_t dev = s->s_dev;\n\n\tgeneric_shutdown_super(s);\n\n\tnfs_fscache_release_super_cookie(s);\n\n\tnfs_free_server(server);\n\tfree_anon_bdev(dev);\n}"
  },
  {
    "function_name": "nfs_fs_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2611-2649",
    "snippet": "struct dentry *nfs_fs_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data)\n{\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_fill_super,\n\t\t.set_security = nfs_set_sb_security,\n\t};\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tstruct nfs_subversion *nfs_mod;\n\tint error;\n\n\tmount_info.parsed = nfs_alloc_parsed_mount_data();\n\tmount_info.mntfh = nfs_alloc_fhandle();\n\tif (mount_info.parsed == NULL || mount_info.mntfh == NULL)\n\t\tgoto out;\n\n\t/* Validate the mount data */\n\terror = nfs_validate_mount_data(fs_type, raw_data, mount_info.parsed, mount_info.mntfh, dev_name);\n\tif (error == NFS_TEXT_DATA)\n\t\terror = nfs_validate_text_mount_data(raw_data, mount_info.parsed, dev_name);\n\tif (error < 0) {\n\t\tmntroot = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\tnfs_mod = get_nfs_version(mount_info.parsed->version);\n\tif (IS_ERR(nfs_mod)) {\n\t\tmntroot = ERR_CAST(nfs_mod);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_mod->rpc_ops->try_mount(flags, dev_name, &mount_info, nfs_mod);\n\n\tput_nfs_version(nfs_mod);\nout:\n\tnfs_free_parsed_mount_data(mount_info.parsed);\n\tnfs_free_fhandle(mount_info.mntfh);\n\treturn mntroot;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_TEXT_DATA\t\t1"
    ],
    "globals_used": [
      "static struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_free_fhandle",
          "args": [
            "mount_info.mntfh"
          ],
          "line": 2647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_parsed_mount_data",
          "args": [
            "mount_info.parsed"
          ],
          "line": 2646
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_parsed_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "938-949",
          "snippet": "static void nfs_free_parsed_mount_data(struct nfs_parsed_mount_data *data)\n{\n\tif (data) {\n\t\tkfree(data->client_address);\n\t\tkfree(data->mount_server.hostname);\n\t\tkfree(data->nfs_server.export_path);\n\t\tkfree(data->nfs_server.hostname);\n\t\tkfree(data->fscache_uniq);\n\t\tsecurity_free_mnt_opts(&data->lsm_opts);\n\t\tkfree(data);\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_free_parsed_mount_data(struct nfs_parsed_mount_data *data)\n{\n\tif (data) {\n\t\tkfree(data->client_address);\n\t\tkfree(data->mount_server.hostname);\n\t\tkfree(data->nfs_server.export_path);\n\t\tkfree(data->nfs_server.hostname);\n\t\tkfree(data->fscache_uniq);\n\t\tsecurity_free_mnt_opts(&data->lsm_opts);\n\t\tkfree(data);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_nfs_version",
          "args": [
            "nfs_mod"
          ],
          "line": 2644
        },
        "resolved": true,
        "details": {
          "function_name": "put_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "118-121",
          "snippet": "void put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid put_nfs_version(struct nfs_subversion *nfs)\n{\n\tmodule_put(nfs->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->try_mount",
          "args": [
            "flags",
            "dev_name",
            "&mount_info",
            "nfs_mod"
          ],
          "line": 2642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "nfs_mod"
          ],
          "line": 2638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nfs_mod"
          ],
          "line": 2637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_nfs_version",
          "args": [
            "mount_info.parsed->version"
          ],
          "line": 2636
        },
        "resolved": true,
        "details": {
          "function_name": "get_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "102-116",
          "snippet": "struct nfs_subversion *get_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs = find_nfs_version(version);\n\n\tif (IS_ERR(nfs)) {\n\t\tmutex_lock(&nfs_version_mutex);\n\t\trequest_module(\"nfsv%d\", version);\n\t\tnfs = find_nfs_version(version);\n\t\tmutex_unlock(&nfs_version_mutex);\n\t}\n\n\tif (!IS_ERR(nfs) && !try_module_get(nfs->owner))\n\t\treturn ERR_PTR(-EAGAIN);\n\treturn nfs;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(nfs_version_mutex);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_MUTEX(nfs_version_mutex);\n\nstruct nfs_subversion *get_nfs_version(unsigned int version)\n{\n\tstruct nfs_subversion *nfs = find_nfs_version(version);\n\n\tif (IS_ERR(nfs)) {\n\t\tmutex_lock(&nfs_version_mutex);\n\t\trequest_module(\"nfsv%d\", version);\n\t\tnfs = find_nfs_version(version);\n\t\tmutex_unlock(&nfs_version_mutex);\n\t}\n\n\tif (!IS_ERR(nfs) && !try_module_get(nfs->owner))\n\t\treturn ERR_PTR(-EAGAIN);\n\treturn nfs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 2632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_validate_text_mount_data",
          "args": [
            "raw_data",
            "mount_info.parsed",
            "dev_name"
          ],
          "line": 2630
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_validate_text_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2120-2171",
          "snippet": "static int nfs_validate_text_mount_data(void *options,\n\t\t\t\t\tstruct nfs_parsed_mount_data *args,\n\t\t\t\t\tconst char *dev_name)\n{\n\tint port = 0;\n\tint max_namelen = PAGE_SIZE;\n\tint max_pathlen = NFS_MAXPATHLEN;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\n\tif (nfs_parse_mount_options((char *)options, args) == 0)\n\t\treturn -EINVAL;\n\n\tif (!nfs_verify_server_address(sap))\n\t\tgoto out_no_address;\n\n\tif (args->version == 4) {\n#if IS_ENABLED(CONFIG_NFS_V4)\n\t\tport = NFS_PORT;\n\t\tmax_namelen = NFS4_MAXNAMLEN;\n\t\tmax_pathlen = NFS4_MAXPATHLEN;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\t\tnfs4_validate_mount_flags(args);\n#else\n\t\tgoto out_v4_not_compiled;\n#endif /* CONFIG_NFS_V4 */\n\t} else\n\t\tnfs_set_mount_transport_protocol(args);\n\n\tnfs_set_port(sap, &args->nfs_server.port, port);\n\n\treturn nfs_parse_devname(dev_name,\n\t\t\t\t   &args->nfs_server.hostname,\n\t\t\t\t   max_namelen,\n\t\t\t\t   &args->nfs_server.export_path,\n\t\t\t\t   max_pathlen);\n\n#if !IS_ENABLED(CONFIG_NFS_V4)\nout_v4_not_compiled:\n\tdfprintk(MOUNT, \"NFS: NFSv4 is not compiled into kernel\\n\");\n\treturn -EPROTONOSUPPORT;\n#else\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n#endif /* !CONFIG_NFS_V4 */\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_validate_text_mount_data(void *options,\n\t\t\t\t\tstruct nfs_parsed_mount_data *args,\n\t\t\t\t\tconst char *dev_name)\n{\n\tint port = 0;\n\tint max_namelen = PAGE_SIZE;\n\tint max_pathlen = NFS_MAXPATHLEN;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\n\tif (nfs_parse_mount_options((char *)options, args) == 0)\n\t\treturn -EINVAL;\n\n\tif (!nfs_verify_server_address(sap))\n\t\tgoto out_no_address;\n\n\tif (args->version == 4) {\n#if IS_ENABLED(CONFIG_NFS_V4)\n\t\tport = NFS_PORT;\n\t\tmax_namelen = NFS4_MAXNAMLEN;\n\t\tmax_pathlen = NFS4_MAXPATHLEN;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\t\tnfs4_validate_mount_flags(args);\n#else\n\t\tgoto out_v4_not_compiled;\n#endif /* CONFIG_NFS_V4 */\n\t} else\n\t\tnfs_set_mount_transport_protocol(args);\n\n\tnfs_set_port(sap, &args->nfs_server.port, port);\n\n\treturn nfs_parse_devname(dev_name,\n\t\t\t\t   &args->nfs_server.hostname,\n\t\t\t\t   max_namelen,\n\t\t\t\t   &args->nfs_server.export_path,\n\t\t\t\t   max_pathlen);\n\n#if !IS_ENABLED(CONFIG_NFS_V4)\nout_v4_not_compiled:\n\tdfprintk(MOUNT, \"NFS: NFSv4 is not compiled into kernel\\n\");\n\treturn -EPROTONOSUPPORT;\n#else\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n#endif /* !CONFIG_NFS_V4 */\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_validate_mount_data",
          "args": [
            "fs_type",
            "raw_data",
            "mount_info.parsed",
            "mount_info.mntfh",
            "dev_name"
          ],
          "line": 2628
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_validate_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2110-2117",
          "snippet": "static int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fhandle",
          "args": [],
          "line": 2623
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1323-1331",
          "snippet": "struct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nfs_fh *nfs_alloc_fhandle(void)\n{\n\tstruct nfs_fh *fh;\n\n\tfh = kmalloc(sizeof(struct nfs_fh), GFP_NOFS);\n\tif (fh != NULL)\n\t\tfh->size = 0;\n\treturn fh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_alloc_parsed_mount_data",
          "args": [],
          "line": 2622
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_parsed_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "916-936",
          "snippet": "static struct nfs_parsed_mount_data *nfs_alloc_parsed_mount_data(void)\n{\n\tstruct nfs_parsed_mount_data *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data) {\n\t\tdata->acregmin\t\t= NFS_DEF_ACREGMIN;\n\t\tdata->acregmax\t\t= NFS_DEF_ACREGMAX;\n\t\tdata->acdirmin\t\t= NFS_DEF_ACDIRMIN;\n\t\tdata->acdirmax\t\t= NFS_DEF_ACDIRMAX;\n\t\tdata->mount_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\tdata->selected_flavor\t= RPC_AUTH_MAXFLAVOR;\n\t\tdata->minorversion\t= 0;\n\t\tdata->need_mount\t= true;\n\t\tdata->net\t\t= current->nsproxy->net_ns;\n\t\tsecurity_init_mnt_opts(&data->lsm_opts);\n\t}\n\treturn data;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_parsed_mount_data *nfs_alloc_parsed_mount_data(void)\n{\n\tstruct nfs_parsed_mount_data *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data) {\n\t\tdata->acregmin\t\t= NFS_DEF_ACREGMIN;\n\t\tdata->acregmax\t\t= NFS_DEF_ACREGMAX;\n\t\tdata->acdirmin\t\t= NFS_DEF_ACDIRMIN;\n\t\tdata->acdirmax\t\t= NFS_DEF_ACDIRMAX;\n\t\tdata->mount_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\tdata->selected_flavor\t= RPC_AUTH_MAXFLAVOR;\n\t\tdata->minorversion\t= 0;\n\t\tdata->need_mount\t= true;\n\t\tdata->net\t\t= current->nsproxy->net_ns;\n\t\tsecurity_init_mnt_opts(&data->lsm_opts);\n\t}\n\treturn data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2618
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_TEXT_DATA\t\t1\n\nstatic struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);\n\nstruct dentry *nfs_fs_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *raw_data)\n{\n\tstruct nfs_mount_info mount_info = {\n\t\t.fill_super = nfs_fill_super,\n\t\t.set_security = nfs_set_sb_security,\n\t};\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tstruct nfs_subversion *nfs_mod;\n\tint error;\n\n\tmount_info.parsed = nfs_alloc_parsed_mount_data();\n\tmount_info.mntfh = nfs_alloc_fhandle();\n\tif (mount_info.parsed == NULL || mount_info.mntfh == NULL)\n\t\tgoto out;\n\n\t/* Validate the mount data */\n\terror = nfs_validate_mount_data(fs_type, raw_data, mount_info.parsed, mount_info.mntfh, dev_name);\n\tif (error == NFS_TEXT_DATA)\n\t\terror = nfs_validate_text_mount_data(raw_data, mount_info.parsed, dev_name);\n\tif (error < 0) {\n\t\tmntroot = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\tnfs_mod = get_nfs_version(mount_info.parsed->version);\n\tif (IS_ERR(nfs_mod)) {\n\t\tmntroot = ERR_CAST(nfs_mod);\n\t\tgoto out;\n\t}\n\n\tmntroot = nfs_mod->rpc_ops->try_mount(flags, dev_name, &mount_info, nfs_mod);\n\n\tput_nfs_version(nfs_mod);\nout:\n\tnfs_free_parsed_mount_data(mount_info.parsed);\n\tnfs_free_fhandle(mount_info.mntfh);\n\treturn mntroot;\n}"
  },
  {
    "function_name": "nfs_fs_mount_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2535-2608",
    "snippet": "struct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "deactivate_locked_super",
          "args": [
            "s"
          ],
          "line": 2606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 2604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "mntroot"
          ],
          "line": 2603
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_free_server",
          "args": [
            "server"
          ],
          "line": 2599
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_free_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/client.c",
          "lines": "1023-1046",
          "snippet": "void nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/sunrpc/bc_xprt.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <net/ipv6.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/sunrpc/bc_xprt.h>\n#include <linux/nfs_xdr.h>\n#include <net/ipv6.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_free_server(struct nfs_server *server)\n{\n\tdprintk(\"--> nfs_free_server()\\n\");\n\n\tnfs_server_remove_lists(server);\n\n\tif (server->destroy != NULL)\n\t\tserver->destroy(server);\n\n\tif (!IS_ERR(server->client_acl))\n\t\trpc_shutdown_client(server->client_acl);\n\tif (!IS_ERR(server->client))\n\t\trpc_shutdown_client(server->client);\n\n\tnfs_put_client(server->nfs_client);\n\n\tida_destroy(&server->lockowner_id);\n\tida_destroy(&server->openowner_id);\n\tnfs_free_iostats(server->io_stats);\n\tbdi_destroy(&server->backing_dev_info);\n\tkfree(server);\n\tnfs_release_automount_timer();\n\tdprintk(\"<-- nfs_free_server()\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount_info->set_security",
          "args": [
            "s",
            "mntroot",
            "mount_info"
          ],
          "line": 2589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "mntroot"
          ],
          "line": 2586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_root",
          "args": [
            "s",
            "mount_info->mntfh",
            "dev_name"
          ],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/getroot.c",
          "lines": "71-133",
          "snippet": "struct dentry *nfs_get_root(struct super_block *sb, struct nfs_fh *mntfh,\n\t\t\t    const char *devname)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\tstruct nfs_fsinfo fsinfo;\n\tstruct dentry *ret;\n\tstruct inode *inode;\n\tvoid *name = kstrdup(devname, GFP_KERNEL);\n\tint error;\n\n\tif (!name)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get the actual root for this mount */\n\tfsinfo.fattr = nfs_alloc_fattr();\n\tif (fsinfo.fattr == NULL) {\n\t\tkfree(name);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\n\terror = server->nfs_client->rpc_ops->getroot(server, mntfh, &fsinfo);\n\tif (error < 0) {\n\t\tdprintk(\"nfs_get_root: getattr error = %d\\n\", -error);\n\t\tret = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\tinode = nfs_fhget(sb, mntfh, fsinfo.fattr, NULL);\n\tif (IS_ERR(inode)) {\n\t\tdprintk(\"nfs_get_root: get root inode failed\\n\");\n\t\tret = ERR_CAST(inode);\n\t\tgoto out;\n\t}\n\n\terror = nfs_superblock_set_dummy_root(sb, inode);\n\tif (error != 0) {\n\t\tret = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\t/* root dentries normally start off anonymous and get spliced in later\n\t * if the dentry tree reaches them; however if the dentry already\n\t * exists, we'll pick it up at this point and use it as the root\n\t */\n\tret = d_obtain_root(inode);\n\tif (IS_ERR(ret)) {\n\t\tdprintk(\"nfs_get_root: get root dentry failed\\n\");\n\t\tgoto out;\n\t}\n\n\tsecurity_d_instantiate(ret, inode);\n\tspin_lock(&ret->d_lock);\n\tif (IS_ROOT(ret) && !ret->d_fsdata &&\n\t    !(ret->d_flags & DCACHE_NFSFS_RENAMED)) {\n\t\tret->d_fsdata = name;\n\t\tname = NULL;\n\t}\n\tspin_unlock(&ret->d_lock);\nout:\n\tkfree(name);\n\tnfs_free_fattr(fsinfo.fattr);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_get_root(struct super_block *sb, struct nfs_fh *mntfh,\n\t\t\t    const char *devname)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\tstruct nfs_fsinfo fsinfo;\n\tstruct dentry *ret;\n\tstruct inode *inode;\n\tvoid *name = kstrdup(devname, GFP_KERNEL);\n\tint error;\n\n\tif (!name)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\t/* get the actual root for this mount */\n\tfsinfo.fattr = nfs_alloc_fattr();\n\tif (fsinfo.fattr == NULL) {\n\t\tkfree(name);\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\n\terror = server->nfs_client->rpc_ops->getroot(server, mntfh, &fsinfo);\n\tif (error < 0) {\n\t\tdprintk(\"nfs_get_root: getattr error = %d\\n\", -error);\n\t\tret = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\tinode = nfs_fhget(sb, mntfh, fsinfo.fattr, NULL);\n\tif (IS_ERR(inode)) {\n\t\tdprintk(\"nfs_get_root: get root inode failed\\n\");\n\t\tret = ERR_CAST(inode);\n\t\tgoto out;\n\t}\n\n\terror = nfs_superblock_set_dummy_root(sb, inode);\n\tif (error != 0) {\n\t\tret = ERR_PTR(error);\n\t\tgoto out;\n\t}\n\n\t/* root dentries normally start off anonymous and get spliced in later\n\t * if the dentry tree reaches them; however if the dentry already\n\t * exists, we'll pick it up at this point and use it as the root\n\t */\n\tret = d_obtain_root(inode);\n\tif (IS_ERR(ret)) {\n\t\tdprintk(\"nfs_get_root: get root dentry failed\\n\");\n\t\tgoto out;\n\t}\n\n\tsecurity_d_instantiate(ret, inode);\n\tspin_lock(&ret->d_lock);\n\tif (IS_ROOT(ret) && !ret->d_fsdata &&\n\t    !(ret->d_flags & DCACHE_NFSFS_RENAMED)) {\n\t\tret->d_fsdata = name;\n\t\tname = NULL;\n\t}\n\tspin_unlock(&ret->d_lock);\nout:\n\tkfree(name);\n\tnfs_free_fattr(fsinfo.fattr);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_get_cache_cookie",
          "args": [
            "s",
            "mount_info->parsed",
            "mount_info->cloned"
          ],
          "line": 2582
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_cache_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2492-2496",
          "snippet": "static void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount_info->fill_super",
          "args": [
            "s",
            "mount_info"
          ],
          "line": 2581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 2573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_bdi_register",
          "args": [
            "server"
          ],
          "line": 2571
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_bdi_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2499-2502",
          "snippet": "static int nfs_bdi_register(struct nfs_server *server)\n{\n\treturn bdi_register_dev(&server->backing_dev_info, server->s_dev);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_bdi_register(struct nfs_server *server)\n{\n\treturn bdi_register_dev(&server->backing_dev_info, server->s_dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "s"
          ],
          "line": 2563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "s"
          ],
          "line": 2562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sget",
          "args": [
            "nfs_mod->nfs_fs",
            "compare_super",
            "nfs_set_super",
            "flags",
            "&sb_mntdata"
          ],
          "line": 2561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2541
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}"
  },
  {
    "function_name": "nfs_clone_sb_security",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2525-2532",
    "snippet": "int nfs_clone_sb_security(struct super_block *s, struct dentry *mntroot,\n\t\t\t  struct nfs_mount_info *mount_info)\n{\n\t/* clone any lsm security options from the parent to the new sb */\n\tif (mntroot->d_inode->i_op != NFS_SB(s)->nfs_client->rpc_ops->dir_inode_ops)\n\t\treturn -ESTALE;\n\treturn security_sb_clone_mnt_opts(mount_info->cloned->sb, s);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_sb_clone_mnt_opts",
          "args": [
            "mount_info->cloned->sb",
            "s"
          ],
          "line": 2531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "s"
          ],
          "line": 2529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_clone_sb_security(struct super_block *s, struct dentry *mntroot,\n\t\t\t  struct nfs_mount_info *mount_info)\n{\n\t/* clone any lsm security options from the parent to the new sb */\n\tif (mntroot->d_inode->i_op != NFS_SB(s)->nfs_client->rpc_ops->dir_inode_ops)\n\t\treturn -ESTALE;\n\treturn security_sb_clone_mnt_opts(mount_info->cloned->sb, s);\n}"
  },
  {
    "function_name": "nfs_set_sb_security",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2504-2522",
    "snippet": "int nfs_set_sb_security(struct super_block *s, struct dentry *mntroot,\n\t\t\tstruct nfs_mount_info *mount_info)\n{\n\tint error;\n\tunsigned long kflags = 0, kflags_out = 0;\n\tif (NFS_SB(s)->caps & NFS_CAP_SECURITY_LABEL)\n\t\tkflags |= SECURITY_LSM_NATIVE_LABELS;\n\n\terror = security_sb_set_mnt_opts(s, &mount_info->parsed->lsm_opts,\n\t\t\t\t\t\tkflags, &kflags_out);\n\tif (error)\n\t\tgoto err;\n\n\tif (NFS_SB(s)->caps & NFS_CAP_SECURITY_LABEL &&\n\t\t!(kflags_out & SECURITY_LSM_NATIVE_LABELS))\n\t\tNFS_SB(s)->caps &= ~NFS_CAP_SECURITY_LABEL;\nerr:\n\treturn error;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "s"
          ],
          "line": 2519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "s"
          ],
          "line": 2517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_sb_set_mnt_opts",
          "args": [
            "s",
            "&mount_info->parsed->lsm_opts",
            "kflags",
            "&kflags_out"
          ],
          "line": 2512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "s"
          ],
          "line": 2509
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_set_sb_security(struct super_block *s, struct dentry *mntroot,\n\t\t\tstruct nfs_mount_info *mount_info)\n{\n\tint error;\n\tunsigned long kflags = 0, kflags_out = 0;\n\tif (NFS_SB(s)->caps & NFS_CAP_SECURITY_LABEL)\n\t\tkflags |= SECURITY_LSM_NATIVE_LABELS;\n\n\terror = security_sb_set_mnt_opts(s, &mount_info->parsed->lsm_opts,\n\t\t\t\t\t\tkflags, &kflags_out);\n\tif (error)\n\t\tgoto err;\n\n\tif (NFS_SB(s)->caps & NFS_CAP_SECURITY_LABEL &&\n\t\t!(kflags_out & SECURITY_LSM_NATIVE_LABELS))\n\t\tNFS_SB(s)->caps &= ~NFS_CAP_SECURITY_LABEL;\nerr:\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_bdi_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2499-2502",
    "snippet": "static int nfs_bdi_register(struct nfs_server *server)\n{\n\treturn bdi_register_dev(&server->backing_dev_info, server->s_dev);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_register_dev",
          "args": [
            "&server->backing_dev_info",
            "server->s_dev"
          ],
          "line": 2501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_bdi_register(struct nfs_server *server)\n{\n\treturn bdi_register_dev(&server->backing_dev_info, server->s_dev);\n}"
  },
  {
    "function_name": "nfs_get_cache_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2492-2496",
    "snippet": "static void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n}"
  },
  {
    "function_name": "nfs_get_cache_cookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2460-2490",
    "snippet": "static void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\tchar *uniq = NULL;\n\tint ulen = 0;\n\n\tnfss->fscache_key = NULL;\n\tnfss->fscache = NULL;\n\n\tif (parsed) {\n\t\tif (!(parsed->options & NFS_OPTION_FSCACHE))\n\t\t\treturn;\n\t\tif (parsed->fscache_uniq) {\n\t\t\tuniq = parsed->fscache_uniq;\n\t\t\tulen = strlen(parsed->fscache_uniq);\n\t\t}\n\t} else if (cloned) {\n\t\tstruct nfs_server *mnt_s = NFS_SB(cloned->sb);\n\t\tif (!(mnt_s->options & NFS_OPTION_FSCACHE))\n\t\t\treturn;\n\t\tif (mnt_s->fscache_key) {\n\t\t\tuniq = mnt_s->fscache_key->key.uniquifier;\n\t\t\tulen = mnt_s->fscache_key->key.uniq_len;\n\t\t};\n\t} else\n\t\treturn;\n\n\tnfs_fscache_get_super_cookie(sb, uniq, ulen);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fscache_get_super_cookie",
          "args": [
            "sb",
            "uniq",
            "ulen"
          ],
          "line": 2489
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fscache_get_super_cookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/fscache.c",
          "lines": "67-154",
          "snippet": "void nfs_fscache_get_super_cookie(struct super_block *sb, const char *uniq, int ulen)\n{\n\tstruct nfs_fscache_key *key, *xkey;\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\tstruct rb_node **p, *parent;\n\tint diff;\n\n\tif (!uniq) {\n\t\tuniq = \"\";\n\t\tulen = 1;\n\t}\n\n\tkey = kzalloc(sizeof(*key) + ulen, GFP_KERNEL);\n\tif (!key)\n\t\treturn;\n\n\tkey->nfs_client = nfss->nfs_client;\n\tkey->key.super.s_flags = sb->s_flags & NFS_MS_MASK;\n\tkey->key.nfs_server.flags = nfss->flags;\n\tkey->key.nfs_server.rsize = nfss->rsize;\n\tkey->key.nfs_server.wsize = nfss->wsize;\n\tkey->key.nfs_server.acregmin = nfss->acregmin;\n\tkey->key.nfs_server.acregmax = nfss->acregmax;\n\tkey->key.nfs_server.acdirmin = nfss->acdirmin;\n\tkey->key.nfs_server.acdirmax = nfss->acdirmax;\n\tkey->key.nfs_server.fsid = nfss->fsid;\n\tkey->key.rpc_auth.au_flavor = nfss->client->cl_auth->au_flavor;\n\n\tkey->key.uniq_len = ulen;\n\tmemcpy(key->key.uniquifier, uniq, ulen);\n\n\tspin_lock(&nfs_fscache_keys_lock);\n\tp = &nfs_fscache_keys.rb_node;\n\tparent = NULL;\n\twhile (*p) {\n\t\tparent = *p;\n\t\txkey = rb_entry(parent, struct nfs_fscache_key, node);\n\n\t\tif (key->nfs_client < xkey->nfs_client)\n\t\t\tgoto go_left;\n\t\tif (key->nfs_client > xkey->nfs_client)\n\t\t\tgoto go_right;\n\n\t\tdiff = memcmp(&key->key, &xkey->key, sizeof(key->key));\n\t\tif (diff < 0)\n\t\t\tgoto go_left;\n\t\tif (diff > 0)\n\t\t\tgoto go_right;\n\n\t\tif (key->key.uniq_len == 0)\n\t\t\tgoto non_unique;\n\t\tdiff = memcmp(key->key.uniquifier,\n\t\t\t      xkey->key.uniquifier,\n\t\t\t      key->key.uniq_len);\n\t\tif (diff < 0)\n\t\t\tgoto go_left;\n\t\tif (diff > 0)\n\t\t\tgoto go_right;\n\t\tgoto non_unique;\n\n\tgo_left:\n\t\tp = &(*p)->rb_left;\n\t\tcontinue;\n\tgo_right:\n\t\tp = &(*p)->rb_right;\n\t}\n\n\trb_link_node(&key->node, parent, p);\n\trb_insert_color(&key->node, &nfs_fscache_keys);\n\tspin_unlock(&nfs_fscache_keys_lock);\n\tnfss->fscache_key = key;\n\n\t/* create a cache index for looking up filehandles */\n\tnfss->fscache = fscache_acquire_cookie(nfss->nfs_client->fscache,\n\t\t\t\t\t       &nfs_fscache_super_index_def,\n\t\t\t\t\t       nfss, true);\n\tdfprintk(FSCACHE, \"NFS: get superblock cookie (0x%p/0x%p)\\n\",\n\t\t nfss, nfss->fscache);\n\treturn;\n\nnon_unique:\n\tspin_unlock(&nfs_fscache_keys_lock);\n\tkfree(key);\n\tnfss->fscache_key = NULL;\n\tnfss->fscache = NULL;\n\tprintk(KERN_WARNING \"NFS:\"\n\t       \" Cache request denied due to non-unique superblock keys\\n\");\n}",
          "includes": [
            "#include \"fscache.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/in6.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rb_root nfs_fscache_keys = RB_ROOT;",
            "static DEFINE_SPINLOCK(nfs_fscache_keys_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"fscache.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/in6.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstatic struct rb_root nfs_fscache_keys = RB_ROOT;\nstatic DEFINE_SPINLOCK(nfs_fscache_keys_lock);\n\nvoid nfs_fscache_get_super_cookie(struct super_block *sb, const char *uniq, int ulen)\n{\n\tstruct nfs_fscache_key *key, *xkey;\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\tstruct rb_node **p, *parent;\n\tint diff;\n\n\tif (!uniq) {\n\t\tuniq = \"\";\n\t\tulen = 1;\n\t}\n\n\tkey = kzalloc(sizeof(*key) + ulen, GFP_KERNEL);\n\tif (!key)\n\t\treturn;\n\n\tkey->nfs_client = nfss->nfs_client;\n\tkey->key.super.s_flags = sb->s_flags & NFS_MS_MASK;\n\tkey->key.nfs_server.flags = nfss->flags;\n\tkey->key.nfs_server.rsize = nfss->rsize;\n\tkey->key.nfs_server.wsize = nfss->wsize;\n\tkey->key.nfs_server.acregmin = nfss->acregmin;\n\tkey->key.nfs_server.acregmax = nfss->acregmax;\n\tkey->key.nfs_server.acdirmin = nfss->acdirmin;\n\tkey->key.nfs_server.acdirmax = nfss->acdirmax;\n\tkey->key.nfs_server.fsid = nfss->fsid;\n\tkey->key.rpc_auth.au_flavor = nfss->client->cl_auth->au_flavor;\n\n\tkey->key.uniq_len = ulen;\n\tmemcpy(key->key.uniquifier, uniq, ulen);\n\n\tspin_lock(&nfs_fscache_keys_lock);\n\tp = &nfs_fscache_keys.rb_node;\n\tparent = NULL;\n\twhile (*p) {\n\t\tparent = *p;\n\t\txkey = rb_entry(parent, struct nfs_fscache_key, node);\n\n\t\tif (key->nfs_client < xkey->nfs_client)\n\t\t\tgoto go_left;\n\t\tif (key->nfs_client > xkey->nfs_client)\n\t\t\tgoto go_right;\n\n\t\tdiff = memcmp(&key->key, &xkey->key, sizeof(key->key));\n\t\tif (diff < 0)\n\t\t\tgoto go_left;\n\t\tif (diff > 0)\n\t\t\tgoto go_right;\n\n\t\tif (key->key.uniq_len == 0)\n\t\t\tgoto non_unique;\n\t\tdiff = memcmp(key->key.uniquifier,\n\t\t\t      xkey->key.uniquifier,\n\t\t\t      key->key.uniq_len);\n\t\tif (diff < 0)\n\t\t\tgoto go_left;\n\t\tif (diff > 0)\n\t\t\tgoto go_right;\n\t\tgoto non_unique;\n\n\tgo_left:\n\t\tp = &(*p)->rb_left;\n\t\tcontinue;\n\tgo_right:\n\t\tp = &(*p)->rb_right;\n\t}\n\n\trb_link_node(&key->node, parent, p);\n\trb_insert_color(&key->node, &nfs_fscache_keys);\n\tspin_unlock(&nfs_fscache_keys_lock);\n\tnfss->fscache_key = key;\n\n\t/* create a cache index for looking up filehandles */\n\tnfss->fscache = fscache_acquire_cookie(nfss->nfs_client->fscache,\n\t\t\t\t\t       &nfs_fscache_super_index_def,\n\t\t\t\t\t       nfss, true);\n\tdfprintk(FSCACHE, \"NFS: get superblock cookie (0x%p/0x%p)\\n\",\n\t\t nfss, nfss->fscache);\n\treturn;\n\nnon_unique:\n\tspin_unlock(&nfs_fscache_keys_lock);\n\tkfree(key);\n\tnfss->fscache_key = NULL;\n\tnfss->fscache = NULL;\n\tprintk(KERN_WARNING \"NFS:\"\n\t       \" Cache request denied due to non-unique superblock keys\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "cloned->sb"
          ],
          "line": 2479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "parsed->fscache_uniq"
          ],
          "line": 2476
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 2464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_get_cache_cookie(struct super_block *sb,\n\t\t\t\t struct nfs_parsed_mount_data *parsed,\n\t\t\t\t struct nfs_clone_mount *cloned)\n{\n\tstruct nfs_server *nfss = NFS_SB(sb);\n\tchar *uniq = NULL;\n\tint ulen = 0;\n\n\tnfss->fscache_key = NULL;\n\tnfss->fscache = NULL;\n\n\tif (parsed) {\n\t\tif (!(parsed->options & NFS_OPTION_FSCACHE))\n\t\t\treturn;\n\t\tif (parsed->fscache_uniq) {\n\t\t\tuniq = parsed->fscache_uniq;\n\t\t\tulen = strlen(parsed->fscache_uniq);\n\t\t}\n\t} else if (cloned) {\n\t\tstruct nfs_server *mnt_s = NFS_SB(cloned->sb);\n\t\tif (!(mnt_s->options & NFS_OPTION_FSCACHE))\n\t\t\treturn;\n\t\tif (mnt_s->fscache_key) {\n\t\t\tuniq = mnt_s->fscache_key->key.uniquifier;\n\t\t\tulen = mnt_s->fscache_key->key.uniq_len;\n\t\t};\n\t} else\n\t\treturn;\n\n\tnfs_fscache_get_super_cookie(sb, uniq, ulen);\n}"
  },
  {
    "function_name": "nfs_compare_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2443-2457",
    "snippet": "static int nfs_compare_super(struct super_block *sb, void *data)\n{\n\tstruct nfs_sb_mountdata *sb_mntdata = data;\n\tstruct nfs_server *server = sb_mntdata->server, *old = NFS_SB(sb);\n\tint mntflags = sb_mntdata->mntflags;\n\n\tif (!nfs_compare_super_address(old, server))\n\t\treturn 0;\n\t/* Note: NFS_MOUNT_UNSHARED == NFS4_MOUNT_UNSHARED */\n\tif (old->flags & NFS_MOUNT_UNSHARED)\n\t\treturn 0;\n\tif (memcmp(&old->fsid, &server->fsid, sizeof(old->fsid)) != 0)\n\t\treturn 0;\n\treturn nfs_compare_mount_options(sb, server, mntflags);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_compare_mount_options",
          "args": [
            "sb",
            "server",
            "mntflags"
          ],
          "line": 2456
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_compare_mount_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2354-2384",
          "snippet": "static int nfs_compare_mount_options(const struct super_block *s, const struct nfs_server *b, int flags)\n{\n\tconst struct nfs_server *a = s->s_fs_info;\n\tconst struct rpc_clnt *clnt_a = a->client;\n\tconst struct rpc_clnt *clnt_b = b->client;\n\n\tif ((s->s_flags & NFS_MS_MASK) != (flags & NFS_MS_MASK))\n\t\tgoto Ebusy;\n\tif (a->nfs_client != b->nfs_client)\n\t\tgoto Ebusy;\n\tif ((a->flags ^ b->flags) & NFS_MOUNT_CMP_FLAGMASK)\n\t\tgoto Ebusy;\n\tif (a->wsize != b->wsize)\n\t\tgoto Ebusy;\n\tif (a->rsize != b->rsize)\n\t\tgoto Ebusy;\n\tif (a->acregmin != b->acregmin)\n\t\tgoto Ebusy;\n\tif (a->acregmax != b->acregmax)\n\t\tgoto Ebusy;\n\tif (a->acdirmin != b->acdirmin)\n\t\tgoto Ebusy;\n\tif (a->acdirmax != b->acdirmax)\n\t\tgoto Ebusy;\n\tif (b->auth_info.flavor_len > 0 &&\n\t   clnt_a->cl_auth->au_flavor != clnt_b->cl_auth->au_flavor)\n\t\tgoto Ebusy;\n\treturn 1;\nEbusy:\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_MOUNT_CMP_FLAGMASK (NFS_REMOUNT_CMP_FLAGMASK & \\\n\t\t~(NFS_MOUNT_UNSHARED | NFS_MOUNT_NORESVPORT))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_MOUNT_CMP_FLAGMASK (NFS_REMOUNT_CMP_FLAGMASK & \\\n\t\t~(NFS_MOUNT_UNSHARED | NFS_MOUNT_NORESVPORT))\n\nstatic int nfs_compare_mount_options(const struct super_block *s, const struct nfs_server *b, int flags)\n{\n\tconst struct nfs_server *a = s->s_fs_info;\n\tconst struct rpc_clnt *clnt_a = a->client;\n\tconst struct rpc_clnt *clnt_b = b->client;\n\n\tif ((s->s_flags & NFS_MS_MASK) != (flags & NFS_MS_MASK))\n\t\tgoto Ebusy;\n\tif (a->nfs_client != b->nfs_client)\n\t\tgoto Ebusy;\n\tif ((a->flags ^ b->flags) & NFS_MOUNT_CMP_FLAGMASK)\n\t\tgoto Ebusy;\n\tif (a->wsize != b->wsize)\n\t\tgoto Ebusy;\n\tif (a->rsize != b->rsize)\n\t\tgoto Ebusy;\n\tif (a->acregmin != b->acregmin)\n\t\tgoto Ebusy;\n\tif (a->acregmax != b->acregmax)\n\t\tgoto Ebusy;\n\tif (a->acdirmin != b->acdirmin)\n\t\tgoto Ebusy;\n\tif (a->acdirmax != b->acdirmax)\n\t\tgoto Ebusy;\n\tif (b->auth_info.flavor_len > 0 &&\n\t   clnt_a->cl_auth->au_flavor != clnt_b->cl_auth->au_flavor)\n\t\tgoto Ebusy;\n\treturn 1;\nEbusy:\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&old->fsid",
            "&server->fsid",
            "sizeof(old->fsid)"
          ],
          "line": 2454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_compare_super_address",
          "args": [
            "old",
            "server"
          ],
          "line": 2449
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_compare_super_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2406-2441",
          "snippet": "static int nfs_compare_super_address(struct nfs_server *server1,\n\t\t\t\t     struct nfs_server *server2)\n{\n\tstruct sockaddr *sap1, *sap2;\n\n\tsap1 = (struct sockaddr *)&server1->nfs_client->cl_addr;\n\tsap2 = (struct sockaddr *)&server2->nfs_client->cl_addr;\n\n\tif (sap1->sa_family != sap2->sa_family)\n\t\treturn 0;\n\n\tswitch (sap1->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin1 = (struct sockaddr_in *)sap1;\n\t\tstruct sockaddr_in *sin2 = (struct sockaddr_in *)sap2;\n\t\tif (sin1->sin_addr.s_addr != sin2->sin_addr.s_addr)\n\t\t\treturn 0;\n\t\tif (sin1->sin_port != sin2->sin_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin1 = (struct sockaddr_in6 *)sap1;\n\t\tstruct sockaddr_in6 *sin2 = (struct sockaddr_in6 *)sap2;\n\t\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\t\treturn 0;\n\t\tif (sin1->sin6_port != sin2->sin6_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_compare_super_address(struct nfs_server *server1,\n\t\t\t\t     struct nfs_server *server2)\n{\n\tstruct sockaddr *sap1, *sap2;\n\n\tsap1 = (struct sockaddr *)&server1->nfs_client->cl_addr;\n\tsap2 = (struct sockaddr *)&server2->nfs_client->cl_addr;\n\n\tif (sap1->sa_family != sap2->sa_family)\n\t\treturn 0;\n\n\tswitch (sap1->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin1 = (struct sockaddr_in *)sap1;\n\t\tstruct sockaddr_in *sin2 = (struct sockaddr_in *)sap2;\n\t\tif (sin1->sin_addr.s_addr != sin2->sin_addr.s_addr)\n\t\t\treturn 0;\n\t\tif (sin1->sin_port != sin2->sin_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin1 = (struct sockaddr_in6 *)sap1;\n\t\tstruct sockaddr_in6 *sin2 = (struct sockaddr_in6 *)sap2;\n\t\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\t\treturn 0;\n\t\tif (sin1->sin6_port != sin2->sin6_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 2446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_compare_super(struct super_block *sb, void *data)\n{\n\tstruct nfs_sb_mountdata *sb_mntdata = data;\n\tstruct nfs_server *server = sb_mntdata->server, *old = NFS_SB(sb);\n\tint mntflags = sb_mntdata->mntflags;\n\n\tif (!nfs_compare_super_address(old, server))\n\t\treturn 0;\n\t/* Note: NFS_MOUNT_UNSHARED == NFS4_MOUNT_UNSHARED */\n\tif (old->flags & NFS_MOUNT_UNSHARED)\n\t\treturn 0;\n\tif (memcmp(&old->fsid, &server->fsid, sizeof(old->fsid)) != 0)\n\t\treturn 0;\n\treturn nfs_compare_mount_options(sb, server, mntflags);\n}"
  },
  {
    "function_name": "nfs_compare_super_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2406-2441",
    "snippet": "static int nfs_compare_super_address(struct nfs_server *server1,\n\t\t\t\t     struct nfs_server *server2)\n{\n\tstruct sockaddr *sap1, *sap2;\n\n\tsap1 = (struct sockaddr *)&server1->nfs_client->cl_addr;\n\tsap2 = (struct sockaddr *)&server2->nfs_client->cl_addr;\n\n\tif (sap1->sa_family != sap2->sa_family)\n\t\treturn 0;\n\n\tswitch (sap1->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin1 = (struct sockaddr_in *)sap1;\n\t\tstruct sockaddr_in *sin2 = (struct sockaddr_in *)sap2;\n\t\tif (sin1->sin_addr.s_addr != sin2->sin_addr.s_addr)\n\t\t\treturn 0;\n\t\tif (sin1->sin_port != sin2->sin_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin1 = (struct sockaddr_in6 *)sap1;\n\t\tstruct sockaddr_in6 *sin2 = (struct sockaddr_in6 *)sap2;\n\t\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\t\treturn 0;\n\t\tif (sin1->sin6_port != sin2->sin6_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ipv6_addr_equal",
          "args": [
            "&sin1->sin6_addr",
            "&sin2->sin6_addr"
          ],
          "line": 2430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_compare_super_address(struct nfs_server *server1,\n\t\t\t\t     struct nfs_server *server2)\n{\n\tstruct sockaddr *sap1, *sap2;\n\n\tsap1 = (struct sockaddr *)&server1->nfs_client->cl_addr;\n\tsap2 = (struct sockaddr *)&server2->nfs_client->cl_addr;\n\n\tif (sap1->sa_family != sap2->sa_family)\n\t\treturn 0;\n\n\tswitch (sap1->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin1 = (struct sockaddr_in *)sap1;\n\t\tstruct sockaddr_in *sin2 = (struct sockaddr_in *)sap2;\n\t\tif (sin1->sin_addr.s_addr != sin2->sin_addr.s_addr)\n\t\t\treturn 0;\n\t\tif (sin1->sin_port != sin2->sin_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin1 = (struct sockaddr_in6 *)sap1;\n\t\tstruct sockaddr_in6 *sin2 = (struct sockaddr_in6 *)sap2;\n\t\tif (!ipv6_addr_equal(&sin1->sin6_addr, &sin2->sin6_addr))\n\t\t\treturn 0;\n\t\tif (sin1->sin6_port != sin2->sin6_port)\n\t\t\treturn 0;\n\t\tbreak;\n\t}\n\tdefault:\n\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_set_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2391-2404",
    "snippet": "static int nfs_set_super(struct super_block *s, void *data)\n{\n\tstruct nfs_sb_mountdata *sb_mntdata = data;\n\tstruct nfs_server *server = sb_mntdata->server;\n\tint ret;\n\n\ts->s_flags = sb_mntdata->mntflags;\n\ts->s_fs_info = server;\n\ts->s_d_op = server->nfs_client->rpc_ops->dentry_ops;\n\tret = set_anon_super(s, server);\n\tif (ret == 0)\n\t\tserver->s_dev = s->s_dev;\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_anon_super",
          "args": [
            "s",
            "server"
          ],
          "line": 2400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_set_super(struct super_block *s, void *data)\n{\n\tstruct nfs_sb_mountdata *sb_mntdata = data;\n\tstruct nfs_server *server = sb_mntdata->server;\n\tint ret;\n\n\ts->s_flags = sb_mntdata->mntflags;\n\ts->s_fs_info = server;\n\ts->s_d_op = server->nfs_client->rpc_ops->dentry_ops;\n\tret = set_anon_super(s, server);\n\tif (ret == 0)\n\t\tserver->s_dev = s->s_dev;\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_compare_mount_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2354-2384",
    "snippet": "static int nfs_compare_mount_options(const struct super_block *s, const struct nfs_server *b, int flags)\n{\n\tconst struct nfs_server *a = s->s_fs_info;\n\tconst struct rpc_clnt *clnt_a = a->client;\n\tconst struct rpc_clnt *clnt_b = b->client;\n\n\tif ((s->s_flags & NFS_MS_MASK) != (flags & NFS_MS_MASK))\n\t\tgoto Ebusy;\n\tif (a->nfs_client != b->nfs_client)\n\t\tgoto Ebusy;\n\tif ((a->flags ^ b->flags) & NFS_MOUNT_CMP_FLAGMASK)\n\t\tgoto Ebusy;\n\tif (a->wsize != b->wsize)\n\t\tgoto Ebusy;\n\tif (a->rsize != b->rsize)\n\t\tgoto Ebusy;\n\tif (a->acregmin != b->acregmin)\n\t\tgoto Ebusy;\n\tif (a->acregmax != b->acregmax)\n\t\tgoto Ebusy;\n\tif (a->acdirmin != b->acdirmin)\n\t\tgoto Ebusy;\n\tif (a->acdirmax != b->acdirmax)\n\t\tgoto Ebusy;\n\tif (b->auth_info.flavor_len > 0 &&\n\t   clnt_a->cl_auth->au_flavor != clnt_b->cl_auth->au_flavor)\n\t\tgoto Ebusy;\n\treturn 1;\nEbusy:\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_MOUNT_CMP_FLAGMASK (NFS_REMOUNT_CMP_FLAGMASK & \\\n\t\t~(NFS_MOUNT_UNSHARED | NFS_MOUNT_NORESVPORT))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_MOUNT_CMP_FLAGMASK (NFS_REMOUNT_CMP_FLAGMASK & \\\n\t\t~(NFS_MOUNT_UNSHARED | NFS_MOUNT_NORESVPORT))\n\nstatic int nfs_compare_mount_options(const struct super_block *s, const struct nfs_server *b, int flags)\n{\n\tconst struct nfs_server *a = s->s_fs_info;\n\tconst struct rpc_clnt *clnt_a = a->client;\n\tconst struct rpc_clnt *clnt_b = b->client;\n\n\tif ((s->s_flags & NFS_MS_MASK) != (flags & NFS_MS_MASK))\n\t\tgoto Ebusy;\n\tif (a->nfs_client != b->nfs_client)\n\t\tgoto Ebusy;\n\tif ((a->flags ^ b->flags) & NFS_MOUNT_CMP_FLAGMASK)\n\t\tgoto Ebusy;\n\tif (a->wsize != b->wsize)\n\t\tgoto Ebusy;\n\tif (a->rsize != b->rsize)\n\t\tgoto Ebusy;\n\tif (a->acregmin != b->acregmin)\n\t\tgoto Ebusy;\n\tif (a->acregmax != b->acregmax)\n\t\tgoto Ebusy;\n\tif (a->acdirmin != b->acdirmin)\n\t\tgoto Ebusy;\n\tif (a->acdirmax != b->acdirmax)\n\t\tgoto Ebusy;\n\tif (b->auth_info.flavor_len > 0 &&\n\t   clnt_a->cl_auth->au_flavor != clnt_b->cl_auth->au_flavor)\n\t\tgoto Ebusy;\n\treturn 1;\nEbusy:\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_clone_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2332-2352",
    "snippet": "void nfs_clone_super(struct super_block *sb, struct nfs_mount_info *mount_info)\n{\n\tconst struct super_block *old_sb = mount_info->cloned->sb;\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_blocksize_bits = old_sb->s_blocksize_bits;\n\tsb->s_blocksize = old_sb->s_blocksize;\n\tsb->s_maxbytes = old_sb->s_maxbytes;\n\tsb->s_xattr = old_sb->s_xattr;\n\tsb->s_op = old_sb->s_op;\n\tsb->s_time_gran = 1;\n\n\tif (server->nfs_client->rpc_ops->version != 2) {\n\t\t/* The VFS shouldn't apply the umask to mode bits. We will do\n\t\t * so ourselves when necessary.\n\t\t */\n\t\tsb->s_flags |= MS_POSIXACL;\n\t}\n\n \tnfs_initialise_sb(sb);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_initialise_sb",
          "args": [
            "sb"
          ],
          "line": 2351
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_initialise_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2283-2300",
          "snippet": "inline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\ninline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 2335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_clone_super(struct super_block *sb, struct nfs_mount_info *mount_info)\n{\n\tconst struct super_block *old_sb = mount_info->cloned->sb;\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_blocksize_bits = old_sb->s_blocksize_bits;\n\tsb->s_blocksize = old_sb->s_blocksize;\n\tsb->s_maxbytes = old_sb->s_maxbytes;\n\tsb->s_xattr = old_sb->s_xattr;\n\tsb->s_op = old_sb->s_op;\n\tsb->s_time_gran = 1;\n\n\tif (server->nfs_client->rpc_ops->version != 2) {\n\t\t/* The VFS shouldn't apply the umask to mode bits. We will do\n\t\t * so ourselves when necessary.\n\t\t */\n\t\tsb->s_flags |= MS_POSIXACL;\n\t}\n\n \tnfs_initialise_sb(sb);\n}"
  },
  {
    "function_name": "nfs_fill_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2305-2326",
    "snippet": "void nfs_fill_super(struct super_block *sb, struct nfs_mount_info *mount_info)\n{\n\tstruct nfs_parsed_mount_data *data = mount_info->parsed;\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_blocksize_bits = 0;\n\tsb->s_blocksize = 0;\n\tsb->s_xattr = server->nfs_client->cl_nfs_mod->xattr;\n\tsb->s_op = server->nfs_client->cl_nfs_mod->sops;\n\tif (data && data->bsize)\n\t\tsb->s_blocksize = nfs_block_size(data->bsize, &sb->s_blocksize_bits);\n\n\tif (server->nfs_client->rpc_ops->version != 2) {\n\t\t/* The VFS shouldn't apply the umask to mode bits. We will do\n\t\t * so ourselves when necessary.\n\t\t */\n\t\tsb->s_flags |= MS_POSIXACL;\n\t\tsb->s_time_gran = 1;\n\t}\n\n \tnfs_initialise_sb(sb);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_initialise_sb",
          "args": [
            "sb"
          ],
          "line": 2325
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_initialise_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2283-2300",
          "snippet": "inline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\ninline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_block_size",
          "args": [
            "data->bsize",
            "&sb->s_blocksize_bits"
          ],
          "line": 2315
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "579-588",
          "snippet": "static inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_size(unsigned long bsize, unsigned char *nrbitsp)\n{\n\tif (bsize < NFS_MIN_FILE_IO_SIZE)\n\t\tbsize = NFS_DEF_FILE_IO_SIZE;\n\telse if (bsize >= NFS_MAX_FILE_IO_SIZE)\n\t\tbsize = NFS_MAX_FILE_IO_SIZE;\n\n\treturn nfs_block_bits(bsize, nrbitsp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_fill_super(struct super_block *sb, struct nfs_mount_info *mount_info)\n{\n\tstruct nfs_parsed_mount_data *data = mount_info->parsed;\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_blocksize_bits = 0;\n\tsb->s_blocksize = 0;\n\tsb->s_xattr = server->nfs_client->cl_nfs_mod->xattr;\n\tsb->s_op = server->nfs_client->cl_nfs_mod->sops;\n\tif (data && data->bsize)\n\t\tsb->s_blocksize = nfs_block_size(data->bsize, &sb->s_blocksize_bits);\n\n\tif (server->nfs_client->rpc_ops->version != 2) {\n\t\t/* The VFS shouldn't apply the umask to mode bits. We will do\n\t\t * so ourselves when necessary.\n\t\t */\n\t\tsb->s_flags |= MS_POSIXACL;\n\t\tsb->s_time_gran = 1;\n\t}\n\n \tnfs_initialise_sb(sb);\n}"
  },
  {
    "function_name": "nfs_initialise_sb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2283-2300",
    "snippet": "inline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_super_set_maxbytes",
          "args": [
            "sb",
            "server->maxfilesize"
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_super_set_maxbytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "593-599",
          "snippet": "static inline\nvoid nfs_super_set_maxbytes(struct super_block *sb, __u64 maxfilesize)\n{\n\tsb->s_maxbytes = (loff_t)maxfilesize;\n\tif (sb->s_maxbytes > MAX_LFS_FILESIZE || sb->s_maxbytes <= 0)\n\t\tsb->s_maxbytes = MAX_LFS_FILESIZE;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nfs_file_fsync_commit(struct file *, loff_t, loff_t, int);",
            "loff_t nfs_file_llseek(struct file *, loff_t, int);",
            "extern struct inode *nfs_alloc_inode(struct super_block *sb);",
            "void nfs_initialise_sb(struct super_block *);",
            "void nfs_kill_super(struct super_block *);",
            "extern bool nfs_sb_active(struct super_block *sb);",
            "extern void nfs_sb_deactive(struct super_block *sb);",
            "void nfs_umount_begin(struct super_block *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nint nfs_file_fsync_commit(struct file *, loff_t, loff_t, int);\nloff_t nfs_file_llseek(struct file *, loff_t, int);\nextern struct inode *nfs_alloc_inode(struct super_block *sb);\nvoid nfs_initialise_sb(struct super_block *);\nvoid nfs_kill_super(struct super_block *);\nextern bool nfs_sb_active(struct super_block *sb);\nextern void nfs_sb_deactive(struct super_block *sb);\nvoid nfs_umount_begin(struct super_block *);\n\nstatic inline\nvoid nfs_super_set_maxbytes(struct super_block *sb, __u64 maxfilesize)\n{\n\tsb->s_maxbytes = (loff_t)maxfilesize;\n\tif (sb->s_maxbytes > MAX_LFS_FILESIZE || sb->s_maxbytes <= 0)\n\t\tsb->s_maxbytes = MAX_LFS_FILESIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_block_bits",
          "args": [
            "server->wsize",
            "&sb->s_blocksize_bits"
          ],
          "line": 2294
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_block_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "550-565",
          "snippet": "static inline\nunsigned long nfs_block_bits(unsigned long bsize, unsigned char *nrbitsp)\n{\n\t/* make sure blocksize is a power of two */\n\tif ((bsize & (bsize - 1)) || nrbitsp) {\n\t\tunsigned char\tnrbits;\n\n\t\tfor (nrbits = 31; nrbits && !(bsize & (1 << nrbits)); nrbits--)\n\t\t\t;\n\t\tbsize = 1 << nrbits;\n\t\tif (nrbitsp)\n\t\t\t*nrbitsp = nrbits;\n\t}\n\n\treturn bsize;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nunsigned long nfs_block_bits(unsigned long bsize, unsigned char *nrbitsp)\n{\n\t/* make sure blocksize is a power of two */\n\tif ((bsize & (bsize - 1)) || nrbitsp) {\n\t\tunsigned char\tnrbits;\n\n\t\tfor (nrbits = 31; nrbits && !(bsize & (1 << nrbits)); nrbits--)\n\t\t\t;\n\t\tbsize = 1 << nrbits;\n\t\tif (nrbitsp)\n\t\t\t*nrbitsp = nrbits;\n\t}\n\n\treturn bsize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "sb->s_id",
            "sizeof(sb->s_id)",
            "\"%u:%u\"",
            "MAJOR(sb->s_dev)",
            "MINOR(sb->s_dev)"
          ],
          "line": 2290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "sb->s_dev"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "sb->s_dev"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 2285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\ninline void nfs_initialise_sb(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tsb->s_magic = NFS_SUPER_MAGIC;\n\n\t/* We probably want something more informative here */\n\tsnprintf(sb->s_id, sizeof(sb->s_id),\n\t\t \"%u:%u\", MAJOR(sb->s_dev), MINOR(sb->s_dev));\n\n\tif (sb->s_blocksize == 0)\n\t\tsb->s_blocksize = nfs_block_bits(server->wsize,\n\t\t\t\t\t\t &sb->s_blocksize_bits);\n\n\tsb->s_bdi = &server->backing_dev_info;\n\n\tnfs_super_set_maxbytes(sb, server->maxfilesize);\n}"
  },
  {
    "function_name": "nfs_remount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2211-2277",
    "snippet": "int\nnfs_remount(struct super_block *sb, int *flags, char *raw_data)\n{\n\tint error;\n\tstruct nfs_server *nfss = sb->s_fs_info;\n\tstruct nfs_parsed_mount_data *data;\n\tstruct nfs_mount_data *options = (struct nfs_mount_data *)raw_data;\n\tstruct nfs4_mount_data *options4 = (struct nfs4_mount_data *)raw_data;\n\tu32 nfsvers = nfss->nfs_client->rpc_ops->version;\n\n\tsync_filesystem(sb);\n\n\t/*\n\t * Userspace mount programs that send binary options generally send\n\t * them populated with default values. We have no way to know which\n\t * ones were explicitly specified. Fall back to legacy behavior and\n\t * just return success.\n\t */\n\tif ((nfsvers == 4 && (!options4 || options4->version == 1)) ||\n\t    (nfsvers <= 3 && (!options || (options->version >= 1 &&\n\t\t\t\t\t   options->version <= 6))))\n\t\treturn 0;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data == NULL)\n\t\treturn -ENOMEM;\n\n\t/* fill out struct with values from existing mount */\n\tdata->flags = nfss->flags;\n\tdata->rsize = nfss->rsize;\n\tdata->wsize = nfss->wsize;\n\tdata->retrans = nfss->client->cl_timeout->to_retries;\n\tdata->selected_flavor = nfss->client->cl_auth->au_flavor;\n\tdata->auth_info = nfss->auth_info;\n\tdata->acregmin = nfss->acregmin / HZ;\n\tdata->acregmax = nfss->acregmax / HZ;\n\tdata->acdirmin = nfss->acdirmin / HZ;\n\tdata->acdirmax = nfss->acdirmax / HZ;\n\tdata->timeo = 10U * nfss->client->cl_timeout->to_initval / HZ;\n\tdata->nfs_server.port = nfss->port;\n\tdata->nfs_server.addrlen = nfss->nfs_client->cl_addrlen;\n\tdata->version = nfsvers;\n\tdata->minorversion = nfss->nfs_client->cl_minorversion;\n\tdata->net = current->nsproxy->net_ns;\n\tmemcpy(&data->nfs_server.address, &nfss->nfs_client->cl_addr,\n\t\tdata->nfs_server.addrlen);\n\n\t/* overwrite those values with any that were specified */\n\terror = -EINVAL;\n\tif (!nfs_parse_mount_options((char *)options, data))\n\t\tgoto out;\n\n\t/*\n\t * noac is a special case. It implies -o sync, but that's not\n\t * necessarily reflected in the mtab options. do_remount_sb\n\t * will clear MS_SYNCHRONOUS if -o sync wasn't specified in the\n\t * remount options, so we have to explicitly reset it.\n\t */\n\tif (data->flags & NFS_MOUNT_NOAC)\n\t\t*flags |= MS_SYNCHRONOUS;\n\n\t/* compare new mount options with old ones */\n\terror = nfs_compare_remount_data(nfss, data);\nout:\n\tkfree(data);\n\treturn error;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 2275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_compare_remount_data",
          "args": [
            "nfss",
            "data"
          ],
          "line": 2273
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_compare_remount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2186-2209",
          "snippet": "static int\nnfs_compare_remount_data(struct nfs_server *nfss,\n\t\t\t struct nfs_parsed_mount_data *data)\n{\n\tif ((data->flags ^ nfss->flags) & NFS_REMOUNT_CMP_FLAGMASK ||\n\t    data->rsize != nfss->rsize ||\n\t    data->wsize != nfss->wsize ||\n\t    data->version != nfss->nfs_client->rpc_ops->version ||\n\t    data->minorversion != nfss->nfs_client->cl_minorversion ||\n\t    data->retrans != nfss->client->cl_timeout->to_retries ||\n\t    data->selected_flavor != nfss->client->cl_auth->au_flavor ||\n\t    data->acregmin != nfss->acregmin / HZ ||\n\t    data->acregmax != nfss->acregmax / HZ ||\n\t    data->acdirmin != nfss->acdirmin / HZ ||\n\t    data->acdirmax != nfss->acdirmax / HZ ||\n\t    data->timeo != (10U * nfss->client->cl_timeout->to_initval / HZ) ||\n\t    data->nfs_server.port != nfss->port ||\n\t    data->nfs_server.addrlen != nfss->nfs_client->cl_addrlen ||\n\t    !rpc_cmp_addr((struct sockaddr *)&data->nfs_server.address,\n\t\t\t  (struct sockaddr *)&nfss->nfs_client->cl_addr))\n\t\treturn -EINVAL;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_REMOUNT_CMP_FLAGMASK ~(NFS_MOUNT_INTR \\\n\t\t| NFS_MOUNT_SECURE \\\n\t\t| NFS_MOUNT_TCP \\\n\t\t| NFS_MOUNT_VER3 \\\n\t\t| NFS_MOUNT_KERBEROS \\\n\t\t| NFS_MOUNT_NONLM \\\n\t\t| NFS_MOUNT_BROKEN_SUID \\\n\t\t| NFS_MOUNT_STRICTLOCK \\\n\t\t| NFS_MOUNT_LEGACY_INTERFACE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_REMOUNT_CMP_FLAGMASK ~(NFS_MOUNT_INTR \\\n\t\t| NFS_MOUNT_SECURE \\\n\t\t| NFS_MOUNT_TCP \\\n\t\t| NFS_MOUNT_VER3 \\\n\t\t| NFS_MOUNT_KERBEROS \\\n\t\t| NFS_MOUNT_NONLM \\\n\t\t| NFS_MOUNT_BROKEN_SUID \\\n\t\t| NFS_MOUNT_STRICTLOCK \\\n\t\t| NFS_MOUNT_LEGACY_INTERFACE)\n\nstatic int\nnfs_compare_remount_data(struct nfs_server *nfss,\n\t\t\t struct nfs_parsed_mount_data *data)\n{\n\tif ((data->flags ^ nfss->flags) & NFS_REMOUNT_CMP_FLAGMASK ||\n\t    data->rsize != nfss->rsize ||\n\t    data->wsize != nfss->wsize ||\n\t    data->version != nfss->nfs_client->rpc_ops->version ||\n\t    data->minorversion != nfss->nfs_client->cl_minorversion ||\n\t    data->retrans != nfss->client->cl_timeout->to_retries ||\n\t    data->selected_flavor != nfss->client->cl_auth->au_flavor ||\n\t    data->acregmin != nfss->acregmin / HZ ||\n\t    data->acregmax != nfss->acregmax / HZ ||\n\t    data->acdirmin != nfss->acdirmin / HZ ||\n\t    data->acdirmax != nfss->acdirmax / HZ ||\n\t    data->timeo != (10U * nfss->client->cl_timeout->to_initval / HZ) ||\n\t    data->nfs_server.port != nfss->port ||\n\t    data->nfs_server.addrlen != nfss->nfs_client->cl_addrlen ||\n\t    !rpc_cmp_addr((struct sockaddr *)&data->nfs_server.address,\n\t\t\t  (struct sockaddr *)&nfss->nfs_client->cl_addr))\n\t\treturn -EINVAL;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_parse_mount_options",
          "args": [
            "(char *)options",
            "data"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_parse_mount_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1194-1669",
          "snippet": "static int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};",
            "static const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};",
            "static match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};",
            "static match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};\nstatic const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};\nstatic match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};\nstatic match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};\n\nstatic int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data->nfs_server.address",
            "&nfss->nfs_client->cl_addr",
            "data->nfs_server.addrlen"
          ],
          "line": 2255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 2234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sync_filesystem",
          "args": [
            "sb"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "sync_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sync.c",
          "lines": "47-67",
          "snippet": "int sync_filesystem(struct super_block *sb)\n{\n\tint ret;\n\n\t/*\n\t * We need to be protected against the filesystem going from\n\t * r/o to r/w or vice versa.\n\t */\n\tWARN_ON(!rwsem_is_locked(&sb->s_umount));\n\n\t/*\n\t * No point in syncing out anything if the filesystem is read-only.\n\t */\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn 0;\n\n\tret = __sync_filesystem(sb, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\treturn __sync_filesystem(sb, 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/backing-dev.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/linkage.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/writeback.h>",
            "#include <linux/sched.h>",
            "#include <linux/namei.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/backing-dev.h>\n#include <linux/quotaops.h>\n#include <linux/pagemap.h>\n#include <linux/linkage.h>\n#include <linux/syscalls.h>\n#include <linux/writeback.h>\n#include <linux/sched.h>\n#include <linux/namei.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n\nint sync_filesystem(struct super_block *sb)\n{\n\tint ret;\n\n\t/*\n\t * We need to be protected against the filesystem going from\n\t * r/o to r/w or vice versa.\n\t */\n\tWARN_ON(!rwsem_is_locked(&sb->s_umount));\n\n\t/*\n\t * No point in syncing out anything if the filesystem is read-only.\n\t */\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn 0;\n\n\tret = __sync_filesystem(sb, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\treturn __sync_filesystem(sb, 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct dentry *nfs_xdev_mount(struct file_system_type *fs_type,\n\t\tint flags, const char *dev_name, void *raw_data);\n\nint\nnfs_remount(struct super_block *sb, int *flags, char *raw_data)\n{\n\tint error;\n\tstruct nfs_server *nfss = sb->s_fs_info;\n\tstruct nfs_parsed_mount_data *data;\n\tstruct nfs_mount_data *options = (struct nfs_mount_data *)raw_data;\n\tstruct nfs4_mount_data *options4 = (struct nfs4_mount_data *)raw_data;\n\tu32 nfsvers = nfss->nfs_client->rpc_ops->version;\n\n\tsync_filesystem(sb);\n\n\t/*\n\t * Userspace mount programs that send binary options generally send\n\t * them populated with default values. We have no way to know which\n\t * ones were explicitly specified. Fall back to legacy behavior and\n\t * just return success.\n\t */\n\tif ((nfsvers == 4 && (!options4 || options4->version == 1)) ||\n\t    (nfsvers <= 3 && (!options || (options->version >= 1 &&\n\t\t\t\t\t   options->version <= 6))))\n\t\treturn 0;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data == NULL)\n\t\treturn -ENOMEM;\n\n\t/* fill out struct with values from existing mount */\n\tdata->flags = nfss->flags;\n\tdata->rsize = nfss->rsize;\n\tdata->wsize = nfss->wsize;\n\tdata->retrans = nfss->client->cl_timeout->to_retries;\n\tdata->selected_flavor = nfss->client->cl_auth->au_flavor;\n\tdata->auth_info = nfss->auth_info;\n\tdata->acregmin = nfss->acregmin / HZ;\n\tdata->acregmax = nfss->acregmax / HZ;\n\tdata->acdirmin = nfss->acdirmin / HZ;\n\tdata->acdirmax = nfss->acdirmax / HZ;\n\tdata->timeo = 10U * nfss->client->cl_timeout->to_initval / HZ;\n\tdata->nfs_server.port = nfss->port;\n\tdata->nfs_server.addrlen = nfss->nfs_client->cl_addrlen;\n\tdata->version = nfsvers;\n\tdata->minorversion = nfss->nfs_client->cl_minorversion;\n\tdata->net = current->nsproxy->net_ns;\n\tmemcpy(&data->nfs_server.address, &nfss->nfs_client->cl_addr,\n\t\tdata->nfs_server.addrlen);\n\n\t/* overwrite those values with any that were specified */\n\terror = -EINVAL;\n\tif (!nfs_parse_mount_options((char *)options, data))\n\t\tgoto out;\n\n\t/*\n\t * noac is a special case. It implies -o sync, but that's not\n\t * necessarily reflected in the mtab options. do_remount_sb\n\t * will clear MS_SYNCHRONOUS if -o sync wasn't specified in the\n\t * remount options, so we have to explicitly reset it.\n\t */\n\tif (data->flags & NFS_MOUNT_NOAC)\n\t\t*flags |= MS_SYNCHRONOUS;\n\n\t/* compare new mount options with old ones */\n\terror = nfs_compare_remount_data(nfss, data);\nout:\n\tkfree(data);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_compare_remount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2186-2209",
    "snippet": "static int\nnfs_compare_remount_data(struct nfs_server *nfss,\n\t\t\t struct nfs_parsed_mount_data *data)\n{\n\tif ((data->flags ^ nfss->flags) & NFS_REMOUNT_CMP_FLAGMASK ||\n\t    data->rsize != nfss->rsize ||\n\t    data->wsize != nfss->wsize ||\n\t    data->version != nfss->nfs_client->rpc_ops->version ||\n\t    data->minorversion != nfss->nfs_client->cl_minorversion ||\n\t    data->retrans != nfss->client->cl_timeout->to_retries ||\n\t    data->selected_flavor != nfss->client->cl_auth->au_flavor ||\n\t    data->acregmin != nfss->acregmin / HZ ||\n\t    data->acregmax != nfss->acregmax / HZ ||\n\t    data->acdirmin != nfss->acdirmin / HZ ||\n\t    data->acdirmax != nfss->acdirmax / HZ ||\n\t    data->timeo != (10U * nfss->client->cl_timeout->to_initval / HZ) ||\n\t    data->nfs_server.port != nfss->port ||\n\t    data->nfs_server.addrlen != nfss->nfs_client->cl_addrlen ||\n\t    !rpc_cmp_addr((struct sockaddr *)&data->nfs_server.address,\n\t\t\t  (struct sockaddr *)&nfss->nfs_client->cl_addr))\n\t\treturn -EINVAL;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_REMOUNT_CMP_FLAGMASK ~(NFS_MOUNT_INTR \\\n\t\t| NFS_MOUNT_SECURE \\\n\t\t| NFS_MOUNT_TCP \\\n\t\t| NFS_MOUNT_VER3 \\\n\t\t| NFS_MOUNT_KERBEROS \\\n\t\t| NFS_MOUNT_NONLM \\\n\t\t| NFS_MOUNT_BROKEN_SUID \\\n\t\t| NFS_MOUNT_STRICTLOCK \\\n\t\t| NFS_MOUNT_LEGACY_INTERFACE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_cmp_addr",
          "args": [
            "(struct sockaddr *)&data->nfs_server.address",
            "(struct sockaddr *)&nfss->nfs_client->cl_addr"
          ],
          "line": 2204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_REMOUNT_CMP_FLAGMASK ~(NFS_MOUNT_INTR \\\n\t\t| NFS_MOUNT_SECURE \\\n\t\t| NFS_MOUNT_TCP \\\n\t\t| NFS_MOUNT_VER3 \\\n\t\t| NFS_MOUNT_KERBEROS \\\n\t\t| NFS_MOUNT_NONLM \\\n\t\t| NFS_MOUNT_BROKEN_SUID \\\n\t\t| NFS_MOUNT_STRICTLOCK \\\n\t\t| NFS_MOUNT_LEGACY_INTERFACE)\n\nstatic int\nnfs_compare_remount_data(struct nfs_server *nfss,\n\t\t\t struct nfs_parsed_mount_data *data)\n{\n\tif ((data->flags ^ nfss->flags) & NFS_REMOUNT_CMP_FLAGMASK ||\n\t    data->rsize != nfss->rsize ||\n\t    data->wsize != nfss->wsize ||\n\t    data->version != nfss->nfs_client->rpc_ops->version ||\n\t    data->minorversion != nfss->nfs_client->cl_minorversion ||\n\t    data->retrans != nfss->client->cl_timeout->to_retries ||\n\t    data->selected_flavor != nfss->client->cl_auth->au_flavor ||\n\t    data->acregmin != nfss->acregmin / HZ ||\n\t    data->acregmax != nfss->acregmax / HZ ||\n\t    data->acdirmin != nfss->acdirmin / HZ ||\n\t    data->acdirmax != nfss->acdirmax / HZ ||\n\t    data->timeo != (10U * nfss->client->cl_timeout->to_initval / HZ) ||\n\t    data->nfs_server.port != nfss->port ||\n\t    data->nfs_server.addrlen != nfss->nfs_client->cl_addrlen ||\n\t    !rpc_cmp_addr((struct sockaddr *)&data->nfs_server.address,\n\t\t\t  (struct sockaddr *)&nfss->nfs_client->cl_addr))\n\t\treturn -EINVAL;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_validate_text_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2120-2171",
    "snippet": "static int nfs_validate_text_mount_data(void *options,\n\t\t\t\t\tstruct nfs_parsed_mount_data *args,\n\t\t\t\t\tconst char *dev_name)\n{\n\tint port = 0;\n\tint max_namelen = PAGE_SIZE;\n\tint max_pathlen = NFS_MAXPATHLEN;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\n\tif (nfs_parse_mount_options((char *)options, args) == 0)\n\t\treturn -EINVAL;\n\n\tif (!nfs_verify_server_address(sap))\n\t\tgoto out_no_address;\n\n\tif (args->version == 4) {\n#if IS_ENABLED(CONFIG_NFS_V4)\n\t\tport = NFS_PORT;\n\t\tmax_namelen = NFS4_MAXNAMLEN;\n\t\tmax_pathlen = NFS4_MAXPATHLEN;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\t\tnfs4_validate_mount_flags(args);\n#else\n\t\tgoto out_v4_not_compiled;\n#endif /* CONFIG_NFS_V4 */\n\t} else\n\t\tnfs_set_mount_transport_protocol(args);\n\n\tnfs_set_port(sap, &args->nfs_server.port, port);\n\n\treturn nfs_parse_devname(dev_name,\n\t\t\t\t   &args->nfs_server.hostname,\n\t\t\t\t   max_namelen,\n\t\t\t\t   &args->nfs_server.export_path,\n\t\t\t\t   max_pathlen);\n\n#if !IS_ENABLED(CONFIG_NFS_V4)\nout_v4_not_compiled:\n\tdfprintk(MOUNT, \"NFS: NFSv4 is not compiled into kernel\\n\");\n\treturn -EPROTONOSUPPORT;\n#else\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n#endif /* !CONFIG_NFS_V4 */\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: mount program didn't pass remote address\\n\""
          ],
          "line": 2169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFSv4: Unsupported transport protocol udp\\n\""
          ],
          "line": 2164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: NFSv4 is not compiled into kernel\\n\""
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 2158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_parse_devname",
          "args": [
            "dev_name",
            "&args->nfs_server.hostname",
            "max_namelen",
            "&args->nfs_server.export_path",
            "max_pathlen"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_parse_devname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1871-1932",
          "snippet": "static int nfs_parse_devname(const char *dev_name,\n\t\t\t     char **hostname, size_t maxnamlen,\n\t\t\t     char **export_path, size_t maxpathlen)\n{\n\tsize_t len;\n\tchar *end;\n\n\t/* Is the host name protected with square brakcets? */\n\tif (*dev_name == '[') {\n\t\tend = strchr(++dev_name, ']');\n\t\tif (end == NULL || end[1] != ':')\n\t\t\tgoto out_bad_devname;\n\n\t\tlen = end - dev_name;\n\t\tend++;\n\t} else {\n\t\tchar *comma;\n\n\t\tend = strchr(dev_name, ':');\n\t\tif (end == NULL)\n\t\t\tgoto out_bad_devname;\n\t\tlen = end - dev_name;\n\n\t\t/* kill possible hostname list: not supported */\n\t\tcomma = strchr(dev_name, ',');\n\t\tif (comma != NULL && comma < end)\n\t\t\t*comma = 0;\n\t}\n\n\tif (len > maxnamlen)\n\t\tgoto out_hostname;\n\n\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t*hostname = kstrndup(dev_name, len, GFP_KERNEL);\n\tif (*hostname == NULL)\n\t\tgoto out_nomem;\n\tlen = strlen(++end);\n\tif (len > maxpathlen)\n\t\tgoto out_path;\n\t*export_path = kstrndup(end, len, GFP_KERNEL);\n\tif (!*export_path)\n\t\tgoto out_nomem;\n\n\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", *export_path);\n\treturn 0;\n\nout_bad_devname:\n\tdfprintk(MOUNT, \"NFS: device name not in host:path format\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to parse device name\\n\");\n\treturn -ENOMEM;\n\nout_hostname:\n\tdfprintk(MOUNT, \"NFS: server hostname too long\\n\");\n\treturn -ENAMETOOLONG;\n\nout_path:\n\tdfprintk(MOUNT, \"NFS: export pathname too long\\n\");\n\treturn -ENAMETOOLONG;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_parse_devname(const char *dev_name,\n\t\t\t     char **hostname, size_t maxnamlen,\n\t\t\t     char **export_path, size_t maxpathlen)\n{\n\tsize_t len;\n\tchar *end;\n\n\t/* Is the host name protected with square brakcets? */\n\tif (*dev_name == '[') {\n\t\tend = strchr(++dev_name, ']');\n\t\tif (end == NULL || end[1] != ':')\n\t\t\tgoto out_bad_devname;\n\n\t\tlen = end - dev_name;\n\t\tend++;\n\t} else {\n\t\tchar *comma;\n\n\t\tend = strchr(dev_name, ':');\n\t\tif (end == NULL)\n\t\t\tgoto out_bad_devname;\n\t\tlen = end - dev_name;\n\n\t\t/* kill possible hostname list: not supported */\n\t\tcomma = strchr(dev_name, ',');\n\t\tif (comma != NULL && comma < end)\n\t\t\t*comma = 0;\n\t}\n\n\tif (len > maxnamlen)\n\t\tgoto out_hostname;\n\n\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t*hostname = kstrndup(dev_name, len, GFP_KERNEL);\n\tif (*hostname == NULL)\n\t\tgoto out_nomem;\n\tlen = strlen(++end);\n\tif (len > maxpathlen)\n\t\tgoto out_path;\n\t*export_path = kstrndup(end, len, GFP_KERNEL);\n\tif (!*export_path)\n\t\tgoto out_nomem;\n\n\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", *export_path);\n\treturn 0;\n\nout_bad_devname:\n\tdfprintk(MOUNT, \"NFS: device name not in host:path format\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to parse device name\\n\");\n\treturn -ENOMEM;\n\nout_hostname:\n\tdfprintk(MOUNT, \"NFS: server hostname too long\\n\");\n\treturn -ENAMETOOLONG;\n\nout_path:\n\tdfprintk(MOUNT, \"NFS: export pathname too long\\n\");\n\treturn -ENAMETOOLONG;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_port",
          "args": [
            "sap",
            "&args->nfs_server.port",
            "port"
          ],
          "line": 2150
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_port",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "978-985",
          "snippet": "static void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_mount_transport_protocol",
          "args": [
            "args"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_mount_transport_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1007-1022",
          "snippet": "static void nfs_set_mount_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tnfs_validate_transport_protocol(mnt);\n\n\tif (mnt->mount_server.protocol == XPRT_TRANSPORT_UDP ||\n\t    mnt->mount_server.protocol == XPRT_TRANSPORT_TCP)\n\t\t\treturn;\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_set_mount_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tnfs_validate_transport_protocol(mnt);\n\n\tif (mnt->mount_server.protocol == XPRT_TRANSPORT_UDP ||\n\t    mnt->mount_server.protocol == XPRT_TRANSPORT_TCP)\n\t\t\treturn;\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_validate_mount_flags",
          "args": [
            "args"
          ],
          "line": 2143
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_validate_mount_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2706-2710",
          "snippet": "static void nfs4_validate_mount_flags(struct nfs_parsed_mount_data *args)\n{\n\targs->flags &= ~(NFS_MOUNT_NONLM|NFS_MOUNT_NOACL|NFS_MOUNT_VER3|\n\t\t\t NFS_MOUNT_LOCAL_FLOCK|NFS_MOUNT_LOCAL_FCNTL);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs4_validate_mount_flags(struct nfs_parsed_mount_data *args)\n{\n\targs->flags &= ~(NFS_MOUNT_NONLM|NFS_MOUNT_NOACL|NFS_MOUNT_VER3|\n\t\t\t NFS_MOUNT_LOCAL_FLOCK|NFS_MOUNT_LOCAL_FCNTL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_validate_transport_protocol",
          "args": [
            "args"
          ],
          "line": 2140
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_validate_transport_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "991-1001",
          "snippet": "static void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_verify_server_address",
          "args": [
            "sap"
          ],
          "line": 2132
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_verify_server_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "957-972",
          "snippet": "static int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_parse_mount_options",
          "args": [
            "(char *)options",
            "args"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_parse_mount_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1194-1669",
          "snippet": "static int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};",
            "static const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};",
            "static match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};",
            "static match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};\nstatic const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};\nstatic match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};\nstatic match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};\n\nstatic int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_validate_text_mount_data(void *options,\n\t\t\t\t\tstruct nfs_parsed_mount_data *args,\n\t\t\t\t\tconst char *dev_name)\n{\n\tint port = 0;\n\tint max_namelen = PAGE_SIZE;\n\tint max_pathlen = NFS_MAXPATHLEN;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\n\tif (nfs_parse_mount_options((char *)options, args) == 0)\n\t\treturn -EINVAL;\n\n\tif (!nfs_verify_server_address(sap))\n\t\tgoto out_no_address;\n\n\tif (args->version == 4) {\n#if IS_ENABLED(CONFIG_NFS_V4)\n\t\tport = NFS_PORT;\n\t\tmax_namelen = NFS4_MAXNAMLEN;\n\t\tmax_pathlen = NFS4_MAXPATHLEN;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\t\tnfs4_validate_mount_flags(args);\n#else\n\t\tgoto out_v4_not_compiled;\n#endif /* CONFIG_NFS_V4 */\n\t} else\n\t\tnfs_set_mount_transport_protocol(args);\n\n\tnfs_set_port(sap, &args->nfs_server.port, port);\n\n\treturn nfs_parse_devname(dev_name,\n\t\t\t\t   &args->nfs_server.hostname,\n\t\t\t\t   max_namelen,\n\t\t\t\t   &args->nfs_server.export_path,\n\t\t\t\t   max_pathlen);\n\n#if !IS_ENABLED(CONFIG_NFS_V4)\nout_v4_not_compiled:\n\tdfprintk(MOUNT, \"NFS: NFSv4 is not compiled into kernel\\n\");\n\treturn -EPROTONOSUPPORT;\n#else\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n#endif /* !CONFIG_NFS_V4 */\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "nfs_validate_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2110-2117",
    "snippet": "static int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs23_validate_mount_data",
          "args": [
            "options",
            "args",
            "mntfh",
            "dev_name"
          ],
          "line": 2116
        },
        "resolved": true,
        "details": {
          "function_name": "nfs23_validate_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1950-2096",
          "snippet": "static int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_DEFAULT_VERSION 2",
            "#define NFS_DEFAULT_VERSION 3",
            "#define NFS_TEXT_DATA\t\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_DEFAULT_VERSION 2\n#define NFS_DEFAULT_VERSION 3\n#define NFS_TEXT_DATA\t\t1\n\nstatic int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n}"
  },
  {
    "function_name": "nfs_validate_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "2099-2108",
    "snippet": "static int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\tif (fs_type == &nfs_fs_type)\n\t\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n\treturn nfs4_validate_mount_data(options, args, dev_name);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs4_validate_mount_data",
          "args": [
            "options",
            "args",
            "dev_name"
          ],
          "line": 2107
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_validate_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2715-2811",
          "snippet": "static int nfs4_validate_mount_data(void *options,\n\t\t\t\t    struct nfs_parsed_mount_data *args,\n\t\t\t\t    const char *dev_name)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tstruct nfs4_mount_data *data = (struct nfs4_mount_data *)options;\n\tchar *c;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = 4;\n\n\tswitch (data->version) {\n\tcase 1:\n\t\tif (data->host_addrlen > sizeof(args->nfs_server.address))\n\t\t\tgoto out_no_address;\n\t\tif (data->host_addrlen == 0)\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.addrlen = data->host_addrlen;\n\t\tif (copy_from_user(sap, data->host_addr, data->host_addrlen))\n\t\t\treturn -EFAULT;\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.port = ntohs(((struct sockaddr_in *)sap)->sin_port);\n\n\t\tif (data->auth_flavourlen) {\n\t\t\trpc_authflavor_t pseudoflavor;\n\t\t\tif (data->auth_flavourlen > 1)\n\t\t\t\tgoto out_inval_auth;\n\t\t\tif (copy_from_user(&pseudoflavor,\n\t\t\t\t\t   data->auth_flavours,\n\t\t\t\t\t   sizeof(pseudoflavor)))\n\t\t\t\treturn -EFAULT;\n\t\t\targs->selected_flavor = pseudoflavor;\n\t\t} else\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\n\t\tc = strndup_user(data->hostname.data, NFS4_MAXNAMLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.hostname = c;\n\n\t\tc = strndup_user(data->mnt_path.data, NFS4_MAXPATHLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.export_path = c;\n\t\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", c);\n\n\t\tc = strndup_user(data->client_addr.data, 16);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->client_address = c;\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs4_fill_super\n\t\t * can deal with.\n\t\t */\n\n\t\targs->flags\t= data->flags & NFS4_MOUNT_FLAGMASK;\n\t\targs->rsize\t= data->rsize;\n\t\targs->wsize\t= data->wsize;\n\t\targs->timeo\t= data->timeo;\n\t\targs->retrans\t= data->retrans;\n\t\targs->acregmin\t= data->acregmin;\n\t\targs->acregmax\t= data->acregmax;\n\t\targs->acdirmin\t= data->acdirmin;\n\t\targs->acdirmax\t= data->acdirmax;\n\t\targs->nfs_server.protocol = data->proto;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_inval_auth:\n\tdfprintk(MOUNT, \"NFS4: Invalid number of RPC auth flavours %d\\n\",\n\t\t data->auth_flavourlen);\n\treturn -EINVAL;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_TEXT_DATA\t\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_TEXT_DATA\t\t1\n\nstatic int nfs4_validate_mount_data(void *options,\n\t\t\t\t    struct nfs_parsed_mount_data *args,\n\t\t\t\t    const char *dev_name)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tstruct nfs4_mount_data *data = (struct nfs4_mount_data *)options;\n\tchar *c;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = 4;\n\n\tswitch (data->version) {\n\tcase 1:\n\t\tif (data->host_addrlen > sizeof(args->nfs_server.address))\n\t\t\tgoto out_no_address;\n\t\tif (data->host_addrlen == 0)\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.addrlen = data->host_addrlen;\n\t\tif (copy_from_user(sap, data->host_addr, data->host_addrlen))\n\t\t\treturn -EFAULT;\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\t\targs->nfs_server.port = ntohs(((struct sockaddr_in *)sap)->sin_port);\n\n\t\tif (data->auth_flavourlen) {\n\t\t\trpc_authflavor_t pseudoflavor;\n\t\t\tif (data->auth_flavourlen > 1)\n\t\t\t\tgoto out_inval_auth;\n\t\t\tif (copy_from_user(&pseudoflavor,\n\t\t\t\t\t   data->auth_flavours,\n\t\t\t\t\t   sizeof(pseudoflavor)))\n\t\t\t\treturn -EFAULT;\n\t\t\targs->selected_flavor = pseudoflavor;\n\t\t} else\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\n\t\tc = strndup_user(data->hostname.data, NFS4_MAXNAMLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.hostname = c;\n\n\t\tc = strndup_user(data->mnt_path.data, NFS4_MAXPATHLEN);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->nfs_server.export_path = c;\n\t\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", c);\n\n\t\tc = strndup_user(data->client_addr.data, 16);\n\t\tif (IS_ERR(c))\n\t\t\treturn PTR_ERR(c);\n\t\targs->client_address = c;\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs4_fill_super\n\t\t * can deal with.\n\t\t */\n\n\t\targs->flags\t= data->flags & NFS4_MOUNT_FLAGMASK;\n\t\targs->rsize\t= data->rsize;\n\t\targs->wsize\t= data->wsize;\n\t\targs->timeo\t= data->timeo;\n\t\targs->retrans\t= data->retrans;\n\t\targs->acregmin\t= data->acregmin;\n\t\targs->acregmax\t= data->acregmax;\n\t\targs->acdirmin\t= data->acdirmin;\n\t\targs->acdirmax\t= data->acdirmax;\n\t\targs->nfs_server.protocol = data->proto;\n\t\tnfs_validate_transport_protocol(args);\n\t\tif (args->nfs_server.protocol == XPRT_TRANSPORT_UDP)\n\t\t\tgoto out_invalid_transport_udp;\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_inval_auth:\n\tdfprintk(MOUNT, \"NFS4: Invalid number of RPC auth flavours %d\\n\",\n\t\t data->auth_flavourlen);\n\treturn -EINVAL;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS4: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_transport_udp:\n\tdfprintk(MOUNT, \"NFSv4: Unsupported transport protocol udp\\n\");\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs23_validate_mount_data",
          "args": [
            "options",
            "args",
            "mntfh",
            "dev_name"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "nfs23_validate_mount_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1950-2096",
          "snippet": "static int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define NFS_DEFAULT_VERSION 2",
            "#define NFS_DEFAULT_VERSION 3",
            "#define NFS_TEXT_DATA\t\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_DEFAULT_VERSION 2\n#define NFS_DEFAULT_VERSION 3\n#define NFS_TEXT_DATA\t\t1\n\nstatic int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\n\nstatic int nfs_validate_mount_data(struct file_system_type *fs_type,\n\t\t\t\t   void *options,\n\t\t\t\t   struct nfs_parsed_mount_data *args,\n\t\t\t\t   struct nfs_fh *mntfh,\n\t\t\t\t   const char *dev_name)\n{\n\tif (fs_type == &nfs_fs_type)\n\t\treturn nfs23_validate_mount_data(options, args, mntfh, dev_name);\n\treturn nfs4_validate_mount_data(options, args, dev_name);\n}"
  },
  {
    "function_name": "nfs23_validate_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1950-2096",
    "snippet": "static int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NFS_DEFAULT_VERSION 2",
      "#define NFS_DEFAULT_VERSION 3",
      "#define NFS_TEXT_DATA\t\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: invalid root filehandle\\n\""
          ],
          "line": 2094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: mount program didn't pass remote address\\n\""
          ],
          "line": 2090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: not enough memory to handle mount options\\n\""
          ],
          "line": 2086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: nfs_mount_data version supports only AUTH_SYS\\n\""
          ],
          "line": 2082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: nfs_mount_data version %d does not support v3\\n\"",
            "data->version"
          ],
          "line": 2077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: mount program didn't pass any mount data\\n\""
          ],
          "line": 2073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "opts_str"
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_sb_parse_opts_str",
          "args": [
            "opts_str",
            "&args->lsm_opts"
          ],
          "line": 2056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "opts_str",
            "&data->context[0]"
          ],
          "line": 2055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "opts_str",
            "\"context=\""
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(data->context) + 8",
            "GFP_KERNEL"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "data->hostname",
            "GFP_KERNEL"
          ],
          "line": 2022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_verify_server_address",
          "args": [
            "sap"
          ],
          "line": 2016
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_verify_server_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "957-972",
          "snippet": "static int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "data->addr.sin_port"
          ],
          "line": 2015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "sap",
            "&data->addr",
            "sizeof(data->addr)"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "mntfh->data + mntfh->size",
            "0",
            "sizeof(mntfh->data) - mntfh->size"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "mntfh->data",
            "data->root.data",
            "mntfh->size"
          ],
          "line": 1992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data->context",
            "0",
            "sizeof(data->context)"
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "data->root.data",
            "data->old_root.data",
            "NFS2_FHSIZE"
          ],
          "line": 1972
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define NFS_DEFAULT_VERSION 2\n#define NFS_DEFAULT_VERSION 3\n#define NFS_TEXT_DATA\t\t1\n\nstatic int nfs23_validate_mount_data(void *options,\n\t\t\t\t     struct nfs_parsed_mount_data *args,\n\t\t\t\t     struct nfs_fh *mntfh,\n\t\t\t\t     const char *dev_name)\n{\n\tstruct nfs_mount_data *data = (struct nfs_mount_data *)options;\n\tstruct sockaddr *sap = (struct sockaddr *)&args->nfs_server.address;\n\tint extra_flags = NFS_MOUNT_LEGACY_INTERFACE;\n\n\tif (data == NULL)\n\t\tgoto out_no_data;\n\n\targs->version = NFS_DEFAULT_VERSION;\n\tswitch (data->version) {\n\tcase 1:\n\t\tdata->namlen = 0;\n\tcase 2:\n\t\tdata->bsize = 0;\n\tcase 3:\n\t\tif (data->flags & NFS_MOUNT_VER3)\n\t\t\tgoto out_no_v3;\n\t\tdata->root.size = NFS2_FHSIZE;\n\t\tmemcpy(data->root.data, data->old_root.data, NFS2_FHSIZE);\n\t\t/* Turn off security negotiation */\n\t\textra_flags |= NFS_MOUNT_SECFLAVOUR;\n\tcase 4:\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\tgoto out_no_sec;\n\tcase 5:\n\t\tmemset(data->context, 0, sizeof(data->context));\n\tcase 6:\n\t\tif (data->flags & NFS_MOUNT_VER3) {\n\t\t\tif (data->root.size > NFS3_FHSIZE || data->root.size == 0)\n\t\t\t\tgoto out_invalid_fh;\n\t\t\tmntfh->size = data->root.size;\n\t\t\targs->version = 3;\n\t\t} else {\n\t\t\tmntfh->size = NFS2_FHSIZE;\n\t\t\targs->version = 2;\n\t\t}\n\n\n\t\tmemcpy(mntfh->data, data->root.data, mntfh->size);\n\t\tif (mntfh->size < sizeof(mntfh->data))\n\t\t\tmemset(mntfh->data + mntfh->size, 0,\n\t\t\t       sizeof(mntfh->data) - mntfh->size);\n\n\t\t/*\n\t\t * Translate to nfs_parsed_mount_data, which nfs_fill_super\n\t\t * can deal with.\n\t\t */\n\t\targs->flags\t\t= data->flags & NFS_MOUNT_FLAGMASK;\n\t\targs->flags\t\t|= extra_flags;\n\t\targs->rsize\t\t= data->rsize;\n\t\targs->wsize\t\t= data->wsize;\n\t\targs->timeo\t\t= data->timeo;\n\t\targs->retrans\t\t= data->retrans;\n\t\targs->acregmin\t\t= data->acregmin;\n\t\targs->acregmax\t\t= data->acregmax;\n\t\targs->acdirmin\t\t= data->acdirmin;\n\t\targs->acdirmax\t\t= data->acdirmax;\n\t\targs->need_mount\t= false;\n\n\t\tmemcpy(sap, &data->addr, sizeof(data->addr));\n\t\targs->nfs_server.addrlen = sizeof(data->addr);\n\t\targs->nfs_server.port = ntohs(data->addr.sin_port);\n\t\tif (!nfs_verify_server_address(sap))\n\t\t\tgoto out_no_address;\n\n\t\tif (!(data->flags & NFS_MOUNT_TCP))\n\t\t\targs->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t\targs->nfs_server.hostname = kstrdup(data->hostname, GFP_KERNEL);\n\t\targs->namlen\t\t= data->namlen;\n\t\targs->bsize\t\t= data->bsize;\n\n\t\tif (data->flags & NFS_MOUNT_SECFLAVOUR)\n\t\t\targs->selected_flavor = data->pseudoflavor;\n\t\telse\n\t\t\targs->selected_flavor = RPC_AUTH_UNIX;\n\t\tif (!args->nfs_server.hostname)\n\t\t\tgoto out_nomem;\n\n\t\tif (!(data->flags & NFS_MOUNT_NONLM))\n\t\t\targs->flags &= ~(NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\t NFS_MOUNT_LOCAL_FCNTL);\n\t\telse\n\t\t\targs->flags |= (NFS_MOUNT_LOCAL_FLOCK|\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t/*\n\t\t * The legacy version 6 binary mount data from userspace has a\n\t\t * field used only to transport selinux information into the\n\t\t * the kernel.  To continue to support that functionality we\n\t\t * have a touch of selinux knowledge here in the NFS code. The\n\t\t * userspace code converted context=blah to just blah so we are\n\t\t * converting back to the full string selinux understands.\n\t\t */\n\t\tif (data->context[0]){\n#ifdef CONFIG_SECURITY_SELINUX\n\t\t\tint rc;\n\t\t\tchar *opts_str = kmalloc(sizeof(data->context) + 8, GFP_KERNEL);\n\t\t\tif (!opts_str)\n\t\t\t\treturn -ENOMEM;\n\t\t\tstrcpy(opts_str, \"context=\");\n\t\t\tdata->context[NFS_MAX_CONTEXT_LEN] = '\\0';\n\t\t\tstrcat(opts_str, &data->context[0]);\n\t\t\trc = security_sb_parse_opts_str(opts_str, &args->lsm_opts);\n\t\t\tkfree(opts_str);\n\t\t\tif (rc)\n\t\t\t\treturn rc;\n#else\n\t\t\treturn -EINVAL;\n#endif\n\t\t}\n\n\t\tbreak;\n\tdefault:\n\t\treturn NFS_TEXT_DATA;\n\t}\n\n\treturn 0;\n\nout_no_data:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass any mount data\\n\");\n\treturn -EINVAL;\n\nout_no_v3:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version %d does not support v3\\n\",\n\t\t data->version);\n\treturn -EINVAL;\n\nout_no_sec:\n\tdfprintk(MOUNT, \"NFS: nfs_mount_data version supports only AUTH_SYS\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to handle mount options\\n\");\n\treturn -ENOMEM;\n\nout_no_address:\n\tdfprintk(MOUNT, \"NFS: mount program didn't pass remote address\\n\");\n\treturn -EINVAL;\n\nout_invalid_fh:\n\tdfprintk(MOUNT, \"NFS: invalid root filehandle\\n\");\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "nfs_parse_devname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1871-1932",
    "snippet": "static int nfs_parse_devname(const char *dev_name,\n\t\t\t     char **hostname, size_t maxnamlen,\n\t\t\t     char **export_path, size_t maxpathlen)\n{\n\tsize_t len;\n\tchar *end;\n\n\t/* Is the host name protected with square brakcets? */\n\tif (*dev_name == '[') {\n\t\tend = strchr(++dev_name, ']');\n\t\tif (end == NULL || end[1] != ':')\n\t\t\tgoto out_bad_devname;\n\n\t\tlen = end - dev_name;\n\t\tend++;\n\t} else {\n\t\tchar *comma;\n\n\t\tend = strchr(dev_name, ':');\n\t\tif (end == NULL)\n\t\t\tgoto out_bad_devname;\n\t\tlen = end - dev_name;\n\n\t\t/* kill possible hostname list: not supported */\n\t\tcomma = strchr(dev_name, ',');\n\t\tif (comma != NULL && comma < end)\n\t\t\t*comma = 0;\n\t}\n\n\tif (len > maxnamlen)\n\t\tgoto out_hostname;\n\n\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t*hostname = kstrndup(dev_name, len, GFP_KERNEL);\n\tif (*hostname == NULL)\n\t\tgoto out_nomem;\n\tlen = strlen(++end);\n\tif (len > maxpathlen)\n\t\tgoto out_path;\n\t*export_path = kstrndup(end, len, GFP_KERNEL);\n\tif (!*export_path)\n\t\tgoto out_nomem;\n\n\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", *export_path);\n\treturn 0;\n\nout_bad_devname:\n\tdfprintk(MOUNT, \"NFS: device name not in host:path format\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to parse device name\\n\");\n\treturn -ENOMEM;\n\nout_hostname:\n\tdfprintk(MOUNT, \"NFS: server hostname too long\\n\");\n\treturn -ENAMETOOLONG;\n\nout_path:\n\tdfprintk(MOUNT, \"NFS: export pathname too long\\n\");\n\treturn -ENAMETOOLONG;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: export pathname too long\\n\""
          ],
          "line": 1930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: server hostname too long\\n\""
          ],
          "line": 1926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: not enough memory to parse device name\\n\""
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: device name not in host:path format\\n\""
          ],
          "line": 1918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: MNTPATH: '%s'\\n\"",
            "*export_path"
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrndup",
          "args": [
            "end",
            "len",
            "GFP_KERNEL"
          ],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "++end"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrndup",
          "args": [
            "dev_name",
            "len",
            "GFP_KERNEL"
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "dev_name",
            "','"
          ],
          "line": 1895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "dev_name",
            "':'"
          ],
          "line": 1889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "++dev_name",
            "']'"
          ],
          "line": 1880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_parse_devname(const char *dev_name,\n\t\t\t     char **hostname, size_t maxnamlen,\n\t\t\t     char **export_path, size_t maxpathlen)\n{\n\tsize_t len;\n\tchar *end;\n\n\t/* Is the host name protected with square brakcets? */\n\tif (*dev_name == '[') {\n\t\tend = strchr(++dev_name, ']');\n\t\tif (end == NULL || end[1] != ':')\n\t\t\tgoto out_bad_devname;\n\n\t\tlen = end - dev_name;\n\t\tend++;\n\t} else {\n\t\tchar *comma;\n\n\t\tend = strchr(dev_name, ':');\n\t\tif (end == NULL)\n\t\t\tgoto out_bad_devname;\n\t\tlen = end - dev_name;\n\n\t\t/* kill possible hostname list: not supported */\n\t\tcomma = strchr(dev_name, ',');\n\t\tif (comma != NULL && comma < end)\n\t\t\t*comma = 0;\n\t}\n\n\tif (len > maxnamlen)\n\t\tgoto out_hostname;\n\n\t/* N.B. caller will free nfs_server.hostname in all cases */\n\t*hostname = kstrndup(dev_name, len, GFP_KERNEL);\n\tif (*hostname == NULL)\n\t\tgoto out_nomem;\n\tlen = strlen(++end);\n\tif (len > maxpathlen)\n\t\tgoto out_path;\n\t*export_path = kstrndup(end, len, GFP_KERNEL);\n\tif (!*export_path)\n\t\tgoto out_nomem;\n\n\tdfprintk(MOUNT, \"NFS: MNTPATH: '%s'\\n\", *export_path);\n\treturn 0;\n\nout_bad_devname:\n\tdfprintk(MOUNT, \"NFS: device name not in host:path format\\n\");\n\treturn -EINVAL;\n\nout_nomem:\n\tdfprintk(MOUNT, \"NFS: not enough memory to parse device name\\n\");\n\treturn -ENOMEM;\n\nout_hostname:\n\tdfprintk(MOUNT, \"NFS: server hostname too long\\n\");\n\treturn -ENAMETOOLONG;\n\nout_path:\n\tdfprintk(MOUNT, \"NFS: export pathname too long\\n\");\n\treturn -ENAMETOOLONG;\n}"
  },
  {
    "function_name": "nfs_try_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1844-1859",
    "snippet": "struct dentry *nfs_try_mount(int flags, const char *dev_name,\n\t\t\t     struct nfs_mount_info *mount_info,\n\t\t\t     struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\n\tif (mount_info->parsed->need_mount)\n\t\tserver = nfs_try_mount_request(mount_info, nfs_mod);\n\telse\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\n\tif (IS_ERR(server))\n\t\treturn ERR_CAST(server);\n\n\treturn nfs_fs_mount_common(server, flags, dev_name, mount_info, nfs_mod);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fs_mount_common",
          "args": [
            "server",
            "flags",
            "dev_name",
            "mount_info",
            "nfs_mod"
          ],
          "line": 1858
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fs_mount_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "2535-2608",
          "snippet": "struct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_fs_mount_common(struct nfs_server *server,\n\t\t\t\t   int flags, const char *dev_name,\n\t\t\t\t   struct nfs_mount_info *mount_info,\n\t\t\t\t   struct nfs_subversion *nfs_mod)\n{\n\tstruct super_block *s;\n\tstruct dentry *mntroot = ERR_PTR(-ENOMEM);\n\tint (*compare_super)(struct super_block *, void *) = nfs_compare_super;\n\tstruct nfs_sb_mountdata sb_mntdata = {\n\t\t.mntflags = flags,\n\t\t.server = server,\n\t};\n\tint error;\n\n\tif (server->flags & NFS_MOUNT_UNSHARED)\n\t\tcompare_super = NULL;\n\n\t/* -o noac implies -o sync */\n\tif (server->flags & NFS_MOUNT_NOAC)\n\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\tif (mount_info->cloned != NULL && mount_info->cloned->sb != NULL)\n\t\tif (mount_info->cloned->sb->s_flags & MS_SYNCHRONOUS)\n\t\t\tsb_mntdata.mntflags |= MS_SYNCHRONOUS;\n\n\t/* Get a superblock - note that we may end up sharing one that already exists */\n\ts = sget(nfs_mod->nfs_fs, compare_super, nfs_set_super, flags, &sb_mntdata);\n\tif (IS_ERR(s)) {\n\t\tmntroot = ERR_CAST(s);\n\t\tgoto out_err_nosb;\n\t}\n\n\tif (s->s_fs_info != server) {\n\t\tnfs_free_server(server);\n\t\tserver = NULL;\n\t} else {\n\t\terror = nfs_bdi_register(server);\n\t\tif (error) {\n\t\t\tmntroot = ERR_PTR(error);\n\t\t\tgoto error_splat_super;\n\t\t}\n\t\tserver->super = s;\n\t}\n\n\tif (!s->s_root) {\n\t\t/* initial superblock/root creation */\n\t\tmount_info->fill_super(s, mount_info);\n\t\tnfs_get_cache_cookie(s, mount_info->parsed, mount_info->cloned);\n\t}\n\n\tmntroot = nfs_get_root(s, mount_info->mntfh, dev_name);\n\tif (IS_ERR(mntroot))\n\t\tgoto error_splat_super;\n\n\terror = mount_info->set_security(s, mntroot, mount_info);\n\tif (error)\n\t\tgoto error_splat_root;\n\n\ts->s_flags |= MS_ACTIVE;\n\nout:\n\treturn mntroot;\n\nout_err_nosb:\n\tnfs_free_server(server);\n\tgoto out;\n\nerror_splat_root:\n\tdput(mntroot);\n\tmntroot = ERR_PTR(error);\nerror_splat_super:\n\tdeactivate_locked_super(s);\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "server"
          ],
          "line": 1856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server"
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->create_server",
          "args": [
            "mount_info",
            "nfs_mod"
          ],
          "line": 1853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_try_mount_request",
          "args": [
            "mount_info",
            "nfs_mod"
          ],
          "line": 1851
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_try_mount_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1771-1842",
          "snippet": "static struct nfs_server *nfs_try_mount_request(struct nfs_mount_info *mount_info,\n\t\t\t\t\tstruct nfs_subversion *nfs_mod)\n{\n\tint status;\n\tunsigned int i;\n\tbool tried_auth_unix = false;\n\tbool auth_null_in_list = false;\n\tstruct nfs_server *server = ERR_PTR(-EACCES);\n\tstruct nfs_parsed_mount_data *args = mount_info->parsed;\n\trpc_authflavor_t authlist[NFS_MAX_SECFLAVORS];\n\tunsigned int authlist_len = ARRAY_SIZE(authlist);\n\n\tstatus = nfs_request_mount(args, mount_info->mntfh, authlist,\n\t\t\t\t\t&authlist_len);\n\tif (status)\n\t\treturn ERR_PTR(status);\n\n\t/*\n\t * Was a sec= authflavor specified in the options? First, verify\n\t * whether the server supports it, and then just try to use it if so.\n\t */\n\tif (args->auth_info.flavor_len > 0) {\n\t\tstatus = nfs_verify_authflavors(args, authlist, authlist_len);\n\t\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\",\n\t\t\t args->selected_flavor);\n\t\tif (status)\n\t\t\treturn ERR_PTR(status);\n\t\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t}\n\n\t/*\n\t * No sec= option was provided. RFC 2623, section 2.7 suggests we\n\t * SHOULD prefer the flavor listed first. However, some servers list\n\t * AUTH_NULL first. Avoid ever choosing AUTH_NULL.\n\t */\n\tfor (i = 0; i < authlist_len; ++i) {\n\t\trpc_authflavor_t flavor;\n\t\tstruct rpcsec_gss_info info;\n\n\t\tflavor = authlist[i];\n\t\tswitch (flavor) {\n\t\tcase RPC_AUTH_UNIX:\n\t\t\ttried_auth_unix = true;\n\t\t\tbreak;\n\t\tcase RPC_AUTH_NULL:\n\t\t\tauth_null_in_list = true;\n\t\t\tcontinue;\n\t\tdefault:\n\t\t\tif (rpcauth_get_gssinfo(flavor, &info) != 0)\n\t\t\t\tcontinue;\n\t\t\t/* Fallthrough */\n\t\t}\n\t\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", flavor);\n\t\targs->selected_flavor = flavor;\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t\tif (!IS_ERR(server))\n\t\t\treturn server;\n\t}\n\n\t/*\n\t * Nothing we tried so far worked. At this point, give up if we've\n\t * already tried AUTH_UNIX or if the server's list doesn't contain\n\t * AUTH_NULL\n\t */\n\tif (tried_auth_unix || !auth_null_in_list)\n\t\treturn server;\n\n\t/* Last chance! Try AUTH_UNIX */\n\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", RPC_AUTH_UNIX);\n\targs->selected_flavor = RPC_AUTH_UNIX;\n\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_server *nfs_try_mount_request(struct nfs_mount_info *mount_info,\n\t\t\t\t\tstruct nfs_subversion *nfs_mod)\n{\n\tint status;\n\tunsigned int i;\n\tbool tried_auth_unix = false;\n\tbool auth_null_in_list = false;\n\tstruct nfs_server *server = ERR_PTR(-EACCES);\n\tstruct nfs_parsed_mount_data *args = mount_info->parsed;\n\trpc_authflavor_t authlist[NFS_MAX_SECFLAVORS];\n\tunsigned int authlist_len = ARRAY_SIZE(authlist);\n\n\tstatus = nfs_request_mount(args, mount_info->mntfh, authlist,\n\t\t\t\t\t&authlist_len);\n\tif (status)\n\t\treturn ERR_PTR(status);\n\n\t/*\n\t * Was a sec= authflavor specified in the options? First, verify\n\t * whether the server supports it, and then just try to use it if so.\n\t */\n\tif (args->auth_info.flavor_len > 0) {\n\t\tstatus = nfs_verify_authflavors(args, authlist, authlist_len);\n\t\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\",\n\t\t\t args->selected_flavor);\n\t\tif (status)\n\t\t\treturn ERR_PTR(status);\n\t\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t}\n\n\t/*\n\t * No sec= option was provided. RFC 2623, section 2.7 suggests we\n\t * SHOULD prefer the flavor listed first. However, some servers list\n\t * AUTH_NULL first. Avoid ever choosing AUTH_NULL.\n\t */\n\tfor (i = 0; i < authlist_len; ++i) {\n\t\trpc_authflavor_t flavor;\n\t\tstruct rpcsec_gss_info info;\n\n\t\tflavor = authlist[i];\n\t\tswitch (flavor) {\n\t\tcase RPC_AUTH_UNIX:\n\t\t\ttried_auth_unix = true;\n\t\t\tbreak;\n\t\tcase RPC_AUTH_NULL:\n\t\t\tauth_null_in_list = true;\n\t\t\tcontinue;\n\t\tdefault:\n\t\t\tif (rpcauth_get_gssinfo(flavor, &info) != 0)\n\t\t\t\tcontinue;\n\t\t\t/* Fallthrough */\n\t\t}\n\t\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", flavor);\n\t\targs->selected_flavor = flavor;\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t\tif (!IS_ERR(server))\n\t\t\treturn server;\n\t}\n\n\t/*\n\t * Nothing we tried so far worked. At this point, give up if we've\n\t * already tried AUTH_UNIX or if the server's list doesn't contain\n\t * AUTH_NULL\n\t */\n\tif (tried_auth_unix || !auth_null_in_list)\n\t\treturn server;\n\n\t/* Last chance! Try AUTH_UNIX */\n\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", RPC_AUTH_UNIX);\n\targs->selected_flavor = RPC_AUTH_UNIX;\n\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct dentry *nfs_try_mount(int flags, const char *dev_name,\n\t\t\t     struct nfs_mount_info *mount_info,\n\t\t\t     struct nfs_subversion *nfs_mod)\n{\n\tstruct nfs_server *server;\n\n\tif (mount_info->parsed->need_mount)\n\t\tserver = nfs_try_mount_request(mount_info, nfs_mod);\n\telse\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\n\tif (IS_ERR(server))\n\t\treturn ERR_CAST(server);\n\n\treturn nfs_fs_mount_common(server, flags, dev_name, mount_info, nfs_mod);\n}"
  },
  {
    "function_name": "nfs_try_mount_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1771-1842",
    "snippet": "static struct nfs_server *nfs_try_mount_request(struct nfs_mount_info *mount_info,\n\t\t\t\t\tstruct nfs_subversion *nfs_mod)\n{\n\tint status;\n\tunsigned int i;\n\tbool tried_auth_unix = false;\n\tbool auth_null_in_list = false;\n\tstruct nfs_server *server = ERR_PTR(-EACCES);\n\tstruct nfs_parsed_mount_data *args = mount_info->parsed;\n\trpc_authflavor_t authlist[NFS_MAX_SECFLAVORS];\n\tunsigned int authlist_len = ARRAY_SIZE(authlist);\n\n\tstatus = nfs_request_mount(args, mount_info->mntfh, authlist,\n\t\t\t\t\t&authlist_len);\n\tif (status)\n\t\treturn ERR_PTR(status);\n\n\t/*\n\t * Was a sec= authflavor specified in the options? First, verify\n\t * whether the server supports it, and then just try to use it if so.\n\t */\n\tif (args->auth_info.flavor_len > 0) {\n\t\tstatus = nfs_verify_authflavors(args, authlist, authlist_len);\n\t\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\",\n\t\t\t args->selected_flavor);\n\t\tif (status)\n\t\t\treturn ERR_PTR(status);\n\t\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t}\n\n\t/*\n\t * No sec= option was provided. RFC 2623, section 2.7 suggests we\n\t * SHOULD prefer the flavor listed first. However, some servers list\n\t * AUTH_NULL first. Avoid ever choosing AUTH_NULL.\n\t */\n\tfor (i = 0; i < authlist_len; ++i) {\n\t\trpc_authflavor_t flavor;\n\t\tstruct rpcsec_gss_info info;\n\n\t\tflavor = authlist[i];\n\t\tswitch (flavor) {\n\t\tcase RPC_AUTH_UNIX:\n\t\t\ttried_auth_unix = true;\n\t\t\tbreak;\n\t\tcase RPC_AUTH_NULL:\n\t\t\tauth_null_in_list = true;\n\t\t\tcontinue;\n\t\tdefault:\n\t\t\tif (rpcauth_get_gssinfo(flavor, &info) != 0)\n\t\t\t\tcontinue;\n\t\t\t/* Fallthrough */\n\t\t}\n\t\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", flavor);\n\t\targs->selected_flavor = flavor;\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t\tif (!IS_ERR(server))\n\t\t\treturn server;\n\t}\n\n\t/*\n\t * Nothing we tried so far worked. At this point, give up if we've\n\t * already tried AUTH_UNIX or if the server's list doesn't contain\n\t * AUTH_NULL\n\t */\n\tif (tried_auth_unix || !auth_null_in_list)\n\t\treturn server;\n\n\t/* Last chance! Try AUTH_UNIX */\n\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", RPC_AUTH_UNIX);\n\targs->selected_flavor = RPC_AUTH_UNIX;\n\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->create_server",
          "args": [
            "mount_info",
            "nfs_mod"
          ],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: attempting to use auth flavor %u\\n\"",
            "RPC_AUTH_UNIX"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "server"
          ],
          "line": 1826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->create_server",
          "args": [
            "mount_info",
            "nfs_mod"
          ],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: attempting to use auth flavor %u\\n\"",
            "flavor"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpcauth_get_gssinfo",
          "args": [
            "flavor",
            "&info"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mod->rpc_ops->create_server",
          "args": [
            "mount_info",
            "nfs_mod"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "status"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: using auth flavor %u\\n\"",
            "args->selected_flavor"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_verify_authflavors",
          "args": [
            "args",
            "authlist",
            "authlist_len"
          ],
          "line": 1793
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_verify_authflavors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1676-1706",
          "snippet": "static int nfs_verify_authflavors(struct nfs_parsed_mount_data *args,\n\t\t\trpc_authflavor_t *server_authlist, unsigned int count)\n{\n\trpc_authflavor_t flavor = RPC_AUTH_MAXFLAVOR;\n\tunsigned int i;\n\n\t/*\n\t * If the sec= mount option is used, the specified flavor or AUTH_NULL\n\t * must be in the list returned by the server.\n\t *\n\t * AUTH_NULL has a special meaning when it's in the server list - it\n\t * means that the server will ignore the rpc creds, so any flavor\n\t * can be used.\n\t */\n\tfor (i = 0; i < count; i++) {\n\t\tflavor = server_authlist[i];\n\n\t\tif (nfs_auth_info_match(&args->auth_info, flavor) ||\n\t\t    flavor == RPC_AUTH_NULL)\n\t\t\tgoto out;\n\t}\n\n\tdfprintk(MOUNT,\n\t\t \"NFS: specified auth flavors not supported by server\\n\");\n\treturn -EACCES;\n\nout:\n\targs->selected_flavor = flavor;\n\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\", args->selected_flavor);\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_authflavors(struct nfs_parsed_mount_data *args,\n\t\t\trpc_authflavor_t *server_authlist, unsigned int count)\n{\n\trpc_authflavor_t flavor = RPC_AUTH_MAXFLAVOR;\n\tunsigned int i;\n\n\t/*\n\t * If the sec= mount option is used, the specified flavor or AUTH_NULL\n\t * must be in the list returned by the server.\n\t *\n\t * AUTH_NULL has a special meaning when it's in the server list - it\n\t * means that the server will ignore the rpc creds, so any flavor\n\t * can be used.\n\t */\n\tfor (i = 0; i < count; i++) {\n\t\tflavor = server_authlist[i];\n\n\t\tif (nfs_auth_info_match(&args->auth_info, flavor) ||\n\t\t    flavor == RPC_AUTH_NULL)\n\t\t\tgoto out;\n\t}\n\n\tdfprintk(MOUNT,\n\t\t \"NFS: specified auth flavors not supported by server\\n\");\n\treturn -EACCES;\n\nout:\n\targs->selected_flavor = flavor;\n\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\", args->selected_flavor);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "status"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_request_mount",
          "args": [
            "args",
            "mount_info->mntfh",
            "authlist",
            "&authlist_len"
          ],
          "line": 1783
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_request_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1712-1769",
          "snippet": "static int nfs_request_mount(struct nfs_parsed_mount_data *args,\n\t\t\t     struct nfs_fh *root_fh,\n\t\t\t     rpc_authflavor_t *server_authlist,\n\t\t\t     unsigned int *server_authlist_len)\n{\n\tstruct nfs_mount_request request = {\n\t\t.sap\t\t= (struct sockaddr *)\n\t\t\t\t\t\t&args->mount_server.address,\n\t\t.dirpath\t= args->nfs_server.export_path,\n\t\t.protocol\t= args->mount_server.protocol,\n\t\t.fh\t\t= root_fh,\n\t\t.noresvport\t= args->flags & NFS_MOUNT_NORESVPORT,\n\t\t.auth_flav_len\t= server_authlist_len,\n\t\t.auth_flavs\t= server_authlist,\n\t\t.net\t\t= args->net,\n\t};\n\tint status;\n\n\tif (args->mount_server.version == 0) {\n\t\tswitch (args->version) {\n\t\t\tdefault:\n\t\t\t\targs->mount_server.version = NFS_MNT3_VERSION;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\targs->mount_server.version = NFS_MNT_VERSION;\n\t\t}\n\t}\n\trequest.version = args->mount_server.version;\n\n\tif (args->mount_server.hostname)\n\t\trequest.hostname = args->mount_server.hostname;\n\telse\n\t\trequest.hostname = args->nfs_server.hostname;\n\n\t/*\n\t * Construct the mount server's address.\n\t */\n\tif (args->mount_server.address.ss_family == AF_UNSPEC) {\n\t\tmemcpy(request.sap, &args->nfs_server.address,\n\t\t       args->nfs_server.addrlen);\n\t\targs->mount_server.addrlen = args->nfs_server.addrlen;\n\t}\n\trequest.salen = args->mount_server.addrlen;\n\tnfs_set_port(request.sap, &args->mount_server.port, 0);\n\n\t/*\n\t * Now ask the mount server to map our export path\n\t * to a file handle.\n\t */\n\tstatus = nfs_mount(&request);\n\tif (status != 0) {\n\t\tdfprintk(MOUNT, \"NFS: unable to mount server %s, error %d\\n\",\n\t\t\t\trequest.hostname, status);\n\t\treturn status;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_request_mount(struct nfs_parsed_mount_data *args,\n\t\t\t     struct nfs_fh *root_fh,\n\t\t\t     rpc_authflavor_t *server_authlist,\n\t\t\t     unsigned int *server_authlist_len)\n{\n\tstruct nfs_mount_request request = {\n\t\t.sap\t\t= (struct sockaddr *)\n\t\t\t\t\t\t&args->mount_server.address,\n\t\t.dirpath\t= args->nfs_server.export_path,\n\t\t.protocol\t= args->mount_server.protocol,\n\t\t.fh\t\t= root_fh,\n\t\t.noresvport\t= args->flags & NFS_MOUNT_NORESVPORT,\n\t\t.auth_flav_len\t= server_authlist_len,\n\t\t.auth_flavs\t= server_authlist,\n\t\t.net\t\t= args->net,\n\t};\n\tint status;\n\n\tif (args->mount_server.version == 0) {\n\t\tswitch (args->version) {\n\t\t\tdefault:\n\t\t\t\targs->mount_server.version = NFS_MNT3_VERSION;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\targs->mount_server.version = NFS_MNT_VERSION;\n\t\t}\n\t}\n\trequest.version = args->mount_server.version;\n\n\tif (args->mount_server.hostname)\n\t\trequest.hostname = args->mount_server.hostname;\n\telse\n\t\trequest.hostname = args->nfs_server.hostname;\n\n\t/*\n\t * Construct the mount server's address.\n\t */\n\tif (args->mount_server.address.ss_family == AF_UNSPEC) {\n\t\tmemcpy(request.sap, &args->nfs_server.address,\n\t\t       args->nfs_server.addrlen);\n\t\targs->mount_server.addrlen = args->nfs_server.addrlen;\n\t}\n\trequest.salen = args->mount_server.addrlen;\n\tnfs_set_port(request.sap, &args->mount_server.port, 0);\n\n\t/*\n\t * Now ask the mount server to map our export path\n\t * to a file handle.\n\t */\n\tstatus = nfs_mount(&request);\n\tif (status != 0) {\n\t\tdfprintk(MOUNT, \"NFS: unable to mount server %s, error %d\\n\",\n\t\t\t\trequest.hostname, status);\n\t\treturn status;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "authlist"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 1778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_server *nfs_try_mount_request(struct nfs_mount_info *mount_info,\n\t\t\t\t\tstruct nfs_subversion *nfs_mod)\n{\n\tint status;\n\tunsigned int i;\n\tbool tried_auth_unix = false;\n\tbool auth_null_in_list = false;\n\tstruct nfs_server *server = ERR_PTR(-EACCES);\n\tstruct nfs_parsed_mount_data *args = mount_info->parsed;\n\trpc_authflavor_t authlist[NFS_MAX_SECFLAVORS];\n\tunsigned int authlist_len = ARRAY_SIZE(authlist);\n\n\tstatus = nfs_request_mount(args, mount_info->mntfh, authlist,\n\t\t\t\t\t&authlist_len);\n\tif (status)\n\t\treturn ERR_PTR(status);\n\n\t/*\n\t * Was a sec= authflavor specified in the options? First, verify\n\t * whether the server supports it, and then just try to use it if so.\n\t */\n\tif (args->auth_info.flavor_len > 0) {\n\t\tstatus = nfs_verify_authflavors(args, authlist, authlist_len);\n\t\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\",\n\t\t\t args->selected_flavor);\n\t\tif (status)\n\t\t\treturn ERR_PTR(status);\n\t\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t}\n\n\t/*\n\t * No sec= option was provided. RFC 2623, section 2.7 suggests we\n\t * SHOULD prefer the flavor listed first. However, some servers list\n\t * AUTH_NULL first. Avoid ever choosing AUTH_NULL.\n\t */\n\tfor (i = 0; i < authlist_len; ++i) {\n\t\trpc_authflavor_t flavor;\n\t\tstruct rpcsec_gss_info info;\n\n\t\tflavor = authlist[i];\n\t\tswitch (flavor) {\n\t\tcase RPC_AUTH_UNIX:\n\t\t\ttried_auth_unix = true;\n\t\t\tbreak;\n\t\tcase RPC_AUTH_NULL:\n\t\t\tauth_null_in_list = true;\n\t\t\tcontinue;\n\t\tdefault:\n\t\t\tif (rpcauth_get_gssinfo(flavor, &info) != 0)\n\t\t\t\tcontinue;\n\t\t\t/* Fallthrough */\n\t\t}\n\t\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", flavor);\n\t\targs->selected_flavor = flavor;\n\t\tserver = nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n\t\tif (!IS_ERR(server))\n\t\t\treturn server;\n\t}\n\n\t/*\n\t * Nothing we tried so far worked. At this point, give up if we've\n\t * already tried AUTH_UNIX or if the server's list doesn't contain\n\t * AUTH_NULL\n\t */\n\tif (tried_auth_unix || !auth_null_in_list)\n\t\treturn server;\n\n\t/* Last chance! Try AUTH_UNIX */\n\tdfprintk(MOUNT, \"NFS: attempting to use auth flavor %u\\n\", RPC_AUTH_UNIX);\n\targs->selected_flavor = RPC_AUTH_UNIX;\n\treturn nfs_mod->rpc_ops->create_server(mount_info, nfs_mod);\n}"
  },
  {
    "function_name": "nfs_request_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1712-1769",
    "snippet": "static int nfs_request_mount(struct nfs_parsed_mount_data *args,\n\t\t\t     struct nfs_fh *root_fh,\n\t\t\t     rpc_authflavor_t *server_authlist,\n\t\t\t     unsigned int *server_authlist_len)\n{\n\tstruct nfs_mount_request request = {\n\t\t.sap\t\t= (struct sockaddr *)\n\t\t\t\t\t\t&args->mount_server.address,\n\t\t.dirpath\t= args->nfs_server.export_path,\n\t\t.protocol\t= args->mount_server.protocol,\n\t\t.fh\t\t= root_fh,\n\t\t.noresvport\t= args->flags & NFS_MOUNT_NORESVPORT,\n\t\t.auth_flav_len\t= server_authlist_len,\n\t\t.auth_flavs\t= server_authlist,\n\t\t.net\t\t= args->net,\n\t};\n\tint status;\n\n\tif (args->mount_server.version == 0) {\n\t\tswitch (args->version) {\n\t\t\tdefault:\n\t\t\t\targs->mount_server.version = NFS_MNT3_VERSION;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\targs->mount_server.version = NFS_MNT_VERSION;\n\t\t}\n\t}\n\trequest.version = args->mount_server.version;\n\n\tif (args->mount_server.hostname)\n\t\trequest.hostname = args->mount_server.hostname;\n\telse\n\t\trequest.hostname = args->nfs_server.hostname;\n\n\t/*\n\t * Construct the mount server's address.\n\t */\n\tif (args->mount_server.address.ss_family == AF_UNSPEC) {\n\t\tmemcpy(request.sap, &args->nfs_server.address,\n\t\t       args->nfs_server.addrlen);\n\t\targs->mount_server.addrlen = args->nfs_server.addrlen;\n\t}\n\trequest.salen = args->mount_server.addrlen;\n\tnfs_set_port(request.sap, &args->mount_server.port, 0);\n\n\t/*\n\t * Now ask the mount server to map our export path\n\t * to a file handle.\n\t */\n\tstatus = nfs_mount(&request);\n\tif (status != 0) {\n\t\tdfprintk(MOUNT, \"NFS: unable to mount server %s, error %d\\n\",\n\t\t\t\trequest.hostname, status);\n\t\treturn status;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: unable to mount server %s, error %d\\n\"",
            "request.hostname",
            "status"
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_mount",
          "args": [
            "&request"
          ],
          "line": 1761
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/mount_clnt.c",
          "lines": "147-226",
          "snippet": "int nfs_mount(struct nfs_mount_request *info)\n{\n\tstruct mountres\tresult = {\n\t\t.fh\t\t= info->fh,\n\t\t.auth_count\t= info->auth_flav_len,\n\t\t.auth_flavors\t= info->auth_flavs,\n\t};\n\tstruct rpc_message msg\t= {\n\t\t.rpc_argp\t= info->dirpath,\n\t\t.rpc_resp\t= &result,\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= info->net,\n\t\t.protocol\t= info->protocol,\n\t\t.address\t= info->sap,\n\t\t.addrsize\t= info->salen,\n\t\t.servername\t= info->hostname,\n\t\t.program\t= &mnt_program,\n\t\t.version\t= info->version,\n\t\t.authflavor\t= RPC_AUTH_UNIX,\n\t};\n\tstruct rpc_clnt\t\t*mnt_clnt;\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS: sending MNT request for %s:%s\\n\",\n\t\t(info->hostname ? info->hostname : \"server\"),\n\t\t\tinfo->dirpath);\n\n\tif (strlen(info->dirpath) > MNTPATHLEN)\n\t\treturn -ENAMETOOLONG;\n\n\tif (info->noresvport)\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\n\tmnt_clnt = rpc_create(&args);\n\tif (IS_ERR(mnt_clnt))\n\t\tgoto out_clnt_err;\n\n\tif (info->version == NFS_MNT3_VERSION)\n\t\tmsg.rpc_proc = &mnt_clnt->cl_procinfo[MOUNTPROC3_MNT];\n\telse\n\t\tmsg.rpc_proc = &mnt_clnt->cl_procinfo[MOUNTPROC_MNT];\n\n\tstatus = rpc_call_sync(mnt_clnt, &msg, RPC_TASK_SOFT|RPC_TASK_TIMEOUT);\n\trpc_shutdown_client(mnt_clnt);\n\n\tif (status < 0)\n\t\tgoto out_call_err;\n\tif (result.errno != 0)\n\t\tgoto out_mnt_err;\n\n\tdprintk(\"NFS: MNT request succeeded\\n\");\n\tstatus = 0;\n\n\t/*\n\t * If the server didn't provide a flavor list, allow the\n\t * client to try any flavor.\n\t */\n\tif (info->version != NFS_MNT3_VERSION || *info->auth_flav_len == 0) {\n\t\tdprintk(\"NFS: Faking up auth_flavs list\\n\");\n\t\tinfo->auth_flavs[0] = RPC_AUTH_NULL;\n\t\t*info->auth_flav_len = 1;\n\t}\nout:\n\treturn status;\n\nout_clnt_err:\n\tstatus = PTR_ERR(mnt_clnt);\n\tdprintk(\"NFS: failed to create MNT RPC client, status=%d\\n\", status);\n\tgoto out;\n\nout_call_err:\n\tdprintk(\"NFS: MNT request failed, status=%d\\n\", status);\n\tgoto out;\n\nout_mnt_err:\n\tdprintk(\"NFS: MNT server returned result %d\\n\", result.errno);\n\tstatus = result.errno;\n\tgoto out;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/sched.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/in.h>",
            "#include <linux/net.h>",
            "#include <linux/uio.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>",
            "#include <linux/socket.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define MNTPATHLEN\t\t(1024)"
          ],
          "globals_used": [
            "static const struct rpc_program mnt_program;",
            "static const struct rpc_program mnt_program = {\n\t.name\t\t= \"mount\",\n\t.number\t\t= NFS_MNT_PROGRAM,\n\t.nrvers\t\t= ARRAY_SIZE(mnt_version),\n\t.version\t= mnt_version,\n\t.stats\t\t= &mnt_stats,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/sched.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/in.h>\n#include <linux/net.h>\n#include <linux/uio.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n#include <linux/socket.h>\n#include <linux/types.h>\n\n#define MNTPATHLEN\t\t(1024)\n\nstatic const struct rpc_program mnt_program;\nstatic const struct rpc_program mnt_program = {\n\t.name\t\t= \"mount\",\n\t.number\t\t= NFS_MNT_PROGRAM,\n\t.nrvers\t\t= ARRAY_SIZE(mnt_version),\n\t.version\t= mnt_version,\n\t.stats\t\t= &mnt_stats,\n};\n\nint nfs_mount(struct nfs_mount_request *info)\n{\n\tstruct mountres\tresult = {\n\t\t.fh\t\t= info->fh,\n\t\t.auth_count\t= info->auth_flav_len,\n\t\t.auth_flavors\t= info->auth_flavs,\n\t};\n\tstruct rpc_message msg\t= {\n\t\t.rpc_argp\t= info->dirpath,\n\t\t.rpc_resp\t= &result,\n\t};\n\tstruct rpc_create_args args = {\n\t\t.net\t\t= info->net,\n\t\t.protocol\t= info->protocol,\n\t\t.address\t= info->sap,\n\t\t.addrsize\t= info->salen,\n\t\t.servername\t= info->hostname,\n\t\t.program\t= &mnt_program,\n\t\t.version\t= info->version,\n\t\t.authflavor\t= RPC_AUTH_UNIX,\n\t};\n\tstruct rpc_clnt\t\t*mnt_clnt;\n\tint\t\t\tstatus;\n\n\tdprintk(\"NFS: sending MNT request for %s:%s\\n\",\n\t\t(info->hostname ? info->hostname : \"server\"),\n\t\t\tinfo->dirpath);\n\n\tif (strlen(info->dirpath) > MNTPATHLEN)\n\t\treturn -ENAMETOOLONG;\n\n\tif (info->noresvport)\n\t\targs.flags |= RPC_CLNT_CREATE_NONPRIVPORT;\n\n\tmnt_clnt = rpc_create(&args);\n\tif (IS_ERR(mnt_clnt))\n\t\tgoto out_clnt_err;\n\n\tif (info->version == NFS_MNT3_VERSION)\n\t\tmsg.rpc_proc = &mnt_clnt->cl_procinfo[MOUNTPROC3_MNT];\n\telse\n\t\tmsg.rpc_proc = &mnt_clnt->cl_procinfo[MOUNTPROC_MNT];\n\n\tstatus = rpc_call_sync(mnt_clnt, &msg, RPC_TASK_SOFT|RPC_TASK_TIMEOUT);\n\trpc_shutdown_client(mnt_clnt);\n\n\tif (status < 0)\n\t\tgoto out_call_err;\n\tif (result.errno != 0)\n\t\tgoto out_mnt_err;\n\n\tdprintk(\"NFS: MNT request succeeded\\n\");\n\tstatus = 0;\n\n\t/*\n\t * If the server didn't provide a flavor list, allow the\n\t * client to try any flavor.\n\t */\n\tif (info->version != NFS_MNT3_VERSION || *info->auth_flav_len == 0) {\n\t\tdprintk(\"NFS: Faking up auth_flavs list\\n\");\n\t\tinfo->auth_flavs[0] = RPC_AUTH_NULL;\n\t\t*info->auth_flav_len = 1;\n\t}\nout:\n\treturn status;\n\nout_clnt_err:\n\tstatus = PTR_ERR(mnt_clnt);\n\tdprintk(\"NFS: failed to create MNT RPC client, status=%d\\n\", status);\n\tgoto out;\n\nout_call_err:\n\tdprintk(\"NFS: MNT request failed, status=%d\\n\", status);\n\tgoto out;\n\nout_mnt_err:\n\tdprintk(\"NFS: MNT server returned result %d\\n\", result.errno);\n\tstatus = result.errno;\n\tgoto out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_set_port",
          "args": [
            "request.sap",
            "&args->mount_server.port",
            "0"
          ],
          "line": 1755
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_set_port",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "978-985",
          "snippet": "static void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "request.sap",
            "&args->nfs_server.address",
            "args->nfs_server.addrlen"
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_request_mount(struct nfs_parsed_mount_data *args,\n\t\t\t     struct nfs_fh *root_fh,\n\t\t\t     rpc_authflavor_t *server_authlist,\n\t\t\t     unsigned int *server_authlist_len)\n{\n\tstruct nfs_mount_request request = {\n\t\t.sap\t\t= (struct sockaddr *)\n\t\t\t\t\t\t&args->mount_server.address,\n\t\t.dirpath\t= args->nfs_server.export_path,\n\t\t.protocol\t= args->mount_server.protocol,\n\t\t.fh\t\t= root_fh,\n\t\t.noresvport\t= args->flags & NFS_MOUNT_NORESVPORT,\n\t\t.auth_flav_len\t= server_authlist_len,\n\t\t.auth_flavs\t= server_authlist,\n\t\t.net\t\t= args->net,\n\t};\n\tint status;\n\n\tif (args->mount_server.version == 0) {\n\t\tswitch (args->version) {\n\t\t\tdefault:\n\t\t\t\targs->mount_server.version = NFS_MNT3_VERSION;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\targs->mount_server.version = NFS_MNT_VERSION;\n\t\t}\n\t}\n\trequest.version = args->mount_server.version;\n\n\tif (args->mount_server.hostname)\n\t\trequest.hostname = args->mount_server.hostname;\n\telse\n\t\trequest.hostname = args->nfs_server.hostname;\n\n\t/*\n\t * Construct the mount server's address.\n\t */\n\tif (args->mount_server.address.ss_family == AF_UNSPEC) {\n\t\tmemcpy(request.sap, &args->nfs_server.address,\n\t\t       args->nfs_server.addrlen);\n\t\targs->mount_server.addrlen = args->nfs_server.addrlen;\n\t}\n\trequest.salen = args->mount_server.addrlen;\n\tnfs_set_port(request.sap, &args->mount_server.port, 0);\n\n\t/*\n\t * Now ask the mount server to map our export path\n\t * to a file handle.\n\t */\n\tstatus = nfs_mount(&request);\n\tif (status != 0) {\n\t\tdfprintk(MOUNT, \"NFS: unable to mount server %s, error %d\\n\",\n\t\t\t\trequest.hostname, status);\n\t\treturn status;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_verify_authflavors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1676-1706",
    "snippet": "static int nfs_verify_authflavors(struct nfs_parsed_mount_data *args,\n\t\t\trpc_authflavor_t *server_authlist, unsigned int count)\n{\n\trpc_authflavor_t flavor = RPC_AUTH_MAXFLAVOR;\n\tunsigned int i;\n\n\t/*\n\t * If the sec= mount option is used, the specified flavor or AUTH_NULL\n\t * must be in the list returned by the server.\n\t *\n\t * AUTH_NULL has a special meaning when it's in the server list - it\n\t * means that the server will ignore the rpc creds, so any flavor\n\t * can be used.\n\t */\n\tfor (i = 0; i < count; i++) {\n\t\tflavor = server_authlist[i];\n\n\t\tif (nfs_auth_info_match(&args->auth_info, flavor) ||\n\t\t    flavor == RPC_AUTH_NULL)\n\t\t\tgoto out;\n\t}\n\n\tdfprintk(MOUNT,\n\t\t \"NFS: specified auth flavors not supported by server\\n\");\n\treturn -EACCES;\n\nout:\n\targs->selected_flavor = flavor;\n\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\", args->selected_flavor);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: using auth flavor %u\\n\"",
            "args->selected_flavor"
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: specified auth flavors not supported by server\\n\""
          ],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_auth_info_match",
          "args": [
            "&args->auth_info",
            "flavor"
          ],
          "line": 1693
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_auth_info_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1053-1066",
          "snippet": "bool nfs_auth_info_match(const struct nfs_auth_info *auth_info,\n\t\t\t rpc_authflavor_t match)\n{\n\tint i;\n\n\tif (!auth_info->flavor_len)\n\t\treturn true;\n\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (auth_info->flavors[i] == match)\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_auth_info_match(const struct nfs_auth_info *auth_info,\n\t\t\t rpc_authflavor_t match)\n{\n\tint i;\n\n\tif (!auth_info->flavor_len)\n\t\treturn true;\n\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (auth_info->flavors[i] == match)\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_authflavors(struct nfs_parsed_mount_data *args,\n\t\t\trpc_authflavor_t *server_authlist, unsigned int count)\n{\n\trpc_authflavor_t flavor = RPC_AUTH_MAXFLAVOR;\n\tunsigned int i;\n\n\t/*\n\t * If the sec= mount option is used, the specified flavor or AUTH_NULL\n\t * must be in the list returned by the server.\n\t *\n\t * AUTH_NULL has a special meaning when it's in the server list - it\n\t * means that the server will ignore the rpc creds, so any flavor\n\t * can be used.\n\t */\n\tfor (i = 0; i < count; i++) {\n\t\tflavor = server_authlist[i];\n\n\t\tif (nfs_auth_info_match(&args->auth_info, flavor) ||\n\t\t    flavor == RPC_AUTH_NULL)\n\t\t\tgoto out;\n\t}\n\n\tdfprintk(MOUNT,\n\t\t \"NFS: specified auth flavors not supported by server\\n\");\n\treturn -EACCES;\n\nout:\n\targs->selected_flavor = flavor;\n\tdfprintk(MOUNT, \"NFS: using auth flavor %u\\n\", args->selected_flavor);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_parse_mount_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1194-1669",
    "snippet": "static int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};",
      "static const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};",
      "static match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};",
      "static match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"NFS: security options invalid: %d\\n\"",
            "rc"
          ],
          "line": 1667
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_secdata",
          "args": [
            "secdata"
          ],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"NFS: not enough memory to parse option\\n\""
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\"",
            "p"
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\"",
            "p"
          ],
          "line": 1600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   relaxing parsing rules\\n\""
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\""
          ],
          "line": 1585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "string",
            "nfs_local_lock_tokens",
            "args"
          ],
          "line": 1566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_option_str",
          "args": [
            "args",
            "&mnt->fscache_uniq"
          ],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_option_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1167-1172",
          "snippet": "static int nfs_get_option_str(substring_t args[], char **option)\n{\n\tkfree(*option);\n\t*option = match_strdup(args);\n\treturn !*option;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_get_option_str(substring_t args[], char **option)\n{\n\tkfree(*option);\n\t*option = match_strdup(args);\n\treturn !*option;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\""
          ],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "string",
            "nfs_lookupcache_tokens",
            "args"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pton",
          "args": [
            "mnt->net",
            "string",
            "strlen(string)",
            "(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address",
            "sizeof(mnt->mount_server.address)"
          ],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_pton",
          "args": [
            "mnt->net",
            "string",
            "strlen(string)",
            "(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address",
            "sizeof(mnt->nfs_server.address)"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\""
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "string",
            "nfs_xprt_protocol_tokens",
            "args"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\""
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xprt_load_transport",
          "args": [
            "string"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "string",
            "nfs_xprt_protocol_tokens",
            "args"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\""
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_parse_security_flavors",
          "args": [
            "string",
            "mnt"
          ],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_parse_security_flavors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1072-1127",
          "snippet": "static int nfs_parse_security_flavors(char *value,\n\t\t\t\t      struct nfs_parsed_mount_data *mnt)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\trpc_authflavor_t pseudoflavor;\n\tchar *p;\n\n\tdfprintk(MOUNT, \"NFS: parsing sec=%s option\\n\", value);\n\n\twhile ((p = strsep(&value, \":\")) != NULL) {\n\t\tswitch (match_token(p, nfs_secflavor_tokens, args)) {\n\t\tcase Opt_sec_none:\n\t\t\tpseudoflavor = RPC_AUTH_NULL;\n\t\t\tbreak;\n\t\tcase Opt_sec_sys:\n\t\t\tpseudoflavor = RPC_AUTH_UNIX;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5i:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5I;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5p:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5P;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkey:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEY;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYI;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYP;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkm:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKM;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMI;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdfprintk(MOUNT,\n\t\t\t\t \"NFS: sec= option '%s' not recognized\\n\", p);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!nfs_auth_info_add(&mnt->auth_info, pseudoflavor))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const match_table_t nfs_secflavor_tokens = {\n\t{ Opt_sec_none, \"none\" },\n\t{ Opt_sec_none, \"null\" },\n\t{ Opt_sec_sys, \"sys\" },\n\n\t{ Opt_sec_krb5, \"krb5\" },\n\t{ Opt_sec_krb5i, \"krb5i\" },\n\t{ Opt_sec_krb5p, \"krb5p\" },\n\n\t{ Opt_sec_lkey, \"lkey\" },\n\t{ Opt_sec_lkeyi, \"lkeyi\" },\n\t{ Opt_sec_lkeyp, \"lkeyp\" },\n\n\t{ Opt_sec_spkm, \"spkm3\" },\n\t{ Opt_sec_spkmi, \"spkm3i\" },\n\t{ Opt_sec_spkmp, \"spkm3p\" },\n\n\t{ Opt_sec_err, NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const match_table_t nfs_secflavor_tokens = {\n\t{ Opt_sec_none, \"none\" },\n\t{ Opt_sec_none, \"null\" },\n\t{ Opt_sec_sys, \"sys\" },\n\n\t{ Opt_sec_krb5, \"krb5\" },\n\t{ Opt_sec_krb5i, \"krb5i\" },\n\t{ Opt_sec_krb5p, \"krb5p\" },\n\n\t{ Opt_sec_lkey, \"lkey\" },\n\t{ Opt_sec_lkeyi, \"lkeyi\" },\n\t{ Opt_sec_lkeyp, \"lkeyp\" },\n\n\t{ Opt_sec_spkm, \"spkm3\" },\n\t{ Opt_sec_spkmi, \"spkm3i\" },\n\t{ Opt_sec_spkmp, \"spkm3p\" },\n\n\t{ Opt_sec_err, NULL }\n};\n\nstatic int nfs_parse_security_flavors(char *value,\n\t\t\t\t      struct nfs_parsed_mount_data *mnt)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\trpc_authflavor_t pseudoflavor;\n\tchar *p;\n\n\tdfprintk(MOUNT, \"NFS: parsing sec=%s option\\n\", value);\n\n\twhile ((p = strsep(&value, \":\")) != NULL) {\n\t\tswitch (match_token(p, nfs_secflavor_tokens, args)) {\n\t\tcase Opt_sec_none:\n\t\t\tpseudoflavor = RPC_AUTH_NULL;\n\t\t\tbreak;\n\t\tcase Opt_sec_sys:\n\t\t\tpseudoflavor = RPC_AUTH_UNIX;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5i:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5I;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5p:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5P;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkey:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEY;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYI;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYP;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkm:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKM;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMI;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdfprintk(MOUNT,\n\t\t\t\t \"NFS: sec= option '%s' not recognized\\n\", p);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!nfs_auth_info_add(&mnt->auth_info, pseudoflavor))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_parse_version_string",
          "args": [
            "string",
            "mnt",
            "args"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_parse_version_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1129-1165",
          "snippet": "static int nfs_parse_version_string(char *string,\n\t\tstruct nfs_parsed_mount_data *mnt,\n\t\tsubstring_t *args)\n{\n\tmnt->flags &= ~NFS_MOUNT_VER3;\n\tswitch (match_token(string, nfs_vers_tokens, args)) {\n\tcase Opt_vers_2:\n\t\tmnt->version = 2;\n\t\tbreak;\n\tcase Opt_vers_3:\n\t\tmnt->flags |= NFS_MOUNT_VER3;\n\t\tmnt->version = 3;\n\t\tbreak;\n\tcase Opt_vers_4:\n\t\t/* Backward compatibility option. In future,\n\t\t * the mount program should always supply\n\t\t * a NFSv4 minor version number.\n\t\t */\n\t\tmnt->version = 4;\n\t\tbreak;\n\tcase Opt_vers_4_0:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 0;\n\t\tbreak;\n\tcase Opt_vers_4_1:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 1;\n\t\tbreak;\n\tcase Opt_vers_4_2:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static match_table_t nfs_vers_tokens = {\n\t{ Opt_vers_2, \"2\" },\n\t{ Opt_vers_3, \"3\" },\n\t{ Opt_vers_4, \"4\" },\n\t{ Opt_vers_4_0, \"4.0\" },\n\t{ Opt_vers_4_1, \"4.1\" },\n\t{ Opt_vers_4_2, \"4.2\" },\n\n\t{ Opt_vers_err, NULL }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic match_table_t nfs_vers_tokens = {\n\t{ Opt_vers_2, \"2\" },\n\t{ Opt_vers_3, \"3\" },\n\t{ Opt_vers_4, \"4\" },\n\t{ Opt_vers_4_0, \"4.0\" },\n\t{ Opt_vers_4_1, \"4.1\" },\n\t{ Opt_vers_4_2, \"4.2\" },\n\n\t{ Opt_vers_err, NULL }\n};\n\nstatic int nfs_parse_version_string(char *string,\n\t\tstruct nfs_parsed_mount_data *mnt,\n\t\tsubstring_t *args)\n{\n\tmnt->flags &= ~NFS_MOUNT_VER3;\n\tswitch (match_token(string, nfs_vers_tokens, args)) {\n\tcase Opt_vers_2:\n\t\tmnt->version = 2;\n\t\tbreak;\n\tcase Opt_vers_3:\n\t\tmnt->flags |= NFS_MOUNT_VER3;\n\t\tmnt->version = 3;\n\t\tbreak;\n\tcase Opt_vers_4:\n\t\t/* Backward compatibility option. In future,\n\t\t * the mount program should always supply\n\t\t * a NFSv4 minor version number.\n\t\t */\n\t\tmnt->version = 4;\n\t\tbreak;\n\tcase Opt_vers_4_0:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 0;\n\t\tbreak;\n\tcase Opt_vers_4_1:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 1;\n\t\tbreak;\n\tcase Opt_vers_4_2:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_get_option_ul",
          "args": [
            "args",
            "&option"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_get_option_ul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1174-1186",
          "snippet": "static int nfs_get_option_ul(substring_t args[], unsigned long *option)\n{\n\tint rc;\n\tchar *string;\n\n\tstring = match_strdup(args);\n\tif (string == NULL)\n\t\treturn -ENOMEM;\n\trc = kstrtoul(string, 10, option);\n\tkfree(string);\n\n\treturn rc;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_get_option_ul(substring_t args[], unsigned long *option)\n{\n\tint rc;\n\tchar *string;\n\n\tstring = match_strdup(args);\n\tif (string == NULL)\n\t\treturn -ENOMEM;\n\trc = kstrtoul(string, 10, option);\n\tkfree(string);\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mnt->fscache_uniq"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mnt->fscache_uniq"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xprt_load_transport",
          "args": [
            "p"
          ],
          "line": 1283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "p",
            "nfs_mount_option_tokens",
            "args"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS:   parsing nfs mount option '%s'\\n\"",
            "p"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&raw",
            "\",\""
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_secdata",
          "args": [
            "secdata"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_sb_parse_opts_str",
          "args": [
            "secdata",
            "&mnt->lsm_opts"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_sb_copy_data",
          "args": [
            "raw",
            "secdata"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_secdata",
          "args": [],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: nfs mount opts='%s'\\n\"",
            "raw"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: mount options string was NULL.\\n\""
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const match_table_t nfs_mount_option_tokens = {\n\t{ Opt_userspace, \"bg\" },\n\t{ Opt_userspace, \"fg\" },\n\t{ Opt_userspace, \"retry=%s\" },\n\n\t{ Opt_sloppy, \"sloppy\" },\n\n\t{ Opt_soft, \"soft\" },\n\t{ Opt_hard, \"hard\" },\n\t{ Opt_deprecated, \"intr\" },\n\t{ Opt_deprecated, \"nointr\" },\n\t{ Opt_posix, \"posix\" },\n\t{ Opt_noposix, \"noposix\" },\n\t{ Opt_cto, \"cto\" },\n\t{ Opt_nocto, \"nocto\" },\n\t{ Opt_ac, \"ac\" },\n\t{ Opt_noac, \"noac\" },\n\t{ Opt_lock, \"lock\" },\n\t{ Opt_nolock, \"nolock\" },\n\t{ Opt_udp, \"udp\" },\n\t{ Opt_tcp, \"tcp\" },\n\t{ Opt_rdma, \"rdma\" },\n\t{ Opt_acl, \"acl\" },\n\t{ Opt_noacl, \"noacl\" },\n\t{ Opt_rdirplus, \"rdirplus\" },\n\t{ Opt_nordirplus, \"nordirplus\" },\n\t{ Opt_sharecache, \"sharecache\" },\n\t{ Opt_nosharecache, \"nosharecache\" },\n\t{ Opt_resvport, \"resvport\" },\n\t{ Opt_noresvport, \"noresvport\" },\n\t{ Opt_fscache, \"fsc\" },\n\t{ Opt_nofscache, \"nofsc\" },\n\t{ Opt_migration, \"migration\" },\n\t{ Opt_nomigration, \"nomigration\" },\n\n\t{ Opt_port, \"port=%s\" },\n\t{ Opt_rsize, \"rsize=%s\" },\n\t{ Opt_wsize, \"wsize=%s\" },\n\t{ Opt_bsize, \"bsize=%s\" },\n\t{ Opt_timeo, \"timeo=%s\" },\n\t{ Opt_retrans, \"retrans=%s\" },\n\t{ Opt_acregmin, \"acregmin=%s\" },\n\t{ Opt_acregmax, \"acregmax=%s\" },\n\t{ Opt_acdirmin, \"acdirmin=%s\" },\n\t{ Opt_acdirmax, \"acdirmax=%s\" },\n\t{ Opt_actimeo, \"actimeo=%s\" },\n\t{ Opt_namelen, \"namlen=%s\" },\n\t{ Opt_mountport, \"mountport=%s\" },\n\t{ Opt_mountvers, \"mountvers=%s\" },\n\t{ Opt_minorversion, \"minorversion=%s\" },\n\n\t{ Opt_nfsvers, \"nfsvers=%s\" },\n\t{ Opt_nfsvers, \"vers=%s\" },\n\n\t{ Opt_sec, \"sec=%s\" },\n\t{ Opt_proto, \"proto=%s\" },\n\t{ Opt_mountproto, \"mountproto=%s\" },\n\t{ Opt_addr, \"addr=%s\" },\n\t{ Opt_clientaddr, \"clientaddr=%s\" },\n\t{ Opt_mounthost, \"mounthost=%s\" },\n\t{ Opt_mountaddr, \"mountaddr=%s\" },\n\n\t{ Opt_lookupcache, \"lookupcache=%s\" },\n\t{ Opt_fscache_uniq, \"fsc=%s\" },\n\t{ Opt_local_lock, \"local_lock=%s\" },\n\n\t/* The following needs to be listed after all other options */\n\t{ Opt_nfsvers, \"v%s\" },\n\n\t{ Opt_err, NULL }\n};\nstatic const match_table_t nfs_xprt_protocol_tokens = {\n\t{ Opt_xprt_udp, \"udp\" },\n\t{ Opt_xprt_udp6, \"udp6\" },\n\t{ Opt_xprt_tcp, \"tcp\" },\n\t{ Opt_xprt_tcp6, \"tcp6\" },\n\t{ Opt_xprt_rdma, \"rdma\" },\n\n\t{ Opt_xprt_err, NULL }\n};\nstatic match_table_t nfs_lookupcache_tokens = {\n\t{ Opt_lookupcache_all, \"all\" },\n\t{ Opt_lookupcache_positive, \"pos\" },\n\t{ Opt_lookupcache_positive, \"positive\" },\n\t{ Opt_lookupcache_none, \"none\" },\n\n\t{ Opt_lookupcache_err, NULL }\n};\nstatic match_table_t nfs_local_lock_tokens = {\n\t{ Opt_local_lock_all, \"all\" },\n\t{ Opt_local_lock_flock, \"flock\" },\n\t{ Opt_local_lock_posix, \"posix\" },\n\t{ Opt_local_lock_none, \"none\" },\n\n\t{ Opt_local_lock_err, NULL }\n};\n\nstatic int nfs_parse_mount_options(char *raw,\n\t\t\t\t   struct nfs_parsed_mount_data *mnt)\n{\n\tchar *p, *string, *secdata;\n\tint rc, sloppy = 0, invalid_option = 0;\n\tunsigned short protofamily = AF_UNSPEC;\n\tunsigned short mountfamily = AF_UNSPEC;\n\n\tif (!raw) {\n\t\tdfprintk(MOUNT, \"NFS: mount options string was NULL.\\n\");\n\t\treturn 1;\n\t}\n\tdfprintk(MOUNT, \"NFS: nfs mount opts='%s'\\n\", raw);\n\n\tsecdata = alloc_secdata();\n\tif (!secdata)\n\t\tgoto out_nomem;\n\n\trc = security_sb_copy_data(raw, secdata);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\trc = security_sb_parse_opts_str(secdata, &mnt->lsm_opts);\n\tif (rc)\n\t\tgoto out_security_failure;\n\n\tfree_secdata(secdata);\n\n\twhile ((p = strsep(&raw, \",\")) != NULL) {\n\t\tsubstring_t args[MAX_OPT_ARGS];\n\t\tunsigned long option;\n\t\tint token;\n\n\t\tif (!*p)\n\t\t\tcontinue;\n\n\t\tdfprintk(MOUNT, \"NFS:   parsing nfs mount option '%s'\\n\", p);\n\n\t\ttoken = match_token(p, nfs_mount_option_tokens, args);\n\t\tswitch (token) {\n\n\t\t/*\n\t\t * boolean options:  foo/nofoo\n\t\t */\n\t\tcase Opt_soft:\n\t\t\tmnt->flags |= NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_hard:\n\t\t\tmnt->flags &= ~NFS_MOUNT_SOFT;\n\t\t\tbreak;\n\t\tcase Opt_posix:\n\t\t\tmnt->flags |= NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_noposix:\n\t\t\tmnt->flags &= ~NFS_MOUNT_POSIX;\n\t\t\tbreak;\n\t\tcase Opt_cto:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_nocto:\n\t\t\tmnt->flags |= NFS_MOUNT_NOCTO;\n\t\t\tbreak;\n\t\tcase Opt_ac:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_noac:\n\t\t\tmnt->flags |= NFS_MOUNT_NOAC;\n\t\t\tbreak;\n\t\tcase Opt_lock:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NONLM;\n\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_nolock:\n\t\t\tmnt->flags |= NFS_MOUNT_NONLM;\n\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\tbreak;\n\t\tcase Opt_udp:\n\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\tbreak;\n\t\tcase Opt_tcp:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\tbreak;\n\t\tcase Opt_rdma:\n\t\t\tmnt->flags |= NFS_MOUNT_TCP; /* for side protocols */\n\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\txprt_load_transport(p);\n\t\t\tbreak;\n\t\tcase Opt_acl:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_noacl:\n\t\t\tmnt->flags |= NFS_MOUNT_NOACL;\n\t\t\tbreak;\n\t\tcase Opt_rdirplus:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_nordirplus:\n\t\t\tmnt->flags |= NFS_MOUNT_NORDIRPLUS;\n\t\t\tbreak;\n\t\tcase Opt_sharecache:\n\t\t\tmnt->flags &= ~NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_nosharecache:\n\t\t\tmnt->flags |= NFS_MOUNT_UNSHARED;\n\t\t\tbreak;\n\t\tcase Opt_resvport:\n\t\t\tmnt->flags &= ~NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_noresvport:\n\t\t\tmnt->flags |= NFS_MOUNT_NORESVPORT;\n\t\t\tbreak;\n\t\tcase Opt_fscache:\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_nofscache:\n\t\t\tmnt->options &= ~NFS_OPTION_FSCACHE;\n\t\t\tkfree(mnt->fscache_uniq);\n\t\t\tmnt->fscache_uniq = NULL;\n\t\t\tbreak;\n\t\tcase Opt_migration:\n\t\t\tmnt->options |= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\t\tcase Opt_nomigration:\n\t\t\tmnt->options &= NFS_OPTION_MIGRATION;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take numeric values\n\t\t */\n\t\tcase Opt_port:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->nfs_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_rsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->rsize = option;\n\t\t\tbreak;\n\t\tcase Opt_wsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->wsize = option;\n\t\t\tbreak;\n\t\tcase Opt_bsize:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->bsize = option;\n\t\t\tbreak;\n\t\tcase Opt_timeo:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->timeo = option;\n\t\t\tbreak;\n\t\tcase Opt_retrans:\n\t\t\tif (nfs_get_option_ul(args, &option) || option == 0)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->retrans = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acregmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmax = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmin:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmin = option;\n\t\t\tbreak;\n\t\tcase Opt_acdirmax:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_actimeo:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->acregmin = mnt->acregmax =\n\t\t\tmnt->acdirmin = mnt->acdirmax = option;\n\t\t\tbreak;\n\t\tcase Opt_namelen:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->namlen = option;\n\t\t\tbreak;\n\t\tcase Opt_mountport:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option > USHRT_MAX)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.port = option;\n\t\t\tbreak;\n\t\tcase Opt_mountvers:\n\t\t\tif (nfs_get_option_ul(args, &option) ||\n\t\t\t    option < NFS_MNT_VERSION ||\n\t\t\t    option > NFS_MNT3_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->mount_server.version = option;\n\t\t\tbreak;\n\t\tcase Opt_minorversion:\n\t\t\tif (nfs_get_option_ul(args, &option))\n\t\t\t\tgoto out_invalid_value;\n\t\t\tif (option > NFS4_MAX_MINOR_VERSION)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tmnt->minorversion = option;\n\t\t\tbreak;\n\n\t\t/*\n\t\t * options that take text values\n\t\t */\n\t\tcase Opt_nfsvers:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_version_string(string, mnt, args);\n\t\t\tkfree(string);\n\t\t\tif (!rc)\n\t\t\t\tgoto out_invalid_value;\n\t\t\tbreak;\n\t\tcase Opt_sec:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\trc = nfs_parse_security_flavors(string, mnt);\n\t\t\tkfree(string);\n\t\t\tif (!rc) {\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"security flavor\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_proto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\n\t\t\tprotofamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->flags &= ~NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tprotofamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma:\n\t\t\t\t/* vector side protocols to TCP */\n\t\t\t\tmnt->flags |= NFS_MOUNT_TCP;\n\t\t\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_RDMA;\n\t\t\t\txprt_load_transport(string);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\tkfree(string);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tkfree(string);\n\t\t\tbreak;\n\t\tcase Opt_mountproto:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\t    nfs_xprt_protocol_tokens, args);\n\t\t\tkfree(string);\n\n\t\t\tmountfamily = AF_INET;\n\t\t\tswitch (token) {\n\t\t\tcase Opt_xprt_udp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_udp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_tcp6:\n\t\t\t\tmountfamily = AF_INET6;\n\t\t\tcase Opt_xprt_tcp:\n\t\t\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t\t\t\tbreak;\n\t\t\tcase Opt_xprt_rdma: /* not used for side protocols */\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized \"\n\t\t\t\t\t\t\"transport protocol\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase Opt_addr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->nfs_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->nfs_server.address,\n\t\t\t\t\tsizeof(mnt->nfs_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->nfs_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_clientaddr:\n\t\t\tif (nfs_get_option_str(args, &mnt->client_address))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mounthost:\n\t\t\tif (nfs_get_option_str(args,\n\t\t\t\t\t       &mnt->mount_server.hostname))\n\t\t\t\tgoto out_nomem;\n\t\t\tbreak;\n\t\tcase Opt_mountaddr:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->mount_server.addrlen =\n\t\t\t\trpc_pton(mnt->net, string, strlen(string),\n\t\t\t\t\t(struct sockaddr *)\n\t\t\t\t\t&mnt->mount_server.address,\n\t\t\t\t\tsizeof(mnt->mount_server.address));\n\t\t\tkfree(string);\n\t\t\tif (mnt->mount_server.addrlen == 0)\n\t\t\t\tgoto out_invalid_address;\n\t\t\tbreak;\n\t\tcase Opt_lookupcache:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string,\n\t\t\t\t\tnfs_lookupcache_tokens, args);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\t\tcase Opt_lookupcache_all:\n\t\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_positive:\n\t\t\t\t\tmnt->flags &= ~NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG;\n\t\t\t\t\tbreak;\n\t\t\t\tcase Opt_lookupcache_none:\n\t\t\t\t\tmnt->flags |= NFS_MOUNT_LOOKUP_CACHE_NONEG|NFS_MOUNT_LOOKUP_CACHE_NONE;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdfprintk(MOUNT, \"NFS:   invalid \"\n\t\t\t\t\t\t\t\"lookupcache argument\\n\");\n\t\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\t\tcase Opt_fscache_uniq:\n\t\t\tif (nfs_get_option_str(args, &mnt->fscache_uniq))\n\t\t\t\tgoto out_nomem;\n\t\t\tmnt->options |= NFS_OPTION_FSCACHE;\n\t\t\tbreak;\n\t\tcase Opt_local_lock:\n\t\t\tstring = match_strdup(args);\n\t\t\tif (string == NULL)\n\t\t\t\tgoto out_nomem;\n\t\t\ttoken = match_token(string, nfs_local_lock_tokens,\n\t\t\t\t\targs);\n\t\t\tkfree(string);\n\t\t\tswitch (token) {\n\t\t\tcase Opt_local_lock_all:\n\t\t\t\tmnt->flags |= (NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t       NFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_flock:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FLOCK;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_posix:\n\t\t\t\tmnt->flags |= NFS_MOUNT_LOCAL_FCNTL;\n\t\t\t\tbreak;\n\t\t\tcase Opt_local_lock_none:\n\t\t\t\tmnt->flags &= ~(NFS_MOUNT_LOCAL_FLOCK |\n\t\t\t\t\t\tNFS_MOUNT_LOCAL_FCNTL);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tdfprintk(MOUNT, \"NFS:\tinvalid\t\"\n\t\t\t\t\t\t\"local_lock argument\\n\");\n\t\t\t\treturn 0;\n\t\t\t};\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Special options\n\t\t */\n\t\tcase Opt_sloppy:\n\t\t\tsloppy = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   relaxing parsing rules\\n\");\n\t\t\tbreak;\n\t\tcase Opt_userspace:\n\t\tcase Opt_deprecated:\n\t\t\tdfprintk(MOUNT, \"NFS:   ignoring mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tinvalid_option = 1;\n\t\t\tdfprintk(MOUNT, \"NFS:   unrecognized mount option \"\n\t\t\t\t\t\"'%s'\\n\", p);\n\t\t}\n\t}\n\n\tif (!sloppy && invalid_option)\n\t\treturn 0;\n\n\tif (mnt->minorversion && mnt->version != 4)\n\t\tgoto out_minorversion_mismatch;\n\n\tif (mnt->options & NFS_OPTION_MIGRATION &&\n\t    (mnt->version != 4 || mnt->minorversion != 0))\n\t\tgoto out_migration_misuse;\n\n\t/*\n\t * verify that any proto=/mountproto= options match the address\n\t * families in the addr=/mountaddr= options.\n\t */\n\tif (protofamily != AF_UNSPEC &&\n\t    protofamily != mnt->nfs_server.address.ss_family)\n\t\tgoto out_proto_mismatch;\n\n\tif (mountfamily != AF_UNSPEC) {\n\t\tif (mnt->mount_server.addrlen) {\n\t\t\tif (mountfamily != mnt->mount_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t} else {\n\t\t\tif (mountfamily != mnt->nfs_server.address.ss_family)\n\t\t\t\tgoto out_mountproto_mismatch;\n\t\t}\n\t}\n\n\treturn 1;\n\nout_mountproto_mismatch:\n\tprintk(KERN_INFO \"NFS: mount server address does not match mountproto= \"\n\t\t\t \"option\\n\");\n\treturn 0;\nout_proto_mismatch:\n\tprintk(KERN_INFO \"NFS: server address does not match proto= option\\n\");\n\treturn 0;\nout_invalid_address:\n\tprintk(KERN_INFO \"NFS: bad IP address specified: %s\\n\", p);\n\treturn 0;\nout_invalid_value:\n\tprintk(KERN_INFO \"NFS: bad mount option value specified: %s\\n\", p);\n\treturn 0;\nout_minorversion_mismatch:\n\tprintk(KERN_INFO \"NFS: mount option vers=%u does not support \"\n\t\t\t \"minorversion=%u\\n\", mnt->version, mnt->minorversion);\n\treturn 0;\nout_migration_misuse:\n\tprintk(KERN_INFO\n\t\t\"NFS: 'migration' not supported for this NFS version\\n\");\n\treturn 0;\nout_nomem:\n\tprintk(KERN_INFO \"NFS: not enough memory to parse option\\n\");\n\treturn 0;\nout_security_failure:\n\tfree_secdata(secdata);\n\tprintk(KERN_INFO \"NFS: security options invalid: %d\\n\", rc);\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_get_option_ul",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1174-1186",
    "snippet": "static int nfs_get_option_ul(substring_t args[], unsigned long *option)\n{\n\tint rc;\n\tchar *string;\n\n\tstring = match_strdup(args);\n\tif (string == NULL)\n\t\treturn -ENOMEM;\n\trc = kstrtoul(string, 10, option);\n\tkfree(string);\n\n\treturn rc;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "string"
          ],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtoul",
          "args": [
            "string",
            "10",
            "option"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_get_option_ul(substring_t args[], unsigned long *option)\n{\n\tint rc;\n\tchar *string;\n\n\tstring = match_strdup(args);\n\tif (string == NULL)\n\t\treturn -ENOMEM;\n\trc = kstrtoul(string, 10, option);\n\tkfree(string);\n\n\treturn rc;\n}"
  },
  {
    "function_name": "nfs_get_option_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1167-1172",
    "snippet": "static int nfs_get_option_str(substring_t args[], char **option)\n{\n\tkfree(*option);\n\t*option = match_strdup(args);\n\treturn !*option;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_strdup",
          "args": [
            "args"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "*option"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_get_option_str(substring_t args[], char **option)\n{\n\tkfree(*option);\n\t*option = match_strdup(args);\n\treturn !*option;\n}"
  },
  {
    "function_name": "nfs_parse_version_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1129-1165",
    "snippet": "static int nfs_parse_version_string(char *string,\n\t\tstruct nfs_parsed_mount_data *mnt,\n\t\tsubstring_t *args)\n{\n\tmnt->flags &= ~NFS_MOUNT_VER3;\n\tswitch (match_token(string, nfs_vers_tokens, args)) {\n\tcase Opt_vers_2:\n\t\tmnt->version = 2;\n\t\tbreak;\n\tcase Opt_vers_3:\n\t\tmnt->flags |= NFS_MOUNT_VER3;\n\t\tmnt->version = 3;\n\t\tbreak;\n\tcase Opt_vers_4:\n\t\t/* Backward compatibility option. In future,\n\t\t * the mount program should always supply\n\t\t * a NFSv4 minor version number.\n\t\t */\n\t\tmnt->version = 4;\n\t\tbreak;\n\tcase Opt_vers_4_0:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 0;\n\t\tbreak;\n\tcase Opt_vers_4_1:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 1;\n\t\tbreak;\n\tcase Opt_vers_4_2:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static match_table_t nfs_vers_tokens = {\n\t{ Opt_vers_2, \"2\" },\n\t{ Opt_vers_3, \"3\" },\n\t{ Opt_vers_4, \"4\" },\n\t{ Opt_vers_4_0, \"4.0\" },\n\t{ Opt_vers_4_1, \"4.1\" },\n\t{ Opt_vers_4_2, \"4.2\" },\n\n\t{ Opt_vers_err, NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "string",
            "nfs_vers_tokens",
            "args"
          ],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic match_table_t nfs_vers_tokens = {\n\t{ Opt_vers_2, \"2\" },\n\t{ Opt_vers_3, \"3\" },\n\t{ Opt_vers_4, \"4\" },\n\t{ Opt_vers_4_0, \"4.0\" },\n\t{ Opt_vers_4_1, \"4.1\" },\n\t{ Opt_vers_4_2, \"4.2\" },\n\n\t{ Opt_vers_err, NULL }\n};\n\nstatic int nfs_parse_version_string(char *string,\n\t\tstruct nfs_parsed_mount_data *mnt,\n\t\tsubstring_t *args)\n{\n\tmnt->flags &= ~NFS_MOUNT_VER3;\n\tswitch (match_token(string, nfs_vers_tokens, args)) {\n\tcase Opt_vers_2:\n\t\tmnt->version = 2;\n\t\tbreak;\n\tcase Opt_vers_3:\n\t\tmnt->flags |= NFS_MOUNT_VER3;\n\t\tmnt->version = 3;\n\t\tbreak;\n\tcase Opt_vers_4:\n\t\t/* Backward compatibility option. In future,\n\t\t * the mount program should always supply\n\t\t * a NFSv4 minor version number.\n\t\t */\n\t\tmnt->version = 4;\n\t\tbreak;\n\tcase Opt_vers_4_0:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 0;\n\t\tbreak;\n\tcase Opt_vers_4_1:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 1;\n\t\tbreak;\n\tcase Opt_vers_4_2:\n\t\tmnt->version = 4;\n\t\tmnt->minorversion = 2;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_parse_security_flavors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1072-1127",
    "snippet": "static int nfs_parse_security_flavors(char *value,\n\t\t\t\t      struct nfs_parsed_mount_data *mnt)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\trpc_authflavor_t pseudoflavor;\n\tchar *p;\n\n\tdfprintk(MOUNT, \"NFS: parsing sec=%s option\\n\", value);\n\n\twhile ((p = strsep(&value, \":\")) != NULL) {\n\t\tswitch (match_token(p, nfs_secflavor_tokens, args)) {\n\t\tcase Opt_sec_none:\n\t\t\tpseudoflavor = RPC_AUTH_NULL;\n\t\t\tbreak;\n\t\tcase Opt_sec_sys:\n\t\t\tpseudoflavor = RPC_AUTH_UNIX;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5i:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5I;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5p:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5P;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkey:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEY;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYI;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYP;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkm:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKM;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMI;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdfprintk(MOUNT,\n\t\t\t\t \"NFS: sec= option '%s' not recognized\\n\", p);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!nfs_auth_info_add(&mnt->auth_info, pseudoflavor))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t nfs_secflavor_tokens = {\n\t{ Opt_sec_none, \"none\" },\n\t{ Opt_sec_none, \"null\" },\n\t{ Opt_sec_sys, \"sys\" },\n\n\t{ Opt_sec_krb5, \"krb5\" },\n\t{ Opt_sec_krb5i, \"krb5i\" },\n\t{ Opt_sec_krb5p, \"krb5p\" },\n\n\t{ Opt_sec_lkey, \"lkey\" },\n\t{ Opt_sec_lkeyi, \"lkeyi\" },\n\t{ Opt_sec_lkeyp, \"lkeyp\" },\n\n\t{ Opt_sec_spkm, \"spkm3\" },\n\t{ Opt_sec_spkmi, \"spkm3i\" },\n\t{ Opt_sec_spkmp, \"spkm3p\" },\n\n\t{ Opt_sec_err, NULL }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_auth_info_add",
          "args": [
            "&mnt->auth_info",
            "pseudoflavor"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_auth_info_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "1028-1047",
          "snippet": "static bool nfs_auth_info_add(struct nfs_auth_info *auth_info,\n\t\t\t      rpc_authflavor_t flavor)\n{\n\tunsigned int i;\n\tunsigned int max_flavor_len = ARRAY_SIZE(auth_info->flavors);\n\n\t/* make sure this flavor isn't already in the list */\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (flavor == auth_info->flavors[i])\n\t\t\treturn true;\n\t}\n\n\tif (auth_info->flavor_len + 1 >= max_flavor_len) {\n\t\tdfprintk(MOUNT, \"NFS: too many sec= flavors\\n\");\n\t\treturn false;\n\t}\n\n\tauth_info->flavors[auth_info->flavor_len++] = flavor;\n\treturn true;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool nfs_auth_info_add(struct nfs_auth_info *auth_info,\n\t\t\t      rpc_authflavor_t flavor)\n{\n\tunsigned int i;\n\tunsigned int max_flavor_len = ARRAY_SIZE(auth_info->flavors);\n\n\t/* make sure this flavor isn't already in the list */\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (flavor == auth_info->flavors[i])\n\t\t\treturn true;\n\t}\n\n\tif (auth_info->flavor_len + 1 >= max_flavor_len) {\n\t\tdfprintk(MOUNT, \"NFS: too many sec= flavors\\n\");\n\t\treturn false;\n\t}\n\n\tauth_info->flavors[auth_info->flavor_len++] = flavor;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: sec= option '%s' not recognized\\n\"",
            "p"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "p",
            "nfs_secflavor_tokens",
            "args"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&value",
            "\":\""
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: parsing sec=%s option\\n\"",
            "value"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const match_table_t nfs_secflavor_tokens = {\n\t{ Opt_sec_none, \"none\" },\n\t{ Opt_sec_none, \"null\" },\n\t{ Opt_sec_sys, \"sys\" },\n\n\t{ Opt_sec_krb5, \"krb5\" },\n\t{ Opt_sec_krb5i, \"krb5i\" },\n\t{ Opt_sec_krb5p, \"krb5p\" },\n\n\t{ Opt_sec_lkey, \"lkey\" },\n\t{ Opt_sec_lkeyi, \"lkeyi\" },\n\t{ Opt_sec_lkeyp, \"lkeyp\" },\n\n\t{ Opt_sec_spkm, \"spkm3\" },\n\t{ Opt_sec_spkmi, \"spkm3i\" },\n\t{ Opt_sec_spkmp, \"spkm3p\" },\n\n\t{ Opt_sec_err, NULL }\n};\n\nstatic int nfs_parse_security_flavors(char *value,\n\t\t\t\t      struct nfs_parsed_mount_data *mnt)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\trpc_authflavor_t pseudoflavor;\n\tchar *p;\n\n\tdfprintk(MOUNT, \"NFS: parsing sec=%s option\\n\", value);\n\n\twhile ((p = strsep(&value, \":\")) != NULL) {\n\t\tswitch (match_token(p, nfs_secflavor_tokens, args)) {\n\t\tcase Opt_sec_none:\n\t\t\tpseudoflavor = RPC_AUTH_NULL;\n\t\t\tbreak;\n\t\tcase Opt_sec_sys:\n\t\t\tpseudoflavor = RPC_AUTH_UNIX;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5i:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5I;\n\t\t\tbreak;\n\t\tcase Opt_sec_krb5p:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_KRB5P;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkey:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEY;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYI;\n\t\t\tbreak;\n\t\tcase Opt_sec_lkeyp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_LKEYP;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkm:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKM;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmi:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMI;\n\t\t\tbreak;\n\t\tcase Opt_sec_spkmp:\n\t\t\tpseudoflavor = RPC_AUTH_GSS_SPKMP;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tdfprintk(MOUNT,\n\t\t\t\t \"NFS: sec= option '%s' not recognized\\n\", p);\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (!nfs_auth_info_add(&mnt->auth_info, pseudoflavor))\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_auth_info_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1053-1066",
    "snippet": "bool nfs_auth_info_match(const struct nfs_auth_info *auth_info,\n\t\t\t rpc_authflavor_t match)\n{\n\tint i;\n\n\tif (!auth_info->flavor_len)\n\t\treturn true;\n\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (auth_info->flavors[i] == match)\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_auth_info_match(const struct nfs_auth_info *auth_info,\n\t\t\t rpc_authflavor_t match)\n{\n\tint i;\n\n\tif (!auth_info->flavor_len)\n\t\treturn true;\n\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (auth_info->flavors[i] == match)\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "nfs_auth_info_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1028-1047",
    "snippet": "static bool nfs_auth_info_add(struct nfs_auth_info *auth_info,\n\t\t\t      rpc_authflavor_t flavor)\n{\n\tunsigned int i;\n\tunsigned int max_flavor_len = ARRAY_SIZE(auth_info->flavors);\n\n\t/* make sure this flavor isn't already in the list */\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (flavor == auth_info->flavors[i])\n\t\t\treturn true;\n\t}\n\n\tif (auth_info->flavor_len + 1 >= max_flavor_len) {\n\t\tdfprintk(MOUNT, \"NFS: too many sec= flavors\\n\");\n\t\treturn false;\n\t}\n\n\tauth_info->flavors[auth_info->flavor_len++] = flavor;\n\treturn true;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: too many sec= flavors\\n\""
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "auth_info->flavors"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic bool nfs_auth_info_add(struct nfs_auth_info *auth_info,\n\t\t\t      rpc_authflavor_t flavor)\n{\n\tunsigned int i;\n\tunsigned int max_flavor_len = ARRAY_SIZE(auth_info->flavors);\n\n\t/* make sure this flavor isn't already in the list */\n\tfor (i = 0; i < auth_info->flavor_len; i++) {\n\t\tif (flavor == auth_info->flavors[i])\n\t\t\treturn true;\n\t}\n\n\tif (auth_info->flavor_len + 1 >= max_flavor_len) {\n\t\tdfprintk(MOUNT, \"NFS: too many sec= flavors\\n\");\n\t\treturn false;\n\t}\n\n\tauth_info->flavors[auth_info->flavor_len++] = flavor;\n\treturn true;\n}"
  },
  {
    "function_name": "nfs_set_mount_transport_protocol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "1007-1022",
    "snippet": "static void nfs_set_mount_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tnfs_validate_transport_protocol(mnt);\n\n\tif (mnt->mount_server.protocol == XPRT_TRANSPORT_UDP ||\n\t    mnt->mount_server.protocol == XPRT_TRANSPORT_TCP)\n\t\t\treturn;\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_validate_transport_protocol",
          "args": [
            "mnt"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_validate_transport_protocol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "991-1001",
          "snippet": "static void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_set_mount_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tnfs_validate_transport_protocol(mnt);\n\n\tif (mnt->mount_server.protocol == XPRT_TRANSPORT_UDP ||\n\t    mnt->mount_server.protocol == XPRT_TRANSPORT_TCP)\n\t\t\treturn;\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_UDP;\n\t\tbreak;\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tmnt->mount_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
  },
  {
    "function_name": "nfs_validate_transport_protocol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "991-1001",
    "snippet": "static void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_validate_transport_protocol(struct nfs_parsed_mount_data *mnt)\n{\n\tswitch (mnt->nfs_server.protocol) {\n\tcase XPRT_TRANSPORT_UDP:\n\tcase XPRT_TRANSPORT_TCP:\n\tcase XPRT_TRANSPORT_RDMA:\n\t\tbreak;\n\tdefault:\n\t\tmnt->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t}\n}"
  },
  {
    "function_name": "nfs_set_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "978-985",
    "snippet": "static void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_set_port",
          "args": [
            "sap",
            "*port"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_set_port(struct sockaddr *sap, int *port,\n\t\t\t\t const unsigned short default_port)\n{\n\tif (*port == NFS_UNSPEC_PORT)\n\t\t*port = default_port;\n\n\trpc_set_port(sap, *port);\n}"
  },
  {
    "function_name": "nfs_verify_server_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "957-972",
    "snippet": "static int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dfprintk",
          "args": [
            "MOUNT",
            "\"NFS: Invalid IP address specified\\n\""
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ipv6_addr_any",
          "args": [
            "sa"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "INADDR_ANY"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_verify_server_address(struct sockaddr *addr)\n{\n\tswitch (addr->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sa = (struct sockaddr_in *)addr;\n\t\treturn sa->sin_addr.s_addr != htonl(INADDR_ANY);\n\t}\n\tcase AF_INET6: {\n\t\tstruct in6_addr *sa = &((struct sockaddr_in6 *)addr)->sin6_addr;\n\t\treturn !ipv6_addr_any(sa);\n\t}\n\t}\n\n\tdfprintk(MOUNT, \"NFS: Invalid IP address specified\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_free_parsed_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "938-949",
    "snippet": "static void nfs_free_parsed_mount_data(struct nfs_parsed_mount_data *data)\n{\n\tif (data) {\n\t\tkfree(data->client_address);\n\t\tkfree(data->mount_server.hostname);\n\t\tkfree(data->nfs_server.export_path);\n\t\tkfree(data->nfs_server.hostname);\n\t\tkfree(data->fscache_uniq);\n\t\tsecurity_free_mnt_opts(&data->lsm_opts);\n\t\tkfree(data);\n\t}\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_free_mnt_opts",
          "args": [
            "&data->lsm_opts"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data->fscache_uniq"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data->nfs_server.hostname"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data->nfs_server.export_path"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data->mount_server.hostname"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data->client_address"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_free_parsed_mount_data(struct nfs_parsed_mount_data *data)\n{\n\tif (data) {\n\t\tkfree(data->client_address);\n\t\tkfree(data->mount_server.hostname);\n\t\tkfree(data->nfs_server.export_path);\n\t\tkfree(data->nfs_server.hostname);\n\t\tkfree(data->fscache_uniq);\n\t\tsecurity_free_mnt_opts(&data->lsm_opts);\n\t\tkfree(data);\n\t}\n}"
  },
  {
    "function_name": "nfs_alloc_parsed_mount_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "916-936",
    "snippet": "static struct nfs_parsed_mount_data *nfs_alloc_parsed_mount_data(void)\n{\n\tstruct nfs_parsed_mount_data *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data) {\n\t\tdata->acregmin\t\t= NFS_DEF_ACREGMIN;\n\t\tdata->acregmax\t\t= NFS_DEF_ACREGMAX;\n\t\tdata->acdirmin\t\t= NFS_DEF_ACDIRMIN;\n\t\tdata->acdirmax\t\t= NFS_DEF_ACDIRMAX;\n\t\tdata->mount_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\tdata->selected_flavor\t= RPC_AUTH_MAXFLAVOR;\n\t\tdata->minorversion\t= 0;\n\t\tdata->need_mount\t= true;\n\t\tdata->net\t\t= current->nsproxy->net_ns;\n\t\tsecurity_init_mnt_opts(&data->lsm_opts);\n\t}\n\treturn data;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_init_mnt_opts",
          "args": [
            "&data->lsm_opts"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct nfs_parsed_mount_data *nfs_alloc_parsed_mount_data(void)\n{\n\tstruct nfs_parsed_mount_data *data;\n\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (data) {\n\t\tdata->acregmin\t\t= NFS_DEF_ACREGMIN;\n\t\tdata->acregmax\t\t= NFS_DEF_ACREGMAX;\n\t\tdata->acdirmin\t\t= NFS_DEF_ACDIRMIN;\n\t\tdata->acdirmax\t\t= NFS_DEF_ACDIRMAX;\n\t\tdata->mount_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.port\t= NFS_UNSPEC_PORT;\n\t\tdata->nfs_server.protocol = XPRT_TRANSPORT_TCP;\n\t\tdata->selected_flavor\t= RPC_AUTH_MAXFLAVOR;\n\t\tdata->minorversion\t= 0;\n\t\tdata->need_mount\t= true;\n\t\tdata->net\t\t= current->nsproxy->net_ns;\n\t\tsecurity_init_mnt_opts(&data->lsm_opts);\n\t}\n\treturn data;\n}"
  },
  {
    "function_name": "nfs_umount_begin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "900-913",
    "snippet": "void nfs_umount_begin(struct super_block *sb)\n{\n\tstruct nfs_server *server;\n\tstruct rpc_clnt *rpc;\n\n\tserver = NFS_SB(sb);\n\t/* -EIO all pending I/O */\n\trpc = server->client_acl;\n\tif (!IS_ERR(rpc))\n\t\trpc_killall_tasks(rpc);\n\trpc = server->client;\n\tif (!IS_ERR(rpc))\n\t\trpc_killall_tasks(rpc);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_killall_tasks",
          "args": [
            "rpc"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "rpc"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_killall_tasks",
          "args": [
            "rpc"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "rpc"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_umount_begin(struct super_block *sb)\n{\n\tstruct nfs_server *server;\n\tstruct rpc_clnt *rpc;\n\n\tserver = NFS_SB(sb);\n\t/* -EIO all pending I/O */\n\trpc = server->client_acl;\n\tif (!IS_ERR(rpc))\n\t\trpc_killall_tasks(rpc);\n\trpc = server->client;\n\tif (!IS_ERR(rpc))\n\t\trpc_killall_tasks(rpc);\n}"
  },
  {
    "function_name": "nfs_show_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "805-893",
    "snippet": "int nfs_show_stats(struct seq_file *m, struct dentry *root)\n{\n\tint i, cpu;\n\tstruct nfs_server *nfss = NFS_SB(root->d_sb);\n\tstruct rpc_auth *auth = nfss->client->cl_auth;\n\tstruct nfs_iostats totals = { };\n\n\tseq_printf(m, \"statvers=%s\", NFS_IOSTAT_VERS);\n\n\t/*\n\t * Display all mount option settings\n\t */\n\tseq_printf(m, \"\\n\\topts:\\t\");\n\tseq_puts(m, root->d_sb->s_flags & MS_RDONLY ? \"ro\" : \"rw\");\n\tseq_puts(m, root->d_sb->s_flags & MS_SYNCHRONOUS ? \",sync\" : \"\");\n\tseq_puts(m, root->d_sb->s_flags & MS_NOATIME ? \",noatime\" : \"\");\n\tseq_puts(m, root->d_sb->s_flags & MS_NODIRATIME ? \",nodiratime\" : \"\");\n\tnfs_show_mount_options(m, nfss, 1);\n\n\tseq_printf(m, \"\\n\\tage:\\t%lu\", (jiffies - nfss->mount_time) / HZ);\n\n\tshow_implementation_id(m, nfss);\n\n\tseq_printf(m, \"\\n\\tcaps:\\t\");\n\tseq_printf(m, \"caps=0x%x\", nfss->caps);\n\tseq_printf(m, \",wtmult=%u\", nfss->wtmult);\n\tseq_printf(m, \",dtsize=%u\", nfss->dtsize);\n\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tif (nfss->nfs_client->rpc_ops->version == 4) {\n\t\tseq_printf(m, \"\\n\\tnfsv4:\\t\");\n\t\tseq_printf(m, \"bm0=0x%x\", nfss->attr_bitmask[0]);\n\t\tseq_printf(m, \",bm1=0x%x\", nfss->attr_bitmask[1]);\n\t\tseq_printf(m, \",bm2=0x%x\", nfss->attr_bitmask[2]);\n\t\tseq_printf(m, \",acl=0x%x\", nfss->acl_bitmask);\n\t\tshow_sessions(m, nfss);\n\t\tshow_pnfs(m, nfss);\n\t}\n#endif\n\n\t/*\n\t * Display security flavor in effect for this mount\n\t */\n\tseq_printf(m, \"\\n\\tsec:\\tflavor=%u\", auth->au_ops->au_flavor);\n\tif (auth->au_flavor)\n\t\tseq_printf(m, \",pseudoflavor=%u\", auth->au_flavor);\n\n\t/*\n\t * Display superblock I/O counters\n\t */\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct nfs_iostats *stats;\n\n\t\tpreempt_disable();\n\t\tstats = per_cpu_ptr(nfss->io_stats, cpu);\n\n\t\tfor (i = 0; i < __NFSIOS_COUNTSMAX; i++)\n\t\t\ttotals.events[i] += stats->events[i];\n\t\tfor (i = 0; i < __NFSIOS_BYTESMAX; i++)\n\t\t\ttotals.bytes[i] += stats->bytes[i];\n#ifdef CONFIG_NFS_FSCACHE\n\t\tfor (i = 0; i < __NFSIOS_FSCACHEMAX; i++)\n\t\t\ttotals.fscache[i] += stats->fscache[i];\n#endif\n\n\t\tpreempt_enable();\n\t}\n\n\tseq_printf(m, \"\\n\\tevents:\\t\");\n\tfor (i = 0; i < __NFSIOS_COUNTSMAX; i++)\n\t\tseq_printf(m, \"%lu \", totals.events[i]);\n\tseq_printf(m, \"\\n\\tbytes:\\t\");\n\tfor (i = 0; i < __NFSIOS_BYTESMAX; i++)\n\t\tseq_printf(m, \"%Lu \", totals.bytes[i]);\n#ifdef CONFIG_NFS_FSCACHE\n\tif (nfss->options & NFS_OPTION_FSCACHE) {\n\t\tseq_printf(m, \"\\n\\tfsc:\\t\");\n\t\tfor (i = 0; i < __NFSIOS_FSCACHEMAX; i++)\n\t\t\tseq_printf(m, \"%Lu \", totals.bytes[i]);\n\t}\n#endif\n\tseq_printf(m, \"\\n\");\n\n\trpc_print_iostats(m, nfss->client);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_print_iostats",
          "args": [
            "m",
            "nfss->client"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "nfss->io_stats",
            "cpu"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "show_pnfs",
          "args": [
            "m",
            "nfss"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "show_pnfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "769-771",
          "snippet": "static void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "show_sessions",
          "args": [
            "m",
            "nfss"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "show_sessions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "743-743",
          "snippet": "static void show_sessions(struct seq_file *m, struct nfs_server *server) {}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_sessions(struct seq_file *m, struct nfs_server *server) {}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NFS_V4"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "show_implementation_id",
          "args": [
            "m",
            "nfss"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "show_implementation_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "773-775",
          "snippet": "static void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_show_mount_options",
          "args": [
            "m",
            "nfss",
            "1"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_mount_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "626-714",
          "snippet": "static void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "root->d_sb->s_flags & MS_NODIRATIME ? \",nodiratime\" : \"\""
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "root->d_sb"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_show_stats(struct seq_file *m, struct dentry *root)\n{\n\tint i, cpu;\n\tstruct nfs_server *nfss = NFS_SB(root->d_sb);\n\tstruct rpc_auth *auth = nfss->client->cl_auth;\n\tstruct nfs_iostats totals = { };\n\n\tseq_printf(m, \"statvers=%s\", NFS_IOSTAT_VERS);\n\n\t/*\n\t * Display all mount option settings\n\t */\n\tseq_printf(m, \"\\n\\topts:\\t\");\n\tseq_puts(m, root->d_sb->s_flags & MS_RDONLY ? \"ro\" : \"rw\");\n\tseq_puts(m, root->d_sb->s_flags & MS_SYNCHRONOUS ? \",sync\" : \"\");\n\tseq_puts(m, root->d_sb->s_flags & MS_NOATIME ? \",noatime\" : \"\");\n\tseq_puts(m, root->d_sb->s_flags & MS_NODIRATIME ? \",nodiratime\" : \"\");\n\tnfs_show_mount_options(m, nfss, 1);\n\n\tseq_printf(m, \"\\n\\tage:\\t%lu\", (jiffies - nfss->mount_time) / HZ);\n\n\tshow_implementation_id(m, nfss);\n\n\tseq_printf(m, \"\\n\\tcaps:\\t\");\n\tseq_printf(m, \"caps=0x%x\", nfss->caps);\n\tseq_printf(m, \",wtmult=%u\", nfss->wtmult);\n\tseq_printf(m, \",dtsize=%u\", nfss->dtsize);\n\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\n#if IS_ENABLED(CONFIG_NFS_V4)\n\tif (nfss->nfs_client->rpc_ops->version == 4) {\n\t\tseq_printf(m, \"\\n\\tnfsv4:\\t\");\n\t\tseq_printf(m, \"bm0=0x%x\", nfss->attr_bitmask[0]);\n\t\tseq_printf(m, \",bm1=0x%x\", nfss->attr_bitmask[1]);\n\t\tseq_printf(m, \",bm2=0x%x\", nfss->attr_bitmask[2]);\n\t\tseq_printf(m, \",acl=0x%x\", nfss->acl_bitmask);\n\t\tshow_sessions(m, nfss);\n\t\tshow_pnfs(m, nfss);\n\t}\n#endif\n\n\t/*\n\t * Display security flavor in effect for this mount\n\t */\n\tseq_printf(m, \"\\n\\tsec:\\tflavor=%u\", auth->au_ops->au_flavor);\n\tif (auth->au_flavor)\n\t\tseq_printf(m, \",pseudoflavor=%u\", auth->au_flavor);\n\n\t/*\n\t * Display superblock I/O counters\n\t */\n\tfor_each_possible_cpu(cpu) {\n\t\tstruct nfs_iostats *stats;\n\n\t\tpreempt_disable();\n\t\tstats = per_cpu_ptr(nfss->io_stats, cpu);\n\n\t\tfor (i = 0; i < __NFSIOS_COUNTSMAX; i++)\n\t\t\ttotals.events[i] += stats->events[i];\n\t\tfor (i = 0; i < __NFSIOS_BYTESMAX; i++)\n\t\t\ttotals.bytes[i] += stats->bytes[i];\n#ifdef CONFIG_NFS_FSCACHE\n\t\tfor (i = 0; i < __NFSIOS_FSCACHEMAX; i++)\n\t\t\ttotals.fscache[i] += stats->fscache[i];\n#endif\n\n\t\tpreempt_enable();\n\t}\n\n\tseq_printf(m, \"\\n\\tevents:\\t\");\n\tfor (i = 0; i < __NFSIOS_COUNTSMAX; i++)\n\t\tseq_printf(m, \"%lu \", totals.events[i]);\n\tseq_printf(m, \"\\n\\tbytes:\\t\");\n\tfor (i = 0; i < __NFSIOS_BYTESMAX; i++)\n\t\tseq_printf(m, \"%Lu \", totals.bytes[i]);\n#ifdef CONFIG_NFS_FSCACHE\n\tif (nfss->options & NFS_OPTION_FSCACHE) {\n\t\tseq_printf(m, \"\\n\\tfsc:\\t\");\n\t\tfor (i = 0; i < __NFSIOS_FSCACHEMAX; i++)\n\t\t\tseq_printf(m, \"%Lu \", totals.bytes[i]);\n\t}\n#endif\n\tseq_printf(m, \"\\n\");\n\n\trpc_print_iostats(m, nfss->client);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_show_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "795-799",
    "snippet": "int nfs_show_path(struct seq_file *m, struct dentry *dentry)\n{\n\tseq_puts(m, \"/\");\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"/\""
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_show_path(struct seq_file *m, struct dentry *dentry)\n{\n\tseq_puts(m, \"/\");\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_show_devname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "778-792",
    "snippet": "int nfs_show_devname(struct seq_file *m, struct dentry *root)\n{\n\tchar *page = (char *) __get_free_page(GFP_KERNEL);\n\tchar *devname, *dummy;\n\tint err = 0;\n\tif (!page)\n\t\treturn -ENOMEM;\n\tdevname = nfs_path(&dummy, root, page, PAGE_SIZE, 0);\n\tif (IS_ERR(devname))\n\t\terr = PTR_ERR(devname);\n\telse\n\t\tseq_escape(m, devname, \" \\t\\n\\\\\");\n\tfree_page((unsigned long)page);\n\treturn err;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_page",
          "args": [
            "(unsigned long)page"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "_xfs_buf_free_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_buf.c",
          "lines": "238-246",
          "snippet": "STATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/migrate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hash.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/percpu.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/bio.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/errno.h>",
            "#include <linux/stddef.h>",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/migrate.h>\n#include <linux/kthread.h>\n#include <linux/hash.h>\n#include <linux/blkdev.h>\n#include <linux/percpu.h>\n#include <linux/workqueue.h>\n#include <linux/proc_fs.h>\n#include <linux/sysctl.h>\n#include <linux/bio.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/errno.h>\n#include <linux/stddef.h>\n#include \"xfs.h\"\n\nSTATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_escape",
          "args": [
            "m",
            "devname",
            "\" \\t\\n\\\\\""
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "seq_escape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "374-397",
          "snippet": "int seq_escape(struct seq_file *m, const char *s, const char *esc)\n{\n\tchar *end = m->buf + m->size;\n        char *p;\n\tchar c;\n\n        for (p = m->buf + m->count; (c = *s) != '\\0' && p < end; s++) {\n\t\tif (!strchr(esc, c)) {\n\t\t\t*p++ = c;\n\t\t\tcontinue;\n\t\t}\n\t\tif (p + 3 < end) {\n\t\t\t*p++ = '\\\\';\n\t\t\t*p++ = '0' + ((c & 0300) >> 6);\n\t\t\t*p++ = '0' + ((c & 070) >> 3);\n\t\t\t*p++ = '0' + (c & 07);\n\t\t\tcontinue;\n\t\t}\n\t\tseq_set_overflow(m);\n\t\treturn -1;\n        }\n\tm->count = p - m->buf;\n        return 0;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_escape(struct seq_file *m, const char *s, const char *esc)\n{\n\tchar *end = m->buf + m->size;\n        char *p;\n\tchar c;\n\n        for (p = m->buf + m->count; (c = *s) != '\\0' && p < end; s++) {\n\t\tif (!strchr(esc, c)) {\n\t\t\t*p++ = c;\n\t\t\tcontinue;\n\t\t}\n\t\tif (p + 3 < end) {\n\t\t\t*p++ = '\\\\';\n\t\t\t*p++ = '0' + ((c & 0300) >> 6);\n\t\t\t*p++ = '0' + ((c & 070) >> 3);\n\t\t\t*p++ = '0' + (c & 07);\n\t\t\tcontinue;\n\t\t}\n\t\tseq_set_overflow(m);\n\t\treturn -1;\n        }\n\tm->count = p - m->buf;\n        return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "devname"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "devname"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_path",
          "args": [
            "&dummy",
            "root",
            "page",
            "PAGE_SIZE",
            "0"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/namespace.c",
          "lines": "50-124",
          "snippet": "char *nfs_path(char **p, struct dentry *dentry, char *buffer, ssize_t buflen,\n\t       unsigned flags)\n{\n\tchar *end;\n\tint namelen;\n\tunsigned seq;\n\tconst char *base;\n\nrename_retry:\n\tend = buffer+buflen;\n\t*--end = '\\0';\n\tbuflen--;\n\n\tseq = read_seqbegin(&rename_lock);\n\trcu_read_lock();\n\twhile (1) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (IS_ROOT(dentry))\n\t\t\tbreak;\n\t\tnamelen = dentry->d_name.len;\n\t\tbuflen -= namelen + 1;\n\t\tif (buflen < 0)\n\t\t\tgoto Elong_unlock;\n\t\tend -= namelen;\n\t\tmemcpy(end, dentry->d_name.name, namelen);\n\t\t*--end = '/';\n\t\tspin_unlock(&dentry->d_lock);\n\t\tdentry = dentry->d_parent;\n\t}\n\tif (read_seqretry(&rename_lock, seq)) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto rename_retry;\n\t}\n\tif ((flags & NFS_PATH_CANONICAL) && *end != '/') {\n\t\tif (--buflen < 0) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\trcu_read_unlock();\n\t\t\tgoto Elong;\n\t\t}\n\t\t*--end = '/';\n\t}\n\t*p = end;\n\tbase = dentry->d_fsdata;\n\tif (!base) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tWARN_ON(1);\n\t\treturn end;\n\t}\n\tnamelen = strlen(base);\n\tif (flags & NFS_PATH_CANONICAL) {\n\t\t/* Strip off excess slashes in base string */\n\t\twhile (namelen > 0 && base[namelen - 1] == '/')\n\t\t\tnamelen--;\n\t}\n\tbuflen -= namelen;\n\tif (buflen < 0) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto Elong;\n\t}\n\tend -= namelen;\n\tmemcpy(end, base, namelen);\n\tspin_unlock(&dentry->d_lock);\n\trcu_read_unlock();\n\treturn end;\nElong_unlock:\n\tspin_unlock(&dentry->d_lock);\n\trcu_read_unlock();\n\tif (read_seqretry(&rename_lock, seq))\n\t\tgoto rename_retry;\nElong:\n\treturn ERR_PTR(-ENAMETOOLONG);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/sunrpc/gss_api.h>",
            "#include <linux/vfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/string.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/gfp.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/sunrpc/gss_api.h>\n#include <linux/vfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/string.h>\n#include <linux/nfs_fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/gfp.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n\nchar *nfs_path(char **p, struct dentry *dentry, char *buffer, ssize_t buflen,\n\t       unsigned flags)\n{\n\tchar *end;\n\tint namelen;\n\tunsigned seq;\n\tconst char *base;\n\nrename_retry:\n\tend = buffer+buflen;\n\t*--end = '\\0';\n\tbuflen--;\n\n\tseq = read_seqbegin(&rename_lock);\n\trcu_read_lock();\n\twhile (1) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (IS_ROOT(dentry))\n\t\t\tbreak;\n\t\tnamelen = dentry->d_name.len;\n\t\tbuflen -= namelen + 1;\n\t\tif (buflen < 0)\n\t\t\tgoto Elong_unlock;\n\t\tend -= namelen;\n\t\tmemcpy(end, dentry->d_name.name, namelen);\n\t\t*--end = '/';\n\t\tspin_unlock(&dentry->d_lock);\n\t\tdentry = dentry->d_parent;\n\t}\n\tif (read_seqretry(&rename_lock, seq)) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto rename_retry;\n\t}\n\tif ((flags & NFS_PATH_CANONICAL) && *end != '/') {\n\t\tif (--buflen < 0) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\trcu_read_unlock();\n\t\t\tgoto Elong;\n\t\t}\n\t\t*--end = '/';\n\t}\n\t*p = end;\n\tbase = dentry->d_fsdata;\n\tif (!base) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tWARN_ON(1);\n\t\treturn end;\n\t}\n\tnamelen = strlen(base);\n\tif (flags & NFS_PATH_CANONICAL) {\n\t\t/* Strip off excess slashes in base string */\n\t\twhile (namelen > 0 && base[namelen - 1] == '/')\n\t\t\tnamelen--;\n\t}\n\tbuflen -= namelen;\n\tif (buflen < 0) {\n\t\tspin_unlock(&dentry->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto Elong;\n\t}\n\tend -= namelen;\n\tmemcpy(end, base, namelen);\n\tspin_unlock(&dentry->d_lock);\n\trcu_read_unlock();\n\treturn end;\nElong_unlock:\n\tspin_unlock(&dentry->d_lock);\n\trcu_read_unlock();\n\tif (read_seqretry(&rename_lock, seq))\n\t\tgoto rename_retry;\nElong:\n\treturn ERR_PTR(-ENAMETOOLONG);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__get_free_page",
          "args": [
            "GFP_KERNEL"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_show_devname(struct seq_file *m, struct dentry *root)\n{\n\tchar *page = (char *) __get_free_page(GFP_KERNEL);\n\tchar *devname, *dummy;\n\tint err = 0;\n\tif (!page)\n\t\treturn -ENOMEM;\n\tdevname = nfs_path(&dummy, root, page, PAGE_SIZE, 0);\n\tif (IS_ERR(devname))\n\t\terr = PTR_ERR(devname);\n\telse\n\t\tseq_escape(m, devname, \" \\t\\n\\\\\");\n\tfree_page((unsigned long)page);\n\treturn err;\n}"
  },
  {
    "function_name": "show_implementation_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "773-775",
    "snippet": "static void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n}"
  },
  {
    "function_name": "show_pnfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "769-771",
    "snippet": "static void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n}"
  },
  {
    "function_name": "show_implementation_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "757-766",
    "snippet": "static void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n\tif (nfss->nfs_client && nfss->nfs_client->cl_implid) {\n\t\tstruct nfs41_impl_id *impl_id = nfss->nfs_client->cl_implid;\n\t\tseq_printf(m, \"\\n\\timpl_id:\\tname='%s',domain='%s',\"\n\t\t\t   \"date='%llu,%u'\",\n\t\t\t   impl_id->name, impl_id->domain,\n\t\t\t   impl_id->date.seconds, impl_id->date.nseconds);\n\t}\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\\timpl_id:\\tname='%s',domain='%s',\"\n\t\t\t   \"date='%llu,%u'\"",
            "impl_id->name",
            "impl_id->domain",
            "impl_id->date.seconds",
            "impl_id->date.nseconds"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_implementation_id(struct seq_file *m, struct nfs_server *nfss)\n{\n\tif (nfss->nfs_client && nfss->nfs_client->cl_implid) {\n\t\tstruct nfs41_impl_id *impl_id = nfss->nfs_client->cl_implid;\n\t\tseq_printf(m, \"\\n\\timpl_id:\\tname='%s',domain='%s',\"\n\t\t\t   \"date='%llu,%u'\",\n\t\t\t   impl_id->name, impl_id->domain,\n\t\t\t   impl_id->date.seconds, impl_id->date.nseconds);\n\t}\n}"
  },
  {
    "function_name": "show_pnfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "748-755",
    "snippet": "static void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n\tseq_printf(m, \",pnfs=\");\n\tif (server->pnfs_curr_ld)\n\t\tseq_printf(m, \"%s\", server->pnfs_curr_ld->name);\n\telse\n\t\tseq_printf(m, \"not configured\");\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"not configured\""
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_pnfs(struct seq_file *m, struct nfs_server *server)\n{\n\tseq_printf(m, \",pnfs=\");\n\tif (server->pnfs_curr_ld)\n\t\tseq_printf(m, \"%s\", server->pnfs_curr_ld->name);\n\telse\n\t\tseq_printf(m, \"not configured\");\n}"
  },
  {
    "function_name": "show_sessions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "743-743",
    "snippet": "static void show_sessions(struct seq_file *m, struct nfs_server *server) {}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_sessions(struct seq_file *m, struct nfs_server *server) {}"
  },
  {
    "function_name": "show_sessions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "737-741",
    "snippet": "static void show_sessions(struct seq_file *m, struct nfs_server *server)\n{\n\tif (nfs4_has_session(server->nfs_client))\n\t\tseq_printf(m, \",sessions\");\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",sessions\""
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs4_has_session",
          "args": [
            "server->nfs_client"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_has_session",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4session.h",
          "lines": "148-151",
          "snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int nfs4_has_session(const struct nfs_client *clp)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void show_sessions(struct seq_file *m, struct nfs_server *server)\n{\n\tif (nfs4_has_session(server->nfs_client))\n\t\tseq_printf(m, \",sessions\");\n}"
  },
  {
    "function_name": "nfs_show_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "719-732",
    "snippet": "int nfs_show_options(struct seq_file *m, struct dentry *root)\n{\n\tstruct nfs_server *nfss = NFS_SB(root->d_sb);\n\n\tnfs_show_mount_options(m, nfss, 0);\n\n\trcu_read_lock();\n\tseq_printf(m, \",addr=%s\",\n\t\t\trpc_peeraddr2str(nfss->nfs_client->cl_rpcclient,\n\t\t\t\t\t\t\tRPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",addr=%s\"",
            "rpc_peeraddr2str(nfss->nfs_client->cl_rpcclient,\n\t\t\t\t\t\t\tRPC_DISPLAY_ADDR)"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "nfss->nfs_client->cl_rpcclient",
            "RPC_DISPLAY_ADDR"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_show_mount_options",
          "args": [
            "m",
            "nfss",
            "0"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_mount_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "626-714",
          "snippet": "static void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "root->d_sb"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_show_options(struct seq_file *m, struct dentry *root)\n{\n\tstruct nfs_server *nfss = NFS_SB(root->d_sb);\n\n\tnfs_show_mount_options(m, nfss, 0);\n\n\trcu_read_lock();\n\tseq_printf(m, \",addr=%s\",\n\t\t\trpc_peeraddr2str(nfss->nfs_client->cl_rpcclient,\n\t\t\t\t\t\t\tRPC_DISPLAY_ADDR));\n\trcu_read_unlock();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_show_mount_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "626-714",
    "snippet": "static void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",local_lock=posix\""
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_show_nfsv4_options",
          "args": [
            "m",
            "nfss",
            "showdefaults"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_nfsv4_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "608-611",
          "snippet": "static void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_show_mountd_options",
          "args": [
            "m",
            "nfss",
            "showdefaults"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_mountd_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "565-597",
          "snippet": "static void nfs_show_mountd_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&nfss->mountd_address;\n\n\tif (nfss->flags & NFS_MOUNT_LEGACY_INTERFACE)\n\t\treturn;\n\n\tswitch (sap->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI4\", &sin->sin_addr.s_addr);\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI6c\", &sin6->sin6_addr);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \",mountaddr=unspecified\");\n\t}\n\n\tif (nfss->mountd_version || showdefaults)\n\t\tseq_printf(m, \",mountvers=%u\", nfss->mountd_version);\n\tif ((nfss->mountd_port &&\n\t\tnfss->mountd_port != (unsigned short)NFS_UNSPEC_PORT) ||\n\t\tshowdefaults)\n\t\tseq_printf(m, \",mountport=%u\", nfss->mountd_port);\n\n\tnfs_show_mountd_netid(m, nfss, showdefaults);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mountd_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&nfss->mountd_address;\n\n\tif (nfss->flags & NFS_MOUNT_LEGACY_INTERFACE)\n\t\treturn;\n\n\tswitch (sap->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI4\", &sin->sin_addr.s_addr);\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI6c\", &sin6->sin6_addr);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \",mountaddr=unspecified\");\n\t}\n\n\tif (nfss->mountd_version || showdefaults)\n\t\tseq_printf(m, \",mountvers=%u\", nfss->mountd_version);\n\tif ((nfss->mountd_port &&\n\t\tnfss->mountd_port != (unsigned short)NFS_UNSPEC_PORT) ||\n\t\tshowdefaults)\n\t\tseq_printf(m, \",mountport=%u\", nfss->mountd_port);\n\n\tnfs_show_mountd_netid(m, nfss, showdefaults);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_pseudoflavour_to_name",
          "args": [
            "nfss->client->cl_auth->au_flavor"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_pseudoflavour_to_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "497-524",
          "snippet": "static const char *nfs_pseudoflavour_to_name(rpc_authflavor_t flavour)\n{\n\tstatic const struct {\n\t\trpc_authflavor_t flavour;\n\t\tconst char *str;\n\t} sec_flavours[NFS_AUTH_INFO_MAX_FLAVORS] = {\n\t\t/* update NFS_AUTH_INFO_MAX_FLAVORS when this list changes! */\n\t\t{ RPC_AUTH_NULL, \"null\" },\n\t\t{ RPC_AUTH_UNIX, \"sys\" },\n\t\t{ RPC_AUTH_GSS_KRB5, \"krb5\" },\n\t\t{ RPC_AUTH_GSS_KRB5I, \"krb5i\" },\n\t\t{ RPC_AUTH_GSS_KRB5P, \"krb5p\" },\n\t\t{ RPC_AUTH_GSS_LKEY, \"lkey\" },\n\t\t{ RPC_AUTH_GSS_LKEYI, \"lkeyi\" },\n\t\t{ RPC_AUTH_GSS_LKEYP, \"lkeyp\" },\n\t\t{ RPC_AUTH_GSS_SPKM, \"spkm\" },\n\t\t{ RPC_AUTH_GSS_SPKMI, \"spkmi\" },\n\t\t{ RPC_AUTH_GSS_SPKMP, \"spkmp\" },\n\t\t{ UINT_MAX, \"unknown\" }\n\t};\n\tint i;\n\n\tfor (i = 0; sec_flavours[i].flavour != UINT_MAX; i++) {\n\t\tif (sec_flavours[i].flavour == flavour)\n\t\t\tbreak;\n\t}\n\treturn sec_flavours[i].str;\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const char *nfs_pseudoflavour_to_name(rpc_authflavor_t flavour)\n{\n\tstatic const struct {\n\t\trpc_authflavor_t flavour;\n\t\tconst char *str;\n\t} sec_flavours[NFS_AUTH_INFO_MAX_FLAVORS] = {\n\t\t/* update NFS_AUTH_INFO_MAX_FLAVORS when this list changes! */\n\t\t{ RPC_AUTH_NULL, \"null\" },\n\t\t{ RPC_AUTH_UNIX, \"sys\" },\n\t\t{ RPC_AUTH_GSS_KRB5, \"krb5\" },\n\t\t{ RPC_AUTH_GSS_KRB5I, \"krb5i\" },\n\t\t{ RPC_AUTH_GSS_KRB5P, \"krb5p\" },\n\t\t{ RPC_AUTH_GSS_LKEY, \"lkey\" },\n\t\t{ RPC_AUTH_GSS_LKEYI, \"lkeyi\" },\n\t\t{ RPC_AUTH_GSS_LKEYP, \"lkeyp\" },\n\t\t{ RPC_AUTH_GSS_SPKM, \"spkm\" },\n\t\t{ RPC_AUTH_GSS_SPKMI, \"spkmi\" },\n\t\t{ RPC_AUTH_GSS_SPKMP, \"spkmp\" },\n\t\t{ UINT_MAX, \"unknown\" }\n\t};\n\tint i;\n\n\tfor (i = 0; sec_flavours[i].flavour != UINT_MAX; i++) {\n\t\tif (sec_flavours[i].flavour == flavour)\n\t\t\tbreak;\n\t}\n\treturn sec_flavours[i].str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_peeraddr2str",
          "args": [
            "nfss->client",
            "RPC_DISPLAY_NETID"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "nfs_infop->nostr"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "658-668",
          "snippet": "int seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_puts(struct seq_file *m, const char *s)\n{\n\tint len = strlen(s);\n\tif (m->count + len < m->size) {\n\t\tmemcpy(m->buf + m->count, s, len);\n\t\tm->count += len;\n\t\treturn 0;\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_show_nfs_version",
          "args": [
            "m",
            "version",
            "clp->cl_minorversion"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_nfs_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "614-621",
          "snippet": "static void nfs_show_nfs_version(struct seq_file *m,\n\t\tunsigned int version,\n\t\tunsigned int minorversion)\n{\n\tseq_printf(m, \",vers=%u\", version);\n\tif (version == 4)\n\t\tseq_printf(m, \".%u\", minorversion);\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_nfs_version(struct seq_file *m,\n\t\tunsigned int version,\n\t\tunsigned int minorversion)\n{\n\tseq_printf(m, \",vers=%u\", version);\n\tif (version == 4)\n\t\tseq_printf(m, \".%u\", minorversion);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mount_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t   int showdefaults)\n{\n\tstatic const struct proc_nfs_info {\n\t\tint flag;\n\t\tconst char *str;\n\t\tconst char *nostr;\n\t} nfs_info[] = {\n\t\t{ NFS_MOUNT_SOFT, \",soft\", \",hard\" },\n\t\t{ NFS_MOUNT_POSIX, \",posix\", \"\" },\n\t\t{ NFS_MOUNT_NOCTO, \",nocto\", \"\" },\n\t\t{ NFS_MOUNT_NOAC, \",noac\", \"\" },\n\t\t{ NFS_MOUNT_NONLM, \",nolock\", \"\" },\n\t\t{ NFS_MOUNT_NOACL, \",noacl\", \"\" },\n\t\t{ NFS_MOUNT_NORDIRPLUS, \",nordirplus\", \"\" },\n\t\t{ NFS_MOUNT_UNSHARED, \",nosharecache\", \"\" },\n\t\t{ NFS_MOUNT_NORESVPORT, \",noresvport\", \"\" },\n\t\t{ 0, NULL, NULL }\n\t};\n\tconst struct proc_nfs_info *nfs_infop;\n\tstruct nfs_client *clp = nfss->nfs_client;\n\tu32 version = clp->rpc_ops->version;\n\tint local_flock, local_fcntl;\n\n\tnfs_show_nfs_version(m, version, clp->cl_minorversion);\n\tseq_printf(m, \",rsize=%u\", nfss->rsize);\n\tseq_printf(m, \",wsize=%u\", nfss->wsize);\n\tif (nfss->bsize != 0)\n\t\tseq_printf(m, \",bsize=%u\", nfss->bsize);\n\tseq_printf(m, \",namlen=%u\", nfss->namelen);\n\tif (nfss->acregmin != NFS_DEF_ACREGMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmin=%u\", nfss->acregmin/HZ);\n\tif (nfss->acregmax != NFS_DEF_ACREGMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acregmax=%u\", nfss->acregmax/HZ);\n\tif (nfss->acdirmin != NFS_DEF_ACDIRMIN*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmin=%u\", nfss->acdirmin/HZ);\n\tif (nfss->acdirmax != NFS_DEF_ACDIRMAX*HZ || showdefaults)\n\t\tseq_printf(m, \",acdirmax=%u\", nfss->acdirmax/HZ);\n\tfor (nfs_infop = nfs_info; nfs_infop->flag; nfs_infop++) {\n\t\tif (nfss->flags & nfs_infop->flag)\n\t\t\tseq_puts(m, nfs_infop->str);\n\t\telse\n\t\t\tseq_puts(m, nfs_infop->nostr);\n\t}\n\trcu_read_lock();\n\tseq_printf(m, \",proto=%s\",\n\t\t   rpc_peeraddr2str(nfss->client, RPC_DISPLAY_NETID));\n\trcu_read_unlock();\n\tif (version == 4) {\n\t\tif (nfss->port != NFS_PORT)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\t} else\n\t\tif (nfss->port)\n\t\t\tseq_printf(m, \",port=%u\", nfss->port);\n\n\tseq_printf(m, \",timeo=%lu\", 10U * nfss->client->cl_timeout->to_initval / HZ);\n\tseq_printf(m, \",retrans=%u\", nfss->client->cl_timeout->to_retries);\n\tseq_printf(m, \",sec=%s\", nfs_pseudoflavour_to_name(nfss->client->cl_auth->au_flavor));\n\n\tif (version != 4)\n\t\tnfs_show_mountd_options(m, nfss, showdefaults);\n\telse\n\t\tnfs_show_nfsv4_options(m, nfss, showdefaults);\n\n\tif (nfss->options & NFS_OPTION_FSCACHE)\n\t\tseq_printf(m, \",fsc\");\n\n\tif (nfss->options & NFS_OPTION_MIGRATION)\n\t\tseq_printf(m, \",migration\");\n\n\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONEG) {\n\t\tif (nfss->flags & NFS_MOUNT_LOOKUP_CACHE_NONE)\n\t\t\tseq_printf(m, \",lookupcache=none\");\n\t\telse\n\t\t\tseq_printf(m, \",lookupcache=pos\");\n\t}\n\n\tlocal_flock = nfss->flags & NFS_MOUNT_LOCAL_FLOCK;\n\tlocal_fcntl = nfss->flags & NFS_MOUNT_LOCAL_FCNTL;\n\n\tif (!local_flock && !local_fcntl)\n\t\tseq_printf(m, \",local_lock=none\");\n\telse if (local_flock && local_fcntl)\n\t\tseq_printf(m, \",local_lock=all\");\n\telse if (local_flock)\n\t\tseq_printf(m, \",local_lock=flock\");\n\telse\n\t\tseq_printf(m, \",local_lock=posix\");\n}"
  },
  {
    "function_name": "nfs_show_nfs_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "614-621",
    "snippet": "static void nfs_show_nfs_version(struct seq_file *m,\n\t\tunsigned int version,\n\t\tunsigned int minorversion)\n{\n\tseq_printf(m, \",vers=%u\", version);\n\tif (version == 4)\n\t\tseq_printf(m, \".%u\", minorversion);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\".%u\"",
            "minorversion"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_nfs_version(struct seq_file *m,\n\t\tunsigned int version,\n\t\tunsigned int minorversion)\n{\n\tseq_printf(m, \",vers=%u\", version);\n\tif (version == 4)\n\t\tseq_printf(m, \".%u\", minorversion);\n}"
  },
  {
    "function_name": "nfs_show_nfsv4_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "608-611",
    "snippet": "static void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n}"
  },
  {
    "function_name": "nfs_show_nfsv4_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "600-606",
    "snippet": "static void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct nfs_client *clp = nfss->nfs_client;\n\n\tseq_printf(m, \",clientaddr=%s\", clp->cl_ipaddr);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",clientaddr=%s\"",
            "clp->cl_ipaddr"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_nfsv4_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct nfs_client *clp = nfss->nfs_client;\n\n\tseq_printf(m, \",clientaddr=%s\", clp->cl_ipaddr);\n}"
  },
  {
    "function_name": "nfs_show_mountd_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "565-597",
    "snippet": "static void nfs_show_mountd_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&nfss->mountd_address;\n\n\tif (nfss->flags & NFS_MOUNT_LEGACY_INTERFACE)\n\t\treturn;\n\n\tswitch (sap->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI4\", &sin->sin_addr.s_addr);\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI6c\", &sin6->sin6_addr);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \",mountaddr=unspecified\");\n\t}\n\n\tif (nfss->mountd_version || showdefaults)\n\t\tseq_printf(m, \",mountvers=%u\", nfss->mountd_version);\n\tif ((nfss->mountd_port &&\n\t\tnfss->mountd_port != (unsigned short)NFS_UNSPEC_PORT) ||\n\t\tshowdefaults)\n\t\tseq_printf(m, \",mountport=%u\", nfss->mountd_port);\n\n\tnfs_show_mountd_netid(m, nfss, showdefaults);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_show_mountd_netid",
          "args": [
            "m",
            "nfss",
            "showdefaults"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_show_mountd_netid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "526-563",
          "snippet": "static void nfs_show_mountd_netid(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t  int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *) &nfss->mountd_address;\n\n\tseq_printf(m, \",mountproto=\");\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tcase AF_INET6:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP6);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \"auto\");\n\t}\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mountd_netid(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t  int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *) &nfss->mountd_address;\n\n\tseq_printf(m, \",mountproto=\");\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tcase AF_INET6:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP6);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \"auto\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",mountport=%u\"",
            "nfss->mountd_port"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mountd_options(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t    int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *)&nfss->mountd_address;\n\n\tif (nfss->flags & NFS_MOUNT_LEGACY_INTERFACE)\n\t\treturn;\n\n\tswitch (sap->sa_family) {\n\tcase AF_INET: {\n\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI4\", &sin->sin_addr.s_addr);\n\t\tbreak;\n\t}\n\tcase AF_INET6: {\n\t\tstruct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)sap;\n\t\tseq_printf(m, \",mountaddr=%pI6c\", &sin6->sin6_addr);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \",mountaddr=unspecified\");\n\t}\n\n\tif (nfss->mountd_version || showdefaults)\n\t\tseq_printf(m, \",mountvers=%u\", nfss->mountd_version);\n\tif ((nfss->mountd_port &&\n\t\tnfss->mountd_port != (unsigned short)NFS_UNSPEC_PORT) ||\n\t\tshowdefaults)\n\t\tseq_printf(m, \",mountport=%u\", nfss->mountd_port);\n\n\tnfs_show_mountd_netid(m, nfss, showdefaults);\n}"
  },
  {
    "function_name": "nfs_show_mountd_netid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "526-563",
    "snippet": "static void nfs_show_mountd_netid(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t  int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *) &nfss->mountd_address;\n\n\tseq_printf(m, \",mountproto=\");\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tcase AF_INET6:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP6);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \"auto\");\n\t}\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"auto\""
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_show_mountd_netid(struct seq_file *m, struct nfs_server *nfss,\n\t\t\t\t  int showdefaults)\n{\n\tstruct sockaddr *sap = (struct sockaddr *) &nfss->mountd_address;\n\n\tseq_printf(m, \",mountproto=\");\n\tswitch (sap->sa_family) {\n\tcase AF_INET:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tcase AF_INET6:\n\t\tswitch (nfss->mountd_protocol) {\n\t\tcase IPPROTO_UDP:\n\t\t\tseq_printf(m, RPCBIND_NETID_UDP6);\n\t\t\tbreak;\n\t\tcase IPPROTO_TCP:\n\t\t\tseq_printf(m, RPCBIND_NETID_TCP6);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tif (showdefaults)\n\t\t\t\tseq_printf(m, \"auto\");\n\t\t}\n\t\tbreak;\n\tdefault:\n\t\tif (showdefaults)\n\t\t\tseq_printf(m, \"auto\");\n\t}\n}"
  },
  {
    "function_name": "nfs_pseudoflavour_to_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "497-524",
    "snippet": "static const char *nfs_pseudoflavour_to_name(rpc_authflavor_t flavour)\n{\n\tstatic const struct {\n\t\trpc_authflavor_t flavour;\n\t\tconst char *str;\n\t} sec_flavours[NFS_AUTH_INFO_MAX_FLAVORS] = {\n\t\t/* update NFS_AUTH_INFO_MAX_FLAVORS when this list changes! */\n\t\t{ RPC_AUTH_NULL, \"null\" },\n\t\t{ RPC_AUTH_UNIX, \"sys\" },\n\t\t{ RPC_AUTH_GSS_KRB5, \"krb5\" },\n\t\t{ RPC_AUTH_GSS_KRB5I, \"krb5i\" },\n\t\t{ RPC_AUTH_GSS_KRB5P, \"krb5p\" },\n\t\t{ RPC_AUTH_GSS_LKEY, \"lkey\" },\n\t\t{ RPC_AUTH_GSS_LKEYI, \"lkeyi\" },\n\t\t{ RPC_AUTH_GSS_LKEYP, \"lkeyp\" },\n\t\t{ RPC_AUTH_GSS_SPKM, \"spkm\" },\n\t\t{ RPC_AUTH_GSS_SPKMI, \"spkmi\" },\n\t\t{ RPC_AUTH_GSS_SPKMP, \"spkmp\" },\n\t\t{ UINT_MAX, \"unknown\" }\n\t};\n\tint i;\n\n\tfor (i = 0; sec_flavours[i].flavour != UINT_MAX; i++) {\n\t\tif (sec_flavours[i].flavour == flavour)\n\t\t\tbreak;\n\t}\n\treturn sec_flavours[i].str;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic const char *nfs_pseudoflavour_to_name(rpc_authflavor_t flavour)\n{\n\tstatic const struct {\n\t\trpc_authflavor_t flavour;\n\t\tconst char *str;\n\t} sec_flavours[NFS_AUTH_INFO_MAX_FLAVORS] = {\n\t\t/* update NFS_AUTH_INFO_MAX_FLAVORS when this list changes! */\n\t\t{ RPC_AUTH_NULL, \"null\" },\n\t\t{ RPC_AUTH_UNIX, \"sys\" },\n\t\t{ RPC_AUTH_GSS_KRB5, \"krb5\" },\n\t\t{ RPC_AUTH_GSS_KRB5I, \"krb5i\" },\n\t\t{ RPC_AUTH_GSS_KRB5P, \"krb5p\" },\n\t\t{ RPC_AUTH_GSS_LKEY, \"lkey\" },\n\t\t{ RPC_AUTH_GSS_LKEYI, \"lkeyi\" },\n\t\t{ RPC_AUTH_GSS_LKEYP, \"lkeyp\" },\n\t\t{ RPC_AUTH_GSS_SPKM, \"spkm\" },\n\t\t{ RPC_AUTH_GSS_SPKMI, \"spkmi\" },\n\t\t{ RPC_AUTH_GSS_SPKMP, \"spkmp\" },\n\t\t{ UINT_MAX, \"unknown\" }\n\t};\n\tint i;\n\n\tfor (i = 0; sec_flavours[i].flavour != UINT_MAX; i++) {\n\t\tif (sec_flavours[i].flavour == flavour)\n\t\t\tbreak;\n\t}\n\treturn sec_flavours[i].str;\n}"
  },
  {
    "function_name": "nfs_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "431-491",
    "snippet": "int nfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\tunsigned char blockbits;\n\tunsigned long blockres;\n\tstruct nfs_fh *fh = NFS_FH(dentry->d_inode);\n\tstruct nfs_fsstat res;\n\tint error = -ENOMEM;\n\n\tres.fattr = nfs_alloc_fattr();\n\tif (res.fattr == NULL)\n\t\tgoto out_err;\n\n\terror = server->nfs_client->rpc_ops->statfs(server, fh, &res);\n\tif (unlikely(error == -ESTALE)) {\n\t\tstruct dentry *pd_dentry;\n\n\t\tpd_dentry = dget_parent(dentry);\n\t\tif (pd_dentry != NULL) {\n\t\t\tnfs_zap_caches(pd_dentry->d_inode);\n\t\t\tdput(pd_dentry);\n\t\t}\n\t}\n\tnfs_free_fattr(res.fattr);\n\tif (error < 0)\n\t\tgoto out_err;\n\n\tbuf->f_type = NFS_SUPER_MAGIC;\n\n\t/*\n\t * Current versions of glibc do not correctly handle the\n\t * case where f_frsize != f_bsize.  Eventually we want to\n\t * report the value of wtmult in this field.\n\t */\n\tbuf->f_frsize = dentry->d_sb->s_blocksize;\n\n\t/*\n\t * On most *nix systems, f_blocks, f_bfree, and f_bavail\n\t * are reported in units of f_frsize.  Linux hasn't had\n\t * an f_frsize field in its statfs struct until recently,\n\t * thus historically Linux's sys_statfs reports these\n\t * fields in units of f_bsize.\n\t */\n\tbuf->f_bsize = dentry->d_sb->s_blocksize;\n\tblockbits = dentry->d_sb->s_blocksize_bits;\n\tblockres = (1 << blockbits) - 1;\n\tbuf->f_blocks = (res.tbytes + blockres) >> blockbits;\n\tbuf->f_bfree = (res.fbytes + blockres) >> blockbits;\n\tbuf->f_bavail = (res.abytes + blockres) >> blockbits;\n\n\tbuf->f_files = res.tfiles;\n\tbuf->f_ffree = res.afiles;\n\n\tbuf->f_namelen = server->namelen;\n\n\treturn 0;\n\n out_err:\n\tdprintk(\"%s: statfs error = %d\\n\", __func__, -error);\n\treturn error;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"%s: statfs error = %d\\n\"",
            "__func__",
            "-error"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_free_fattr",
          "args": [
            "res.fattr"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "pd_dentry"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_zap_caches",
          "args": [
            "pd_dentry->d_inode"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_zap_caches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "189-194",
          "snippet": "void nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nfs_invalidate_inode(struct inode *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void nfs_invalidate_inode(struct inode *);\n\nvoid nfs_zap_caches(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tnfs_zap_caches_locked(inode);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dget_parent",
          "args": [
            "dentry"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "dget_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "777-814",
          "snippet": "struct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *dget_parent(struct dentry *dentry)\n{\n\tint gotref;\n\tstruct dentry *ret;\n\n\t/*\n\t * Do optimistic parent lookup without any\n\t * locking.\n\t */\n\trcu_read_lock();\n\tret = ACCESS_ONCE(dentry->d_parent);\n\tgotref = lockref_get_not_zero(&ret->d_lockref);\n\trcu_read_unlock();\n\tif (likely(gotref)) {\n\t\tif (likely(ret == ACCESS_ONCE(dentry->d_parent)))\n\t\t\treturn ret;\n\t\tdput(ret);\n\t}\n\nrepeat:\n\t/*\n\t * Don't need rcu_dereference because we re-check it was correct under\n\t * the lock.\n\t */\n\trcu_read_lock();\n\tret = dentry->d_parent;\n\tspin_lock(&ret->d_lock);\n\tif (unlikely(ret != dentry->d_parent)) {\n\t\tspin_unlock(&ret->d_lock);\n\t\trcu_read_unlock();\n\t\tgoto repeat;\n\t}\n\trcu_read_unlock();\n\tBUG_ON(!ret->d_lockref.count);\n\tret->d_lockref.count++;\n\tspin_unlock(&ret->d_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error == -ESTALE"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "server->nfs_client->rpc_ops->statfs",
          "args": [
            "server",
            "fh",
            "&res"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_alloc_fattr",
          "args": [],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_alloc_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/inode.c",
          "lines": "1312-1320",
          "snippet": "struct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}",
          "includes": [
            "#include \"nfstrace.h\"",
            "#include \"netns.h\"",
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/compat.h>",
            "#include <linux/slab.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_update_inode(struct inode *, struct nfs_fattr *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfstrace.h\"\n#include \"netns.h\"\n#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/compat.h>\n#include <linux/slab.h>\n#include <linux/nfs_xdr.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int nfs_update_inode(struct inode *, struct nfs_fattr *);\n\nstruct nfs_fattr *nfs_alloc_fattr(void)\n{\n\tstruct nfs_fattr *fattr;\n\n\tfattr = kmalloc(sizeof(*fattr), GFP_NOFS);\n\tif (fattr != NULL)\n\t\tnfs_fattr_init(fattr);\n\treturn fattr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NFS_FH",
          "args": [
            "dentry->d_inode"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "dentry->d_sb"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint nfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct nfs_server *server = NFS_SB(dentry->d_sb);\n\tunsigned char blockbits;\n\tunsigned long blockres;\n\tstruct nfs_fh *fh = NFS_FH(dentry->d_inode);\n\tstruct nfs_fsstat res;\n\tint error = -ENOMEM;\n\n\tres.fattr = nfs_alloc_fattr();\n\tif (res.fattr == NULL)\n\t\tgoto out_err;\n\n\terror = server->nfs_client->rpc_ops->statfs(server, fh, &res);\n\tif (unlikely(error == -ESTALE)) {\n\t\tstruct dentry *pd_dentry;\n\n\t\tpd_dentry = dget_parent(dentry);\n\t\tif (pd_dentry != NULL) {\n\t\t\tnfs_zap_caches(pd_dentry->d_inode);\n\t\t\tdput(pd_dentry);\n\t\t}\n\t}\n\tnfs_free_fattr(res.fattr);\n\tif (error < 0)\n\t\tgoto out_err;\n\n\tbuf->f_type = NFS_SUPER_MAGIC;\n\n\t/*\n\t * Current versions of glibc do not correctly handle the\n\t * case where f_frsize != f_bsize.  Eventually we want to\n\t * report the value of wtmult in this field.\n\t */\n\tbuf->f_frsize = dentry->d_sb->s_blocksize;\n\n\t/*\n\t * On most *nix systems, f_blocks, f_bfree, and f_bavail\n\t * are reported in units of f_frsize.  Linux hasn't had\n\t * an f_frsize field in its statfs struct until recently,\n\t * thus historically Linux's sys_statfs reports these\n\t * fields in units of f_bsize.\n\t */\n\tbuf->f_bsize = dentry->d_sb->s_blocksize;\n\tblockbits = dentry->d_sb->s_blocksize_bits;\n\tblockres = (1 << blockbits) - 1;\n\tbuf->f_blocks = (res.tbytes + blockres) >> blockbits;\n\tbuf->f_bfree = (res.fbytes + blockres) >> blockbits;\n\tbuf->f_bavail = (res.abytes + blockres) >> blockbits;\n\n\tbuf->f_files = res.tfiles;\n\tbuf->f_ffree = res.afiles;\n\n\tbuf->f_namelen = server->namelen;\n\n\treturn 0;\n\n out_err:\n\tdprintk(\"%s: statfs error = %d\\n\", __func__, -error);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_sb_deactive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "419-425",
    "snippet": "void nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "deactivate_super",
          "args": [
            "sb"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&server->active"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nvoid nfs_sb_deactive(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (atomic_dec_and_test(&server->active))\n\t\tdeactivate_super(sb);\n}"
  },
  {
    "function_name": "nfs_sb_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "407-416",
    "snippet": "bool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&sb->s_active"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc_return",
          "args": [
            "&server->active"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc_not_zero",
          "args": [
            "&sb->s_active"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NFS_SB",
          "args": [
            "sb"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nbool nfs_sb_active(struct super_block *sb)\n{\n\tstruct nfs_server *server = NFS_SB(sb);\n\n\tif (!atomic_inc_not_zero(&sb->s_active))\n\t\treturn false;\n\tif (atomic_inc_return(&server->active) != 1)\n\t\tatomic_dec(&sb->s_active);\n\treturn true;\n}"
  },
  {
    "function_name": "unregister_nfs_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "399-405",
    "snippet": "void __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};",
      "static struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&nfs_fs_type"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_nfs4_fs",
          "args": [],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs4_fs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "356-358",
          "snippet": "static void unregister_nfs4_fs(void)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void unregister_nfs4_fs(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_unregister_sysctl",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_unregister_sysctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/sysctl.c",
          "lines": "60-64",
          "snippet": "void nfs_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs_callback_sysctl_table);\n\tnfs_callback_sysctl_table = NULL;\n}",
          "includes": [
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/fs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/linkage.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ctl_table_header *nfs_callback_sysctl_table;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/sysctl.h>\n#include <linux/fs.h>\n#include <linux/ctype.h>\n#include <linux/linkage.h>\n#include <linux/types.h>\n\nstatic struct ctl_table_header *nfs_callback_sysctl_table;\n\nvoid nfs_unregister_sysctl(void)\n{\n\tunregister_sysctl_table(nfs_callback_sysctl_table);\n\tnfs_callback_sysctl_table = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&acl_shrinker"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\nstatic struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};\n\nvoid __exit unregister_nfs_fs(void)\n{\n\tunregister_shrinker(&acl_shrinker);\n\tnfs_unregister_sysctl();\n\tunregister_nfs4_fs();\n\tunregister_filesystem(&nfs_fs_type);\n}"
  },
  {
    "function_name": "register_nfs_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "370-394",
    "snippet": "int __init register_nfs_fs(void)\n{\n\tint ret;\n\n        ret = register_filesystem(&nfs_fs_type);\n\tif (ret < 0)\n\t\tgoto error_0;\n\n\tret = register_nfs4_fs();\n\tif (ret < 0)\n\t\tgoto error_1;\n\n\tret = nfs_register_sysctl();\n\tif (ret < 0)\n\t\tgoto error_2;\n\tregister_shrinker(&acl_shrinker);\n\treturn 0;\n\nerror_2:\n\tunregister_nfs4_fs();\nerror_1:\n\tunregister_filesystem(&nfs_fs_type);\nerror_0:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};",
      "static struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&nfs_fs_type"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_nfs4_fs",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_nfs4_fs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
          "lines": "356-358",
          "snippet": "static void unregister_nfs4_fs(void)\n{\n}",
          "includes": [
            "#include \"nfs.h\"",
            "#include \"pnfs.h\"",
            "#include \"nfs4session.h\"",
            "#include \"fscache.h\"",
            "#include \"internal.h\"",
            "#include \"iostat.h\"",
            "#include \"delegation.h\"",
            "#include \"callback.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/parser.h>",
            "#include <linux/magic.h>",
            "#include <linux/nfs_xdr.h>",
            "#include <linux/netdevice.h>",
            "#include <net/ipv6.h>",
            "#include <linux/slab.h>",
            "#include <linux/in6.h>",
            "#include <linux/inet.h>",
            "#include <linux/vfs.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/lockd/bind.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/xprtrdma.h>",
            "#include <linux/sunrpc/xprtsock.h>",
            "#include <linux/sunrpc/metrics.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/unistd.h>",
            "#include <linux/errno.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void unregister_nfs4_fs(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&acl_shrinker"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_register_sysctl",
          "args": [],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_register_sysctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/sysctl.c",
          "lines": "52-58",
          "snippet": "int nfs_register_sysctl(void)\n{\n\tnfs_callback_sysctl_table = register_sysctl_table(nfs_cb_sysctl_root);\n\tif (nfs_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/fs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/linkage.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ctl_table_header *nfs_callback_sysctl_table;",
            "static struct ctl_table nfs_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs_cb_sysctl_dir,\n\t},\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/sysctl.h>\n#include <linux/fs.h>\n#include <linux/ctype.h>\n#include <linux/linkage.h>\n#include <linux/types.h>\n\nstatic struct ctl_table_header *nfs_callback_sysctl_table;\nstatic struct ctl_table nfs_cb_sysctl_root[] = {\n\t{\n\t\t.procname = \"fs\",\n\t\t.mode = 0555,\n\t\t.child = nfs_cb_sysctl_dir,\n\t},\n\t{ }\n};\n\nint nfs_register_sysctl(void)\n{\n\tnfs_callback_sysctl_table = register_sysctl_table(nfs_cb_sysctl_root);\n\tif (nfs_callback_sysctl_table == NULL)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct file_system_type nfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"nfs\",\n\t.mount\t\t= nfs_fs_mount,\n\t.kill_sb\t= nfs_kill_super,\n\t.fs_flags\t= FS_RENAME_DOES_D_MOVE|FS_BINARY_MOUNTDATA,\n};\nstatic struct shrinker acl_shrinker = {\n\t.count_objects\t= nfs_access_cache_count,\n\t.scan_objects\t= nfs_access_cache_scan,\n\t.seeks\t\t= DEFAULT_SEEKS,\n};\n\nint __init register_nfs_fs(void)\n{\n\tint ret;\n\n        ret = register_filesystem(&nfs_fs_type);\n\tif (ret < 0)\n\t\tgoto error_0;\n\n\tret = register_nfs4_fs();\n\tif (ret < 0)\n\t\tgoto error_1;\n\n\tret = nfs_register_sysctl();\n\tif (ret < 0)\n\t\tgoto error_2;\n\tregister_shrinker(&acl_shrinker);\n\treturn 0;\n\nerror_2:\n\tunregister_nfs4_fs();\nerror_1:\n\tunregister_filesystem(&nfs_fs_type);\nerror_0:\n\treturn ret;\n}"
  },
  {
    "function_name": "unregister_nfs4_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "356-358",
    "snippet": "static void unregister_nfs4_fs(void)\n{\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void unregister_nfs4_fs(void)\n{\n}"
  },
  {
    "function_name": "register_nfs4_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "351-354",
    "snippet": "static int __init register_nfs4_fs(void)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int __init register_nfs4_fs(void)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "unregister_nfs4_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "346-349",
    "snippet": "static void unregister_nfs4_fs(void)\n{\n\tunregister_filesystem(&nfs4_fs_type);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&nfs4_fs_type"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void unregister_nfs4_fs(void)\n{\n\tunregister_filesystem(&nfs4_fs_type);\n}"
  },
  {
    "function_name": "register_nfs4_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/super.c",
    "lines": "341-344",
    "snippet": "static int __init register_nfs4_fs(void)\n{\n\treturn register_filesystem(&nfs4_fs_type);\n}",
    "includes": [
      "#include \"nfs.h\"",
      "#include \"pnfs.h\"",
      "#include \"nfs4session.h\"",
      "#include \"fscache.h\"",
      "#include \"internal.h\"",
      "#include \"iostat.h\"",
      "#include \"delegation.h\"",
      "#include \"callback.h\"",
      "#include \"nfs4_fs.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/nsproxy.h>",
      "#include <linux/parser.h>",
      "#include <linux/magic.h>",
      "#include <linux/nfs_xdr.h>",
      "#include <linux/netdevice.h>",
      "#include <net/ipv6.h>",
      "#include <linux/slab.h>",
      "#include <linux/in6.h>",
      "#include <linux/inet.h>",
      "#include <linux/vfs.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/lockd/bind.h>",
      "#include <linux/nfs4_mount.h>",
      "#include <linux/nfs_mount.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/xprtrdma.h>",
      "#include <linux/sunrpc/xprtsock.h>",
      "#include <linux/sunrpc/metrics.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/addr.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/unistd.h>",
      "#include <linux/errno.h>",
      "#include <linux/stat.h>",
      "#include <linux/string.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_filesystem",
          "args": [
            "&nfs4_fs_type"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/filesystems.c",
          "lines": "101-120",
          "snippet": "int unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/kmod.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct file_system_type *file_systems;",
            "static DEFINE_RWLOCK(file_systems_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kmod.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n\nstatic struct file_system_type *file_systems;\nstatic DEFINE_RWLOCK(file_systems_lock);\n\nint unregister_filesystem(struct file_system_type * fs)\n{\n\tstruct file_system_type ** tmp;\n\n\twrite_lock(&file_systems_lock);\n\ttmp = &file_systems;\n\twhile (*tmp) {\n\t\tif (fs == *tmp) {\n\t\t\t*tmp = fs->next;\n\t\t\tfs->next = NULL;\n\t\t\twrite_unlock(&file_systems_lock);\n\t\t\tsynchronize_rcu();\n\t\t\treturn 0;\n\t\t}\n\t\ttmp = &(*tmp)->next;\n\t}\n\twrite_unlock(&file_systems_lock);\n\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs.h\"\n#include \"pnfs.h\"\n#include \"nfs4session.h\"\n#include \"fscache.h\"\n#include \"internal.h\"\n#include \"iostat.h\"\n#include \"delegation.h\"\n#include \"callback.h\"\n#include \"nfs4_fs.h\"\n#include <asm/uaccess.h>\n#include <linux/rcupdate.h>\n#include <linux/nsproxy.h>\n#include <linux/parser.h>\n#include <linux/magic.h>\n#include <linux/nfs_xdr.h>\n#include <linux/netdevice.h>\n#include <net/ipv6.h>\n#include <linux/slab.h>\n#include <linux/in6.h>\n#include <linux/inet.h>\n#include <linux/vfs.h>\n#include <linux/nfs_idmap.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/seq_file.h>\n#include <linux/lockd/bind.h>\n#include <linux/nfs4_mount.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/xprtrdma.h>\n#include <linux/sunrpc/xprtsock.h>\n#include <linux/sunrpc/metrics.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/unistd.h>\n#include <linux/errno.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int __init register_nfs4_fs(void)\n{\n\treturn register_filesystem(&nfs4_fs_type);\n}"
  }
]