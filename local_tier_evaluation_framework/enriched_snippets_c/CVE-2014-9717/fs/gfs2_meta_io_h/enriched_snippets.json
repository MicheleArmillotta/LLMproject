[
  {
    "function_name": "gfs2_meta_inode_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.h",
    "lines": "66-70",
    "snippet": "static inline int gfs2_meta_inode_buffer(struct gfs2_inode *ip,\n\t\t\t\t\t struct buffer_head **bhp)\n{\n\treturn gfs2_meta_indirect_buffer(ip, 0, ip->i_no_addr, bhp);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_meta_indirect_buffer",
          "args": [
            "ip",
            "0",
            "ip->i_no_addr",
            "bhp"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_meta_indirect_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.c",
          "lines": "336-352",
          "snippet": "int gfs2_meta_indirect_buffer(struct gfs2_inode *ip, int height, u64 num,\n\t\t\t      struct buffer_head **bhp)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(&ip->i_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tstruct buffer_head *bh;\n\tint ret = 0;\n\tu32 mtype = height ? GFS2_METATYPE_IN : GFS2_METATYPE_DI;\n\n\tret = gfs2_meta_read(gl, num, DIO_WAIT, &bh);\n\tif (ret == 0 && gfs2_metatype_check(sdp, bh, mtype)) {\n\t\tbrelse(bh);\n\t\tret = -EIO;\n\t}\n\t*bhp = bh;\n\treturn ret;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"log.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/delay.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"log.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/delay.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_meta_indirect_buffer(struct gfs2_inode *ip, int height, u64 num,\n\t\t\t      struct buffer_head **bhp)\n{\n\tstruct gfs2_sbd *sdp = GFS2_SB(&ip->i_inode);\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tstruct buffer_head *bh;\n\tint ret = 0;\n\tu32 mtype = height ? GFS2_METATYPE_IN : GFS2_METATYPE_DI;\n\n\tret = gfs2_meta_read(gl, num, DIO_WAIT, &bh);\n\tif (ret == 0 && gfs2_metatype_check(sdp, bh, mtype)) {\n\t\tbrelse(bh);\n\t\tret = -EIO;\n\t}\n\t*bhp = bh;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline int gfs2_meta_inode_buffer(struct gfs2_inode *ip,\n\t\t\t\t\t struct buffer_head **bhp)\n{\n\treturn gfs2_meta_indirect_buffer(ip, 0, ip->i_no_addr, bhp);\n}"
  },
  {
    "function_name": "gfs2_mapping2sbd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.h",
    "lines": "43-52",
    "snippet": "static inline struct gfs2_sbd *gfs2_mapping2sbd(struct address_space *mapping)\n{\n\tstruct inode *inode = mapping->host;\n\tif (mapping->a_ops == &gfs2_meta_aops)\n\t\treturn (((struct gfs2_glock *)mapping) - 1)->gl_sbd;\n\telse if (mapping->a_ops == &gfs2_rgrp_aops)\n\t\treturn container_of(mapping, struct gfs2_sbd, sd_aspace);\n\telse\n\t\treturn inode->i_sb->s_fs_info;\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "mapping",
            "structgfs2_sbd",
            "sd_aspace"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct gfs2_sbd *gfs2_mapping2sbd(struct address_space *mapping)\n{\n\tstruct inode *inode = mapping->host;\n\tif (mapping->a_ops == &gfs2_meta_aops)\n\t\treturn (((struct gfs2_glock *)mapping) - 1)->gl_sbd;\n\telse if (mapping->a_ops == &gfs2_rgrp_aops)\n\t\treturn container_of(mapping, struct gfs2_sbd, sd_aspace);\n\telse\n\t\treturn inode->i_sb->s_fs_info;\n}"
  },
  {
    "function_name": "gfs2_buffer_copy_tail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.h",
    "lines": "28-38",
    "snippet": "static inline void gfs2_buffer_copy_tail(struct buffer_head *to_bh,\n\t\t\t\t\t int to_head,\n\t\t\t\t\t struct buffer_head *from_bh,\n\t\t\t\t\t int from_head)\n{\n\tBUG_ON(from_head < to_head);\n\tmemcpy(to_bh->b_data + to_head, from_bh->b_data + from_head,\n\t       from_bh->b_size - from_head);\n\tmemset(to_bh->b_data + to_bh->b_size + to_head - from_head,\n\t       0, from_head - to_head);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "to_bh->b_data + to_bh->b_size + to_head - from_head",
            "0",
            "from_head - to_head"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "to_bh->b_data + to_head",
            "from_bh->b_data + from_head",
            "from_bh->b_size - from_head"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "from_head < to_head"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void gfs2_buffer_copy_tail(struct buffer_head *to_bh,\n\t\t\t\t\t int to_head,\n\t\t\t\t\t struct buffer_head *from_bh,\n\t\t\t\t\t int from_head)\n{\n\tBUG_ON(from_head < to_head);\n\tmemcpy(to_bh->b_data + to_head, from_bh->b_data + from_head,\n\t       from_bh->b_size - from_head);\n\tmemset(to_bh->b_data + to_bh->b_size + to_head - from_head,\n\t       0, from_head - to_head);\n}"
  },
  {
    "function_name": "gfs2_buffer_clear_tail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.h",
    "lines": "22-26",
    "snippet": "static inline void gfs2_buffer_clear_tail(struct buffer_head *bh, int head)\n{\n\tBUG_ON(head > bh->b_size);\n\tmemset(bh->b_data + head, 0, bh->b_size - head);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bh->b_data + head",
            "0",
            "bh->b_size - head"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "head > bh->b_size"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void gfs2_buffer_clear_tail(struct buffer_head *bh, int head)\n{\n\tBUG_ON(head > bh->b_size);\n\tmemset(bh->b_data + head, 0, bh->b_size - head);\n}"
  },
  {
    "function_name": "gfs2_buffer_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/meta_io.h",
    "lines": "17-20",
    "snippet": "static inline void gfs2_buffer_clear(struct buffer_head *bh)\n{\n\tmemset(bh->b_data, 0, bh->b_size);\n}",
    "includes": [
      "#include \"incore.h\"",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bh->b_data",
            "0",
            "bh->b_size"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"incore.h\"\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void gfs2_buffer_clear(struct buffer_head *bh)\n{\n\tmemset(bh->b_data, 0, bh->b_size);\n}"
  }
]