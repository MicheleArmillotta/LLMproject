[
  {
    "function_name": "ext4_blocks_for_truncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/truncate.h",
    "lines": "21-42",
    "snippet": "static inline unsigned long ext4_blocks_for_truncate(struct inode *inode)\n{\n\text4_lblk_t needed;\n\n\tneeded = inode->i_blocks >> (inode->i_sb->s_blocksize_bits - 9);\n\n\t/* Give ourselves just enough room to cope with inodes in which\n\t * i_blocks is corrupt: we've seen disk corruptions in the past\n\t * which resulted in random data in an inode which looked enough\n\t * like a regular file for ext4 to try to delete it.  Things\n\t * will go a bit crazy if that happens, but at least we should\n\t * try not to panic the whole kernel. */\n\tif (needed < 2)\n\t\tneeded = 2;\n\n\t/* But we need to bound the transaction so we don't overflow the\n\t * journal. */\n\tif (needed > EXT4_MAX_TRANS_DATA)\n\t\tneeded = EXT4_MAX_TRANS_DATA;\n\n\treturn EXT4_DATA_TRANS_BLOCKS(inode->i_sb) + needed;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXT4_DATA_TRANS_BLOCKS",
          "args": [
            "inode->i_sb"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline unsigned long ext4_blocks_for_truncate(struct inode *inode)\n{\n\text4_lblk_t needed;\n\n\tneeded = inode->i_blocks >> (inode->i_sb->s_blocksize_bits - 9);\n\n\t/* Give ourselves just enough room to cope with inodes in which\n\t * i_blocks is corrupt: we've seen disk corruptions in the past\n\t * which resulted in random data in an inode which looked enough\n\t * like a regular file for ext4 to try to delete it.  Things\n\t * will go a bit crazy if that happens, but at least we should\n\t * try not to panic the whole kernel. */\n\tif (needed < 2)\n\t\tneeded = 2;\n\n\t/* But we need to bound the transaction so we don't overflow the\n\t * journal. */\n\tif (needed > EXT4_MAX_TRANS_DATA)\n\t\tneeded = EXT4_MAX_TRANS_DATA;\n\n\treturn EXT4_DATA_TRANS_BLOCKS(inode->i_sb) + needed;\n}"
  },
  {
    "function_name": "ext4_truncate_failed_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/truncate.h",
    "lines": "11-15",
    "snippet": "static inline void ext4_truncate_failed_write(struct inode *inode)\n{\n\ttruncate_inode_pages(inode->i_mapping, inode->i_size);\n\text4_truncate(inode);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ext4_truncate",
          "args": [
            "inode"
          ],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_truncate_failed_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/truncate.h",
          "lines": "11-15",
          "snippet": "static inline void ext4_truncate_failed_write(struct inode *inode)\n{\n\ttruncate_inode_pages(inode->i_mapping, inode->i_size);\n\text4_truncate(inode);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages",
          "args": [
            "inode->i_mapping",
            "inode->i_size"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void ext4_truncate_failed_write(struct inode *inode)\n{\n\ttruncate_inode_pages(inode->i_mapping, inode->i_size);\n\text4_truncate(inode);\n}"
  }
]