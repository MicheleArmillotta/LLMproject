[
  {
    "function_name": "fat_dir_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "386-389",
    "snippet": "static inline unsigned long fat_dir_hash(int logstart)\n{\n\treturn hash_32(logstart, FAT_HASH_BITS);\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [
      "#define FAT_HASH_BITS\t8"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_32",
          "args": [
            "logstart",
            "FAT_HASH_BITS"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\n#define FAT_HASH_BITS\t8\n\nstatic inline unsigned long fat_dir_hash(int logstart)\n{\n\treturn hash_32(logstart, FAT_HASH_BITS);\n}"
  },
  {
    "function_name": "fatent_brelse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "339-348",
    "snippet": "static inline void fatent_brelse(struct fat_entry *fatent)\n{\n\tint i;\n\tfatent->u.ent32_p = NULL;\n\tfor (i = 0; i < fatent->nr_bhs; i++)\n\t\tbrelse(fatent->bhs[i]);\n\tfatent->nr_bhs = 0;\n\tfatent->bhs[0] = fatent->bhs[1] = NULL;\n\tfatent->fat_inode = NULL;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "fatent->bhs[i]"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "fatent_brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "339-348",
          "snippet": "static inline void fatent_brelse(struct fat_entry *fatent)\n{\n\tint i;\n\tfatent->u.ent32_p = NULL;\n\tfor (i = 0; i < fatent->nr_bhs; i++)\n\t\tbrelse(fatent->bhs[i]);\n\tfatent->nr_bhs = 0;\n\tfatent->bhs[0] = fatent->bhs[1] = NULL;\n\tfatent->fat_inode = NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fatent_brelse(struct fat_entry *fatent)\n{\n\tint i;\n\tfatent->u.ent32_p = NULL;\n\tfor (i = 0; i < fatent->nr_bhs; i++)\n\t\tbrelse(fatent->bhs[i]);\n\tfatent->nr_bhs = 0;\n\tfatent->bhs[0] = fatent->bhs[1] = NULL;\n\tfatent->fat_inode = NULL;\n}"
  },
  {
    "function_name": "fatent_set_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "333-337",
    "snippet": "static inline void fatent_set_entry(struct fat_entry *fatent, int entry)\n{\n\tfatent->entry = entry;\n\tfatent->u.ent32_p = NULL;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fatent_set_entry(struct fat_entry *fatent, int entry)\n{\n\tfatent->entry = entry;\n\tfatent->u.ent32_p = NULL;\n}"
  },
  {
    "function_name": "fatent_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "324-331",
    "snippet": "static inline void fatent_init(struct fat_entry *fatent)\n{\n\tfatent->nr_bhs = 0;\n\tfatent->entry = 0;\n\tfatent->u.ent32_p = NULL;\n\tfatent->bhs[0] = fatent->bhs[1] = NULL;\n\tfatent->fat_inode = NULL;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fatent_init(struct fat_entry *fatent)\n{\n\tfatent->nr_bhs = 0;\n\tfatent->entry = 0;\n\tfatent->u.ent32_p = NULL;\n\tfatent->bhs[0] = fatent->bhs[1] = NULL;\n\tfatent->fat_inode = NULL;\n}"
  },
  {
    "function_name": "fatwchar_to16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "273-285",
    "snippet": "static inline void fatwchar_to16(__u8 *dst, const wchar_t *src, size_t len)\n{\n#ifdef __BIG_ENDIAN\n\twhile (len--) {\n\t\tdst[0] = *src & 0x00FF;\n\t\tdst[1] = (*src & 0xFF00) >> 8;\n\t\tdst += 2;\n\t\tsrc++;\n\t}\n#else\n\tmemcpy(dst, src, len * 2);\n#endif\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "len * 2"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fatwchar_to16(__u8 *dst, const wchar_t *src, size_t len)\n{\n#ifdef __BIG_ENDIAN\n\twhile (len--) {\n\t\tdst[0] = *src & 0x00FF;\n\t\tdst[1] = (*src & 0xFF00) >> 8;\n\t\tdst += 2;\n\t\tsrc++;\n\t}\n#else\n\tmemcpy(dst, src, len * 2);\n#endif\n}"
  },
  {
    "function_name": "fat_set_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "267-271",
    "snippet": "static inline void fat_set_start(struct msdos_dir_entry *de, int cluster)\n{\n\tde->start   = cpu_to_le16(cluster);\n\tde->starthi = cpu_to_le16(cluster >> 16);\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "cluster >> 16"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "cluster"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fat_set_start(struct msdos_dir_entry *de, int cluster)\n{\n\tde->start   = cpu_to_le16(cluster);\n\tde->starthi = cpu_to_le16(cluster >> 16);\n}"
  },
  {
    "function_name": "fat_get_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "258-265",
    "snippet": "static inline int fat_get_start(const struct msdos_sb_info *sbi,\n\t\t\t\tconst struct msdos_dir_entry *de)\n{\n\tint cluster = le16_to_cpu(de->start);\n\tif (sbi->fat_bits == 32)\n\t\tcluster |= (le16_to_cpu(de->starthi) << 16);\n\treturn cluster;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "de->starthi"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline int fat_get_start(const struct msdos_sb_info *sbi,\n\t\t\t\tconst struct msdos_dir_entry *de)\n{\n\tint cluster = le16_to_cpu(de->start);\n\tif (sbi->fat_bits == 32)\n\t\tcluster |= (le16_to_cpu(de->starthi) << 16);\n\treturn cluster;\n}"
  },
  {
    "function_name": "fat16_towchar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "246-256",
    "snippet": "static inline void fat16_towchar(wchar_t *dst, const __u8 *src, size_t len)\n{\n#ifdef __BIG_ENDIAN\n\twhile (len--) {\n\t\t*dst++ = src[0] | (src[1] << 8);\n\t\tsrc += 2;\n\t}\n#else\n\tmemcpy(dst, src, len * 2);\n#endif\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "len * 2"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fat16_towchar(wchar_t *dst, const __u8 *src, size_t len)\n{\n#ifdef __BIG_ENDIAN\n\twhile (len--) {\n\t\t*dst++ = src[0] | (src[1] << 8);\n\t\tsrc += 2;\n\t}\n#else\n\tmemcpy(dst, src, len * 2);\n#endif\n}"
  },
  {
    "function_name": "fat_i_pos_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "232-244",
    "snippet": "static inline loff_t fat_i_pos_read(struct msdos_sb_info *sbi,\n\t\t\t\t\tstruct inode *inode)\n{\n\tloff_t i_pos;\n#if BITS_PER_LONG == 32\n\tspin_lock(&sbi->inode_hash_lock);\n#endif\n\ti_pos = MSDOS_I(inode)->i_pos;\n#if BITS_PER_LONG == 32\n\tspin_unlock(&sbi->inode_hash_lock);\n#endif\n\treturn i_pos;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbi->inode_hash_lock"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MSDOS_I",
          "args": [
            "inode"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "MSDOS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "147-150",
          "snippet": "static inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbi->inode_hash_lock"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline loff_t fat_i_pos_read(struct msdos_sb_info *sbi,\n\t\t\t\t\tstruct inode *inode)\n{\n\tloff_t i_pos;\n#if BITS_PER_LONG == 32\n\tspin_lock(&sbi->inode_hash_lock);\n#endif\n\ti_pos = MSDOS_I(inode)->i_pos;\n#if BITS_PER_LONG == 32\n\tspin_unlock(&sbi->inode_hash_lock);\n#endif\n\treturn i_pos;\n}"
  },
  {
    "function_name": "fat_get_blknr_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "225-230",
    "snippet": "static inline void fat_get_blknr_offset(struct msdos_sb_info *sbi,\n\t\t\t\tloff_t i_pos, sector_t *blknr, int *offset)\n{\n\t*blknr = i_pos >> sbi->dir_per_block_bits;\n\t*offset = i_pos & (sbi->dir_per_block - 1);\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fat_get_blknr_offset(struct msdos_sb_info *sbi,\n\t\t\t\tloff_t i_pos, sector_t *blknr, int *offset)\n{\n\t*blknr = i_pos >> sbi->dir_per_block_bits;\n\t*offset = i_pos & (sbi->dir_per_block - 1);\n}"
  },
  {
    "function_name": "fat_clus_to_blknr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "219-223",
    "snippet": "static inline sector_t fat_clus_to_blknr(struct msdos_sb_info *sbi, int clus)\n{\n\treturn ((sector_t)clus - FAT_START_ENT) * sbi->sec_per_clus\n\t\t+ sbi->data_start;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline sector_t fat_clus_to_blknr(struct msdos_sb_info *sbi, int clus)\n{\n\treturn ((sector_t)clus - FAT_START_ENT) * sbi->sec_per_clus\n\t\t+ sbi->data_start;\n}"
  },
  {
    "function_name": "fat_checksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "208-217",
    "snippet": "static inline unsigned char fat_checksum(const __u8 *name)\n{\n\tunsigned char s = name[0];\n\ts = (s<<7) + (s>>1) + name[1];\ts = (s<<7) + (s>>1) + name[2];\n\ts = (s<<7) + (s>>1) + name[3];\ts = (s<<7) + (s>>1) + name[4];\n\ts = (s<<7) + (s>>1) + name[5];\ts = (s<<7) + (s>>1) + name[6];\n\ts = (s<<7) + (s>>1) + name[7];\ts = (s<<7) + (s>>1) + name[8];\n\ts = (s<<7) + (s>>1) + name[9];\ts = (s<<7) + (s>>1) + name[10];\n\treturn s;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline unsigned char fat_checksum(const __u8 *name)\n{\n\tunsigned char s = name[0];\n\ts = (s<<7) + (s>>1) + name[1];\ts = (s<<7) + (s>>1) + name[2];\n\ts = (s<<7) + (s>>1) + name[3];\ts = (s<<7) + (s>>1) + name[4];\n\ts = (s<<7) + (s>>1) + name[5];\ts = (s<<7) + (s>>1) + name[6];\n\ts = (s<<7) + (s>>1) + name[7];\ts = (s<<7) + (s>>1) + name[8];\n\ts = (s<<7) + (s>>1) + name[9];\ts = (s<<7) + (s>>1) + name[10];\n\treturn s;\n}"
  },
  {
    "function_name": "fat_save_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "200-206",
    "snippet": "static inline void fat_save_attrs(struct inode *inode, u8 attrs)\n{\n\tif (fat_mode_can_hold_ro(inode))\n\t\tMSDOS_I(inode)->i_attrs = attrs & ATTR_UNUSED;\n\telse\n\t\tMSDOS_I(inode)->i_attrs = attrs & (ATTR_UNUSED | ATTR_RO);\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MSDOS_I",
          "args": [
            "inode"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "MSDOS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "147-150",
          "snippet": "static inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fat_mode_can_hold_ro",
          "args": [
            "inode"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "fat_mode_can_hold_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "159-174",
          "snippet": "static inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline void fat_save_attrs(struct inode *inode, u8 attrs)\n{\n\tif (fat_mode_can_hold_ro(inode))\n\t\tMSDOS_I(inode)->i_attrs = attrs & ATTR_UNUSED;\n\telse\n\t\tMSDOS_I(inode)->i_attrs = attrs & (ATTR_UNUSED | ATTR_RO);\n}"
  },
  {
    "function_name": "fat_make_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "190-198",
    "snippet": "static inline u8 fat_make_attrs(struct inode *inode)\n{\n\tu8 attrs = MSDOS_I(inode)->i_attrs;\n\tif (S_ISDIR(inode->i_mode))\n\t\tattrs |= ATTR_DIR;\n\tif (fat_mode_can_hold_ro(inode) && !(inode->i_mode & S_IWUGO))\n\t\tattrs |= ATTR_RO;\n\treturn attrs;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fat_mode_can_hold_ro",
          "args": [
            "inode"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "fat_mode_can_hold_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "159-174",
          "snippet": "static inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSDOS_I",
          "args": [
            "inode"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "MSDOS_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "147-150",
          "snippet": "static inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline u8 fat_make_attrs(struct inode *inode)\n{\n\tu8 attrs = MSDOS_I(inode)->i_attrs;\n\tif (S_ISDIR(inode->i_mode))\n\t\tattrs |= ATTR_DIR;\n\tif (fat_mode_can_hold_ro(inode) && !(inode->i_mode & S_IWUGO))\n\t\tattrs |= ATTR_RO;\n\treturn attrs;\n}"
  },
  {
    "function_name": "fat_make_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "177-187",
    "snippet": "static inline umode_t fat_make_mode(struct msdos_sb_info *sbi,\n\t\t\t\t   u8 attrs, umode_t mode)\n{\n\tif (attrs & ATTR_RO && !((attrs & ATTR_DIR) && !sbi->options.rodir))\n\t\tmode &= ~S_IWUGO;\n\n\tif (attrs & ATTR_DIR)\n\t\treturn (mode & ~sbi->options.fs_dmask) | S_IFDIR;\n\telse\n\t\treturn (mode & ~sbi->options.fs_fmask) | S_IFREG;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline umode_t fat_make_mode(struct msdos_sb_info *sbi,\n\t\t\t\t   u8 attrs, umode_t mode)\n{\n\tif (attrs & ATTR_RO && !((attrs & ATTR_DIR) && !sbi->options.rodir))\n\t\tmode &= ~S_IWUGO;\n\n\tif (attrs & ATTR_DIR)\n\t\treturn (mode & ~sbi->options.fs_dmask) | S_IFDIR;\n\telse\n\t\treturn (mode & ~sbi->options.fs_fmask) | S_IFREG;\n}"
  },
  {
    "function_name": "fat_mode_can_hold_ro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "159-174",
    "snippet": "static inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MSDOS_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "MSDOS_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
          "lines": "142-145",
          "snippet": "static inline struct msdos_sb_info *MSDOS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/msdos_fs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/mutex.h>",
            "#include <linux/hash.h>",
            "#include <linux/fs.h>",
            "#include <linux/nls.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_sb_info *MSDOS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline int fat_mode_can_hold_ro(struct inode *inode)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(inode->i_sb);\n\tumode_t mask;\n\n\tif (S_ISDIR(inode->i_mode)) {\n\t\tif (!sbi->options.rodir)\n\t\t\treturn 0;\n\t\tmask = ~sbi->options.fs_dmask;\n\t} else\n\t\tmask = ~sbi->options.fs_fmask;\n\n\tif (!(mask & S_IWUGO))\n\t\treturn 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "MSDOS_I",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "147-150",
    "snippet": "static inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "inode",
            "structmsdos_inode_info",
            "vfs_inode"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_inode_info *MSDOS_I(struct inode *inode)\n{\n\treturn container_of(inode, struct msdos_inode_info, vfs_inode);\n}"
  },
  {
    "function_name": "MSDOS_SB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fat.h",
    "lines": "142-145",
    "snippet": "static inline struct msdos_sb_info *MSDOS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
    "includes": [
      "#include <linux/msdos_fs.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/mutex.h>",
      "#include <linux/hash.h>",
      "#include <linux/fs.h>",
      "#include <linux/nls.h>",
      "#include <linux/string.h>",
      "#include <linux/buffer_head.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/msdos_fs.h>\n#include <linux/ratelimit.h>\n#include <linux/mutex.h>\n#include <linux/hash.h>\n#include <linux/fs.h>\n#include <linux/nls.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n\nstatic inline struct msdos_sb_info *MSDOS_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
  }
]