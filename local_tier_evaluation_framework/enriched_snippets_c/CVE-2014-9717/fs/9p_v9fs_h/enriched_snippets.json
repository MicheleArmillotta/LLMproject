[
  {
    "function_name": "v9fs_get_new_inode_from_fid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "218-226",
    "snippet": "static inline struct inode *\nv9fs_get_new_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t    struct super_block *sb)\n{\n\tif (v9fs_proto_dotl(v9ses))\n\t\treturn v9fs_inode_from_fid_dotl(v9ses, fid, sb, 1);\n\telse\n\t\treturn v9fs_inode_from_fid(v9ses, fid, sb, 1);\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v9fs_inode_from_fid",
          "args": [
            "v9ses",
            "fid",
            "sb",
            "1"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_inode_from_fid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode.c",
          "lines": "549-564",
          "snippet": "struct inode *\nv9fs_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t    struct super_block *sb, int new)\n{\n\tstruct p9_wstat *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_stat(fid);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget(sb, &st->qid, st, new);\n\tp9stat_free(st);\n\tkfree(st);\n\treturn inode;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstruct inode *\nv9fs_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t    struct super_block *sb, int new)\n{\n\tstruct p9_wstat *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_stat(fid);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget(sb, &st->qid, st, new);\n\tp9stat_free(st);\n\tkfree(st);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_inode_from_fid_dotl",
          "args": [
            "v9ses",
            "fid",
            "sb",
            "1"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_inode_from_fid_dotl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode_dotl.c",
          "lines": "158-172",
          "snippet": "struct inode *\nv9fs_inode_from_fid_dotl(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t struct super_block *sb, int new)\n{\n\tstruct p9_stat_dotl *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_getattr_dotl(fid, P9_STATS_BASIC | P9_STATS_GEN);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget_dotl(sb, &st->qid, fid, st, new);\n\tkfree(st);\n\treturn inode;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstruct inode *\nv9fs_inode_from_fid_dotl(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t struct super_block *sb, int new)\n{\n\tstruct p9_stat_dotl *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_getattr_dotl(fid, P9_STATS_BASIC | P9_STATS_GEN);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget_dotl(sb, &st->qid, fid, st, new);\n\tkfree(st);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_proto_dotl",
          "args": [
            "v9ses"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_proto_dotl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
          "lines": "187-190",
          "snippet": "static inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}",
          "includes": [
            "#include <linux/backing-dev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline struct inode *\nv9fs_get_new_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t    struct super_block *sb)\n{\n\tif (v9fs_proto_dotl(v9ses))\n\t\treturn v9fs_inode_from_fid_dotl(v9ses, fid, sb, 1);\n\telse\n\t\treturn v9fs_inode_from_fid(v9ses, fid, sb, 1);\n}"
  },
  {
    "function_name": "v9fs_get_inode_from_fid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "200-208",
    "snippet": "static inline struct inode *\nv9fs_get_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\tstruct super_block *sb)\n{\n\tif (v9fs_proto_dotl(v9ses))\n\t\treturn v9fs_inode_from_fid_dotl(v9ses, fid, sb, 0);\n\telse\n\t\treturn v9fs_inode_from_fid(v9ses, fid, sb, 0);\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v9fs_inode_from_fid",
          "args": [
            "v9ses",
            "fid",
            "sb",
            "0"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_inode_from_fid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode.c",
          "lines": "549-564",
          "snippet": "struct inode *\nv9fs_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t    struct super_block *sb, int new)\n{\n\tstruct p9_wstat *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_stat(fid);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget(sb, &st->qid, st, new);\n\tp9stat_free(st);\n\tkfree(st);\n\treturn inode;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstruct inode *\nv9fs_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t    struct super_block *sb, int new)\n{\n\tstruct p9_wstat *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_stat(fid);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget(sb, &st->qid, st, new);\n\tp9stat_free(st);\n\tkfree(st);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_inode_from_fid_dotl",
          "args": [
            "v9ses",
            "fid",
            "sb",
            "0"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_inode_from_fid_dotl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/vfs_inode_dotl.c",
          "lines": "158-172",
          "snippet": "struct inode *\nv9fs_inode_from_fid_dotl(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t struct super_block *sb, int new)\n{\n\tstruct p9_stat_dotl *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_getattr_dotl(fid, P9_STATS_BASIC | P9_STATS_GEN);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget_dotl(sb, &st->qid, fid, st, new);\n\tkfree(st);\n\treturn inode;\n}",
          "includes": [
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"cache.h\"",
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/idr.h>",
            "#include <linux/namei.h>",
            "#include <linux/inet.h>",
            "#include <linux/string.h>",
            "#include <linux/stat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"acl.h\"\n#include \"xattr.h\"\n#include \"cache.h\"\n#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/idr.h>\n#include <linux/namei.h>\n#include <linux/inet.h>\n#include <linux/string.h>\n#include <linux/stat.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nstruct inode *\nv9fs_inode_from_fid_dotl(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\t struct super_block *sb, int new)\n{\n\tstruct p9_stat_dotl *st;\n\tstruct inode *inode = NULL;\n\n\tst = p9_client_getattr_dotl(fid, P9_STATS_BASIC | P9_STATS_GEN);\n\tif (IS_ERR(st))\n\t\treturn ERR_CAST(st);\n\n\tinode = v9fs_qid_iget_dotl(sb, &st->qid, fid, st, new);\n\tkfree(st);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "v9fs_proto_dotl",
          "args": [
            "v9ses"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_proto_dotl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
          "lines": "187-190",
          "snippet": "static inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}",
          "includes": [
            "#include <linux/backing-dev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline struct inode *\nv9fs_get_inode_from_fid(struct v9fs_session_info *v9ses, struct p9_fid *fid,\n\t\t\tstruct super_block *sb)\n{\n\tif (v9fs_proto_dotl(v9ses))\n\t\treturn v9fs_inode_from_fid_dotl(v9ses, fid, sb, 0);\n\telse\n\t\treturn v9fs_inode_from_fid(v9ses, fid, sb, 0);\n}"
  },
  {
    "function_name": "v9fs_proto_dotl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "187-190",
    "snippet": "static inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline int v9fs_proto_dotl(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000L;\n}"
  },
  {
    "function_name": "v9fs_proto_dotu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "182-185",
    "snippet": "static inline int v9fs_proto_dotu(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000U;\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline int v9fs_proto_dotu(struct v9fs_session_info *v9ses)\n{\n\treturn v9ses->flags & V9FS_PROTO_2000U;\n}"
  },
  {
    "function_name": "v9fs_dentry2v9ses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "177-180",
    "snippet": "static inline struct v9fs_session_info *v9fs_dentry2v9ses(struct dentry *dentry)\n{\n\treturn dentry->d_sb->s_fs_info;\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline struct v9fs_session_info *v9fs_dentry2v9ses(struct dentry *dentry)\n{\n\treturn dentry->d_sb->s_fs_info;\n}"
  },
  {
    "function_name": "v9fs_inode2v9ses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "172-175",
    "snippet": "static inline struct v9fs_session_info *v9fs_inode2v9ses(struct inode *inode)\n{\n\treturn (inode->i_sb->s_fs_info);\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline struct v9fs_session_info *v9fs_inode2v9ses(struct inode *inode)\n{\n\treturn (inode->i_sb->s_fs_info);\n}"
  },
  {
    "function_name": "V9FS_I",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/v9fs.h",
    "lines": "137-140",
    "snippet": "static inline struct v9fs_inode *V9FS_I(const struct inode *inode)\n{\n\treturn container_of(inode, struct v9fs_inode, vfs_inode);\n}",
    "includes": [
      "#include <linux/backing-dev.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "inode",
            "structv9fs_inode",
            "vfs_inode"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/backing-dev.h>\n\nstatic inline struct v9fs_inode *V9FS_I(const struct inode *inode)\n{\n\treturn container_of(inode, struct v9fs_inode, vfs_inode);\n}"
  }
]