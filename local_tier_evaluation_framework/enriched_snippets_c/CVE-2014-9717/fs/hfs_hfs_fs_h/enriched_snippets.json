[
  {
    "function_name": "hfs_bitmap_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfs/hfs_fs.h",
    "lines": "267-271",
    "snippet": "static inline void hfs_bitmap_dirty(struct super_block *sb)\n{\n\tset_bit(HFS_FLG_BITMAP_DIRTY, &HFS_SB(sb)->flags);\n\thfs_mark_mdb_dirty(sb);\n}",
    "includes": [
      "#include \"hfs.h\"",
      "#include <asm/uaccess.h>",
      "#include <asm/byteorder.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>",
      "#include <linux/types.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define HFS_FLG_BITMAP_DIRTY\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hfs_mark_mdb_dirty",
          "args": [
            "sb"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "hfs_mark_mdb_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfs/super.c",
          "lines": "68-83",
          "snippet": "void hfs_mark_mdb_dirty(struct super_block *sb)\n{\n\tstruct hfs_sb_info *sbi = HFS_SB(sb);\n\tunsigned long delay;\n\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn;\n\n\tspin_lock(&sbi->work_lock);\n\tif (!sbi->work_queued) {\n\t\tdelay = msecs_to_jiffies(dirty_writeback_interval * 10);\n\t\tqueue_delayed_work(system_long_wq, &sbi->mdb_work, delay);\n\t\tsbi->work_queued = 1;\n\t}\n\tspin_unlock(&sbi->work_lock);\n}",
          "includes": [
            "#include \"btree.h\"",
            "#include \"hfs_fs.h\"",
            "#include <linux/vfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/parser.h>",
            "#include <linux/nls.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btree.h\"\n#include \"hfs_fs.h\"\n#include <linux/vfs.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/parser.h>\n#include <linux/nls.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/blkdev.h>\n#include <linux/module.h>\n\nvoid hfs_mark_mdb_dirty(struct super_block *sb)\n{\n\tstruct hfs_sb_info *sbi = HFS_SB(sb);\n\tunsigned long delay;\n\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn;\n\n\tspin_lock(&sbi->work_lock);\n\tif (!sbi->work_queued) {\n\t\tdelay = msecs_to_jiffies(dirty_writeback_interval * 10);\n\t\tqueue_delayed_work(system_long_wq, &sbi->mdb_work, delay);\n\t\tsbi->work_queued = 1;\n\t}\n\tspin_unlock(&sbi->work_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "HFS_FLG_BITMAP_DIRTY",
            "&HFS_SB(sb)->flags"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "HFS_SB",
          "args": [
            "sb"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hfs.h\"\n#include <asm/uaccess.h>\n#include <asm/byteorder.h>\n#include <linux/workqueue.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/types.h>\n#include <linux/slab.h>\n\n#define HFS_FLG_BITMAP_DIRTY\t0\n\nstatic inline void hfs_bitmap_dirty(struct super_block *sb)\n{\n\tset_bit(HFS_FLG_BITMAP_DIRTY, &HFS_SB(sb)->flags);\n\thfs_mark_mdb_dirty(sb);\n}"
  },
  {
    "function_name": "hfs_mdb_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hfs/hfs_fs.h",
    "lines": "262-265",
    "snippet": "static inline const char *hfs_mdb_name(struct super_block *sb)\n{\n\treturn sb->s_id;\n}",
    "includes": [
      "#include \"hfs.h\"",
      "#include <asm/uaccess.h>",
      "#include <asm/byteorder.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/fs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/mutex.h>",
      "#include <linux/types.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"hfs.h\"\n#include <asm/uaccess.h>\n#include <asm/byteorder.h>\n#include <linux/workqueue.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/mutex.h>\n#include <linux/types.h>\n#include <linux/slab.h>\n\nstatic inline const char *hfs_mdb_name(struct super_block *sb)\n{\n\treturn sb->s_id;\n}"
  }
]