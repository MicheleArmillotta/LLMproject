[
  {
    "function_name": "exit_ocfs2_uptodate_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "634-638",
    "snippet": "void exit_ocfs2_uptodate_cache(void)\n{\n\tif (ocfs2_uptodate_cachep)\n\t\tkmem_cache_destroy(ocfs2_uptodate_cachep);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *ocfs2_uptodate_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "ocfs2_uptodate_cachep"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nvoid exit_ocfs2_uptodate_cache(void)\n{\n\tif (ocfs2_uptodate_cachep)\n\t\tkmem_cache_destroy(ocfs2_uptodate_cachep);\n}"
  },
  {
    "function_name": "init_ocfs2_uptodate_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "623-632",
    "snippet": "int __init init_ocfs2_uptodate_cache(void)\n{\n\tocfs2_uptodate_cachep = kmem_cache_create(\"ocfs2_uptodate\",\n\t\t\t\t  sizeof(struct ocfs2_meta_cache_item),\n\t\t\t\t  0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!ocfs2_uptodate_cachep)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *ocfs2_uptodate_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"ocfs2_uptodate\"",
            "sizeof(struct ocfs2_meta_cache_item)",
            "0",
            "SLAB_HWCACHE_ALIGN",
            "NULL"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nint __init init_ocfs2_uptodate_cache(void)\n{\n\tocfs2_uptodate_cachep = kmem_cache_create(\"ocfs2_uptodate\",\n\t\t\t\t  sizeof(struct ocfs2_meta_cache_item),\n\t\t\t\t  0, SLAB_HWCACHE_ALIGN, NULL);\n\tif (!ocfs2_uptodate_cachep)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ocfs2_remove_xattr_clusters_from_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "612-621",
    "snippet": "void ocfs2_remove_xattr_clusters_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t    sector_t block,\n\t\t\t\t\t    u32 c_len)\n{\n\tstruct super_block *sb = ocfs2_metadata_cache_get_super(ci);\n\tunsigned int i, b_len = ocfs2_clusters_to_blocks(sb, 1) * c_len;\n\n\tfor (i = 0; i < b_len; i++, block++)\n\t\tocfs2_remove_block_from_cache(ci, block);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_remove_block_from_cache",
          "args": [
            "ci",
            "block"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_remove_block_from_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "571-596",
          "snippet": "static void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ocfs2_uptodate_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_clusters_to_blocks",
          "args": [
            "sb",
            "1"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clusters_to_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "711-718",
          "snippet": "static inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_get_super",
          "args": [
            "ci"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_get_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "79-84",
          "snippet": "struct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstruct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_remove_xattr_clusters_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t    sector_t block,\n\t\t\t\t\t    u32 c_len)\n{\n\tstruct super_block *sb = ocfs2_metadata_cache_get_super(ci);\n\tunsigned int i, b_len = ocfs2_clusters_to_blocks(sb, 1) * c_len;\n\n\tfor (i = 0; i < b_len; i++, block++)\n\t\tocfs2_remove_block_from_cache(ci, block);\n}"
  },
  {
    "function_name": "ocfs2_remove_from_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "603-609",
    "snippet": "void ocfs2_remove_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t     struct buffer_head *bh)\n{\n\tsector_t block = bh->b_blocknr;\n\n\tocfs2_remove_block_from_cache(ci, block);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_remove_block_from_cache",
          "args": [
            "ci",
            "block"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_remove_block_from_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "571-596",
          "snippet": "static void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ocfs2_uptodate_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_remove_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t     struct buffer_head *bh)\n{\n\tsector_t block = bh->b_blocknr;\n\n\tocfs2_remove_block_from_cache(ci, block);\n}"
  },
  {
    "function_name": "ocfs2_remove_block_from_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "571-596",
    "snippet": "static void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *ocfs2_uptodate_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ocfs2_uptodate_cachep",
            "item"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "93-98",
          "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_remove_metadata_tree",
          "args": [
            "ci",
            "item"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_remove_metadata_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "560-569",
          "snippet": "static void ocfs2_remove_metadata_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t       struct ocfs2_meta_cache_item *item)\n{\n\ttrace_ocfs2_remove_metadata_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)item->c_block);\n\n\trb_erase(&item->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached--;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_remove_metadata_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t       struct ocfs2_meta_cache_item *item)\n{\n\ttrace_ocfs2_remove_metadata_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)item->c_block);\n\n\trb_erase(&item->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_search_cache_tree",
          "args": [
            "ci",
            "block"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_search_cache_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "222-241",
          "snippet": "static struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_remove_metadata_array",
          "args": [
            "ci",
            "index"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_remove_metadata_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "535-557",
          "snippet": "static void ocfs2_remove_metadata_array(struct ocfs2_caching_info *ci,\n\t\t\t\t\tint index)\n{\n\tsector_t *array = ci->ci_cache.ci_array;\n\tint bytes;\n\n\tBUG_ON(index < 0 || index >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\tBUG_ON(index >= ci->ci_num_cached);\n\tBUG_ON(!ci->ci_num_cached);\n\n\ttrace_ocfs2_remove_metadata_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tindex, ci->ci_num_cached);\n\n\tci->ci_num_cached--;\n\n\t/* don't need to copy if the array is now empty, or if we\n\t * removed at the tail */\n\tif (ci->ci_num_cached && index < ci->ci_num_cached) {\n\t\tbytes = sizeof(sector_t) * (ci->ci_num_cached - index);\n\t\tmemmove(&array[index], &array[index + 1], bytes);\n\t}\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_remove_metadata_array(struct ocfs2_caching_info *ci,\n\t\t\t\t\tint index)\n{\n\tsector_t *array = ci->ci_cache.ci_array;\n\tint bytes;\n\n\tBUG_ON(index < 0 || index >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\tBUG_ON(index >= ci->ci_num_cached);\n\tBUG_ON(!ci->ci_num_cached);\n\n\ttrace_ocfs2_remove_metadata_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tindex, ci->ci_num_cached);\n\n\tci->ci_num_cached--;\n\n\t/* don't need to copy if the array is now empty, or if we\n\t * removed at the tail */\n\tif (ci->ci_num_cached && index < ci->ci_num_cached) {\n\t\tbytes = sizeof(sector_t) * (ci->ci_num_cached - index);\n\t\tmemmove(&array[index], &array[index + 1], bytes);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_search_cache_array",
          "args": [
            "ci",
            "block"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_search_cache_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "207-218",
          "snippet": "static int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_remove_block_from_cache",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long) block",
            "ci->ci_num_cached",
            "ci->ci_flags"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_lock",
          "args": [
            "ci"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "86-91",
          "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic void ocfs2_remove_block_from_cache(struct ocfs2_caching_info *ci,\n\t\t\t\t\t  sector_t block)\n{\n\tint index;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\ttrace_ocfs2_remove_block_from_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) block, ci->ci_num_cached,\n\t\tci->ci_flags);\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\tindex = ocfs2_search_cache_array(ci, block);\n\t\tif (index != -1)\n\t\t\tocfs2_remove_metadata_array(ci, index);\n\t} else {\n\t\titem = ocfs2_search_cache_tree(ci, block);\n\t\tif (item)\n\t\t\tocfs2_remove_metadata_tree(ci, item);\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\tif (item)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n}"
  },
  {
    "function_name": "ocfs2_remove_metadata_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "560-569",
    "snippet": "static void ocfs2_remove_metadata_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t       struct ocfs2_meta_cache_item *item)\n{\n\ttrace_ocfs2_remove_metadata_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)item->c_block);\n\n\trb_erase(&item->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached--;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&item->c_node",
            "&ci->ci_cache.ci_tree"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_remove_metadata_tree",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long)item->c_block"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_remove_metadata_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t       struct ocfs2_meta_cache_item *item)\n{\n\ttrace_ocfs2_remove_metadata_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)item->c_block);\n\n\trb_erase(&item->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached--;\n}"
  },
  {
    "function_name": "ocfs2_remove_metadata_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "535-557",
    "snippet": "static void ocfs2_remove_metadata_array(struct ocfs2_caching_info *ci,\n\t\t\t\t\tint index)\n{\n\tsector_t *array = ci->ci_cache.ci_array;\n\tint bytes;\n\n\tBUG_ON(index < 0 || index >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\tBUG_ON(index >= ci->ci_num_cached);\n\tBUG_ON(!ci->ci_num_cached);\n\n\ttrace_ocfs2_remove_metadata_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tindex, ci->ci_num_cached);\n\n\tci->ci_num_cached--;\n\n\t/* don't need to copy if the array is now empty, or if we\n\t * removed at the tail */\n\tif (ci->ci_num_cached && index < ci->ci_num_cached) {\n\t\tbytes = sizeof(sector_t) * (ci->ci_num_cached - index);\n\t\tmemmove(&array[index], &array[index + 1], bytes);\n\t}\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "&array[index]",
            "&array[index + 1]",
            "bytes"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_remove_metadata_array",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "index",
            "ci->ci_num_cached"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci->ci_num_cached"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "index >= ci->ci_num_cached"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "index < 0 || index >= OCFS2_CACHE_INFO_MAX_ARRAY"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_remove_metadata_array(struct ocfs2_caching_info *ci,\n\t\t\t\t\tint index)\n{\n\tsector_t *array = ci->ci_cache.ci_array;\n\tint bytes;\n\n\tBUG_ON(index < 0 || index >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\tBUG_ON(index >= ci->ci_num_cached);\n\tBUG_ON(!ci->ci_num_cached);\n\n\ttrace_ocfs2_remove_metadata_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tindex, ci->ci_num_cached);\n\n\tci->ci_num_cached--;\n\n\t/* don't need to copy if the array is now empty, or if we\n\t * removed at the tail */\n\tif (ci->ci_num_cached && index < ci->ci_num_cached) {\n\t\tbytes = sizeof(sector_t) * (ci->ci_num_cached - index);\n\t\tmemmove(&array[index], &array[index + 1], bytes);\n\t}\n}"
  },
  {
    "function_name": "ocfs2_set_new_buffer_uptodate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "521-532",
    "snippet": "void ocfs2_set_new_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t   struct buffer_head *bh)\n{\n\t/* This should definitely *not* exist in our cache */\n\tBUG_ON(ocfs2_buffer_cached(ci, bh));\n\n\tset_buffer_uptodate(bh);\n\n\tocfs2_metadata_cache_io_lock(ci);\n\tocfs2_set_buffer_uptodate(ci, bh);\n\tocfs2_metadata_cache_io_unlock(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_io_unlock",
          "args": [
            "ci"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_io_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "107-112",
          "snippet": "void ocfs2_metadata_cache_io_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_io_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_set_buffer_uptodate",
          "args": [
            "ci",
            "bh"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "483-516",
          "snippet": "void ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint expand;\n\n\t/* The block may very well exist in our cache already, so avoid\n\t * doing any more work in that case. */\n\tif (ocfs2_buffer_cached(ci, bh))\n\t\treturn;\n\n\ttrace_ocfs2_set_buffer_uptodate_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)bh->b_blocknr);\n\n\t/* No need to recheck under spinlock - insertion is guarded by\n\t * co_io_lock() */\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Fast case - it's an array and there's a free\n\t\t * spot. */\n\t\tocfs2_append_cache_array(ci, bh->b_blocknr);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\treturn;\n\t}\n\n\texpand = 0;\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\t/* We need to bump things up to a tree. */\n\t\texpand = 1;\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\t__ocfs2_set_buffer_uptodate(ci, bh->b_blocknr, expand);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint expand;\n\n\t/* The block may very well exist in our cache already, so avoid\n\t * doing any more work in that case. */\n\tif (ocfs2_buffer_cached(ci, bh))\n\t\treturn;\n\n\ttrace_ocfs2_set_buffer_uptodate_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)bh->b_blocknr);\n\n\t/* No need to recheck under spinlock - insertion is guarded by\n\t * co_io_lock() */\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Fast case - it's an array and there's a free\n\t\t * spot. */\n\t\tocfs2_append_cache_array(ci, bh->b_blocknr);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\treturn;\n\t}\n\n\texpand = 0;\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\t/* We need to bump things up to a tree. */\n\t\texpand = 1;\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\t__ocfs2_set_buffer_uptodate(ci, bh->b_blocknr, expand);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_io_lock",
          "args": [
            "ci"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_io_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "100-105",
          "snippet": "void ocfs2_metadata_cache_io_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_io_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_lock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "ocfs2_buffer_cached(ci, bh)"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_buffer_cached",
          "args": [
            "ci",
            "bh"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_buffer_cached",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "243-266",
          "snippet": "static int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_set_new_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t   struct buffer_head *bh)\n{\n\t/* This should definitely *not* exist in our cache */\n\tBUG_ON(ocfs2_buffer_cached(ci, bh));\n\n\tset_buffer_uptodate(bh);\n\n\tocfs2_metadata_cache_io_lock(ci);\n\tocfs2_set_buffer_uptodate(ci, bh);\n\tocfs2_metadata_cache_io_unlock(ci);\n}"
  },
  {
    "function_name": "ocfs2_set_buffer_uptodate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "483-516",
    "snippet": "void ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint expand;\n\n\t/* The block may very well exist in our cache already, so avoid\n\t * doing any more work in that case. */\n\tif (ocfs2_buffer_cached(ci, bh))\n\t\treturn;\n\n\ttrace_ocfs2_set_buffer_uptodate_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)bh->b_blocknr);\n\n\t/* No need to recheck under spinlock - insertion is guarded by\n\t * co_io_lock() */\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Fast case - it's an array and there's a free\n\t\t * spot. */\n\t\tocfs2_append_cache_array(ci, bh->b_blocknr);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\treturn;\n\t}\n\n\texpand = 0;\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\t/* We need to bump things up to a tree. */\n\t\texpand = 1;\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\t__ocfs2_set_buffer_uptodate(ci, bh->b_blocknr, expand);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__ocfs2_set_buffer_uptodate",
          "args": [
            "ci",
            "bh->b_blocknr",
            "expand"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "400-463",
          "snippet": "static void __ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t\tsector_t block,\n\t\t\t\t\tint expand_tree)\n{\n\tint i;\n\tstruct ocfs2_meta_cache_item *new = NULL;\n\tstruct ocfs2_meta_cache_item *tree[OCFS2_CACHE_INFO_MAX_ARRAY] =\n\t\t{ NULL, };\n\n\ttrace_ocfs2_set_buffer_uptodate(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, expand_tree);\n\n\tnew = kmem_cache_alloc(ocfs2_uptodate_cachep, GFP_NOFS);\n\tif (!new) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn;\n\t}\n\tnew->c_block = block;\n\n\tif (expand_tree) {\n\t\t/* Do *not* allocate an array here - the removal code\n\t\t * has no way of tracking that. */\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t\ttree[i] = kmem_cache_alloc(ocfs2_uptodate_cachep,\n\t\t\t\t\t\t   GFP_NOFS);\n\t\t\tif (!tree[i]) {\n\t\t\t\tmlog_errno(-ENOMEM);\n\t\t\t\tgoto out_free;\n\t\t\t}\n\n\t\t\t/* These are initialized in ocfs2_expand_cache! */\n\t\t}\n\t}\n\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Ok, items were removed from the cache in between\n\t\t * locks. Detect this and revert back to the fast path */\n\t\tocfs2_append_cache_array(ci, block);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\tgoto out_free;\n\t}\n\n\tif (expand_tree)\n\t\tocfs2_expand_cache(ci, tree);\n\n\t__ocfs2_insert_cache_tree(ci, new);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tnew = NULL;\nout_free:\n\tif (new)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, new);\n\n\t/* If these were used, then ocfs2_expand_cache re-set them to\n\t * NULL for us. */\n\tif (tree[0]) {\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\t\tif (tree[i])\n\t\t\t\tkmem_cache_free(ocfs2_uptodate_cachep,\n\t\t\t\t\t\ttree[i]);\n\t}\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ocfs2_uptodate_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic void __ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t\tsector_t block,\n\t\t\t\t\tint expand_tree)\n{\n\tint i;\n\tstruct ocfs2_meta_cache_item *new = NULL;\n\tstruct ocfs2_meta_cache_item *tree[OCFS2_CACHE_INFO_MAX_ARRAY] =\n\t\t{ NULL, };\n\n\ttrace_ocfs2_set_buffer_uptodate(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, expand_tree);\n\n\tnew = kmem_cache_alloc(ocfs2_uptodate_cachep, GFP_NOFS);\n\tif (!new) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn;\n\t}\n\tnew->c_block = block;\n\n\tif (expand_tree) {\n\t\t/* Do *not* allocate an array here - the removal code\n\t\t * has no way of tracking that. */\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t\ttree[i] = kmem_cache_alloc(ocfs2_uptodate_cachep,\n\t\t\t\t\t\t   GFP_NOFS);\n\t\t\tif (!tree[i]) {\n\t\t\t\tmlog_errno(-ENOMEM);\n\t\t\t\tgoto out_free;\n\t\t\t}\n\n\t\t\t/* These are initialized in ocfs2_expand_cache! */\n\t\t}\n\t}\n\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Ok, items were removed from the cache in between\n\t\t * locks. Detect this and revert back to the fast path */\n\t\tocfs2_append_cache_array(ci, block);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\tgoto out_free;\n\t}\n\n\tif (expand_tree)\n\t\tocfs2_expand_cache(ci, tree);\n\n\t__ocfs2_insert_cache_tree(ci, new);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tnew = NULL;\nout_free:\n\tif (new)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, new);\n\n\t/* If these were used, then ocfs2_expand_cache re-set them to\n\t * NULL for us. */\n\tif (tree[0]) {\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\t\tif (tree[i])\n\t\t\t\tkmem_cache_free(ocfs2_uptodate_cachep,\n\t\t\t\t\t\ttree[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "93-98",
          "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_append_cache_array",
          "args": [
            "ci",
            "bh->b_blocknr"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_append_cache_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "303-314",
          "snippet": "static void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_insert_can_use_array",
          "args": [
            "ci"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_insert_can_use_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "354-358",
          "snippet": "static inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_lock",
          "args": [
            "ci"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "86-91",
          "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_set_buffer_uptodate_begin",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long)bh->b_blocknr"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_buffer_cached",
          "args": [
            "ci",
            "bh"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_buffer_cached",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "243-266",
          "snippet": "static int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint expand;\n\n\t/* The block may very well exist in our cache already, so avoid\n\t * doing any more work in that case. */\n\tif (ocfs2_buffer_cached(ci, bh))\n\t\treturn;\n\n\ttrace_ocfs2_set_buffer_uptodate_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)bh->b_blocknr);\n\n\t/* No need to recheck under spinlock - insertion is guarded by\n\t * co_io_lock() */\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Fast case - it's an array and there's a free\n\t\t * spot. */\n\t\tocfs2_append_cache_array(ci, bh->b_blocknr);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\treturn;\n\t}\n\n\texpand = 0;\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE) {\n\t\t/* We need to bump things up to a tree. */\n\t\texpand = 1;\n\t}\n\tocfs2_metadata_cache_unlock(ci);\n\n\t__ocfs2_set_buffer_uptodate(ci, bh->b_blocknr, expand);\n}"
  },
  {
    "function_name": "__ocfs2_set_buffer_uptodate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "400-463",
    "snippet": "static void __ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t\tsector_t block,\n\t\t\t\t\tint expand_tree)\n{\n\tint i;\n\tstruct ocfs2_meta_cache_item *new = NULL;\n\tstruct ocfs2_meta_cache_item *tree[OCFS2_CACHE_INFO_MAX_ARRAY] =\n\t\t{ NULL, };\n\n\ttrace_ocfs2_set_buffer_uptodate(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, expand_tree);\n\n\tnew = kmem_cache_alloc(ocfs2_uptodate_cachep, GFP_NOFS);\n\tif (!new) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn;\n\t}\n\tnew->c_block = block;\n\n\tif (expand_tree) {\n\t\t/* Do *not* allocate an array here - the removal code\n\t\t * has no way of tracking that. */\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t\ttree[i] = kmem_cache_alloc(ocfs2_uptodate_cachep,\n\t\t\t\t\t\t   GFP_NOFS);\n\t\t\tif (!tree[i]) {\n\t\t\t\tmlog_errno(-ENOMEM);\n\t\t\t\tgoto out_free;\n\t\t\t}\n\n\t\t\t/* These are initialized in ocfs2_expand_cache! */\n\t\t}\n\t}\n\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Ok, items were removed from the cache in between\n\t\t * locks. Detect this and revert back to the fast path */\n\t\tocfs2_append_cache_array(ci, block);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\tgoto out_free;\n\t}\n\n\tif (expand_tree)\n\t\tocfs2_expand_cache(ci, tree);\n\n\t__ocfs2_insert_cache_tree(ci, new);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tnew = NULL;\nout_free:\n\tif (new)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, new);\n\n\t/* If these were used, then ocfs2_expand_cache re-set them to\n\t * NULL for us. */\n\tif (tree[0]) {\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\t\tif (tree[i])\n\t\t\t\tkmem_cache_free(ocfs2_uptodate_cachep,\n\t\t\t\t\t\ttree[i]);\n\t}\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *ocfs2_uptodate_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ocfs2_uptodate_cachep",
            "tree[i]"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ocfs2_uptodate_cachep",
            "new"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "93-98",
          "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__ocfs2_insert_cache_tree",
          "args": [
            "ci",
            "new"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_insert_cache_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "319-351",
          "snippet": "static void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_expand_cache",
          "args": [
            "ci",
            "tree"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_expand_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "365-396",
          "snippet": "static void ocfs2_expand_cache(struct ocfs2_caching_info *ci,\n\t\t\t       struct ocfs2_meta_cache_item **tree)\n{\n\tint i;\n\n\tmlog_bug_on_msg(ci->ci_num_cached != OCFS2_CACHE_INFO_MAX_ARRAY,\n\t\t\t\"Owner %llu, num cached = %u, should be %u\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t\tci->ci_num_cached, OCFS2_CACHE_INFO_MAX_ARRAY);\n\tmlog_bug_on_msg(!(ci->ci_flags & OCFS2_CACHE_FL_INLINE),\n\t\t\t\"Owner %llu not marked as inline anymore!\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci));\n\n\t/* Be careful to initialize the tree members *first* because\n\t * once the ci_tree is used, the array is junk... */\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\ttree[i]->c_block = ci->ci_cache.ci_array[i];\n\n\tci->ci_flags &= ~OCFS2_CACHE_FL_INLINE;\n\tci->ci_cache.ci_tree = RB_ROOT;\n\t/* this will be set again by __ocfs2_insert_cache_tree */\n\tci->ci_num_cached = 0;\n\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t__ocfs2_insert_cache_tree(ci, tree[i]);\n\t\ttree[i] = NULL;\n\t}\n\n\ttrace_ocfs2_expand_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tci->ci_flags, ci->ci_num_cached);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_expand_cache(struct ocfs2_caching_info *ci,\n\t\t\t       struct ocfs2_meta_cache_item **tree)\n{\n\tint i;\n\n\tmlog_bug_on_msg(ci->ci_num_cached != OCFS2_CACHE_INFO_MAX_ARRAY,\n\t\t\t\"Owner %llu, num cached = %u, should be %u\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t\tci->ci_num_cached, OCFS2_CACHE_INFO_MAX_ARRAY);\n\tmlog_bug_on_msg(!(ci->ci_flags & OCFS2_CACHE_FL_INLINE),\n\t\t\t\"Owner %llu not marked as inline anymore!\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci));\n\n\t/* Be careful to initialize the tree members *first* because\n\t * once the ci_tree is used, the array is junk... */\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\ttree[i]->c_block = ci->ci_cache.ci_array[i];\n\n\tci->ci_flags &= ~OCFS2_CACHE_FL_INLINE;\n\tci->ci_cache.ci_tree = RB_ROOT;\n\t/* this will be set again by __ocfs2_insert_cache_tree */\n\tci->ci_num_cached = 0;\n\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t__ocfs2_insert_cache_tree(ci, tree[i]);\n\t\ttree[i] = NULL;\n\t}\n\n\ttrace_ocfs2_expand_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tci->ci_flags, ci->ci_num_cached);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_append_cache_array",
          "args": [
            "ci",
            "block"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_append_cache_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "303-314",
          "snippet": "static void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_insert_can_use_array",
          "args": [
            "ci"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_insert_can_use_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "354-358",
          "snippet": "static inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_lock",
          "args": [
            "ci"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "86-91",
          "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "ocfs2_uptodate_cachep",
            "GFP_NOFS"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_set_buffer_uptodate",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long)block",
            "expand_tree"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic void __ocfs2_set_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t\t\tsector_t block,\n\t\t\t\t\tint expand_tree)\n{\n\tint i;\n\tstruct ocfs2_meta_cache_item *new = NULL;\n\tstruct ocfs2_meta_cache_item *tree[OCFS2_CACHE_INFO_MAX_ARRAY] =\n\t\t{ NULL, };\n\n\ttrace_ocfs2_set_buffer_uptodate(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, expand_tree);\n\n\tnew = kmem_cache_alloc(ocfs2_uptodate_cachep, GFP_NOFS);\n\tif (!new) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn;\n\t}\n\tnew->c_block = block;\n\n\tif (expand_tree) {\n\t\t/* Do *not* allocate an array here - the removal code\n\t\t * has no way of tracking that. */\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t\ttree[i] = kmem_cache_alloc(ocfs2_uptodate_cachep,\n\t\t\t\t\t\t   GFP_NOFS);\n\t\t\tif (!tree[i]) {\n\t\t\t\tmlog_errno(-ENOMEM);\n\t\t\t\tgoto out_free;\n\t\t\t}\n\n\t\t\t/* These are initialized in ocfs2_expand_cache! */\n\t\t}\n\t}\n\n\tocfs2_metadata_cache_lock(ci);\n\tif (ocfs2_insert_can_use_array(ci)) {\n\t\t/* Ok, items were removed from the cache in between\n\t\t * locks. Detect this and revert back to the fast path */\n\t\tocfs2_append_cache_array(ci, block);\n\t\tocfs2_metadata_cache_unlock(ci);\n\t\tgoto out_free;\n\t}\n\n\tif (expand_tree)\n\t\tocfs2_expand_cache(ci, tree);\n\n\t__ocfs2_insert_cache_tree(ci, new);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tnew = NULL;\nout_free:\n\tif (new)\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, new);\n\n\t/* If these were used, then ocfs2_expand_cache re-set them to\n\t * NULL for us. */\n\tif (tree[0]) {\n\t\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\t\tif (tree[i])\n\t\t\t\tkmem_cache_free(ocfs2_uptodate_cachep,\n\t\t\t\t\t\ttree[i]);\n\t}\n}"
  },
  {
    "function_name": "ocfs2_expand_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "365-396",
    "snippet": "static void ocfs2_expand_cache(struct ocfs2_caching_info *ci,\n\t\t\t       struct ocfs2_meta_cache_item **tree)\n{\n\tint i;\n\n\tmlog_bug_on_msg(ci->ci_num_cached != OCFS2_CACHE_INFO_MAX_ARRAY,\n\t\t\t\"Owner %llu, num cached = %u, should be %u\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t\tci->ci_num_cached, OCFS2_CACHE_INFO_MAX_ARRAY);\n\tmlog_bug_on_msg(!(ci->ci_flags & OCFS2_CACHE_FL_INLINE),\n\t\t\t\"Owner %llu not marked as inline anymore!\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci));\n\n\t/* Be careful to initialize the tree members *first* because\n\t * once the ci_tree is used, the array is junk... */\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\ttree[i]->c_block = ci->ci_cache.ci_array[i];\n\n\tci->ci_flags &= ~OCFS2_CACHE_FL_INLINE;\n\tci->ci_cache.ci_tree = RB_ROOT;\n\t/* this will be set again by __ocfs2_insert_cache_tree */\n\tci->ci_num_cached = 0;\n\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t__ocfs2_insert_cache_tree(ci, tree[i]);\n\t\ttree[i] = NULL;\n\t}\n\n\ttrace_ocfs2_expand_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tci->ci_flags, ci->ci_num_cached);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_ocfs2_expand_cache",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "ci->ci_flags",
            "ci->ci_num_cached"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__ocfs2_insert_cache_tree",
          "args": [
            "ci",
            "tree[i]"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "__ocfs2_insert_cache_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "319-351",
          "snippet": "static void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "!(ci->ci_flags & OCFS2_CACHE_FL_INLINE)",
            "\"Owner %llu not marked as inline anymore!\\n\"",
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_bug_on_msg",
          "args": [
            "ci->ci_num_cached != OCFS2_CACHE_INFO_MAX_ARRAY",
            "\"Owner %llu, num cached = %u, should be %u\\n\"",
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "ci->ci_num_cached",
            "OCFS2_CACHE_INFO_MAX_ARRAY"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_expand_cache(struct ocfs2_caching_info *ci,\n\t\t\t       struct ocfs2_meta_cache_item **tree)\n{\n\tint i;\n\n\tmlog_bug_on_msg(ci->ci_num_cached != OCFS2_CACHE_INFO_MAX_ARRAY,\n\t\t\t\"Owner %llu, num cached = %u, should be %u\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t\tci->ci_num_cached, OCFS2_CACHE_INFO_MAX_ARRAY);\n\tmlog_bug_on_msg(!(ci->ci_flags & OCFS2_CACHE_FL_INLINE),\n\t\t\t\"Owner %llu not marked as inline anymore!\\n\",\n\t\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci));\n\n\t/* Be careful to initialize the tree members *first* because\n\t * once the ci_tree is used, the array is junk... */\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++)\n\t\ttree[i]->c_block = ci->ci_cache.ci_array[i];\n\n\tci->ci_flags &= ~OCFS2_CACHE_FL_INLINE;\n\tci->ci_cache.ci_tree = RB_ROOT;\n\t/* this will be set again by __ocfs2_insert_cache_tree */\n\tci->ci_num_cached = 0;\n\n\tfor (i = 0; i < OCFS2_CACHE_INFO_MAX_ARRAY; i++) {\n\t\t__ocfs2_insert_cache_tree(ci, tree[i]);\n\t\ttree[i] = NULL;\n\t}\n\n\ttrace_ocfs2_expand_cache(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tci->ci_flags, ci->ci_num_cached);\n}"
  },
  {
    "function_name": "ocfs2_insert_can_use_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "354-358",
    "snippet": "static inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_insert_can_use_array(struct ocfs2_caching_info *ci)\n{\n\treturn (ci->ci_flags & OCFS2_CACHE_FL_INLINE) &&\n\t\t(ci->ci_num_cached < OCFS2_CACHE_INFO_MAX_ARRAY);\n}"
  },
  {
    "function_name": "__ocfs2_insert_cache_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "319-351",
    "snippet": "static void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "&new->c_node",
            "&ci->ci_cache.ci_tree"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "&new->c_node",
            "parent",
            "p"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Duplicate block %llu cached!\\n\"",
            "(unsigned long long) block"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "mlog_show",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/masklog.c",
          "lines": "107-113",
          "snippet": "static ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}",
          "includes": [
            "#include \"masklog.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"masklog.h\"\n#include <asm/uaccess.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic ssize_t mlog_show(struct kobject *obj, struct attribute *attr,\n\t\t\t char *buf)\n{\n\tstruct mlog_attribute *mlog_attr = to_mlog_attr(attr);\n\n\treturn mlog_mask_show(mlog_attr->mask, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "parent",
            "structocfs2_meta_cache_item",
            "c_node"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_insert_cache_tree",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long)block",
            "ci->ci_num_cached"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void __ocfs2_insert_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\t\t      struct ocfs2_meta_cache_item *new)\n{\n\tsector_t block = new->c_block;\n\tstruct rb_node *parent = NULL;\n\tstruct rb_node **p = &ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *tmp;\n\n\ttrace_ocfs2_insert_cache_tree(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\twhile(*p) {\n\t\tparent = *p;\n\n\t\ttmp = rb_entry(parent, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < tmp->c_block)\n\t\t\tp = &(*p)->rb_left;\n\t\telse if (block > tmp->c_block)\n\t\t\tp = &(*p)->rb_right;\n\t\telse {\n\t\t\t/* This should never happen! */\n\t\t\tmlog(ML_ERROR, \"Duplicate block %llu cached!\\n\",\n\t\t\t     (unsigned long long) block);\n\t\t\tBUG();\n\t\t}\n\t}\n\n\trb_link_node(&new->c_node, parent, p);\n\trb_insert_color(&new->c_node, &ci->ci_cache.ci_tree);\n\tci->ci_num_cached++;\n}"
  },
  {
    "function_name": "ocfs2_append_cache_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "303-314",
    "snippet": "static void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_ocfs2_append_cache_array",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long)block",
            "ci->ci_num_cached"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_append_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t     sector_t block)\n{\n\tBUG_ON(ci->ci_num_cached >= OCFS2_CACHE_INFO_MAX_ARRAY);\n\n\ttrace_ocfs2_append_cache_array(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long)block, ci->ci_num_cached);\n\n\tci->ci_cache.ci_array[ci->ci_num_cached] = block;\n\tci->ci_num_cached++;\n}"
  },
  {
    "function_name": "ocfs2_buffer_read_ahead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "296-300",
    "snippet": "int ocfs2_buffer_read_ahead(struct ocfs2_caching_info *ci,\n\t\t\t    struct buffer_head *bh)\n{\n\treturn buffer_locked(bh) && ocfs2_buffer_cached(ci, bh);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_buffer_cached",
          "args": [
            "ci",
            "bh"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_buffer_cached",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "243-266",
          "snippet": "static int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_locked",
          "args": [
            "bh"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nint ocfs2_buffer_read_ahead(struct ocfs2_caching_info *ci,\n\t\t\t    struct buffer_head *bh)\n{\n\treturn buffer_locked(bh) && ocfs2_buffer_cached(ci, bh);\n}"
  },
  {
    "function_name": "ocfs2_buffer_uptodate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "273-290",
    "snippet": "int ocfs2_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t  struct buffer_head *bh)\n{\n\t/* Doesn't matter if the bh is in our cache or not -- if it's\n\t * not marked uptodate then we know it can't have correct\n\t * data. */\n\tif (!buffer_uptodate(bh))\n\t\treturn 0;\n\n\t/* OCFS2 does not allow multiple nodes to be changing the same\n\t * block at the same time. */\n\tif (buffer_jbd(bh))\n\t\treturn 1;\n\n\t/* Ok, locally the buffer is marked as up to date, now search\n\t * our cache to see if we can trust that. */\n\treturn ocfs2_buffer_cached(ci, bh);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_buffer_cached",
          "args": [
            "ci",
            "bh"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_buffer_cached",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "243-266",
          "snippet": "static int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_jbd",
          "args": [
            "bh"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nint ocfs2_buffer_uptodate(struct ocfs2_caching_info *ci,\n\t\t\t  struct buffer_head *bh)\n{\n\t/* Doesn't matter if the bh is in our cache or not -- if it's\n\t * not marked uptodate then we know it can't have correct\n\t * data. */\n\tif (!buffer_uptodate(bh))\n\t\treturn 0;\n\n\t/* OCFS2 does not allow multiple nodes to be changing the same\n\t * block at the same time. */\n\tif (buffer_jbd(bh))\n\t\treturn 1;\n\n\t/* Ok, locally the buffer is marked as up to date, now search\n\t * our cache to see if we can trust that. */\n\treturn ocfs2_buffer_cached(ci, bh);\n}"
  },
  {
    "function_name": "ocfs2_buffer_cached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "243-266",
    "snippet": "static int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_ocfs2_buffer_cached_end",
          "args": [
            "index",
            "item"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "93-98",
          "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_search_cache_tree",
          "args": [
            "ci",
            "bh->b_blocknr"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_search_cache_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "222-241",
          "snippet": "static struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_search_cache_array",
          "args": [
            "ci",
            "bh->b_blocknr"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_search_cache_array",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "207-218",
          "snippet": "static int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_buffer_cached_begin",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "(unsigned long long) bh->b_blocknr",
            "!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_lock",
          "args": [
            "ci"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "86-91",
          "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_buffer_cached(struct ocfs2_caching_info *ci,\n\t\t\t       struct buffer_head *bh)\n{\n\tint index = -1;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\tocfs2_metadata_cache_lock(ci);\n\n\ttrace_ocfs2_buffer_cached_begin(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t(unsigned long long) bh->b_blocknr,\n\t\t!!(ci->ci_flags & OCFS2_CACHE_FL_INLINE));\n\n\tif (ci->ci_flags & OCFS2_CACHE_FL_INLINE)\n\t\tindex = ocfs2_search_cache_array(ci, bh->b_blocknr);\n\telse\n\t\titem = ocfs2_search_cache_tree(ci, bh->b_blocknr);\n\n\tocfs2_metadata_cache_unlock(ci);\n\n\ttrace_ocfs2_buffer_cached_end(index, item);\n\n\treturn (index != -1) || (item != NULL);\n}"
  },
  {
    "function_name": "ocfs2_search_cache_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "222-241",
    "snippet": "static struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "n",
            "structocfs2_meta_cache_item",
            "c_node"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct ocfs2_meta_cache_item *\nocfs2_search_cache_tree(struct ocfs2_caching_info *ci,\n\t\t\tsector_t block)\n{\n\tstruct rb_node * n = ci->ci_cache.ci_tree.rb_node;\n\tstruct ocfs2_meta_cache_item *item = NULL;\n\n\twhile (n) {\n\t\titem = rb_entry(n, struct ocfs2_meta_cache_item, c_node);\n\n\t\tif (block < item->c_block)\n\t\t\tn = n->rb_left;\n\t\telse if (block > item->c_block)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\treturn item;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "ocfs2_search_cache_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "207-218",
    "snippet": "static int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic int ocfs2_search_cache_array(struct ocfs2_caching_info *ci,\n\t\t\t\t    sector_t item)\n{\n\tint i;\n\n\tfor (i = 0; i < ci->ci_num_cached; i++) {\n\t\tif (item == ci->ci_cache.ci_array[i])\n\t\t\treturn i;\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_purge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "171-203",
    "snippet": "void ocfs2_metadata_cache_purge(struct ocfs2_caching_info *ci)\n{\n\tunsigned int tree, to_purge, purged;\n\tstruct rb_root root = RB_ROOT;\n\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tocfs2_metadata_cache_lock(ci);\n\ttree = !(ci->ci_flags & OCFS2_CACHE_FL_INLINE);\n\tto_purge = ci->ci_num_cached;\n\n\ttrace_ocfs2_metadata_cache_purge(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tto_purge, tree);\n\n\t/* If we're a tree, save off the root so that we can safely\n\t * initialize the cache. We do the work to free tree members\n\t * without the spinlock. */\n\tif (tree)\n\t\troot = ci->ci_cache.ci_tree;\n\n\tocfs2_metadata_cache_reset(ci, 0);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tpurged = ocfs2_purge_copied_metadata_tree(&root);\n\t/* If possible, track the number wiped so that we can more\n\t * easily detect counting errors. Unfortunately, this is only\n\t * meaningful for trees. */\n\tif (tree && purged != to_purge)\n\t\tmlog(ML_ERROR, \"Owner %llu, count = %u, purged = %u\\n\",\n\t\t     (unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t     to_purge, purged);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog",
          "args": [
            "ML_ERROR",
            "\"Owner %llu, count = %u, purged = %u\\n\"",
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "to_purge",
            "purged"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_owner",
          "args": [
            "ci"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "72-77",
          "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_purge_copied_metadata_tree",
          "args": [
            "&root"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_purge_copied_metadata_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "145-163",
          "snippet": "static unsigned int ocfs2_purge_copied_metadata_tree(struct rb_root *root)\n{\n\tunsigned int purged = 0;\n\tstruct rb_node *node;\n\tstruct ocfs2_meta_cache_item *item;\n\n\twhile ((node = rb_last(root)) != NULL) {\n\t\titem = rb_entry(node, struct ocfs2_meta_cache_item, c_node);\n\n\t\ttrace_ocfs2_purge_copied_metadata_tree(\n\t\t\t\t\t(unsigned long long) item->c_block);\n\n\t\trb_erase(&item->c_node, root);\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n\n\t\tpurged++;\n\t}\n\treturn purged;\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ocfs2_uptodate_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic unsigned int ocfs2_purge_copied_metadata_tree(struct rb_root *root)\n{\n\tunsigned int purged = 0;\n\tstruct rb_node *node;\n\tstruct ocfs2_meta_cache_item *item;\n\n\twhile ((node = rb_last(root)) != NULL) {\n\t\titem = rb_entry(node, struct ocfs2_meta_cache_item, c_node);\n\n\t\ttrace_ocfs2_purge_copied_metadata_tree(\n\t\t\t\t\t(unsigned long long) item->c_block);\n\n\t\trb_erase(&item->c_node, root);\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n\n\t\tpurged++;\n\t}\n\treturn purged;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "93-98",
          "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_reset",
          "args": [
            "ci",
            "0"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "115-125",
          "snippet": "static void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_metadata_cache_purge",
          "args": [
            "(unsigned long long)ocfs2_metadata_cache_owner(ci)",
            "to_purge",
            "tree"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_lock",
          "args": [
            "ci"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "86-91",
          "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_purge(struct ocfs2_caching_info *ci)\n{\n\tunsigned int tree, to_purge, purged;\n\tstruct rb_root root = RB_ROOT;\n\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tocfs2_metadata_cache_lock(ci);\n\ttree = !(ci->ci_flags & OCFS2_CACHE_FL_INLINE);\n\tto_purge = ci->ci_num_cached;\n\n\ttrace_ocfs2_metadata_cache_purge(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tto_purge, tree);\n\n\t/* If we're a tree, save off the root so that we can safely\n\t * initialize the cache. We do the work to free tree members\n\t * without the spinlock. */\n\tif (tree)\n\t\troot = ci->ci_cache.ci_tree;\n\n\tocfs2_metadata_cache_reset(ci, 0);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tpurged = ocfs2_purge_copied_metadata_tree(&root);\n\t/* If possible, track the number wiped so that we can more\n\t * easily detect counting errors. Unfortunately, this is only\n\t * meaningful for trees. */\n\tif (tree && purged != to_purge)\n\t\tmlog(ML_ERROR, \"Owner %llu, count = %u, purged = %u\\n\",\n\t\t     (unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t     to_purge, purged);\n}"
  },
  {
    "function_name": "ocfs2_purge_copied_metadata_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "145-163",
    "snippet": "static unsigned int ocfs2_purge_copied_metadata_tree(struct rb_root *root)\n{\n\tunsigned int purged = 0;\n\tstruct rb_node *node;\n\tstruct ocfs2_meta_cache_item *item;\n\n\twhile ((node = rb_last(root)) != NULL) {\n\t\titem = rb_entry(node, struct ocfs2_meta_cache_item, c_node);\n\n\t\ttrace_ocfs2_purge_copied_metadata_tree(\n\t\t\t\t\t(unsigned long long) item->c_block);\n\n\t\trb_erase(&item->c_node, root);\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n\n\t\tpurged++;\n\t}\n\treturn purged;\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *ocfs2_uptodate_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ocfs2_uptodate_cachep",
            "item"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&item->c_node",
            "root"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_ocfs2_purge_copied_metadata_tree",
          "args": [
            "(unsigned long long) item->c_block"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "node",
            "structocfs2_meta_cache_item",
            "c_node"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_last",
          "args": [
            "root"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct kmem_cache *ocfs2_uptodate_cachep;\n\nstatic unsigned int ocfs2_purge_copied_metadata_tree(struct rb_root *root)\n{\n\tunsigned int purged = 0;\n\tstruct rb_node *node;\n\tstruct ocfs2_meta_cache_item *item;\n\n\twhile ((node = rb_last(root)) != NULL) {\n\t\titem = rb_entry(node, struct ocfs2_meta_cache_item, c_node);\n\n\t\ttrace_ocfs2_purge_copied_metadata_tree(\n\t\t\t\t\t(unsigned long long) item->c_block);\n\n\t\trb_erase(&item->c_node, root);\n\t\tkmem_cache_free(ocfs2_uptodate_cachep, item);\n\n\t\tpurged++;\n\t}\n\treturn purged;\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "136-140",
    "snippet": "void ocfs2_metadata_cache_exit(struct ocfs2_caching_info *ci)\n{\n\tocfs2_metadata_cache_purge(ci);\n\tocfs2_metadata_cache_reset(ci, 1);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_reset",
          "args": [
            "ci",
            "1"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "115-125",
          "snippet": "static void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_purge",
          "args": [
            "ci"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "171-203",
          "snippet": "void ocfs2_metadata_cache_purge(struct ocfs2_caching_info *ci)\n{\n\tunsigned int tree, to_purge, purged;\n\tstruct rb_root root = RB_ROOT;\n\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tocfs2_metadata_cache_lock(ci);\n\ttree = !(ci->ci_flags & OCFS2_CACHE_FL_INLINE);\n\tto_purge = ci->ci_num_cached;\n\n\ttrace_ocfs2_metadata_cache_purge(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tto_purge, tree);\n\n\t/* If we're a tree, save off the root so that we can safely\n\t * initialize the cache. We do the work to free tree members\n\t * without the spinlock. */\n\tif (tree)\n\t\troot = ci->ci_cache.ci_tree;\n\n\tocfs2_metadata_cache_reset(ci, 0);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tpurged = ocfs2_purge_copied_metadata_tree(&root);\n\t/* If possible, track the number wiped so that we can more\n\t * easily detect counting errors. Unfortunately, this is only\n\t * meaningful for trees. */\n\tif (tree && purged != to_purge)\n\t\tmlog(ML_ERROR, \"Owner %llu, count = %u, purged = %u\\n\",\n\t\t     (unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t     to_purge, purged);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_purge(struct ocfs2_caching_info *ci)\n{\n\tunsigned int tree, to_purge, purged;\n\tstruct rb_root root = RB_ROOT;\n\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tocfs2_metadata_cache_lock(ci);\n\ttree = !(ci->ci_flags & OCFS2_CACHE_FL_INLINE);\n\tto_purge = ci->ci_num_cached;\n\n\ttrace_ocfs2_metadata_cache_purge(\n\t\t(unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\tto_purge, tree);\n\n\t/* If we're a tree, save off the root so that we can safely\n\t * initialize the cache. We do the work to free tree members\n\t * without the spinlock. */\n\tif (tree)\n\t\troot = ci->ci_cache.ci_tree;\n\n\tocfs2_metadata_cache_reset(ci, 0);\n\tocfs2_metadata_cache_unlock(ci);\n\n\tpurged = ocfs2_purge_copied_metadata_tree(&root);\n\t/* If possible, track the number wiped so that we can more\n\t * easily detect counting errors. Unfortunately, this is only\n\t * meaningful for trees. */\n\tif (tree && purged != to_purge)\n\t\tmlog(ML_ERROR, \"Owner %llu, count = %u, purged = %u\\n\",\n\t\t     (unsigned long long)ocfs2_metadata_cache_owner(ci),\n\t\t     to_purge, purged);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_exit(struct ocfs2_caching_info *ci)\n{\n\tocfs2_metadata_cache_purge(ci);\n\tocfs2_metadata_cache_reset(ci, 1);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "127-134",
    "snippet": "void ocfs2_metadata_cache_init(struct ocfs2_caching_info *ci,\n\t\t\t       const struct ocfs2_caching_operations *ops)\n{\n\tBUG_ON(!ops);\n\n\tci->ci_ops = ops;\n\tocfs2_metadata_cache_reset(ci, 1);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_reset",
          "args": [
            "ci",
            "1"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
          "lines": "115-125",
          "snippet": "static void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ops"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_init(struct ocfs2_caching_info *ci,\n\t\t\t       const struct ocfs2_caching_operations *ops)\n{\n\tBUG_ON(!ops);\n\n\tci->ci_ops = ops;\n\tocfs2_metadata_cache_reset(ci, 1);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "115-125",
    "snippet": "static void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_reset(struct ocfs2_caching_info *ci,\n\t\t\t\t       int clear)\n{\n\tci->ci_flags |= OCFS2_CACHE_FL_INLINE;\n\tci->ci_num_cached = 0;\n\n\tif (clear) {\n\t\tci->ci_created_trans = 0;\n\t\tci->ci_last_trans = 0;\n\t}\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_io_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "107-112",
    "snippet": "void ocfs2_metadata_cache_io_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_unlock(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_io_unlock",
          "args": [
            "ci"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_io_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_unlock(ci);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_io_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "100-105",
    "snippet": "void ocfs2_metadata_cache_io_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_lock(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_io_lock",
          "args": [
            "ci"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nvoid ocfs2_metadata_cache_io_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_io_lock(ci);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "93-98",
    "snippet": "static void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_cache_unlock",
          "args": [
            "ci"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_unlock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_unlock(ci);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "86-91",
    "snippet": "static void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_cache_lock",
          "args": [
            "ci"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic void ocfs2_metadata_cache_lock(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\tci->ci_ops->co_cache_lock(ci);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_get_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "79-84",
    "snippet": "struct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_get_super",
          "args": [
            "ci"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstruct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}"
  },
  {
    "function_name": "ocfs2_metadata_cache_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/uptodate.c",
    "lines": "72-77",
    "snippet": "u64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}",
    "includes": [
      "#include \"ocfs2_trace.h\"",
      "#include \"uptodate.h\"",
      "#include \"inode.h\"",
      "#include \"ocfs2.h\"",
      "#include <cluster/masklog.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ci->ci_ops->co_owner",
          "args": [
            "ci"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!ci || !ci->ci_ops"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nu64 ocfs2_metadata_cache_owner(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_owner(ci);\n}"
  }
]