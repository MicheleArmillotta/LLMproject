[
  {
    "function_name": "o2net_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "514-537",
    "snippet": "int o2net_debugfs_init(void)\n{\n\tumode_t mode = S_IFREG|S_IRUSR;\n\n\to2net_dentry = debugfs_create_dir(O2NET_DEBUG_DIR, NULL);\n\tif (o2net_dentry)\n\t\tnst_dentry = debugfs_create_file(NST_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &nst_seq_fops);\n\tif (nst_dentry)\n\t\tsc_dentry = debugfs_create_file(SC_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &sc_seq_fops);\n\tif (sc_dentry)\n\t\tstats_dentry = debugfs_create_file(STATS_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &stats_seq_fops);\n\tif (stats_dentry)\n\t\tnodes_dentry = debugfs_create_file(NODES_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &nodes_fops);\n\tif (nodes_dentry)\n\t\treturn 0;\n\n\to2net_debugfs_exit();\n\tmlog_errno(-ENOMEM);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define NODES_DEBUG_NAME\t\"connected_nodes\"",
      "#define STATS_DEBUG_NAME\t\"stats\"",
      "#define NST_DEBUG_NAME\t\t\"send_tracking\"",
      "#define SC_DEBUG_NAME\t\t\"sock_containers\"",
      "#define O2NET_DEBUG_DIR\t\t\"o2net\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "o2net_debugfs_exit",
          "args": [],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_debugfs_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "505-512",
          "snippet": "void o2net_debugfs_exit(void)\n{\n\tdebugfs_remove(nodes_dentry);\n\tdebugfs_remove(stats_dentry);\n\tdebugfs_remove(sc_dentry);\n\tdebugfs_remove(nst_dentry);\n\tdebugfs_remove(o2net_dentry);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debugfs_exit(void)\n{\n\tdebugfs_remove(nodes_dentry);\n\tdebugfs_remove(stats_dentry);\n\tdebugfs_remove(sc_dentry);\n\tdebugfs_remove(nst_dentry);\n\tdebugfs_remove(o2net_dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "NODES_DEBUG_NAME",
            "mode",
            "o2net_dentry",
            "NULL",
            "&nodes_fops"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "O2NET_DEBUG_DIR",
            "NULL"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define NODES_DEBUG_NAME\t\"connected_nodes\"\n#define STATS_DEBUG_NAME\t\"stats\"\n#define NST_DEBUG_NAME\t\t\"send_tracking\"\n#define SC_DEBUG_NAME\t\t\"sock_containers\"\n#define O2NET_DEBUG_DIR\t\t\"o2net\"\n\nint o2net_debugfs_init(void)\n{\n\tumode_t mode = S_IFREG|S_IRUSR;\n\n\to2net_dentry = debugfs_create_dir(O2NET_DEBUG_DIR, NULL);\n\tif (o2net_dentry)\n\t\tnst_dentry = debugfs_create_file(NST_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &nst_seq_fops);\n\tif (nst_dentry)\n\t\tsc_dentry = debugfs_create_file(SC_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &sc_seq_fops);\n\tif (sc_dentry)\n\t\tstats_dentry = debugfs_create_file(STATS_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &stats_seq_fops);\n\tif (stats_dentry)\n\t\tnodes_dentry = debugfs_create_file(NODES_DEBUG_NAME, mode,\n\t\t\t\t\to2net_dentry, NULL, &nodes_fops);\n\tif (nodes_dentry)\n\t\treturn 0;\n\n\to2net_debugfs_exit();\n\tmlog_errno(-ENOMEM);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "o2net_debugfs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "505-512",
    "snippet": "void o2net_debugfs_exit(void)\n{\n\tdebugfs_remove(nodes_dentry);\n\tdebugfs_remove(stats_dentry);\n\tdebugfs_remove(sc_dentry);\n\tdebugfs_remove(nst_dentry);\n\tdebugfs_remove(o2net_dentry);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "o2net_dentry"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debugfs_exit(void)\n{\n\tdebugfs_remove(nodes_dentry);\n\tdebugfs_remove(stats_dentry);\n\tdebugfs_remove(sc_dentry);\n\tdebugfs_remove(nst_dentry);\n\tdebugfs_remove(o2net_dentry);\n}"
  },
  {
    "function_name": "o2net_debug_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "491-496",
    "snippet": "static ssize_t o2net_debug_read(struct file *file, char __user *buf,\n\t\t\t\tsize_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "nbytes",
            "ppos",
            "file->private_data",
            "i_size_read(file->f_mapping->host)"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "file->f_mapping->host"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic ssize_t o2net_debug_read(struct file *file, char __user *buf,\n\t\t\t\tsize_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}"
  },
  {
    "function_name": "o2net_debug_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "485-489",
    "snippet": "static int o2net_debug_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "file->private_data"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int o2net_debug_release(struct inode *inode, struct file *file)\n{\n\tkfree(file->private_data);\n\treturn 0;\n}"
  },
  {
    "function_name": "nodes_fop_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "470-483",
    "snippet": "static int nodes_fop_open(struct inode *inode, struct file *file)\n{\n\tchar *buf;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\ti_size_write(inode, o2net_fill_bitmap(buf, PAGE_SIZE));\n\n\tfile->private_data = buf;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "o2net_fill_bitmap(buf, PAGE_SIZE)"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2net_fill_bitmap",
          "args": [
            "buf",
            "PAGE_SIZE"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_fill_bitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "456-468",
          "snippet": "static int o2net_fill_bitmap(char *buf, int len)\n{\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint i = -1, out = 0;\n\n\to2net_fill_node_map(map, sizeof(map));\n\n\twhile ((i = find_next_bit(map, O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\n\treturn out;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int o2net_fill_bitmap(char *buf, int len)\n{\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint i = -1, out = 0;\n\n\to2net_fill_node_map(map, sizeof(map));\n\n\twhile ((i = find_next_bit(map, O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int nodes_fop_open(struct inode *inode, struct file *file)\n{\n\tchar *buf;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\ti_size_write(inode, o2net_fill_bitmap(buf, PAGE_SIZE));\n\n\tfile->private_data = buf;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "o2net_fill_bitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "456-468",
    "snippet": "static int o2net_fill_bitmap(char *buf, int len)\n{\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint i = -1, out = 0;\n\n\to2net_fill_node_map(map, sizeof(map));\n\n\twhile ((i = find_next_bit(map, O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\n\treturn out;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"\\n\""
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "PAGE_SIZE - out",
            "\"%d \"",
            "i"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "map",
            "O2NM_MAX_NODES",
            "i + 1"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2net_fill_node_map",
          "args": [
            "map",
            "sizeof(map)"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_fill_node_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "1010-1026",
          "snippet": "void o2net_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\tstruct o2net_sock_container *sc;\n\tint node, ret;\n\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemset(map, 0, bytes);\n\tfor (node = 0; node < O2NM_MAX_NODES; ++node) {\n\t\tif (!o2net_tx_can_proceed(o2net_nn_from_num(node), &sc, &ret))\n\t\t\tcontinue;\n\t\tif (!ret) {\n\t\t\tset_bit(node, map);\n\t\t\tsc_put(sc);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nvoid o2net_fill_node_map(unsigned long *map, unsigned bytes)\n{\n\tstruct o2net_sock_container *sc;\n\tint node, ret;\n\n\tBUG_ON(bytes < (BITS_TO_LONGS(O2NM_MAX_NODES) * sizeof(unsigned long)));\n\n\tmemset(map, 0, bytes);\n\tfor (node = 0; node < O2NM_MAX_NODES; ++node) {\n\t\tif (!o2net_tx_can_proceed(o2net_nn_from_num(node), &sc, &ret))\n\t\t\tcontinue;\n\t\tif (!ret) {\n\t\t\tset_bit(node, map);\n\t\t\tsc_put(sc);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BITS_TO_LONGS",
          "args": [
            "O2NM_MAX_NODES"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int o2net_fill_bitmap(char *buf, int len)\n{\n\tunsigned long map[BITS_TO_LONGS(O2NM_MAX_NODES)];\n\tint i = -1, out = 0;\n\n\to2net_fill_node_map(map, sizeof(map));\n\n\twhile ((i = find_next_bit(map, O2NM_MAX_NODES, i + 1)) < O2NM_MAX_NODES)\n\t\tout += snprintf(buf + out, PAGE_SIZE - out, \"%d \", i);\n\tout += snprintf(buf + out, PAGE_SIZE - out, \"\\n\");\n\n\treturn out;\n}"
  },
  {
    "function_name": "sc_fop_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "444-447",
    "snippet": "static int sc_fop_open(struct inode *inode, struct file *file)\n{\n\treturn sc_common_open(file, SHOW_SOCK_CONTAINERS);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define SHOW_SOCK_CONTAINERS\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc_common_open",
          "args": [
            "file",
            "SHOW_SOCK_CONTAINERS"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "sc_common_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "399-420",
          "snippet": "static int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define SHOW_SOCK_CONTAINERS\t0\n\nstatic int sc_fop_open(struct inode *inode, struct file *file)\n{\n\treturn sc_common_open(file, SHOW_SOCK_CONTAINERS);\n}"
  },
  {
    "function_name": "stats_fop_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "432-435",
    "snippet": "static int stats_fop_open(struct inode *inode, struct file *file)\n{\n\treturn sc_common_open(file, SHOW_SOCK_STATS);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define SHOW_SOCK_STATS\t\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sc_common_open",
          "args": [
            "file",
            "SHOW_SOCK_STATS"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "sc_common_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "399-420",
          "snippet": "static int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define SHOW_SOCK_STATS\t\t1\n\nstatic int stats_fop_open(struct inode *inode, struct file *file)\n{\n\treturn sc_common_open(file, SHOW_SOCK_STATS);\n}"
  },
  {
    "function_name": "sc_fop_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "422-430",
    "snippet": "static int sc_fop_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *dummy_sc = sd->dbg_sock;\n\n\to2net_debug_del_sc(dummy_sc);\n\treturn seq_release_private(inode, file);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_release_private",
          "args": [
            "inode",
            "file"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "seq_release_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "605-612",
          "snippet": "int seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2net_debug_del_sc",
          "args": [
            "dummy_sc"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_debug_del_sc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "220-225",
          "snippet": "void o2net_debug_del_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_del_init(&sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_del_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_del_init(&sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int sc_fop_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *dummy_sc = sd->dbg_sock;\n\n\to2net_debug_del_sc(dummy_sc);\n\treturn seq_release_private(inode, file);\n}"
  },
  {
    "function_name": "sc_common_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "399-420",
    "snippet": "static int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2net_debug_add_sc",
          "args": [
            "dummy_sc"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_debug_add_sc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "213-218",
          "snippet": "void o2net_debug_add_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&sc->sc_net_debug_item, &sock_containers);\n\tspin_unlock(&o2net_debug_lock);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_add_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&sc->sc_net_debug_item, &sock_containers);\n\tspin_unlock(&o2net_debug_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dummy_sc"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__seq_open_private",
          "args": [
            "file",
            "&sc_seq_ops",
            "sizeof(*sd)"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "__seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "615-638",
          "snippet": "void *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nvoid *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*dummy_sc)",
            "GFP_KERNEL"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int sc_common_open(struct file *file, int ctxt)\n{\n\tstruct o2net_sock_debug *sd;\n\tstruct o2net_sock_container *dummy_sc;\n\n\tdummy_sc = kzalloc(sizeof(*dummy_sc), GFP_KERNEL);\n\tif (!dummy_sc)\n\t\treturn -ENOMEM;\n\n\tsd = __seq_open_private(file, &sc_seq_ops, sizeof(*sd));\n\tif (!sd) {\n\t\tkfree(dummy_sc);\n\t\treturn -ENOMEM;\n\t}\n\n\tsd->dbg_ctxt = ctxt;\n\tsd->dbg_sock = dummy_sc;\n\n\to2net_debug_add_sc(dummy_sc);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "sc_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "388-390",
    "snippet": "static void sc_seq_stop(struct seq_file *seq, void *v)\n{\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void sc_seq_stop(struct seq_file *seq, void *v)\n{\n}"
  },
  {
    "function_name": "sc_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "368-386",
    "snippet": "static int sc_seq_show(struct seq_file *seq, void *v)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\n\tif (sc) {\n\t\tif (sd->dbg_ctxt == SHOW_SOCK_CONTAINERS)\n\t\t\tsc_show_sock_container(seq, sc);\n\t\telse\n\t\t\tsc_show_sock_stats(seq, sc);\n\t}\n\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define SHOW_SOCK_CONTAINERS\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc_show_sock_stats",
          "args": [
            "seq",
            "sc"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "sc_show_sock_stats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "300-313",
          "snippet": "static void sc_show_sock_stats(struct seq_file *seq,\n\t\t\t       struct o2net_sock_container *sc)\n{\n\tif (!sc)\n\t\treturn;\n\n\tseq_printf(seq, \"%d,%u,%lu,%lld,%lld,%lld,%lu,%lld\\n\", O2NET_STATS_STR_VERSION,\n\t\t   sc->sc_node->nd_num, (unsigned long)sc_send_count(sc),\n\t\t   (long long)sc_tv_acquiry_total_ns(sc),\n\t\t   (long long)sc_tv_send_total_ns(sc),\n\t\t   (long long)sc_tv_status_total_ns(sc),\n\t\t   (unsigned long)sc_recv_count(sc),\n\t\t   (long long)sc_tv_process_total_ns(sc));\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define O2NET_STATS_STR_VERSION\t\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define O2NET_STATS_STR_VERSION\t\t1\n\nstatic void sc_show_sock_stats(struct seq_file *seq,\n\t\t\t       struct o2net_sock_container *sc)\n{\n\tif (!sc)\n\t\treturn;\n\n\tseq_printf(seq, \"%d,%u,%lu,%lld,%lld,%lld,%lu,%lld\\n\", O2NET_STATS_STR_VERSION,\n\t\t   sc->sc_node->nd_num, (unsigned long)sc_send_count(sc),\n\t\t   (long long)sc_tv_acquiry_total_ns(sc),\n\t\t   (long long)sc_tv_send_total_ns(sc),\n\t\t   (long long)sc_tv_status_total_ns(sc),\n\t\t   (unsigned long)sc_recv_count(sc),\n\t\t   (long long)sc_tv_process_total_ns(sc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc_show_sock_container",
          "args": [
            "seq",
            "sc"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "sc_show_sock_container",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "315-366",
          "snippet": "static void sc_show_sock_container(struct seq_file *seq,\n\t\t\t\t   struct o2net_sock_container *sc)\n{\n\tstruct inet_sock *inet = NULL;\n\t__be32 saddr = 0, daddr = 0;\n\t__be16 sport = 0, dport = 0;\n\n\tif (!sc)\n\t\treturn;\n\n\tif (sc->sc_sock) {\n\t\tinet = inet_sk(sc->sc_sock->sk);\n\t\t/* the stack's structs aren't sparse endian clean */\n\t\tsaddr = (__force __be32)inet->inet_saddr;\n\t\tdaddr = (__force __be32)inet->inet_daddr;\n\t\tsport = (__force __be16)inet->inet_sport;\n\t\tdport = (__force __be16)inet->inet_dport;\n\t}\n\n\t/* XXX sigh, inet-> doesn't have sparse annotation so any\n\t * use of it here generates a warning with -Wbitwise */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  krefs:           %d\\n\"\n\t\t   \"  sock:            %pI4:%u -> \"\n\t\t\t\t      \"%pI4:%u\\n\"\n\t\t   \"  remote node:     %s\\n\"\n\t\t   \"  page off:        %zu\\n\"\n\t\t   \"  handshake ok:    %u\\n\"\n\t\t   \"  timer:           %lld usecs\\n\"\n\t\t   \"  data ready:      %lld usecs\\n\"\n\t\t   \"  advance start:   %lld usecs\\n\"\n\t\t   \"  advance stop:    %lld usecs\\n\"\n\t\t   \"  func start:      %lld usecs\\n\"\n\t\t   \"  func stop:       %lld usecs\\n\"\n\t\t   \"  func key:        0x%08x\\n\"\n\t\t   \"  func type:       %u\\n\",\n\t\t   sc,\n\t\t   atomic_read(&sc->sc_kref.refcount),\n\t\t   &saddr, inet ? ntohs(sport) : 0,\n\t\t   &daddr, inet ? ntohs(dport) : 0,\n\t\t   sc->sc_node->nd_name,\n\t\t   sc->sc_page_off,\n\t\t   sc->sc_handshake_ok,\n\t\t   (long long)ktime_to_us(sc->sc_tv_timer),\n\t\t   (long long)ktime_to_us(sc->sc_tv_data_ready),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_stop),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_stop),\n\t\t   sc->sc_msg_key,\n\t\t   sc->sc_msg_type);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void sc_show_sock_container(struct seq_file *seq,\n\t\t\t\t   struct o2net_sock_container *sc)\n{\n\tstruct inet_sock *inet = NULL;\n\t__be32 saddr = 0, daddr = 0;\n\t__be16 sport = 0, dport = 0;\n\n\tif (!sc)\n\t\treturn;\n\n\tif (sc->sc_sock) {\n\t\tinet = inet_sk(sc->sc_sock->sk);\n\t\t/* the stack's structs aren't sparse endian clean */\n\t\tsaddr = (__force __be32)inet->inet_saddr;\n\t\tdaddr = (__force __be32)inet->inet_daddr;\n\t\tsport = (__force __be16)inet->inet_sport;\n\t\tdport = (__force __be16)inet->inet_dport;\n\t}\n\n\t/* XXX sigh, inet-> doesn't have sparse annotation so any\n\t * use of it here generates a warning with -Wbitwise */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  krefs:           %d\\n\"\n\t\t   \"  sock:            %pI4:%u -> \"\n\t\t\t\t      \"%pI4:%u\\n\"\n\t\t   \"  remote node:     %s\\n\"\n\t\t   \"  page off:        %zu\\n\"\n\t\t   \"  handshake ok:    %u\\n\"\n\t\t   \"  timer:           %lld usecs\\n\"\n\t\t   \"  data ready:      %lld usecs\\n\"\n\t\t   \"  advance start:   %lld usecs\\n\"\n\t\t   \"  advance stop:    %lld usecs\\n\"\n\t\t   \"  func start:      %lld usecs\\n\"\n\t\t   \"  func stop:       %lld usecs\\n\"\n\t\t   \"  func key:        0x%08x\\n\"\n\t\t   \"  func type:       %u\\n\",\n\t\t   sc,\n\t\t   atomic_read(&sc->sc_kref.refcount),\n\t\t   &saddr, inet ? ntohs(sport) : 0,\n\t\t   &daddr, inet ? ntohs(dport) : 0,\n\t\t   sc->sc_node->nd_name,\n\t\t   sc->sc_page_off,\n\t\t   sc->sc_handshake_ok,\n\t\t   (long long)ktime_to_us(sc->sc_tv_timer),\n\t\t   (long long)ktime_to_us(sc->sc_tv_data_ready),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_stop),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_stop),\n\t\t   sc->sc_msg_key,\n\t\t   sc->sc_msg_type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "next_sc",
          "args": [
            "dummy_sc"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "next_sc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "232-253",
          "snippet": "static struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define SHOW_SOCK_CONTAINERS\t0\n\nstatic int sc_seq_show(struct seq_file *seq, void *v)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\n\tif (sc) {\n\t\tif (sd->dbg_ctxt == SHOW_SOCK_CONTAINERS)\n\t\t\tsc_show_sock_container(seq, sc);\n\t\telse\n\t\t\tsc_show_sock_stats(seq, sc);\n\t}\n\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "sc_show_sock_container",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "315-366",
    "snippet": "static void sc_show_sock_container(struct seq_file *seq,\n\t\t\t\t   struct o2net_sock_container *sc)\n{\n\tstruct inet_sock *inet = NULL;\n\t__be32 saddr = 0, daddr = 0;\n\t__be16 sport = 0, dport = 0;\n\n\tif (!sc)\n\t\treturn;\n\n\tif (sc->sc_sock) {\n\t\tinet = inet_sk(sc->sc_sock->sk);\n\t\t/* the stack's structs aren't sparse endian clean */\n\t\tsaddr = (__force __be32)inet->inet_saddr;\n\t\tdaddr = (__force __be32)inet->inet_daddr;\n\t\tsport = (__force __be16)inet->inet_sport;\n\t\tdport = (__force __be16)inet->inet_dport;\n\t}\n\n\t/* XXX sigh, inet-> doesn't have sparse annotation so any\n\t * use of it here generates a warning with -Wbitwise */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  krefs:           %d\\n\"\n\t\t   \"  sock:            %pI4:%u -> \"\n\t\t\t\t      \"%pI4:%u\\n\"\n\t\t   \"  remote node:     %s\\n\"\n\t\t   \"  page off:        %zu\\n\"\n\t\t   \"  handshake ok:    %u\\n\"\n\t\t   \"  timer:           %lld usecs\\n\"\n\t\t   \"  data ready:      %lld usecs\\n\"\n\t\t   \"  advance start:   %lld usecs\\n\"\n\t\t   \"  advance stop:    %lld usecs\\n\"\n\t\t   \"  func start:      %lld usecs\\n\"\n\t\t   \"  func stop:       %lld usecs\\n\"\n\t\t   \"  func key:        0x%08x\\n\"\n\t\t   \"  func type:       %u\\n\",\n\t\t   sc,\n\t\t   atomic_read(&sc->sc_kref.refcount),\n\t\t   &saddr, inet ? ntohs(sport) : 0,\n\t\t   &daddr, inet ? ntohs(dport) : 0,\n\t\t   sc->sc_node->nd_name,\n\t\t   sc->sc_page_off,\n\t\t   sc->sc_handshake_ok,\n\t\t   (long long)ktime_to_us(sc->sc_tv_timer),\n\t\t   (long long)ktime_to_us(sc->sc_tv_data_ready),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_stop),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_stop),\n\t\t   sc->sc_msg_key,\n\t\t   sc->sc_msg_type);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\"%p:\\n\"\n\t\t   \"  krefs:           %d\\n\"\n\t\t   \"  sock:            %pI4:%u -> \"\n\t\t\t\t      \"%pI4:%u\\n\"\n\t\t   \"  remote node:     %s\\n\"\n\t\t   \"  page off:        %zu\\n\"\n\t\t   \"  handshake ok:    %u\\n\"\n\t\t   \"  timer:           %lld usecs\\n\"\n\t\t   \"  data ready:      %lld usecs\\n\"\n\t\t   \"  advance start:   %lld usecs\\n\"\n\t\t   \"  advance stop:    %lld usecs\\n\"\n\t\t   \"  func start:      %lld usecs\\n\"\n\t\t   \"  func stop:       %lld usecs\\n\"\n\t\t   \"  func key:        0x%08x\\n\"\n\t\t   \"  func type:       %u\\n\"",
            "sc",
            "atomic_read(&sc->sc_kref.refcount)",
            "&saddr",
            "inet ? ntohs(sport) : 0",
            "&daddr",
            "inet ? ntohs(dport) : 0",
            "sc->sc_node->nd_name",
            "sc->sc_page_off",
            "sc->sc_handshake_ok",
            "(long long)ktime_to_us(sc->sc_tv_timer)",
            "(long long)ktime_to_us(sc->sc_tv_data_ready)",
            "(long long)ktime_to_us(sc->sc_tv_advance_start)",
            "(long long)ktime_to_us(sc->sc_tv_advance_stop)",
            "(long long)ktime_to_us(sc->sc_tv_func_start)",
            "(long long)ktime_to_us(sc->sc_tv_func_stop)",
            "sc->sc_msg_key",
            "sc->sc_msg_type"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_func_stop"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_func_start"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_advance_stop"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_advance_start"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_data_ready"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "sc->sc_tv_timer"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "dport"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "sport"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&sc->sc_kref.refcount"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_sk",
          "args": [
            "sc->sc_sock->sk"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void sc_show_sock_container(struct seq_file *seq,\n\t\t\t\t   struct o2net_sock_container *sc)\n{\n\tstruct inet_sock *inet = NULL;\n\t__be32 saddr = 0, daddr = 0;\n\t__be16 sport = 0, dport = 0;\n\n\tif (!sc)\n\t\treturn;\n\n\tif (sc->sc_sock) {\n\t\tinet = inet_sk(sc->sc_sock->sk);\n\t\t/* the stack's structs aren't sparse endian clean */\n\t\tsaddr = (__force __be32)inet->inet_saddr;\n\t\tdaddr = (__force __be32)inet->inet_daddr;\n\t\tsport = (__force __be16)inet->inet_sport;\n\t\tdport = (__force __be16)inet->inet_dport;\n\t}\n\n\t/* XXX sigh, inet-> doesn't have sparse annotation so any\n\t * use of it here generates a warning with -Wbitwise */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  krefs:           %d\\n\"\n\t\t   \"  sock:            %pI4:%u -> \"\n\t\t\t\t      \"%pI4:%u\\n\"\n\t\t   \"  remote node:     %s\\n\"\n\t\t   \"  page off:        %zu\\n\"\n\t\t   \"  handshake ok:    %u\\n\"\n\t\t   \"  timer:           %lld usecs\\n\"\n\t\t   \"  data ready:      %lld usecs\\n\"\n\t\t   \"  advance start:   %lld usecs\\n\"\n\t\t   \"  advance stop:    %lld usecs\\n\"\n\t\t   \"  func start:      %lld usecs\\n\"\n\t\t   \"  func stop:       %lld usecs\\n\"\n\t\t   \"  func key:        0x%08x\\n\"\n\t\t   \"  func type:       %u\\n\",\n\t\t   sc,\n\t\t   atomic_read(&sc->sc_kref.refcount),\n\t\t   &saddr, inet ? ntohs(sport) : 0,\n\t\t   &daddr, inet ? ntohs(dport) : 0,\n\t\t   sc->sc_node->nd_name,\n\t\t   sc->sc_page_off,\n\t\t   sc->sc_handshake_ok,\n\t\t   (long long)ktime_to_us(sc->sc_tv_timer),\n\t\t   (long long)ktime_to_us(sc->sc_tv_data_ready),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_advance_stop),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_start),\n\t\t   (long long)ktime_to_us(sc->sc_tv_func_stop),\n\t\t   sc->sc_msg_key,\n\t\t   sc->sc_msg_type);\n}"
  },
  {
    "function_name": "sc_show_sock_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "300-313",
    "snippet": "static void sc_show_sock_stats(struct seq_file *seq,\n\t\t\t       struct o2net_sock_container *sc)\n{\n\tif (!sc)\n\t\treturn;\n\n\tseq_printf(seq, \"%d,%u,%lu,%lld,%lld,%lld,%lu,%lld\\n\", O2NET_STATS_STR_VERSION,\n\t\t   sc->sc_node->nd_num, (unsigned long)sc_send_count(sc),\n\t\t   (long long)sc_tv_acquiry_total_ns(sc),\n\t\t   (long long)sc_tv_send_total_ns(sc),\n\t\t   (long long)sc_tv_status_total_ns(sc),\n\t\t   (unsigned long)sc_recv_count(sc),\n\t\t   (long long)sc_tv_process_total_ns(sc));\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define O2NET_STATS_STR_VERSION\t\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\"%d,%u,%lu,%lld,%lld,%lld,%lu,%lld\\n\"",
            "O2NET_STATS_STR_VERSION",
            "sc->sc_node->nd_num",
            "(unsigned long)sc_send_count(sc)",
            "(long long)sc_tv_acquiry_total_ns(sc)",
            "(long long)sc_tv_send_total_ns(sc)",
            "(long long)sc_tv_status_total_ns(sc)",
            "(unsigned long)sc_recv_count(sc)",
            "(long long)sc_tv_process_total_ns(sc)"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc_tv_process_total_ns",
          "args": [
            "sc"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc_recv_count",
          "args": [
            "sc"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc_tv_status_total_ns",
          "args": [
            "sc"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc_tv_send_total_ns",
          "args": [
            "sc"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc_tv_acquiry_total_ns",
          "args": [
            "sc"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sc_send_count",
          "args": [
            "sc"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\n#define O2NET_STATS_STR_VERSION\t\t1\n\nstatic void sc_show_sock_stats(struct seq_file *seq,\n\t\t\t       struct o2net_sock_container *sc)\n{\n\tif (!sc)\n\t\treturn;\n\n\tseq_printf(seq, \"%d,%u,%lu,%lld,%lld,%lld,%lu,%lld\\n\", O2NET_STATS_STR_VERSION,\n\t\t   sc->sc_node->nd_num, (unsigned long)sc_send_count(sc),\n\t\t   (long long)sc_tv_acquiry_total_ns(sc),\n\t\t   (long long)sc_tv_send_total_ns(sc),\n\t\t   (long long)sc_tv_status_total_ns(sc),\n\t\t   (unsigned long)sc_recv_count(sc),\n\t\t   (long long)sc_tv_process_total_ns(sc));\n}"
  },
  {
    "function_name": "sc_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "267-280",
    "snippet": "static void *sc_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\tlist_del_init(&dummy_sc->sc_net_debug_item);\n\tif (sc)\n\t\tlist_add(&dummy_sc->sc_net_debug_item, &sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn sc; /* unused, just needs to be null when done */\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&dummy_sc->sc_net_debug_item",
            "&sc->sc_net_debug_item"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&dummy_sc->sc_net_debug_item"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_sc",
          "args": [
            "dummy_sc"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "next_sc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "232-253",
          "snippet": "static struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void *sc_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\tlist_del_init(&dummy_sc->sc_net_debug_item);\n\tif (sc)\n\t\tlist_add(&dummy_sc->sc_net_debug_item, &sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn sc; /* unused, just needs to be null when done */\n}"
  },
  {
    "function_name": "sc_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "255-265",
    "snippet": "static void *sc_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn sc;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "next_sc",
          "args": [
            "dummy_sc"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "next_sc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "232-253",
          "snippet": "static struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void *sc_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct o2net_sock_debug *sd = seq->private;\n\tstruct o2net_sock_container *sc, *dummy_sc = sd->dbg_sock;\n\n\tspin_lock(&o2net_debug_lock);\n\tsc = next_sc(dummy_sc);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn sc;\n}"
  },
  {
    "function_name": "next_sc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "232-253",
    "snippet": "static struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "sc",
            "&sc_start->sc_net_debug_item",
            "sc_net_debug_item"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_sock_container\n\t\t\t*next_sc(struct o2net_sock_container *sc_start)\n{\n\tstruct o2net_sock_container *sc, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(sc, &sc_start->sc_net_debug_item,\n\t\t\t    sc_net_debug_item) {\n\t\t/* discover the head of the list miscast as a sc */\n\t\tif (&sc->sc_net_debug_item == &sock_containers)\n\t\t\tbreak;\n\n\t\t/* use sc_page to detect real scs in the list */\n\t\tif (sc->sc_page != NULL) {\n\t\t\tret = sc;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2net_debug_del_sc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "220-225",
    "snippet": "void o2net_debug_del_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_del_init(&sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&sc->sc_net_debug_item"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_del_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_del_init(&sc->sc_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}"
  },
  {
    "function_name": "o2net_debug_add_sc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "213-218",
    "snippet": "void o2net_debug_add_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&sc->sc_net_debug_item, &sock_containers);\n\tspin_unlock(&o2net_debug_lock);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&sc->sc_net_debug_item",
            "&sock_containers"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_add_sc(struct o2net_sock_container *sc)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&sc->sc_net_debug_item, &sock_containers);\n\tspin_unlock(&o2net_debug_lock);\n}"
  },
  {
    "function_name": "nst_fop_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "197-204",
    "snippet": "static int nst_fop_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct o2net_send_tracking *dummy_nst = seq->private;\n\n\to2net_debug_del_nst(dummy_nst);\n\treturn seq_release_private(inode, file);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_release_private",
          "args": [
            "inode",
            "file"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "seq_release_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "605-612",
          "snippet": "int seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}"
        }
      },
      {
        "call_info": {
          "callee": "o2net_debug_del_nst",
          "args": [
            "dummy_nst"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_debug_del_nst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "73-79",
          "snippet": "void o2net_debug_del_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tif (!list_empty(&nst->st_net_debug_item))\n\t\tlist_del_init(&nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_del_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tif (!list_empty(&nst->st_net_debug_item))\n\t\tlist_del_init(&nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int nst_fop_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct o2net_send_tracking *dummy_nst = seq->private;\n\n\to2net_debug_del_nst(dummy_nst);\n\treturn seq_release_private(inode, file);\n}"
  },
  {
    "function_name": "nst_fop_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "185-195",
    "snippet": "static int nst_fop_open(struct inode *inode, struct file *file)\n{\n\tstruct o2net_send_tracking *dummy_nst;\n\n\tdummy_nst = __seq_open_private(file, &nst_seq_ops, sizeof(*dummy_nst));\n\tif (!dummy_nst)\n\t\treturn -ENOMEM;\n\to2net_debug_add_nst(dummy_nst);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "o2net_debug_add_nst",
          "args": [
            "dummy_nst"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_debug_add_nst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "66-71",
          "snippet": "void o2net_debug_add_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&nst->st_net_debug_item, &send_tracking);\n\tspin_unlock(&o2net_debug_lock);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_add_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&nst->st_net_debug_item, &send_tracking);\n\tspin_unlock(&o2net_debug_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__seq_open_private",
          "args": [
            "file",
            "&nst_seq_ops",
            "sizeof(*dummy_nst)"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "__seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "615-638",
          "snippet": "void *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nvoid *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int nst_fop_open(struct inode *inode, struct file *file)\n{\n\tstruct o2net_send_tracking *dummy_nst;\n\n\tdummy_nst = __seq_open_private(file, &nst_seq_ops, sizeof(*dummy_nst));\n\tif (!dummy_nst)\n\t\treturn -ENOMEM;\n\to2net_debug_add_nst(dummy_nst);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nst_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "174-176",
    "snippet": "static void nst_seq_stop(struct seq_file *seq, void *v)\n{\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void nst_seq_stop(struct seq_file *seq, void *v)\n{\n}"
  },
  {
    "function_name": "nst_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "130-172",
    "snippet": "static int nst_seq_show(struct seq_file *seq, void *v)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\tktime_t now;\n\ts64 sock, send, status;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tif (!nst)\n\t\tgoto out;\n\n\tnow = ktime_get();\n\tsock = ktime_to_us(ktime_sub(now, nst->st_sock_time));\n\tsend = ktime_to_us(ktime_sub(now, nst->st_send_time));\n\tstatus = ktime_to_us(ktime_sub(now, nst->st_status_time));\n\n\t/* get_task_comm isn't exported.  oh well. */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  pid:          %lu\\n\"\n\t\t   \"  tgid:         %lu\\n\"\n\t\t   \"  process name: %s\\n\"\n\t\t   \"  node:         %u\\n\"\n\t\t   \"  sc:           %p\\n\"\n\t\t   \"  message id:   %d\\n\"\n\t\t   \"  message type: %u\\n\"\n\t\t   \"  message key:  0x%08x\\n\"\n\t\t   \"  sock acquiry: %lld usecs ago\\n\"\n\t\t   \"  send start:   %lld usecs ago\\n\"\n\t\t   \"  wait start:   %lld usecs ago\\n\",\n\t\t   nst, (unsigned long)task_pid_nr(nst->st_task),\n\t\t   (unsigned long)nst->st_task->tgid,\n\t\t   nst->st_task->comm, nst->st_node,\n\t\t   nst->st_sc, nst->st_id, nst->st_msg_type,\n\t\t   nst->st_msg_key,\n\t\t   (long long)sock,\n\t\t   (long long)send,\n\t\t   (long long)status);\n\nout:\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\"%p:\\n\"\n\t\t   \"  pid:          %lu\\n\"\n\t\t   \"  tgid:         %lu\\n\"\n\t\t   \"  process name: %s\\n\"\n\t\t   \"  node:         %u\\n\"\n\t\t   \"  sc:           %p\\n\"\n\t\t   \"  message id:   %d\\n\"\n\t\t   \"  message type: %u\\n\"\n\t\t   \"  message key:  0x%08x\\n\"\n\t\t   \"  sock acquiry: %lld usecs ago\\n\"\n\t\t   \"  send start:   %lld usecs ago\\n\"\n\t\t   \"  wait start:   %lld usecs ago\\n\"",
            "nst",
            "(unsigned long)task_pid_nr(nst->st_task)",
            "(unsigned long)nst->st_task->tgid",
            "nst->st_task->comm",
            "nst->st_node",
            "nst->st_sc",
            "nst->st_id",
            "nst->st_msg_type",
            "nst->st_msg_key",
            "(long long)sock",
            "(long long)send",
            "(long long)status"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "nst->st_task"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "ktime_sub(now, nst->st_status_time)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_sub",
          "args": [
            "now",
            "nst->st_status_time"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "ktime_sub(now, nst->st_send_time)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_sub",
          "args": [
            "now",
            "nst->st_send_time"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_us",
          "args": [
            "ktime_sub(now, nst->st_sock_time)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_sub",
          "args": [
            "now",
            "nst->st_sock_time"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_get",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_nst",
          "args": [
            "dummy_nst"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "next_nst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "81-102",
          "snippet": "static struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic int nst_seq_show(struct seq_file *seq, void *v)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\tktime_t now;\n\ts64 sock, send, status;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tif (!nst)\n\t\tgoto out;\n\n\tnow = ktime_get();\n\tsock = ktime_to_us(ktime_sub(now, nst->st_sock_time));\n\tsend = ktime_to_us(ktime_sub(now, nst->st_send_time));\n\tstatus = ktime_to_us(ktime_sub(now, nst->st_status_time));\n\n\t/* get_task_comm isn't exported.  oh well. */\n\tseq_printf(seq, \"%p:\\n\"\n\t\t   \"  pid:          %lu\\n\"\n\t\t   \"  tgid:         %lu\\n\"\n\t\t   \"  process name: %s\\n\"\n\t\t   \"  node:         %u\\n\"\n\t\t   \"  sc:           %p\\n\"\n\t\t   \"  message id:   %d\\n\"\n\t\t   \"  message type: %u\\n\"\n\t\t   \"  message key:  0x%08x\\n\"\n\t\t   \"  sock acquiry: %lld usecs ago\\n\"\n\t\t   \"  send start:   %lld usecs ago\\n\"\n\t\t   \"  wait start:   %lld usecs ago\\n\",\n\t\t   nst, (unsigned long)task_pid_nr(nst->st_task),\n\t\t   (unsigned long)nst->st_task->tgid,\n\t\t   nst->st_task->comm, nst->st_node,\n\t\t   nst->st_sc, nst->st_id, nst->st_msg_type,\n\t\t   nst->st_msg_key,\n\t\t   (long long)sock,\n\t\t   (long long)send,\n\t\t   (long long)status);\n\nout:\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nst_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "115-128",
    "snippet": "static void *nst_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tlist_del_init(&dummy_nst->st_net_debug_item);\n\tif (nst)\n\t\tlist_add(&dummy_nst->st_net_debug_item,\n\t\t\t &nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn nst; /* unused, just needs to be null when done */\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&dummy_nst->st_net_debug_item",
            "&nst->st_net_debug_item"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&dummy_nst->st_net_debug_item"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_nst",
          "args": [
            "dummy_nst"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "next_nst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "81-102",
          "snippet": "static struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void *nst_seq_next(struct seq_file *seq, void *v, loff_t *pos)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tlist_del_init(&dummy_nst->st_net_debug_item);\n\tif (nst)\n\t\tlist_add(&dummy_nst->st_net_debug_item,\n\t\t\t &nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn nst; /* unused, just needs to be null when done */\n}"
  },
  {
    "function_name": "nst_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "104-113",
    "snippet": "static void *nst_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn nst;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "next_nst",
          "args": [
            "dummy_nst"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "next_nst",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
          "lines": "81-102",
          "snippet": "static struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void *nst_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct o2net_send_tracking *nst, *dummy_nst = seq->private;\n\n\tspin_lock(&o2net_debug_lock);\n\tnst = next_nst(dummy_nst);\n\tspin_unlock(&o2net_debug_lock);\n\n\treturn nst;\n}"
  },
  {
    "function_name": "next_nst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "81-102",
    "snippet": "static struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "nst",
            "&nst_start->st_net_debug_item",
            "st_net_debug_item"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic struct o2net_send_tracking\n\t\t\t*next_nst(struct o2net_send_tracking *nst_start)\n{\n\tstruct o2net_send_tracking *nst, *ret = NULL;\n\n\tassert_spin_locked(&o2net_debug_lock);\n\n\tlist_for_each_entry(nst, &nst_start->st_net_debug_item,\n\t\t\t    st_net_debug_item) {\n\t\t/* discover the head of the list */\n\t\tif (&nst->st_net_debug_item == &send_tracking)\n\t\t\tbreak;\n\n\t\t/* use st_task to detect real nsts in the list */\n\t\tif (nst->st_task != NULL) {\n\t\t\tret = nst;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "o2net_debug_del_nst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "73-79",
    "snippet": "void o2net_debug_del_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tif (!list_empty(&nst->st_net_debug_item))\n\t\tlist_del_init(&nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&nst->st_net_debug_item"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&nst->st_net_debug_item"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_del_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tif (!list_empty(&nst->st_net_debug_item))\n\t\tlist_del_init(&nst->st_net_debug_item);\n\tspin_unlock(&o2net_debug_lock);\n}"
  },
  {
    "function_name": "o2net_debug_add_nst",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/netdebug.c",
    "lines": "66-71",
    "snippet": "void o2net_debug_add_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&nst->st_net_debug_item, &send_tracking);\n\tspin_unlock(&o2net_debug_lock);\n}",
    "includes": [
      "#include \"tcp_internal.h\"",
      "#include \"masklog.h\"",
      "#include \"nodemanager.h\"",
      "#include \"tcp.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/kref.h>",
      "#include <linux/idr.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&nst->st_net_debug_item",
            "&send_tracking"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&o2net_debug_lock"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include <linux/uaccess.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nvoid o2net_debug_add_nst(struct o2net_send_tracking *nst)\n{\n\tspin_lock(&o2net_debug_lock);\n\tlist_add(&nst->st_net_debug_item, &send_tracking);\n\tspin_unlock(&o2net_debug_lock);\n}"
  }
]