[
  {
    "function_name": "nilfs_destroy_logs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "179-182",
    "snippet": "static inline void nilfs_destroy_logs(struct list_head *logs)\n{\n\tnilfs_truncate_logs(logs, NULL);\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_truncate_logs",
          "args": [
            "logs",
            "NULL"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_truncate_logs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.c",
          "lines": "282-293",
          "snippet": "void nilfs_truncate_logs(struct list_head *logs,\n\t\t\t struct nilfs_segment_buffer *last)\n{\n\tstruct nilfs_segment_buffer *n, *segbuf;\n\n\tsegbuf = list_prepare_entry(last, logs, sb_list);\n\tlist_for_each_entry_safe_continue(segbuf, n, logs, sb_list) {\n\t\tlist_del_init(&segbuf->sb_list);\n\t\tnilfs_segbuf_clear(segbuf);\n\t\tnilfs_segbuf_free(segbuf);\n\t}\n}",
          "includes": [
            "#include \"segbuf.h\"",
            "#include \"page.h\"",
            "#include <linux/slab.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/crc32.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"segbuf.h\"\n#include \"page.h\"\n#include <linux/slab.h>\n#include <linux/backing-dev.h>\n#include <linux/crc32.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n\nstatic int nilfs_segbuf_wait(struct nilfs_segment_buffer *segbuf);\n\nvoid nilfs_truncate_logs(struct list_head *logs,\n\t\t\t struct nilfs_segment_buffer *last)\n{\n\tstruct nilfs_segment_buffer *n, *segbuf;\n\n\tsegbuf = list_prepare_entry(last, logs, sb_list);\n\tlist_for_each_entry_safe_continue(segbuf, n, logs, sb_list) {\n\t\tlist_del_init(&segbuf->sb_list);\n\t\tnilfs_segbuf_clear(segbuf);\n\t\tnilfs_segbuf_free(segbuf);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void nilfs_destroy_logs(struct list_head *logs)\n{\n\tnilfs_truncate_logs(logs, NULL);\n}"
  },
  {
    "function_name": "nilfs_segbuf_add_file_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "163-170",
    "snippet": "static inline void\nnilfs_segbuf_add_file_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t     struct buffer_head *bh)\n{\n\tget_bh(bh);\n\tnilfs_segbuf_add_payload_buffer(segbuf, bh);\n\tsegbuf->sb_sum.nfileblk++;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_segbuf_add_payload_buffer",
          "args": [
            "segbuf",
            "bh"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_segbuf_add_payload_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
          "lines": "155-161",
          "snippet": "static inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/bio.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "bh"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_file_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t     struct buffer_head *bh)\n{\n\tget_bh(bh);\n\tnilfs_segbuf_add_payload_buffer(segbuf, bh);\n\tsegbuf->sb_sum.nfileblk++;\n}"
  },
  {
    "function_name": "nilfs_segbuf_add_payload_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "155-161",
    "snippet": "static inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&bh->b_assoc_buffers",
            "&segbuf->sb_payload_buffers"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_payload_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t\tstruct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_payload_buffers);\n\tsegbuf->sb_sum.nblocks++;\n}"
  },
  {
    "function_name": "nilfs_segbuf_add_segsum_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "146-153",
    "snippet": "static inline void\nnilfs_segbuf_add_segsum_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t       struct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_segsum_buffers);\n\tsegbuf->sb_sum.nblocks++;\n\tsegbuf->sb_sum.nsumblk++;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&bh->b_assoc_buffers",
            "&segbuf->sb_segsum_buffers"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline void\nnilfs_segbuf_add_segsum_buffer(struct nilfs_segment_buffer *segbuf,\n\t\t\t       struct buffer_head *bh)\n{\n\tlist_add_tail(&bh->b_assoc_buffers, &segbuf->sb_segsum_buffers);\n\tsegbuf->sb_sum.nblocks++;\n\tsegbuf->sb_sum.nsumblk++;\n}"
  },
  {
    "function_name": "nilfs_segbuf_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "141-144",
    "snippet": "static inline int nilfs_segbuf_empty(struct nilfs_segment_buffer *segbuf)\n{\n\treturn segbuf->sb_sum.nblocks == segbuf->sb_sum.nsumblk;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_segbuf_empty(struct nilfs_segment_buffer *segbuf)\n{\n\treturn segbuf->sb_sum.nblocks == segbuf->sb_sum.nsumblk;\n}"
  },
  {
    "function_name": "nilfs_segbuf_simplex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/segbuf.h",
    "lines": "133-139",
    "snippet": "static inline int nilfs_segbuf_simplex(struct nilfs_segment_buffer *segbuf)\n{\n\tunsigned int flags = segbuf->sb_sum.flags;\n\n\treturn (flags & (NILFS_SS_LOGBGN | NILFS_SS_LOGEND)) ==\n\t\t(NILFS_SS_LOGBGN | NILFS_SS_LOGEND);\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/bio.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/bio.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic inline int nilfs_segbuf_simplex(struct nilfs_segment_buffer *segbuf)\n{\n\tunsigned int flags = segbuf->sb_sum.flags;\n\n\treturn (flags & (NILFS_SS_LOGBGN | NILFS_SS_LOGEND)) ==\n\t\t(NILFS_SS_LOGBGN | NILFS_SS_LOGEND);\n}"
  }
]