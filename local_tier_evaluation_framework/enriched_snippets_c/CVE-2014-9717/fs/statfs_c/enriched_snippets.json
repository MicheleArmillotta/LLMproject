[
  {
    "function_name": "vfs_ustat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "216-226",
    "snippet": "int vfs_ustat(dev_t dev, struct kstatfs *sbuf)\n{\n\tstruct super_block *s = user_get_super(dev);\n\tint err;\n\tif (!s)\n\t\treturn -EINVAL;\n\n\terr = statfs_by_dentry(s->s_root, sbuf);\n\tdrop_super(s);\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "drop_super",
          "args": [
            "s"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "statfs_by_dentry",
          "args": [
            "s->s_root",
            "sbuf"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "statfs_by_dentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "49-64",
          "snippet": "static int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_get_super",
          "args": [
            "dev"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint vfs_ustat(dev_t dev, struct kstatfs *sbuf)\n{\n\tstruct super_block *s = user_get_super(dev);\n\tint err;\n\tif (!s)\n\t\treturn -EINVAL;\n\n\terr = statfs_by_dentry(s->s_root, sbuf);\n\tdrop_super(s);\n\treturn err;\n}"
  },
  {
    "function_name": "do_statfs64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "148-170",
    "snippet": "static int do_statfs64(struct kstatfs *st, struct statfs64 __user *p)\n{\n\tstruct statfs64 buf;\n\tif (sizeof(buf) == sizeof(*st))\n\t\tmemcpy(&buf, st, sizeof(*st));\n\telse {\n\t\tbuf.f_type = st->f_type;\n\t\tbuf.f_bsize = st->f_bsize;\n\t\tbuf.f_blocks = st->f_blocks;\n\t\tbuf.f_bfree = st->f_bfree;\n\t\tbuf.f_bavail = st->f_bavail;\n\t\tbuf.f_files = st->f_files;\n\t\tbuf.f_ffree = st->f_ffree;\n\t\tbuf.f_fsid = st->f_fsid;\n\t\tbuf.f_namelen = st->f_namelen;\n\t\tbuf.f_frsize = st->f_frsize;\n\t\tbuf.f_flags = st->f_flags;\n\t\tmemset(buf.f_spare, 0, sizeof(buf.f_spare));\n\t}\n\tif (copy_to_user(p, &buf, sizeof(buf)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "p",
            "&buf",
            "sizeof(buf)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf.f_spare",
            "0",
            "sizeof(buf.f_spare)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&buf",
            "st",
            "sizeof(*st)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int do_statfs64(struct kstatfs *st, struct statfs64 __user *p)\n{\n\tstruct statfs64 buf;\n\tif (sizeof(buf) == sizeof(*st))\n\t\tmemcpy(&buf, st, sizeof(*st));\n\telse {\n\t\tbuf.f_type = st->f_type;\n\t\tbuf.f_bsize = st->f_bsize;\n\t\tbuf.f_blocks = st->f_blocks;\n\t\tbuf.f_bfree = st->f_bfree;\n\t\tbuf.f_bavail = st->f_bavail;\n\t\tbuf.f_files = st->f_files;\n\t\tbuf.f_ffree = st->f_ffree;\n\t\tbuf.f_fsid = st->f_fsid;\n\t\tbuf.f_namelen = st->f_namelen;\n\t\tbuf.f_frsize = st->f_frsize;\n\t\tbuf.f_flags = st->f_flags;\n\t\tmemset(buf.f_spare, 0, sizeof(buf.f_spare));\n\t}\n\tif (copy_to_user(p, &buf, sizeof(buf)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_statfs_native",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "106-146",
    "snippet": "static int do_statfs_native(struct kstatfs *st, struct statfs __user *p)\n{\n\tstruct statfs buf;\n\n\tif (sizeof(buf) == sizeof(*st))\n\t\tmemcpy(&buf, st, sizeof(*st));\n\telse {\n\t\tif (sizeof buf.f_blocks == 4) {\n\t\t\tif ((st->f_blocks | st->f_bfree | st->f_bavail |\n\t\t\t     st->f_bsize | st->f_frsize) &\n\t\t\t    0xffffffff00000000ULL)\n\t\t\t\treturn -EOVERFLOW;\n\t\t\t/*\n\t\t\t * f_files and f_ffree may be -1; it's okay to stuff\n\t\t\t * that into 32 bits\n\t\t\t */\n\t\t\tif (st->f_files != -1 &&\n\t\t\t    (st->f_files & 0xffffffff00000000ULL))\n\t\t\t\treturn -EOVERFLOW;\n\t\t\tif (st->f_ffree != -1 &&\n\t\t\t    (st->f_ffree & 0xffffffff00000000ULL))\n\t\t\t\treturn -EOVERFLOW;\n\t\t}\n\n\t\tbuf.f_type = st->f_type;\n\t\tbuf.f_bsize = st->f_bsize;\n\t\tbuf.f_blocks = st->f_blocks;\n\t\tbuf.f_bfree = st->f_bfree;\n\t\tbuf.f_bavail = st->f_bavail;\n\t\tbuf.f_files = st->f_files;\n\t\tbuf.f_ffree = st->f_ffree;\n\t\tbuf.f_fsid = st->f_fsid;\n\t\tbuf.f_namelen = st->f_namelen;\n\t\tbuf.f_frsize = st->f_frsize;\n\t\tbuf.f_flags = st->f_flags;\n\t\tmemset(buf.f_spare, 0, sizeof(buf.f_spare));\n\t}\n\tif (copy_to_user(p, &buf, sizeof(buf)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "p",
            "&buf",
            "sizeof(buf)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf.f_spare",
            "0",
            "sizeof(buf.f_spare)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&buf",
            "st",
            "sizeof(*st)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int do_statfs_native(struct kstatfs *st, struct statfs __user *p)\n{\n\tstruct statfs buf;\n\n\tif (sizeof(buf) == sizeof(*st))\n\t\tmemcpy(&buf, st, sizeof(*st));\n\telse {\n\t\tif (sizeof buf.f_blocks == 4) {\n\t\t\tif ((st->f_blocks | st->f_bfree | st->f_bavail |\n\t\t\t     st->f_bsize | st->f_frsize) &\n\t\t\t    0xffffffff00000000ULL)\n\t\t\t\treturn -EOVERFLOW;\n\t\t\t/*\n\t\t\t * f_files and f_ffree may be -1; it's okay to stuff\n\t\t\t * that into 32 bits\n\t\t\t */\n\t\t\tif (st->f_files != -1 &&\n\t\t\t    (st->f_files & 0xffffffff00000000ULL))\n\t\t\t\treturn -EOVERFLOW;\n\t\t\tif (st->f_ffree != -1 &&\n\t\t\t    (st->f_ffree & 0xffffffff00000000ULL))\n\t\t\t\treturn -EOVERFLOW;\n\t\t}\n\n\t\tbuf.f_type = st->f_type;\n\t\tbuf.f_bsize = st->f_bsize;\n\t\tbuf.f_blocks = st->f_blocks;\n\t\tbuf.f_bfree = st->f_bfree;\n\t\tbuf.f_bavail = st->f_bavail;\n\t\tbuf.f_files = st->f_files;\n\t\tbuf.f_ffree = st->f_ffree;\n\t\tbuf.f_fsid = st->f_fsid;\n\t\tbuf.f_namelen = st->f_namelen;\n\t\tbuf.f_frsize = st->f_frsize;\n\t\tbuf.f_flags = st->f_flags;\n\t\tmemset(buf.f_spare, 0, sizeof(buf.f_spare));\n\t}\n\tif (copy_to_user(p, &buf, sizeof(buf)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "fd_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "95-104",
    "snippet": "int fd_statfs(int fd, struct kstatfs *st)\n{\n\tstruct fd f = fdget_raw(fd);\n\tint error = -EBADF;\n\tif (f.file) {\n\t\terror = vfs_statfs(&f.file->f_path, st);\n\t\tfdput(f);\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "fdput_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/read_write.c",
          "lines": "273-278",
          "snippet": "static inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/splice.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/aio.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/splice.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fsnotify.h>\n#include <linux/aio.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/slab.h>\n\nstatic inline void fdput_pos(struct fd f)\n{\n\tif (f.flags & FDPUT_POS_UNLOCK)\n\t\tmutex_unlock(&f.file->f_pos_lock);\n\tfdput(f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_statfs",
          "args": [
            "&f.file->f_path",
            "st"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "66-74",
          "snippet": "int vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdget_raw",
          "args": [
            "fd"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "__fdget_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/file.c",
          "lines": "701-704",
          "snippet": "unsigned long __fdget_raw(unsigned int fd)\n{\n\treturn __fget_light(fd, 0);\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/time.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/interrupt.h>\n#include <linux/bitops.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/time.h>\n#include <linux/mmzone.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nunsigned long __fdget_raw(unsigned int fd)\n{\n\treturn __fget_light(fd, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint fd_statfs(int fd, struct kstatfs *st)\n{\n\tstruct fd f = fdget_raw(fd);\n\tint error = -EBADF;\n\tif (f.file) {\n\t\terror = vfs_statfs(&f.file->f_path, st);\n\t\tfdput(f);\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "user_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "77-93",
    "snippet": "int user_statfs(const char __user *pathname, struct kstatfs *st)\n{\n\tstruct path path;\n\tint error;\n\tunsigned int lookup_flags = LOOKUP_FOLLOW|LOOKUP_AUTOMOUNT;\nretry:\n\terror = user_path_at(AT_FDCWD, pathname, lookup_flags, &path);\n\tif (!error) {\n\t\terror = vfs_statfs(&path, st);\n\t\tpath_put(&path);\n\t\tif (retry_estale(error, lookup_flags)) {\n\t\t\tlookup_flags |= LOOKUP_REVAL;\n\t\t\tgoto retry;\n\t\t}\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retry_estale",
          "args": [
            "error",
            "lookup_flags"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "489-493",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_statfs",
          "args": [
            "&path",
            "st"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "66-74",
          "snippet": "int vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_path_at",
          "args": [
            "AT_FDCWD",
            "pathname",
            "lookup_flags",
            "&path"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "user_path_at",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "2205-2209",
          "snippet": "int user_path_at(int dfd, const char __user *name, unsigned flags,\n\t\t struct path *path)\n{\n\treturn user_path_at_empty(dfd, name, flags, path, NULL);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nint user_path_at(int dfd, const char __user *name, unsigned flags,\n\t\t struct path *path)\n{\n\treturn user_path_at_empty(dfd, name, flags, path, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint user_statfs(const char __user *pathname, struct kstatfs *st)\n{\n\tstruct path path;\n\tint error;\n\tunsigned int lookup_flags = LOOKUP_FOLLOW|LOOKUP_AUTOMOUNT;\nretry:\n\terror = user_path_at(AT_FDCWD, pathname, lookup_flags, &path);\n\tif (!error) {\n\t\terror = vfs_statfs(&path, st);\n\t\tpath_put(&path);\n\t\tif (retry_estale(error, lookup_flags)) {\n\t\t\tlookup_flags |= LOOKUP_REVAL;\n\t\t\tgoto retry;\n\t\t}\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "vfs_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "66-74",
    "snippet": "int vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "calculate_f_flags",
          "args": [
            "path->mnt"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "calculate_f_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "43-47",
          "snippet": "static int calculate_f_flags(struct vfsmount *mnt)\n{\n\treturn ST_VALID | flags_by_mnt(mnt->mnt_flags) |\n\t\tflags_by_sb(mnt->mnt_sb->s_flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int calculate_f_flags(struct vfsmount *mnt)\n{\n\treturn ST_VALID | flags_by_mnt(mnt->mnt_flags) |\n\t\tflags_by_sb(mnt->mnt_sb->s_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "statfs_by_dentry",
          "args": [
            "path->dentry",
            "buf"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "statfs_by_dentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "49-64",
          "snippet": "static int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nint vfs_statfs(struct path *path, struct kstatfs *buf)\n{\n\tint error;\n\n\terror = statfs_by_dentry(path->dentry, buf);\n\tif (!error)\n\t\tbuf->f_flags = calculate_f_flags(path->mnt);\n\treturn error;\n}"
  },
  {
    "function_name": "statfs_by_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "49-64",
    "snippet": "static int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dentry->d_sb->s_op->statfs",
          "args": [
            "dentry",
            "buf"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_sb_statfs",
          "args": [
            "dentry"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf",
            "0",
            "sizeof(*buf)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int statfs_by_dentry(struct dentry *dentry, struct kstatfs *buf)\n{\n\tint retval;\n\n\tif (!dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\tmemset(buf, 0, sizeof(*buf));\n\tretval = security_sb_statfs(dentry);\n\tif (retval)\n\t\treturn retval;\n\tretval = dentry->d_sb->s_op->statfs(dentry, buf);\n\tif (retval == 0 && buf->f_frsize == 0)\n\t\tbuf->f_frsize = buf->f_bsize;\n\treturn retval;\n}"
  },
  {
    "function_name": "calculate_f_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "43-47",
    "snippet": "static int calculate_f_flags(struct vfsmount *mnt)\n{\n\treturn ST_VALID | flags_by_mnt(mnt->mnt_flags) |\n\t\tflags_by_sb(mnt->mnt_sb->s_flags);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flags_by_sb",
          "args": [
            "mnt->mnt_sb->s_flags"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "flags_by_sb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "33-41",
          "snippet": "static int flags_by_sb(int s_flags)\n{\n\tint flags = 0;\n\tif (s_flags & MS_SYNCHRONOUS)\n\t\tflags |= ST_SYNCHRONOUS;\n\tif (s_flags & MS_MANDLOCK)\n\t\tflags |= ST_MANDLOCK;\n\treturn flags;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int flags_by_sb(int s_flags)\n{\n\tint flags = 0;\n\tif (s_flags & MS_SYNCHRONOUS)\n\t\tflags |= ST_SYNCHRONOUS;\n\tif (s_flags & MS_MANDLOCK)\n\t\tflags |= ST_MANDLOCK;\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "flags_by_mnt",
          "args": [
            "mnt->mnt_flags"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "flags_by_mnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
          "lines": "12-31",
          "snippet": "static int flags_by_mnt(int mnt_flags)\n{\n\tint flags = 0;\n\n\tif (mnt_flags & MNT_READONLY)\n\t\tflags |= ST_RDONLY;\n\tif (mnt_flags & MNT_NOSUID)\n\t\tflags |= ST_NOSUID;\n\tif (mnt_flags & MNT_NODEV)\n\t\tflags |= ST_NODEV;\n\tif (mnt_flags & MNT_NOEXEC)\n\t\tflags |= ST_NOEXEC;\n\tif (mnt_flags & MNT_NOATIME)\n\t\tflags |= ST_NOATIME;\n\tif (mnt_flags & MNT_NODIRATIME)\n\t\tflags |= ST_NODIRATIME;\n\tif (mnt_flags & MNT_RELATIME)\n\t\tflags |= ST_RELATIME;\n\treturn flags;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int flags_by_mnt(int mnt_flags)\n{\n\tint flags = 0;\n\n\tif (mnt_flags & MNT_READONLY)\n\t\tflags |= ST_RDONLY;\n\tif (mnt_flags & MNT_NOSUID)\n\t\tflags |= ST_NOSUID;\n\tif (mnt_flags & MNT_NODEV)\n\t\tflags |= ST_NODEV;\n\tif (mnt_flags & MNT_NOEXEC)\n\t\tflags |= ST_NOEXEC;\n\tif (mnt_flags & MNT_NOATIME)\n\t\tflags |= ST_NOATIME;\n\tif (mnt_flags & MNT_NODIRATIME)\n\t\tflags |= ST_NODIRATIME;\n\tif (mnt_flags & MNT_RELATIME)\n\t\tflags |= ST_RELATIME;\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int calculate_f_flags(struct vfsmount *mnt)\n{\n\treturn ST_VALID | flags_by_mnt(mnt->mnt_flags) |\n\t\tflags_by_sb(mnt->mnt_sb->s_flags);\n}"
  },
  {
    "function_name": "flags_by_sb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "33-41",
    "snippet": "static int flags_by_sb(int s_flags)\n{\n\tint flags = 0;\n\tif (s_flags & MS_SYNCHRONOUS)\n\t\tflags |= ST_SYNCHRONOUS;\n\tif (s_flags & MS_MANDLOCK)\n\t\tflags |= ST_MANDLOCK;\n\treturn flags;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int flags_by_sb(int s_flags)\n{\n\tint flags = 0;\n\tif (s_flags & MS_SYNCHRONOUS)\n\t\tflags |= ST_SYNCHRONOUS;\n\tif (s_flags & MS_MANDLOCK)\n\t\tflags |= ST_MANDLOCK;\n\treturn flags;\n}"
  },
  {
    "function_name": "flags_by_mnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/statfs.c",
    "lines": "12-31",
    "snippet": "static int flags_by_mnt(int mnt_flags)\n{\n\tint flags = 0;\n\n\tif (mnt_flags & MNT_READONLY)\n\t\tflags |= ST_RDONLY;\n\tif (mnt_flags & MNT_NOSUID)\n\t\tflags |= ST_NOSUID;\n\tif (mnt_flags & MNT_NODEV)\n\t\tflags |= ST_NODEV;\n\tif (mnt_flags & MNT_NOEXEC)\n\t\tflags |= ST_NOEXEC;\n\tif (mnt_flags & MNT_NOATIME)\n\t\tflags |= ST_NOATIME;\n\tif (mnt_flags & MNT_NODIRATIME)\n\t\tflags |= ST_NODIRATIME;\n\tif (mnt_flags & MNT_RELATIME)\n\t\tflags |= ST_RELATIME;\n\treturn flags;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/security.h>",
      "#include <linux/statfs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs.h>",
      "#include <linux/export.h>",
      "#include <linux/syscalls.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic int flags_by_mnt(int mnt_flags)\n{\n\tint flags = 0;\n\n\tif (mnt_flags & MNT_READONLY)\n\t\tflags |= ST_RDONLY;\n\tif (mnt_flags & MNT_NOSUID)\n\t\tflags |= ST_NOSUID;\n\tif (mnt_flags & MNT_NODEV)\n\t\tflags |= ST_NODEV;\n\tif (mnt_flags & MNT_NOEXEC)\n\t\tflags |= ST_NOEXEC;\n\tif (mnt_flags & MNT_NOATIME)\n\t\tflags |= ST_NOATIME;\n\tif (mnt_flags & MNT_NODIRATIME)\n\t\tflags |= ST_NODIRATIME;\n\tif (mnt_flags & MNT_RELATIME)\n\t\tflags |= ST_RELATIME;\n\treturn flags;\n}"
  }
]