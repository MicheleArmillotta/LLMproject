[
  {
    "function_name": "gfs2_unregister_debugfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "2106-2110",
    "snippet": "void gfs2_unregister_debugfs(void)\n{\n\tdebugfs_remove(gfs2_root);\n\tgfs2_root = NULL;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *gfs2_root;",
      "static struct dentry *gfs2_root;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "gfs2_root"
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *gfs2_root;\nstatic struct dentry *gfs2_root;\n\nvoid gfs2_unregister_debugfs(void)\n{\n\tdebugfs_remove(gfs2_root);\n\tgfs2_root = NULL;\n}"
  },
  {
    "function_name": "gfs2_register_debugfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "2100-2104",
    "snippet": "int gfs2_register_debugfs(void)\n{\n\tgfs2_root = debugfs_create_dir(\"gfs2\", NULL);\n\treturn gfs2_root ? 0 : -ENOMEM;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *gfs2_root;",
      "static struct dentry *gfs2_root;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"gfs2\"",
            "NULL"
          ],
          "line": 2102
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *gfs2_root;\nstatic struct dentry *gfs2_root;\n\nint gfs2_register_debugfs(void)\n{\n\tgfs2_root = debugfs_create_dir(\"gfs2\", NULL);\n\treturn gfs2_root ? 0 : -ENOMEM;\n}"
  },
  {
    "function_name": "gfs2_delete_debugfs_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "2080-2098",
    "snippet": "void gfs2_delete_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tif (sdp->debugfs_dir) {\n\t\tif (sdp->debugfs_dentry_glocks) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glocks);\n\t\t\tsdp->debugfs_dentry_glocks = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_glstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glstats);\n\t\t\tsdp->debugfs_dentry_glstats = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_sbstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_sbstats);\n\t\t\tsdp->debugfs_dentry_sbstats = NULL;\n\t\t}\n\t\tdebugfs_remove(sdp->debugfs_dir);\n\t\tsdp->debugfs_dir = NULL;\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "sdp->debugfs_dir"
          ],
          "line": 2095
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_delete_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tif (sdp->debugfs_dir) {\n\t\tif (sdp->debugfs_dentry_glocks) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glocks);\n\t\t\tsdp->debugfs_dentry_glocks = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_glstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glstats);\n\t\t\tsdp->debugfs_dentry_glstats = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_sbstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_sbstats);\n\t\t\tsdp->debugfs_dentry_sbstats = NULL;\n\t\t}\n\t\tdebugfs_remove(sdp->debugfs_dir);\n\t\tsdp->debugfs_dir = NULL;\n\t}\n}"
  },
  {
    "function_name": "gfs2_create_debugfs_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "2048-2078",
    "snippet": "int gfs2_create_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tsdp->debugfs_dir = debugfs_create_dir(sdp->sd_table_name, gfs2_root);\n\tif (!sdp->debugfs_dir)\n\t\treturn -ENOMEM;\n\tsdp->debugfs_dentry_glocks = debugfs_create_file(\"glocks\",\n\t\t\t\t\t\t\t S_IFREG | S_IRUGO,\n\t\t\t\t\t\t\t sdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t &gfs2_glocks_fops);\n\tif (!sdp->debugfs_dentry_glocks)\n\t\tgoto fail;\n\n\tsdp->debugfs_dentry_glstats = debugfs_create_file(\"glstats\",\n\t\t\t\t\t\t\tS_IFREG | S_IRUGO,\n\t\t\t\t\t\t\tsdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t&gfs2_glstats_fops);\n\tif (!sdp->debugfs_dentry_glstats)\n\t\tgoto fail;\n\n\tsdp->debugfs_dentry_sbstats = debugfs_create_file(\"sbstats\",\n\t\t\t\t\t\t\tS_IFREG | S_IRUGO,\n\t\t\t\t\t\t\tsdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t&gfs2_sbstats_fops);\n\tif (!sdp->debugfs_dentry_sbstats)\n\t\tgoto fail;\n\n\treturn 0;\nfail:\n\tgfs2_delete_debugfs_file(sdp);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *gfs2_root;",
      "static struct dentry *gfs2_root;",
      "static const struct file_operations gfs2_glocks_fops = {\n\t.owner   = THIS_MODULE,\n\t.open    = gfs2_glocks_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};",
      "static const struct file_operations gfs2_glstats_fops = {\n\t.owner   = THIS_MODULE,\n\t.open    = gfs2_glstats_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};",
      "static const struct file_operations gfs2_sbstats_fops = {\n\t.owner   = THIS_MODULE,\n\t.open\t = gfs2_sbstats_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_delete_debugfs_file",
          "args": [
            "sdp"
          ],
          "line": 2076
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_delete_debugfs_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "2080-2098",
          "snippet": "void gfs2_delete_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tif (sdp->debugfs_dir) {\n\t\tif (sdp->debugfs_dentry_glocks) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glocks);\n\t\t\tsdp->debugfs_dentry_glocks = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_glstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glstats);\n\t\t\tsdp->debugfs_dentry_glstats = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_sbstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_sbstats);\n\t\t\tsdp->debugfs_dentry_sbstats = NULL;\n\t\t}\n\t\tdebugfs_remove(sdp->debugfs_dir);\n\t\tsdp->debugfs_dir = NULL;\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_delete_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tif (sdp->debugfs_dir) {\n\t\tif (sdp->debugfs_dentry_glocks) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glocks);\n\t\t\tsdp->debugfs_dentry_glocks = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_glstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_glstats);\n\t\t\tsdp->debugfs_dentry_glstats = NULL;\n\t\t}\n\t\tif (sdp->debugfs_dentry_sbstats) {\n\t\t\tdebugfs_remove(sdp->debugfs_dentry_sbstats);\n\t\t\tsdp->debugfs_dentry_sbstats = NULL;\n\t\t}\n\t\tdebugfs_remove(sdp->debugfs_dir);\n\t\tsdp->debugfs_dir = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"sbstats\"",
            "S_IFREG | S_IRUGO",
            "sdp->debugfs_dir",
            "sdp",
            "&gfs2_sbstats_fops"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "sdp->sd_table_name",
            "gfs2_root"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *gfs2_root;\nstatic struct dentry *gfs2_root;\nstatic const struct file_operations gfs2_glocks_fops = {\n\t.owner   = THIS_MODULE,\n\t.open    = gfs2_glocks_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};\nstatic const struct file_operations gfs2_glstats_fops = {\n\t.owner   = THIS_MODULE,\n\t.open    = gfs2_glstats_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};\nstatic const struct file_operations gfs2_sbstats_fops = {\n\t.owner   = THIS_MODULE,\n\t.open\t = gfs2_sbstats_open,\n\t.read    = seq_read,\n\t.llseek  = seq_lseek,\n\t.release = seq_release_private,\n};\n\nint gfs2_create_debugfs_file(struct gfs2_sbd *sdp)\n{\n\tsdp->debugfs_dir = debugfs_create_dir(sdp->sd_table_name, gfs2_root);\n\tif (!sdp->debugfs_dir)\n\t\treturn -ENOMEM;\n\tsdp->debugfs_dentry_glocks = debugfs_create_file(\"glocks\",\n\t\t\t\t\t\t\t S_IFREG | S_IRUGO,\n\t\t\t\t\t\t\t sdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t &gfs2_glocks_fops);\n\tif (!sdp->debugfs_dentry_glocks)\n\t\tgoto fail;\n\n\tsdp->debugfs_dentry_glstats = debugfs_create_file(\"glstats\",\n\t\t\t\t\t\t\tS_IFREG | S_IRUGO,\n\t\t\t\t\t\t\tsdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t&gfs2_glstats_fops);\n\tif (!sdp->debugfs_dentry_glstats)\n\t\tgoto fail;\n\n\tsdp->debugfs_dentry_sbstats = debugfs_create_file(\"sbstats\",\n\t\t\t\t\t\t\tS_IFREG | S_IRUGO,\n\t\t\t\t\t\t\tsdp->debugfs_dir, sdp,\n\t\t\t\t\t\t\t&gfs2_sbstats_fops);\n\tif (!sdp->debugfs_dentry_sbstats)\n\t\tgoto fail;\n\n\treturn 0;\nfail:\n\tgfs2_delete_debugfs_file(sdp);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "gfs2_sbstats_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "2012-2022",
    "snippet": "static int gfs2_sbstats_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_sbstats_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct seq_operations gfs2_sbstats_seq_ops = {\n\t.start = gfs2_sbstats_seq_start,\n\t.next  = gfs2_sbstats_seq_next,\n\t.stop  = gfs2_sbstats_seq_stop,\n\t.show  = gfs2_sbstats_seq_show,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_open_private",
          "args": [
            "file",
            "&gfs2_sbstats_seq_ops",
            "sizeof(struct gfs2_glock_iter)"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "641-645",
          "snippet": "int seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const struct seq_operations gfs2_sbstats_seq_ops = {\n\t.start = gfs2_sbstats_seq_start,\n\t.next  = gfs2_sbstats_seq_next,\n\t.stop  = gfs2_sbstats_seq_stop,\n\t.show  = gfs2_sbstats_seq_show,\n};\n\nstatic int gfs2_sbstats_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_sbstats_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "gfs2_glstats_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1997-2010",
    "snippet": "static int gfs2_glstats_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_glstats_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t\tseq->buf = kmalloc(GFS2_SEQ_GOODSIZE, GFP_KERNEL | __GFP_NOWARN);\n\t\tif (seq->buf)\n\t\t\tseq->size = GFS2_SEQ_GOODSIZE;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_SEQ_GOODSIZE min(PAGE_SIZE << PAGE_ALLOC_COSTLY_ORDER, 65536UL)"
    ],
    "globals_used": [
      "static const struct seq_operations gfs2_glstats_seq_ops = {\n\t.start = gfs2_glock_seq_start,\n\t.next  = gfs2_glock_seq_next,\n\t.stop  = gfs2_glock_seq_stop,\n\t.show  = gfs2_glstats_seq_show,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "GFS2_SEQ_GOODSIZE",
            "GFP_KERNEL | __GFP_NOWARN"
          ],
          "line": 2005
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_open_private",
          "args": [
            "file",
            "&gfs2_glstats_seq_ops",
            "sizeof(struct gfs2_glock_iter)"
          ],
          "line": 1999
        },
        "resolved": true,
        "details": {
          "function_name": "seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "641-645",
          "snippet": "int seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_SEQ_GOODSIZE min(PAGE_SIZE << PAGE_ALLOC_COSTLY_ORDER, 65536UL)\n\nstatic const struct seq_operations gfs2_glstats_seq_ops = {\n\t.start = gfs2_glock_seq_start,\n\t.next  = gfs2_glock_seq_next,\n\t.stop  = gfs2_glock_seq_stop,\n\t.show  = gfs2_glstats_seq_show,\n};\n\nstatic int gfs2_glstats_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_glstats_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t\tseq->buf = kmalloc(GFS2_SEQ_GOODSIZE, GFP_KERNEL | __GFP_NOWARN);\n\t\tif (seq->buf)\n\t\t\tseq->size = GFS2_SEQ_GOODSIZE;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "gfs2_glocks_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1982-1995",
    "snippet": "static int gfs2_glocks_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_glock_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t\tseq->buf = kmalloc(GFS2_SEQ_GOODSIZE, GFP_KERNEL | __GFP_NOWARN);\n\t\tif (seq->buf)\n\t\t\tseq->size = GFS2_SEQ_GOODSIZE;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_SEQ_GOODSIZE min(PAGE_SIZE << PAGE_ALLOC_COSTLY_ORDER, 65536UL)"
    ],
    "globals_used": [
      "static const struct seq_operations gfs2_glock_seq_ops = {\n\t.start = gfs2_glock_seq_start,\n\t.next  = gfs2_glock_seq_next,\n\t.stop  = gfs2_glock_seq_stop,\n\t.show  = gfs2_glock_seq_show,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "GFS2_SEQ_GOODSIZE",
            "GFP_KERNEL | __GFP_NOWARN"
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_open_private",
          "args": [
            "file",
            "&gfs2_glock_seq_ops",
            "sizeof(struct gfs2_glock_iter)"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "641-645",
          "snippet": "int seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_open_private(struct file *filp, const struct seq_operations *ops,\n\t\tint psize)\n{\n\treturn __seq_open_private(filp, ops, psize) ? 0 : -ENOMEM;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_SEQ_GOODSIZE min(PAGE_SIZE << PAGE_ALLOC_COSTLY_ORDER, 65536UL)\n\nstatic const struct seq_operations gfs2_glock_seq_ops = {\n\t.start = gfs2_glock_seq_start,\n\t.next  = gfs2_glock_seq_next,\n\t.stop  = gfs2_glock_seq_stop,\n\t.show  = gfs2_glock_seq_show,\n};\n\nstatic int gfs2_glocks_open(struct inode *inode, struct file *file)\n{\n\tint ret = seq_open_private(file, &gfs2_glock_seq_ops,\n\t\t\t\t   sizeof(struct gfs2_glock_iter));\n\tif (ret == 0) {\n\t\tstruct seq_file *seq = file->private_data;\n\t\tstruct gfs2_glock_iter *gi = seq->private;\n\t\tgi->sdp = inode->i_private;\n\t\tseq->buf = kmalloc(GFS2_SEQ_GOODSIZE, GFP_KERNEL | __GFP_NOWARN);\n\t\tif (seq->buf)\n\t\t\tseq->size = GFS2_SEQ_GOODSIZE;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "gfs2_sbstats_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1954-1957",
    "snippet": "static void gfs2_sbstats_seq_stop(struct seq_file *seq, void *iter_ptr)\n{\n\tpreempt_enable();\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1956
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_sbstats_seq_stop(struct seq_file *seq, void *iter_ptr)\n{\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "gfs2_sbstats_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1941-1952",
    "snippet": "static void *gfs2_sbstats_seq_next(struct seq_file *seq, void *iter_ptr,\n\t\t\t\t   loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\t(*pos)++;\n\tgi->hash++;\n\tif (gi->hash >= GFS2_NR_SBSTATS) {\n\t\tpreempt_enable();\n\t\treturn NULL;\n\t}\n\treturn SEQ_START_TOKEN;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_NR_SBSTATS (ARRAY_SIZE(gfs2_gltype) * ARRAY_SIZE(gfs2_stype))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1948
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_NR_SBSTATS (ARRAY_SIZE(gfs2_gltype) * ARRAY_SIZE(gfs2_stype))\n\nstatic void *gfs2_sbstats_seq_next(struct seq_file *seq, void *iter_ptr,\n\t\t\t\t   loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\t(*pos)++;\n\tgi->hash++;\n\tif (gi->hash >= GFS2_NR_SBSTATS) {\n\t\tpreempt_enable();\n\t\treturn NULL;\n\t}\n\treturn SEQ_START_TOKEN;\n}"
  },
  {
    "function_name": "gfs2_sbstats_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1930-1939",
    "snippet": "static void *gfs2_sbstats_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\tgi->hash = *pos;\n\tif (*pos >= GFS2_NR_SBSTATS)\n\t\treturn NULL;\n\tpreempt_disable();\n\treturn SEQ_START_TOKEN;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_NR_SBSTATS (ARRAY_SIZE(gfs2_gltype) * ARRAY_SIZE(gfs2_stype))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1937
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_NR_SBSTATS (ARRAY_SIZE(gfs2_gltype) * ARRAY_SIZE(gfs2_stype))\n\nstatic void *gfs2_sbstats_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\tgi->hash = *pos;\n\tif (*pos >= GFS2_NR_SBSTATS)\n\t\treturn NULL;\n\tpreempt_disable();\n\treturn SEQ_START_TOKEN;\n}"
  },
  {
    "function_name": "gfs2_glock_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1924-1928",
    "snippet": "static int gfs2_glock_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tdump_glock(seq, iter_ptr);\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_glock",
          "args": [
            "seq",
            "iter_ptr"
          ],
          "line": 1926
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dump_glock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1702-1729",
          "snippet": "void gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int gfs2_glock_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tdump_glock(seq, iter_ptr);\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_glock_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1915-1922",
    "snippet": "static void gfs2_glock_seq_stop(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\tif (gi->gl)\n\t\trcu_read_unlock();\n\tgi->gl = NULL;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1920
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_seq_stop(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\tif (gi->gl)\n\t\trcu_read_unlock();\n\tgi->gl = NULL;\n}"
  },
  {
    "function_name": "gfs2_glock_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1902-1913",
    "snippet": "static void *gfs2_glock_seq_next(struct seq_file *seq, void *iter_ptr,\n\t\t\t\t loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\t(*pos)++;\n\tgi->last_pos = *pos;\n\tif (gfs2_glock_iter_next(gi))\n\t\treturn NULL;\n\n\treturn gi->gl;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_iter_next",
          "args": [
            "gi"
          ],
          "line": 1909
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_iter_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1847-1878",
          "snippet": "static int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void *gfs2_glock_seq_next(struct seq_file *seq, void *iter_ptr,\n\t\t\t\t loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\n\t(*pos)++;\n\tgi->last_pos = *pos;\n\tif (gfs2_glock_iter_next(gi))\n\t\treturn NULL;\n\n\treturn gi->gl;\n}"
  },
  {
    "function_name": "gfs2_glock_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1880-1900",
    "snippet": "static void *gfs2_glock_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\tloff_t n = *pos;\n\n\tif (gi->last_pos <= *pos)\n\t\tn = gi->nhash + (*pos - gi->last_pos);\n\telse\n\t\tgi->hash = 0;\n\n\tgi->nhash = 0;\n\trcu_read_lock();\n\n\tdo {\n\t\tif (gfs2_glock_iter_next(gi))\n\t\t\treturn NULL;\n\t} while (n--);\n\n\tgi->last_pos = *pos;\n\treturn gi->gl;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_iter_next",
          "args": [
            "gi"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_iter_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1847-1878",
          "snippet": "static int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1891
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void *gfs2_glock_seq_start(struct seq_file *seq, loff_t *pos)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\tloff_t n = *pos;\n\n\tif (gi->last_pos <= *pos)\n\t\tn = gi->nhash + (*pos - gi->last_pos);\n\telse\n\t\tgi->hash = 0;\n\n\tgi->nhash = 0;\n\trcu_read_lock();\n\n\tdo {\n\t\tif (gfs2_glock_iter_next(gi))\n\t\t\treturn NULL;\n\t} while (n--);\n\n\tgi->last_pos = *pos;\n\treturn gi->gl;\n}"
  },
  {
    "function_name": "gfs2_glock_iter_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1847-1878",
    "snippet": "static int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__lockref_is_dead",
          "args": [
            "&gi->gl->gl_lockref"
          ],
          "line": 1875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glock_hash_chain",
          "args": [
            "gi->hash"
          ],
          "line": 1870
        },
        "resolved": true,
        "details": {
          "function_name": "glock_hash_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1835-1839",
          "snippet": "static inline struct gfs2_glock *glock_hash_chain(unsigned hash)\n{\n\treturn hlist_bl_entry(hlist_bl_first_rcu(&gl_hash_table[hash]),\n\t\t\t      struct gfs2_glock, gl_list);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline struct gfs2_glock *glock_hash_chain(unsigned hash)\n{\n\treturn hlist_bl_entry(hlist_bl_first_rcu(&gl_hash_table[hash]),\n\t\t\t      struct gfs2_glock, gl_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glock_hash_next",
          "args": [
            "gl"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "glock_hash_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1841-1845",
          "snippet": "static inline struct gfs2_glock *glock_hash_next(struct gfs2_glock *gl)\n{\n\treturn hlist_bl_entry(rcu_dereference(gl->gl_list.next),\n\t\t\t      struct gfs2_glock, gl_list);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_glock *glock_hash_next(struct gfs2_glock *gl)\n{\n\treturn hlist_bl_entry(rcu_dereference(gl->gl_list.next),\n\t\t\t      struct gfs2_glock, gl_list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic int gfs2_glock_iter_next(struct gfs2_glock_iter *gi)\n{\n\tstruct gfs2_glock *gl;\n\n\tdo {\n\t\tgl = gi->gl;\n\t\tif (gl) {\n\t\t\tgi->gl = glock_hash_next(gl);\n\t\t\tgi->nhash++;\n\t\t} else {\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t\twhile (gi->gl == NULL) {\n\t\t\tgi->hash++;\n\t\t\tif (gi->hash >= GFS2_GL_HASH_SIZE) {\n\t\t\t\trcu_read_unlock();\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tgi->gl = glock_hash_chain(gi->hash);\n\t\t\tgi->nhash = 0;\n\t\t}\n\t/* Skip entries for other sb and dead entries */\n\t} while (gi->sdp != gi->gl->gl_sbd ||\n\t\t __lockref_is_dead(&gi->gl->gl_lockref));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "glock_hash_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1841-1845",
    "snippet": "static inline struct gfs2_glock *glock_hash_next(struct gfs2_glock *gl)\n{\n\treturn hlist_bl_entry(rcu_dereference(gl->gl_list.next),\n\t\t\t      struct gfs2_glock, gl_list);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_entry",
          "args": [
            "rcu_dereference(gl->gl_list.next)",
            "structgfs2_glock",
            "gl_list"
          ],
          "line": 1843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "gl->gl_list.next"
          ],
          "line": 1843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_glock *glock_hash_next(struct gfs2_glock *gl)\n{\n\treturn hlist_bl_entry(rcu_dereference(gl->gl_list.next),\n\t\t\t      struct gfs2_glock, gl_list);\n}"
  },
  {
    "function_name": "glock_hash_chain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1835-1839",
    "snippet": "static inline struct gfs2_glock *glock_hash_chain(unsigned hash)\n{\n\treturn hlist_bl_entry(hlist_bl_first_rcu(&gl_hash_table[hash]),\n\t\t\t      struct gfs2_glock, gl_list);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_entry",
          "args": [
            "hlist_bl_first_rcu(&gl_hash_table[hash])",
            "structgfs2_glock",
            "gl_list"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_first_rcu",
          "args": [
            "&gl_hash_table[hash]"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline struct gfs2_glock *glock_hash_chain(unsigned hash)\n{\n\treturn hlist_bl_entry(hlist_bl_first_rcu(&gl_hash_table[hash]),\n\t\t\t      struct gfs2_glock, gl_list);\n}"
  },
  {
    "function_name": "gfs2_glock_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1828-1833",
    "snippet": "void gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;",
      "struct workqueue_struct *gfs2_delete_workqueue;",
      "static struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "gfs2_delete_workqueue"
          ],
          "line": 1832
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&glock_shrinker"
          ],
          "line": 1830
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\nstruct workqueue_struct *gfs2_delete_workqueue;\nstatic struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};\n\nvoid gfs2_glock_exit(void)\n{\n\tunregister_shrinker(&glock_shrinker);\n\tdestroy_workqueue(glock_workqueue);\n\tdestroy_workqueue(gfs2_delete_workqueue);\n}"
  },
  {
    "function_name": "gfs2_glock_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1804-1826",
    "snippet": "int __init gfs2_glock_init(void)\n{\n\tunsigned i;\n\tfor(i = 0; i < GFS2_GL_HASH_SIZE; i++) {\n\t\tINIT_HLIST_BL_HEAD(&gl_hash_table[i]);\n\t}\n\n\tglock_workqueue = alloc_workqueue(\"glock_workqueue\", WQ_MEM_RECLAIM |\n\t\t\t\t\t  WQ_HIGHPRI | WQ_FREEZABLE, 0);\n\tif (!glock_workqueue)\n\t\treturn -ENOMEM;\n\tgfs2_delete_workqueue = alloc_workqueue(\"delete_workqueue\",\n\t\t\t\t\t\tWQ_MEM_RECLAIM | WQ_FREEZABLE,\n\t\t\t\t\t\t0);\n\tif (!gfs2_delete_workqueue) {\n\t\tdestroy_workqueue(glock_workqueue);\n\t\treturn -ENOMEM;\n\t}\n\n\tregister_shrinker(&glock_shrinker);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
    ],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;",
      "struct workqueue_struct *gfs2_delete_workqueue;",
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];",
      "static struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&glock_shrinker"
          ],
          "line": 1823
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "glock_workqueue"
          ],
          "line": 1819
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"delete_workqueue\"",
            "WQ_MEM_RECLAIM | WQ_FREEZABLE",
            "0"
          ],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"glock_workqueue\"",
            "WQ_MEM_RECLAIM |\n\t\t\t\t\t  WQ_HIGHPRI | WQ_FREEZABLE",
            "0"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_HEAD",
          "args": [
            "&gl_hash_table[i]"
          ],
          "line": 1808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic struct workqueue_struct *glock_workqueue;\nstruct workqueue_struct *gfs2_delete_workqueue;\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\nstatic struct shrinker glock_shrinker = {\n\t.seeks = DEFAULT_SEEKS,\n\t.count_objects = gfs2_glock_shrink_count,\n\t.scan_objects = gfs2_glock_shrink_scan,\n};\n\nint __init gfs2_glock_init(void)\n{\n\tunsigned i;\n\tfor(i = 0; i < GFS2_GL_HASH_SIZE; i++) {\n\t\tINIT_HLIST_BL_HEAD(&gl_hash_table[i]);\n\t}\n\n\tglock_workqueue = alloc_workqueue(\"glock_workqueue\", WQ_MEM_RECLAIM |\n\t\t\t\t\t  WQ_HIGHPRI | WQ_FREEZABLE, 0);\n\tif (!glock_workqueue)\n\t\treturn -ENOMEM;\n\tgfs2_delete_workqueue = alloc_workqueue(\"delete_workqueue\",\n\t\t\t\t\t\tWQ_MEM_RECLAIM | WQ_FREEZABLE,\n\t\t\t\t\t\t0);\n\tif (!gfs2_delete_workqueue) {\n\t\tdestroy_workqueue(glock_workqueue);\n\t\treturn -ENOMEM;\n\t}\n\n\tregister_shrinker(&glock_shrinker);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_sbstats_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1776-1802",
    "snippet": "static int gfs2_sbstats_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\tstruct gfs2_sbd *sdp = gi->sdp;\n\tunsigned index = gi->hash >> 3;\n\tunsigned subindex = gi->hash & 0x07;\n\ts64 value;\n\tint i;\n\n\tif (index == 0 && subindex != 0)\n\t\treturn 0;\n\n\tseq_printf(seq, \"%-10s %8s:\", gfs2_gltype[index],\n\t\t   (index == 0) ? \"cpu\": gfs2_stype[subindex]);\n\n\tfor_each_possible_cpu(i) {\n                const struct gfs2_pcpu_lkstats *lkstats = per_cpu_ptr(sdp->sd_lkstats, i);\n\t\tif (index == 0) {\n\t\t\tvalue = i;\n\t\t} else {\n\t\t\tvalue = lkstats->lkstats[index - 1].stats[subindex];\n\t\t}\n\t\tseq_printf(seq, \" %15lld\", (long long)value);\n\t}\n\tseq_putc(seq, '\\n');\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *gfs2_gltype[] = {\n\t\"type\",\n\t\"reserved\",\n\t\"nondisk\",\n\t\"inode\",\n\t\"rgrp\",\n\t\"meta\",\n\t\"iopen\",\n\t\"flock\",\n\t\"plock\",\n\t\"quota\",\n\t\"journal\",\n};",
      "static const char *gfs2_stype[] = {\n\t[GFS2_LKS_SRTT]\t\t= \"srtt\",\n\t[GFS2_LKS_SRTTVAR]\t= \"srttvar\",\n\t[GFS2_LKS_SRTTB]\t= \"srttb\",\n\t[GFS2_LKS_SRTTVARB]\t= \"srttvarb\",\n\t[GFS2_LKS_SIRT]\t\t= \"sirt\",\n\t[GFS2_LKS_SIRTVAR]\t= \"sirtvar\",\n\t[GFS2_LKS_DCOUNT]\t= \"dlm\",\n\t[GFS2_LKS_QCOUNT]\t= \"queue\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_putc",
          "args": [
            "seq",
            "'\\n'"
          ],
          "line": 1800
        },
        "resolved": true,
        "details": {
          "function_name": "seq_putc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "648-655",
          "snippet": "int seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_putc(struct seq_file *m, char c)\n{\n\tif (m->count < m->size) {\n\t\tm->buf[m->count++] = c;\n\t\treturn 0;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\" %15lld\"",
            "(long long)value"
          ],
          "line": 1798
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "sdp->sd_lkstats",
            "i"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *gfs2_gltype[] = {\n\t\"type\",\n\t\"reserved\",\n\t\"nondisk\",\n\t\"inode\",\n\t\"rgrp\",\n\t\"meta\",\n\t\"iopen\",\n\t\"flock\",\n\t\"plock\",\n\t\"quota\",\n\t\"journal\",\n};\nstatic const char *gfs2_stype[] = {\n\t[GFS2_LKS_SRTT]\t\t= \"srtt\",\n\t[GFS2_LKS_SRTTVAR]\t= \"srttvar\",\n\t[GFS2_LKS_SRTTB]\t= \"srttb\",\n\t[GFS2_LKS_SRTTVARB]\t= \"srttvarb\",\n\t[GFS2_LKS_SIRT]\t\t= \"sirt\",\n\t[GFS2_LKS_SIRTVAR]\t= \"sirtvar\",\n\t[GFS2_LKS_DCOUNT]\t= \"dlm\",\n\t[GFS2_LKS_QCOUNT]\t= \"queue\",\n};\n\nstatic int gfs2_sbstats_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock_iter *gi = seq->private;\n\tstruct gfs2_sbd *sdp = gi->sdp;\n\tunsigned index = gi->hash >> 3;\n\tunsigned subindex = gi->hash & 0x07;\n\ts64 value;\n\tint i;\n\n\tif (index == 0 && subindex != 0)\n\t\treturn 0;\n\n\tseq_printf(seq, \"%-10s %8s:\", gfs2_gltype[index],\n\t\t   (index == 0) ? \"cpu\": gfs2_stype[subindex]);\n\n\tfor_each_possible_cpu(i) {\n                const struct gfs2_pcpu_lkstats *lkstats = per_cpu_ptr(sdp->sd_lkstats, i);\n\t\tif (index == 0) {\n\t\t\tvalue = i;\n\t\t} else {\n\t\t\tvalue = lkstats->lkstats[index - 1].stats[subindex];\n\t\t}\n\t\tseq_printf(seq, \" %15lld\", (long long)value);\n\t}\n\tseq_putc(seq, '\\n');\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_glstats_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1731-1747",
    "snippet": "static int gfs2_glstats_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock *gl = iter_ptr;\n\n\tseq_printf(seq, \"G: n:%u/%llx rtt:%lld/%lld rttb:%lld/%lld irt:%lld/%lld dcnt: %lld qcnt: %lld\\n\",\n\t\t   gl->gl_name.ln_type,\n\t\t   (unsigned long long)gl->gl_name.ln_number,\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTVAR],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTB],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTVARB],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SIRT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SIRTVAR],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_DCOUNT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_QCOUNT]);\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\"G: n:%u/%llx rtt:%lld/%lld rttb:%lld/%lld irt:%lld/%lld dcnt: %lld qcnt: %lld\\n\"",
            "gl->gl_name.ln_type",
            "(unsigned long long)gl->gl_name.ln_number",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SRTT]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SRTTVAR]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SRTTB]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SRTTVARB]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SIRT]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_SIRTVAR]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_DCOUNT]",
            "(long long)gl->gl_stats.stats[GFS2_LKS_QCOUNT]"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int gfs2_glstats_seq_show(struct seq_file *seq, void *iter_ptr)\n{\n\tstruct gfs2_glock *gl = iter_ptr;\n\n\tseq_printf(seq, \"G: n:%u/%llx rtt:%lld/%lld rttb:%lld/%lld irt:%lld/%lld dcnt: %lld qcnt: %lld\\n\",\n\t\t   gl->gl_name.ln_type,\n\t\t   (unsigned long long)gl->gl_name.ln_number,\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTVAR],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTB],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SRTTVARB],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SIRT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_SIRTVAR],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_DCOUNT],\n\t\t   (long long)gl->gl_stats.stats[GFS2_LKS_QCOUNT]);\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_dump_glock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1702-1729",
    "snippet": "void gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glops->go_dump",
          "args": [
            "seq",
            "gl"
          ],
          "line": 1728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_holder",
          "args": [
            "seq",
            "gh"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "dump_holder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1630-1646",
          "snippet": "static void dump_holder(struct seq_file *seq, const struct gfs2_holder *gh)\n{\n\tstruct task_struct *gh_owner = NULL;\n\tchar flags_buf[32];\n\n\trcu_read_lock();\n\tif (gh->gh_owner_pid)\n\t\tgh_owner = pid_task(gh->gh_owner_pid, PIDTYPE_PID);\n\tgfs2_print_dbg(seq, \" H: s:%s f:%s e:%d p:%ld [%s] %pS\\n\",\n\t\t       state2str(gh->gh_state),\n\t\t       hflags2str(flags_buf, gh->gh_flags, gh->gh_iflags),\n\t\t       gh->gh_error,\n\t\t       gh->gh_owner_pid ? (long)pid_nr(gh->gh_owner_pid) : -1,\n\t\t       gh_owner ? gh_owner->comm : \"(ended)\",\n\t\t       (void *)gh->gh_ip);\n\trcu_read_unlock();\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void dump_holder(struct seq_file *seq, const struct gfs2_holder *gh)\n{\n\tstruct task_struct *gh_owner = NULL;\n\tchar flags_buf[32];\n\n\trcu_read_lock();\n\tif (gh->gh_owner_pid)\n\t\tgh_owner = pid_task(gh->gh_owner_pid, PIDTYPE_PID);\n\tgfs2_print_dbg(seq, \" H: s:%s f:%s e:%d p:%ld [%s] %pS\\n\",\n\t\t       state2str(gh->gh_state),\n\t\t       hflags2str(flags_buf, gh->gh_flags, gh->gh_iflags),\n\t\t       gh->gh_error,\n\t\t       gh->gh_owner_pid ? (long)pid_nr(gh->gh_owner_pid) : -1,\n\t\t       gh_owner ? gh_owner->comm : \"(ended)\",\n\t\t       (void *)gh->gh_ip);\n\trcu_read_unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gh",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 1724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_print_dbg",
          "args": [
            "seq",
            "\"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\"",
            "state2str(gl->gl_state)",
            "gl->gl_name.ln_type",
            "(unsigned long long)gl->gl_name.ln_number",
            "gflags2str(gflags_buf, gl)",
            "state2str(gl->gl_target)",
            "state2str(gl->gl_demote_state)",
            "dtime",
            "atomic_read(&gl->gl_ail_count)",
            "atomic_read(&gl->gl_revokes)",
            "(int)gl->gl_lockref.count",
            "gl->gl_hold_time"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_print_dbg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "897-914",
          "snippet": "void gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&gl->gl_revokes"
          ],
          "line": 1721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&gl->gl_ail_count"
          ],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "state2str",
          "args": [
            "gl->gl_demote_state"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "state2str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1579-1592",
          "snippet": "static const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "gflags2str",
          "args": [
            "gflags_buf",
            "gl"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "gflags2str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1648-1683",
          "snippet": "static const char *gflags2str(char *buf, const struct gfs2_glock *gl)\n{\n\tconst unsigned long *gflags = &gl->gl_flags;\n\tchar *p = buf;\n\n\tif (test_bit(GLF_LOCK, gflags))\n\t\t*p++ = 'l';\n\tif (test_bit(GLF_DEMOTE, gflags))\n\t\t*p++ = 'D';\n\tif (test_bit(GLF_PENDING_DEMOTE, gflags))\n\t\t*p++ = 'd';\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, gflags))\n\t\t*p++ = 'p';\n\tif (test_bit(GLF_DIRTY, gflags))\n\t\t*p++ = 'y';\n\tif (test_bit(GLF_LFLUSH, gflags))\n\t\t*p++ = 'f';\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, gflags))\n\t\t*p++ = 'i';\n\tif (test_bit(GLF_REPLY_PENDING, gflags))\n\t\t*p++ = 'r';\n\tif (test_bit(GLF_INITIAL, gflags))\n\t\t*p++ = 'I';\n\tif (test_bit(GLF_FROZEN, gflags))\n\t\t*p++ = 'F';\n\tif (test_bit(GLF_QUEUED, gflags))\n\t\t*p++ = 'q';\n\tif (test_bit(GLF_LRU, gflags))\n\t\t*p++ = 'L';\n\tif (gl->gl_object)\n\t\t*p++ = 'o';\n\tif (test_bit(GLF_BLOCKING, gflags))\n\t\t*p++ = 'b';\n\t*p = 0;\n\treturn buf;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *gflags2str(char *buf, const struct gfs2_glock *gl)\n{\n\tconst unsigned long *gflags = &gl->gl_flags;\n\tchar *p = buf;\n\n\tif (test_bit(GLF_LOCK, gflags))\n\t\t*p++ = 'l';\n\tif (test_bit(GLF_DEMOTE, gflags))\n\t\t*p++ = 'D';\n\tif (test_bit(GLF_PENDING_DEMOTE, gflags))\n\t\t*p++ = 'd';\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, gflags))\n\t\t*p++ = 'p';\n\tif (test_bit(GLF_DIRTY, gflags))\n\t\t*p++ = 'y';\n\tif (test_bit(GLF_LFLUSH, gflags))\n\t\t*p++ = 'f';\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, gflags))\n\t\t*p++ = 'i';\n\tif (test_bit(GLF_REPLY_PENDING, gflags))\n\t\t*p++ = 'r';\n\tif (test_bit(GLF_INITIAL, gflags))\n\t\t*p++ = 'I';\n\tif (test_bit(GLF_FROZEN, gflags))\n\t\t*p++ = 'F';\n\tif (test_bit(GLF_QUEUED, gflags))\n\t\t*p++ = 'q';\n\tif (test_bit(GLF_LRU, gflags))\n\t\t*p++ = 'L';\n\tif (gl->gl_object)\n\t\t*p++ = 'o';\n\tif (test_bit(GLF_BLOCKING, gflags))\n\t\t*p++ = 'b';\n\t*p = 0;\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}"
  },
  {
    "function_name": "gflags2str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1648-1683",
    "snippet": "static const char *gflags2str(char *buf, const struct gfs2_glock *gl)\n{\n\tconst unsigned long *gflags = &gl->gl_flags;\n\tchar *p = buf;\n\n\tif (test_bit(GLF_LOCK, gflags))\n\t\t*p++ = 'l';\n\tif (test_bit(GLF_DEMOTE, gflags))\n\t\t*p++ = 'D';\n\tif (test_bit(GLF_PENDING_DEMOTE, gflags))\n\t\t*p++ = 'd';\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, gflags))\n\t\t*p++ = 'p';\n\tif (test_bit(GLF_DIRTY, gflags))\n\t\t*p++ = 'y';\n\tif (test_bit(GLF_LFLUSH, gflags))\n\t\t*p++ = 'f';\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, gflags))\n\t\t*p++ = 'i';\n\tif (test_bit(GLF_REPLY_PENDING, gflags))\n\t\t*p++ = 'r';\n\tif (test_bit(GLF_INITIAL, gflags))\n\t\t*p++ = 'I';\n\tif (test_bit(GLF_FROZEN, gflags))\n\t\t*p++ = 'F';\n\tif (test_bit(GLF_QUEUED, gflags))\n\t\t*p++ = 'q';\n\tif (test_bit(GLF_LRU, gflags))\n\t\t*p++ = 'L';\n\tif (gl->gl_object)\n\t\t*p++ = 'o';\n\tif (test_bit(GLF_BLOCKING, gflags))\n\t\t*p++ = 'b';\n\t*p = 0;\n\treturn buf;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_BLOCKING",
            "gflags"
          ],
          "line": 1679
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *gflags2str(char *buf, const struct gfs2_glock *gl)\n{\n\tconst unsigned long *gflags = &gl->gl_flags;\n\tchar *p = buf;\n\n\tif (test_bit(GLF_LOCK, gflags))\n\t\t*p++ = 'l';\n\tif (test_bit(GLF_DEMOTE, gflags))\n\t\t*p++ = 'D';\n\tif (test_bit(GLF_PENDING_DEMOTE, gflags))\n\t\t*p++ = 'd';\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, gflags))\n\t\t*p++ = 'p';\n\tif (test_bit(GLF_DIRTY, gflags))\n\t\t*p++ = 'y';\n\tif (test_bit(GLF_LFLUSH, gflags))\n\t\t*p++ = 'f';\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, gflags))\n\t\t*p++ = 'i';\n\tif (test_bit(GLF_REPLY_PENDING, gflags))\n\t\t*p++ = 'r';\n\tif (test_bit(GLF_INITIAL, gflags))\n\t\t*p++ = 'I';\n\tif (test_bit(GLF_FROZEN, gflags))\n\t\t*p++ = 'F';\n\tif (test_bit(GLF_QUEUED, gflags))\n\t\t*p++ = 'q';\n\tif (test_bit(GLF_LRU, gflags))\n\t\t*p++ = 'L';\n\tif (gl->gl_object)\n\t\t*p++ = 'o';\n\tif (test_bit(GLF_BLOCKING, gflags))\n\t\t*p++ = 'b';\n\t*p = 0;\n\treturn buf;\n}"
  },
  {
    "function_name": "dump_holder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1630-1646",
    "snippet": "static void dump_holder(struct seq_file *seq, const struct gfs2_holder *gh)\n{\n\tstruct task_struct *gh_owner = NULL;\n\tchar flags_buf[32];\n\n\trcu_read_lock();\n\tif (gh->gh_owner_pid)\n\t\tgh_owner = pid_task(gh->gh_owner_pid, PIDTYPE_PID);\n\tgfs2_print_dbg(seq, \" H: s:%s f:%s e:%d p:%ld [%s] %pS\\n\",\n\t\t       state2str(gh->gh_state),\n\t\t       hflags2str(flags_buf, gh->gh_flags, gh->gh_iflags),\n\t\t       gh->gh_error,\n\t\t       gh->gh_owner_pid ? (long)pid_nr(gh->gh_owner_pid) : -1,\n\t\t       gh_owner ? gh_owner->comm : \"(ended)\",\n\t\t       (void *)gh->gh_ip);\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_print_dbg",
          "args": [
            "seq",
            "\" H: s:%s f:%s e:%d p:%ld [%s] %pS\\n\"",
            "state2str(gh->gh_state)",
            "hflags2str(flags_buf, gh->gh_flags, gh->gh_iflags)",
            "gh->gh_error",
            "gh->gh_owner_pid ? (long)pid_nr(gh->gh_owner_pid) : -1",
            "gh_owner ? gh_owner->comm : \"(ended)\"",
            "(void *)gh->gh_ip"
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_print_dbg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "897-914",
          "snippet": "void gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pid_nr",
          "args": [
            "gh->gh_owner_pid"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hflags2str",
          "args": [
            "flags_buf",
            "gh->gh_flags",
            "gh->gh_iflags"
          ],
          "line": 1640
        },
        "resolved": true,
        "details": {
          "function_name": "hflags2str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1594-1621",
          "snippet": "static const char *hflags2str(char *buf, unsigned flags, unsigned long iflags)\n{\n\tchar *p = buf;\n\tif (flags & LM_FLAG_TRY)\n\t\t*p++ = 't';\n\tif (flags & LM_FLAG_TRY_1CB)\n\t\t*p++ = 'T';\n\tif (flags & LM_FLAG_NOEXP)\n\t\t*p++ = 'e';\n\tif (flags & LM_FLAG_ANY)\n\t\t*p++ = 'A';\n\tif (flags & LM_FLAG_PRIORITY)\n\t\t*p++ = 'p';\n\tif (flags & GL_ASYNC)\n\t\t*p++ = 'a';\n\tif (flags & GL_EXACT)\n\t\t*p++ = 'E';\n\tif (flags & GL_NOCACHE)\n\t\t*p++ = 'c';\n\tif (test_bit(HIF_HOLDER, &iflags))\n\t\t*p++ = 'H';\n\tif (test_bit(HIF_WAIT, &iflags))\n\t\t*p++ = 'W';\n\tif (test_bit(HIF_FIRST, &iflags))\n\t\t*p++ = 'F';\n\t*p = 0;\n\treturn buf;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *hflags2str(char *buf, unsigned flags, unsigned long iflags)\n{\n\tchar *p = buf;\n\tif (flags & LM_FLAG_TRY)\n\t\t*p++ = 't';\n\tif (flags & LM_FLAG_TRY_1CB)\n\t\t*p++ = 'T';\n\tif (flags & LM_FLAG_NOEXP)\n\t\t*p++ = 'e';\n\tif (flags & LM_FLAG_ANY)\n\t\t*p++ = 'A';\n\tif (flags & LM_FLAG_PRIORITY)\n\t\t*p++ = 'p';\n\tif (flags & GL_ASYNC)\n\t\t*p++ = 'a';\n\tif (flags & GL_EXACT)\n\t\t*p++ = 'E';\n\tif (flags & GL_NOCACHE)\n\t\t*p++ = 'c';\n\tif (test_bit(HIF_HOLDER, &iflags))\n\t\t*p++ = 'H';\n\tif (test_bit(HIF_WAIT, &iflags))\n\t\t*p++ = 'W';\n\tif (test_bit(HIF_FIRST, &iflags))\n\t\t*p++ = 'F';\n\t*p = 0;\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "state2str",
          "args": [
            "gh->gh_state"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "state2str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1579-1592",
          "snippet": "static const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "pid_task",
          "args": [
            "gh->gh_owner_pid",
            "PIDTYPE_PID"
          ],
          "line": 1637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void dump_holder(struct seq_file *seq, const struct gfs2_holder *gh)\n{\n\tstruct task_struct *gh_owner = NULL;\n\tchar flags_buf[32];\n\n\trcu_read_lock();\n\tif (gh->gh_owner_pid)\n\t\tgh_owner = pid_task(gh->gh_owner_pid, PIDTYPE_PID);\n\tgfs2_print_dbg(seq, \" H: s:%s f:%s e:%d p:%ld [%s] %pS\\n\",\n\t\t       state2str(gh->gh_state),\n\t\t       hflags2str(flags_buf, gh->gh_flags, gh->gh_iflags),\n\t\t       gh->gh_error,\n\t\t       gh->gh_owner_pid ? (long)pid_nr(gh->gh_owner_pid) : -1,\n\t\t       gh_owner ? gh_owner->comm : \"(ended)\",\n\t\t       (void *)gh->gh_ip);\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "hflags2str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1594-1621",
    "snippet": "static const char *hflags2str(char *buf, unsigned flags, unsigned long iflags)\n{\n\tchar *p = buf;\n\tif (flags & LM_FLAG_TRY)\n\t\t*p++ = 't';\n\tif (flags & LM_FLAG_TRY_1CB)\n\t\t*p++ = 'T';\n\tif (flags & LM_FLAG_NOEXP)\n\t\t*p++ = 'e';\n\tif (flags & LM_FLAG_ANY)\n\t\t*p++ = 'A';\n\tif (flags & LM_FLAG_PRIORITY)\n\t\t*p++ = 'p';\n\tif (flags & GL_ASYNC)\n\t\t*p++ = 'a';\n\tif (flags & GL_EXACT)\n\t\t*p++ = 'E';\n\tif (flags & GL_NOCACHE)\n\t\t*p++ = 'c';\n\tif (test_bit(HIF_HOLDER, &iflags))\n\t\t*p++ = 'H';\n\tif (test_bit(HIF_WAIT, &iflags))\n\t\t*p++ = 'W';\n\tif (test_bit(HIF_FIRST, &iflags))\n\t\t*p++ = 'F';\n\t*p = 0;\n\treturn buf;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_FIRST",
            "&iflags"
          ],
          "line": 1617
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *hflags2str(char *buf, unsigned flags, unsigned long iflags)\n{\n\tchar *p = buf;\n\tif (flags & LM_FLAG_TRY)\n\t\t*p++ = 't';\n\tif (flags & LM_FLAG_TRY_1CB)\n\t\t*p++ = 'T';\n\tif (flags & LM_FLAG_NOEXP)\n\t\t*p++ = 'e';\n\tif (flags & LM_FLAG_ANY)\n\t\t*p++ = 'A';\n\tif (flags & LM_FLAG_PRIORITY)\n\t\t*p++ = 'p';\n\tif (flags & GL_ASYNC)\n\t\t*p++ = 'a';\n\tif (flags & GL_EXACT)\n\t\t*p++ = 'E';\n\tif (flags & GL_NOCACHE)\n\t\t*p++ = 'c';\n\tif (test_bit(HIF_HOLDER, &iflags))\n\t\t*p++ = 'H';\n\tif (test_bit(HIF_WAIT, &iflags))\n\t\t*p++ = 'W';\n\tif (test_bit(HIF_FIRST, &iflags))\n\t\t*p++ = 'F';\n\t*p = 0;\n\treturn buf;\n}"
  },
  {
    "function_name": "state2str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1579-1592",
    "snippet": "static const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const char *state2str(unsigned state)\n{\n\tswitch(state) {\n\tcase LM_ST_UNLOCKED:\n\t\treturn \"UN\";\n\tcase LM_ST_SHARED:\n\t\treturn \"SH\";\n\tcase LM_ST_DEFERRED:\n\t\treturn \"DF\";\n\tcase LM_ST_EXCLUSIVE:\n\t\treturn \"EX\";\n\t}\n\treturn \"??\";\n}"
  },
  {
    "function_name": "gfs2_glock_finish_truncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1565-1577",
    "snippet": "void gfs2_glock_finish_truncate(struct gfs2_inode *ip)\n{\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint ret;\n\n\tret = gfs2_truncatei_resume(ip);\n\tgfs2_assert_withdraw(gl->gl_sbd, ret == 0);\n\n\tspin_lock(&gl->gl_spin);\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1576
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "run_queue",
          "args": [
            "gl",
            "1"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "run_queue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "576-626",
          "snippet": "static void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_assert_withdraw",
          "args": [
            "gl->gl_sbd",
            "ret == 0"
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_truncatei_resume",
          "args": [
            "ip"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_truncatei_resume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/bmap.c",
          "lines": "1317-1324",
          "snippet": "int gfs2_truncatei_resume(struct gfs2_inode *ip)\n{\n\tint error;\n\terror = trunc_dealloc(ip, i_size_read(&ip->i_inode));\n\tif (!error)\n\t\terror = trunc_end(ip);\n\treturn error;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"util.h\"",
            "#include \"dir.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"log.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"util.h\"\n#include \"dir.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"log.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/blkdev.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nint gfs2_truncatei_resume(struct gfs2_inode *ip)\n{\n\tint error;\n\terror = trunc_dealloc(ip, i_size_read(&ip->i_inode));\n\tif (!error)\n\t\terror = trunc_end(ip);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_finish_truncate(struct gfs2_inode *ip)\n{\n\tstruct gfs2_glock *gl = ip->i_gl;\n\tint ret;\n\n\tret = gfs2_truncatei_resume(ip);\n\tgfs2_assert_withdraw(gl->gl_sbd, ret == 0);\n\n\tspin_lock(&gl->gl_spin);\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n}"
  },
  {
    "function_name": "gfs2_gl_hash_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1555-1563",
    "snippet": "void gfs2_gl_hash_clear(struct gfs2_sbd *sdp)\n{\n\tset_bit(SDF_SKIP_DLM_UNLOCK, &sdp->sd_flags);\n\tflush_workqueue(glock_workqueue);\n\tglock_hash_walk(clear_glock, sdp);\n\tflush_workqueue(glock_workqueue);\n\twait_event(sdp->sd_glock_wait, atomic_read(&sdp->sd_glock_disposal) == 0);\n\tglock_hash_walk(dump_glock_func, sdp);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "glock_hash_walk",
          "args": [
            "dump_glock_func",
            "sdp"
          ],
          "line": 1562
        },
        "resolved": true,
        "details": {
          "function_name": "glock_hash_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1480-1486",
          "snippet": "static void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_event",
          "args": [
            "sdp->sd_glock_wait",
            "atomic_read(&sdp->sd_glock_disposal) == 0"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&sdp->sd_glock_disposal"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_workqueue",
          "args": [
            "glock_workqueue"
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_workqueue",
          "args": [
            "glock_workqueue"
          ],
          "line": 1558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "SDF_SKIP_DLM_UNLOCK",
            "&sdp->sd_flags"
          ],
          "line": 1557
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nvoid gfs2_gl_hash_clear(struct gfs2_sbd *sdp)\n{\n\tset_bit(SDF_SKIP_DLM_UNLOCK, &sdp->sd_flags);\n\tflush_workqueue(glock_workqueue);\n\tglock_hash_walk(clear_glock, sdp);\n\tflush_workqueue(glock_workqueue);\n\twait_event(sdp->sd_glock_wait, atomic_read(&sdp->sd_glock_disposal) == 0);\n\tglock_hash_walk(dump_glock_func, sdp);\n}"
  },
  {
    "function_name": "dump_glock_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1542-1545",
    "snippet": "static void dump_glock_func(struct gfs2_glock *gl)\n{\n\tdump_glock(NULL, gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_glock",
          "args": [
            "NULL",
            "gl"
          ],
          "line": 1544
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dump_glock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1702-1729",
          "snippet": "void gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void dump_glock_func(struct gfs2_glock *gl)\n{\n\tdump_glock(NULL, gl);\n}"
  },
  {
    "function_name": "dump_glock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1535-1540",
    "snippet": "static void dump_glock(struct seq_file *seq, struct gfs2_glock *gl)\n{\n\tspin_lock(&gl->gl_spin);\n\tgfs2_dump_glock(seq, gl);\n\tspin_unlock(&gl->gl_spin);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1539
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_dump_glock",
          "args": [
            "seq",
            "gl"
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dump_glock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1702-1729",
          "snippet": "void gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1537
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void dump_glock(struct seq_file *seq, struct gfs2_glock *gl)\n{\n\tspin_lock(&gl->gl_spin);\n\tgfs2_dump_glock(seq, gl);\n\tspin_unlock(&gl->gl_spin);\n}"
  },
  {
    "function_name": "gfs2_glock_thaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1530-1533",
    "snippet": "void gfs2_glock_thaw(struct gfs2_sbd *sdp)\n{\n\tglock_hash_walk(thaw_glock, sdp);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glock_hash_walk",
          "args": [
            "thaw_glock",
            "sdp"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "glock_hash_walk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1480-1486",
          "snippet": "static void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_thaw(struct gfs2_sbd *sdp)\n{\n\tglock_hash_walk(thaw_glock, sdp);\n}"
  },
  {
    "function_name": "clear_glock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1512-1522",
    "snippet": "static void clear_glock(struct gfs2_glock *gl)\n{\n\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tif (gl->gl_state != LM_ST_UNLOCKED)\n\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 1520
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_callback",
          "args": [
            "gl",
            "LM_ST_UNLOCKED",
            "0",
            "false"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "handle_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "879-895",
          "snippet": "static void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1516
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_remove_from_lru",
          "args": [
            "gl"
          ],
          "line": 1514
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_remove_from_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "176-185",
          "snippet": "static void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void clear_glock(struct gfs2_glock *gl)\n{\n\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tif (gl->gl_state != LM_ST_UNLOCKED)\n\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "thaw_glock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1495-1504",
    "snippet": "static void thaw_glock(struct gfs2_glock *gl)\n{\n\tif (!test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))\n\t\tgoto out;\n\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0) {\nout:\n\t\tgfs2_glock_put(gl);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1502
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 1500
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_REPLY_PENDING",
            "&gl->gl_flags"
          ],
          "line": 1499
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "GLF_FROZEN",
            "&gl->gl_flags"
          ],
          "line": 1497
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void thaw_glock(struct gfs2_glock *gl)\n{\n\tif (!test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))\n\t\tgoto out;\n\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0) {\nout:\n\t\tgfs2_glock_put(gl);\n\t}\n}"
  },
  {
    "function_name": "glock_hash_walk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1480-1486",
    "snippet": "static void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "examine_bucket",
          "args": [
            "examiner",
            "sdp",
            "x"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "examine_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1464-1478",
          "snippet": "static void examine_bucket(glock_examiner examiner, const struct gfs2_sbd *sdp,\n\t\t\t  unsigned int hash)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_head *head = &gl_hash_table[hash];\n\tstruct hlist_bl_node *pos;\n\n\trcu_read_lock();\n\thlist_bl_for_each_entry_rcu(gl, pos, head, gl_list) {\n\t\tif ((gl->gl_sbd == sdp) && lockref_get_not_dead(&gl->gl_lockref))\n\t\t\texaminer(gl);\n\t}\n\trcu_read_unlock();\n\tcond_resched();\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic void examine_bucket(glock_examiner examiner, const struct gfs2_sbd *sdp,\n\t\t\t  unsigned int hash)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_head *head = &gl_hash_table[hash];\n\tstruct hlist_bl_node *pos;\n\n\trcu_read_lock();\n\thlist_bl_for_each_entry_rcu(gl, pos, head, gl_list) {\n\t\tif ((gl->gl_sbd == sdp) && lockref_get_not_dead(&gl->gl_lockref))\n\t\t\texaminer(gl);\n\t}\n\trcu_read_unlock();\n\tcond_resched();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_SIZE       (1 << GFS2_GL_HASH_SHIFT)\n\nstatic void glock_hash_walk(glock_examiner examiner, const struct gfs2_sbd *sdp)\n{\n\tunsigned x;\n\n\tfor (x = 0; x < GFS2_GL_HASH_SIZE; x++)\n\t\texamine_bucket(examiner, sdp, x);\n}"
  },
  {
    "function_name": "examine_bucket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1464-1478",
    "snippet": "static void examine_bucket(glock_examiner examiner, const struct gfs2_sbd *sdp,\n\t\t\t  unsigned int hash)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_head *head = &gl_hash_table[hash];\n\tstruct hlist_bl_node *pos;\n\n\trcu_read_lock();\n\thlist_bl_for_each_entry_rcu(gl, pos, head, gl_list) {\n\t\tif ((gl->gl_sbd == sdp) && lockref_get_not_dead(&gl->gl_lockref))\n\t\t\texaminer(gl);\n\t}\n\trcu_read_unlock();\n\tcond_resched();\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "examiner",
          "args": [
            "gl"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockref_get_not_dead",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 1473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry_rcu",
          "args": [
            "gl",
            "pos",
            "head",
            "gl_list"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic void examine_bucket(glock_examiner examiner, const struct gfs2_sbd *sdp,\n\t\t\t  unsigned int hash)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_head *head = &gl_hash_table[hash];\n\tstruct hlist_bl_node *pos;\n\n\trcu_read_lock();\n\thlist_bl_for_each_entry_rcu(gl, pos, head, gl_list) {\n\t\tif ((gl->gl_sbd == sdp) && lockref_get_not_dead(&gl->gl_lockref))\n\t\t\texaminer(gl);\n\t}\n\trcu_read_unlock();\n\tcond_resched();\n}"
  },
  {
    "function_name": "gfs2_glock_shrink_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1444-1448",
    "snippet": "static unsigned long gfs2_glock_shrink_count(struct shrinker *shrink,\n\t\t\t\t\t     struct shrink_control *sc)\n{\n\treturn vfs_pressure_ratio(atomic_read(&lru_count));\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_t lru_count = ATOMIC_INIT(0);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_pressure_ratio",
          "args": [
            "atomic_read(&lru_count)"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&lru_count"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic atomic_t lru_count = ATOMIC_INIT(0);\n\nstatic unsigned long gfs2_glock_shrink_count(struct shrinker *shrink,\n\t\t\t\t\t     struct shrink_control *sc)\n{\n\treturn vfs_pressure_ratio(atomic_read(&lru_count));\n}"
  },
  {
    "function_name": "gfs2_glock_shrink_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1436-1442",
    "snippet": "static unsigned long gfs2_glock_shrink_scan(struct shrinker *shrink,\n\t\t\t\t\t    struct shrink_control *sc)\n{\n\tif (!(sc->gfp_mask & __GFP_FS))\n\t\treturn SHRINK_STOP;\n\treturn gfs2_scan_glock_lru(sc->nr_to_scan);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_scan_glock_lru",
          "args": [
            "sc->nr_to_scan"
          ],
          "line": 1441
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_scan_glock_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1407-1434",
          "snippet": "static long gfs2_scan_glock_lru(int nr)\n{\n\tstruct gfs2_glock *gl;\n\tLIST_HEAD(skipped);\n\tLIST_HEAD(dispose);\n\tlong freed = 0;\n\n\tspin_lock(&lru_lock);\n\twhile ((nr-- >= 0) && !list_empty(&lru_list)) {\n\t\tgl = list_entry(lru_list.next, struct gfs2_glock, gl_lru);\n\n\t\t/* Test for being demotable */\n\t\tif (!test_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tlist_move(&gl->gl_lru, &dispose);\n\t\t\tatomic_dec(&lru_count);\n\t\t\tfreed++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlist_move(&gl->gl_lru, &skipped);\n\t}\n\tlist_splice(&skipped, &lru_list);\n\tif (!list_empty(&dispose))\n\t\tgfs2_dispose_glock_lru(&dispose);\n\tspin_unlock(&lru_lock);\n\n\treturn freed;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(lru_list);",
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic long gfs2_scan_glock_lru(int nr)\n{\n\tstruct gfs2_glock *gl;\n\tLIST_HEAD(skipped);\n\tLIST_HEAD(dispose);\n\tlong freed = 0;\n\n\tspin_lock(&lru_lock);\n\twhile ((nr-- >= 0) && !list_empty(&lru_list)) {\n\t\tgl = list_entry(lru_list.next, struct gfs2_glock, gl_lru);\n\n\t\t/* Test for being demotable */\n\t\tif (!test_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tlist_move(&gl->gl_lru, &dispose);\n\t\t\tatomic_dec(&lru_count);\n\t\t\tfreed++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlist_move(&gl->gl_lru, &skipped);\n\t}\n\tlist_splice(&skipped, &lru_list);\n\tif (!list_empty(&dispose))\n\t\tgfs2_dispose_glock_lru(&dispose);\n\tspin_unlock(&lru_lock);\n\n\treturn freed;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic unsigned long gfs2_glock_shrink_scan(struct shrinker *shrink,\n\t\t\t\t\t    struct shrink_control *sc)\n{\n\tif (!(sc->gfp_mask & __GFP_FS))\n\t\treturn SHRINK_STOP;\n\treturn gfs2_scan_glock_lru(sc->nr_to_scan);\n}"
  },
  {
    "function_name": "gfs2_scan_glock_lru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1407-1434",
    "snippet": "static long gfs2_scan_glock_lru(int nr)\n{\n\tstruct gfs2_glock *gl;\n\tLIST_HEAD(skipped);\n\tLIST_HEAD(dispose);\n\tlong freed = 0;\n\n\tspin_lock(&lru_lock);\n\twhile ((nr-- >= 0) && !list_empty(&lru_list)) {\n\t\tgl = list_entry(lru_list.next, struct gfs2_glock, gl_lru);\n\n\t\t/* Test for being demotable */\n\t\tif (!test_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tlist_move(&gl->gl_lru, &dispose);\n\t\t\tatomic_dec(&lru_count);\n\t\t\tfreed++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlist_move(&gl->gl_lru, &skipped);\n\t}\n\tlist_splice(&skipped, &lru_list);\n\tif (!list_empty(&dispose))\n\t\tgfs2_dispose_glock_lru(&dispose);\n\tspin_unlock(&lru_lock);\n\n\treturn freed;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(lru_list);",
      "static atomic_t lru_count = ATOMIC_INIT(0);",
      "static DEFINE_SPINLOCK(lru_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lru_lock"
          ],
          "line": 1431
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_dispose_glock_lru",
          "args": [
            "&dispose"
          ],
          "line": 1430
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dispose_glock_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1365-1396",
          "snippet": "static void gfs2_dispose_glock_lru(struct list_head *list)\n__releases(&lru_lock)\n__acquires(&lru_lock)\n{\n\tstruct gfs2_glock *gl;\n\n\tlist_sort(NULL, list, glock_cmp);\n\n\twhile(!list_empty(list)) {\n\t\tgl = list_entry(list->next, struct gfs2_glock, gl_lru);\n\t\tlist_del_init(&gl->gl_lru);\n\t\tif (!spin_trylock(&gl->gl_spin)) {\nadd_back_to_lru:\n\t\t\tlist_add(&gl->gl_lru, &lru_list);\n\t\t\tatomic_inc(&lru_count);\n\t\t\tcontinue;\n\t\t}\n\t\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tgoto add_back_to_lru;\n\t\t}\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (demote_ok(gl))\n\t\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\t\tWARN_ON(!test_and_clear_bit(GLF_LOCK, &gl->gl_flags));\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t\tspin_unlock(&gl->gl_spin);\n\t\tcond_resched_lock(&lru_lock);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;",
            "static LIST_HEAD(lru_list);",
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_dispose_glock_lru(struct list_head *list)\n__releases(&lru_lock)\n__acquires(&lru_lock)\n{\n\tstruct gfs2_glock *gl;\n\n\tlist_sort(NULL, list, glock_cmp);\n\n\twhile(!list_empty(list)) {\n\t\tgl = list_entry(list->next, struct gfs2_glock, gl_lru);\n\t\tlist_del_init(&gl->gl_lru);\n\t\tif (!spin_trylock(&gl->gl_spin)) {\nadd_back_to_lru:\n\t\t\tlist_add(&gl->gl_lru, &lru_list);\n\t\t\tatomic_inc(&lru_count);\n\t\t\tcontinue;\n\t\t}\n\t\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tgoto add_back_to_lru;\n\t\t}\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (demote_ok(gl))\n\t\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\t\tWARN_ON(!test_and_clear_bit(GLF_LOCK, &gl->gl_flags));\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t\tspin_unlock(&gl->gl_spin);\n\t\tcond_resched_lock(&lru_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&dispose"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_splice",
          "args": [
            "&skipped",
            "&lru_list"
          ],
          "line": 1428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_move",
          "args": [
            "&gl->gl_lru",
            "&skipped"
          ],
          "line": 1426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&lru_count"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_move",
          "args": [
            "&gl->gl_lru",
            "&dispose"
          ],
          "line": 1420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "lru_list.next",
            "structgfs2_glock",
            "gl_lru"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lru_lock"
          ],
          "line": 1414
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "dispose"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "skipped"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic long gfs2_scan_glock_lru(int nr)\n{\n\tstruct gfs2_glock *gl;\n\tLIST_HEAD(skipped);\n\tLIST_HEAD(dispose);\n\tlong freed = 0;\n\n\tspin_lock(&lru_lock);\n\twhile ((nr-- >= 0) && !list_empty(&lru_list)) {\n\t\tgl = list_entry(lru_list.next, struct gfs2_glock, gl_lru);\n\n\t\t/* Test for being demotable */\n\t\tif (!test_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tlist_move(&gl->gl_lru, &dispose);\n\t\t\tatomic_dec(&lru_count);\n\t\t\tfreed++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlist_move(&gl->gl_lru, &skipped);\n\t}\n\tlist_splice(&skipped, &lru_list);\n\tif (!list_empty(&dispose))\n\t\tgfs2_dispose_glock_lru(&dispose);\n\tspin_unlock(&lru_lock);\n\n\treturn freed;\n}"
  },
  {
    "function_name": "gfs2_dispose_glock_lru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1365-1396",
    "snippet": "static void gfs2_dispose_glock_lru(struct list_head *list)\n__releases(&lru_lock)\n__acquires(&lru_lock)\n{\n\tstruct gfs2_glock *gl;\n\n\tlist_sort(NULL, list, glock_cmp);\n\n\twhile(!list_empty(list)) {\n\t\tgl = list_entry(list->next, struct gfs2_glock, gl_lru);\n\t\tlist_del_init(&gl->gl_lru);\n\t\tif (!spin_trylock(&gl->gl_spin)) {\nadd_back_to_lru:\n\t\t\tlist_add(&gl->gl_lru, &lru_list);\n\t\t\tatomic_inc(&lru_count);\n\t\t\tcontinue;\n\t\t}\n\t\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tgoto add_back_to_lru;\n\t\t}\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (demote_ok(gl))\n\t\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\t\tWARN_ON(!test_and_clear_bit(GLF_LOCK, &gl->gl_flags));\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t\tspin_unlock(&gl->gl_spin);\n\t\tcond_resched_lock(&lru_lock);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;",
      "static LIST_HEAD(lru_list);",
      "static atomic_t lru_count = ATOMIC_INIT(0);",
      "static DEFINE_SPINLOCK(lru_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched_lock",
          "args": [
            "&lru_lock"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1393
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 1391
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!test_and_clear_bit(GLF_LOCK, &gl->gl_flags)"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1390
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_callback",
          "args": [
            "gl",
            "LM_ST_UNLOCKED",
            "0",
            "false"
          ],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "handle_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "879-895",
          "snippet": "static void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}"
        }
      },
      {
        "call_info": {
          "callee": "demote_ok",
          "args": [
            "gl"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "demote_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "148-159",
          "snippet": "static int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LRU",
            "&gl->gl_flags"
          ],
          "line": 1386
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1382
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&lru_count"
          ],
          "line": 1379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&gl->gl_lru",
            "&lru_list"
          ],
          "line": 1378
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_trylock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "list->next",
            "structgfs2_glock",
            "gl_lru"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "list"
          ],
          "line": 1373
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_sort",
          "args": [
            "NULL",
            "list",
            "glock_cmp"
          ],
          "line": 1371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&lru_lock"
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&lru_lock"
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_dispose_glock_lru(struct list_head *list)\n__releases(&lru_lock)\n__acquires(&lru_lock)\n{\n\tstruct gfs2_glock *gl;\n\n\tlist_sort(NULL, list, glock_cmp);\n\n\twhile(!list_empty(list)) {\n\t\tgl = list_entry(list->next, struct gfs2_glock, gl_lru);\n\t\tlist_del_init(&gl->gl_lru);\n\t\tif (!spin_trylock(&gl->gl_spin)) {\nadd_back_to_lru:\n\t\t\tlist_add(&gl->gl_lru, &lru_list);\n\t\t\tatomic_inc(&lru_count);\n\t\t\tcontinue;\n\t\t}\n\t\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags)) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tgoto add_back_to_lru;\n\t\t}\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (demote_ok(gl))\n\t\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\t\tWARN_ON(!test_and_clear_bit(GLF_LOCK, &gl->gl_flags));\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t\tspin_unlock(&gl->gl_spin);\n\t\tcond_resched_lock(&lru_lock);\n\t}\n}"
  },
  {
    "function_name": "glock_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1336-1349",
    "snippet": "static int glock_cmp(void *priv, struct list_head *a, struct list_head *b)\n{\n\tstruct gfs2_glock *gla, *glb;\n\n\tgla = list_entry(a, struct gfs2_glock, gl_lru);\n\tglb = list_entry(b, struct gfs2_glock, gl_lru);\n\n\tif (gla->gl_name.ln_number > glb->gl_name.ln_number)\n\t\treturn 1;\n\tif (gla->gl_name.ln_number < glb->gl_name.ln_number)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "b",
            "structgfs2_glock",
            "gl_lru"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "a",
            "structgfs2_glock",
            "gl_lru"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int glock_cmp(void *priv, struct list_head *a, struct list_head *b)\n{\n\tstruct gfs2_glock *gla, *glb;\n\n\tgla = list_entry(a, struct gfs2_glock, gl_lru);\n\tglb = list_entry(b, struct gfs2_glock, gl_lru);\n\n\tif (gla->gl_name.ln_number > glb->gl_name.ln_number)\n\t\treturn 1;\n\tif (gla->gl_name.ln_number < glb->gl_name.ln_number)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_glock_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1313-1334",
    "snippet": "void gfs2_glock_complete(struct gfs2_glock *gl, int ret)\n{\n\tstruct lm_lockstruct *ls = &gl->gl_sbd->sd_lockstruct;\n\n\tspin_lock(&gl->gl_spin);\n\tgl->gl_reply = ret;\n\n\tif (unlikely(test_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags))) {\n\t\tif (gfs2_should_freeze(gl)) {\n\t\t\tset_bit(GLF_FROZEN, &gl->gl_flags);\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tgl->gl_lockref.count++;\n\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_REPLY_PENDING",
            "&gl->gl_flags"
          ],
          "line": 1329
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_should_freeze",
          "args": [
            "gl"
          ],
          "line": 1321
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_should_freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1285-1302",
          "snippet": "static int gfs2_should_freeze(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_holder *gh;\n\n\tif (gl->gl_reply & ~LM_OUT_ST_MASK)\n\t\treturn 0;\n\tif (gl->gl_target == LM_ST_UNLOCKED)\n\t\treturn 0;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (LM_FLAG_NOEXP & gh->gh_flags)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int gfs2_should_freeze(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_holder *gh;\n\n\tif (gl->gl_reply & ~LM_OUT_ST_MASK)\n\t\treturn 0;\n\tif (gl->gl_target == LM_ST_UNLOCKED)\n\t\treturn 0;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (LM_FLAG_NOEXP & gh->gh_flags)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "test_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags)"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DFL_BLOCK_LOCKS",
            "&ls->ls_recover_flags"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nvoid gfs2_glock_complete(struct gfs2_glock *gl, int ret)\n{\n\tstruct lm_lockstruct *ls = &gl->gl_sbd->sd_lockstruct;\n\n\tspin_lock(&gl->gl_spin);\n\tgl->gl_reply = ret;\n\n\tif (unlikely(test_bit(DFL_BLOCK_LOCKS, &ls->ls_recover_flags))) {\n\t\tif (gfs2_should_freeze(gl)) {\n\t\t\tset_bit(GLF_FROZEN, &gl->gl_flags);\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tgl->gl_lockref.count++;\n\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "gfs2_should_freeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1285-1302",
    "snippet": "static int gfs2_should_freeze(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_holder *gh;\n\n\tif (gl->gl_reply & ~LM_OUT_ST_MASK)\n\t\treturn 0;\n\tif (gl->gl_target == LM_ST_UNLOCKED)\n\t\treturn 0;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (LM_FLAG_NOEXP & gh->gh_flags)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gh",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int gfs2_should_freeze(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_holder *gh;\n\n\tif (gl->gl_reply & ~LM_OUT_ST_MASK)\n\t\treturn 0;\n\tif (gl->gl_target == LM_ST_UNLOCKED)\n\t\treturn 0;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (LM_FLAG_NOEXP & gh->gh_flags)\n\t\t\treturn 0;\n\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "gfs2_glock_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1251-1272",
    "snippet": "void gfs2_glock_cb(struct gfs2_glock *gl, unsigned int state)\n{\n\tunsigned long delay = 0;\n\tunsigned long holdtime;\n\tunsigned long now = jiffies;\n\n\tgfs2_glock_hold(gl);\n\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\tif (test_bit(GLF_QUEUED, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE) {\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\t\tif (test_bit(GLF_REPLY_PENDING, &gl->gl_flags))\n\t\t\tdelay = gl->gl_hold_time;\n\t}\n\n\tspin_lock(&gl->gl_spin);\n\thandle_callback(gl, state, delay, true);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "delay"
          ],
          "line": 1270
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_callback",
          "args": [
            "gl",
            "state",
            "delay",
            "true"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "handle_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "879-895",
          "snippet": "static void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1267
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_REPLY_PENDING",
            "&gl->gl_flags"
          ],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_before",
          "args": [
            "now",
            "holdtime"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_hold",
          "args": [
            "gl"
          ],
          "line": 1257
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "135-139",
          "snippet": "static void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nvoid gfs2_glock_cb(struct gfs2_glock *gl, unsigned int state)\n{\n\tunsigned long delay = 0;\n\tunsigned long holdtime;\n\tunsigned long now = jiffies;\n\n\tgfs2_glock_hold(gl);\n\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\tif (test_bit(GLF_QUEUED, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE) {\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\t\tif (test_bit(GLF_REPLY_PENDING, &gl->gl_flags))\n\t\t\tdelay = gl->gl_hold_time;\n\t}\n\n\tspin_lock(&gl->gl_spin);\n\thandle_callback(gl, state, delay, true);\n\tspin_unlock(&gl->gl_spin);\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "gfs2_glock_dq_m",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1245-1249",
    "snippet": "void gfs2_glock_dq_m(unsigned int num_gh, struct gfs2_holder *ghs)\n{\n\twhile (num_gh--)\n\t\tgfs2_glock_dq(&ghs[num_gh]);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_dq",
          "args": [
            "&ghs[num_gh]"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_dq_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1110-1114",
          "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_m(unsigned int num_gh, struct gfs2_holder *ghs)\n{\n\twhile (num_gh--)\n\t\tgfs2_glock_dq(&ghs[num_gh]);\n}"
  },
  {
    "function_name": "gfs2_glock_nq_m",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1210-1236",
    "snippet": "int gfs2_glock_nq_m(unsigned int num_gh, struct gfs2_holder *ghs)\n{\n\tstruct gfs2_holder *tmp[4];\n\tstruct gfs2_holder **pph = tmp;\n\tint error = 0;\n\n\tswitch(num_gh) {\n\tcase 0:\n\t\treturn 0;\n\tcase 1:\n\t\tghs->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\t\treturn gfs2_glock_nq(ghs);\n\tdefault:\n\t\tif (num_gh <= 4)\n\t\t\tbreak;\n\t\tpph = kmalloc(num_gh * sizeof(struct gfs2_holder *), GFP_NOFS);\n\t\tif (!pph)\n\t\t\treturn -ENOMEM;\n\t}\n\n\terror = nq_m_sync(num_gh, ghs, pph);\n\n\tif (pph != tmp)\n\t\tkfree(pph);\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pph"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nq_m_sync",
          "args": [
            "num_gh",
            "ghs",
            "pph"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "nq_m_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1175-1198",
          "snippet": "static int nq_m_sync(unsigned int num_gh, struct gfs2_holder *ghs,\n\t\t     struct gfs2_holder **p)\n{\n\tunsigned int x;\n\tint error = 0;\n\n\tfor (x = 0; x < num_gh; x++)\n\t\tp[x] = &ghs[x];\n\n\tsort(p, num_gh, sizeof(struct gfs2_holder *), glock_compare, NULL);\n\n\tfor (x = 0; x < num_gh; x++) {\n\t\tp[x]->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\n\t\terror = gfs2_glock_nq(p[x]);\n\t\tif (error) {\n\t\t\twhile (x--)\n\t\t\t\tgfs2_glock_dq(p[x]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int nq_m_sync(unsigned int num_gh, struct gfs2_holder *ghs,\n\t\t     struct gfs2_holder **p)\n{\n\tunsigned int x;\n\tint error = 0;\n\n\tfor (x = 0; x < num_gh; x++)\n\t\tp[x] = &ghs[x];\n\n\tsort(p, num_gh, sizeof(struct gfs2_holder *), glock_compare, NULL);\n\n\tfor (x = 0; x < num_gh; x++) {\n\t\tp[x]->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\n\t\terror = gfs2_glock_nq(p[x]);\n\t\tif (error) {\n\t\t\twhile (x--)\n\t\t\t\tgfs2_glock_dq(p[x]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "num_gh * sizeof(struct gfs2_holder *)",
            "GFP_NOFS"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_nq",
          "args": [
            "ghs"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_nq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1006-1034",
          "snippet": "int gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nint gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_glock_nq_m(unsigned int num_gh, struct gfs2_holder *ghs)\n{\n\tstruct gfs2_holder *tmp[4];\n\tstruct gfs2_holder **pph = tmp;\n\tint error = 0;\n\n\tswitch(num_gh) {\n\tcase 0:\n\t\treturn 0;\n\tcase 1:\n\t\tghs->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\t\treturn gfs2_glock_nq(ghs);\n\tdefault:\n\t\tif (num_gh <= 4)\n\t\t\tbreak;\n\t\tpph = kmalloc(num_gh * sizeof(struct gfs2_holder *), GFP_NOFS);\n\t\tif (!pph)\n\t\t\treturn -ENOMEM;\n\t}\n\n\terror = nq_m_sync(num_gh, ghs, pph);\n\n\tif (pph != tmp)\n\t\tkfree(pph);\n\n\treturn error;\n}"
  },
  {
    "function_name": "nq_m_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1175-1198",
    "snippet": "static int nq_m_sync(unsigned int num_gh, struct gfs2_holder *ghs,\n\t\t     struct gfs2_holder **p)\n{\n\tunsigned int x;\n\tint error = 0;\n\n\tfor (x = 0; x < num_gh; x++)\n\t\tp[x] = &ghs[x];\n\n\tsort(p, num_gh, sizeof(struct gfs2_holder *), glock_compare, NULL);\n\n\tfor (x = 0; x < num_gh; x++) {\n\t\tp[x]->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\n\t\terror = gfs2_glock_nq(p[x]);\n\t\tif (error) {\n\t\t\twhile (x--)\n\t\t\t\tgfs2_glock_dq(p[x]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_dq",
          "args": [
            "p[x]"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_dq_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1110-1114",
          "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_nq",
          "args": [
            "p[x]"
          ],
          "line": 1189
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_nq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1006-1034",
          "snippet": "int gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nint gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sort",
          "args": [
            "p",
            "num_gh",
            "sizeof(struct gfs2_holder *)",
            "glock_compare",
            "NULL"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int nq_m_sync(unsigned int num_gh, struct gfs2_holder *ghs,\n\t\t     struct gfs2_holder **p)\n{\n\tunsigned int x;\n\tint error = 0;\n\n\tfor (x = 0; x < num_gh; x++)\n\t\tp[x] = &ghs[x];\n\n\tsort(p, num_gh, sizeof(struct gfs2_holder *), glock_compare, NULL);\n\n\tfor (x = 0; x < num_gh; x++) {\n\t\tp[x]->gh_flags &= ~(LM_FLAG_TRY | GL_ASYNC);\n\n\t\terror = gfs2_glock_nq(p[x]);\n\t\tif (error) {\n\t\t\twhile (x--)\n\t\t\t\tgfs2_glock_dq(p[x]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "glock_compare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1151-1164",
    "snippet": "static int glock_compare(const void *arg_a, const void *arg_b)\n{\n\tconst struct gfs2_holder *gh_a = *(const struct gfs2_holder **)arg_a;\n\tconst struct gfs2_holder *gh_b = *(const struct gfs2_holder **)arg_b;\n\tconst struct lm_lockname *a = &gh_a->gh_gl->gl_name;\n\tconst struct lm_lockname *b = &gh_b->gh_gl->gl_name;\n\n\tif (a->ln_number > b->ln_number)\n\t\treturn 1;\n\tif (a->ln_number < b->ln_number)\n\t\treturn -1;\n\tBUG_ON(gh_a->gh_gl->gl_ops->go_type == gh_b->gh_gl->gl_ops->go_type);\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "gh_a->gh_gl->gl_ops->go_type == gh_b->gh_gl->gl_ops->go_type"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int glock_compare(const void *arg_a, const void *arg_b)\n{\n\tconst struct gfs2_holder *gh_a = *(const struct gfs2_holder **)arg_a;\n\tconst struct gfs2_holder *gh_b = *(const struct gfs2_holder **)arg_b;\n\tconst struct lm_lockname *a = &gh_a->gh_gl->gl_name;\n\tconst struct lm_lockname *b = &gh_b->gh_gl->gl_name;\n\n\tif (a->ln_number > b->ln_number)\n\t\treturn 1;\n\tif (a->ln_number < b->ln_number)\n\t\treturn -1;\n\tBUG_ON(gh_a->gh_gl->gl_ops->go_type == gh_b->gh_gl->gl_ops->go_type);\n\treturn 0;\n}"
  },
  {
    "function_name": "gfs2_glock_nq_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1128-1142",
    "snippet": "int gfs2_glock_nq_num(struct gfs2_sbd *sdp, u64 number,\n\t\t      const struct gfs2_glock_operations *glops,\n\t\t      unsigned int state, int flags, struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl;\n\tint error;\n\n\terror = gfs2_glock_get(sdp, number, glops, CREATE, &gl);\n\tif (!error) {\n\t\terror = gfs2_glock_nq_init(gl, state, flags, gh);\n\t\tgfs2_glock_put(gl);\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_nq_init",
          "args": [
            "gl",
            "state",
            "flags",
            "gh"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_nq_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.h",
          "lines": "204-230",
          "snippet": "extern __printf(2, 3)\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...);\n\n/**\n * gfs2_glock_nq_init - initialize a holder and enqueue it on a glock\n * @gl: the glock\n * @state: the state we're requesting\n * @flags: the modifier flags\n * @gh: the holder structure\n *\n * Returns: 0, GLR_*, or errno\n */\n\nstatic inline int gfs2_glock_nq_init(struct gfs2_glock *gl,\n\t\t\t\t     unsigned int state, int flags,\n\t\t\t\t     struct gfs2_holder *gh)\n{\n\tint error;\n\n\tgfs2_holder_init(gl, state, flags, gh);\n\n\terror = gfs2_glock_nq(gh);\n\tif (error)\n\t\tgfs2_holder_uninit(gh);\n\n\treturn error;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/parser.h>\n#include <linux/sched.h>\n\nextern __printf(2, 3)\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...);\n\n/**\n * gfs2_glock_nq_init - initialize a holder and enqueue it on a glock\n * @gl: the glock\n * @state: the state we're requesting\n * @flags: the modifier flags\n * @gh: the holder structure\n *\n * Returns: 0, GLR_*, or errno\n */\n\nstatic inline int gfs2_glock_nq_init(struct gfs2_glock *gl,\n\t\t\t\t     unsigned int state, int flags,\n\t\t\t\t     struct gfs2_holder *gh)\n{\n\tint error;\n\n\tgfs2_holder_init(gl, state, flags, gh);\n\n\terror = gfs2_glock_nq(gh);\n\tif (error)\n\t\tgfs2_holder_uninit(gh);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_get",
          "args": [
            "sdp",
            "number",
            "glops",
            "CREATE",
            "&gl"
          ],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "702-790",
          "snippet": "int gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nint gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_glock_nq_num(struct gfs2_sbd *sdp, u64 number,\n\t\t      const struct gfs2_glock_operations *glops,\n\t\t      unsigned int state, int flags, struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl;\n\tint error;\n\n\terror = gfs2_glock_get(sdp, number, glops, CREATE, &gl);\n\tif (!error) {\n\t\terror = gfs2_glock_nq_init(gl, state, flags, gh);\n\t\tgfs2_glock_put(gl);\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "gfs2_glock_dq_uninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1110-1114",
    "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_holder_uninit",
          "args": [
            "gh"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_holder_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "841-847",
          "snippet": "void gfs2_holder_uninit(struct gfs2_holder *gh)\n{\n\tput_pid(gh->gh_owner_pid);\n\tgfs2_glock_put(gh->gh_gl);\n\tgh->gh_gl = NULL;\n\tgh->gh_ip = 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_holder_uninit(struct gfs2_holder *gh)\n{\n\tput_pid(gh->gh_owner_pid);\n\tgfs2_glock_put(gh->gh_gl);\n\tgh->gh_gl = NULL;\n\tgh->gh_ip = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_dq",
          "args": [
            "gh"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_dq_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1110-1114",
          "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}"
  },
  {
    "function_name": "gfs2_glock_dq_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1096-1102",
    "snippet": "void gfs2_glock_dq_wait(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tgfs2_glock_dq(gh);\n\tmight_sleep();\n\twait_on_bit(&gl->gl_flags, GLF_DEMOTE, TASK_UNINTERRUPTIBLE);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_on_bit",
          "args": [
            "&gl->gl_flags",
            "GLF_DEMOTE",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_dq",
          "args": [
            "gh"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_dq_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1110-1114",
          "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_wait(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tgfs2_glock_dq(gh);\n\tmight_sleep();\n\twait_on_bit(&gl->gl_flags, GLF_DEMOTE, TASK_UNINTERRUPTIBLE);\n}"
  },
  {
    "function_name": "gfs2_glock_dq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1054-1094",
    "snippet": "void gfs2_glock_dq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned delay = 0;\n\tint fast_path = 0;\n\n\tspin_lock(&gl->gl_spin);\n\tif (gh->gh_flags & GL_NOCACHE)\n\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\n\tlist_del_init(&gh->gh_list);\n\tif (find_first_holder(gl) == NULL) {\n\t\tif (glops->go_unlock) {\n\t\t\tGLOCK_BUG_ON(gl, test_and_set_bit(GLF_LOCK, &gl->gl_flags));\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tglops->go_unlock(gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\t\t}\n\t\tif (list_empty(&gl->gl_holders) &&\n\t\t    !test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t\t    !test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tfast_path = 1;\n\t}\n\tif (!test_bit(GLF_LFLUSH, &gl->gl_flags) && demote_ok(gl))\n\t\tgfs2_glock_add_to_lru(gl);\n\n\ttrace_gfs2_glock_queue(gh, 0);\n\tspin_unlock(&gl->gl_spin);\n\tif (likely(fast_path))\n\t\treturn;\n\n\tgfs2_glock_hold(gl);\n\tif (test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t    !test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE)\n\t\tdelay = gl->gl_hold_time;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "delay"
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_hold",
          "args": [
            "gl"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "135-139",
          "snippet": "static void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "fast_path"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_queue",
          "args": [
            "gh",
            "0"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_add_to_lru",
          "args": [
            "gl"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_add_to_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "162-174",
          "snippet": "void gfs2_glock_add_to_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\n\tif (!list_empty(&gl->gl_lru))\n\t\tlist_del_init(&gl->gl_lru);\n\telse\n\t\tatomic_inc(&lru_count);\n\n\tlist_add_tail(&gl->gl_lru, &lru_list);\n\tset_bit(GLF_LRU, &gl->gl_flags);\n\tspin_unlock(&lru_lock);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(lru_list);",
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nvoid gfs2_glock_add_to_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\n\tif (!list_empty(&gl->gl_lru))\n\t\tlist_del_init(&gl->gl_lru);\n\telse\n\t\tatomic_inc(&lru_count);\n\n\tlist_add_tail(&gl->gl_lru, &lru_list);\n\tset_bit(GLF_LRU, &gl->gl_flags);\n\tspin_unlock(&lru_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "demote_ok",
          "args": [
            "gl"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "demote_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "148-159",
          "snippet": "static int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "glops->go_unlock",
          "args": [
            "gh"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "test_and_set_bit(GLF_LOCK, &gl->gl_flags)"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_holder",
          "args": [
            "gl"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_holder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "557-567",
          "snippet": "static inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gh->gh_list"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handle_callback",
          "args": [
            "gl",
            "LM_ST_UNLOCKED",
            "0",
            "false"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "handle_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "879-895",
          "snippet": "static void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nvoid gfs2_glock_dq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned delay = 0;\n\tint fast_path = 0;\n\n\tspin_lock(&gl->gl_spin);\n\tif (gh->gh_flags & GL_NOCACHE)\n\t\thandle_callback(gl, LM_ST_UNLOCKED, 0, false);\n\n\tlist_del_init(&gh->gh_list);\n\tif (find_first_holder(gl) == NULL) {\n\t\tif (glops->go_unlock) {\n\t\t\tGLOCK_BUG_ON(gl, test_and_set_bit(GLF_LOCK, &gl->gl_flags));\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\tglops->go_unlock(gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\t\t}\n\t\tif (list_empty(&gl->gl_holders) &&\n\t\t    !test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t\t    !test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tfast_path = 1;\n\t}\n\tif (!test_bit(GLF_LFLUSH, &gl->gl_flags) && demote_ok(gl))\n\t\tgfs2_glock_add_to_lru(gl);\n\n\ttrace_gfs2_glock_queue(gh, 0);\n\tspin_unlock(&gl->gl_spin);\n\tif (likely(fast_path))\n\t\treturn;\n\n\tgfs2_glock_hold(gl);\n\tif (test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t    !test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_name.ln_type == LM_TYPE_INODE)\n\t\tdelay = gl->gl_hold_time;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "gfs2_glock_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1043-1046",
    "snippet": "int gfs2_glock_poll(struct gfs2_holder *gh)\n{\n\treturn test_bit(HIF_WAIT, &gh->gh_iflags) ? 0 : 1;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_WAIT",
            "&gh->gh_iflags"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_glock_poll(struct gfs2_holder *gh)\n{\n\treturn test_bit(HIF_WAIT, &gh->gh_iflags) ? 0 : 1;\n}"
  },
  {
    "function_name": "gfs2_glock_nq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "1006-1034",
    "snippet": "int gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_wait",
          "args": [
            "gh"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "856-868",
          "snippet": "int gfs2_glock_wait(struct gfs2_holder *gh)\n{\n\tunsigned long time1 = jiffies;\n\n\tmight_sleep();\n\twait_on_bit(&gh->gh_iflags, HIF_WAIT, TASK_UNINTERRUPTIBLE);\n\tif (time_after(jiffies, time1 + HZ)) /* have we waited > a second? */\n\t\t/* Lengthen the minimum hold time. */\n\t\tgh->gh_gl->gl_hold_time = min(gh->gh_gl->gl_hold_time +\n\t\t\t\t\t      GL_GLOCK_HOLD_INCR,\n\t\t\t\t\t      GL_GLOCK_MAX_HOLD);\n\treturn gh->gh_error;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_glock_wait(struct gfs2_holder *gh)\n{\n\tunsigned long time1 = jiffies;\n\n\tmight_sleep();\n\twait_on_bit(&gh->gh_iflags, HIF_WAIT, TASK_UNINTERRUPTIBLE);\n\tif (time_after(jiffies, time1 + HZ)) /* have we waited > a second? */\n\t\t/* Lengthen the minimum hold time. */\n\t\tgh->gh_gl->gl_hold_time = min(gh->gh_gl->gl_hold_time +\n\t\t\t\t\t      GL_GLOCK_HOLD_INCR,\n\t\t\t\t\t      GL_GLOCK_MAX_HOLD);\n\treturn gh->gh_error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "run_queue",
          "args": [
            "gl",
            "1"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "run_queue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "576-626",
          "snippet": "static void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_REPLY_PENDING",
            "&gl->gl_flags"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "(LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags)"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "GLF_FROZEN",
            "&gl->gl_flags"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_to_queue",
          "args": [
            "gh"
          ],
          "line": 1019
        },
        "resolved": true,
        "details": {
          "function_name": "add_to_queue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "926-995",
          "snippet": "static inline void add_to_queue(struct gfs2_holder *gh)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct list_head *insert_pt = NULL;\n\tstruct gfs2_holder *gh2;\n\tint try_futile = 0;\n\n\tBUG_ON(gh->gh_owner_pid == NULL);\n\tif (test_and_set_bit(HIF_WAIT, &gh->gh_iflags))\n\t\tBUG();\n\n\tif (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)) {\n\t\tif (test_bit(GLF_LOCK, &gl->gl_flags))\n\t\t\ttry_futile = !may_grant(gl, gh);\n\t\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\t\tgoto fail;\n\t}\n\n\tlist_for_each_entry(gh2, &gl->gl_holders, gh_list) {\n\t\tif (unlikely(gh2->gh_owner_pid == gh->gh_owner_pid &&\n\t\t    (gh->gh_gl->gl_ops->go_type != LM_TYPE_FLOCK)))\n\t\t\tgoto trap_recursive;\n\t\tif (try_futile &&\n\t\t    !(gh2->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\nfail:\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\t\tgfs2_holder_wake(gh);\n\t\t\treturn;\n\t\t}\n\t\tif (test_bit(HIF_HOLDER, &gh2->gh_iflags))\n\t\t\tcontinue;\n\t\tif (unlikely((gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt))\n\t\t\tinsert_pt = &gh2->gh_list;\n\t}\n\tset_bit(GLF_QUEUED, &gl->gl_flags);\n\ttrace_gfs2_glock_queue(gh, 1);\n\tgfs2_glstats_inc(gl, GFS2_LKS_QCOUNT);\n\tgfs2_sbstats_inc(gl, GFS2_LKS_QCOUNT);\n\tif (likely(insert_pt == NULL)) {\n\t\tlist_add_tail(&gh->gh_list, &gl->gl_holders);\n\t\tif (unlikely(gh->gh_flags & LM_FLAG_PRIORITY))\n\t\t\tgoto do_cancel;\n\t\treturn;\n\t}\n\tlist_add_tail(&gh->gh_list, insert_pt);\ndo_cancel:\n\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\tif (!(gh->gh_flags & LM_FLAG_PRIORITY)) {\n\t\tspin_unlock(&gl->gl_spin);\n\t\tif (sdp->sd_lockstruct.ls_ops->lm_cancel)\n\t\t\tsdp->sd_lockstruct.ls_ops->lm_cancel(gl);\n\t\tspin_lock(&gl->gl_spin);\n\t}\n\treturn;\n\ntrap_recursive:\n\tpr_err(\"original: %pSR\\n\", (void *)gh2->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh2->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh2->gh_gl->gl_name.ln_type, gh2->gh_state);\n\tpr_err(\"new: %pSR\\n\", (void *)gh->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh->gh_gl->gl_name.ln_type, gh->gh_state);\n\tgfs2_dump_glock(NULL, gl);\n\tBUG();\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void add_to_queue(struct gfs2_holder *gh)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct list_head *insert_pt = NULL;\n\tstruct gfs2_holder *gh2;\n\tint try_futile = 0;\n\n\tBUG_ON(gh->gh_owner_pid == NULL);\n\tif (test_and_set_bit(HIF_WAIT, &gh->gh_iflags))\n\t\tBUG();\n\n\tif (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)) {\n\t\tif (test_bit(GLF_LOCK, &gl->gl_flags))\n\t\t\ttry_futile = !may_grant(gl, gh);\n\t\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\t\tgoto fail;\n\t}\n\n\tlist_for_each_entry(gh2, &gl->gl_holders, gh_list) {\n\t\tif (unlikely(gh2->gh_owner_pid == gh->gh_owner_pid &&\n\t\t    (gh->gh_gl->gl_ops->go_type != LM_TYPE_FLOCK)))\n\t\t\tgoto trap_recursive;\n\t\tif (try_futile &&\n\t\t    !(gh2->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\nfail:\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\t\tgfs2_holder_wake(gh);\n\t\t\treturn;\n\t\t}\n\t\tif (test_bit(HIF_HOLDER, &gh2->gh_iflags))\n\t\t\tcontinue;\n\t\tif (unlikely((gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt))\n\t\t\tinsert_pt = &gh2->gh_list;\n\t}\n\tset_bit(GLF_QUEUED, &gl->gl_flags);\n\ttrace_gfs2_glock_queue(gh, 1);\n\tgfs2_glstats_inc(gl, GFS2_LKS_QCOUNT);\n\tgfs2_sbstats_inc(gl, GFS2_LKS_QCOUNT);\n\tif (likely(insert_pt == NULL)) {\n\t\tlist_add_tail(&gh->gh_list, &gl->gl_holders);\n\t\tif (unlikely(gh->gh_flags & LM_FLAG_PRIORITY))\n\t\t\tgoto do_cancel;\n\t\treturn;\n\t}\n\tlist_add_tail(&gh->gh_list, insert_pt);\ndo_cancel:\n\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\tif (!(gh->gh_flags & LM_FLAG_PRIORITY)) {\n\t\tspin_unlock(&gl->gl_spin);\n\t\tif (sdp->sd_lockstruct.ls_ops->lm_cancel)\n\t\t\tsdp->sd_lockstruct.ls_ops->lm_cancel(gl);\n\t\tspin_lock(&gl->gl_spin);\n\t}\n\treturn;\n\ntrap_recursive:\n\tpr_err(\"original: %pSR\\n\", (void *)gh2->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh2->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh2->gh_gl->gl_name.ln_type, gh2->gh_state);\n\tpr_err(\"new: %pSR\\n\", (void *)gh->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh->gh_gl->gl_name.ln_type, gh->gh_state);\n\tgfs2_dump_glock(NULL, gl);\n\tBUG();\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_remove_from_lru",
          "args": [
            "gl"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_remove_from_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "176-185",
          "snippet": "static void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_LRU",
            "&gl->gl_flags"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "test_bit(SDF_SHUTDOWN, &sdp->sd_flags)"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nint gfs2_glock_nq(struct gfs2_holder *gh)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tint error = 0;\n\n\tif (unlikely(test_bit(SDF_SHUTDOWN, &sdp->sd_flags)))\n\t\treturn -EIO;\n\n\tif (test_bit(GLF_LRU, &gl->gl_flags))\n\t\tgfs2_glock_remove_from_lru(gl);\n\n\tspin_lock(&gl->gl_spin);\n\tadd_to_queue(gh);\n\tif (unlikely((LM_FLAG_NOEXP & gh->gh_flags) &&\n\t\t     test_and_clear_bit(GLF_FROZEN, &gl->gl_flags))) {\n\t\tset_bit(GLF_REPLY_PENDING, &gl->gl_flags);\n\t\tgl->gl_lockref.count++;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgl->gl_lockref.count--;\n\t}\n\trun_queue(gl, 1);\n\tspin_unlock(&gl->gl_spin);\n\n\tif (!(gh->gh_flags & GL_ASYNC))\n\t\terror = gfs2_glock_wait(gh);\n\n\treturn error;\n}"
  },
  {
    "function_name": "add_to_queue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "926-995",
    "snippet": "static inline void add_to_queue(struct gfs2_holder *gh)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct list_head *insert_pt = NULL;\n\tstruct gfs2_holder *gh2;\n\tint try_futile = 0;\n\n\tBUG_ON(gh->gh_owner_pid == NULL);\n\tif (test_and_set_bit(HIF_WAIT, &gh->gh_iflags))\n\t\tBUG();\n\n\tif (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)) {\n\t\tif (test_bit(GLF_LOCK, &gl->gl_flags))\n\t\t\ttry_futile = !may_grant(gl, gh);\n\t\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\t\tgoto fail;\n\t}\n\n\tlist_for_each_entry(gh2, &gl->gl_holders, gh_list) {\n\t\tif (unlikely(gh2->gh_owner_pid == gh->gh_owner_pid &&\n\t\t    (gh->gh_gl->gl_ops->go_type != LM_TYPE_FLOCK)))\n\t\t\tgoto trap_recursive;\n\t\tif (try_futile &&\n\t\t    !(gh2->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\nfail:\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\t\tgfs2_holder_wake(gh);\n\t\t\treturn;\n\t\t}\n\t\tif (test_bit(HIF_HOLDER, &gh2->gh_iflags))\n\t\t\tcontinue;\n\t\tif (unlikely((gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt))\n\t\t\tinsert_pt = &gh2->gh_list;\n\t}\n\tset_bit(GLF_QUEUED, &gl->gl_flags);\n\ttrace_gfs2_glock_queue(gh, 1);\n\tgfs2_glstats_inc(gl, GFS2_LKS_QCOUNT);\n\tgfs2_sbstats_inc(gl, GFS2_LKS_QCOUNT);\n\tif (likely(insert_pt == NULL)) {\n\t\tlist_add_tail(&gh->gh_list, &gl->gl_holders);\n\t\tif (unlikely(gh->gh_flags & LM_FLAG_PRIORITY))\n\t\t\tgoto do_cancel;\n\t\treturn;\n\t}\n\tlist_add_tail(&gh->gh_list, insert_pt);\ndo_cancel:\n\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\tif (!(gh->gh_flags & LM_FLAG_PRIORITY)) {\n\t\tspin_unlock(&gl->gl_spin);\n\t\tif (sdp->sd_lockstruct.ls_ops->lm_cancel)\n\t\t\tsdp->sd_lockstruct.ls_ops->lm_cancel(gl);\n\t\tspin_lock(&gl->gl_spin);\n\t}\n\treturn;\n\ntrap_recursive:\n\tpr_err(\"original: %pSR\\n\", (void *)gh2->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh2->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh2->gh_gl->gl_name.ln_type, gh2->gh_state);\n\tpr_err(\"new: %pSR\\n\", (void *)gh->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh->gh_gl->gl_name.ln_type, gh->gh_state);\n\tgfs2_dump_glock(NULL, gl);\n\tBUG();\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_dump_glock",
          "args": [
            "NULL",
            "gl"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dump_glock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1702-1729",
          "snippet": "void gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_dump_glock(struct seq_file *seq, const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tunsigned long long dtime;\n\tconst struct gfs2_holder *gh;\n\tchar gflags_buf[32];\n\n\tdtime = jiffies - gl->gl_demote_time;\n\tdtime *= 1000000/HZ; /* demote time in uSec */\n\tif (!test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\tdtime = 0;\n\tgfs2_print_dbg(seq, \"G:  s:%s n:%u/%llx f:%s t:%s d:%s/%llu a:%d v:%d r:%d m:%ld\\n\",\n\t\t  state2str(gl->gl_state),\n\t\t  gl->gl_name.ln_type,\n\t\t  (unsigned long long)gl->gl_name.ln_number,\n\t\t  gflags2str(gflags_buf, gl),\n\t\t  state2str(gl->gl_target),\n\t\t  state2str(gl->gl_demote_state), dtime,\n\t\t  atomic_read(&gl->gl_ail_count),\n\t\t  atomic_read(&gl->gl_revokes),\n\t\t  (int)gl->gl_lockref.count, gl->gl_hold_time);\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list)\n\t\tdump_holder(seq, gh);\n\n\tif (gl->gl_state != LM_ST_UNLOCKED && glops->go_dump)\n\t\tglops->go_dump(seq, gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"lock type: %d req lock state : %d\\n\"",
            "gh->gh_gl->gl_name.ln_type",
            "gh->gh_state"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"pid: %d\\n\"",
            "pid_nr(gh->gh_owner_pid)"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pid_nr",
          "args": [
            "gh->gh_owner_pid"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"new: %pSR\\n\"",
            "(void *)gh->gh_ip"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"lock type: %d req lock state : %d\\n\"",
            "gh2->gh_gl->gl_name.ln_type",
            "gh2->gh_state"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"pid: %d\\n\"",
            "pid_nr(gh2->gh_owner_pid)"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pid_nr",
          "args": [
            "gh2->gh_owner_pid"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"original: %pSR\\n\"",
            "(void *)gh2->gh_ip"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp->sd_lockstruct.ls_ops->lm_cancel",
          "args": [
            "gl"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "gl->gl_holders.next",
            "structgfs2_holder",
            "gh_list"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&gh->gh_list",
            "insert_pt"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "gh->gh_flags & LM_FLAG_PRIORITY"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&gh->gh_list",
            "&gl->gl_holders"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "insert_pt == NULL"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_sbstats_inc",
          "args": [
            "gl",
            "GFS2_LKS_QCOUNT"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_sbstats_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "832-838",
          "snippet": "static inline void gfs2_sbstats_inc(const struct gfs2_glock *gl, int which)\n{\n\tconst struct gfs2_sbd *sdp = gl->gl_sbd;\n\tpreempt_disable();\n\tthis_cpu_ptr(sdp->sd_lkstats)->lkstats[gl->gl_name.ln_type].stats[which]++;\n\tpreempt_enable();\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline void gfs2_sbstats_inc(const struct gfs2_glock *gl, int which)\n{\n\tconst struct gfs2_sbd *sdp = gl->gl_sbd;\n\tpreempt_disable();\n\tthis_cpu_ptr(sdp->sd_lkstats)->lkstats[gl->gl_name.ln_type].stats[which]++;\n\tpreempt_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glstats_inc",
          "args": [
            "gl",
            "GFS2_LKS_QCOUNT"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glstats_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "827-830",
          "snippet": "static inline void gfs2_glstats_inc(struct gfs2_glock *gl, int which)\n{\n\tgl->gl_stats.stats[which]++;\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline void gfs2_glstats_inc(struct gfs2_glock *gl, int which)\n{\n\tgl->gl_stats.stats[which]++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_queue",
          "args": [
            "gh",
            "1"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_QUEUED",
            "&gl->gl_flags"
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "(gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh2->gh_iflags"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_holder_wake",
          "args": [
            "gh"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_holder_wake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "270-275",
          "snippet": "static void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "gh2->gh_owner_pid == gh->gh_owner_pid &&\n\t\t    (gh->gh_gl->gl_ops->go_type != LM_TYPE_FLOCK)"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gh2",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "may_grant",
          "args": [
            "gl",
            "gh"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "may_grant",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "249-268",
          "snippet": "static inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "HIF_WAIT",
            "&gh->gh_iflags"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "gh->gh_owner_pid == NULL"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void add_to_queue(struct gfs2_holder *gh)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_glock *gl = gh->gh_gl;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct list_head *insert_pt = NULL;\n\tstruct gfs2_holder *gh2;\n\tint try_futile = 0;\n\n\tBUG_ON(gh->gh_owner_pid == NULL);\n\tif (test_and_set_bit(HIF_WAIT, &gh->gh_iflags))\n\t\tBUG();\n\n\tif (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)) {\n\t\tif (test_bit(GLF_LOCK, &gl->gl_flags))\n\t\t\ttry_futile = !may_grant(gl, gh);\n\t\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\t\tgoto fail;\n\t}\n\n\tlist_for_each_entry(gh2, &gl->gl_holders, gh_list) {\n\t\tif (unlikely(gh2->gh_owner_pid == gh->gh_owner_pid &&\n\t\t    (gh->gh_gl->gl_ops->go_type != LM_TYPE_FLOCK)))\n\t\t\tgoto trap_recursive;\n\t\tif (try_futile &&\n\t\t    !(gh2->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\nfail:\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\t\tgfs2_holder_wake(gh);\n\t\t\treturn;\n\t\t}\n\t\tif (test_bit(HIF_HOLDER, &gh2->gh_iflags))\n\t\t\tcontinue;\n\t\tif (unlikely((gh->gh_flags & LM_FLAG_PRIORITY) && !insert_pt))\n\t\t\tinsert_pt = &gh2->gh_list;\n\t}\n\tset_bit(GLF_QUEUED, &gl->gl_flags);\n\ttrace_gfs2_glock_queue(gh, 1);\n\tgfs2_glstats_inc(gl, GFS2_LKS_QCOUNT);\n\tgfs2_sbstats_inc(gl, GFS2_LKS_QCOUNT);\n\tif (likely(insert_pt == NULL)) {\n\t\tlist_add_tail(&gh->gh_list, &gl->gl_holders);\n\t\tif (unlikely(gh->gh_flags & LM_FLAG_PRIORITY))\n\t\t\tgoto do_cancel;\n\t\treturn;\n\t}\n\tlist_add_tail(&gh->gh_list, insert_pt);\ndo_cancel:\n\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\tif (!(gh->gh_flags & LM_FLAG_PRIORITY)) {\n\t\tspin_unlock(&gl->gl_spin);\n\t\tif (sdp->sd_lockstruct.ls_ops->lm_cancel)\n\t\t\tsdp->sd_lockstruct.ls_ops->lm_cancel(gl);\n\t\tspin_lock(&gl->gl_spin);\n\t}\n\treturn;\n\ntrap_recursive:\n\tpr_err(\"original: %pSR\\n\", (void *)gh2->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh2->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh2->gh_gl->gl_name.ln_type, gh2->gh_state);\n\tpr_err(\"new: %pSR\\n\", (void *)gh->gh_ip);\n\tpr_err(\"pid: %d\\n\", pid_nr(gh->gh_owner_pid));\n\tpr_err(\"lock type: %d req lock state : %d\\n\",\n\t       gh->gh_gl->gl_name.ln_type, gh->gh_state);\n\tgfs2_dump_glock(NULL, gl);\n\tBUG();\n}"
  },
  {
    "function_name": "gfs2_print_dbg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "897-914",
    "snippet": "void gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%pV\"",
            "&vaf"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_vprintf",
          "args": [
            "seq",
            "fmt",
            "args"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "seq_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "400-413",
          "snippet": "int seq_vprintf(struct seq_file *m, const char *f, va_list args)\n{\n\tint len;\n\n\tif (m->count < m->size) {\n\t\tlen = vsnprintf(m->buf + m->count, m->size - m->count, f, args);\n\t\tif (m->count + len < m->size) {\n\t\t\tm->count += len;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_vprintf(struct seq_file *m, const char *f, va_list args)\n{\n\tint len;\n\n\tif (m->count < m->size) {\n\t\tlen = vsnprintf(m->buf + m->count, m->size - m->count, f, args);\n\t\tif (m->count + len < m->size) {\n\t\t\tm->count += len;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tseq_set_overflow(m);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tva_start(args, fmt);\n\n\tif (seq) {\n\t\tseq_vprintf(seq, fmt, args);\n\t} else {\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tpr_err(\"%pV\", &vaf);\n\t}\n\n\tva_end(args);\n}"
  },
  {
    "function_name": "handle_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "879-895",
    "snippet": "static void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_gfs2_demote_rq",
          "args": [
            "gl",
            "remote"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gl->gl_ops->go_callback",
          "args": [
            "gl",
            "remote"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "bit",
            "&gl->gl_flags"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void handle_callback(struct gfs2_glock *gl, unsigned int state,\n\t\t\t    unsigned long delay, bool remote)\n{\n\tint bit = delay ? GLF_PENDING_DEMOTE : GLF_DEMOTE;\n\n\tset_bit(bit, &gl->gl_flags);\n\tif (gl->gl_demote_state == LM_ST_EXCLUSIVE) {\n\t\tgl->gl_demote_state = state;\n\t\tgl->gl_demote_time = jiffies;\n\t} else if (gl->gl_demote_state != LM_ST_UNLOCKED &&\n\t\t\tgl->gl_demote_state != state) {\n\t\tgl->gl_demote_state = LM_ST_UNLOCKED;\n\t}\n\tif (gl->gl_ops->go_callback)\n\t\tgl->gl_ops->go_callback(gl, remote);\n\ttrace_gfs2_demote_rq(gl, remote);\n}"
  },
  {
    "function_name": "gfs2_glock_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "856-868",
    "snippet": "int gfs2_glock_wait(struct gfs2_holder *gh)\n{\n\tunsigned long time1 = jiffies;\n\n\tmight_sleep();\n\twait_on_bit(&gh->gh_iflags, HIF_WAIT, TASK_UNINTERRUPTIBLE);\n\tif (time_after(jiffies, time1 + HZ)) /* have we waited > a second? */\n\t\t/* Lengthen the minimum hold time. */\n\t\tgh->gh_gl->gl_hold_time = min(gh->gh_gl->gl_hold_time +\n\t\t\t\t\t      GL_GLOCK_HOLD_INCR,\n\t\t\t\t\t      GL_GLOCK_MAX_HOLD);\n\treturn gh->gh_error;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "gh->gh_gl->gl_hold_time +\n\t\t\t\t\t      GL_GLOCK_HOLD_INCR",
            "GL_GLOCK_MAX_HOLD"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "get_dominating_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/pnode.c",
          "lines": "55-66",
          "snippet": "int get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"pnode.h\"",
            "#include \"internal.h\"",
            "#include <linux/nsproxy.h>",
            "#include <linux/fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/mnt_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pnode.h\"\n#include \"internal.h\"\n#include <linux/nsproxy.h>\n#include <linux/fs.h>\n#include <linux/mount.h>\n#include <linux/mnt_namespace.h>\n\nint get_dominating_id(struct mount *mnt, const struct path *root)\n{\n\tstruct mount *m;\n\n\tfor (m = mnt->mnt_master; m != NULL; m = m->mnt_master) {\n\t\tstruct mount *d = get_peer_under_root(m, mnt->mnt_ns, root);\n\t\tif (d)\n\t\t\treturn d->mnt_group_id;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_after",
          "args": [
            "jiffies",
            "time1 + HZ"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_on_bit",
          "args": [
            "&gh->gh_iflags",
            "HIF_WAIT",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nint gfs2_glock_wait(struct gfs2_holder *gh)\n{\n\tunsigned long time1 = jiffies;\n\n\tmight_sleep();\n\twait_on_bit(&gh->gh_iflags, HIF_WAIT, TASK_UNINTERRUPTIBLE);\n\tif (time_after(jiffies, time1 + HZ)) /* have we waited > a second? */\n\t\t/* Lengthen the minimum hold time. */\n\t\tgh->gh_gl->gl_hold_time = min(gh->gh_gl->gl_hold_time +\n\t\t\t\t\t      GL_GLOCK_HOLD_INCR,\n\t\t\t\t\t      GL_GLOCK_MAX_HOLD);\n\treturn gh->gh_error;\n}"
  },
  {
    "function_name": "gfs2_holder_uninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "841-847",
    "snippet": "void gfs2_holder_uninit(struct gfs2_holder *gh)\n{\n\tput_pid(gh->gh_owner_pid);\n\tgfs2_glock_put(gh->gh_gl);\n\tgh->gh_gl = NULL;\n\tgh->gh_ip = 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gh->gh_gl"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_pid",
          "args": [
            "gh->gh_owner_pid"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_holder_uninit(struct gfs2_holder *gh)\n{\n\tput_pid(gh->gh_owner_pid);\n\tgfs2_glock_put(gh->gh_gl);\n\tgh->gh_gl = NULL;\n\tgh->gh_ip = 0;\n}"
  },
  {
    "function_name": "gfs2_holder_reinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "825-833",
    "snippet": "void gfs2_holder_reinit(unsigned int state, unsigned flags, struct gfs2_holder *gh)\n{\n\tgh->gh_state = state;\n\tgh->gh_flags = flags;\n\tgh->gh_iflags = 0;\n\tgh->gh_ip = _RET_IP_;\n\tput_pid(gh->gh_owner_pid);\n\tgh->gh_owner_pid = get_pid(task_pid(current));\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_pid",
          "args": [
            "task_pid(current)"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid",
          "args": [
            "current"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_pid",
          "args": [
            "gh->gh_owner_pid"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_holder_reinit(unsigned int state, unsigned flags, struct gfs2_holder *gh)\n{\n\tgh->gh_state = state;\n\tgh->gh_flags = flags;\n\tgh->gh_iflags = 0;\n\tgh->gh_ip = _RET_IP_;\n\tput_pid(gh->gh_owner_pid);\n\tgh->gh_owner_pid = get_pid(task_pid(current));\n}"
  },
  {
    "function_name": "gfs2_holder_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "801-813",
    "snippet": "void gfs2_holder_init(struct gfs2_glock *gl, unsigned int state, unsigned flags,\n\t\t      struct gfs2_holder *gh)\n{\n\tINIT_LIST_HEAD(&gh->gh_list);\n\tgh->gh_gl = gl;\n\tgh->gh_ip = _RET_IP_;\n\tgh->gh_owner_pid = get_pid(task_pid(current));\n\tgh->gh_state = state;\n\tgh->gh_flags = flags;\n\tgh->gh_error = 0;\n\tgh->gh_iflags = 0;\n\tgfs2_glock_hold(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_hold",
          "args": [
            "gl"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "135-139",
          "snippet": "static void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_pid",
          "args": [
            "task_pid(current)"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid",
          "args": [
            "current"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&gh->gh_list"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_holder_init(struct gfs2_glock *gl, unsigned int state, unsigned flags,\n\t\t      struct gfs2_holder *gh)\n{\n\tINIT_LIST_HEAD(&gh->gh_list);\n\tgh->gh_gl = gl;\n\tgh->gh_ip = _RET_IP_;\n\tgh->gh_owner_pid = get_pid(task_pid(current));\n\tgh->gh_state = state;\n\tgh->gh_flags = flags;\n\tgh->gh_error = 0;\n\tgh->gh_iflags = 0;\n\tgfs2_glock_hold(gl);\n}"
  },
  {
    "function_name": "gfs2_glock_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "702-790",
    "snippet": "int gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_bucket",
          "args": [
            "hash"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_add_head_rcu",
          "args": [
            "&gl->gl_list",
            "&gl_hash_table[hash]"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&sdp->sd_glock_disposal"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "cachep",
            "gl"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "gl->gl_lksb.sb_lvbptr"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "search_bucket",
          "args": [
            "hash",
            "sdp",
            "&name"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "search_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "222-239",
          "snippet": "static struct gfs2_glock *search_bucket(unsigned int hash,\n\t\t\t\t\tconst struct gfs2_sbd *sdp,\n\t\t\t\t\tconst struct lm_lockname *name)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_node *h;\n\n\thlist_bl_for_each_entry_rcu(gl, h, &gl_hash_table[hash], gl_list) {\n\t\tif (!lm_name_equal(&gl->gl_name, name))\n\t\t\tcontinue;\n\t\tif (gl->gl_sbd != sdp)\n\t\t\tcontinue;\n\t\tif (lockref_get_not_dead(&gl->gl_lockref))\n\t\t\treturn gl;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic struct gfs2_glock *search_bucket(unsigned int hash,\n\t\t\t\t\tconst struct gfs2_sbd *sdp,\n\t\t\t\t\tconst struct lm_lockname *name)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_node *h;\n\n\thlist_bl_for_each_entry_rcu(gl, h, &gl_hash_table[hash], gl_list) {\n\t\tif (!lm_name_equal(&gl->gl_name, name))\n\t\t\tcontinue;\n\t\tif (gl->gl_sbd != sdp)\n\t\t\tcontinue;\n\t\tif (lockref_get_not_dead(&gl->gl_lockref))\n\t\t\treturn gl;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_bucket",
          "args": [
            "hash"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapping_set_gfp_mask",
          "args": [
            "mapping",
            "GFP_NOFS"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock2aspace",
          "args": [
            "gl"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock2aspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.h",
          "lines": "174-179",
          "snippet": "static inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/parser.h>\n#include <linux/sched.h>\n\nstatic inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&gl->gl_delete",
            "delete_work_func"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&gl->gl_work",
            "glock_work_func"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "sdp->sd_lkstats"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_set",
          "args": [
            "0",
            "0"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&sdp->sd_glock_disposal"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "cachep",
            "gl"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "GFS2_MIN_LVB_SIZE",
            "GFP_NOFS"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&gl->gl_lksb",
            "0",
            "sizeof(struct dlm_lksb)"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "cachep",
            "GFP_NOFS"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gl_hash",
          "args": [
            "sdp",
            "&name"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "gl_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "85-96",
          "snippet": "static unsigned int gl_hash(const struct gfs2_sbd *sdp,\n\t\t\t    const struct lm_lockname *name)\n{\n\tunsigned int h;\n\n\th = jhash(&name->ln_number, sizeof(u64), 0);\n\th = jhash(&name->ln_type, sizeof(unsigned int), h);\n\th = jhash(&sdp, sizeof(struct gfs2_sbd *), h);\n\th &= GFS2_GL_HASH_MASK;\n\n\treturn h;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define GFS2_GL_HASH_MASK       (GFS2_GL_HASH_SIZE - 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_MASK       (GFS2_GL_HASH_SIZE - 1)\n\nstatic unsigned int gl_hash(const struct gfs2_sbd *sdp,\n\t\t\t    const struct lm_lockname *name)\n{\n\tunsigned int h;\n\n\th = jhash(&name->ln_number, sizeof(u64), 0);\n\th = jhash(&name->ln_type, sizeof(unsigned int), h);\n\th = jhash(&sdp, sizeof(struct gfs2_sbd *), h);\n\th &= GFS2_GL_HASH_MASK;\n\n\treturn h;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nint gfs2_glock_get(struct gfs2_sbd *sdp, u64 number,\n\t\t   const struct gfs2_glock_operations *glops, int create,\n\t\t   struct gfs2_glock **glp)\n{\n\tstruct super_block *s = sdp->sd_vfs;\n\tstruct lm_lockname name = { .ln_number = number, .ln_type = glops->go_type };\n\tstruct gfs2_glock *gl, *tmp;\n\tunsigned int hash = gl_hash(sdp, &name);\n\tstruct address_space *mapping;\n\tstruct kmem_cache *cachep;\n\n\trcu_read_lock();\n\tgl = search_bucket(hash, sdp, &name);\n\trcu_read_unlock();\n\n\t*glp = gl;\n\tif (gl)\n\t\treturn 0;\n\tif (!create)\n\t\treturn -ENOENT;\n\n\tif (glops->go_flags & GLOF_ASPACE)\n\t\tcachep = gfs2_glock_aspace_cachep;\n\telse\n\t\tcachep = gfs2_glock_cachep;\n\tgl = kmem_cache_alloc(cachep, GFP_NOFS);\n\tif (!gl)\n\t\treturn -ENOMEM;\n\n\tmemset(&gl->gl_lksb, 0, sizeof(struct dlm_lksb));\n\n\tif (glops->go_flags & GLOF_LVB) {\n\t\tgl->gl_lksb.sb_lvbptr = kzalloc(GFS2_MIN_LVB_SIZE, GFP_NOFS);\n\t\tif (!gl->gl_lksb.sb_lvbptr) {\n\t\t\tkmem_cache_free(cachep, gl);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t}\n\n\tatomic_inc(&sdp->sd_glock_disposal);\n\tgl->gl_sbd = sdp;\n\tgl->gl_flags = 0;\n\tgl->gl_name = name;\n\tgl->gl_lockref.count = 1;\n\tgl->gl_state = LM_ST_UNLOCKED;\n\tgl->gl_target = LM_ST_UNLOCKED;\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tgl->gl_hash = hash;\n\tgl->gl_ops = glops;\n\tgl->gl_dstamp = ktime_set(0, 0);\n\tpreempt_disable();\n\t/* We use the global stats to estimate the initial per-glock stats */\n\tgl->gl_stats = this_cpu_ptr(sdp->sd_lkstats)->lkstats[glops->go_type];\n\tpreempt_enable();\n\tgl->gl_stats.stats[GFS2_LKS_DCOUNT] = 0;\n\tgl->gl_stats.stats[GFS2_LKS_QCOUNT] = 0;\n\tgl->gl_tchange = jiffies;\n\tgl->gl_object = NULL;\n\tgl->gl_hold_time = GL_GLOCK_DFT_HOLD;\n\tINIT_DELAYED_WORK(&gl->gl_work, glock_work_func);\n\tINIT_WORK(&gl->gl_delete, delete_work_func);\n\n\tmapping = gfs2_glock2aspace(gl);\n\tif (mapping) {\n                mapping->a_ops = &gfs2_meta_aops;\n\t\tmapping->host = s->s_bdev->bd_inode;\n\t\tmapping->flags = 0;\n\t\tmapping_set_gfp_mask(mapping, GFP_NOFS);\n\t\tmapping->private_data = NULL;\n\t\tmapping->writeback_index = 0;\n\t}\n\n\tspin_lock_bucket(hash);\n\ttmp = search_bucket(hash, sdp, &name);\n\tif (tmp) {\n\t\tspin_unlock_bucket(hash);\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(cachep, gl);\n\t\tatomic_dec(&sdp->sd_glock_disposal);\n\t\tgl = tmp;\n\t} else {\n\t\thlist_bl_add_head_rcu(&gl->gl_list, &gl_hash_table[hash]);\n\t\tspin_unlock_bucket(hash);\n\t}\n\n\t*glp = gl;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "glock_work_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "650-687",
    "snippet": "static void glock_work_func(struct work_struct *work)\n{\n\tunsigned long delay = 0;\n\tstruct gfs2_glock *gl = container_of(work, struct gfs2_glock, gl_work.work);\n\tint drop_ref = 0;\n\n\tif (test_and_clear_bit(GLF_REPLY_PENDING, &gl->gl_flags)) {\n\t\tfinish_xmote(gl, gl->gl_reply);\n\t\tdrop_ref = 1;\n\t}\n\tspin_lock(&gl->gl_spin);\n\tif (test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_state != LM_ST_UNLOCKED &&\n\t    gl->gl_demote_state != LM_ST_EXCLUSIVE) {\n\t\tunsigned long holdtime, now = jiffies;\n\n\t\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\n\t\tif (!delay) {\n\t\t\tclear_bit(GLF_PENDING_DEMOTE, &gl->gl_flags);\n\t\t\tset_bit(GLF_DEMOTE, &gl->gl_flags);\n\t\t}\n\t}\n\trun_queue(gl, 0);\n\tspin_unlock(&gl->gl_spin);\n\tif (!delay)\n\t\tgfs2_glock_put(gl);\n\telse {\n\t\tif (gl->gl_name.ln_type != LM_TYPE_INODE)\n\t\t\tdelay = 0;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\tif (drop_ref)\n\t\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "delay"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "run_queue",
          "args": [
            "gl",
            "0"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "run_queue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "576-626",
          "snippet": "static void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_PENDING_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_before",
          "args": [
            "now",
            "holdtime"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_PENDING_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_xmote",
          "args": [
            "gl",
            "gl->gl_reply"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "finish_xmote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "418-494",
          "snippet": "static void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "GLF_REPLY_PENDING",
            "&gl->gl_flags"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structgfs2_glock",
            "gl_work.work"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void glock_work_func(struct work_struct *work)\n{\n\tunsigned long delay = 0;\n\tstruct gfs2_glock *gl = container_of(work, struct gfs2_glock, gl_work.work);\n\tint drop_ref = 0;\n\n\tif (test_and_clear_bit(GLF_REPLY_PENDING, &gl->gl_flags)) {\n\t\tfinish_xmote(gl, gl->gl_reply);\n\t\tdrop_ref = 1;\n\t}\n\tspin_lock(&gl->gl_spin);\n\tif (test_bit(GLF_PENDING_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_state != LM_ST_UNLOCKED &&\n\t    gl->gl_demote_state != LM_ST_EXCLUSIVE) {\n\t\tunsigned long holdtime, now = jiffies;\n\n\t\tholdtime = gl->gl_tchange + gl->gl_hold_time;\n\t\tif (time_before(now, holdtime))\n\t\t\tdelay = holdtime - now;\n\n\t\tif (!delay) {\n\t\t\tclear_bit(GLF_PENDING_DEMOTE, &gl->gl_flags);\n\t\t\tset_bit(GLF_DEMOTE, &gl->gl_flags);\n\t\t}\n\t}\n\trun_queue(gl, 0);\n\tspin_unlock(&gl->gl_spin);\n\tif (!delay)\n\t\tgfs2_glock_put(gl);\n\telse {\n\t\tif (gl->gl_name.ln_type != LM_TYPE_INODE)\n\t\t\tdelay = 0;\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, delay) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\tif (drop_ref)\n\t\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "delete_work_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "628-648",
    "snippet": "static void delete_work_func(struct work_struct *work)\n{\n\tstruct gfs2_glock *gl = container_of(work, struct gfs2_glock, gl_delete);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_inode *ip;\n\tstruct inode *inode;\n\tu64 no_addr = gl->gl_name.ln_number;\n\n\tip = gl->gl_object;\n\t/* Note: Unsafe to dereference ip as we don't hold right refs/locks */\n\n\tif (ip)\n\t\tinode = gfs2_ilookup(sdp->sd_vfs, no_addr, 1);\n\telse\n\t\tinode = gfs2_lookup_by_inum(sdp, no_addr, NULL, GFS2_BLKST_UNLINKED);\n\tif (inode && !IS_ERR(inode)) {\n\t\td_prune_aliases(inode);\n\t\tiput(inode);\n\t}\n\tgfs2_glock_put(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 645
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_prune_aliases",
          "args": [
            "inode"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "d_prune_aliases",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "882-902",
          "snippet": "void d_prune_aliases(struct inode *inode)\n{\n\tstruct dentry *dentry;\nrestart:\n\tspin_lock(&inode->i_lock);\n\thlist_for_each_entry(dentry, &inode->i_dentry, d_u.d_alias) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (!dentry->d_lockref.count) {\n\t\t\tstruct dentry *parent = lock_parent(dentry);\n\t\t\tif (likely(!dentry->d_lockref.count)) {\n\t\t\t\t__dentry_kill(dentry);\n\t\t\t\tdput(parent);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tif (parent)\n\t\t\t\tspin_unlock(&parent->d_lock);\n\t\t}\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid d_prune_aliases(struct inode *inode)\n{\n\tstruct dentry *dentry;\nrestart:\n\tspin_lock(&inode->i_lock);\n\thlist_for_each_entry(dentry, &inode->i_dentry, d_u.d_alias) {\n\t\tspin_lock(&dentry->d_lock);\n\t\tif (!dentry->d_lockref.count) {\n\t\t\tstruct dentry *parent = lock_parent(dentry);\n\t\t\tif (likely(!dentry->d_lockref.count)) {\n\t\t\t\t__dentry_kill(dentry);\n\t\t\t\tdput(parent);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tif (parent)\n\t\t\t\tspin_unlock(&parent->d_lock);\n\t\t}\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_lookup_by_inum",
          "args": [
            "sdp",
            "no_addr",
            "NULL",
            "GFS2_BLKST_UNLINKED"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_lookup_by_inum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.c",
          "lines": "206-247",
          "snippet": "struct inode *gfs2_lookup_by_inum(struct gfs2_sbd *sdp, u64 no_addr,\n\t\t\t\t  u64 *no_formal_ino, unsigned int blktype)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tstruct gfs2_holder i_gh;\n\tstruct inode *inode = NULL;\n\tint error;\n\n\t/* Must not read in block until block type is verified */\n\terror = gfs2_glock_nq_num(sdp, no_addr, &gfs2_inode_glops,\n\t\t\t\t  LM_ST_EXCLUSIVE, GL_SKIP, &i_gh);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\terror = gfs2_check_blk_type(sdp, no_addr, blktype);\n\tif (error)\n\t\tgoto fail;\n\n\tinode = gfs2_inode_lookup(sb, DT_UNKNOWN, no_addr, 0, 1);\n\tif (IS_ERR(inode))\n\t\tgoto fail;\n\n\t/* Two extra checks for NFS only */\n\tif (no_formal_ino) {\n\t\terror = -ESTALE;\n\t\tif (GFS2_I(inode)->i_no_formal_ino != *no_formal_ino)\n\t\t\tgoto fail_iput;\n\n\t\terror = -EIO;\n\t\tif (GFS2_I(inode)->i_diskflags & GFS2_DIF_SYSTEM)\n\t\t\tgoto fail_iput;\n\n\t\terror = 0;\n\t}\n\nfail:\n\tgfs2_glock_dq_uninit(&i_gh);\n\treturn error ? ERR_PTR(error) : inode;\nfail_iput:\n\tiput(inode);\n\tgoto fail;\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"super.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/fiemap.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"super.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/fiemap.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct inode *gfs2_lookup_by_inum(struct gfs2_sbd *sdp, u64 no_addr,\n\t\t\t\t  u64 *no_formal_ino, unsigned int blktype)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tstruct gfs2_holder i_gh;\n\tstruct inode *inode = NULL;\n\tint error;\n\n\t/* Must not read in block until block type is verified */\n\terror = gfs2_glock_nq_num(sdp, no_addr, &gfs2_inode_glops,\n\t\t\t\t  LM_ST_EXCLUSIVE, GL_SKIP, &i_gh);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\terror = gfs2_check_blk_type(sdp, no_addr, blktype);\n\tif (error)\n\t\tgoto fail;\n\n\tinode = gfs2_inode_lookup(sb, DT_UNKNOWN, no_addr, 0, 1);\n\tif (IS_ERR(inode))\n\t\tgoto fail;\n\n\t/* Two extra checks for NFS only */\n\tif (no_formal_ino) {\n\t\terror = -ESTALE;\n\t\tif (GFS2_I(inode)->i_no_formal_ino != *no_formal_ino)\n\t\t\tgoto fail_iput;\n\n\t\terror = -EIO;\n\t\tif (GFS2_I(inode)->i_diskflags & GFS2_DIF_SYSTEM)\n\t\t\tgoto fail_iput;\n\n\t\terror = 0;\n\t}\n\nfail:\n\tgfs2_glock_dq_uninit(&i_gh);\n\treturn error ? ERR_PTR(error) : inode;\nfail_iput:\n\tiput(inode);\n\tgoto fail;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_ilookup",
          "args": [
            "sdp->sd_vfs",
            "no_addr",
            "1"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ilookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.c",
          "lines": "74-83",
          "snippet": "struct inode *gfs2_ilookup(struct super_block *sb, u64 no_addr, int non_block)\n{\n\tunsigned long hash = (unsigned long)no_addr;\n\tstruct gfs2_skip_data data;\n\n\tdata.no_addr = no_addr;\n\tdata.skipped = 0;\n\tdata.non_block = non_block;\n\treturn ilookup5(sb, hash, iget_test, &data);\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"super.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/fiemap.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"super.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/fiemap.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct inode *gfs2_ilookup(struct super_block *sb, u64 no_addr, int non_block)\n{\n\tunsigned long hash = (unsigned long)no_addr;\n\tstruct gfs2_skip_data data;\n\n\tdata.no_addr = no_addr;\n\tdata.skipped = 0;\n\tdata.non_block = non_block;\n\treturn ilookup5(sb, hash, iget_test, &data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structgfs2_glock",
            "gl_delete"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void delete_work_func(struct work_struct *work)\n{\n\tstruct gfs2_glock *gl = container_of(work, struct gfs2_glock, gl_delete);\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct gfs2_inode *ip;\n\tstruct inode *inode;\n\tu64 no_addr = gl->gl_name.ln_number;\n\n\tip = gl->gl_object;\n\t/* Note: Unsafe to dereference ip as we don't hold right refs/locks */\n\n\tif (ip)\n\t\tinode = gfs2_ilookup(sdp->sd_vfs, no_addr, 1);\n\telse\n\t\tinode = gfs2_lookup_by_inum(sdp, no_addr, NULL, GFS2_BLKST_UNLINKED);\n\tif (inode && !IS_ERR(inode)) {\n\t\td_prune_aliases(inode);\n\t\tiput(inode);\n\t}\n\tgfs2_glock_put(gl);\n}"
  },
  {
    "function_name": "run_queue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "576-626",
    "snippet": "static void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_xmote",
          "args": [
            "gl",
            "gh",
            "gl->gl_target"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "do_xmote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "504-550",
          "snippet": "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);",
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_error",
          "args": [
            "gl",
            "0"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "do_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "282-299",
          "snippet": "static inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_waiter",
          "args": [
            "gl"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_waiter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "360-369",
          "snippet": "static inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_promote",
          "args": [
            "gl"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "do_promote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "309-353",
          "snippet": "static int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_demote_wake",
          "args": [
            "gl"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_demote_wake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "403-409",
          "snippet": "static void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "gl->gl_demote_state == LM_ST_EXCLUSIVE"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_DEMOTE_IN_PROGRESS",
            "&gl->gl_flags"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_holder",
          "args": [
            "gl"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_holder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "557-567",
          "snippet": "static inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void run_queue(struct gfs2_glock *gl, const int nonblock)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tstruct gfs2_holder *gh = NULL;\n\tint ret;\n\n\tif (test_and_set_bit(GLF_LOCK, &gl->gl_flags))\n\t\treturn;\n\n\tGLOCK_BUG_ON(gl, test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags));\n\n\tif (test_bit(GLF_DEMOTE, &gl->gl_flags) &&\n\t    gl->gl_demote_state != gl->gl_state) {\n\t\tif (find_first_holder(gl))\n\t\t\tgoto out_unlock;\n\t\tif (nonblock)\n\t\t\tgoto out_sched;\n\t\tset_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags);\n\t\tGLOCK_BUG_ON(gl, gl->gl_demote_state == LM_ST_EXCLUSIVE);\n\t\tgl->gl_target = gl->gl_demote_state;\n\t} else {\n\t\tif (test_bit(GLF_DEMOTE, &gl->gl_flags))\n\t\t\tgfs2_demote_wake(gl);\n\t\tret = do_promote(gl);\n\t\tif (ret == 0)\n\t\t\tgoto out_unlock;\n\t\tif (ret == 2)\n\t\t\tgoto out;\n\t\tgh = find_first_waiter(gl);\n\t\tgl->gl_target = gh->gh_state;\n\t\tif (!(gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB)))\n\t\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tdo_xmote(gl, gh, gl->gl_target);\nout:\n\treturn;\n\nout_sched:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\tgl->gl_lockref.count++;\n\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\tgl->gl_lockref.count--;\n\treturn;\n\nout_unlock:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\treturn;\n}"
  },
  {
    "function_name": "find_first_holder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "557-567",
    "snippet": "static inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "gl->gl_holders.next",
            "structgfs2_holder",
            "gh_list"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_holder(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tif (!list_empty(&gl->gl_holders)) {\n\t\tgh = list_entry(gl->gl_holders.next, struct gfs2_holder, gh_list);\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "do_xmote",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "504-550",
    "snippet": "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);",
      "static struct workqueue_struct *glock_workqueue;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "193-212",
          "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "glock_workqueue",
            "&gl->gl_work",
            "0"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "o2net_sc_queue_delayed_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/cluster/tcp.c",
          "lines": "481-488",
          "snippet": "static void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}",
          "includes": [
            "#include \"tcp_internal.h\"",
            "#include \"quorum.h\"",
            "#include \"masklog.h\"",
            "#include \"nodemanager.h\"",
            "#include \"tcp.h\"",
            "#include \"heartbeat.h\"",
            "#include <asm/uaccess.h>",
            "#include <net/tcp.h>",
            "#include <linux/export.h>",
            "#include <linux/net.h>",
            "#include <linux/kref.h>",
            "#include <linux/idr.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct workqueue_struct *o2net_wq;",
            "static void o2net_sc_connect_completed(struct work_struct *work);",
            "static void o2net_rx_until_empty(struct work_struct *work);",
            "static void o2net_shutdown_sc(struct work_struct *work);",
            "static void o2net_sc_send_keep_req(struct work_struct *work);",
            "static void o2net_sc_postpone_idle(struct o2net_sock_container *sc);",
            "static void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcp_internal.h\"\n#include \"quorum.h\"\n#include \"masklog.h\"\n#include \"nodemanager.h\"\n#include \"tcp.h\"\n#include \"heartbeat.h\"\n#include <asm/uaccess.h>\n#include <net/tcp.h>\n#include <linux/export.h>\n#include <linux/net.h>\n#include <linux/kref.h>\n#include <linux/idr.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/kernel.h>\n\nstatic struct workqueue_struct *o2net_wq;\nstatic void o2net_sc_connect_completed(struct work_struct *work);\nstatic void o2net_rx_until_empty(struct work_struct *work);\nstatic void o2net_shutdown_sc(struct work_struct *work);\nstatic void o2net_sc_send_keep_req(struct work_struct *work);\nstatic void o2net_sc_postpone_idle(struct o2net_sock_container *sc);\nstatic void o2net_sc_reset_idle_timer(struct o2net_sock_container *sc);\n\nstatic void o2net_sc_queue_delayed_work(struct o2net_sock_container *sc,\n\t\t\t\t\tstruct delayed_work *work,\n\t\t\t\t\tint delay)\n{\n\tsc_get(sc);\n\tif (!queue_delayed_work(o2net_wq, work, delay))\n\t\tsc_put(sc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_xmote",
          "args": [
            "gl",
            "target"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "finish_xmote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "418-494",
          "snippet": "static void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "1"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"lm_lock ret %d\\n\"",
            "ret"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp->sd_lockstruct.ls_ops->lm_lock",
          "args": [
            "gl",
            "target",
            "lck_flags"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock_hold",
          "args": [
            "gl"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_hold",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "135-139",
          "snippet": "static void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_INVALIDATE_IN_PROGRESS",
            "&gl->gl_flags"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "glops->go_inval",
          "args": [
            "gl",
            "target == LM_ST_DEFERRED ? 0 : DIO_METADATA"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_INVALIDATE_IN_PROGRESS",
            "&gl->gl_flags"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "glops->go_sync",
          "args": [
            "gl"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_BLOCKING",
            "&gl->gl_flags"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_error",
          "args": [
            "gl",
            "0"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "do_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "282-299",
          "snippet": "static inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "gl->gl_state == gl->gl_target"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "gl->gl_state == target"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}"
  },
  {
    "function_name": "finish_xmote",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "418-494",
    "snippet": "static void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LOCK",
            "&gl->gl_flags"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_promote",
          "args": [
            "gl"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "do_promote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "309-353",
          "snippet": "static int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_error",
          "args": [
            "gl",
            "rv"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "do_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "282-299",
          "snippet": "static inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "glops->go_xmote_bh",
          "args": [
            "gl",
            "gh"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_demote_wake",
          "args": [
            "gl"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_demote_wake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "403-409",
          "snippet": "static void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "GLF_DEMOTE_IN_PROGRESS",
            "&gl->gl_flags"
          ],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "1"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"wanted %u got %u\\n\"",
            "gl->gl_target",
            "state"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_xmote",
          "args": [
            "gl",
            "gh",
            "LM_ST_UNLOCKED"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "do_xmote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "504-550",
          "snippet": "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);",
            "static struct workqueue_struct *glock_workqueue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target);\nstatic struct workqueue_struct *glock_workqueue;\n\nstatic void do_xmote(struct gfs2_glock *gl, struct gfs2_holder *gh, unsigned int target)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tunsigned int lck_flags = gh ? gh->gh_flags : 0;\n\tint ret;\n\n\tlck_flags &= (LM_FLAG_TRY | LM_FLAG_TRY_1CB | LM_FLAG_NOEXP |\n\t\t      LM_FLAG_PRIORITY);\n\tGLOCK_BUG_ON(gl, gl->gl_state == target);\n\tGLOCK_BUG_ON(gl, gl->gl_state == gl->gl_target);\n\tif ((target == LM_ST_UNLOCKED || target == LM_ST_DEFERRED) &&\n\t    glops->go_inval) {\n\t\tset_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\t\tdo_error(gl, 0); /* Fail queued try locks */\n\t}\n\tgl->gl_req = target;\n\tset_bit(GLF_BLOCKING, &gl->gl_flags);\n\tif ((gl->gl_req == LM_ST_UNLOCKED) ||\n\t    (gl->gl_state == LM_ST_EXCLUSIVE) ||\n\t    (lck_flags & (LM_FLAG_TRY|LM_FLAG_TRY_1CB)))\n\t\tclear_bit(GLF_BLOCKING, &gl->gl_flags);\n\tspin_unlock(&gl->gl_spin);\n\tif (glops->go_sync)\n\t\tglops->go_sync(gl);\n\tif (test_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags))\n\t\tglops->go_inval(gl, target == LM_ST_DEFERRED ? 0 : DIO_METADATA);\n\tclear_bit(GLF_INVALIDATE_IN_PROGRESS, &gl->gl_flags);\n\n\tgfs2_glock_hold(gl);\n\tif (sdp->sd_lockstruct.ls_ops->lm_lock)\t{\n\t\t/* lock_dlm */\n\t\tret = sdp->sd_lockstruct.ls_ops->lm_lock(gl, target, lck_flags);\n\t\tif (ret) {\n\t\t\tpr_err(\"lm_lock ret %d\\n\", ret);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t} else { /* lock_nolock */\n\t\tfinish_xmote(gl, target);\n\t\tif (queue_delayed_work(glock_workqueue, &gl->gl_work, 0) == 0)\n\t\t\tgfs2_glock_put(gl);\n\t}\n\n\tspin_lock(&gl->gl_spin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_waiter",
          "args": [
            "gl"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_waiter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "360-369",
          "snippet": "static inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_move_tail",
          "args": [
            "&gh->gh_list",
            "&gl->gl_holders"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "GLF_DEMOTE_IN_PROGRESS",
            "&gl->gl_flags"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "state != gl->gl_target"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "state_change",
          "args": [
            "gl",
            "state"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "state_change",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "378-401",
          "snippet": "static void state_change(struct gfs2_glock *gl, unsigned int new_state)\n{\n\tint held1, held2;\n\n\theld1 = (gl->gl_state != LM_ST_UNLOCKED);\n\theld2 = (new_state != LM_ST_UNLOCKED);\n\n\tif (held1 != held2) {\n\t\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\t\tif (held2)\n\t\t\tgl->gl_lockref.count++;\n\t\telse\n\t\t\tgl->gl_lockref.count--;\n\t}\n\tif (held1 && held2 && list_empty(&gl->gl_holders))\n\t\tclear_bit(GLF_QUEUED, &gl->gl_flags);\n\n\tif (new_state != gl->gl_target)\n\t\t/* shorten our minimum hold time */\n\t\tgl->gl_hold_time = max(gl->gl_hold_time - GL_GLOCK_HOLD_DECR,\n\t\t\t\t       GL_GLOCK_MIN_HOLD);\n\tgl->gl_state = new_state;\n\tgl->gl_tchange = jiffies;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void state_change(struct gfs2_glock *gl, unsigned int new_state)\n{\n\tint held1, held2;\n\n\theld1 = (gl->gl_state != LM_ST_UNLOCKED);\n\theld2 = (new_state != LM_ST_UNLOCKED);\n\n\tif (held1 != held2) {\n\t\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\t\tif (held2)\n\t\t\tgl->gl_lockref.count++;\n\t\telse\n\t\t\tgl->gl_lockref.count--;\n\t}\n\tif (held1 && held2 && list_empty(&gl->gl_holders))\n\t\tclear_bit(GLF_QUEUED, &gl->gl_flags);\n\n\tif (new_state != gl->gl_target)\n\t\t/* shorten our minimum hold time */\n\t\tgl->gl_hold_time = max(gl->gl_hold_time - GL_GLOCK_HOLD_DECR,\n\t\t\t\t       GL_GLOCK_MIN_HOLD);\n\tgl->gl_state = new_state;\n\tgl->gl_tchange = jiffies;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_state_change",
          "args": [
            "gl",
            "state"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void finish_xmote(struct gfs2_glock *gl, unsigned int ret)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh;\n\tunsigned state = ret & LM_OUT_ST_MASK;\n\tint rv;\n\n\tspin_lock(&gl->gl_spin);\n\ttrace_gfs2_glock_state_change(gl, state);\n\tstate_change(gl, state);\n\tgh = find_first_waiter(gl);\n\n\t/* Demote to UN request arrived during demote to SH or DF */\n\tif (test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags) &&\n\t    state != LM_ST_UNLOCKED && gl->gl_demote_state == LM_ST_UNLOCKED)\n\t\tgl->gl_target = LM_ST_UNLOCKED;\n\n\t/* Check for state != intended state */\n\tif (unlikely(state != gl->gl_target)) {\n\t\tif (gh && !test_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags)) {\n\t\t\t/* move to back of queue and try next entry */\n\t\t\tif (ret & LM_OUT_CANCELED) {\n\t\t\t\tif ((gh->gh_flags & LM_FLAG_PRIORITY) == 0)\n\t\t\t\t\tlist_move_tail(&gh->gh_list, &gl->gl_holders);\n\t\t\t\tgh = find_first_waiter(gl);\n\t\t\t\tgl->gl_target = gh->gh_state;\n\t\t\t\tgoto retry;\n\t\t\t}\n\t\t\t/* Some error or failed \"try lock\" - report it */\n\t\t\tif ((ret & LM_OUT_ERROR) ||\n\t\t\t    (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))) {\n\t\t\t\tgl->gl_target = gl->gl_state;\n\t\t\t\tdo_error(gl, ret);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\tswitch(state) {\n\t\t/* Unlocked due to conversion deadlock, try again */\n\t\tcase LM_ST_UNLOCKED:\nretry:\n\t\t\tdo_xmote(gl, gh, gl->gl_target);\n\t\t\tbreak;\n\t\t/* Conversion fails, unlock and try again */\n\t\tcase LM_ST_SHARED:\n\t\tcase LM_ST_DEFERRED:\n\t\t\tdo_xmote(gl, gh, LM_ST_UNLOCKED);\n\t\t\tbreak;\n\t\tdefault: /* Everything else */\n\t\t\tpr_err(\"wanted %u got %u\\n\", gl->gl_target, state);\n\t\t\tGLOCK_BUG_ON(gl, 1);\n\t\t}\n\t\tspin_unlock(&gl->gl_spin);\n\t\treturn;\n\t}\n\n\t/* Fast path - we got what we asked for */\n\tif (test_and_clear_bit(GLF_DEMOTE_IN_PROGRESS, &gl->gl_flags))\n\t\tgfs2_demote_wake(gl);\n\tif (state != LM_ST_UNLOCKED) {\n\t\tif (glops->go_xmote_bh) {\n\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\trv = glops->go_xmote_bh(gl, gh);\n\t\t\tspin_lock(&gl->gl_spin);\n\t\t\tif (rv) {\n\t\t\t\tdo_error(gl, rv);\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t\trv = do_promote(gl);\n\t\tif (rv == 2)\n\t\t\tgoto out_locked;\n\t}\nout:\n\tclear_bit(GLF_LOCK, &gl->gl_flags);\nout_locked:\n\tspin_unlock(&gl->gl_spin);\n}"
  },
  {
    "function_name": "gfs2_demote_wake",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "403-409",
    "snippet": "static void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&gl->gl_flags",
            "GLF_DEMOTE"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_DEMOTE",
            "&gl->gl_flags"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_demote_wake(struct gfs2_glock *gl)\n{\n\tgl->gl_demote_state = LM_ST_EXCLUSIVE;\n\tclear_bit(GLF_DEMOTE, &gl->gl_flags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gl->gl_flags, GLF_DEMOTE);\n}"
  },
  {
    "function_name": "state_change",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "378-401",
    "snippet": "static void state_change(struct gfs2_glock *gl, unsigned int new_state)\n{\n\tint held1, held2;\n\n\theld1 = (gl->gl_state != LM_ST_UNLOCKED);\n\theld2 = (new_state != LM_ST_UNLOCKED);\n\n\tif (held1 != held2) {\n\t\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\t\tif (held2)\n\t\t\tgl->gl_lockref.count++;\n\t\telse\n\t\t\tgl->gl_lockref.count--;\n\t}\n\tif (held1 && held2 && list_empty(&gl->gl_holders))\n\t\tclear_bit(GLF_QUEUED, &gl->gl_flags);\n\n\tif (new_state != gl->gl_target)\n\t\t/* shorten our minimum hold time */\n\t\tgl->gl_hold_time = max(gl->gl_hold_time - GL_GLOCK_HOLD_DECR,\n\t\t\t\t       GL_GLOCK_MIN_HOLD);\n\tgl->gl_state = new_state;\n\tgl->gl_tchange = jiffies;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "max",
          "args": [
            "gl->gl_hold_time - GL_GLOCK_HOLD_DECR",
            "GL_GLOCK_MIN_HOLD"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "max_select_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/select.c",
          "lines": "342-382",
          "snippet": "static int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <net/busy_poll.h>",
            "#include <linux/freezer.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/personality.h> /* for STICKY_TIMEOUTS */",
            "#include <linux/poll.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <net/busy_poll.h>\n#include <linux/freezer.h>\n#include <linux/sched/rt.h>\n#include <linux/hrtimer.h>\n#include <linux/rcupdate.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/personality.h> /* for STICKY_TIMEOUTS */\n#include <linux/poll.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_QUEUED",
            "&gl->gl_flags"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "__lockref_is_dead(&gl->gl_lockref)"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__lockref_is_dead",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void state_change(struct gfs2_glock *gl, unsigned int new_state)\n{\n\tint held1, held2;\n\n\theld1 = (gl->gl_state != LM_ST_UNLOCKED);\n\theld2 = (new_state != LM_ST_UNLOCKED);\n\n\tif (held1 != held2) {\n\t\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\t\tif (held2)\n\t\t\tgl->gl_lockref.count++;\n\t\telse\n\t\t\tgl->gl_lockref.count--;\n\t}\n\tif (held1 && held2 && list_empty(&gl->gl_holders))\n\t\tclear_bit(GLF_QUEUED, &gl->gl_flags);\n\n\tif (new_state != gl->gl_target)\n\t\t/* shorten our minimum hold time */\n\t\tgl->gl_hold_time = max(gl->gl_hold_time - GL_GLOCK_HOLD_DECR,\n\t\t\t\t       GL_GLOCK_MIN_HOLD);\n\tgl->gl_state = new_state;\n\tgl->gl_tchange = jiffies;\n}"
  },
  {
    "function_name": "find_first_waiter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "360-369",
    "snippet": "static inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gh",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct gfs2_holder *find_first_waiter(const struct gfs2_glock *gl)\n{\n\tstruct gfs2_holder *gh;\n\n\tlist_for_each_entry(gh, &gl->gl_holders, gh_list) {\n\t\tif (!test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\treturn gh;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "do_promote",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "309-353",
    "snippet": "static int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_error",
          "args": [
            "gl",
            "0"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "do_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "282-299",
          "snippet": "static inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_holder_wake",
          "args": [
            "gh"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_holder_wake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "270-275",
          "snippet": "static void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_promote",
          "args": [
            "gh",
            "0"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_promote",
          "args": [
            "gh",
            "1"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_queue",
          "args": [
            "gh",
            "0"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gh->gh_list"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "glops->go_lock",
          "args": [
            "gh"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "may_grant",
          "args": [
            "gl",
            "gh"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "may_grant",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "249-268",
          "snippet": "static inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "gh",
            "tmp",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__acquires",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&gl->gl_spin"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int do_promote(struct gfs2_glock *gl)\n__releases(&gl->gl_spin)\n__acquires(&gl->gl_spin)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\tstruct gfs2_holder *gh, *tmp;\n\tint ret;\n\nrestart:\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (may_grant(gl, gh)) {\n\t\t\tif (gh->gh_list.prev == &gl->gl_holders &&\n\t\t\t    glops->go_lock) {\n\t\t\t\tspin_unlock(&gl->gl_spin);\n\t\t\t\t/* FIXME: eliminate this eventually */\n\t\t\t\tret = glops->go_lock(gh);\n\t\t\t\tspin_lock(&gl->gl_spin);\n\t\t\t\tif (ret) {\n\t\t\t\t\tif (ret == 1)\n\t\t\t\t\t\treturn 2;\n\t\t\t\t\tgh->gh_error = ret;\n\t\t\t\t\tlist_del_init(&gh->gh_list);\n\t\t\t\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\t\tgoto restart;\n\t\t\t\t}\n\t\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\t\ttrace_gfs2_promote(gh, 1);\n\t\t\t\tgfs2_holder_wake(gh);\n\t\t\t\tgoto restart;\n\t\t\t}\n\t\t\tset_bit(HIF_HOLDER, &gh->gh_iflags);\n\t\t\ttrace_gfs2_promote(gh, 0);\n\t\t\tgfs2_holder_wake(gh);\n\t\t\tcontinue;\n\t\t}\n\t\tif (gh->gh_list.prev == &gl->gl_holders)\n\t\t\treturn 1;\n\t\tdo_error(gl, 0);\n\t\tbreak;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "do_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "282-299",
    "snippet": "static inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_holder_wake",
          "args": [
            "gh"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_holder_wake",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "270-275",
          "snippet": "static void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_queue",
          "args": [
            "gh",
            "0"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gh->gh_list"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "HIF_HOLDER",
            "&gh->gh_iflags"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "gh",
            "tmp",
            "&gl->gl_holders",
            "gh_list"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline void do_error(struct gfs2_glock *gl, const int ret)\n{\n\tstruct gfs2_holder *gh, *tmp;\n\n\tlist_for_each_entry_safe(gh, tmp, &gl->gl_holders, gh_list) {\n\t\tif (test_bit(HIF_HOLDER, &gh->gh_iflags))\n\t\t\tcontinue;\n\t\tif (ret & LM_OUT_ERROR)\n\t\t\tgh->gh_error = -EIO;\n\t\telse if (gh->gh_flags & (LM_FLAG_TRY | LM_FLAG_TRY_1CB))\n\t\t\tgh->gh_error = GLR_TRYFAILED;\n\t\telse\n\t\t\tcontinue;\n\t\tlist_del_init(&gh->gh_list);\n\t\ttrace_gfs2_glock_queue(gh, 0);\n\t\tgfs2_holder_wake(gh);\n\t}\n}"
  },
  {
    "function_name": "gfs2_holder_wake",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "270-275",
    "snippet": "static void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_bit",
          "args": [
            "&gh->gh_iflags",
            "HIF_WAIT"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "HIF_WAIT",
            "&gh->gh_iflags"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_holder_wake(struct gfs2_holder *gh)\n{\n\tclear_bit(HIF_WAIT, &gh->gh_iflags);\n\tsmp_mb__after_atomic();\n\twake_up_bit(&gh->gh_iflags, HIF_WAIT);\n}"
  },
  {
    "function_name": "may_grant",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "249-268",
    "snippet": "static inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "gl->gl_holders.next",
            "const structgfs2_holder",
            "gh_list"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline int may_grant(const struct gfs2_glock *gl, const struct gfs2_holder *gh)\n{\n\tconst struct gfs2_holder *gh_head = list_entry(gl->gl_holders.next, const struct gfs2_holder, gh_list);\n\tif ((gh->gh_state == LM_ST_EXCLUSIVE ||\n\t     gh_head->gh_state == LM_ST_EXCLUSIVE) && gh != gh_head)\n\t\treturn 0;\n\tif (gl->gl_state == gh->gh_state)\n\t\treturn 1;\n\tif (gh->gh_flags & GL_EXACT)\n\t\treturn 0;\n\tif (gl->gl_state == LM_ST_EXCLUSIVE) {\n\t\tif (gh->gh_state == LM_ST_SHARED && gh_head->gh_state == LM_ST_SHARED)\n\t\t\treturn 1;\n\t\tif (gh->gh_state == LM_ST_DEFERRED && gh_head->gh_state == LM_ST_DEFERRED)\n\t\t\treturn 1;\n\t}\n\tif (gl->gl_state != LM_ST_UNLOCKED && (gh->gh_flags & LM_FLAG_ANY))\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "search_bucket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "222-239",
    "snippet": "static struct gfs2_glock *search_bucket(unsigned int hash,\n\t\t\t\t\tconst struct gfs2_sbd *sdp,\n\t\t\t\t\tconst struct lm_lockname *name)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_node *h;\n\n\thlist_bl_for_each_entry_rcu(gl, h, &gl_hash_table[hash], gl_list) {\n\t\tif (!lm_name_equal(&gl->gl_name, name))\n\t\t\tcontinue;\n\t\tif (gl->gl_sbd != sdp)\n\t\t\tcontinue;\n\t\tif (lockref_get_not_dead(&gl->gl_lockref))\n\t\t\treturn gl;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockref_get_not_dead",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_name_equal",
          "args": [
            "&gl->gl_name",
            "name"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry_rcu",
          "args": [
            "gl",
            "h",
            "&gl_hash_table[hash]",
            "gl_list"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic struct gfs2_glock *search_bucket(unsigned int hash,\n\t\t\t\t\tconst struct gfs2_sbd *sdp,\n\t\t\t\t\tconst struct lm_lockname *name)\n{\n\tstruct gfs2_glock *gl;\n\tstruct hlist_bl_node *h;\n\n\thlist_bl_for_each_entry_rcu(gl, h, &gl_hash_table[hash], gl_list) {\n\t\tif (!lm_name_equal(&gl->gl_name, name))\n\t\t\tcontinue;\n\t\tif (gl->gl_sbd != sdp)\n\t\t\tcontinue;\n\t\tif (lockref_get_not_dead(&gl->gl_lockref))\n\t\t\treturn gl;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "gfs2_glock_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "193-212",
    "snippet": "void gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp->sd_lockstruct.ls_ops->lm_put_lock",
          "args": [
            "gl"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_gfs2_glock_put",
          "args": [
            "gl"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "mapping && mapping->nrpages"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "!list_empty(&gl->gl_holders)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_bucket",
          "args": [
            "gl->gl_hash"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_del_rcu",
          "args": [
            "&gl->gl_list"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_bucket",
          "args": [
            "gl->gl_hash"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_remove_from_lru",
          "args": [
            "gl"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_remove_from_lru",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "176-185",
          "snippet": "static void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t lru_count = ATOMIC_INIT(0);",
            "static DEFINE_SPINLOCK(lru_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockref_mark_dead",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockref_put_or_lock",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_glock2aspace",
          "args": [
            "gl"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock2aspace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.h",
          "lines": "174-179",
          "snippet": "static inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/parser.h>\n#include <linux/sched.h>\n\nstatic inline struct address_space *gfs2_glock2aspace(struct gfs2_glock *gl)\n{\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE)\n\t\treturn (struct address_space *)(gl + 1);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_put(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\tstruct address_space *mapping = gfs2_glock2aspace(gl);\n\n\tif (lockref_put_or_lock(&gl->gl_lockref))\n\t\treturn;\n\n\tlockref_mark_dead(&gl->gl_lockref);\n\n\tgfs2_glock_remove_from_lru(gl);\n\tspin_unlock(&gl->gl_lockref.lock);\n\tspin_lock_bucket(gl->gl_hash);\n\thlist_bl_del_rcu(&gl->gl_list);\n\tspin_unlock_bucket(gl->gl_hash);\n\tGLOCK_BUG_ON(gl, !list_empty(&gl->gl_holders));\n\tGLOCK_BUG_ON(gl, mapping && mapping->nrpages);\n\ttrace_gfs2_glock_put(gl);\n\tsdp->sd_lockstruct.ls_ops->lm_put_lock(gl);\n}"
  },
  {
    "function_name": "gfs2_glock_remove_from_lru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "176-185",
    "snippet": "static void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_t lru_count = ATOMIC_INIT(0);",
      "static DEFINE_SPINLOCK(lru_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lru_lock"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "GLF_LRU",
            "&gl->gl_flags"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&lru_count"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lru_lock"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nstatic void gfs2_glock_remove_from_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\tif (!list_empty(&gl->gl_lru)) {\n\t\tlist_del_init(&gl->gl_lru);\n\t\tatomic_dec(&lru_count);\n\t\tclear_bit(GLF_LRU, &gl->gl_flags);\n\t}\n\tspin_unlock(&lru_lock);\n}"
  },
  {
    "function_name": "gfs2_glock_add_to_lru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "162-174",
    "snippet": "void gfs2_glock_add_to_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\n\tif (!list_empty(&gl->gl_lru))\n\t\tlist_del_init(&gl->gl_lru);\n\telse\n\t\tatomic_inc(&lru_count);\n\n\tlist_add_tail(&gl->gl_lru, &lru_list);\n\tset_bit(GLF_LRU, &gl->gl_flags);\n\tspin_unlock(&lru_lock);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(lru_list);",
      "static atomic_t lru_count = ATOMIC_INIT(0);",
      "static DEFINE_SPINLOCK(lru_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lru_lock"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "103-106",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "GLF_LRU",
            "&gl->gl_flags"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&gl->gl_lru",
            "&lru_list"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&lru_count"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_lru"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lru_lock"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "98-101",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic LIST_HEAD(lru_list);\nstatic atomic_t lru_count = ATOMIC_INIT(0);\nstatic DEFINE_SPINLOCK(lru_lock);\n\nvoid gfs2_glock_add_to_lru(struct gfs2_glock *gl)\n{\n\tspin_lock(&lru_lock);\n\n\tif (!list_empty(&gl->gl_lru))\n\t\tlist_del_init(&gl->gl_lru);\n\telse\n\t\tatomic_inc(&lru_count);\n\n\tlist_add_tail(&gl->gl_lru, &lru_list);\n\tset_bit(GLF_LRU, &gl->gl_flags);\n\tspin_unlock(&lru_lock);\n}"
  },
  {
    "function_name": "demote_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "148-159",
    "snippet": "static int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glops->go_demote_ok",
          "args": [
            "gl"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&gl->gl_holders"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int demote_ok(const struct gfs2_glock *gl)\n{\n\tconst struct gfs2_glock_operations *glops = gl->gl_ops;\n\n\tif (gl->gl_state == LM_ST_UNLOCKED)\n\t\treturn 0;\n\tif (!list_empty(&gl->gl_holders))\n\t\treturn 0;\n\tif (glops->go_demote_ok)\n\t\treturn glops->go_demote_ok(gl);\n\treturn 1;\n}"
  },
  {
    "function_name": "gfs2_glock_hold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "135-139",
    "snippet": "static void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockref_get",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GLOCK_BUG_ON",
          "args": [
            "gl",
            "__lockref_is_dead(&gl->gl_lockref)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__lockref_is_dead",
          "args": [
            "&gl->gl_lockref"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_hold(struct gfs2_glock *gl)\n{\n\tGLOCK_BUG_ON(gl, __lockref_is_dead(&gl->gl_lockref));\n\tlockref_get(&gl->gl_lockref);\n}"
  },
  {
    "function_name": "gfs2_glock_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "120-127",
    "snippet": "void gfs2_glock_free(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\n\tcall_rcu(&gl->gl_rcu, gfs2_glock_dealloc);\n\tif (atomic_dec_and_test(&sdp->sd_glock_disposal))\n\t\twake_up(&sdp->sd_glock_wait);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&sdp->sd_glock_wait"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_wake_up_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/quota.c",
          "lines": "1409-1414",
          "snippet": "void gfs2_wake_up_statfs(struct gfs2_sbd *sdp) {\n\tif (!sdp->sd_statfs_force_sync) {\n\t\tsdp->sd_statfs_force_sync = 1;\n\t\twake_up(&sdp->sd_quota_wait);\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_wake_up_statfs(struct gfs2_sbd *sdp) {\n\tif (!sdp->sd_statfs_force_sync) {\n\t\tsdp->sd_statfs_force_sync = 1;\n\t\twake_up(&sdp->sd_quota_wait);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&sdp->sd_glock_disposal"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&gl->gl_rcu",
            "gfs2_glock_dealloc"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_free(struct gfs2_glock *gl)\n{\n\tstruct gfs2_sbd *sdp = gl->gl_sbd;\n\n\tcall_rcu(&gl->gl_rcu, gfs2_glock_dealloc);\n\tif (atomic_dec_and_test(&sdp->sd_glock_disposal))\n\t\twake_up(&sdp->sd_glock_wait);\n}"
  },
  {
    "function_name": "gfs2_glock_dealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "108-118",
    "snippet": "static void gfs2_glock_dealloc(struct rcu_head *rcu)\n{\n\tstruct gfs2_glock *gl = container_of(rcu, struct gfs2_glock, gl_rcu);\n\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE) {\n\t\tkmem_cache_free(gfs2_glock_aspace_cachep, gl);\n\t} else {\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(gfs2_glock_cachep, gl);\n\t}\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "gfs2_glock_cachep",
            "gl"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "gl->gl_lksb.sb_lvbptr"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "gfs2_glock_aspace_cachep",
            "gl"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "rcu",
            "structgfs2_glock",
            "gl_rcu"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void gfs2_glock_dealloc(struct rcu_head *rcu)\n{\n\tstruct gfs2_glock *gl = container_of(rcu, struct gfs2_glock, gl_rcu);\n\n\tif (gl->gl_ops->go_flags & GLOF_ASPACE) {\n\t\tkmem_cache_free(gfs2_glock_aspace_cachep, gl);\n\t} else {\n\t\tkfree(gl->gl_lksb.sb_lvbptr);\n\t\tkmem_cache_free(gfs2_glock_cachep, gl);\n\t}\n}"
  },
  {
    "function_name": "spin_unlock_bucket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "103-106",
    "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "&gl_hash_table[hash]"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n\thlist_bl_unlock(&gl_hash_table[hash]);\n}"
  },
  {
    "function_name": "spin_lock_bucket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "98-101",
    "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "&gl_hash_table[hash]"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head gl_hash_table[GFS2_GL_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n\thlist_bl_lock(&gl_hash_table[hash]);\n}"
  },
  {
    "function_name": "gl_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
    "lines": "85-96",
    "snippet": "static unsigned int gl_hash(const struct gfs2_sbd *sdp,\n\t\t\t    const struct lm_lockname *name)\n{\n\tunsigned int h;\n\n\th = jhash(&name->ln_number, sizeof(u64), 0);\n\th = jhash(&name->ln_type, sizeof(unsigned int), h);\n\th = jhash(&sdp, sizeof(struct gfs2_sbd *), h);\n\th &= GFS2_GL_HASH_MASK;\n\n\treturn h;\n}",
    "includes": [
      "#include \"trace_gfs2.h\"",
      "#include \"bmap.h\"",
      "#include \"util.h\"",
      "#include \"super.h\"",
      "#include \"quota.h\"",
      "#include \"meta_io.h\"",
      "#include \"lops.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/lockref.h>",
      "#include <linux/list_sort.h>",
      "#include <linux/percpu.h>",
      "#include <linux/bit_spinlock.h>",
      "#include <linux/rculist_bl.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/seq_file.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/module.h>",
      "#include <linux/wait.h>",
      "#include <linux/list.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/jhash.h>",
      "#include <linux/sort.h>",
      "#include <linux/delay.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define GFS2_GL_HASH_MASK       (GFS2_GL_HASH_SIZE - 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "jhash",
          "args": [
            "&sdp",
            "sizeof(struct gfs2_sbd *)",
            "h"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jhash",
          "args": [
            "&name->ln_type",
            "sizeof(unsigned int)",
            "h"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jhash",
          "args": [
            "&name->ln_number",
            "sizeof(u64)",
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define GFS2_GL_HASH_MASK       (GFS2_GL_HASH_SIZE - 1)\n\nstatic unsigned int gl_hash(const struct gfs2_sbd *sdp,\n\t\t\t    const struct lm_lockname *name)\n{\n\tunsigned int h;\n\n\th = jhash(&name->ln_number, sizeof(u64), 0);\n\th = jhash(&name->ln_type, sizeof(unsigned int), h);\n\th = jhash(&sdp, sizeof(struct gfs2_sbd *), h);\n\th &= GFS2_GL_HASH_MASK;\n\n\treturn h;\n}"
  }
]