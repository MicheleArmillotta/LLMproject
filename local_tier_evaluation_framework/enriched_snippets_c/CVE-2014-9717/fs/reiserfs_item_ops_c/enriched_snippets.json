[
  {
    "function_name": "errcatch_print_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "720-724",
    "snippet": "static void errcatch_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"green-16011\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16011\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void errcatch_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"green-16011\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}"
  },
  {
    "function_name": "errcatch_unit_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "713-718",
    "snippet": "static int errcatch_unit_num(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"green-16010\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16010\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_unit_num(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"green-16010\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}"
  },
  {
    "function_name": "errcatch_part_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "706-711",
    "snippet": "static int errcatch_part_size(struct virtual_item *vi, int first, int count)\n{\n\treiserfs_warning(NULL, \"green-16009\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16009\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_part_size(struct virtual_item *vi, int first, int count)\n{\n\treiserfs_warning(NULL, \"green-16009\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}"
  },
  {
    "function_name": "errcatch_check_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "699-704",
    "snippet": "static int errcatch_check_right(struct virtual_item *vi, int free)\n{\n\treiserfs_warning(NULL, \"green-16008\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16008\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_check_right(struct virtual_item *vi, int free)\n{\n\treiserfs_warning(NULL, \"green-16008\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn -1;\n}"
  },
  {
    "function_name": "errcatch_check_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "691-697",
    "snippet": "static int errcatch_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\treiserfs_warning(NULL, \"green-16007\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16007\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\treiserfs_warning(NULL, \"green-16007\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn -1;\n}"
  },
  {
    "function_name": "errcatch_create_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "677-689",
    "snippet": "static int errcatch_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\treiserfs_warning(NULL, \"green-16006\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\t/*\n\t * We might return -1 here as well, but it won't help as\n\t * create_virtual_node() from where this operation is called\n\t * from is of return type void.\n\t */\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16006\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\treiserfs_warning(NULL, \"green-16006\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\t/*\n\t * We might return -1 here as well, but it won't help as\n\t * create_virtual_node() from where this operation is called\n\t * from is of return type void.\n\t */\n\treturn 0;\n}"
  },
  {
    "function_name": "errcatch_check_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "671-675",
    "snippet": "static void errcatch_check_item(struct item_head *ih, char *item)\n{\n\treiserfs_warning(NULL, \"green-16005\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16005\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void errcatch_check_item(struct item_head *ih, char *item)\n{\n\treiserfs_warning(NULL, \"green-16005\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}"
  },
  {
    "function_name": "errcatch_print_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "665-669",
    "snippet": "static void errcatch_print_item(struct item_head *ih, char *item)\n{\n\treiserfs_warning(NULL, \"green-16004\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16004\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void errcatch_print_item(struct item_head *ih, char *item)\n{\n\treiserfs_warning(NULL, \"green-16004\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}"
  },
  {
    "function_name": "errcatch_is_left_mergeable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "657-663",
    "snippet": "static int errcatch_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\treiserfs_warning(NULL, \"green-16003\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16003\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\treiserfs_warning(NULL, \"green-16003\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}"
  },
  {
    "function_name": "errcatch_decrement_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "651-655",
    "snippet": "static void errcatch_decrement_key(struct cpu_key *key)\n{\n\treiserfs_warning(NULL, \"green-16002\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16002\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void errcatch_decrement_key(struct cpu_key *key)\n{\n\treiserfs_warning(NULL, \"green-16002\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n}"
  },
  {
    "function_name": "errcatch_bytes_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "644-649",
    "snippet": "static int errcatch_bytes_number(struct item_head *ih, int block_size)\n{\n\treiserfs_warning(NULL, \"green-16001\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"green-16001\"",
            "\"Invalid item type observed, run fsck ASAP\""
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int errcatch_bytes_number(struct item_head *ih, int block_size)\n{\n\treiserfs_warning(NULL, \"green-16001\",\n\t\t\t \"Invalid item type observed, run fsck ASAP\");\n\treturn 0;\n}"
  },
  {
    "function_name": "direntry_print_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "614-626",
    "snippet": "static void direntry_print_vi(struct virtual_item *vi)\n{\n\tint i;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\treiserfs_warning(NULL, \"reiserfs-16104\",\n\t\t\t \"DIRENTRY, index %d, type 0x%x, %h, flags 0x%x\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih, dir_u->flags);\n\tprintk(\"%d entries: \", dir_u->entry_count);\n\tfor (i = 0; i < dir_u->entry_count; i++)\n\t\tprintk(\"%d \", dir_u->entry_sizes[i]);\n\tprintk(\"\\n\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"\\n\""
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"reiserfs-16104\"",
            "\"DIRENTRY, index %d, type 0x%x, %h, flags 0x%x\"",
            "vi->vi_index",
            "vi->vi_type",
            "vi->vi_ih",
            "dir_u->flags"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "266-277",
          "snippet": "void __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direntry_print_vi(struct virtual_item *vi)\n{\n\tint i;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\treiserfs_warning(NULL, \"reiserfs-16104\",\n\t\t\t \"DIRENTRY, index %d, type 0x%x, %h, flags 0x%x\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih, dir_u->flags);\n\tprintk(\"%d entries: \", dir_u->entry_count);\n\tfor (i = 0; i < dir_u->entry_count; i++)\n\t\tprintk(\"%d \", dir_u->entry_sizes[i]);\n\tprintk(\"\\n\");\n}"
  },
  {
    "function_name": "direntry_unit_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "607-612",
    "snippet": "static int direntry_unit_num(struct virtual_item *vi)\n{\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\treturn dir_u->entry_count;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direntry_unit_num(struct virtual_item *vi)\n{\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\treturn dir_u->entry_count;\n}"
  },
  {
    "function_name": "direntry_part_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "588-605",
    "snippet": "static int direntry_part_size(struct virtual_item *vi, int first, int count)\n{\n\tint i, retval;\n\tint from, to;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tretval = 0;\n\tif (first == 0)\n\t\tfrom = 0;\n\telse\n\t\tfrom = dir_u->entry_count - count;\n\tto = from + count - 1;\n\n\tfor (i = from; i <= to; i++)\n\t\tretval += dir_u->entry_sizes[i];\n\n\treturn retval;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direntry_part_size(struct virtual_item *vi, int first, int count)\n{\n\tint i, retval;\n\tint from, to;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tretval = 0;\n\tif (first == 0)\n\t\tfrom = 0;\n\telse\n\t\tfrom = dir_u->entry_count - count;\n\tto = from + count - 1;\n\n\tfor (i = from; i <= to; i++)\n\t\tretval += dir_u->entry_sizes[i];\n\n\treturn retval;\n}"
  },
  {
    "function_name": "direntry_check_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "563-585",
    "snippet": "static int direntry_check_right(struct virtual_item *vi, int free)\n{\n\tint i;\n\tint entries = 0;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tfor (i = dir_u->entry_count - 1; i >= 0; i--) {\n\t\t/* i-th entry doesn't fit into the remaining free space */\n\t\tif (dir_u->entry_sizes[i] > free)\n\t\t\tbreak;\n\n\t\tfree -= dir_u->entry_sizes[i];\n\t\tentries++;\n\t}\n\tBUG_ON(entries == dir_u->entry_count);\n\n\t/* \".\" and \"..\" can not be separated from each other */\n\tif ((dir_u->flags & DIRENTRY_VI_FIRST_DIRENTRY_ITEM)\n\t    && entries > dir_u->entry_count - 2)\n\t\tentries = dir_u->entry_count - 2;\n\n\treturn entries ? : -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [
      "#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "entries == dir_u->entry_count"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\n#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1\n\nstatic int direntry_check_right(struct virtual_item *vi, int free)\n{\n\tint i;\n\tint entries = 0;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tfor (i = dir_u->entry_count - 1; i >= 0; i--) {\n\t\t/* i-th entry doesn't fit into the remaining free space */\n\t\tif (dir_u->entry_sizes[i] > free)\n\t\t\tbreak;\n\n\t\tfree -= dir_u->entry_sizes[i];\n\t\tentries++;\n\t}\n\tBUG_ON(entries == dir_u->entry_count);\n\n\t/* \".\" and \"..\" can not be separated from each other */\n\tif ((dir_u->flags & DIRENTRY_VI_FIRST_DIRENTRY_ITEM)\n\t    && entries > dir_u->entry_count - 2)\n\t\tentries = dir_u->entry_count - 2;\n\n\treturn entries ? : -1;\n}"
  },
  {
    "function_name": "direntry_check_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "533-561",
    "snippet": "static int direntry_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint i;\n\tint entries = 0;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tfor (i = start_skip; i < dir_u->entry_count - end_skip; i++) {\n\t\t/* i-th entry doesn't fit into the remaining free space */\n\t\tif (dir_u->entry_sizes[i] > free)\n\t\t\tbreak;\n\n\t\tfree -= dir_u->entry_sizes[i];\n\t\tentries++;\n\t}\n\n\tif (entries == dir_u->entry_count) {\n\t\treiserfs_panic(NULL, \"item_ops-1\",\n\t\t\t       \"free space %d, entry_count %d\", free,\n\t\t\t       dir_u->entry_count);\n\t}\n\n\t/* \".\" and \"..\" can not be separated from each other */\n\tif (start_skip == 0 && (dir_u->flags & DIRENTRY_VI_FIRST_DIRENTRY_ITEM)\n\t    && entries < 2)\n\t\tentries = 0;\n\n\treturn entries ? : -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [
      "#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1"
    ],
    "globals_used": [
      "struct item_operations *item_ops[TYPE_ANY + 1] = {\n\t&stat_data_ops,\n\t&indirect_ops,\n\t&direct_ops,\n\t&direntry_ops,\n\tNULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,\n\t&errcatch_ops\t\t/* This is to catch errors with invalid type (15th entry for TYPE_ANY) */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_panic",
          "args": [
            "NULL",
            "\"item_ops-1\"",
            "\"free space %d, entry_count %d\"",
            "free",
            "dir_u->entry_count"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "356-372",
          "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\n#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1\n\nstruct item_operations *item_ops[TYPE_ANY + 1] = {\n\t&stat_data_ops,\n\t&indirect_ops,\n\t&direct_ops,\n\t&direntry_ops,\n\tNULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,\n\t&errcatch_ops\t\t/* This is to catch errors with invalid type (15th entry for TYPE_ANY) */\n};\n\nstatic int direntry_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint i;\n\tint entries = 0;\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\n\tfor (i = start_skip; i < dir_u->entry_count - end_skip; i++) {\n\t\t/* i-th entry doesn't fit into the remaining free space */\n\t\tif (dir_u->entry_sizes[i] > free)\n\t\t\tbreak;\n\n\t\tfree -= dir_u->entry_sizes[i];\n\t\tentries++;\n\t}\n\n\tif (entries == dir_u->entry_count) {\n\t\treiserfs_panic(NULL, \"item_ops-1\",\n\t\t\t       \"free space %d, entry_count %d\", free,\n\t\t\t       dir_u->entry_count);\n\t}\n\n\t/* \".\" and \"..\" can not be separated from each other */\n\tif (start_skip == 0 && (dir_u->flags & DIRENTRY_VI_FIRST_DIRENTRY_ITEM)\n\t    && entries < 2)\n\t\tentries = 0;\n\n\treturn entries ? : -1;\n}"
  },
  {
    "function_name": "direntry_create_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "466-527",
    "snippet": "static int direntry_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\tint i, j;\n\tint size = sizeof(struct direntry_uarea);\n\tstruct reiserfs_de_head *deh;\n\n\tvi->vi_index = TYPE_DIRENTRY;\n\n\tBUG_ON(!(vi->vi_ih) || !vi->vi_item);\n\n\tdir_u->flags = 0;\n\tif (le_ih_k_offset(vi->vi_ih) == DOT_OFFSET)\n\t\tdir_u->flags |= DIRENTRY_VI_FIRST_DIRENTRY_ITEM;\n\n\tdeh = (struct reiserfs_de_head *)(vi->vi_item);\n\n\t/* virtual directory item have this amount of entry after */\n\tdir_u->entry_count = ih_entry_count(vi->vi_ih) +\n\t    ((is_affected) ? ((vn->vn_mode == M_CUT) ? -1 :\n\t\t\t      (vn->vn_mode == M_PASTE ? 1 : 0)) : 0);\n\n\tfor (i = 0; i < dir_u->entry_count; i++) {\n\t\tj = old_entry_num(is_affected, i, vn->vn_pos_in_item,\n\t\t\t\t  vn->vn_mode);\n\t\tdir_u->entry_sizes[i] =\n\t\t    (j ? deh_location(&deh[j - 1]) : ih_item_len(vi->vi_ih)) -\n\t\t    deh_location(&deh[j]) + DEH_SIZE;\n\t}\n\n\tsize += (dir_u->entry_count * sizeof(short));\n\n\t/* set size of pasted entry */\n\tif (is_affected && vn->vn_mode == M_PASTE)\n\t\tdir_u->entry_sizes[vn->vn_pos_in_item] = insert_size;\n\n#ifdef CONFIG_REISERFS_CHECK\n\t/* compare total size of entries with item length */\n\t{\n\t\tint k, l;\n\n\t\tl = 0;\n\t\tfor (k = 0; k < dir_u->entry_count; k++)\n\t\t\tl += dir_u->entry_sizes[k];\n\n\t\tif (l + IH_SIZE != vi->vi_item_len +\n\t\t    ((is_affected\n\t\t      && (vn->vn_mode == M_PASTE\n\t\t\t  || vn->vn_mode == M_CUT)) ? insert_size : 0)) {\n\t\t\treiserfs_panic(NULL, \"vs-8025\", \"(mode==%c, \"\n\t\t\t\t       \"insert_size==%d), invalid length of \"\n\t\t\t\t       \"directory item\",\n\t\t\t\t       vn->vn_mode, insert_size);\n\t\t}\n\t}\n#endif\n\n\treturn size;\n\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [
      "#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_panic",
          "args": [
            "NULL",
            "\"vs-8025\"",
            "\"(mode==%c, \"\n\t\t\t\t       \"insert_size==%d), invalid length of \"\n\t\t\t\t       \"directory item\"",
            "vn->vn_mode",
            "insert_size"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_panic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "356-372",
          "snippet": "void __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_panic(struct super_block *sb, const char *id,\n\t\t      const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\n#ifdef CONFIG_REISERFS_CHECK\n\tdump_stack();\n#endif\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS panic (device %s): %s%s%s: %s\\n\",\n\t\t      sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t      function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS panic: %s%s%s: %s\\n\",\n\t\t      id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n\tBUG();\n}"
        }
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "&deh[j]"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "vi->vi_ih"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "&deh[j - 1]"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_entry_num",
          "args": [
            "is_affected",
            "i",
            "vn->vn_pos_in_item",
            "vn->vn_mode"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "old_entry_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "438-459",
          "snippet": "static inline int old_entry_num(int is_affected, int virtual_entry_num,\n\t\t\t\tint pos_in_item, int mode)\n{\n\tif (mode == M_INSERT || mode == M_DELETE)\n\t\treturn virtual_entry_num;\n\n\tif (!is_affected)\n\t\t/* cut or paste is applied to another item */\n\t\treturn virtual_entry_num;\n\n\tif (virtual_entry_num < pos_in_item)\n\t\treturn virtual_entry_num;\n\n\tif (mode == M_CUT)\n\t\treturn virtual_entry_num + 1;\n\n\tRFALSE(mode != M_PASTE || virtual_entry_num == 0,\n\t       \"vs-8015: old_entry_num: mode must be M_PASTE (mode = \\'%c\\'\",\n\t       mode);\n\n\treturn virtual_entry_num - 1;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic inline int old_entry_num(int is_affected, int virtual_entry_num,\n\t\t\t\tint pos_in_item, int mode)\n{\n\tif (mode == M_INSERT || mode == M_DELETE)\n\t\treturn virtual_entry_num;\n\n\tif (!is_affected)\n\t\t/* cut or paste is applied to another item */\n\t\treturn virtual_entry_num;\n\n\tif (virtual_entry_num < pos_in_item)\n\t\treturn virtual_entry_num;\n\n\tif (mode == M_CUT)\n\t\treturn virtual_entry_num + 1;\n\n\tRFALSE(mode != M_PASTE || virtual_entry_num == 0,\n\t       \"vs-8015: old_entry_num: mode must be M_PASTE (mode = \\'%c\\'\",\n\t       mode);\n\n\treturn virtual_entry_num - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ih_entry_count",
          "args": [
            "vi->vi_ih"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le_ih_k_offset",
          "args": [
            "vi->vi_ih"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "le_ih_k_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1481-1484",
          "snippet": "static inline loff_t le_ih_k_offset(const struct item_head *ih)\n{\n\treturn le_key_k_offset(ih_version(ih), &(ih->ih_key));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_ih_k_offset(const struct item_head *ih)\n{\n\treturn le_key_k_offset(ih_version(ih), &(ih->ih_key));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!(vi->vi_ih) || !vi->vi_item"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\n#define DIRENTRY_VI_FIRST_DIRENTRY_ITEM 1\n\nstatic int direntry_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\tstruct direntry_uarea *dir_u = vi->vi_uarea;\n\tint i, j;\n\tint size = sizeof(struct direntry_uarea);\n\tstruct reiserfs_de_head *deh;\n\n\tvi->vi_index = TYPE_DIRENTRY;\n\n\tBUG_ON(!(vi->vi_ih) || !vi->vi_item);\n\n\tdir_u->flags = 0;\n\tif (le_ih_k_offset(vi->vi_ih) == DOT_OFFSET)\n\t\tdir_u->flags |= DIRENTRY_VI_FIRST_DIRENTRY_ITEM;\n\n\tdeh = (struct reiserfs_de_head *)(vi->vi_item);\n\n\t/* virtual directory item have this amount of entry after */\n\tdir_u->entry_count = ih_entry_count(vi->vi_ih) +\n\t    ((is_affected) ? ((vn->vn_mode == M_CUT) ? -1 :\n\t\t\t      (vn->vn_mode == M_PASTE ? 1 : 0)) : 0);\n\n\tfor (i = 0; i < dir_u->entry_count; i++) {\n\t\tj = old_entry_num(is_affected, i, vn->vn_pos_in_item,\n\t\t\t\t  vn->vn_mode);\n\t\tdir_u->entry_sizes[i] =\n\t\t    (j ? deh_location(&deh[j - 1]) : ih_item_len(vi->vi_ih)) -\n\t\t    deh_location(&deh[j]) + DEH_SIZE;\n\t}\n\n\tsize += (dir_u->entry_count * sizeof(short));\n\n\t/* set size of pasted entry */\n\tif (is_affected && vn->vn_mode == M_PASTE)\n\t\tdir_u->entry_sizes[vn->vn_pos_in_item] = insert_size;\n\n#ifdef CONFIG_REISERFS_CHECK\n\t/* compare total size of entries with item length */\n\t{\n\t\tint k, l;\n\n\t\tl = 0;\n\t\tfor (k = 0; k < dir_u->entry_count; k++)\n\t\t\tl += dir_u->entry_sizes[k];\n\n\t\tif (l + IH_SIZE != vi->vi_item_len +\n\t\t    ((is_affected\n\t\t      && (vn->vn_mode == M_PASTE\n\t\t\t  || vn->vn_mode == M_CUT)) ? insert_size : 0)) {\n\t\t\treiserfs_panic(NULL, \"vs-8025\", \"(mode==%c, \"\n\t\t\t\t       \"insert_size==%d), invalid length of \"\n\t\t\t\t       \"directory item\",\n\t\t\t\t       vn->vn_mode, insert_size);\n\t\t}\n\t}\n#endif\n\n\treturn size;\n\n}"
  },
  {
    "function_name": "old_entry_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "438-459",
    "snippet": "static inline int old_entry_num(int is_affected, int virtual_entry_num,\n\t\t\t\tint pos_in_item, int mode)\n{\n\tif (mode == M_INSERT || mode == M_DELETE)\n\t\treturn virtual_entry_num;\n\n\tif (!is_affected)\n\t\t/* cut or paste is applied to another item */\n\t\treturn virtual_entry_num;\n\n\tif (virtual_entry_num < pos_in_item)\n\t\treturn virtual_entry_num;\n\n\tif (mode == M_CUT)\n\t\treturn virtual_entry_num + 1;\n\n\tRFALSE(mode != M_PASTE || virtual_entry_num == 0,\n\t       \"vs-8015: old_entry_num: mode must be M_PASTE (mode = \\'%c\\'\",\n\t       mode);\n\n\treturn virtual_entry_num - 1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RFALSE",
          "args": [
            "mode != M_PASTE || virtual_entry_num == 0",
            "\"vs-8015: old_entry_num: mode must be M_PASTE (mode = \\'%c\\'\"",
            "mode"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic inline int old_entry_num(int is_affected, int virtual_entry_num,\n\t\t\t\tint pos_in_item, int mode)\n{\n\tif (mode == M_INSERT || mode == M_DELETE)\n\t\treturn virtual_entry_num;\n\n\tif (!is_affected)\n\t\t/* cut or paste is applied to another item */\n\t\treturn virtual_entry_num;\n\n\tif (virtual_entry_num < pos_in_item)\n\t\treturn virtual_entry_num;\n\n\tif (mode == M_CUT)\n\t\treturn virtual_entry_num + 1;\n\n\tRFALSE(mode != M_PASTE || virtual_entry_num == 0,\n\t       \"vs-8015: old_entry_num: mode must be M_PASTE (mode = \\'%c\\'\",\n\t       mode);\n\n\treturn virtual_entry_num - 1;\n}"
  },
  {
    "function_name": "direntry_check_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "420-430",
    "snippet": "static void direntry_check_item(struct item_head *ih, char *item)\n{\n\tint i;\n\tstruct reiserfs_de_head *deh;\n\n\t/* unused */\n\tdeh = (struct reiserfs_de_head *)item;\n\tfor (i = 0; i < ih_entry_count(ih); i++, deh++) {\n\t\t;\n\t}\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ih_entry_count",
          "args": [
            "ih"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direntry_check_item(struct item_head *ih, char *item)\n{\n\tint i;\n\tstruct reiserfs_de_head *deh;\n\n\t/* unused */\n\tdeh = (struct reiserfs_de_head *)item;\n\tfor (i = 0; i < ih_entry_count(ih); i++, deh++) {\n\t\t;\n\t}\n}"
  },
  {
    "function_name": "direntry_print_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "380-418",
    "snippet": "static void direntry_print_item(struct item_head *ih, char *item)\n{\n\tint i;\n\tint namelen;\n\tstruct reiserfs_de_head *deh;\n\tchar *name;\n\tstatic char namebuf[80];\n\n\tprintk(\"\\n # %-15s%-30s%-15s%-15s%-15s\\n\", \"Name\",\n\t       \"Key of pointed object\", \"Hash\", \"Gen number\", \"Status\");\n\n\tdeh = (struct reiserfs_de_head *)item;\n\n\tfor (i = 0; i < ih_entry_count(ih); i++, deh++) {\n\t\tnamelen =\n\t\t    (i ? (deh_location(deh - 1)) : ih_item_len(ih)) -\n\t\t    deh_location(deh);\n\t\tname = item + deh_location(deh);\n\t\tif (name[namelen - 1] == 0)\n\t\t\tnamelen = strlen(name);\n\t\tnamebuf[0] = '\"';\n\t\tif (namelen > sizeof(namebuf) - 3) {\n\t\t\tstrncpy(namebuf + 1, name, sizeof(namebuf) - 3);\n\t\t\tnamebuf[sizeof(namebuf) - 2] = '\"';\n\t\t\tnamebuf[sizeof(namebuf) - 1] = 0;\n\t\t} else {\n\t\t\tmemcpy(namebuf + 1, name, namelen);\n\t\t\tnamebuf[namelen + 1] = '\"';\n\t\t\tnamebuf[namelen + 2] = 0;\n\t\t}\n\n\t\tprintk(\"%d:  %-15s%-15d%-15d%-15lld%-15lld(%s)\\n\",\n\t\t       i, namebuf,\n\t\t       deh_dir_id(deh), deh_objectid(deh),\n\t\t       GET_HASH_VALUE(deh_offset(deh)),\n\t\t       GET_GENERATION_NUMBER((deh_offset(deh))),\n\t\t       (de_hidden(deh)) ? \"HIDDEN\" : \"VISIBLE\");\n\t}\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%d:  %-15s%-15d%-15d%-15lld%-15lld(%s)\\n\"",
            "i",
            "namebuf",
            "deh_dir_id(deh)",
            "deh_objectid(deh)",
            "GET_HASH_VALUE(deh_offset(deh))",
            "GET_GENERATION_NUMBER((deh_offset(deh)))",
            "(de_hidden(deh)) ? \"HIDDEN\" : \"VISIBLE\""
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "de_hidden",
          "args": [
            "deh"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_GENERATION_NUMBER",
          "args": [
            "(deh_offset(deh))"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_offset",
          "args": [
            "deh"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HASH_VALUE",
          "args": [
            "deh_offset(deh)"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_offset",
          "args": [
            "deh"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_objectid",
          "args": [
            "deh"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_dir_id",
          "args": [
            "deh"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "namebuf + 1",
            "name",
            "namelen"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "namebuf + 1",
            "name",
            "sizeof(namebuf) - 3"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "deh"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "deh"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deh_location",
          "args": [
            "deh - 1"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_entry_count",
          "args": [
            "ih"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direntry_print_item(struct item_head *ih, char *item)\n{\n\tint i;\n\tint namelen;\n\tstruct reiserfs_de_head *deh;\n\tchar *name;\n\tstatic char namebuf[80];\n\n\tprintk(\"\\n # %-15s%-30s%-15s%-15s%-15s\\n\", \"Name\",\n\t       \"Key of pointed object\", \"Hash\", \"Gen number\", \"Status\");\n\n\tdeh = (struct reiserfs_de_head *)item;\n\n\tfor (i = 0; i < ih_entry_count(ih); i++, deh++) {\n\t\tnamelen =\n\t\t    (i ? (deh_location(deh - 1)) : ih_item_len(ih)) -\n\t\t    deh_location(deh);\n\t\tname = item + deh_location(deh);\n\t\tif (name[namelen - 1] == 0)\n\t\t\tnamelen = strlen(name);\n\t\tnamebuf[0] = '\"';\n\t\tif (namelen > sizeof(namebuf) - 3) {\n\t\t\tstrncpy(namebuf + 1, name, sizeof(namebuf) - 3);\n\t\t\tnamebuf[sizeof(namebuf) - 2] = '\"';\n\t\t\tnamebuf[sizeof(namebuf) - 1] = 0;\n\t\t} else {\n\t\t\tmemcpy(namebuf + 1, name, namelen);\n\t\t\tnamebuf[namelen + 1] = '\"';\n\t\t\tnamebuf[namelen + 2] = 0;\n\t\t}\n\n\t\tprintk(\"%d:  %-15s%-15d%-15d%-15lld%-15lld(%s)\\n\",\n\t\t       i, namebuf,\n\t\t       deh_dir_id(deh), deh_objectid(deh),\n\t\t       GET_HASH_VALUE(deh_offset(deh)),\n\t\t       GET_GENERATION_NUMBER((deh_offset(deh))),\n\t\t       (de_hidden(deh)) ? \"HIDDEN\" : \"VISIBLE\");\n\t}\n}"
  },
  {
    "function_name": "direntry_is_left_mergeable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "371-378",
    "snippet": "static int direntry_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\tif (le32_to_cpu(key->u.k_offset_v1.k_offset) == DOT_OFFSET)\n\t\treturn 0;\n\treturn 1;\n\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le32_to_cpu",
          "args": [
            "key->u.k_offset_v1.k_offset"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "sle32_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "53-56",
          "snippet": "static inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s32 sle32_to_cpup(sle32 *x)\n{\n\treturn le32_to_cpu(*(__force le32*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direntry_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\tif (le32_to_cpu(key->u.k_offset_v1.k_offset) == DOT_OFFSET)\n\t\treturn 0;\n\treturn 1;\n\n}"
  },
  {
    "function_name": "direntry_decrement_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "364-369",
    "snippet": "static void direntry_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpu_key_k_type",
          "args": [
            "key",
            "TYPE_STAT_DATA"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1598-1601",
          "snippet": "static inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_key_k_offset",
          "args": [
            "key"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_offset_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1603-1606",
          "snippet": "static inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direntry_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}"
  },
  {
    "function_name": "direntry_bytes_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "357-362",
    "snippet": "static int direntry_bytes_number(struct item_head *ih, int block_size)\n{\n\treiserfs_warning(NULL, \"vs-16090\",\n\t\t\t \"bytes number is asked for direntry\");\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"vs-16090\"",
            "\"bytes number is asked for direntry\""
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direntry_bytes_number(struct item_head *ih, int block_size)\n{\n\treiserfs_warning(NULL, \"vs-16090\",\n\t\t\t \"bytes number is asked for direntry\");\n\treturn 0;\n}"
  },
  {
    "function_name": "indirect_print_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "334-339",
    "snippet": "static void indirect_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16103\",\n\t\t\t \"INDIRECT, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"reiserfs-16103\"",
            "\"INDIRECT, index %d, type 0x%x, %h\"",
            "vi->vi_index",
            "vi->vi_type",
            "vi->vi_ih"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "266-277",
          "snippet": "void __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void indirect_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16103\",\n\t\t\t \"INDIRECT, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}"
  },
  {
    "function_name": "indirect_unit_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "328-332",
    "snippet": "static int indirect_unit_num(struct virtual_item *vi)\n{\n\t/* unit of indirect item is byte (yet) */\n\treturn vi->vi_item_len - IH_SIZE;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_unit_num(struct virtual_item *vi)\n{\n\t/* unit of indirect item is byte (yet) */\n\treturn vi->vi_item_len - IH_SIZE;\n}"
  },
  {
    "function_name": "indirect_part_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "322-326",
    "snippet": "static int indirect_part_size(struct virtual_item *vi, int first, int units)\n{\n\t/* unit of indirect item is byte (yet) */\n\treturn units;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_part_size(struct virtual_item *vi, int first, int units)\n{\n\t/* unit of indirect item is byte (yet) */\n\treturn units;\n}"
  },
  {
    "function_name": "indirect_check_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "313-316",
    "snippet": "static int indirect_check_right(struct virtual_item *vi, int free)\n{\n\treturn indirect_check_left(vi, free, 0, 0);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indirect_check_left",
          "args": [
            "vi",
            "free",
            "0",
            "0"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "indirect_check_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "304-311",
          "snippet": "static int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_check_right(struct virtual_item *vi, int free)\n{\n\treturn indirect_check_left(vi, free, 0, 0);\n}"
  },
  {
    "function_name": "indirect_check_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "304-311",
    "snippet": "static int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}"
  },
  {
    "function_name": "indirect_create_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "296-302",
    "snippet": "static int indirect_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_INDIRECT;\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_create_vi(struct virtual_node *vn,\n\t\t\t      struct virtual_item *vi,\n\t\t\t      int is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_INDIRECT;\n\treturn 0;\n}"
  },
  {
    "function_name": "indirect_check_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "291-294",
    "snippet": "static void indirect_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void indirect_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}"
  },
  {
    "function_name": "indirect_print_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "268-289",
    "snippet": "static void indirect_print_item(struct item_head *ih, char *item)\n{\n\tint j;\n\t__le32 *unp;\n\t__u32 prev = INT_MAX;\n\tint num = 0;\n\n\tunp = (__le32 *) item;\n\n\tif (ih_item_len(ih) % UNFM_P_SIZE)\n\t\treiserfs_warning(NULL, \"reiserfs-16102\", \"invalid item len\");\n\n\tprintk(\"%d pointers\\n[ \", (int)I_UNFM_NUM(ih));\n\tfor (j = 0; j < I_UNFM_NUM(ih); j++) {\n\t\tif (sequence_finished(prev, &num, get_block_num(unp, j))) {\n\t\t\tprint_sequence(prev, num);\n\t\t\tstart_new_sequence(&prev, &num, get_block_num(unp, j));\n\t\t}\n\t}\n\tprint_sequence(prev, num);\n\tprintk(\"]\\n\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"]\\n\""
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_sequence",
          "args": [
            "prev",
            "num"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "print_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "257-266",
          "snippet": "static void print_sequence(__u32 start, int len)\n{\n\tif (start == INT_MAX)\n\t\treturn;\n\n\tif (len == 1)\n\t\tprintk(\" %d\", start);\n\telse\n\t\tprintk(\" %d(%d)\", start, len);\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void print_sequence(__u32 start, int len)\n{\n\tif (start == INT_MAX)\n\t\treturn;\n\n\tif (len == 1)\n\t\tprintk(\" %d\", start);\n\telse\n\t\tprintk(\" %d(%d)\", start, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "start_new_sequence",
          "args": [
            "&prev",
            "&num",
            "get_block_num(unp, j)"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "start_new_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "235-239",
          "snippet": "static void start_new_sequence(__u32 * start, int *len, __u32 new)\n{\n\t*start = new;\n\t*len = 1;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void start_new_sequence(__u32 * start, int *len, __u32 new)\n{\n\t*start = new;\n\t*len = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_block_num",
          "args": [
            "unp",
            "j"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sequence_finished",
          "args": [
            "prev",
            "&num",
            "get_block_num(unp, j)"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "sequence_finished",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "241-255",
          "snippet": "static int sequence_finished(__u32 start, int *len, __u32 new)\n{\n\tif (start == INT_MAX)\n\t\treturn 1;\n\n\tif (start == 0 && new == 0) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\tif (start != 0 && (start + *len) == new) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sequence_finished(__u32 start, int *len, __u32 new)\n{\n\tif (start == INT_MAX)\n\t\treturn 1;\n\n\tif (start == 0 && new == 0) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\tif (start != 0 && (start + *len) == new) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_block_num",
          "args": [
            "unp",
            "j"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "I_UNFM_NUM",
          "args": [
            "ih"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "I_UNFM_NUM",
          "args": [
            "ih"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"reiserfs-16102\"",
            "\"invalid item len\""
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void indirect_print_item(struct item_head *ih, char *item)\n{\n\tint j;\n\t__le32 *unp;\n\t__u32 prev = INT_MAX;\n\tint num = 0;\n\n\tunp = (__le32 *) item;\n\n\tif (ih_item_len(ih) % UNFM_P_SIZE)\n\t\treiserfs_warning(NULL, \"reiserfs-16102\", \"invalid item len\");\n\n\tprintk(\"%d pointers\\n[ \", (int)I_UNFM_NUM(ih));\n\tfor (j = 0; j < I_UNFM_NUM(ih); j++) {\n\t\tif (sequence_finished(prev, &num, get_block_num(unp, j))) {\n\t\t\tprint_sequence(prev, num);\n\t\t\tstart_new_sequence(&prev, &num, get_block_num(unp, j));\n\t\t}\n\t}\n\tprint_sequence(prev, num);\n\tprintk(\"]\\n\");\n}"
  },
  {
    "function_name": "print_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "257-266",
    "snippet": "static void print_sequence(__u32 start, int len)\n{\n\tif (start == INT_MAX)\n\t\treturn;\n\n\tif (len == 1)\n\t\tprintk(\" %d\", start);\n\telse\n\t\tprintk(\" %d(%d)\", start, len);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\" %d(%d)\"",
            "start",
            "len"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void print_sequence(__u32 start, int len)\n{\n\tif (start == INT_MAX)\n\t\treturn;\n\n\tif (len == 1)\n\t\tprintk(\" %d\", start);\n\telse\n\t\tprintk(\" %d(%d)\", start, len);\n}"
  },
  {
    "function_name": "sequence_finished",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "241-255",
    "snippet": "static int sequence_finished(__u32 start, int *len, __u32 new)\n{\n\tif (start == INT_MAX)\n\t\treturn 1;\n\n\tif (start == 0 && new == 0) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\tif (start != 0 && (start + *len) == new) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sequence_finished(__u32 start, int *len, __u32 new)\n{\n\tif (start == INT_MAX)\n\t\treturn 1;\n\n\tif (start == 0 && new == 0) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\tif (start != 0 && (start + *len) == new) {\n\t\t(*len)++;\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "start_new_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "235-239",
    "snippet": "static void start_new_sequence(__u32 * start, int *len, __u32 new)\n{\n\t*start = new;\n\t*len = 1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void start_new_sequence(__u32 * start, int *len, __u32 new)\n{\n\t*start = new;\n\t*len = 1;\n}"
  },
  {
    "function_name": "indirect_is_left_mergeable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "227-232",
    "snippet": "static int indirect_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\tint version = le_key_version(key);\n\treturn (le_key_k_offset(version, key) != 1);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le_key_k_offset",
          "args": [
            "version",
            "key"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_k_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1473-1479",
          "snippet": "static inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}"
        }
      },
      {
        "call_info": {
          "callee": "le_key_version",
          "args": [
            "key"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2980-2991",
          "snippet": "static inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define TYPE_DIRENTRY 3",
            "#define TYPE_DIRECT 2",
            "#define TYPE_INDIRECT 1",
            "#define KEY_FORMAT_3_6 1",
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define TYPE_DIRENTRY 3\n#define TYPE_DIRECT 2\n#define TYPE_INDIRECT 1\n#define KEY_FORMAT_3_6 1\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t      unsigned long bsize)\n{\n\tint version = le_key_version(key);\n\treturn (le_key_k_offset(version, key) != 1);\n}"
  },
  {
    "function_name": "indirect_decrement_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "219-224",
    "snippet": "static void indirect_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpu_key_k_type",
          "args": [
            "key",
            "TYPE_STAT_DATA"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1598-1601",
          "snippet": "static inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_key_k_offset",
          "args": [
            "key"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_offset_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1603-1606",
          "snippet": "static inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void indirect_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}"
  },
  {
    "function_name": "indirect_bytes_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "213-216",
    "snippet": "static int indirect_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn ih_item_len(ih) / UNFM_P_SIZE * block_size;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn ih_item_len(ih) / UNFM_P_SIZE * block_size;\n}"
  },
  {
    "function_name": "direct_print_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "190-195",
    "snippet": "static void direct_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16101\",\n\t\t\t \"DIRECT, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"reiserfs-16101\"",
            "\"DIRECT, index %d, type 0x%x, %h\"",
            "vi->vi_index",
            "vi->vi_type",
            "vi->vi_ih"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "266-277",
          "snippet": "void __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direct_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16101\",\n\t\t\t \"DIRECT, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}"
  },
  {
    "function_name": "direct_unit_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "185-188",
    "snippet": "static int direct_unit_num(struct virtual_item *vi)\n{\n\treturn vi->vi_item_len - IH_SIZE;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_unit_num(struct virtual_item *vi)\n{\n\treturn vi->vi_item_len - IH_SIZE;\n}"
  },
  {
    "function_name": "direct_part_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "180-183",
    "snippet": "static int direct_part_size(struct virtual_item *vi, int first, int count)\n{\n\treturn count;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_part_size(struct virtual_item *vi, int first, int count)\n{\n\treturn count;\n}"
  },
  {
    "function_name": "direct_check_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "175-178",
    "snippet": "static int direct_check_right(struct virtual_item *vi, int free)\n{\n\treturn direct_check_left(vi, free, 0, 0);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "direct_check_left",
          "args": [
            "vi",
            "free",
            "0",
            "0"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "indirect_check_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "304-311",
          "snippet": "static int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int indirect_check_left(struct virtual_item *vi, int free,\n\t\t\t       int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % UNFM_P_SIZE;\n\treturn bytes ? : -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_check_right(struct virtual_item *vi, int free)\n{\n\treturn direct_check_left(vi, free, 0, 0);\n}"
  },
  {
    "function_name": "direct_check_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "166-173",
    "snippet": "static int direct_check_left(struct virtual_item *vi, int free,\n\t\t\t     int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % 8;\n\treturn bytes ? : -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_check_left(struct virtual_item *vi, int free,\n\t\t\t     int start_skip, int end_skip)\n{\n\tint bytes;\n\n\tbytes = free - free % 8;\n\treturn bytes ? : -1;\n}"
  },
  {
    "function_name": "direct_create_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "158-164",
    "snippet": "static int direct_create_vi(struct virtual_node *vn,\n\t\t\t    struct virtual_item *vi,\n\t\t\t    int is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_DIRECT;\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_create_vi(struct virtual_node *vn,\n\t\t\t    struct virtual_item *vi,\n\t\t\t    int is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_DIRECT;\n\treturn 0;\n}"
  },
  {
    "function_name": "direct_check_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "153-156",
    "snippet": "static void direct_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direct_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}"
  },
  {
    "function_name": "direct_print_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "142-151",
    "snippet": "static void direct_print_item(struct item_head *ih, char *item)\n{\n\tint j = 0;\n\n/*    return; */\n\tprintk(\"\\\"\");\n\twhile (j < ih_item_len(ih))\n\t\tprintk(\"%c\", item[j++]);\n\tprintk(\"\\\"\\n\");\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"\\\"\\n\""
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direct_print_item(struct item_head *ih, char *item)\n{\n\tint j = 0;\n\n/*    return; */\n\tprintk(\"\\\"\");\n\twhile (j < ih_item_len(ih))\n\t\tprintk(\"%c\", item[j++]);\n\tprintk(\"\\\"\\n\");\n}"
  },
  {
    "function_name": "direct_is_left_mergeable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "135-140",
    "snippet": "static int direct_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t    unsigned long bsize)\n{\n\tint version = le_key_version(key);\n\treturn ((le_key_k_offset(version, key) & (bsize - 1)) != 1);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le_key_k_offset",
          "args": [
            "version",
            "key"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_k_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1473-1479",
          "snippet": "static inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline loff_t le_key_k_offset(int version,\n\t\t\t\t     const struct reiserfs_key *key)\n{\n\treturn (version == KEY_FORMAT_3_5) ?\n\t    le32_to_cpu(key->u.k_offset_v1.k_offset) :\n\t    offset_v2_k_offset(&(key->u.k_offset_v2));\n}"
        }
      },
      {
        "call_info": {
          "callee": "le_key_version",
          "args": [
            "key"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "le_key_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "2980-2991",
          "snippet": "static inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [
            "#define TYPE_DIRENTRY 3",
            "#define TYPE_DIRECT 2",
            "#define TYPE_INDIRECT 1",
            "#define KEY_FORMAT_3_6 1",
            "#define KEY_FORMAT_3_5 0"
          ],
          "globals_used": [
            "extern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);",
            "extern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\n#define TYPE_DIRENTRY 3\n#define TYPE_DIRECT 2\n#define TYPE_INDIRECT 1\n#define KEY_FORMAT_3_6 1\n#define KEY_FORMAT_3_5 0\n\nextern int comp_le_keys(const struct reiserfs_key *,\n\t\t\tconst struct reiserfs_key *);\nextern int comp_short_le_keys(const struct reiserfs_key *,\n\t\t\t      const struct reiserfs_key *);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline int le_key_version(const struct reiserfs_key *key)\n{\n\tint type;\n\n\ttype = offset_v2_k_type(&(key->u.k_offset_v2));\n\tif (type != TYPE_DIRECT && type != TYPE_INDIRECT\n\t    && type != TYPE_DIRENTRY)\n\t\treturn KEY_FORMAT_3_5;\n\n\treturn KEY_FORMAT_3_6;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_is_left_mergeable(struct reiserfs_key *key,\n\t\t\t\t    unsigned long bsize)\n{\n\tint version = le_key_version(key);\n\treturn ((le_key_k_offset(version, key) & (bsize - 1)) != 1);\n}"
  },
  {
    "function_name": "direct_decrement_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "128-133",
    "snippet": "static void direct_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpu_key_k_type",
          "args": [
            "key",
            "TYPE_STAT_DATA"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1598-1601",
          "snippet": "static inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_key_k_offset",
          "args": [
            "key"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_key_k_offset_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1603-1606",
          "snippet": "static inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void cpu_key_k_offset_dec(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_offset--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void direct_decrement_key(struct cpu_key *key)\n{\n\tcpu_key_k_offset_dec(key);\n\tif (cpu_key_k_offset(key) == 0)\n\t\tset_cpu_key_k_type(key, TYPE_STAT_DATA);\n}"
  },
  {
    "function_name": "direct_bytes_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "122-125",
    "snippet": "static int direct_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn ih_item_len(ih);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ih_item_len",
          "args": [
            "ih"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int direct_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn ih_item_len(ih);\n}"
  },
  {
    "function_name": "sd_print_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "99-104",
    "snippet": "static void sd_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16100\",\n\t\t\t \"STATDATA, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reiserfs_warning",
          "args": [
            "NULL",
            "\"reiserfs-16100\"",
            "\"STATDATA, index %d, type 0x%x, %h\"",
            "vi->vi_index",
            "vi->vi_type",
            "vi->vi_ih"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "__reiserfs_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "266-277",
          "snippet": "void __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nvoid __reiserfs_warning(struct super_block *sb, const char *id,\n\t\t\t const char *function, const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tif (sb)\n\t\tprintk(KERN_WARNING \"REISERFS warning (device %s): %s%s%s: \"\n\t\t       \"%s\\n\", sb->s_id, id ? id : \"\", id ? \" \" : \"\",\n\t\t       function, error_buf);\n\telse\n\t\tprintk(KERN_WARNING \"REISERFS warning: %s%s%s: %s\\n\",\n\t\t       id ? id : \"\", id ? \" \" : \"\", function, error_buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void sd_print_vi(struct virtual_item *vi)\n{\n\treiserfs_warning(NULL, \"reiserfs-16100\",\n\t\t\t \"STATDATA, index %d, type 0x%x, %h\",\n\t\t\t vi->vi_index, vi->vi_type, vi->vi_ih);\n}"
  },
  {
    "function_name": "sd_unit_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "94-97",
    "snippet": "static int sd_unit_num(struct virtual_item *vi)\n{\n\treturn vi->vi_item_len - IH_SIZE;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_unit_num(struct virtual_item *vi)\n{\n\treturn vi->vi_item_len - IH_SIZE;\n}"
  },
  {
    "function_name": "sd_part_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "88-92",
    "snippet": "static int sd_part_size(struct virtual_item *vi, int first, int count)\n{\n\tBUG_ON(count);\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "count"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_part_size(struct virtual_item *vi, int first, int count)\n{\n\tBUG_ON(count);\n\treturn 0;\n}"
  },
  {
    "function_name": "sd_check_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "83-86",
    "snippet": "static int sd_check_right(struct virtual_item *vi, int free)\n{\n\treturn -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_check_right(struct virtual_item *vi, int free)\n{\n\treturn -1;\n}"
  },
  {
    "function_name": "sd_check_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "76-81",
    "snippet": "static int sd_check_left(struct virtual_item *vi, int free,\n\t\t\t int start_skip, int end_skip)\n{\n\tBUG_ON(start_skip || end_skip);\n\treturn -1;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "start_skip || end_skip"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_check_left(struct virtual_item *vi, int free,\n\t\t\t int start_skip, int end_skip)\n{\n\tBUG_ON(start_skip || end_skip);\n\treturn -1;\n}"
  },
  {
    "function_name": "sd_create_vi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "68-74",
    "snippet": "static int sd_create_vi(struct virtual_node *vn,\n\t\t\tstruct virtual_item *vi,\n\t\t\tint is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_STAT_DATA;\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_create_vi(struct virtual_node *vn,\n\t\t\tstruct virtual_item *vi,\n\t\t\tint is_affected, int insert_size)\n{\n\tvi->vi_index = TYPE_STAT_DATA;\n\treturn 0;\n}"
  },
  {
    "function_name": "sd_check_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "63-66",
    "snippet": "static void sd_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void sd_check_item(struct item_head *ih, char *item)\n{\n\t/* unused */\n}"
  },
  {
    "function_name": "sd_print_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "44-61",
    "snippet": "static void sd_print_item(struct item_head *ih, char *item)\n{\n\tprintk(\"\\tmode | size | nlinks | first direct | mtime\\n\");\n\tif (stat_data_v1(ih)) {\n\t\tstruct stat_data_v1 *sd = (struct stat_data_v1 *)item;\n\n\t\tprintk(\"\\t0%-6o | %6u | %2u | %d | %s\\n\", sd_v1_mode(sd),\n\t\t       sd_v1_size(sd), sd_v1_nlink(sd),\n\t\t       sd_v1_first_direct_byte(sd),\n\t\t       print_time(sd_v1_mtime(sd)));\n\t} else {\n\t\tstruct stat_data *sd = (struct stat_data *)item;\n\n\t\tprintk(\"\\t0%-6o | %6llu | %2u | %d | %s\\n\", sd_v2_mode(sd),\n\t\t       (unsigned long long)sd_v2_size(sd), sd_v2_nlink(sd),\n\t\t       sd_v2_rdev(sd), print_time(sd_v2_mtime(sd)));\n\t}\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"\\t0%-6o | %6llu | %2u | %d | %s\\n\"",
            "sd_v2_mode(sd)",
            "(unsigned long long)sd_v2_size(sd)",
            "sd_v2_nlink(sd)",
            "sd_v2_rdev(sd)",
            "print_time(sd_v2_mtime(sd))"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/prints.c",
          "lines": "291-295",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_time",
          "args": [
            "sd_v2_mtime(sd)"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "print_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
          "lines": "36-42",
          "snippet": "static char *print_time(time_t t)\n{\n\tstatic char timebuf[256];\n\n\tsprintf(timebuf, \"%ld\", t);\n\treturn timebuf;\n}",
          "includes": [
            "#include \"reiserfs.h\"",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic char *print_time(time_t t)\n{\n\tstatic char timebuf[256];\n\n\tsprintf(timebuf, \"%ld\", t);\n\treturn timebuf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sd_v2_mtime",
          "args": [
            "sd"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v2_rdev",
          "args": [
            "sd"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v2_nlink",
          "args": [
            "sd"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v2_size",
          "args": [
            "sd"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v2_mode",
          "args": [
            "sd"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v1_mtime",
          "args": [
            "sd"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v1_first_direct_byte",
          "args": [
            "sd"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v1_nlink",
          "args": [
            "sd"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v1_size",
          "args": [
            "sd"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_v1_mode",
          "args": [
            "sd"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat_data_v1",
          "args": [
            "ih"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void sd_print_item(struct item_head *ih, char *item)\n{\n\tprintk(\"\\tmode | size | nlinks | first direct | mtime\\n\");\n\tif (stat_data_v1(ih)) {\n\t\tstruct stat_data_v1 *sd = (struct stat_data_v1 *)item;\n\n\t\tprintk(\"\\t0%-6o | %6u | %2u | %d | %s\\n\", sd_v1_mode(sd),\n\t\t       sd_v1_size(sd), sd_v1_nlink(sd),\n\t\t       sd_v1_first_direct_byte(sd),\n\t\t       print_time(sd_v1_mtime(sd)));\n\t} else {\n\t\tstruct stat_data *sd = (struct stat_data *)item;\n\n\t\tprintk(\"\\t0%-6o | %6llu | %2u | %d | %s\\n\", sd_v2_mode(sd),\n\t\t       (unsigned long long)sd_v2_size(sd), sd_v2_nlink(sd),\n\t\t       sd_v2_rdev(sd), print_time(sd_v2_mtime(sd)));\n\t}\n}"
  },
  {
    "function_name": "print_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "36-42",
    "snippet": "static char *print_time(time_t t)\n{\n\tstatic char timebuf[256];\n\n\tsprintf(timebuf, \"%ld\", t);\n\treturn timebuf;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "timebuf",
            "\"%ld\"",
            "t"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic char *print_time(time_t t)\n{\n\tstatic char timebuf[256];\n\n\tsprintf(timebuf, \"%ld\", t);\n\treturn timebuf;\n}"
  },
  {
    "function_name": "sd_is_left_mergeable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "31-34",
    "snippet": "static int sd_is_left_mergeable(struct reiserfs_key *key, unsigned long bsize)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_is_left_mergeable(struct reiserfs_key *key, unsigned long bsize)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "sd_decrement_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "24-29",
    "snippet": "static void sd_decrement_key(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_objectid--;\n\tset_cpu_key_k_type(key, TYPE_ANY);\n\tset_cpu_key_k_offset(key, (loff_t)(~0ULL >> 1));\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpu_key_k_offset",
          "args": [
            "key",
            "(loff_t)(~0ULL >> 1)"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpu_key_k_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1593-1596",
          "snippet": "static inline void set_cpu_key_k_offset(struct cpu_key *key, loff_t offset)\n{\n\tkey->on_disk_key.k_offset = offset;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);",
            "int direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);",
            "int indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\nint direct2indirect(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct treepath *, struct buffer_head *, loff_t);\nint indirect2direct(struct reiserfs_transaction_handle *, struct inode *,\n\t\t    struct page *, struct treepath *, const struct cpu_key *,\n\t\t    loff_t, char *);\n\nstatic inline void set_cpu_key_k_offset(struct cpu_key *key, loff_t offset)\n{\n\tkey->on_disk_key.k_offset = offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "~0ULL >> 1"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpu_key_k_type",
          "args": [
            "key",
            "TYPE_ANY"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpu_key_k_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/reiserfs.h",
          "lines": "1598-1601",
          "snippet": "static inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}",
          "includes": [
            "#include <linux/buffer_head.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/bitops.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/bug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/slab.h>",
            "#include <linux/reiserfs_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);",
            "void reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);",
            "struct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/buffer_head.h>\n#include <linux/proc_fs.h>\n#include <linux/bitops.h>\n#include <asm/unaligned.h>\n#include <linux/workqueue.h>\n#include <linux/bug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/slab.h>\n#include <linux/reiserfs_fs.h>\n\nextern int comp_short_keys(const struct reiserfs_key *le_key,\n\t\t\t   const struct cpu_key *cpu_key);\nvoid reiserfs_delete_solid_item(struct reiserfs_transaction_handle *th,\n\t\t\t\tstruct inode *inode, struct reiserfs_key *key);\nstruct inode *reiserfs_iget(struct super_block *s, const struct cpu_key *key);\n\nstatic inline void set_cpu_key_k_type(struct cpu_key *key, int type)\n{\n\tkey->on_disk_key.k_type = type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic void sd_decrement_key(struct cpu_key *key)\n{\n\tkey->on_disk_key.k_objectid--;\n\tset_cpu_key_k_type(key, TYPE_ANY);\n\tset_cpu_key_k_offset(key, (loff_t)(~0ULL >> 1));\n}"
  },
  {
    "function_name": "sd_bytes_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/reiserfs/item_ops.c",
    "lines": "19-22",
    "snippet": "static int sd_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"reiserfs.h\"",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"reiserfs.h\"\n#include <linux/time.h>\n\nstatic int sd_bytes_number(struct item_head *ih, int block_size)\n{\n\treturn 0;\n}"
  }
]