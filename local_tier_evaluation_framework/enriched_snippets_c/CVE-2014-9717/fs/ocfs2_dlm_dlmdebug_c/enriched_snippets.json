[
  {
    "function_name": "dlm_destroy_debugfs_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "996-999",
    "snippet": "void dlm_destroy_debugfs_root(void)\n{\n\tdebugfs_remove(dlm_debugfs_root);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "dlm_debugfs_root"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_destroy_debugfs_root(void)\n{\n\tdebugfs_remove(dlm_debugfs_root);\n}"
  },
  {
    "function_name": "dlm_create_debugfs_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "986-994",
    "snippet": "int dlm_create_debugfs_root(void)\n{\n\tdlm_debugfs_root = debugfs_create_dir(DLM_DEBUGFS_DIR, NULL);\n\tif (!dlm_debugfs_root) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define DLM_DEBUGFS_DIR\t\t\t\t\"o2dlm\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "DLM_DEBUGFS_DIR",
            "NULL"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DLM_DEBUGFS_DIR\t\t\t\t\"o2dlm\"\n\nint dlm_create_debugfs_root(void)\n{\n\tdlm_debugfs_root = debugfs_create_dir(DLM_DEBUGFS_DIR, NULL);\n\tif (!dlm_debugfs_root) {\n\t\tmlog_errno(-ENOMEM);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "dlm_destroy_debugfs_subroot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "980-983",
    "snippet": "void dlm_destroy_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdebugfs_remove(dlm->dlm_debugfs_subroot);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "dlm->dlm_debugfs_subroot"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_destroy_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdebugfs_remove(dlm->dlm_debugfs_subroot);\n}"
  },
  {
    "function_name": "dlm_create_debugfs_subroot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "957-978",
    "snippet": "int dlm_create_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdlm->dlm_debugfs_subroot = debugfs_create_dir(dlm->name,\n\t\t\t\t\t\t      dlm_debugfs_root);\n\tif (!dlm->dlm_debugfs_subroot) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\tdlm->dlm_debug_ctxt = kzalloc(sizeof(struct dlm_debug_ctxt),\n\t\t\t\t      GFP_KERNEL);\n\tif (!dlm->dlm_debug_ctxt) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\tkref_init(&dlm->dlm_debug_ctxt->debug_refcnt);\n\n\treturn 0;\nbail:\n\tdlm_destroy_debugfs_subroot(dlm);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_destroy_debugfs_subroot",
          "args": [
            "dlm"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_destroy_debugfs_subroot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "980-983",
          "snippet": "void dlm_destroy_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdebugfs_remove(dlm->dlm_debugfs_subroot);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_destroy_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdebugfs_remove(dlm->dlm_debugfs_subroot);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&dlm->dlm_debug_ctxt->debug_refcnt"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct dlm_debug_ctxt)",
            "GFP_KERNEL"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "dlm->name",
            "dlm_debugfs_root"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nint dlm_create_debugfs_subroot(struct dlm_ctxt *dlm)\n{\n\tdlm->dlm_debugfs_subroot = debugfs_create_dir(dlm->name,\n\t\t\t\t\t\t      dlm_debugfs_root);\n\tif (!dlm->dlm_debugfs_subroot) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\tdlm->dlm_debug_ctxt = kzalloc(sizeof(struct dlm_debug_ctxt),\n\t\t\t\t      GFP_KERNEL);\n\tif (!dlm->dlm_debug_ctxt) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\tkref_init(&dlm->dlm_debug_ctxt->debug_refcnt);\n\n\treturn 0;\nbail:\n\tdlm_destroy_debugfs_subroot(dlm);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "dlm_debug_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "943-954",
    "snippet": "void dlm_debug_shutdown(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\tif (dc) {\n\t\tdebugfs_remove(dc->debug_purgelist_dentry);\n\t\tdebugfs_remove(dc->debug_mle_dentry);\n\t\tdebugfs_remove(dc->debug_lockres_dentry);\n\t\tdebugfs_remove(dc->debug_state_dentry);\n\t\tdlm_debug_put(dc);\n\t}\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_debug_put",
          "args": [
            "dc"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_debug_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "359-363",
          "snippet": "static void dlm_debug_put(struct dlm_debug_ctxt *dc)\n{\n\tif (dc)\n\t\tkref_put(&dc->debug_refcnt, dlm_debug_free);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_debug_put(struct dlm_debug_ctxt *dc)\n{\n\tif (dc)\n\t\tkref_put(&dc->debug_refcnt, dlm_debug_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "dc->debug_state_dentry"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blockcheck_stats_debugfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/blockcheck.c",
          "lines": "318-321",
          "snippet": "void ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}",
          "includes": [
            "#include \"blockcheck.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <asm/byteorder.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/bitops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/crc32.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blockcheck.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <asm/byteorder.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n#include <linux/bitops.h>\n#include <linux/buffer_head.h>\n#include <linux/crc32.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n\nvoid ocfs2_blockcheck_stats_debugfs_remove(struct ocfs2_blockcheck_stats *stats)\n{\n\tocfs2_blockcheck_debug_remove(stats);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_debug_shutdown(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\tif (dc) {\n\t\tdebugfs_remove(dc->debug_purgelist_dentry);\n\t\tdebugfs_remove(dc->debug_mle_dentry);\n\t\tdebugfs_remove(dc->debug_lockres_dentry);\n\t\tdebugfs_remove(dc->debug_state_dentry);\n\t\tdlm_debug_put(dc);\n\t}\n}"
  },
  {
    "function_name": "dlm_debug_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "889-941",
    "snippet": "int dlm_debug_init(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\t/* for dumping dlm_ctxt */\n\tdc->debug_state_dentry = debugfs_create_file(DLM_DEBUGFS_DLM_STATE,\n\t\t\t\t\t\t     S_IFREG|S_IRUSR,\n\t\t\t\t\t\t     dlm->dlm_debugfs_subroot,\n\t\t\t\t\t\t     dlm, &debug_state_fops);\n\tif (!dc->debug_state_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping lockres */\n\tdc->debug_lockres_dentry =\n\t\t\tdebugfs_create_file(DLM_DEBUGFS_LOCKING_STATE,\n\t\t\t\t\t    S_IFREG|S_IRUSR,\n\t\t\t\t\t    dlm->dlm_debugfs_subroot,\n\t\t\t\t\t    dlm, &debug_lockres_fops);\n\tif (!dc->debug_lockres_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping mles */\n\tdc->debug_mle_dentry = debugfs_create_file(DLM_DEBUGFS_MLE_STATE,\n\t\t\t\t\t\t   S_IFREG|S_IRUSR,\n\t\t\t\t\t\t   dlm->dlm_debugfs_subroot,\n\t\t\t\t\t\t   dlm, &debug_mle_fops);\n\tif (!dc->debug_mle_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping lockres on the purge list */\n\tdc->debug_purgelist_dentry =\n\t\t\tdebugfs_create_file(DLM_DEBUGFS_PURGE_LIST,\n\t\t\t\t\t    S_IFREG|S_IRUSR,\n\t\t\t\t\t    dlm->dlm_debugfs_subroot,\n\t\t\t\t\t    dlm, &debug_purgelist_fops);\n\tif (!dc->debug_purgelist_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\tdlm_debug_get(dc);\n\treturn 0;\n\nbail:\n\tdlm_debug_shutdown(dlm);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define DLM_DEBUGFS_PURGE_LIST\t\t\t\"purge_list\"",
      "#define DLM_DEBUGFS_MLE_STATE\t\t\t\"mle_state\"",
      "#define DLM_DEBUGFS_LOCKING_STATE\t\t\"locking_state\"",
      "#define DLM_DEBUGFS_DLM_STATE\t\t\t\"dlm_state\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_debug_shutdown",
          "args": [
            "dlm"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_debug_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "943-954",
          "snippet": "void dlm_debug_shutdown(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\tif (dc) {\n\t\tdebugfs_remove(dc->debug_purgelist_dentry);\n\t\tdebugfs_remove(dc->debug_mle_dentry);\n\t\tdebugfs_remove(dc->debug_lockres_dentry);\n\t\tdebugfs_remove(dc->debug_state_dentry);\n\t\tdlm_debug_put(dc);\n\t}\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_debug_shutdown(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\tif (dc) {\n\t\tdebugfs_remove(dc->debug_purgelist_dentry);\n\t\tdebugfs_remove(dc->debug_mle_dentry);\n\t\tdebugfs_remove(dc->debug_lockres_dentry);\n\t\tdebugfs_remove(dc->debug_state_dentry);\n\t\tdlm_debug_put(dc);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_debug_get",
          "args": [
            "dc"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_debug_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "365-368",
          "snippet": "static void dlm_debug_get(struct dlm_debug_ctxt *dc)\n{\n\tkref_get(&dc->debug_refcnt);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_debug_get(struct dlm_debug_ctxt *dc)\n{\n\tkref_get(&dc->debug_refcnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "DLM_DEBUGFS_PURGE_LIST",
            "S_IFREG|S_IRUSR",
            "dlm->dlm_debugfs_subroot",
            "dlm",
            "&debug_purgelist_fops"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "321-346",
          "snippet": "struct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_file(const char *name, umode_t mode,\n\t\t\t\t   struct dentry *parent, void *data,\n\t\t\t\t   const struct file_operations *fops)\n{\n\tstruct dentry *dentry;\n\tstruct inode *inode;\n\n\tif (!(mode & S_IFMT))\n\t\tmode |= S_IFREG;\n\tBUG_ON(!S_ISREG(mode));\n\tdentry = start_creating(name, parent);\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = mode;\n\tinode->i_fop = fops ? fops : &debugfs_file_operations;\n\tinode->i_private = data;\n\td_instantiate(dentry, inode);\n\tfsnotify_create(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DLM_DEBUGFS_PURGE_LIST\t\t\t\"purge_list\"\n#define DLM_DEBUGFS_MLE_STATE\t\t\t\"mle_state\"\n#define DLM_DEBUGFS_LOCKING_STATE\t\t\"locking_state\"\n#define DLM_DEBUGFS_DLM_STATE\t\t\t\"dlm_state\"\n\nint dlm_debug_init(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_debug_ctxt *dc = dlm->dlm_debug_ctxt;\n\n\t/* for dumping dlm_ctxt */\n\tdc->debug_state_dentry = debugfs_create_file(DLM_DEBUGFS_DLM_STATE,\n\t\t\t\t\t\t     S_IFREG|S_IRUSR,\n\t\t\t\t\t\t     dlm->dlm_debugfs_subroot,\n\t\t\t\t\t\t     dlm, &debug_state_fops);\n\tif (!dc->debug_state_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping lockres */\n\tdc->debug_lockres_dentry =\n\t\t\tdebugfs_create_file(DLM_DEBUGFS_LOCKING_STATE,\n\t\t\t\t\t    S_IFREG|S_IRUSR,\n\t\t\t\t\t    dlm->dlm_debugfs_subroot,\n\t\t\t\t\t    dlm, &debug_lockres_fops);\n\tif (!dc->debug_lockres_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping mles */\n\tdc->debug_mle_dentry = debugfs_create_file(DLM_DEBUGFS_MLE_STATE,\n\t\t\t\t\t\t   S_IFREG|S_IRUSR,\n\t\t\t\t\t\t   dlm->dlm_debugfs_subroot,\n\t\t\t\t\t\t   dlm, &debug_mle_fops);\n\tif (!dc->debug_mle_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\t/* for dumping lockres on the purge list */\n\tdc->debug_purgelist_dentry =\n\t\t\tdebugfs_create_file(DLM_DEBUGFS_PURGE_LIST,\n\t\t\t\t\t    S_IFREG|S_IRUSR,\n\t\t\t\t\t    dlm->dlm_debugfs_subroot,\n\t\t\t\t\t    dlm, &debug_purgelist_fops);\n\tif (!dc->debug_purgelist_dentry) {\n\t\tmlog_errno(-ENOMEM);\n\t\tgoto bail;\n\t}\n\n\tdlm_debug_get(dc);\n\treturn 0;\n\nbail:\n\tdlm_debug_shutdown(dlm);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "debug_state_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "862-878",
    "snippet": "static int debug_state_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_state_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "debug_state_print(dlm, buf, PAGE_SIZE - 1)"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_state_print",
          "args": [
            "dlm",
            "buf",
            "PAGE_SIZE - 1"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "debug_state_print",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "697-860",
          "snippet": "static int debug_state_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tint out = 0;\n\tstruct dlm_reco_node_data *node;\n\tchar *state;\n\tint cur_mles = 0, tot_mles = 0;\n\tint i;\n\n\tspin_lock(&dlm->spinlock);\n\n\tswitch (dlm->dlm_state) {\n\tcase DLM_CTXT_NEW:\n\t\tstate = \"NEW\"; break;\n\tcase DLM_CTXT_JOINED:\n\t\tstate = \"JOINED\"; break;\n\tcase DLM_CTXT_IN_SHUTDOWN:\n\t\tstate = \"SHUTDOWN\"; break;\n\tcase DLM_CTXT_LEAVING:\n\t\tstate = \"LEAVING\"; break;\n\tdefault:\n\t\tstate = \"UNKNOWN\"; break;\n\t}\n\n\t/* Domain: xxxxxxxxxx  Key: 0xdfbac769 */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Domain: %s  Key: 0x%08x  Protocol: %d.%d\\n\",\n\t\t\tdlm->name, dlm->key, dlm->dlm_locking_proto.pv_major,\n\t\t\tdlm->dlm_locking_proto.pv_minor);\n\n\t/* Thread Pid: xxx  Node: xxx  State: xxxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Thread Pid: %d  Node: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_thread_task), dlm->node_num, state);\n\n\t/* Number of Joins: xxx  Joining Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Number of Joins: %d  Joining Node: %d\\n\",\n\t\t\tdlm->num_joins, dlm->joining_node);\n\n\t/* Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Domain Map: \");\n\tout += stringify_nodemap(dlm->domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Exit Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Exit Domain Map: \");\n\tout += stringify_nodemap(dlm->exit_domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Live Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Live Map: \");\n\tout += stringify_nodemap(dlm->live_nodes_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Lock Resources: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lock Resources: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->res_cur_count),\n\t\t\tatomic_read(&dlm->res_tot_count));\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\ttot_mles += atomic_read(&dlm->mle_tot_count[i]);\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\tcur_mles += atomic_read(&dlm->mle_cur_count[i]);\n\n\t/* MLEs: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"MLEs: %d (%d)\\n\", cur_mles, tot_mles);\n\n\t/*  Blocking: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Blocking: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_BLOCK]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_BLOCK]));\n\n\t/*  Mastery: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Mastery: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MASTER]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MASTER]));\n\n\t/*  Migration: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Migration: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MIGRATION]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MIGRATION]));\n\n\t/* Lists: Dirty=Empty  Purge=InUse  PendingASTs=Empty  ... */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lists: Dirty=%s  Purge=%s  PendingASTs=%s  \"\n\t\t\t\"PendingBASTs=%s\\n\",\n\t\t\t(list_empty(&dlm->dirty_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->purge_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_asts) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_basts) ? \"Empty\" : \"InUse\"));\n\n\t/* Purge Count: xxx  Refs: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Purge Count: %d  Refs: %d\\n\", dlm->purge_count,\n\t\t\tatomic_read(&dlm->dlm_refs.refcount));\n\n\t/* Dead Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dead Node: %d\\n\", dlm->reco.dead_node);\n\n\t/* What about DLM_RECO_STATE_FINALIZE? */\n\tif (dlm->reco.state == DLM_RECO_STATE_ACTIVE)\n\t\tstate = \"ACTIVE\";\n\telse\n\t\tstate = \"INACTIVE\";\n\n\t/* Recovery Pid: xxxx  Master: xxx  State: xxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Recovery Pid: %d  Master: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_reco_thread_task),\n\t\t\tdlm->reco.new_master, state);\n\n\t/* Recovery Map: xx xx */\n\tout += snprintf(buf + out, len - out, \"Recovery Map: \");\n\tout += stringify_nodemap(dlm->recovery_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Recovery Node State: */\n\tout += snprintf(buf + out, len - out, \"Recovery Node State:\\n\");\n\tlist_for_each_entry(node, &dlm->reco.node_data, list) {\n\t\tswitch (node->state) {\n\t\tcase DLM_RECO_NODE_DATA_INIT:\n\t\t\tstate = \"INIT\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTING:\n\t\t\tstate = \"REQUESTING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DEAD:\n\t\t\tstate = \"DEAD\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_RECEIVING:\n\t\t\tstate = \"RECEIVING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTED:\n\t\t\tstate = \"REQUESTED\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DONE:\n\t\t\tstate = \"DONE\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_FINALIZE_SENT:\n\t\t\tstate = \"FINALIZE-SENT\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstate = \"BAD\";\n\t\t\tbreak;\n\t\t}\n\t\tout += snprintf(buf + out, len - out, \"\\t%u - %s\\n\",\n\t\t\t\tnode->node_num, state);\n\t}\n\n\tspin_unlock(&dlm->spinlock);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_state_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tint out = 0;\n\tstruct dlm_reco_node_data *node;\n\tchar *state;\n\tint cur_mles = 0, tot_mles = 0;\n\tint i;\n\n\tspin_lock(&dlm->spinlock);\n\n\tswitch (dlm->dlm_state) {\n\tcase DLM_CTXT_NEW:\n\t\tstate = \"NEW\"; break;\n\tcase DLM_CTXT_JOINED:\n\t\tstate = \"JOINED\"; break;\n\tcase DLM_CTXT_IN_SHUTDOWN:\n\t\tstate = \"SHUTDOWN\"; break;\n\tcase DLM_CTXT_LEAVING:\n\t\tstate = \"LEAVING\"; break;\n\tdefault:\n\t\tstate = \"UNKNOWN\"; break;\n\t}\n\n\t/* Domain: xxxxxxxxxx  Key: 0xdfbac769 */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Domain: %s  Key: 0x%08x  Protocol: %d.%d\\n\",\n\t\t\tdlm->name, dlm->key, dlm->dlm_locking_proto.pv_major,\n\t\t\tdlm->dlm_locking_proto.pv_minor);\n\n\t/* Thread Pid: xxx  Node: xxx  State: xxxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Thread Pid: %d  Node: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_thread_task), dlm->node_num, state);\n\n\t/* Number of Joins: xxx  Joining Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Number of Joins: %d  Joining Node: %d\\n\",\n\t\t\tdlm->num_joins, dlm->joining_node);\n\n\t/* Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Domain Map: \");\n\tout += stringify_nodemap(dlm->domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Exit Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Exit Domain Map: \");\n\tout += stringify_nodemap(dlm->exit_domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Live Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Live Map: \");\n\tout += stringify_nodemap(dlm->live_nodes_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Lock Resources: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lock Resources: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->res_cur_count),\n\t\t\tatomic_read(&dlm->res_tot_count));\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\ttot_mles += atomic_read(&dlm->mle_tot_count[i]);\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\tcur_mles += atomic_read(&dlm->mle_cur_count[i]);\n\n\t/* MLEs: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"MLEs: %d (%d)\\n\", cur_mles, tot_mles);\n\n\t/*  Blocking: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Blocking: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_BLOCK]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_BLOCK]));\n\n\t/*  Mastery: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Mastery: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MASTER]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MASTER]));\n\n\t/*  Migration: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Migration: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MIGRATION]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MIGRATION]));\n\n\t/* Lists: Dirty=Empty  Purge=InUse  PendingASTs=Empty  ... */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lists: Dirty=%s  Purge=%s  PendingASTs=%s  \"\n\t\t\t\"PendingBASTs=%s\\n\",\n\t\t\t(list_empty(&dlm->dirty_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->purge_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_asts) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_basts) ? \"Empty\" : \"InUse\"));\n\n\t/* Purge Count: xxx  Refs: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Purge Count: %d  Refs: %d\\n\", dlm->purge_count,\n\t\t\tatomic_read(&dlm->dlm_refs.refcount));\n\n\t/* Dead Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dead Node: %d\\n\", dlm->reco.dead_node);\n\n\t/* What about DLM_RECO_STATE_FINALIZE? */\n\tif (dlm->reco.state == DLM_RECO_STATE_ACTIVE)\n\t\tstate = \"ACTIVE\";\n\telse\n\t\tstate = \"INACTIVE\";\n\n\t/* Recovery Pid: xxxx  Master: xxx  State: xxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Recovery Pid: %d  Master: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_reco_thread_task),\n\t\t\tdlm->reco.new_master, state);\n\n\t/* Recovery Map: xx xx */\n\tout += snprintf(buf + out, len - out, \"Recovery Map: \");\n\tout += stringify_nodemap(dlm->recovery_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Recovery Node State: */\n\tout += snprintf(buf + out, len - out, \"Recovery Node State:\\n\");\n\tlist_for_each_entry(node, &dlm->reco.node_data, list) {\n\t\tswitch (node->state) {\n\t\tcase DLM_RECO_NODE_DATA_INIT:\n\t\t\tstate = \"INIT\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTING:\n\t\t\tstate = \"REQUESTING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DEAD:\n\t\t\tstate = \"DEAD\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_RECEIVING:\n\t\t\tstate = \"RECEIVING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTED:\n\t\t\tstate = \"REQUESTED\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DONE:\n\t\t\tstate = \"DONE\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_FINALIZE_SENT:\n\t\t\tstate = \"FINALIZE-SENT\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstate = \"BAD\";\n\t\t\tbreak;\n\t\t}\n\t\tout += snprintf(buf + out, len - out, \"\\t%u - %s\\n\",\n\t\t\t\tnode->node_num, state);\n\t}\n\n\tspin_unlock(&dlm->spinlock);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_NOFS"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_state_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_state_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "debug_state_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "697-860",
    "snippet": "static int debug_state_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tint out = 0;\n\tstruct dlm_reco_node_data *node;\n\tchar *state;\n\tint cur_mles = 0, tot_mles = 0;\n\tint i;\n\n\tspin_lock(&dlm->spinlock);\n\n\tswitch (dlm->dlm_state) {\n\tcase DLM_CTXT_NEW:\n\t\tstate = \"NEW\"; break;\n\tcase DLM_CTXT_JOINED:\n\t\tstate = \"JOINED\"; break;\n\tcase DLM_CTXT_IN_SHUTDOWN:\n\t\tstate = \"SHUTDOWN\"; break;\n\tcase DLM_CTXT_LEAVING:\n\t\tstate = \"LEAVING\"; break;\n\tdefault:\n\t\tstate = \"UNKNOWN\"; break;\n\t}\n\n\t/* Domain: xxxxxxxxxx  Key: 0xdfbac769 */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Domain: %s  Key: 0x%08x  Protocol: %d.%d\\n\",\n\t\t\tdlm->name, dlm->key, dlm->dlm_locking_proto.pv_major,\n\t\t\tdlm->dlm_locking_proto.pv_minor);\n\n\t/* Thread Pid: xxx  Node: xxx  State: xxxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Thread Pid: %d  Node: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_thread_task), dlm->node_num, state);\n\n\t/* Number of Joins: xxx  Joining Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Number of Joins: %d  Joining Node: %d\\n\",\n\t\t\tdlm->num_joins, dlm->joining_node);\n\n\t/* Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Domain Map: \");\n\tout += stringify_nodemap(dlm->domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Exit Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Exit Domain Map: \");\n\tout += stringify_nodemap(dlm->exit_domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Live Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Live Map: \");\n\tout += stringify_nodemap(dlm->live_nodes_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Lock Resources: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lock Resources: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->res_cur_count),\n\t\t\tatomic_read(&dlm->res_tot_count));\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\ttot_mles += atomic_read(&dlm->mle_tot_count[i]);\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\tcur_mles += atomic_read(&dlm->mle_cur_count[i]);\n\n\t/* MLEs: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"MLEs: %d (%d)\\n\", cur_mles, tot_mles);\n\n\t/*  Blocking: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Blocking: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_BLOCK]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_BLOCK]));\n\n\t/*  Mastery: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Mastery: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MASTER]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MASTER]));\n\n\t/*  Migration: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Migration: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MIGRATION]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MIGRATION]));\n\n\t/* Lists: Dirty=Empty  Purge=InUse  PendingASTs=Empty  ... */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lists: Dirty=%s  Purge=%s  PendingASTs=%s  \"\n\t\t\t\"PendingBASTs=%s\\n\",\n\t\t\t(list_empty(&dlm->dirty_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->purge_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_asts) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_basts) ? \"Empty\" : \"InUse\"));\n\n\t/* Purge Count: xxx  Refs: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Purge Count: %d  Refs: %d\\n\", dlm->purge_count,\n\t\t\tatomic_read(&dlm->dlm_refs.refcount));\n\n\t/* Dead Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dead Node: %d\\n\", dlm->reco.dead_node);\n\n\t/* What about DLM_RECO_STATE_FINALIZE? */\n\tif (dlm->reco.state == DLM_RECO_STATE_ACTIVE)\n\t\tstate = \"ACTIVE\";\n\telse\n\t\tstate = \"INACTIVE\";\n\n\t/* Recovery Pid: xxxx  Master: xxx  State: xxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Recovery Pid: %d  Master: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_reco_thread_task),\n\t\t\tdlm->reco.new_master, state);\n\n\t/* Recovery Map: xx xx */\n\tout += snprintf(buf + out, len - out, \"Recovery Map: \");\n\tout += stringify_nodemap(dlm->recovery_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Recovery Node State: */\n\tout += snprintf(buf + out, len - out, \"Recovery Node State:\\n\");\n\tlist_for_each_entry(node, &dlm->reco.node_data, list) {\n\t\tswitch (node->state) {\n\t\tcase DLM_RECO_NODE_DATA_INIT:\n\t\t\tstate = \"INIT\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTING:\n\t\t\tstate = \"REQUESTING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DEAD:\n\t\t\tstate = \"DEAD\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_RECEIVING:\n\t\t\tstate = \"RECEIVING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTED:\n\t\t\tstate = \"REQUESTED\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DONE:\n\t\t\tstate = \"DONE\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_FINALIZE_SENT:\n\t\t\tstate = \"FINALIZE-SENT\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstate = \"BAD\";\n\t\t\tbreak;\n\t\t}\n\t\tout += snprintf(buf + out, len - out, \"\\t%u - %s\\n\",\n\t\t\t\tnode->node_num, state);\n\t}\n\n\tspin_unlock(&dlm->spinlock);\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dlm->spinlock"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\t%u - %s\\n\"",
            "node->node_num",
            "state"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "node",
            "&dlm->reco.node_data",
            "list"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Recovery Node State:\\n\""
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_nodemap",
          "args": [
            "dlm->recovery_map",
            "O2NM_MAX_NODES",
            "buf + out",
            "len - out"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_nodemap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "271-281",
          "snippet": "static int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Recovery Map: \""
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Recovery Pid: %d  Master: %d  State: %s\\n\"",
            "task_pid_nr(dlm->dlm_reco_thread_task)",
            "dlm->reco.new_master",
            "state"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "dlm->dlm_reco_thread_task"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Dead Node: %d\\n\"",
            "dlm->reco.dead_node"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Purge Count: %d  Refs: %d\\n\"",
            "dlm->purge_count",
            "atomic_read(&dlm->dlm_refs.refcount)"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->dlm_refs.refcount"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Lists: Dirty=%s  Purge=%s  PendingASTs=%s  \"\n\t\t\t\"PendingBASTs=%s\\n\"",
            "(list_empty(&dlm->dirty_list) ? \"Empty\" : \"InUse\")",
            "(list_empty(&dlm->purge_list) ? \"Empty\" : \"InUse\")",
            "(list_empty(&dlm->pending_asts) ? \"Empty\" : \"InUse\")",
            "(list_empty(&dlm->pending_basts) ? \"Empty\" : \"InUse\")"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&dlm->pending_basts"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"  Migration: %d (%d)\\n\"",
            "atomic_read(&dlm->mle_cur_count[DLM_MLE_MIGRATION])",
            "atomic_read(&dlm->mle_tot_count[DLM_MLE_MIGRATION])"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_tot_count[DLM_MLE_MIGRATION]"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_cur_count[DLM_MLE_MIGRATION]"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"  Mastery: %d (%d)\\n\"",
            "atomic_read(&dlm->mle_cur_count[DLM_MLE_MASTER])",
            "atomic_read(&dlm->mle_tot_count[DLM_MLE_MASTER])"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_tot_count[DLM_MLE_MASTER]"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_cur_count[DLM_MLE_MASTER]"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"  Blocking: %d (%d)\\n\"",
            "atomic_read(&dlm->mle_cur_count[DLM_MLE_BLOCK])",
            "atomic_read(&dlm->mle_tot_count[DLM_MLE_BLOCK])"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_tot_count[DLM_MLE_BLOCK]"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_cur_count[DLM_MLE_BLOCK]"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"MLEs: %d (%d)\\n\"",
            "cur_mles",
            "tot_mles"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_cur_count[i]"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->mle_tot_count[i]"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Lock Resources: %d (%d)\\n\"",
            "atomic_read(&dlm->res_cur_count)",
            "atomic_read(&dlm->res_tot_count)"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->res_tot_count"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dlm->res_cur_count"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Live Map: \""
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Exit Domain Map: \""
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Domain Map: \""
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Number of Joins: %d  Joining Node: %d\\n\"",
            "dlm->num_joins",
            "dlm->joining_node"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Thread Pid: %d  Node: %d  State: %s\\n\"",
            "task_pid_nr(dlm->dlm_thread_task)",
            "dlm->node_num",
            "state"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "dlm->dlm_thread_task"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Domain: %s  Key: 0x%08x  Protocol: %d.%d\\n\"",
            "dlm->name",
            "dlm->key",
            "dlm->dlm_locking_proto.pv_major",
            "dlm->dlm_locking_proto.pv_minor"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dlm->spinlock"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_state_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tint out = 0;\n\tstruct dlm_reco_node_data *node;\n\tchar *state;\n\tint cur_mles = 0, tot_mles = 0;\n\tint i;\n\n\tspin_lock(&dlm->spinlock);\n\n\tswitch (dlm->dlm_state) {\n\tcase DLM_CTXT_NEW:\n\t\tstate = \"NEW\"; break;\n\tcase DLM_CTXT_JOINED:\n\t\tstate = \"JOINED\"; break;\n\tcase DLM_CTXT_IN_SHUTDOWN:\n\t\tstate = \"SHUTDOWN\"; break;\n\tcase DLM_CTXT_LEAVING:\n\t\tstate = \"LEAVING\"; break;\n\tdefault:\n\t\tstate = \"UNKNOWN\"; break;\n\t}\n\n\t/* Domain: xxxxxxxxxx  Key: 0xdfbac769 */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Domain: %s  Key: 0x%08x  Protocol: %d.%d\\n\",\n\t\t\tdlm->name, dlm->key, dlm->dlm_locking_proto.pv_major,\n\t\t\tdlm->dlm_locking_proto.pv_minor);\n\n\t/* Thread Pid: xxx  Node: xxx  State: xxxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Thread Pid: %d  Node: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_thread_task), dlm->node_num, state);\n\n\t/* Number of Joins: xxx  Joining Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Number of Joins: %d  Joining Node: %d\\n\",\n\t\t\tdlm->num_joins, dlm->joining_node);\n\n\t/* Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Domain Map: \");\n\tout += stringify_nodemap(dlm->domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Exit Domain Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Exit Domain Map: \");\n\tout += stringify_nodemap(dlm->exit_domain_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Live Map: xx xx xx */\n\tout += snprintf(buf + out, len - out, \"Live Map: \");\n\tout += stringify_nodemap(dlm->live_nodes_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Lock Resources: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lock Resources: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->res_cur_count),\n\t\t\tatomic_read(&dlm->res_tot_count));\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\ttot_mles += atomic_read(&dlm->mle_tot_count[i]);\n\n\tfor (i = 0; i < DLM_MLE_NUM_TYPES; ++i)\n\t\tcur_mles += atomic_read(&dlm->mle_cur_count[i]);\n\n\t/* MLEs: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"MLEs: %d (%d)\\n\", cur_mles, tot_mles);\n\n\t/*  Blocking: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Blocking: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_BLOCK]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_BLOCK]));\n\n\t/*  Mastery: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Mastery: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MASTER]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MASTER]));\n\n\t/*  Migration: xxx (xxx) */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"  Migration: %d (%d)\\n\",\n\t\t\tatomic_read(&dlm->mle_cur_count[DLM_MLE_MIGRATION]),\n\t\t\tatomic_read(&dlm->mle_tot_count[DLM_MLE_MIGRATION]));\n\n\t/* Lists: Dirty=Empty  Purge=InUse  PendingASTs=Empty  ... */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Lists: Dirty=%s  Purge=%s  PendingASTs=%s  \"\n\t\t\t\"PendingBASTs=%s\\n\",\n\t\t\t(list_empty(&dlm->dirty_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->purge_list) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_asts) ? \"Empty\" : \"InUse\"),\n\t\t\t(list_empty(&dlm->pending_basts) ? \"Empty\" : \"InUse\"));\n\n\t/* Purge Count: xxx  Refs: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Purge Count: %d  Refs: %d\\n\", dlm->purge_count,\n\t\t\tatomic_read(&dlm->dlm_refs.refcount));\n\n\t/* Dead Node: xxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dead Node: %d\\n\", dlm->reco.dead_node);\n\n\t/* What about DLM_RECO_STATE_FINALIZE? */\n\tif (dlm->reco.state == DLM_RECO_STATE_ACTIVE)\n\t\tstate = \"ACTIVE\";\n\telse\n\t\tstate = \"INACTIVE\";\n\n\t/* Recovery Pid: xxxx  Master: xxx  State: xxxx */\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Recovery Pid: %d  Master: %d  State: %s\\n\",\n\t\t\ttask_pid_nr(dlm->dlm_reco_thread_task),\n\t\t\tdlm->reco.new_master, state);\n\n\t/* Recovery Map: xx xx */\n\tout += snprintf(buf + out, len - out, \"Recovery Map: \");\n\tout += stringify_nodemap(dlm->recovery_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* Recovery Node State: */\n\tout += snprintf(buf + out, len - out, \"Recovery Node State:\\n\");\n\tlist_for_each_entry(node, &dlm->reco.node_data, list) {\n\t\tswitch (node->state) {\n\t\tcase DLM_RECO_NODE_DATA_INIT:\n\t\t\tstate = \"INIT\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTING:\n\t\t\tstate = \"REQUESTING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DEAD:\n\t\t\tstate = \"DEAD\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_RECEIVING:\n\t\t\tstate = \"RECEIVING\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_REQUESTED:\n\t\t\tstate = \"REQUESTED\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_DONE:\n\t\t\tstate = \"DONE\";\n\t\t\tbreak;\n\t\tcase DLM_RECO_NODE_DATA_FINALIZE_SENT:\n\t\t\tstate = \"FINALIZE-SENT\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tstate = \"BAD\";\n\t\t\tbreak;\n\t\t}\n\t\tout += snprintf(buf + out, len - out, \"\\t%u - %s\\n\",\n\t\t\t\tnode->node_num, state);\n\t}\n\n\tspin_unlock(&dlm->spinlock);\n\n\treturn out;\n}"
  },
  {
    "function_name": "debug_lockres_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "676-686",
    "snippet": "static int debug_lockres_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct debug_lockres *dl = (struct debug_lockres *)seq->private;\n\n\tif (dl->dl_res)\n\t\tdlm_lockres_put(dl->dl_res);\n\tdlm_put(dl->dl_ctxt);\n\tkfree(dl->dl_buf);\n\treturn seq_release_private(inode, file);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_release_private",
          "args": [
            "inode",
            "file"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "seq_release_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "605-612",
          "snippet": "int seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_release_private(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\n\tkfree(seq->private);\n\tseq->private = NULL;\n\treturn seq_release(inode, file);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dl->dl_buf"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_put",
          "args": [
            "dl->dl_ctxt"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_put_mle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmmaster.c",
          "lines": "248-258",
          "snippet": "static void dlm_put_mle(struct dlm_master_list_entry *mle)\n{\n\tstruct dlm_ctxt *dlm;\n\tdlm = mle->dlm;\n\n\tspin_lock(&dlm->spinlock);\n\tspin_lock(&dlm->master_lock);\n\t__dlm_put_mle(mle);\n\tspin_unlock(&dlm->master_lock);\n\tspin_unlock(&dlm->spinlock);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_put_mle(struct dlm_master_list_entry *mle);",
            "static void __dlm_put_mle(struct dlm_master_list_entry *mle);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/spinlock.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_put_mle(struct dlm_master_list_entry *mle);\nstatic void __dlm_put_mle(struct dlm_master_list_entry *mle);\n\nstatic void dlm_put_mle(struct dlm_master_list_entry *mle)\n{\n\tstruct dlm_ctxt *dlm;\n\tdlm = mle->dlm;\n\n\tspin_lock(&dlm->spinlock);\n\tspin_lock(&dlm->master_lock);\n\t__dlm_put_mle(mle);\n\tspin_unlock(&dlm->master_lock);\n\tspin_unlock(&dlm->spinlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockres_put",
          "args": [
            "dl->dl_res"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockres_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmmaster.c",
          "lines": "550-553",
          "snippet": "void dlm_lockres_put(struct dlm_lock_resource *res)\n{\n\tkref_put(&res->refs, dlm_lockres_release);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 dlm_pick_migration_target(struct dlm_ctxt *dlm,\n\t\t\t\t    struct dlm_lock_resource *res);",
            "static void dlm_remove_nonlocal_locks(struct dlm_ctxt *dlm,\n\t\t\t\t      struct dlm_lock_resource *res);",
            "static int dlm_pre_master_reco_lockres(struct dlm_ctxt *dlm,\n\t\t\t\t       struct dlm_lock_resource *res);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/spinlock.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic u8 dlm_pick_migration_target(struct dlm_ctxt *dlm,\n\t\t\t\t    struct dlm_lock_resource *res);\nstatic void dlm_remove_nonlocal_locks(struct dlm_ctxt *dlm,\n\t\t\t\t      struct dlm_lock_resource *res);\nstatic int dlm_pre_master_reco_lockres(struct dlm_ctxt *dlm,\n\t\t\t\t       struct dlm_lock_resource *res);\n\nvoid dlm_lockres_put(struct dlm_lock_resource *res)\n{\n\tkref_put(&res->refs, dlm_lockres_release);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_lockres_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *seq = file->private_data;\n\tstruct debug_lockres *dl = (struct debug_lockres *)seq->private;\n\n\tif (dl->dl_res)\n\t\tdlm_lockres_put(dl->dl_res);\n\tdlm_put(dl->dl_ctxt);\n\tkfree(dl->dl_buf);\n\treturn seq_release_private(inode, file);\n}"
  },
  {
    "function_name": "debug_lockres_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "647-674",
    "snippet": "static int debug_lockres_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tstruct debug_lockres *dl;\n\tvoid *buf;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\tgoto bail;\n\n\tdl = __seq_open_private(file, &debug_lockres_ops, sizeof(*dl));\n\tif (!dl)\n\t\tgoto bailfree;\n\n\tdl->dl_len = PAGE_SIZE;\n\tdl->dl_buf = buf;\n\n\tdlm_grab(dlm);\n\tdl->dl_ctxt = dlm;\n\n\treturn 0;\n\nbailfree:\n\tkfree(buf);\nbail:\n\tmlog_errno(-ENOMEM);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mlog_errno",
          "args": [
            "-ENOMEM"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_grab",
          "args": [
            "dlm"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_grab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdomain.c",
          "lines": "360-378",
          "snippet": "struct dlm_ctxt *dlm_grab(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_ctxt *target;\n\tstruct dlm_ctxt *ret = NULL;\n\n\tspin_lock(&dlm_domain_lock);\n\n\tlist_for_each_entry(target, &dlm_domains, list) {\n\t\tif (target == dlm) {\n\t\t\t__dlm_get(target);\n\t\t\tret = target;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tspin_unlock(&dlm_domain_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/err.h>",
            "#include <linux/delay.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_unregister_domain_handlers(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/debugfs.h>\n#include <linux/err.h>\n#include <linux/delay.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/module.h>\n\nstatic void dlm_unregister_domain_handlers(struct dlm_ctxt *dlm);\n\nstruct dlm_ctxt *dlm_grab(struct dlm_ctxt *dlm)\n{\n\tstruct dlm_ctxt *target;\n\tstruct dlm_ctxt *ret = NULL;\n\n\tspin_lock(&dlm_domain_lock);\n\n\tlist_for_each_entry(target, &dlm_domains, list) {\n\t\tif (target == dlm) {\n\t\t\t__dlm_get(target);\n\t\t\tret = target;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tspin_unlock(&dlm_domain_lock);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__seq_open_private",
          "args": [
            "file",
            "&debug_lockres_ops",
            "sizeof(*dl)"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "__seq_open_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "615-638",
          "snippet": "void *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nvoid *__seq_open_private(struct file *f, const struct seq_operations *ops,\n\t\tint psize)\n{\n\tint rc;\n\tvoid *private;\n\tstruct seq_file *seq;\n\n\tprivate = kzalloc(psize, GFP_KERNEL);\n\tif (private == NULL)\n\t\tgoto out;\n\n\trc = seq_open(f, ops);\n\tif (rc < 0)\n\t\tgoto out_free;\n\n\tseq = f->private_data;\n\tseq->private = private;\n\treturn private;\n\nout_free:\n\tkfree(private);\nout:\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_lockres_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tstruct debug_lockres *dl;\n\tvoid *buf;\n\n\tbuf = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (!buf)\n\t\tgoto bail;\n\n\tdl = __seq_open_private(file, &debug_lockres_ops, sizeof(*dl));\n\tif (!dl)\n\t\tgoto bailfree;\n\n\tdl->dl_len = PAGE_SIZE;\n\tdl->dl_buf = buf;\n\n\tdlm_grab(dlm);\n\tdl->dl_ctxt = dlm;\n\n\treturn 0;\n\nbailfree:\n\tkfree(buf);\nbail:\n\tmlog_errno(-ENOMEM);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "lockres_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "631-638",
    "snippet": "static int lockres_seq_show(struct seq_file *s, void *v)\n{\n\tstruct debug_lockres *dl = (struct debug_lockres *)v;\n\n\tseq_printf(s, \"%s\", dl->dl_buf);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"%s\"",
            "dl->dl_buf"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int lockres_seq_show(struct seq_file *s, void *v)\n{\n\tstruct debug_lockres *dl = (struct debug_lockres *)v;\n\n\tseq_printf(s, \"%s\", dl->dl_buf);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "lockres_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "626-629",
    "snippet": "static void *lockres_seq_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void *lockres_seq_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "lockres_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "622-624",
    "snippet": "static void lockres_seq_stop(struct seq_file *m, void *v)\n{\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void lockres_seq_stop(struct seq_file *m, void *v)\n{\n}"
  },
  {
    "function_name": "lockres_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "576-620",
    "snippet": "static void *lockres_seq_start(struct seq_file *m, loff_t *pos)\n{\n\tstruct debug_lockres *dl = m->private;\n\tstruct dlm_ctxt *dlm = dl->dl_ctxt;\n\tstruct dlm_lock_resource *oldres = dl->dl_res;\n\tstruct dlm_lock_resource *res = NULL;\n\tstruct list_head *track_list;\n\n\tspin_lock(&dlm->track_lock);\n\tif (oldres)\n\t\ttrack_list = &oldres->tracking;\n\telse {\n\t\ttrack_list = &dlm->tracking_list;\n\t\tif (list_empty(track_list)) {\n\t\t\tdl = NULL;\n\t\t\tspin_unlock(&dlm->track_lock);\n\t\t\tgoto bail;\n\t\t}\n\t}\n\n\tlist_for_each_entry(res, track_list, tracking) {\n\t\tif (&res->tracking == &dlm->tracking_list)\n\t\t\tres = NULL;\n\t\telse\n\t\t\tdlm_lockres_get(res);\n\t\tbreak;\n\t}\n\tspin_unlock(&dlm->track_lock);\n\n\tif (oldres)\n\t\tdlm_lockres_put(oldres);\n\n\tdl->dl_res = res;\n\n\tif (res) {\n\t\tspin_lock(&res->spinlock);\n\t\tdump_lockres(res, dl->dl_buf, dl->dl_len - 1);\n\t\tspin_unlock(&res->spinlock);\n\t} else\n\t\tdl = NULL;\n\nbail:\n\t/* passed to seq_show */\n\treturn dl;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&res->spinlock"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_lockres",
          "args": [
            "res",
            "dl->dl_buf",
            "dl->dl_len - 1"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "dump_lockres",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "523-574",
          "snippet": "static int dump_lockres(struct dlm_lock_resource *res, char *buf, int len)\n{\n\tstruct dlm_lock *lock;\n\tint i;\n\tint out = 0;\n\n\tout += snprintf(buf + out, len - out, \"NAME:\");\n\tout += stringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t\t  buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n#define DEBUG_LRES_VERSION\t1\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"LRES:%d,%d,%d,%ld,%d,%d,%d,%d,%d,%d,%d\\n\",\n\t\t\tDEBUG_LRES_VERSION,\n\t\t\tres->owner, res->state, res->last_used,\n\t\t\t!list_empty(&res->purge),\n\t\t\t!list_empty(&res->dirty),\n\t\t\t!list_empty(&res->recovering),\n\t\t\tres->inflight_locks, res->migration_pending,\n\t\t\tatomic_read(&res->asts_reserved),\n\t\t\tatomic_read(&res->refs.refcount));\n\n\t/* refmap */\n\tout += snprintf(buf + out, len - out, \"RMAP:\");\n\tout += stringify_nodemap(res->refmap, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* lvb */\n\tout += snprintf(buf + out, len - out, \"LVBX:\");\n\tfor (i = 0; i < DLM_LVB_LEN; i++)\n\t\tout += snprintf(buf + out, len - out,\n\t\t\t\t\t\"%02x\", (unsigned char)res->lvb[i]);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* granted */\n\tlist_for_each_entry(lock, &res->granted, list)\n\t\tout += dump_lock(lock, 0, buf + out, len - out);\n\n\t/* converting */\n\tlist_for_each_entry(lock, &res->converting, list)\n\t\tout += dump_lock(lock, 1, buf + out, len - out);\n\n\t/* blocked */\n\tlist_for_each_entry(lock, &res->blocked, list)\n\t\tout += dump_lock(lock, 2, buf + out, len - out);\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define DEBUG_LRES_VERSION\t1"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DEBUG_LRES_VERSION\t1\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_lockres(struct dlm_lock_resource *res, char *buf, int len)\n{\n\tstruct dlm_lock *lock;\n\tint i;\n\tint out = 0;\n\n\tout += snprintf(buf + out, len - out, \"NAME:\");\n\tout += stringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t\t  buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n#define DEBUG_LRES_VERSION\t1\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"LRES:%d,%d,%d,%ld,%d,%d,%d,%d,%d,%d,%d\\n\",\n\t\t\tDEBUG_LRES_VERSION,\n\t\t\tres->owner, res->state, res->last_used,\n\t\t\t!list_empty(&res->purge),\n\t\t\t!list_empty(&res->dirty),\n\t\t\t!list_empty(&res->recovering),\n\t\t\tres->inflight_locks, res->migration_pending,\n\t\t\tatomic_read(&res->asts_reserved),\n\t\t\tatomic_read(&res->refs.refcount));\n\n\t/* refmap */\n\tout += snprintf(buf + out, len - out, \"RMAP:\");\n\tout += stringify_nodemap(res->refmap, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* lvb */\n\tout += snprintf(buf + out, len - out, \"LVBX:\");\n\tfor (i = 0; i < DLM_LVB_LEN; i++)\n\t\tout += snprintf(buf + out, len - out,\n\t\t\t\t\t\"%02x\", (unsigned char)res->lvb[i]);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* granted */\n\tlist_for_each_entry(lock, &res->granted, list)\n\t\tout += dump_lock(lock, 0, buf + out, len - out);\n\n\t/* converting */\n\tlist_for_each_entry(lock, &res->converting, list)\n\t\tout += dump_lock(lock, 1, buf + out, len - out);\n\n\t/* blocked */\n\tlist_for_each_entry(lock, &res->blocked, list)\n\t\tout += dump_lock(lock, 2, buf + out, len - out);\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&res->spinlock"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockres_put",
          "args": [
            "oldres"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockres_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmmaster.c",
          "lines": "550-553",
          "snippet": "void dlm_lockres_put(struct dlm_lock_resource *res)\n{\n\tkref_put(&res->refs, dlm_lockres_release);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u8 dlm_pick_migration_target(struct dlm_ctxt *dlm,\n\t\t\t\t    struct dlm_lock_resource *res);",
            "static void dlm_remove_nonlocal_locks(struct dlm_ctxt *dlm,\n\t\t\t\t      struct dlm_lock_resource *res);",
            "static int dlm_pre_master_reco_lockres(struct dlm_ctxt *dlm,\n\t\t\t\t       struct dlm_lock_resource *res);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/spinlock.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic u8 dlm_pick_migration_target(struct dlm_ctxt *dlm,\n\t\t\t\t    struct dlm_lock_resource *res);\nstatic void dlm_remove_nonlocal_locks(struct dlm_ctxt *dlm,\n\t\t\t\t      struct dlm_lock_resource *res);\nstatic int dlm_pre_master_reco_lockres(struct dlm_ctxt *dlm,\n\t\t\t\t       struct dlm_lock_resource *res);\n\nvoid dlm_lockres_put(struct dlm_lock_resource *res)\n{\n\tkref_put(&res->refs, dlm_lockres_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockres_get",
          "args": [
            "res"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockres_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "873-878",
          "snippet": "static inline void dlm_lockres_get(struct dlm_lock_resource *res)\n{\n\t/* This is called on every lookup, so it might be worth\n\t * inlining. */\n\tkref_get(&res->refs);\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\nstatic inline void dlm_lockres_get(struct dlm_lock_resource *res)\n{\n\t/* This is called on every lookup, so it might be worth\n\t * inlining. */\n\tkref_get(&res->refs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "res",
            "track_list",
            "tracking"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "track_list"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void *lockres_seq_start(struct seq_file *m, loff_t *pos)\n{\n\tstruct debug_lockres *dl = m->private;\n\tstruct dlm_ctxt *dlm = dl->dl_ctxt;\n\tstruct dlm_lock_resource *oldres = dl->dl_res;\n\tstruct dlm_lock_resource *res = NULL;\n\tstruct list_head *track_list;\n\n\tspin_lock(&dlm->track_lock);\n\tif (oldres)\n\t\ttrack_list = &oldres->tracking;\n\telse {\n\t\ttrack_list = &dlm->tracking_list;\n\t\tif (list_empty(track_list)) {\n\t\t\tdl = NULL;\n\t\t\tspin_unlock(&dlm->track_lock);\n\t\t\tgoto bail;\n\t\t}\n\t}\n\n\tlist_for_each_entry(res, track_list, tracking) {\n\t\tif (&res->tracking == &dlm->tracking_list)\n\t\t\tres = NULL;\n\t\telse\n\t\t\tdlm_lockres_get(res);\n\t\tbreak;\n\t}\n\tspin_unlock(&dlm->track_lock);\n\n\tif (oldres)\n\t\tdlm_lockres_put(oldres);\n\n\tdl->dl_res = res;\n\n\tif (res) {\n\t\tspin_lock(&res->spinlock);\n\t\tdump_lockres(res, dl->dl_buf, dl->dl_len - 1);\n\t\tspin_unlock(&res->spinlock);\n\t} else\n\t\tdl = NULL;\n\nbail:\n\t/* passed to seq_show */\n\treturn dl;\n}"
  },
  {
    "function_name": "dump_lockres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "523-574",
    "snippet": "static int dump_lockres(struct dlm_lock_resource *res, char *buf, int len)\n{\n\tstruct dlm_lock *lock;\n\tint i;\n\tint out = 0;\n\n\tout += snprintf(buf + out, len - out, \"NAME:\");\n\tout += stringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t\t  buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n#define DEBUG_LRES_VERSION\t1\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"LRES:%d,%d,%d,%ld,%d,%d,%d,%d,%d,%d,%d\\n\",\n\t\t\tDEBUG_LRES_VERSION,\n\t\t\tres->owner, res->state, res->last_used,\n\t\t\t!list_empty(&res->purge),\n\t\t\t!list_empty(&res->dirty),\n\t\t\t!list_empty(&res->recovering),\n\t\t\tres->inflight_locks, res->migration_pending,\n\t\t\tatomic_read(&res->asts_reserved),\n\t\t\tatomic_read(&res->refs.refcount));\n\n\t/* refmap */\n\tout += snprintf(buf + out, len - out, \"RMAP:\");\n\tout += stringify_nodemap(res->refmap, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* lvb */\n\tout += snprintf(buf + out, len - out, \"LVBX:\");\n\tfor (i = 0; i < DLM_LVB_LEN; i++)\n\t\tout += snprintf(buf + out, len - out,\n\t\t\t\t\t\"%02x\", (unsigned char)res->lvb[i]);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* granted */\n\tlist_for_each_entry(lock, &res->granted, list)\n\t\tout += dump_lock(lock, 0, buf + out, len - out);\n\n\t/* converting */\n\tlist_for_each_entry(lock, &res->converting, list)\n\t\tout += dump_lock(lock, 1, buf + out, len - out);\n\n\t/* blocked */\n\tlist_for_each_entry(lock, &res->blocked, list)\n\t\tout += dump_lock(lock, 2, buf + out, len - out);\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define DEBUG_LRES_VERSION\t1"
    ],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_lock",
          "args": [
            "lock",
            "2",
            "buf + out",
            "len - out"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "dump_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "499-521",
          "snippet": "static int dump_lock(struct dlm_lock *lock, int list_type, char *buf, int len)\n{\n\tint out;\n\n#define DEBUG_LOCK_VERSION\t1\n\tspin_lock(&lock->spinlock);\n\tout = snprintf(buf, len, \"LOCK:%d,%d,%d,%d,%d,%d:%lld,%d,%d,%d,%d,%d,\"\n\t\t       \"%d,%d,%d,%d\\n\",\n\t\t       DEBUG_LOCK_VERSION,\n\t\t       list_type, lock->ml.type, lock->ml.convert_type,\n\t\t       lock->ml.node,\n\t\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t\t       !list_empty(&lock->ast_list),\n\t\t       !list_empty(&lock->bast_list),\n\t\t       lock->ast_pending, lock->bast_pending,\n\t\t       lock->convert_pending, lock->lock_pending,\n\t\t       lock->cancel_pending, lock->unlock_pending,\n\t\t       atomic_read(&lock->lock_refs.refcount));\n\tspin_unlock(&lock->spinlock);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define DEBUG_LOCK_VERSION\t1"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DEBUG_LOCK_VERSION\t1\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_lock(struct dlm_lock *lock, int list_type, char *buf, int len)\n{\n\tint out;\n\n#define DEBUG_LOCK_VERSION\t1\n\tspin_lock(&lock->spinlock);\n\tout = snprintf(buf, len, \"LOCK:%d,%d,%d,%d,%d,%d:%lld,%d,%d,%d,%d,%d,\"\n\t\t       \"%d,%d,%d,%d\\n\",\n\t\t       DEBUG_LOCK_VERSION,\n\t\t       list_type, lock->ml.type, lock->ml.convert_type,\n\t\t       lock->ml.node,\n\t\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t\t       !list_empty(&lock->ast_list),\n\t\t       !list_empty(&lock->bast_list),\n\t\t       lock->ast_pending, lock->bast_pending,\n\t\t       lock->convert_pending, lock->lock_pending,\n\t\t       lock->cancel_pending, lock->unlock_pending,\n\t\t       atomic_read(&lock->lock_refs.refcount));\n\tspin_unlock(&lock->spinlock);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->blocked",
            "list"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->converting",
            "list"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->granted",
            "list"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"%02x\"",
            "(unsigned char)res->lvb[i]"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"LVBX:\""
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_nodemap",
          "args": [
            "res->refmap",
            "O2NM_MAX_NODES",
            "buf + out",
            "len - out"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_nodemap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "271-281",
          "snippet": "static int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"RMAP:\""
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"LRES:%d,%d,%d,%ld,%d,%d,%d,%d,%d,%d,%d\\n\"",
            "DEBUG_LRES_VERSION",
            "res->owner",
            "res->state",
            "res->last_used",
            "!list_empty(&res->purge)",
            "!list_empty(&res->dirty)",
            "!list_empty(&res->recovering)",
            "res->inflight_locks",
            "res->migration_pending",
            "atomic_read(&res->asts_reserved)",
            "atomic_read(&res->refs.refcount)"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&res->refs.refcount"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&res->asts_reserved"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&res->recovering"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_lockname",
          "args": [
            "res->lockname.name",
            "res->lockname.len",
            "buf + out",
            "len - out"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_lockname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "251-269",
          "snippet": "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define OCFS2_DENTRY_LOCK_INO_START\t18"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"NAME:\""
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DEBUG_LRES_VERSION\t1\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_lockres(struct dlm_lock_resource *res, char *buf, int len)\n{\n\tstruct dlm_lock *lock;\n\tint i;\n\tint out = 0;\n\n\tout += snprintf(buf + out, len - out, \"NAME:\");\n\tout += stringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t\t  buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n#define DEBUG_LRES_VERSION\t1\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"LRES:%d,%d,%d,%ld,%d,%d,%d,%d,%d,%d,%d\\n\",\n\t\t\tDEBUG_LRES_VERSION,\n\t\t\tres->owner, res->state, res->last_used,\n\t\t\t!list_empty(&res->purge),\n\t\t\t!list_empty(&res->dirty),\n\t\t\t!list_empty(&res->recovering),\n\t\t\tres->inflight_locks, res->migration_pending,\n\t\t\tatomic_read(&res->asts_reserved),\n\t\t\tatomic_read(&res->refs.refcount));\n\n\t/* refmap */\n\tout += snprintf(buf + out, len - out, \"RMAP:\");\n\tout += stringify_nodemap(res->refmap, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* lvb */\n\tout += snprintf(buf + out, len - out, \"LVBX:\");\n\tfor (i = 0; i < DLM_LVB_LEN; i++)\n\t\tout += snprintf(buf + out, len - out,\n\t\t\t\t\t\"%02x\", (unsigned char)res->lvb[i]);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\t/* granted */\n\tlist_for_each_entry(lock, &res->granted, list)\n\t\tout += dump_lock(lock, 0, buf + out, len - out);\n\n\t/* converting */\n\tlist_for_each_entry(lock, &res->converting, list)\n\t\tout += dump_lock(lock, 1, buf + out, len - out);\n\n\t/* blocked */\n\tlist_for_each_entry(lock, &res->blocked, list)\n\t\tout += dump_lock(lock, 2, buf + out, len - out);\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}"
  },
  {
    "function_name": "dump_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "499-521",
    "snippet": "static int dump_lock(struct dlm_lock *lock, int list_type, char *buf, int len)\n{\n\tint out;\n\n#define DEBUG_LOCK_VERSION\t1\n\tspin_lock(&lock->spinlock);\n\tout = snprintf(buf, len, \"LOCK:%d,%d,%d,%d,%d,%d:%lld,%d,%d,%d,%d,%d,\"\n\t\t       \"%d,%d,%d,%d\\n\",\n\t\t       DEBUG_LOCK_VERSION,\n\t\t       list_type, lock->ml.type, lock->ml.convert_type,\n\t\t       lock->ml.node,\n\t\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t\t       !list_empty(&lock->ast_list),\n\t\t       !list_empty(&lock->bast_list),\n\t\t       lock->ast_pending, lock->bast_pending,\n\t\t       lock->convert_pending, lock->lock_pending,\n\t\t       lock->cancel_pending, lock->unlock_pending,\n\t\t       atomic_read(&lock->lock_refs.refcount));\n\tspin_unlock(&lock->spinlock);\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define DEBUG_LOCK_VERSION\t1"
    ],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lock->spinlock"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "len",
            "\"LOCK:%d,%d,%d,%d,%d,%d:%lld,%d,%d,%d,%d,%d,\"\n\t\t       \"%d,%d,%d,%d\\n\"",
            "DEBUG_LOCK_VERSION",
            "list_type",
            "lock->ml.type",
            "lock->ml.convert_type",
            "lock->ml.node",
            "dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie))",
            "dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie))",
            "!list_empty(&lock->ast_list)",
            "!list_empty(&lock->bast_list)",
            "lock->ast_pending",
            "lock->bast_pending",
            "lock->convert_pending",
            "lock->lock_pending",
            "lock->cancel_pending",
            "lock->unlock_pending",
            "atomic_read(&lock->lock_refs.refcount)"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&lock->lock_refs.refcount"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&lock->bast_list"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_get_lock_cookie_seq",
          "args": [
            "be64_to_cpu(lock->ml.cookie)"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_get_lock_cookie_seq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "821-826",
          "snippet": "static inline unsigned long long dlm_get_lock_cookie_seq(u64 cookie)\n{\n\tunsigned long long ret;\n\tret = ((unsigned long long)cookie) & 0x00ffffffffffffffULL;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\nstatic inline unsigned long long dlm_get_lock_cookie_seq(u64 cookie)\n{\n\tunsigned long long ret;\n\tret = ((unsigned long long)cookie) & 0x00ffffffffffffffULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "lock->ml.cookie"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_get_lock_cookie_node",
          "args": [
            "be64_to_cpu(lock->ml.cookie)"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_get_lock_cookie_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "813-819",
          "snippet": "static inline u8 dlm_get_lock_cookie_node(u64 cookie)\n{\n\tu8 ret;\n\tcookie >>= 56;\n\tret = (u8)(cookie & 0xffULL);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\nstatic inline u8 dlm_get_lock_cookie_node(u64 cookie)\n{\n\tu8 ret;\n\tcookie >>= 56;\n\tret = (u8)(cookie & 0xffULL);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "lock->ml.cookie"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lock->spinlock"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define DEBUG_LOCK_VERSION\t1\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_lock(struct dlm_lock *lock, int list_type, char *buf, int len)\n{\n\tint out;\n\n#define DEBUG_LOCK_VERSION\t1\n\tspin_lock(&lock->spinlock);\n\tout = snprintf(buf, len, \"LOCK:%d,%d,%d,%d,%d,%d:%lld,%d,%d,%d,%d,%d,\"\n\t\t       \"%d,%d,%d,%d\\n\",\n\t\t       DEBUG_LOCK_VERSION,\n\t\t       list_type, lock->ml.type, lock->ml.convert_type,\n\t\t       lock->ml.node,\n\t\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t\t       !list_empty(&lock->ast_list),\n\t\t       !list_empty(&lock->bast_list),\n\t\t       lock->ast_pending, lock->bast_pending,\n\t\t       lock->convert_pending, lock->lock_pending,\n\t\t       lock->cancel_pending, lock->unlock_pending,\n\t\t       atomic_read(&lock->lock_refs.refcount));\n\tspin_unlock(&lock->spinlock);\n\n\treturn out;\n}"
  },
  {
    "function_name": "debug_mle_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "471-487",
    "snippet": "static int debug_mle_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_mle_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "debug_mle_print(dlm, buf, PAGE_SIZE - 1)"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_mle_print",
          "args": [
            "dlm",
            "buf",
            "PAGE_SIZE - 1"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "debug_mle_print",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "441-469",
          "snippet": "static int debug_mle_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_master_list_entry *mle;\n\tstruct hlist_head *bucket;\n\tint i, out = 0;\n\tunsigned long total = 0, longest = 0, bucket_count = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping MLEs for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->master_lock);\n\tfor (i = 0; i < DLM_HASH_BUCKETS; i++) {\n\t\tbucket = dlm_master_hash(dlm, i);\n\t\thlist_for_each_entry(mle, bucket, master_hash_node) {\n\t\t\t++total;\n\t\t\t++bucket_count;\n\t\t\tif (len - out < 200)\n\t\t\t\tcontinue;\n\t\t\tout += dump_mle(mle, buf + out, len - out);\n\t\t}\n\t\tlongest = max(longest, bucket_count);\n\t\tbucket_count = 0;\n\t}\n\tspin_unlock(&dlm->master_lock);\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Total: %lu, Longest: %lu\\n\", total, longest);\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_mle_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_master_list_entry *mle;\n\tstruct hlist_head *bucket;\n\tint i, out = 0;\n\tunsigned long total = 0, longest = 0, bucket_count = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping MLEs for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->master_lock);\n\tfor (i = 0; i < DLM_HASH_BUCKETS; i++) {\n\t\tbucket = dlm_master_hash(dlm, i);\n\t\thlist_for_each_entry(mle, bucket, master_hash_node) {\n\t\t\t++total;\n\t\t\t++bucket_count;\n\t\t\tif (len - out < 200)\n\t\t\t\tcontinue;\n\t\t\tout += dump_mle(mle, buf + out, len - out);\n\t\t}\n\t\tlongest = max(longest, bucket_count);\n\t\tbucket_count = 0;\n\t}\n\tspin_unlock(&dlm->master_lock);\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Total: %lu, Longest: %lu\\n\", total, longest);\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_NOFS"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_mle_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_mle_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "debug_mle_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "441-469",
    "snippet": "static int debug_mle_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_master_list_entry *mle;\n\tstruct hlist_head *bucket;\n\tint i, out = 0;\n\tunsigned long total = 0, longest = 0, bucket_count = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping MLEs for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->master_lock);\n\tfor (i = 0; i < DLM_HASH_BUCKETS; i++) {\n\t\tbucket = dlm_master_hash(dlm, i);\n\t\thlist_for_each_entry(mle, bucket, master_hash_node) {\n\t\t\t++total;\n\t\t\t++bucket_count;\n\t\t\tif (len - out < 200)\n\t\t\t\tcontinue;\n\t\t\tout += dump_mle(mle, buf + out, len - out);\n\t\t}\n\t\tlongest = max(longest, bucket_count);\n\t\tbucket_count = 0;\n\t}\n\tspin_unlock(&dlm->master_lock);\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Total: %lu, Longest: %lu\\n\", total, longest);\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Total: %lu, Longest: %lu\\n\"",
            "total",
            "longest"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dlm->master_lock"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "longest",
            "bucket_count"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "max_select_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/select.c",
          "lines": "342-382",
          "snippet": "static int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <net/busy_poll.h>",
            "#include <linux/freezer.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/personality.h> /* for STICKY_TIMEOUTS */",
            "#include <linux/poll.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <net/busy_poll.h>\n#include <linux/freezer.h>\n#include <linux/sched/rt.h>\n#include <linux/hrtimer.h>\n#include <linux/rcupdate.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/personality.h> /* for STICKY_TIMEOUTS */\n#include <linux/poll.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n\nstatic int max_select_fd(unsigned long n, fd_set_bits *fds)\n{\n\tunsigned long *open_fds;\n\tunsigned long set;\n\tint max;\n\tstruct fdtable *fdt;\n\n\t/* handle last in-complete long-word first */\n\tset = ~(~0UL << (n & (BITS_PER_LONG-1)));\n\tn /= BITS_PER_LONG;\n\tfdt = files_fdtable(current->files);\n\topen_fds = fdt->open_fds + n;\n\tmax = 0;\n\tif (set) {\n\t\tset &= BITS(fds, n);\n\t\tif (set) {\n\t\t\tif (!(set & ~*open_fds))\n\t\t\t\tgoto get_max;\n\t\t\treturn -EBADF;\n\t\t}\n\t}\n\twhile (n) {\n\t\topen_fds--;\n\t\tn--;\n\t\tset = BITS(fds, n);\n\t\tif (!set)\n\t\t\tcontinue;\n\t\tif (set & ~*open_fds)\n\t\t\treturn -EBADF;\n\t\tif (max)\n\t\t\tcontinue;\nget_max:\n\t\tdo {\n\t\t\tmax++;\n\t\t\tset >>= 1;\n\t\t} while (set);\n\t\tmax += n * BITS_PER_LONG;\n\t}\n\n\treturn max;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_mle",
          "args": [
            "mle",
            "buf + out",
            "len - out"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "dump_mle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "283-326",
          "snippet": "static int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry",
          "args": [
            "mle",
            "bucket",
            "master_hash_node"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_master_hash",
          "args": [
            "dlm",
            "i"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_master_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "195-200",
          "snippet": "static inline struct hlist_head *dlm_master_hash(struct dlm_ctxt *dlm,\n\t\t\t\t\t\t unsigned i)\n{\n\treturn dlm->master_hash[(i / DLM_BUCKETS_PER_PAGE) % DLM_HASH_PAGES] +\n\t\t\t(i % DLM_BUCKETS_PER_PAGE);\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [
            "#define DLM_BUCKETS_PER_PAGE\t(PAGE_SIZE / sizeof(struct hlist_head))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\n#define DLM_BUCKETS_PER_PAGE\t(PAGE_SIZE / sizeof(struct hlist_head))\n\nstatic inline struct hlist_head *dlm_master_hash(struct dlm_ctxt *dlm,\n\t\t\t\t\t\t unsigned i)\n{\n\treturn dlm->master_hash[(i / DLM_BUCKETS_PER_PAGE) % DLM_HASH_PAGES] +\n\t\t\t(i % DLM_BUCKETS_PER_PAGE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dlm->master_lock"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Dumping MLEs for Domain: %s\\n\"",
            "dlm->name"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_mle_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_master_list_entry *mle;\n\tstruct hlist_head *bucket;\n\tint i, out = 0;\n\tunsigned long total = 0, longest = 0, bucket_count = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping MLEs for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->master_lock);\n\tfor (i = 0; i < DLM_HASH_BUCKETS; i++) {\n\t\tbucket = dlm_master_hash(dlm, i);\n\t\thlist_for_each_entry(mle, bucket, master_hash_node) {\n\t\t\t++total;\n\t\t\t++bucket_count;\n\t\t\tif (len - out < 200)\n\t\t\t\tcontinue;\n\t\t\tout += dump_mle(mle, buf + out, len - out);\n\t\t}\n\t\tlongest = max(longest, bucket_count);\n\t\tbucket_count = 0;\n\t}\n\tspin_unlock(&dlm->master_lock);\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Total: %lu, Longest: %lu\\n\", total, longest);\n\treturn out;\n}"
  },
  {
    "function_name": "debug_purgelist_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "414-430",
    "snippet": "static int debug_purgelist_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_purgelist_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "debug_purgelist_print(dlm, buf, PAGE_SIZE - 1)"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_i_size_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/btrfs_inode.h",
          "lines": "233-237",
          "snippet": "static inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}",
          "includes": [
            "#include \"delayed-inode.h\"",
            "#include \"ordered-data.h\"",
            "#include \"extent_io.h\"",
            "#include \"extent_map.h\"",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"delayed-inode.h\"\n#include \"ordered-data.h\"\n#include \"extent_io.h\"\n#include \"extent_map.h\"\n#include <linux/hash.h>\n\nstatic inline void btrfs_i_size_write(struct inode *inode, u64 size)\n{\n\ti_size_write(inode, size);\n\tBTRFS_I(inode)->disk_i_size = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_purgelist_print",
          "args": [
            "dlm",
            "buf",
            "PAGE_SIZE - 1"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "debug_purgelist_print",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "385-412",
          "snippet": "static int debug_purgelist_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_lock_resource *res;\n\tint out = 0;\n\tunsigned long total = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping Purgelist for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->spinlock);\n\tlist_for_each_entry(res, &dlm->purge_list, purge) {\n\t\t++total;\n\t\tif (len - out < 100)\n\t\t\tcontinue;\n\t\tspin_lock(&res->spinlock);\n\t\tout += stringify_lockname(res->lockname.name,\n\t\t\t\t\t  res->lockname.len,\n\t\t\t\t\t  buf + out, len - out);\n\t\tout += snprintf(buf + out, len - out, \"\\t%ld\\n\",\n\t\t\t\t(jiffies - res->last_used)/HZ);\n\t\tspin_unlock(&res->spinlock);\n\t}\n\tspin_unlock(&dlm->spinlock);\n\n\tout += snprintf(buf + out, len - out, \"Total on list: %lu\\n\", total);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_purgelist_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_lock_resource *res;\n\tint out = 0;\n\tunsigned long total = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping Purgelist for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->spinlock);\n\tlist_for_each_entry(res, &dlm->purge_list, purge) {\n\t\t++total;\n\t\tif (len - out < 100)\n\t\t\tcontinue;\n\t\tspin_lock(&res->spinlock);\n\t\tout += stringify_lockname(res->lockname.name,\n\t\t\t\t\t  res->lockname.len,\n\t\t\t\t\t  buf + out, len - out);\n\t\tout += snprintf(buf + out, len - out, \"\\t%ld\\n\",\n\t\t\t\t(jiffies - res->last_used)/HZ);\n\t\tspin_unlock(&res->spinlock);\n\t}\n\tspin_unlock(&dlm->spinlock);\n\n\tout += snprintf(buf + out, len - out, \"Total on list: %lu\\n\", total);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_NOFS"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_purgelist_open(struct inode *inode, struct file *file)\n{\n\tstruct dlm_ctxt *dlm = inode->i_private;\n\tchar *buf = NULL;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (!buf)\n\t\tgoto bail;\n\n\ti_size_write(inode, debug_purgelist_print(dlm, buf, PAGE_SIZE - 1));\n\n\tfile->private_data = buf;\n\n\treturn 0;\nbail:\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "debug_purgelist_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "385-412",
    "snippet": "static int debug_purgelist_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_lock_resource *res;\n\tint out = 0;\n\tunsigned long total = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping Purgelist for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->spinlock);\n\tlist_for_each_entry(res, &dlm->purge_list, purge) {\n\t\t++total;\n\t\tif (len - out < 100)\n\t\t\tcontinue;\n\t\tspin_lock(&res->spinlock);\n\t\tout += stringify_lockname(res->lockname.name,\n\t\t\t\t\t  res->lockname.len,\n\t\t\t\t\t  buf + out, len - out);\n\t\tout += snprintf(buf + out, len - out, \"\\t%ld\\n\",\n\t\t\t\t(jiffies - res->last_used)/HZ);\n\t\tspin_unlock(&res->spinlock);\n\t}\n\tspin_unlock(&dlm->spinlock);\n\n\tout += snprintf(buf + out, len - out, \"Total on list: %lu\\n\", total);\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Total on list: %lu\\n\"",
            "total"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dlm->spinlock"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\t%ld\\n\"",
            "(jiffies - res->last_used)/HZ"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_lockname",
          "args": [
            "res->lockname.name",
            "res->lockname.len",
            "buf + out",
            "len - out"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_lockname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "251-269",
          "snippet": "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define OCFS2_DENTRY_LOCK_INO_START\t18"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&res->spinlock"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "res",
            "&dlm->purge_list",
            "purge"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Dumping Purgelist for Domain: %s\\n\"",
            "dlm->name"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int debug_purgelist_print(struct dlm_ctxt *dlm, char *buf, int len)\n{\n\tstruct dlm_lock_resource *res;\n\tint out = 0;\n\tunsigned long total = 0;\n\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"Dumping Purgelist for Domain: %s\\n\", dlm->name);\n\n\tspin_lock(&dlm->spinlock);\n\tlist_for_each_entry(res, &dlm->purge_list, purge) {\n\t\t++total;\n\t\tif (len - out < 100)\n\t\t\tcontinue;\n\t\tspin_lock(&res->spinlock);\n\t\tout += stringify_lockname(res->lockname.name,\n\t\t\t\t\t  res->lockname.len,\n\t\t\t\t\t  buf + out, len - out);\n\t\tout += snprintf(buf + out, len - out, \"\\t%ld\\n\",\n\t\t\t\t(jiffies - res->last_used)/HZ);\n\t\tspin_unlock(&res->spinlock);\n\t}\n\tspin_unlock(&dlm->spinlock);\n\n\tout += snprintf(buf + out, len - out, \"Total on list: %lu\\n\", total);\n\n\treturn out;\n}"
  },
  {
    "function_name": "debug_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "376-381",
    "snippet": "static ssize_t debug_read(struct file *file, char __user *buf,\n\t\t\t  size_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "nbytes",
            "ppos",
            "file->private_data",
            "i_size_read(file->f_mapping->host)"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "simple_read_from_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/libfs.c",
          "lines": "590-608",
          "snippet": "ssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nssize_t simple_read_from_buffer(void __user *to, size_t count, loff_t *ppos,\n\t\t\t\tconst void *from, size_t available)\n{\n\tloff_t pos = *ppos;\n\tsize_t ret;\n\n\tif (pos < 0)\n\t\treturn -EINVAL;\n\tif (pos >= available || !count)\n\t\treturn 0;\n\tif (count > available - pos)\n\t\tcount = available - pos;\n\tret = copy_to_user(to, from + pos, count);\n\tif (ret == count)\n\t\treturn -EFAULT;\n\tcount -= ret;\n\t*ppos = pos + count;\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "file->f_mapping->host"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic ssize_t debug_read(struct file *file, char __user *buf,\n\t\t\t  size_t nbytes, loff_t *ppos)\n{\n\treturn simple_read_from_buffer(buf, nbytes, ppos, file->private_data,\n\t\t\t\t       i_size_read(file->f_mapping->host));\n}"
  },
  {
    "function_name": "debug_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "370-374",
    "snippet": "static int debug_release(struct inode *inode, struct file *file)\n{\n\tfree_page((unsigned long)file->private_data);\n\treturn 0;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_page",
          "args": [
            "(unsigned long)file->private_data"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "_xfs_buf_free_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_buf.c",
          "lines": "238-246",
          "snippet": "STATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/migrate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hash.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/percpu.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/bio.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/errno.h>",
            "#include <linux/stddef.h>",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/migrate.h>\n#include <linux/kthread.h>\n#include <linux/hash.h>\n#include <linux/blkdev.h>\n#include <linux/percpu.h>\n#include <linux/workqueue.h>\n#include <linux/proc_fs.h>\n#include <linux/sysctl.h>\n#include <linux/bio.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/errno.h>\n#include <linux/stddef.h>\n#include \"xfs.h\"\n\nSTATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int debug_release(struct inode *inode, struct file *file)\n{\n\tfree_page((unsigned long)file->private_data);\n\treturn 0;\n}"
  },
  {
    "function_name": "dlm_debug_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "365-368",
    "snippet": "static void dlm_debug_get(struct dlm_debug_ctxt *dc)\n{\n\tkref_get(&dc->debug_refcnt);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&dc->debug_refcnt"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_debug_get(struct dlm_debug_ctxt *dc)\n{\n\tkref_get(&dc->debug_refcnt);\n}"
  },
  {
    "function_name": "dlm_debug_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "359-363",
    "snippet": "static void dlm_debug_put(struct dlm_debug_ctxt *dc)\n{\n\tif (dc)\n\t\tkref_put(&dc->debug_refcnt, dlm_debug_free);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&dc->debug_refcnt",
            "dlm_debug_free"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_debug_put(struct dlm_debug_ctxt *dc)\n{\n\tif (dc)\n\t\tkref_put(&dc->debug_refcnt, dlm_debug_free);\n}"
  },
  {
    "function_name": "dlm_debug_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "350-357",
    "snippet": "static void dlm_debug_free(struct kref *kref)\n{\n\tstruct dlm_debug_ctxt *dc;\n\n\tdc = container_of(kref, struct dlm_debug_ctxt, debug_refcnt);\n\n\tkfree(dc);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dc"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kref",
            "structdlm_debug_ctxt",
            "debug_refcnt"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_debug_free(struct kref *kref)\n{\n\tstruct dlm_debug_ctxt *dc;\n\n\tdc = container_of(kref, struct dlm_debug_ctxt, debug_refcnt);\n\n\tkfree(dc);\n}"
  },
  {
    "function_name": "dlm_print_one_mle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "328-337",
    "snippet": "void dlm_print_one_mle(struct dlm_master_list_entry *mle)\n{\n\tchar *buf;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (buf) {\n\t\tdump_mle(mle, buf, PAGE_SIZE - 1);\n\t\tfree_page((unsigned long)buf);\n\t}\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_page",
          "args": [
            "(unsigned long)buf"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "_xfs_buf_free_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_buf.c",
          "lines": "238-246",
          "snippet": "STATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}",
          "includes": [
            "#include \"xfs_log.h\"",
            "#include \"xfs_trace.h\"",
            "#include \"xfs_mount.h\"",
            "#include \"xfs_sb.h\"",
            "#include \"xfs_trans_resv.h\"",
            "#include \"xfs_log_format.h\"",
            "#include \"xfs_format.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/migrate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hash.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/percpu.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/bio.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/errno.h>",
            "#include <linux/stddef.h>",
            "#include \"xfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_log.h\"\n#include \"xfs_trace.h\"\n#include \"xfs_mount.h\"\n#include \"xfs_sb.h\"\n#include \"xfs_trans_resv.h\"\n#include \"xfs_log_format.h\"\n#include \"xfs_format.h\"\n#include <linux/freezer.h>\n#include <linux/backing-dev.h>\n#include <linux/migrate.h>\n#include <linux/kthread.h>\n#include <linux/hash.h>\n#include <linux/blkdev.h>\n#include <linux/percpu.h>\n#include <linux/workqueue.h>\n#include <linux/proc_fs.h>\n#include <linux/sysctl.h>\n#include <linux/bio.h>\n#include <linux/vmalloc.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/errno.h>\n#include <linux/stddef.h>\n#include \"xfs.h\"\n\nSTATIC void\n_xfs_buf_free_pages(\n\txfs_buf_t\t*bp)\n{\n\tif (bp->b_pages != bp->b_page_array) {\n\t\tkmem_free(bp->b_pages);\n\t\tbp->b_pages = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_mle",
          "args": [
            "mle",
            "buf",
            "PAGE_SIZE - 1"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "dump_mle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "283-326",
          "snippet": "static int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_NOFS"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_print_one_mle(struct dlm_master_list_entry *mle)\n{\n\tchar *buf;\n\n\tbuf = (char *) get_zeroed_page(GFP_NOFS);\n\tif (buf) {\n\t\tdump_mle(mle, buf, PAGE_SIZE - 1);\n\t\tfree_page((unsigned long)buf);\n\t}\n}"
  },
  {
    "function_name": "dump_mle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "283-326",
    "snippet": "static int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_nodemap",
          "args": [
            "mle->node_map",
            "O2NM_MAX_NODES",
            "buf + out",
            "len - out"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_nodemap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "271-281",
          "snippet": "static int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Node=\""
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Response=\""
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Vote=\""
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\n\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"Maybe=\""
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\"",
            "mle_type",
            "mle->master",
            "mle->new_master",
            "!list_empty(&mle->hb_events)",
            "!!mle->inuse",
            "atomic_read(&mle->mle_refs.refcount)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&mle->mle_refs.refcount"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&mle->hb_events"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stringify_lockname",
          "args": [
            "mle->mname",
            "mle->mnamelen",
            "buf + out",
            "len - out"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_lockname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "251-269",
          "snippet": "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define OCFS2_DENTRY_LOCK_INO_START\t18"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int dump_mle(struct dlm_master_list_entry *mle, char *buf, int len)\n{\n\tint out = 0;\n\tchar *mle_type;\n\n\tif (mle->type == DLM_MLE_BLOCK)\n\t\tmle_type = \"BLK\";\n\telse if (mle->type == DLM_MLE_MASTER)\n\t\tmle_type = \"MAS\";\n\telse\n\t\tmle_type = \"MIG\";\n\n\tout += stringify_lockname(mle->mname, mle->mnamelen, buf + out, len - out);\n\tout += snprintf(buf + out, len - out,\n\t\t\t\"\\t%3s\\tmas=%3u\\tnew=%3u\\tevt=%1d\\tuse=%1d\\tref=%3d\\n\",\n\t\t\tmle_type, mle->master, mle->new_master,\n\t\t\t!list_empty(&mle->hb_events),\n\t\t\t!!mle->inuse,\n\t\t\tatomic_read(&mle->mle_refs.refcount));\n\n\tout += snprintf(buf + out, len - out, \"Maybe=\");\n\tout += stringify_nodemap(mle->maybe_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Vote=\");\n\tout += stringify_nodemap(mle->vote_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Response=\");\n\tout += stringify_nodemap(mle->response_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"Node=\");\n\tout += stringify_nodemap(mle->node_map, O2NM_MAX_NODES,\n\t\t\t\t buf + out, len - out);\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\tout += snprintf(buf + out, len - out, \"\\n\");\n\n\treturn out;\n}"
  },
  {
    "function_name": "stringify_nodemap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "271-281",
    "snippet": "static int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"%d \"",
            "i"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "nodemap",
            "maxnodes",
            "i + 1"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_nodemap(unsigned long *nodemap, int maxnodes,\n\t\t\t     char *buf, int len)\n{\n\tint out = 0;\n\tint i = -1;\n\n\twhile ((i = find_next_bit(nodemap, maxnodes, i + 1)) < maxnodes)\n\t\tout += snprintf(buf + out, len - out, \"%d \", i);\n\n\treturn out;\n}"
  },
  {
    "function_name": "stringify_lockname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "251-269",
    "snippet": "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define OCFS2_DENTRY_LOCK_INO_START\t18"
    ],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"%.*s\"",
            "locklen",
            "lockname"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf + out",
            "len - out",
            "\"%.*s%08x\"",
            "OCFS2_DENTRY_LOCK_INO_START - 1",
            "lockname",
            "(unsigned int)be64_to_cpu(inode_blkno_be)"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "inode_blkno_be"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(__be64 *)&inode_blkno_be",
            "(char *)&lockname[OCFS2_DENTRY_LOCK_INO_START]",
            "sizeof(__be64)"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}"
  },
  {
    "function_name": "dlm_errname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "237-242",
    "snippet": "const char *dlm_errname(enum dlm_status err)\n{\n\tif (err >= DLM_MAXSTATS || err < 0)\n\t\treturn dlm_errnames[DLM_MAXSTATS];\n\treturn dlm_errnames[err];\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *dlm_errnames[] = {\n\t[DLM_NORMAL] =\t\t\t\"DLM_NORMAL\",\n\t[DLM_GRANTED] =\t\t\t\"DLM_GRANTED\",\n\t[DLM_DENIED] =\t\t\t\"DLM_DENIED\",\n\t[DLM_DENIED_NOLOCKS] =\t\t\"DLM_DENIED_NOLOCKS\",\n\t[DLM_WORKING] =\t\t\t\"DLM_WORKING\",\n\t[DLM_BLOCKED] =\t\t\t\"DLM_BLOCKED\",\n\t[DLM_BLOCKED_ORPHAN] =\t\t\"DLM_BLOCKED_ORPHAN\",\n\t[DLM_DENIED_GRACE_PERIOD] =\t\"DLM_DENIED_GRACE_PERIOD\",\n\t[DLM_SYSERR] =\t\t\t\"DLM_SYSERR\",\n\t[DLM_NOSUPPORT] =\t\t\"DLM_NOSUPPORT\",\n\t[DLM_CANCELGRANT] =\t\t\"DLM_CANCELGRANT\",\n\t[DLM_IVLOCKID] =\t\t\"DLM_IVLOCKID\",\n\t[DLM_SYNC] =\t\t\t\"DLM_SYNC\",\n\t[DLM_BADTYPE] =\t\t\t\"DLM_BADTYPE\",\n\t[DLM_BADRESOURCE] =\t\t\"DLM_BADRESOURCE\",\n\t[DLM_MAXHANDLES] =\t\t\"DLM_MAXHANDLES\",\n\t[DLM_NOCLINFO] =\t\t\"DLM_NOCLINFO\",\n\t[DLM_NOLOCKMGR] =\t\t\"DLM_NOLOCKMGR\",\n\t[DLM_NOPURGED] =\t\t\"DLM_NOPURGED\",\n\t[DLM_BADARGS] =\t\t\t\"DLM_BADARGS\",\n\t[DLM_VOID] =\t\t\t\"DLM_VOID\",\n\t[DLM_NOTQUEUED] =\t\t\"DLM_NOTQUEUED\",\n\t[DLM_IVBUFLEN] =\t\t\"DLM_IVBUFLEN\",\n\t[DLM_CVTUNGRANT] =\t\t\"DLM_CVTUNGRANT\",\n\t[DLM_BADPARAM] =\t\t\"DLM_BADPARAM\",\n\t[DLM_VALNOTVALID] =\t\t\"DLM_VALNOTVALID\",\n\t[DLM_REJECTED] =\t\t\"DLM_REJECTED\",\n\t[DLM_ABORT] =\t\t\t\"DLM_ABORT\",\n\t[DLM_CANCEL] =\t\t\t\"DLM_CANCEL\",\n\t[DLM_IVRESHANDLE] =\t\t\"DLM_IVRESHANDLE\",\n\t[DLM_DEADLOCK] =\t\t\"DLM_DEADLOCK\",\n\t[DLM_DENIED_NOASTS] =\t\t\"DLM_DENIED_NOASTS\",\n\t[DLM_FORWARD] =\t\t\t\"DLM_FORWARD\",\n\t[DLM_TIMEOUT] =\t\t\t\"DLM_TIMEOUT\",\n\t[DLM_IVGROUPID] =\t\t\"DLM_IVGROUPID\",\n\t[DLM_VERS_CONFLICT] =\t\t\"DLM_VERS_CONFLICT\",\n\t[DLM_BAD_DEVICE_PATH] =\t\t\"DLM_BAD_DEVICE_PATH\",\n\t[DLM_NO_DEVICE_PERMISSION] =\t\"DLM_NO_DEVICE_PERMISSION\",\n\t[DLM_NO_CONTROL_DEVICE ] =\t\"DLM_NO_CONTROL_DEVICE \",\n\t[DLM_RECOVERING] =\t\t\"DLM_RECOVERING\",\n\t[DLM_MIGRATING] =\t\t\"DLM_MIGRATING\",\n\t[DLM_MAXSTATS] =\t\t\"DLM_MAXSTATS\",\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic const char *dlm_errnames[] = {\n\t[DLM_NORMAL] =\t\t\t\"DLM_NORMAL\",\n\t[DLM_GRANTED] =\t\t\t\"DLM_GRANTED\",\n\t[DLM_DENIED] =\t\t\t\"DLM_DENIED\",\n\t[DLM_DENIED_NOLOCKS] =\t\t\"DLM_DENIED_NOLOCKS\",\n\t[DLM_WORKING] =\t\t\t\"DLM_WORKING\",\n\t[DLM_BLOCKED] =\t\t\t\"DLM_BLOCKED\",\n\t[DLM_BLOCKED_ORPHAN] =\t\t\"DLM_BLOCKED_ORPHAN\",\n\t[DLM_DENIED_GRACE_PERIOD] =\t\"DLM_DENIED_GRACE_PERIOD\",\n\t[DLM_SYSERR] =\t\t\t\"DLM_SYSERR\",\n\t[DLM_NOSUPPORT] =\t\t\"DLM_NOSUPPORT\",\n\t[DLM_CANCELGRANT] =\t\t\"DLM_CANCELGRANT\",\n\t[DLM_IVLOCKID] =\t\t\"DLM_IVLOCKID\",\n\t[DLM_SYNC] =\t\t\t\"DLM_SYNC\",\n\t[DLM_BADTYPE] =\t\t\t\"DLM_BADTYPE\",\n\t[DLM_BADRESOURCE] =\t\t\"DLM_BADRESOURCE\",\n\t[DLM_MAXHANDLES] =\t\t\"DLM_MAXHANDLES\",\n\t[DLM_NOCLINFO] =\t\t\"DLM_NOCLINFO\",\n\t[DLM_NOLOCKMGR] =\t\t\"DLM_NOLOCKMGR\",\n\t[DLM_NOPURGED] =\t\t\"DLM_NOPURGED\",\n\t[DLM_BADARGS] =\t\t\t\"DLM_BADARGS\",\n\t[DLM_VOID] =\t\t\t\"DLM_VOID\",\n\t[DLM_NOTQUEUED] =\t\t\"DLM_NOTQUEUED\",\n\t[DLM_IVBUFLEN] =\t\t\"DLM_IVBUFLEN\",\n\t[DLM_CVTUNGRANT] =\t\t\"DLM_CVTUNGRANT\",\n\t[DLM_BADPARAM] =\t\t\"DLM_BADPARAM\",\n\t[DLM_VALNOTVALID] =\t\t\"DLM_VALNOTVALID\",\n\t[DLM_REJECTED] =\t\t\"DLM_REJECTED\",\n\t[DLM_ABORT] =\t\t\t\"DLM_ABORT\",\n\t[DLM_CANCEL] =\t\t\t\"DLM_CANCEL\",\n\t[DLM_IVRESHANDLE] =\t\t\"DLM_IVRESHANDLE\",\n\t[DLM_DEADLOCK] =\t\t\"DLM_DEADLOCK\",\n\t[DLM_DENIED_NOASTS] =\t\t\"DLM_DENIED_NOASTS\",\n\t[DLM_FORWARD] =\t\t\t\"DLM_FORWARD\",\n\t[DLM_TIMEOUT] =\t\t\t\"DLM_TIMEOUT\",\n\t[DLM_IVGROUPID] =\t\t\"DLM_IVGROUPID\",\n\t[DLM_VERS_CONFLICT] =\t\t\"DLM_VERS_CONFLICT\",\n\t[DLM_BAD_DEVICE_PATH] =\t\t\"DLM_BAD_DEVICE_PATH\",\n\t[DLM_NO_DEVICE_PERMISSION] =\t\"DLM_NO_DEVICE_PERMISSION\",\n\t[DLM_NO_CONTROL_DEVICE ] =\t\"DLM_NO_CONTROL_DEVICE \",\n\t[DLM_RECOVERING] =\t\t\"DLM_RECOVERING\",\n\t[DLM_MIGRATING] =\t\t\"DLM_MIGRATING\",\n\t[DLM_MAXSTATS] =\t\t\"DLM_MAXSTATS\",\n};\n\nconst char *dlm_errname(enum dlm_status err)\n{\n\tif (err >= DLM_MAXSTATS || err < 0)\n\t\treturn dlm_errnames[DLM_MAXSTATS];\n\treturn dlm_errnames[err];\n}"
  },
  {
    "function_name": "dlm_errmsg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "229-234",
    "snippet": "const char *dlm_errmsg(enum dlm_status err)\n{\n\tif (err >= DLM_MAXSTATS || err < 0)\n\t\treturn dlm_errmsgs[DLM_MAXSTATS];\n\treturn dlm_errmsgs[err];\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *dlm_errmsgs[] = {\n\t[DLM_NORMAL] = \t\t\t\"request in progress\",\n\t[DLM_GRANTED] = \t\t\"request granted\",\n\t[DLM_DENIED] = \t\t\t\"request denied\",\n\t[DLM_DENIED_NOLOCKS] = \t\t\"request denied, out of system resources\",\n\t[DLM_WORKING] = \t\t\"async request in progress\",\n\t[DLM_BLOCKED] = \t\t\"lock request blocked\",\n\t[DLM_BLOCKED_ORPHAN] = \t\t\"lock request blocked by a orphan lock\",\n\t[DLM_DENIED_GRACE_PERIOD] = \t\"topological change in progress\",\n\t[DLM_SYSERR] = \t\t\t\"system error\",\n\t[DLM_NOSUPPORT] = \t\t\"unsupported\",\n\t[DLM_CANCELGRANT] = \t\t\"can't cancel convert: already granted\",\n\t[DLM_IVLOCKID] = \t\t\"bad lockid\",\n\t[DLM_SYNC] = \t\t\t\"synchronous request granted\",\n\t[DLM_BADTYPE] = \t\t\"bad resource type\",\n\t[DLM_BADRESOURCE] = \t\t\"bad resource handle\",\n\t[DLM_MAXHANDLES] = \t\t\"no more resource handles\",\n\t[DLM_NOCLINFO] = \t\t\"can't contact cluster manager\",\n\t[DLM_NOLOCKMGR] = \t\t\"can't contact lock manager\",\n\t[DLM_NOPURGED] = \t\t\"can't contact purge daemon\",\n\t[DLM_BADARGS] = \t\t\"bad api args\",\n\t[DLM_VOID] = \t\t\t\"no status\",\n\t[DLM_NOTQUEUED] = \t\t\"NOQUEUE was specified and request failed\",\n\t[DLM_IVBUFLEN] = \t\t\"invalid resource name length\",\n\t[DLM_CVTUNGRANT] = \t\t\"attempted to convert ungranted lock\",\n\t[DLM_BADPARAM] = \t\t\"invalid lock mode specified\",\n\t[DLM_VALNOTVALID] = \t\t\"value block has been invalidated\",\n\t[DLM_REJECTED] = \t\t\"request rejected, unrecognized client\",\n\t[DLM_ABORT] = \t\t\t\"blocked lock request cancelled\",\n\t[DLM_CANCEL] = \t\t\t\"conversion request cancelled\",\n\t[DLM_IVRESHANDLE] = \t\t\"invalid resource handle\",\n\t[DLM_DEADLOCK] = \t\t\"deadlock recovery refused this request\",\n\t[DLM_DENIED_NOASTS] = \t\t\"failed to allocate AST\",\n\t[DLM_FORWARD] = \t\t\"request must wait for primary's response\",\n\t[DLM_TIMEOUT] = \t\t\"timeout value for lock has expired\",\n\t[DLM_IVGROUPID] = \t\t\"invalid group specification\",\n\t[DLM_VERS_CONFLICT] = \t\t\"version conflicts prevent request handling\",\n\t[DLM_BAD_DEVICE_PATH] = \t\"Locks device does not exist or path wrong\",\n\t[DLM_NO_DEVICE_PERMISSION] = \t\"Client has insufficient perms for device\",\n\t[DLM_NO_CONTROL_DEVICE] = \t\"Cannot set options on opened device \",\n\t[DLM_RECOVERING] = \t\t\"lock resource being recovered\",\n\t[DLM_MIGRATING] = \t\t\"lock resource being migrated\",\n\t[DLM_MAXSTATS] = \t\t\"invalid error number\",\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic const char *dlm_errmsgs[] = {\n\t[DLM_NORMAL] = \t\t\t\"request in progress\",\n\t[DLM_GRANTED] = \t\t\"request granted\",\n\t[DLM_DENIED] = \t\t\t\"request denied\",\n\t[DLM_DENIED_NOLOCKS] = \t\t\"request denied, out of system resources\",\n\t[DLM_WORKING] = \t\t\"async request in progress\",\n\t[DLM_BLOCKED] = \t\t\"lock request blocked\",\n\t[DLM_BLOCKED_ORPHAN] = \t\t\"lock request blocked by a orphan lock\",\n\t[DLM_DENIED_GRACE_PERIOD] = \t\"topological change in progress\",\n\t[DLM_SYSERR] = \t\t\t\"system error\",\n\t[DLM_NOSUPPORT] = \t\t\"unsupported\",\n\t[DLM_CANCELGRANT] = \t\t\"can't cancel convert: already granted\",\n\t[DLM_IVLOCKID] = \t\t\"bad lockid\",\n\t[DLM_SYNC] = \t\t\t\"synchronous request granted\",\n\t[DLM_BADTYPE] = \t\t\"bad resource type\",\n\t[DLM_BADRESOURCE] = \t\t\"bad resource handle\",\n\t[DLM_MAXHANDLES] = \t\t\"no more resource handles\",\n\t[DLM_NOCLINFO] = \t\t\"can't contact cluster manager\",\n\t[DLM_NOLOCKMGR] = \t\t\"can't contact lock manager\",\n\t[DLM_NOPURGED] = \t\t\"can't contact purge daemon\",\n\t[DLM_BADARGS] = \t\t\"bad api args\",\n\t[DLM_VOID] = \t\t\t\"no status\",\n\t[DLM_NOTQUEUED] = \t\t\"NOQUEUE was specified and request failed\",\n\t[DLM_IVBUFLEN] = \t\t\"invalid resource name length\",\n\t[DLM_CVTUNGRANT] = \t\t\"attempted to convert ungranted lock\",\n\t[DLM_BADPARAM] = \t\t\"invalid lock mode specified\",\n\t[DLM_VALNOTVALID] = \t\t\"value block has been invalidated\",\n\t[DLM_REJECTED] = \t\t\"request rejected, unrecognized client\",\n\t[DLM_ABORT] = \t\t\t\"blocked lock request cancelled\",\n\t[DLM_CANCEL] = \t\t\t\"conversion request cancelled\",\n\t[DLM_IVRESHANDLE] = \t\t\"invalid resource handle\",\n\t[DLM_DEADLOCK] = \t\t\"deadlock recovery refused this request\",\n\t[DLM_DENIED_NOASTS] = \t\t\"failed to allocate AST\",\n\t[DLM_FORWARD] = \t\t\"request must wait for primary's response\",\n\t[DLM_TIMEOUT] = \t\t\"timeout value for lock has expired\",\n\t[DLM_IVGROUPID] = \t\t\"invalid group specification\",\n\t[DLM_VERS_CONFLICT] = \t\t\"version conflicts prevent request handling\",\n\t[DLM_BAD_DEVICE_PATH] = \t\"Locks device does not exist or path wrong\",\n\t[DLM_NO_DEVICE_PERMISSION] = \t\"Client has insufficient perms for device\",\n\t[DLM_NO_CONTROL_DEVICE] = \t\"Cannot set options on opened device \",\n\t[DLM_RECOVERING] = \t\t\"lock resource being recovered\",\n\t[DLM_MIGRATING] = \t\t\"lock resource being migrated\",\n\t[DLM_MAXSTATS] = \t\t\"invalid error number\",\n};\n\nconst char *dlm_errmsg(enum dlm_status err)\n{\n\tif (err >= DLM_MAXSTATS || err < 0)\n\t\treturn dlm_errmsgs[DLM_MAXSTATS];\n\treturn dlm_errmsgs[err];\n}"
  },
  {
    "function_name": "dlm_print_one_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "133-136",
    "snippet": "void dlm_print_one_lock(struct dlm_lock *lockid)\n{\n\tdlm_print_one_lock_resource(lockid->lockres);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_print_one_lock_resource",
          "args": [
            "lockid->lockres"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "__dlm_print_one_lock_resource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "97-131",
          "snippet": "void __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nvoid __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_print_one_lock(struct dlm_lock *lockid)\n{\n\tdlm_print_one_lock_resource(lockid->lockres);\n}"
  },
  {
    "function_name": "__dlm_print_one_lock_resource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "97-131",
    "snippet": "void __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__dlm_print_lock",
          "args": [
            "lock"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "__dlm_print_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "74-95",
          "snippet": "static void __dlm_print_lock(struct dlm_lock *lock)\n{\n\tspin_lock(&lock->spinlock);\n\n\tprintk(\"    type=%d, conv=%d, node=%u, cookie=%u:%llu, \"\n\t       \"ref=%u, ast=(empty=%c,pend=%c), bast=(empty=%c,pend=%c), \"\n\t       \"pending=(conv=%c,lock=%c,cancel=%c,unlock=%c)\\n\",\n\t       lock->ml.type, lock->ml.convert_type, lock->ml.node,\n\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t       atomic_read(&lock->lock_refs.refcount),\n\t       (list_empty(&lock->ast_list) ? 'y' : 'n'),\n\t       (lock->ast_pending ? 'y' : 'n'),\n\t       (list_empty(&lock->bast_list) ? 'y' : 'n'),\n\t       (lock->bast_pending ? 'y' : 'n'),\n\t       (lock->convert_pending ? 'y' : 'n'),\n\t       (lock->lock_pending ? 'y' : 'n'),\n\t       (lock->cancel_pending ? 'y' : 'n'),\n\t       (lock->unlock_pending ? 'y' : 'n'));\n\n\tspin_unlock(&lock->spinlock);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void __dlm_print_lock(struct dlm_lock *lock)\n{\n\tspin_lock(&lock->spinlock);\n\n\tprintk(\"    type=%d, conv=%d, node=%u, cookie=%u:%llu, \"\n\t       \"ref=%u, ast=(empty=%c,pend=%c), bast=(empty=%c,pend=%c), \"\n\t       \"pending=(conv=%c,lock=%c,cancel=%c,unlock=%c)\\n\",\n\t       lock->ml.type, lock->ml.convert_type, lock->ml.node,\n\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t       atomic_read(&lock->lock_refs.refcount),\n\t       (list_empty(&lock->ast_list) ? 'y' : 'n'),\n\t       (lock->ast_pending ? 'y' : 'n'),\n\t       (list_empty(&lock->bast_list) ? 'y' : 'n'),\n\t       (lock->bast_pending ? 'y' : 'n'),\n\t       (lock->convert_pending ? 'y' : 'n'),\n\t       (lock->lock_pending ? 'y' : 'n'),\n\t       (lock->cancel_pending ? 'y' : 'n'),\n\t       (lock->unlock_pending ? 'y' : 'n'));\n\n\tspin_unlock(&lock->spinlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->blocked",
            "list"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"  blocked queue:\\n\""
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->converting",
            "list"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "lock",
            "&res->granted",
            "list"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_print_lockres_refmap",
          "args": [
            "res"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_print_lockres_refmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "57-72",
          "snippet": "static void dlm_print_lockres_refmap(struct dlm_lock_resource *res)\n{\n\tint bit;\n\tassert_spin_locked(&res->spinlock);\n\n\tprintk(\"  refmap nodes: [ \");\n\tbit = 0;\n\twhile (1) {\n\t\tbit = find_next_bit(res->refmap, O2NM_MAX_NODES, bit);\n\t\tif (bit >= O2NM_MAX_NODES)\n\t\t\tbreak;\n\t\tprintk(\"%u \", bit);\n\t\tbit++;\n\t}\n\tprintk(\"], inflight=%u\\n\", res->inflight_locks);\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_print_lockres_refmap(struct dlm_lock_resource *res)\n{\n\tint bit;\n\tassert_spin_locked(&res->spinlock);\n\n\tprintk(\"  refmap nodes: [ \");\n\tbit = 0;\n\twhile (1) {\n\t\tbit = find_next_bit(res->refmap, O2NM_MAX_NODES, bit);\n\t\tif (bit >= O2NM_MAX_NODES)\n\t\t\tbreak;\n\t\tprintk(\"%u \", bit);\n\t\tbit++;\n\t}\n\tprintk(\"], inflight=%u\\n\", res->inflight_locks);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&res->asts_reserved"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&res->recovering"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&res->refs.refcount"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stringify_lockname",
          "args": [
            "res->lockname.name",
            "res->lockname.len",
            "buf",
            "sizeof(buf)"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "stringify_lockname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "251-269",
          "snippet": "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define OCFS2_DENTRY_LOCK_INO_START\t18"
          ],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len)\n{\n\tint out = 0;\n\t__be64 inode_blkno_be;\n\n#define OCFS2_DENTRY_LOCK_INO_START\t18\n\tif (*lockname == 'N') {\n\t\tmemcpy((__be64 *)&inode_blkno_be,\n\t\t       (char *)&lockname[OCFS2_DENTRY_LOCK_INO_START],\n\t\t       sizeof(__be64));\n\t\tout += snprintf(buf + out, len - out, \"%.*s%08x\",\n\t\t\t\tOCFS2_DENTRY_LOCK_INO_START - 1, lockname,\n\t\t\t\t(unsigned int)be64_to_cpu(inode_blkno_be));\n\t} else\n\t\tout += snprintf(buf + out, len - out, \"%.*s\",\n\t\t\t\tlocklen, lockname);\n\treturn out;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&res->spinlock"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nvoid __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}"
  },
  {
    "function_name": "__dlm_print_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "74-95",
    "snippet": "static void __dlm_print_lock(struct dlm_lock *lock)\n{\n\tspin_lock(&lock->spinlock);\n\n\tprintk(\"    type=%d, conv=%d, node=%u, cookie=%u:%llu, \"\n\t       \"ref=%u, ast=(empty=%c,pend=%c), bast=(empty=%c,pend=%c), \"\n\t       \"pending=(conv=%c,lock=%c,cancel=%c,unlock=%c)\\n\",\n\t       lock->ml.type, lock->ml.convert_type, lock->ml.node,\n\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t       atomic_read(&lock->lock_refs.refcount),\n\t       (list_empty(&lock->ast_list) ? 'y' : 'n'),\n\t       (lock->ast_pending ? 'y' : 'n'),\n\t       (list_empty(&lock->bast_list) ? 'y' : 'n'),\n\t       (lock->bast_pending ? 'y' : 'n'),\n\t       (lock->convert_pending ? 'y' : 'n'),\n\t       (lock->lock_pending ? 'y' : 'n'),\n\t       (lock->cancel_pending ? 'y' : 'n'),\n\t       (lock->unlock_pending ? 'y' : 'n'));\n\n\tspin_unlock(&lock->spinlock);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lock->spinlock"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"    type=%d, conv=%d, node=%u, cookie=%u:%llu, \"\n\t       \"ref=%u, ast=(empty=%c,pend=%c), bast=(empty=%c,pend=%c), \"\n\t       \"pending=(conv=%c,lock=%c,cancel=%c,unlock=%c)\\n\"",
            "lock->ml.type",
            "lock->ml.convert_type",
            "lock->ml.node",
            "dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie))",
            "dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie))",
            "atomic_read(&lock->lock_refs.refcount)",
            "(list_empty(&lock->ast_list) ? 'y' : 'n')",
            "(lock->ast_pending ? 'y' : 'n')",
            "(list_empty(&lock->bast_list) ? 'y' : 'n')",
            "(lock->bast_pending ? 'y' : 'n')",
            "(lock->convert_pending ? 'y' : 'n')",
            "(lock->lock_pending ? 'y' : 'n')",
            "(lock->cancel_pending ? 'y' : 'n')",
            "(lock->unlock_pending ? 'y' : 'n')"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&lock->bast_list"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&lock->lock_refs.refcount"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_get_lock_cookie_seq",
          "args": [
            "be64_to_cpu(lock->ml.cookie)"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_get_lock_cookie_seq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "821-826",
          "snippet": "static inline unsigned long long dlm_get_lock_cookie_seq(u64 cookie)\n{\n\tunsigned long long ret;\n\tret = ((unsigned long long)cookie) & 0x00ffffffffffffffULL;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\nstatic inline unsigned long long dlm_get_lock_cookie_seq(u64 cookie)\n{\n\tunsigned long long ret;\n\tret = ((unsigned long long)cookie) & 0x00ffffffffffffffULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "lock->ml.cookie"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dlm_get_lock_cookie_node",
          "args": [
            "be64_to_cpu(lock->ml.cookie)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_get_lock_cookie_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmcommon.h",
          "lines": "813-819",
          "snippet": "static inline u8 dlm_get_lock_cookie_node(u64 cookie)\n{\n\tu8 ret;\n\tcookie >>= 56;\n\tret = (u8)(cookie & 0xffULL);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kref.h>\n\nstatic inline u8 dlm_get_lock_cookie_node(u64 cookie)\n{\n\tu8 ret;\n\tcookie >>= 56;\n\tret = (u8)(cookie & 0xffULL);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "lock->ml.cookie"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lock->spinlock"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void __dlm_print_lock(struct dlm_lock *lock)\n{\n\tspin_lock(&lock->spinlock);\n\n\tprintk(\"    type=%d, conv=%d, node=%u, cookie=%u:%llu, \"\n\t       \"ref=%u, ast=(empty=%c,pend=%c), bast=(empty=%c,pend=%c), \"\n\t       \"pending=(conv=%c,lock=%c,cancel=%c,unlock=%c)\\n\",\n\t       lock->ml.type, lock->ml.convert_type, lock->ml.node,\n\t       dlm_get_lock_cookie_node(be64_to_cpu(lock->ml.cookie)),\n\t       dlm_get_lock_cookie_seq(be64_to_cpu(lock->ml.cookie)),\n\t       atomic_read(&lock->lock_refs.refcount),\n\t       (list_empty(&lock->ast_list) ? 'y' : 'n'),\n\t       (lock->ast_pending ? 'y' : 'n'),\n\t       (list_empty(&lock->bast_list) ? 'y' : 'n'),\n\t       (lock->bast_pending ? 'y' : 'n'),\n\t       (lock->convert_pending ? 'y' : 'n'),\n\t       (lock->lock_pending ? 'y' : 'n'),\n\t       (lock->cancel_pending ? 'y' : 'n'),\n\t       (lock->unlock_pending ? 'y' : 'n'));\n\n\tspin_unlock(&lock->spinlock);\n}"
  },
  {
    "function_name": "dlm_print_lockres_refmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "57-72",
    "snippet": "static void dlm_print_lockres_refmap(struct dlm_lock_resource *res)\n{\n\tint bit;\n\tassert_spin_locked(&res->spinlock);\n\n\tprintk(\"  refmap nodes: [ \");\n\tbit = 0;\n\twhile (1) {\n\t\tbit = find_next_bit(res->refmap, O2NM_MAX_NODES, bit);\n\t\tif (bit >= O2NM_MAX_NODES)\n\t\t\tbreak;\n\t\tprintk(\"%u \", bit);\n\t\tbit++;\n\t}\n\tprintk(\"], inflight=%u\\n\", res->inflight_locks);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"], inflight=%u\\n\"",
            "res->inflight_locks"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "res->refmap",
            "O2NM_MAX_NODES",
            "bit"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "mb_find_next_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/mballoc.c",
          "lines": "427-438",
          "snippet": "static inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/log2.h>",
            "#include \"mballoc.h\"",
            "#include \"ext4_jbd2.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/log2.h>\n#include \"mballoc.h\"\n#include \"ext4_jbd2.h\"\n\nstatic inline int mb_find_next_bit(void *addr, int max, int start)\n{\n\tint fix = 0, ret, tmpmax;\n\taddr = mb_correct_addr_and_bit(&fix, addr);\n\ttmpmax = max + fix;\n\tstart += fix;\n\n\tret = ext4_find_next_bit(addr, tmpmax, start) - fix;\n\tif (ret > max)\n\t\treturn max;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&res->spinlock"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void dlm_print_lockres_refmap(struct dlm_lock_resource *res)\n{\n\tint bit;\n\tassert_spin_locked(&res->spinlock);\n\n\tprintk(\"  refmap nodes: [ \");\n\tbit = 0;\n\twhile (1) {\n\t\tbit = find_next_bit(res->refmap, O2NM_MAX_NODES, bit);\n\t\tif (bit >= O2NM_MAX_NODES)\n\t\t\tbreak;\n\t\tprintk(\"%u \", bit);\n\t\tbit++;\n\t}\n\tprintk(\"], inflight=%u\\n\", res->inflight_locks);\n}"
  },
  {
    "function_name": "dlm_print_one_lock_resource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
    "lines": "50-55",
    "snippet": "void dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tspin_lock(&res->spinlock);\n\t__dlm_print_one_lock_resource(res);\n\tspin_unlock(&res->spinlock);\n}",
    "includes": [
      "#include \"cluster/masklog.h\"",
      "#include \"dlmdebug.h\"",
      "#include \"dlmdomain.h\"",
      "#include \"dlmcommon.h\"",
      "#include \"dlmapi.h\"",
      "#include \"cluster/tcp.h\"",
      "#include \"cluster/nodemanager.h\"",
      "#include \"cluster/heartbeat.h\"",
      "#include <linux/export.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/highmem.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&res->spinlock"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__dlm_print_one_lock_resource",
          "args": [
            "res"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "__dlm_print_one_lock_resource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmdebug.c",
          "lines": "97-131",
          "snippet": "void __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdebug.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/export.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic int stringify_lockname(const char *lockname, int locklen, char *buf,\n\t\t\t      int len);\n\nvoid __dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tstruct dlm_lock *lock;\n\tchar buf[DLM_LOCKID_NAME_MAX];\n\n\tassert_spin_locked(&res->spinlock);\n\n\tstringify_lockname(res->lockname.name, res->lockname.len,\n\t\t\t   buf, sizeof(buf));\n\tprintk(\"lockres: %s, owner=%u, state=%u\\n\",\n\t       buf, res->owner, res->state);\n\tprintk(\"  last used: %lu, refcnt: %u, on purge list: %s\\n\",\n\t       res->last_used, atomic_read(&res->refs.refcount),\n\t       list_empty(&res->purge) ? \"no\" : \"yes\");\n\tprintk(\"  on dirty list: %s, on reco list: %s, \"\n\t       \"migrating pending: %s\\n\",\n\t       list_empty(&res->dirty) ? \"no\" : \"yes\",\n\t       list_empty(&res->recovering) ? \"no\" : \"yes\",\n\t       res->migration_pending ? \"yes\" : \"no\");\n\tprintk(\"  inflight locks: %d, asts reserved: %d\\n\",\n\t       res->inflight_locks, atomic_read(&res->asts_reserved));\n\tdlm_print_lockres_refmap(res);\n\tprintk(\"  granted queue:\\n\");\n\tlist_for_each_entry(lock, &res->granted, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  converting queue:\\n\");\n\tlist_for_each_entry(lock, &res->converting, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n\tprintk(\"  blocked queue:\\n\");\n\tlist_for_each_entry(lock, &res->blocked, list) {\n\t\t__dlm_print_lock(lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&res->spinlock"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdebug.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/export.h>\n#include <linux/debugfs.h>\n#include <linux/spinlock.h>\n#include <linux/sysctl.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid dlm_print_one_lock_resource(struct dlm_lock_resource *res)\n{\n\tspin_lock(&res->spinlock);\n\t__dlm_print_one_lock_resource(res);\n\tspin_unlock(&res->spinlock);\n}"
  }
]