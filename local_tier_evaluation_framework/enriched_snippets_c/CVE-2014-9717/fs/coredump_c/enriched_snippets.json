[
  {
    "function_name": "dump_align",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "744-750",
    "snippet": "int dump_align(struct coredump_params *cprm, int align)\n{\n\tunsigned mod = cprm->written & (align - 1);\n\tif (align & (align - 1))\n\t\treturn 0;\n\treturn mod ? dump_skip(cprm, align - mod) : 1;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_skip",
          "args": [
            "cprm",
            "align - mod"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "dump_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "721-741",
          "snippet": "int dump_skip(struct coredump_params *cprm, size_t nr)\n{\n\tstatic char zeroes[PAGE_SIZE];\n\tstruct file *file = cprm->file;\n\tif (file->f_op->llseek && file->f_op->llseek != no_llseek) {\n\t\tif (cprm->written + nr > cprm->limit)\n\t\t\treturn 0;\n\t\tif (dump_interrupted() ||\n\t\t    file->f_op->llseek(file, nr, SEEK_CUR) < 0)\n\t\t\treturn 0;\n\t\tcprm->written += nr;\n\t\treturn 1;\n\t} else {\n\t\twhile (nr > PAGE_SIZE) {\n\t\t\tif (!dump_emit(cprm, zeroes, PAGE_SIZE))\n\t\t\t\treturn 0;\n\t\t\tnr -= PAGE_SIZE;\n\t\t}\n\t\treturn dump_emit(cprm, zeroes, nr);\n\t}\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint dump_skip(struct coredump_params *cprm, size_t nr)\n{\n\tstatic char zeroes[PAGE_SIZE];\n\tstruct file *file = cprm->file;\n\tif (file->f_op->llseek && file->f_op->llseek != no_llseek) {\n\t\tif (cprm->written + nr > cprm->limit)\n\t\t\treturn 0;\n\t\tif (dump_interrupted() ||\n\t\t    file->f_op->llseek(file, nr, SEEK_CUR) < 0)\n\t\t\treturn 0;\n\t\tcprm->written += nr;\n\t\treturn 1;\n\t} else {\n\t\twhile (nr > PAGE_SIZE) {\n\t\t\tif (!dump_emit(cprm, zeroes, PAGE_SIZE))\n\t\t\t\treturn 0;\n\t\t\tnr -= PAGE_SIZE;\n\t\t}\n\t\treturn dump_emit(cprm, zeroes, nr);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint dump_align(struct coredump_params *cprm, int align)\n{\n\tunsigned mod = cprm->written & (align - 1);\n\tif (align & (align - 1))\n\t\treturn 0;\n\treturn mod ? dump_skip(cprm, align - mod) : 1;\n}"
  },
  {
    "function_name": "dump_skip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "721-741",
    "snippet": "int dump_skip(struct coredump_params *cprm, size_t nr)\n{\n\tstatic char zeroes[PAGE_SIZE];\n\tstruct file *file = cprm->file;\n\tif (file->f_op->llseek && file->f_op->llseek != no_llseek) {\n\t\tif (cprm->written + nr > cprm->limit)\n\t\t\treturn 0;\n\t\tif (dump_interrupted() ||\n\t\t    file->f_op->llseek(file, nr, SEEK_CUR) < 0)\n\t\t\treturn 0;\n\t\tcprm->written += nr;\n\t\treturn 1;\n\t} else {\n\t\twhile (nr > PAGE_SIZE) {\n\t\t\tif (!dump_emit(cprm, zeroes, PAGE_SIZE))\n\t\t\t\treturn 0;\n\t\t\tnr -= PAGE_SIZE;\n\t\t}\n\t\treturn dump_emit(cprm, zeroes, nr);\n\t}\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_emit",
          "args": [
            "cprm",
            "zeroes",
            "nr"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_emit",
          "args": [
            "cprm",
            "zeroes",
            "PAGE_SIZE"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->f_op->llseek",
          "args": [
            "file",
            "nr",
            "SEEK_CUR"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_interrupted",
          "args": [],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint dump_skip(struct coredump_params *cprm, size_t nr)\n{\n\tstatic char zeroes[PAGE_SIZE];\n\tstruct file *file = cprm->file;\n\tif (file->f_op->llseek && file->f_op->llseek != no_llseek) {\n\t\tif (cprm->written + nr > cprm->limit)\n\t\t\treturn 0;\n\t\tif (dump_interrupted() ||\n\t\t    file->f_op->llseek(file, nr, SEEK_CUR) < 0)\n\t\t\treturn 0;\n\t\tcprm->written += nr;\n\t\treturn 1;\n\t} else {\n\t\twhile (nr > PAGE_SIZE) {\n\t\t\tif (!dump_emit(cprm, zeroes, PAGE_SIZE))\n\t\t\t\treturn 0;\n\t\t\tnr -= PAGE_SIZE;\n\t\t}\n\t\treturn dump_emit(cprm, zeroes, nr);\n\t}\n}"
  },
  {
    "function_name": "format_corename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "160-274",
    "snippet": "static int format_corename(struct core_name *cn, struct coredump_params *cprm)\n{\n\tconst struct cred *cred = current_cred();\n\tconst char *pat_ptr = core_pattern;\n\tint ispipe = (*pat_ptr == '|');\n\tint pid_in_pattern = 0;\n\tint err = 0;\n\n\tcn->used = 0;\n\tcn->corename = NULL;\n\tif (expand_corename(cn, core_name_size))\n\t\treturn -ENOMEM;\n\tcn->corename[0] = '\\0';\n\n\tif (ispipe)\n\t\t++pat_ptr;\n\n\t/* Repeat as long as we have more pattern to process and more output\n\t   space */\n\twhile (*pat_ptr) {\n\t\tif (*pat_ptr != '%') {\n\t\t\terr = cn_printf(cn, \"%c\", *pat_ptr++);\n\t\t} else {\n\t\t\tswitch (*++pat_ptr) {\n\t\t\t/* single % at the end, drop that */\n\t\t\tcase 0:\n\t\t\t\tgoto out;\n\t\t\t/* Double percent, output one percent */\n\t\t\tcase '%':\n\t\t\t\terr = cn_printf(cn, \"%c\", '%');\n\t\t\t\tbreak;\n\t\t\t/* pid */\n\t\t\tcase 'p':\n\t\t\t\tpid_in_pattern = 1;\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_tgid_vnr(current));\n\t\t\t\tbreak;\n\t\t\t/* global pid */\n\t\t\tcase 'P':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_tgid_nr(current));\n\t\t\t\tbreak;\n\t\t\tcase 'i':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_pid_vnr(current));\n\t\t\t\tbreak;\n\t\t\tcase 'I':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_pid_nr(current));\n\t\t\t\tbreak;\n\t\t\t/* uid */\n\t\t\tcase 'u':\n\t\t\t\terr = cn_printf(cn, \"%d\", cred->uid);\n\t\t\t\tbreak;\n\t\t\t/* gid */\n\t\t\tcase 'g':\n\t\t\t\terr = cn_printf(cn, \"%d\", cred->gid);\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t__get_dumpable(cprm->mm_flags));\n\t\t\t\tbreak;\n\t\t\t/* signal that caused the coredump */\n\t\t\tcase 's':\n\t\t\t\terr = cn_printf(cn, \"%ld\", cprm->siginfo->si_signo);\n\t\t\t\tbreak;\n\t\t\t/* UNIX time of coredump */\n\t\t\tcase 't': {\n\t\t\t\tstruct timeval tv;\n\t\t\t\tdo_gettimeofday(&tv);\n\t\t\t\terr = cn_printf(cn, \"%lu\", tv.tv_sec);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* hostname */\n\t\t\tcase 'h':\n\t\t\t\tdown_read(&uts_sem);\n\t\t\t\terr = cn_esc_printf(cn, \"%s\",\n\t\t\t\t\t      utsname()->nodename);\n\t\t\t\tup_read(&uts_sem);\n\t\t\t\tbreak;\n\t\t\t/* executable */\n\t\t\tcase 'e':\n\t\t\t\terr = cn_esc_printf(cn, \"%s\", current->comm);\n\t\t\t\tbreak;\n\t\t\tcase 'E':\n\t\t\t\terr = cn_print_exe_file(cn);\n\t\t\t\tbreak;\n\t\t\t/* core limit size */\n\t\t\tcase 'c':\n\t\t\t\terr = cn_printf(cn, \"%lu\",\n\t\t\t\t\t      rlimit(RLIMIT_CORE));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t++pat_ptr;\n\t\t}\n\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\nout:\n\t/* Backward compatibility with core_uses_pid:\n\t *\n\t * If core_pattern does not include a %p (as is the default)\n\t * and core_uses_pid is set, then .%pid will be appended to\n\t * the filename. Do not do this for piped commands. */\n\tif (!ispipe && !pid_in_pattern && core_uses_pid) {\n\t\terr = cn_printf(cn, \".%d\", task_tgid_vnr(current));\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn ispipe;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int core_uses_pid;",
      "char core_pattern[CORENAME_MAX_SIZE] = \"core\";",
      "static int core_name_size = CORENAME_MAX_SIZE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cn_printf",
          "args": [
            "cn",
            "\".%d\"",
            "task_tgid_vnr(current)"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "cn_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "96-106",
          "snippet": "static int cn_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_tgid_vnr",
          "args": [
            "current"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rlimit",
          "args": [
            "RLIMIT_CORE"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cn_print_exe_file",
          "args": [
            "cn"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "cn_print_exe_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "125-154",
          "snippet": "static int cn_print_exe_file(struct core_name *cn)\n{\n\tstruct file *exe_file;\n\tchar *pathbuf, *path;\n\tint ret;\n\n\texe_file = get_mm_exe_file(current->mm);\n\tif (!exe_file)\n\t\treturn cn_esc_printf(cn, \"%s (path unknown)\", current->comm);\n\n\tpathbuf = kmalloc(PATH_MAX, GFP_TEMPORARY);\n\tif (!pathbuf) {\n\t\tret = -ENOMEM;\n\t\tgoto put_exe_file;\n\t}\n\n\tpath = d_path(&exe_file->f_path, pathbuf, PATH_MAX);\n\tif (IS_ERR(path)) {\n\t\tret = PTR_ERR(path);\n\t\tgoto free_buf;\n\t}\n\n\tret = cn_esc_printf(cn, \"%s\", path);\n\nfree_buf:\n\tkfree(pathbuf);\nput_exe_file:\n\tfput(exe_file);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_print_exe_file(struct core_name *cn)\n{\n\tstruct file *exe_file;\n\tchar *pathbuf, *path;\n\tint ret;\n\n\texe_file = get_mm_exe_file(current->mm);\n\tif (!exe_file)\n\t\treturn cn_esc_printf(cn, \"%s (path unknown)\", current->comm);\n\n\tpathbuf = kmalloc(PATH_MAX, GFP_TEMPORARY);\n\tif (!pathbuf) {\n\t\tret = -ENOMEM;\n\t\tgoto put_exe_file;\n\t}\n\n\tpath = d_path(&exe_file->f_path, pathbuf, PATH_MAX);\n\tif (IS_ERR(path)) {\n\t\tret = PTR_ERR(path);\n\t\tgoto free_buf;\n\t}\n\n\tret = cn_esc_printf(cn, \"%s\", path);\n\nfree_buf:\n\tkfree(pathbuf);\nput_exe_file:\n\tfput(exe_file);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cn_esc_printf",
          "args": [
            "cn",
            "\"%s\"",
            "current->comm"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "cn_esc_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "108-123",
          "snippet": "static int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&uts_sem"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utsname",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&uts_sem"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_gettimeofday",
          "args": [
            "&tv"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_dumpable",
          "args": [
            "cprm->mm_flags"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "current"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_vnr",
          "args": [
            "current"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_tgid_nr",
          "args": [
            "current"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_tgid_vnr",
          "args": [
            "current"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "expand_corename",
          "args": [
            "cn",
            "core_name_size"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "expand_corename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "58-71",
          "snippet": "static int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int core_name_size = CORENAME_MAX_SIZE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int core_name_size = CORENAME_MAX_SIZE;\n\nstatic int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nint core_uses_pid;\nchar core_pattern[CORENAME_MAX_SIZE] = \"core\";\nstatic int core_name_size = CORENAME_MAX_SIZE;\n\nstatic int format_corename(struct core_name *cn, struct coredump_params *cprm)\n{\n\tconst struct cred *cred = current_cred();\n\tconst char *pat_ptr = core_pattern;\n\tint ispipe = (*pat_ptr == '|');\n\tint pid_in_pattern = 0;\n\tint err = 0;\n\n\tcn->used = 0;\n\tcn->corename = NULL;\n\tif (expand_corename(cn, core_name_size))\n\t\treturn -ENOMEM;\n\tcn->corename[0] = '\\0';\n\n\tif (ispipe)\n\t\t++pat_ptr;\n\n\t/* Repeat as long as we have more pattern to process and more output\n\t   space */\n\twhile (*pat_ptr) {\n\t\tif (*pat_ptr != '%') {\n\t\t\terr = cn_printf(cn, \"%c\", *pat_ptr++);\n\t\t} else {\n\t\t\tswitch (*++pat_ptr) {\n\t\t\t/* single % at the end, drop that */\n\t\t\tcase 0:\n\t\t\t\tgoto out;\n\t\t\t/* Double percent, output one percent */\n\t\t\tcase '%':\n\t\t\t\terr = cn_printf(cn, \"%c\", '%');\n\t\t\t\tbreak;\n\t\t\t/* pid */\n\t\t\tcase 'p':\n\t\t\t\tpid_in_pattern = 1;\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_tgid_vnr(current));\n\t\t\t\tbreak;\n\t\t\t/* global pid */\n\t\t\tcase 'P':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_tgid_nr(current));\n\t\t\t\tbreak;\n\t\t\tcase 'i':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_pid_vnr(current));\n\t\t\t\tbreak;\n\t\t\tcase 'I':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t      task_pid_nr(current));\n\t\t\t\tbreak;\n\t\t\t/* uid */\n\t\t\tcase 'u':\n\t\t\t\terr = cn_printf(cn, \"%d\", cred->uid);\n\t\t\t\tbreak;\n\t\t\t/* gid */\n\t\t\tcase 'g':\n\t\t\t\terr = cn_printf(cn, \"%d\", cred->gid);\n\t\t\t\tbreak;\n\t\t\tcase 'd':\n\t\t\t\terr = cn_printf(cn, \"%d\",\n\t\t\t\t\t__get_dumpable(cprm->mm_flags));\n\t\t\t\tbreak;\n\t\t\t/* signal that caused the coredump */\n\t\t\tcase 's':\n\t\t\t\terr = cn_printf(cn, \"%ld\", cprm->siginfo->si_signo);\n\t\t\t\tbreak;\n\t\t\t/* UNIX time of coredump */\n\t\t\tcase 't': {\n\t\t\t\tstruct timeval tv;\n\t\t\t\tdo_gettimeofday(&tv);\n\t\t\t\terr = cn_printf(cn, \"%lu\", tv.tv_sec);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* hostname */\n\t\t\tcase 'h':\n\t\t\t\tdown_read(&uts_sem);\n\t\t\t\terr = cn_esc_printf(cn, \"%s\",\n\t\t\t\t\t      utsname()->nodename);\n\t\t\t\tup_read(&uts_sem);\n\t\t\t\tbreak;\n\t\t\t/* executable */\n\t\t\tcase 'e':\n\t\t\t\terr = cn_esc_printf(cn, \"%s\", current->comm);\n\t\t\t\tbreak;\n\t\t\tcase 'E':\n\t\t\t\terr = cn_print_exe_file(cn);\n\t\t\t\tbreak;\n\t\t\t/* core limit size */\n\t\t\tcase 'c':\n\t\t\t\terr = cn_printf(cn, \"%lu\",\n\t\t\t\t\t      rlimit(RLIMIT_CORE));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t++pat_ptr;\n\t\t}\n\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\nout:\n\t/* Backward compatibility with core_uses_pid:\n\t *\n\t * If core_pattern does not include a %p (as is the default)\n\t * and core_uses_pid is set, then .%pid will be appended to\n\t * the filename. Do not do this for piped commands. */\n\tif (!ispipe && !pid_in_pattern && core_uses_pid) {\n\t\terr = cn_printf(cn, \".%d\", task_tgid_vnr(current));\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn ispipe;\n}"
  },
  {
    "function_name": "cn_print_exe_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "125-154",
    "snippet": "static int cn_print_exe_file(struct core_name *cn)\n{\n\tstruct file *exe_file;\n\tchar *pathbuf, *path;\n\tint ret;\n\n\texe_file = get_mm_exe_file(current->mm);\n\tif (!exe_file)\n\t\treturn cn_esc_printf(cn, \"%s (path unknown)\", current->comm);\n\n\tpathbuf = kmalloc(PATH_MAX, GFP_TEMPORARY);\n\tif (!pathbuf) {\n\t\tret = -ENOMEM;\n\t\tgoto put_exe_file;\n\t}\n\n\tpath = d_path(&exe_file->f_path, pathbuf, PATH_MAX);\n\tif (IS_ERR(path)) {\n\t\tret = PTR_ERR(path);\n\t\tgoto free_buf;\n\t}\n\n\tret = cn_esc_printf(cn, \"%s\", path);\n\nfree_buf:\n\tkfree(pathbuf);\nput_exe_file:\n\tfput(exe_file);\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fput",
          "args": [
            "exe_file"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "__fput_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/file_table.c",
          "lines": "293-300",
          "snippet": "void __fput_sync(struct file *file)\n{\n\tif (atomic_long_dec_and_test(&file->f_count)) {\n\t\tstruct task_struct *task = current;\n\t\tBUG_ON(!(task->flags & PF_KTHREAD));\n\t\t__fput(file);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <linux/ima.h>",
            "#include <linux/task_work.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/percpu.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/lglock.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/cdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/mount.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/eventpoll.h>",
            "#include <linux/security.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/atomic.h>\n#include <linux/ima.h>\n#include <linux/task_work.h>\n#include <linux/hardirq.h>\n#include <linux/percpu.h>\n#include <linux/percpu_counter.h>\n#include <linux/lglock.h>\n#include <linux/sysctl.h>\n#include <linux/fsnotify.h>\n#include <linux/cdev.h>\n#include <linux/capability.h>\n#include <linux/mount.h>\n#include <linux/rcupdate.h>\n#include <linux/eventpoll.h>\n#include <linux/security.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n\nvoid __fput_sync(struct file *file)\n{\n\tif (atomic_long_dec_and_test(&file->f_count)) {\n\t\tstruct task_struct *task = current;\n\t\tBUG_ON(!(task->flags & PF_KTHREAD));\n\t\t__fput(file);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pathbuf"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cn_esc_printf",
          "args": [
            "cn",
            "\"%s\"",
            "path"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "cn_esc_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "108-123",
          "snippet": "static int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "path"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "path"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_path",
          "args": [
            "&exe_file->f_path",
            "pathbuf",
            "PATH_MAX"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "d_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "3047-3076",
          "snippet": "char *d_path(const struct path *path, char *buf, int buflen)\n{\n\tchar *res = buf + buflen;\n\tstruct path root;\n\tint error;\n\n\t/*\n\t * We have various synthetic filesystems that never get mounted.  On\n\t * these filesystems dentries are never used for lookup purposes, and\n\t * thus don't need to be hashed.  They also don't need a name until a\n\t * user wants to identify the object in /proc/pid/fd/.  The little hack\n\t * below allows us to generate a name for these objects on demand:\n\t *\n\t * Some pseudo inodes are mountable.  When they are mounted\n\t * path->dentry == path->mnt->mnt_root.  In that case don't call d_dname\n\t * and instead have d_path return the mounted path.\n\t */\n\tif (path->dentry->d_op && path->dentry->d_op->d_dname &&\n\t    (!IS_ROOT(path->dentry) || path->dentry != path->mnt->mnt_root))\n\t\treturn path->dentry->d_op->d_dname(path->dentry, buf, buflen);\n\n\trcu_read_lock();\n\tget_fs_root_rcu(current->fs, &root);\n\terror = path_with_deleted(path, &root, &res, &buflen);\n\trcu_read_unlock();\n\n\tif (error < 0)\n\t\tres = ERR_PTR(error);\n\treturn res;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nchar *d_path(const struct path *path, char *buf, int buflen)\n{\n\tchar *res = buf + buflen;\n\tstruct path root;\n\tint error;\n\n\t/*\n\t * We have various synthetic filesystems that never get mounted.  On\n\t * these filesystems dentries are never used for lookup purposes, and\n\t * thus don't need to be hashed.  They also don't need a name until a\n\t * user wants to identify the object in /proc/pid/fd/.  The little hack\n\t * below allows us to generate a name for these objects on demand:\n\t *\n\t * Some pseudo inodes are mountable.  When they are mounted\n\t * path->dentry == path->mnt->mnt_root.  In that case don't call d_dname\n\t * and instead have d_path return the mounted path.\n\t */\n\tif (path->dentry->d_op && path->dentry->d_op->d_dname &&\n\t    (!IS_ROOT(path->dentry) || path->dentry != path->mnt->mnt_root))\n\t\treturn path->dentry->d_op->d_dname(path->dentry, buf, buflen);\n\n\trcu_read_lock();\n\tget_fs_root_rcu(current->fs, &root);\n\terror = path_with_deleted(path, &root, &res, &buflen);\n\trcu_read_unlock();\n\n\tif (error < 0)\n\t\tres = ERR_PTR(error);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PATH_MAX",
            "GFP_TEMPORARY"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_mm_exe_file",
          "args": [
            "current->mm"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_print_exe_file(struct core_name *cn)\n{\n\tstruct file *exe_file;\n\tchar *pathbuf, *path;\n\tint ret;\n\n\texe_file = get_mm_exe_file(current->mm);\n\tif (!exe_file)\n\t\treturn cn_esc_printf(cn, \"%s (path unknown)\", current->comm);\n\n\tpathbuf = kmalloc(PATH_MAX, GFP_TEMPORARY);\n\tif (!pathbuf) {\n\t\tret = -ENOMEM;\n\t\tgoto put_exe_file;\n\t}\n\n\tpath = d_path(&exe_file->f_path, pathbuf, PATH_MAX);\n\tif (IS_ERR(path)) {\n\t\tret = PTR_ERR(path);\n\t\tgoto free_buf;\n\t}\n\n\tret = cn_esc_printf(cn, \"%s\", path);\n\nfree_buf:\n\tkfree(pathbuf);\nput_exe_file:\n\tfput(exe_file);\n\treturn ret;\n}"
  },
  {
    "function_name": "cn_esc_printf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "108-123",
    "snippet": "static int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cn_vprintf",
          "args": [
            "cn",
            "fmt",
            "arg"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "cn_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "73-94",
          "snippet": "static int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg",
            "fmt"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_esc_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tint cur = cn->used;\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\tfor (; cur < cn->used; ++cur) {\n\t\tif (cn->corename[cur] == '/')\n\t\t\tcn->corename[cur] = '!';\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "cn_printf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "96-106",
    "snippet": "static int cn_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cn_vprintf",
          "args": [
            "cn",
            "fmt",
            "arg"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "cn_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "73-94",
          "snippet": "static int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "arg",
            "fmt"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_printf(struct core_name *cn, const char *fmt, ...)\n{\n\tva_list arg;\n\tint ret;\n\n\tva_start(arg, fmt);\n\tret = cn_vprintf(cn, fmt, arg);\n\tva_end(arg);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "cn_vprintf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "73-94",
    "snippet": "static int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "expand_corename",
          "args": [
            "cn",
            "cn->size + need - free + 1"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "expand_corename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
          "lines": "58-71",
          "snippet": "static int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/exec.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/coredump.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int core_name_size = CORENAME_MAX_SIZE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int core_name_size = CORENAME_MAX_SIZE;\n\nstatic int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "arg_copy"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "cn->corename + cn->used",
            "free",
            "fmt",
            "arg_copy"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_copy",
          "args": [
            "arg_copy",
            "arg"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int cn_vprintf(struct core_name *cn, const char *fmt, va_list arg)\n{\n\tint free, need;\n\tva_list arg_copy;\n\nagain:\n\tfree = cn->size - cn->used;\n\n\tva_copy(arg_copy, arg);\n\tneed = vsnprintf(cn->corename + cn->used, free, fmt, arg_copy);\n\tva_end(arg_copy);\n\n\tif (need < free) {\n\t\tcn->used += need;\n\t\treturn 0;\n\t}\n\n\tif (!expand_corename(cn, cn->size + need - free + 1))\n\t\tgoto again;\n\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "expand_corename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/coredump.c",
    "lines": "58-71",
    "snippet": "static int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/sched.h>",
      "#include \"internal.h\"",
      "#include <trace/events/task.h>",
      "#include <asm/exec.h>",
      "#include <asm/tlb.h>",
      "#include <asm/mmu_context.h>",
      "#include <asm/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/oom.h>",
      "#include <linux/pipe_fs_i.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/fsnotify.h>",
      "#include <linux/kmod.h>",
      "#include <linux/tracehook.h>",
      "#include <linux/audit.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/tsacct_kern.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/security.h>",
      "#include <linux/mount.h>",
      "#include <linux/namei.h>",
      "#include <linux/module.h>",
      "#include <linux/pid_namespace.h>",
      "#include <linux/utsname.h>",
      "#include <linux/coredump.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/personality.h>",
      "#include <linux/key.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/highmem.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/init.h>",
      "#include <linux/string.h>",
      "#include <linux/swap.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/stat.h>",
      "#include <linux/mm.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/file.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int core_name_size = CORENAME_MAX_SIZE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ksize",
          "args": [
            "corename"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krealloc",
          "args": [
            "cn->corename",
            "size",
            "GFP_KERNEL"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/exec.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/coredump.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic int core_name_size = CORENAME_MAX_SIZE;\n\nstatic int expand_corename(struct core_name *cn, int size)\n{\n\tchar *corename = krealloc(cn->corename, size, GFP_KERNEL);\n\n\tif (!corename)\n\t\treturn -ENOMEM;\n\n\tif (size > core_name_size) /* racy but harmless */\n\t\tcore_name_size = size;\n\n\tcn->size = ksize(corename);\n\tcn->corename = corename;\n\treturn 0;\n}"
  }
]