[
  {
    "function_name": "exit_nlm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "639-648",
    "snippet": "static void __exit exit_nlm(void)\n{\n\t/* FIXME: delete all NLM clients */\n\tnlm_shutdown_hosts();\n\tlockd_remove_procfs();\n\tunregister_pernet_subsys(&lockd_net_ops);\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(nlm_sysctl_table);\n#endif\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pernet_operations lockd_net_ops = {\n\t.init = lockd_init_net,\n\t.exit = lockd_exit_net,\n\t.id = &lockd_net_id,\n\t.size = sizeof(struct lockd_net),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_sysctl_table",
          "args": [
            "nlm_sysctl_table"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&lockd_net_ops"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockd_remove_procfs",
          "args": [],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_remove_procfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/procfs.h",
          "lines": "21-25",
          "snippet": "static inline void\nlockd_remove_procfs(void)\n{\n\treturn;\n}",
          "includes": [
            "#include <linux/kconfig.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kconfig.h>\n\nstatic inline void\nlockd_remove_procfs(void)\n{\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlm_shutdown_hosts",
          "args": [],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "nlm_shutdown_hosts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/host.c",
          "lines": "627-632",
          "snippet": "void\nnlm_shutdown_hosts(void)\n{\n\tdprintk(\"lockd: shutting down host module\\n\");\n\tnlm_shutdown_hosts_net(NULL);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <net/ipv6.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <net/ipv6.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/mutex.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid\nnlm_shutdown_hosts(void)\n{\n\tdprintk(\"lockd: shutting down host module\\n\");\n\tnlm_shutdown_hosts_net(NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct pernet_operations lockd_net_ops = {\n\t.init = lockd_init_net,\n\t.exit = lockd_exit_net,\n\t.id = &lockd_net_id,\n\t.size = sizeof(struct lockd_net),\n};\n\nstatic void __exit exit_nlm(void)\n{\n\t/* FIXME: delete all NLM clients */\n\tnlm_shutdown_hosts();\n\tlockd_remove_procfs();\n\tunregister_pernet_subsys(&lockd_net_ops);\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(nlm_sysctl_table);\n#endif\n}"
  },
  {
    "function_name": "init_nlm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "609-637",
    "snippet": "static int __init init_nlm(void)\n{\n\tint err;\n\n#ifdef CONFIG_SYSCTL\n\terr = -ENOMEM;\n\tnlm_sysctl_table = register_sysctl_table(nlm_sysctl_root);\n\tif (nlm_sysctl_table == NULL)\n\t\tgoto err_sysctl;\n#endif\n\terr = register_pernet_subsys(&lockd_net_ops);\n\tif (err)\n\t\tgoto err_pernet;\n\n\terr = lockd_create_procfs();\n\tif (err)\n\t\tgoto err_procfs;\n\n\treturn 0;\n\nerr_procfs:\n\tunregister_pernet_subsys(&lockd_net_ops);\nerr_pernet:\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(nlm_sysctl_table);\nerr_sysctl:\n#endif\n\treturn err;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pernet_operations lockd_net_ops = {\n\t.init = lockd_init_net,\n\t.exit = lockd_exit_net,\n\t.id = &lockd_net_id,\n\t.size = sizeof(struct lockd_net),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_pernet_subsys",
          "args": [
            "&lockd_net_ops"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockd_create_procfs",
          "args": [],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_create_procfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/procfs.h",
          "lines": "15-19",
          "snippet": "static inline int\nlockd_create_procfs(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/kconfig.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kconfig.h>\n\nstatic inline int\nlockd_create_procfs(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_pernet_subsys",
          "args": [
            "&lockd_net_ops"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "nlm_sysctl_root"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct pernet_operations lockd_net_ops = {\n\t.init = lockd_init_net,\n\t.exit = lockd_exit_net,\n\t.id = &lockd_net_id,\n\t.size = sizeof(struct lockd_net),\n};\n\nstatic int __init init_nlm(void)\n{\n\tint err;\n\n#ifdef CONFIG_SYSCTL\n\terr = -ENOMEM;\n\tnlm_sysctl_table = register_sysctl_table(nlm_sysctl_root);\n\tif (nlm_sysctl_table == NULL)\n\t\tgoto err_sysctl;\n#endif\n\terr = register_pernet_subsys(&lockd_net_ops);\n\tif (err)\n\t\tgoto err_pernet;\n\n\terr = lockd_create_procfs();\n\tif (err)\n\t\tgoto err_procfs;\n\n\treturn 0;\n\nerr_procfs:\n\tunregister_pernet_subsys(&lockd_net_ops);\nerr_pernet:\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(nlm_sysctl_table);\nerr_sysctl:\n#endif\n\treturn err;\n}"
  },
  {
    "function_name": "lockd_exit_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "593-595",
    "snippet": "static void lockd_exit_net(struct net *net)\n{\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void lockd_exit_net(struct net *net)\n{\n}"
  },
  {
    "function_name": "lockd_init_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "583-591",
    "snippet": "static int lockd_init_net(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tINIT_DELAYED_WORK(&ln->grace_period_end, grace_ender);\n\tINIT_LIST_HEAD(&ln->lockd_manager.list);\n\tspin_lock_init(&ln->nsm_clnt_lock);\n\treturn 0;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int lockd_net_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&ln->nsm_clnt_lock"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ln->lockd_manager.list"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&ln->grace_period_end",
            "grace_ender"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint lockd_net_id;\n\nstatic int lockd_init_net(struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tINIT_DELAYED_WORK(&ln->grace_period_end, grace_ender);\n\tINIT_LIST_HEAD(&ln->lockd_manager.list);\n\tspin_lock_init(&ln->nsm_clnt_lock);\n\treturn 0;\n}"
  },
  {
    "function_name": "lockd_authenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "542-559",
    "snippet": "static int lockd_authenticate(struct svc_rqst *rqstp)\n{\n\trqstp->rq_client = NULL;\n\tswitch (rqstp->rq_authop->flavour) {\n\t\tcase RPC_AUTH_NULL:\n\t\tcase RPC_AUTH_UNIX:\n\t\t\tif (rqstp->rq_proc == 0)\n\t\t\t\treturn SVC_OK;\n\t\t\tif (is_callback(rqstp->rq_proc)) {\n\t\t\t\t/* Leave it to individual procedures to\n\t\t\t\t * call nlmsvc_lookup_host(rqstp)\n\t\t\t\t */\n\t\t\t\treturn SVC_OK;\n\t\t\t}\n\t\t\treturn svc_set_client(rqstp);\n\t}\n\treturn SVC_DENIED;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_set_client",
          "args": [
            "rqstp"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_callback",
          "args": [
            "rqstp->rq_proc"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "is_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "530-539",
          "snippet": "static inline int is_callback(u32 proc)\n{\n\treturn proc == NLMPROC_GRANTED\n\t\t|| proc == NLMPROC_GRANTED_MSG\n\t\t|| proc == NLMPROC_TEST_RES\n\t\t|| proc == NLMPROC_LOCK_RES\n\t\t|| proc == NLMPROC_CANCEL_RES\n\t\t|| proc == NLMPROC_UNLOCK_RES\n\t\t|| proc == NLMPROC_NSM_NOTIFY;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic inline int is_callback(u32 proc)\n{\n\treturn proc == NLMPROC_GRANTED\n\t\t|| proc == NLMPROC_GRANTED_MSG\n\t\t|| proc == NLMPROC_TEST_RES\n\t\t|| proc == NLMPROC_LOCK_RES\n\t\t|| proc == NLMPROC_CANCEL_RES\n\t\t|| proc == NLMPROC_UNLOCK_RES\n\t\t|| proc == NLMPROC_NSM_NOTIFY;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int lockd_authenticate(struct svc_rqst *rqstp)\n{\n\trqstp->rq_client = NULL;\n\tswitch (rqstp->rq_authop->flavour) {\n\t\tcase RPC_AUTH_NULL:\n\t\tcase RPC_AUTH_UNIX:\n\t\t\tif (rqstp->rq_proc == 0)\n\t\t\t\treturn SVC_OK;\n\t\t\tif (is_callback(rqstp->rq_proc)) {\n\t\t\t\t/* Leave it to individual procedures to\n\t\t\t\t * call nlmsvc_lookup_host(rqstp)\n\t\t\t\t */\n\t\t\t\treturn SVC_OK;\n\t\t\t}\n\t\t\treturn svc_set_client(rqstp);\n\t}\n\treturn SVC_DENIED;\n}"
  },
  {
    "function_name": "is_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "530-539",
    "snippet": "static inline int is_callback(u32 proc)\n{\n\treturn proc == NLMPROC_GRANTED\n\t\t|| proc == NLMPROC_GRANTED_MSG\n\t\t|| proc == NLMPROC_TEST_RES\n\t\t|| proc == NLMPROC_LOCK_RES\n\t\t|| proc == NLMPROC_CANCEL_RES\n\t\t|| proc == NLMPROC_UNLOCK_RES\n\t\t|| proc == NLMPROC_NSM_NOTIFY;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic inline int is_callback(u32 proc)\n{\n\treturn proc == NLMPROC_GRANTED\n\t\t|| proc == NLMPROC_GRANTED_MSG\n\t\t|| proc == NLMPROC_TEST_RES\n\t\t|| proc == NLMPROC_LOCK_RES\n\t\t|| proc == NLMPROC_CANCEL_RES\n\t\t|| proc == NLMPROC_UNLOCK_RES\n\t\t|| proc == NLMPROC_NSM_NOTIFY;\n}"
  },
  {
    "function_name": "lockd_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "406-432",
    "snippet": "void\nlockd_down(struct net *net)\n{\n\tmutex_lock(&nlmsvc_mutex);\n\tlockd_down_net(nlmsvc_rqst->rq_server, net);\n\tif (nlmsvc_users) {\n\t\tif (--nlmsvc_users)\n\t\t\tgoto out;\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down: no users! task=%p\\n\",\n\t\t\tnlmsvc_task);\n\t\tBUG();\n\t}\n\n\tif (!nlmsvc_task) {\n\t\tprintk(KERN_ERR \"lockd_down: no lockd running.\\n\");\n\t\tBUG();\n\t}\n\tkthread_stop(nlmsvc_task);\n\tdprintk(\"lockd_down: service stopped\\n\");\n\tsvc_exit_thread(nlmsvc_rqst);\n\tdprintk(\"lockd_down: service destroyed\\n\");\n\tnlmsvc_task = NULL;\n\tnlmsvc_rqst = NULL;\nout:\n\tmutex_unlock(&nlmsvc_mutex);\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(nlmsvc_mutex);",
      "static unsigned int\t\tnlmsvc_users;",
      "static struct task_struct\t*nlmsvc_task;",
      "static struct svc_rqst\t\t*nlmsvc_rqst;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&nlmsvc_mutex"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_down: service destroyed\\n\""
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_exit_thread",
          "args": [
            "nlmsvc_rqst"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_down: service stopped\\n\""
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_stop",
          "args": [
            "nlmsvc_task"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"lockd_down: no lockd running.\\n\""
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockd_down_net",
          "args": [
            "nlmsvc_rqst->rq_server",
            "net"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_down_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "263-280",
          "snippet": "static void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int\t\tnlmsvc_users;",
            "static struct task_struct\t*nlmsvc_task;",
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct task_struct\t*nlmsvc_task;\nint lockd_net_id;\n\nstatic void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&nlmsvc_mutex"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_MUTEX(nlmsvc_mutex);\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct task_struct\t*nlmsvc_task;\nstatic struct svc_rqst\t\t*nlmsvc_rqst;\n\nvoid\nlockd_down(struct net *net)\n{\n\tmutex_lock(&nlmsvc_mutex);\n\tlockd_down_net(nlmsvc_rqst->rq_server, net);\n\tif (nlmsvc_users) {\n\t\tif (--nlmsvc_users)\n\t\t\tgoto out;\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down: no users! task=%p\\n\",\n\t\t\tnlmsvc_task);\n\t\tBUG();\n\t}\n\n\tif (!nlmsvc_task) {\n\t\tprintk(KERN_ERR \"lockd_down: no lockd running.\\n\");\n\t\tBUG();\n\t}\n\tkthread_stop(nlmsvc_task);\n\tdprintk(\"lockd_down: service stopped\\n\");\n\tsvc_exit_thread(nlmsvc_rqst);\n\tdprintk(\"lockd_down: service destroyed\\n\");\n\tnlmsvc_task = NULL;\n\tnlmsvc_rqst = NULL;\nout:\n\tmutex_unlock(&nlmsvc_mutex);\n}"
  },
  {
    "function_name": "lockd_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "365-400",
    "snippet": "int lockd_up(struct net *net)\n{\n\tstruct svc_serv *serv;\n\tint error;\n\n\tmutex_lock(&nlmsvc_mutex);\n\n\tserv = lockd_create_svc();\n\tif (IS_ERR(serv)) {\n\t\terror = PTR_ERR(serv);\n\t\tgoto err_create;\n\t}\n\n\terror = lockd_up_net(serv, net);\n\tif (error < 0)\n\t\tgoto err_net;\n\n\terror = lockd_start_svc(serv);\n\tif (error < 0)\n\t\tgoto err_start;\n\n\tnlmsvc_users++;\n\t/*\n\t * Note: svc_serv structures have an initial use count of 1,\n\t * so we exit through here on both success and failure.\n\t */\nerr_net:\n\tsvc_destroy(serv);\nerr_create:\n\tmutex_unlock(&nlmsvc_mutex);\n\treturn error;\n\nerr_start:\n\tlockd_down_net(serv, net);\n\tgoto err_net;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(nlmsvc_mutex);",
      "static unsigned int\t\tnlmsvc_users;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockd_down_net",
          "args": [
            "serv",
            "net"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_down_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "263-280",
          "snippet": "static void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int\t\tnlmsvc_users;",
            "static struct task_struct\t*nlmsvc_task;",
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct task_struct\t*nlmsvc_task;\nint lockd_net_id;\n\nstatic void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&nlmsvc_mutex"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_destroy",
          "args": [
            "serv"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockd_start_svc",
          "args": [
            "serv"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_start_svc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "282-323",
          "snippet": "static int lockd_start_svc(struct svc_serv *serv)\n{\n\tint error;\n\n\tif (nlmsvc_rqst)\n\t\treturn 0;\n\n\t/*\n\t * Create the kernel thread and wait for it to start.\n\t */\n\tnlmsvc_rqst = svc_prepare_thread(serv, &serv->sv_pools[0], NUMA_NO_NODE);\n\tif (IS_ERR(nlmsvc_rqst)) {\n\t\terror = PTR_ERR(nlmsvc_rqst);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: svc_rqst allocation failed, error=%d\\n\",\n\t\t\terror);\n\t\tgoto out_rqst;\n\t}\n\n\tsvc_sock_update_bufs(serv);\n\tserv->sv_maxconn = nlm_max_connections;\n\n\tnlmsvc_task = kthread_create(lockd, nlmsvc_rqst, \"%s\", serv->sv_name);\n\tif (IS_ERR(nlmsvc_task)) {\n\t\terror = PTR_ERR(nlmsvc_task);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: kthread_run failed, error=%d\\n\", error);\n\t\tgoto out_task;\n\t}\n\tnlmsvc_rqst->rq_task = nlmsvc_task;\n\twake_up_process(nlmsvc_task);\n\n\tdprintk(\"lockd_up: service started\\n\");\n\treturn 0;\n\nout_task:\n\tsvc_exit_thread(nlmsvc_rqst);\n\tnlmsvc_task = NULL;\nout_rqst:\n\tnlmsvc_rqst = NULL;\n\treturn error;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct task_struct\t*nlmsvc_task;",
            "static struct svc_rqst\t\t*nlmsvc_rqst;",
            "static unsigned int\t\tnlm_max_connections = 1024;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct task_struct\t*nlmsvc_task;\nstatic struct svc_rqst\t\t*nlmsvc_rqst;\nstatic unsigned int\t\tnlm_max_connections = 1024;\n\nstatic int lockd_start_svc(struct svc_serv *serv)\n{\n\tint error;\n\n\tif (nlmsvc_rqst)\n\t\treturn 0;\n\n\t/*\n\t * Create the kernel thread and wait for it to start.\n\t */\n\tnlmsvc_rqst = svc_prepare_thread(serv, &serv->sv_pools[0], NUMA_NO_NODE);\n\tif (IS_ERR(nlmsvc_rqst)) {\n\t\terror = PTR_ERR(nlmsvc_rqst);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: svc_rqst allocation failed, error=%d\\n\",\n\t\t\terror);\n\t\tgoto out_rqst;\n\t}\n\n\tsvc_sock_update_bufs(serv);\n\tserv->sv_maxconn = nlm_max_connections;\n\n\tnlmsvc_task = kthread_create(lockd, nlmsvc_rqst, \"%s\", serv->sv_name);\n\tif (IS_ERR(nlmsvc_task)) {\n\t\terror = PTR_ERR(nlmsvc_task);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: kthread_run failed, error=%d\\n\", error);\n\t\tgoto out_task;\n\t}\n\tnlmsvc_rqst->rq_task = nlmsvc_task;\n\twake_up_process(nlmsvc_task);\n\n\tdprintk(\"lockd_up: service started\\n\");\n\treturn 0;\n\nout_task:\n\tsvc_exit_thread(nlmsvc_rqst);\n\tnlmsvc_task = NULL;\nout_rqst:\n\tnlmsvc_rqst = NULL;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockd_up_net",
          "args": [
            "serv",
            "net"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_up_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "239-261",
          "snippet": "static int lockd_up_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tint error;\n\n\tif (ln->nlmsvc_users++)\n\t\treturn 0;\n\n\terror = svc_bind(serv, net);\n\tif (error)\n\t\tgoto err_bind;\n\n\terror = make_socks(serv, net);\n\tif (error < 0)\n\t\tgoto err_bind;\n\tset_grace_period(net);\n\tdprintk(\"lockd_up_net: per-net data created; net=%p\\n\", net);\n\treturn 0;\n\nerr_bind:\n\tln->nlmsvc_users--;\n\treturn error;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int\t\tnlmsvc_users;",
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned int\t\tnlmsvc_users;\nint lockd_net_id;\n\nstatic int lockd_up_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tint error;\n\n\tif (ln->nlmsvc_users++)\n\t\treturn 0;\n\n\terror = svc_bind(serv, net);\n\tif (error)\n\t\tgoto err_bind;\n\n\terror = make_socks(serv, net);\n\tif (error < 0)\n\t\tgoto err_bind;\n\tset_grace_period(net);\n\tdprintk(\"lockd_up_net: per-net data created; net=%p\\n\", net);\n\treturn 0;\n\nerr_bind:\n\tln->nlmsvc_users--;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "serv"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "serv"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockd_create_svc",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "lockd_create_svc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "325-360",
          "snippet": "static struct svc_serv *lockd_create_svc(void)\n{\n\tstruct svc_serv *serv;\n\n\t/*\n\t * Check whether we're already up and running.\n\t */\n\tif (nlmsvc_rqst) {\n\t\t/*\n\t\t * Note: increase service usage, because later in case of error\n\t\t * svc_destroy() will be called.\n\t\t */\n\t\tsvc_get(nlmsvc_rqst->rq_server);\n\t\treturn nlmsvc_rqst->rq_server;\n\t}\n\n\t/*\n\t * Sanity check: if there's no pid,\n\t * we should be the first user ...\n\t */\n\tif (nlmsvc_users)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: no pid, %d users??\\n\", nlmsvc_users);\n\n\tif (!nlm_timeout)\n\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\tnlmsvc_timeout = nlm_timeout * HZ;\n\n\tserv = svc_create(&nlmsvc_program, LOCKD_BUFSIZE, svc_rpcb_cleanup);\n\tif (!serv) {\n\t\tprintk(KERN_WARNING \"lockd_up: create service failed\\n\");\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tdprintk(\"lockd_up: service created\\n\");\n\treturn serv;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define LOCKD_BUFSIZE\t\t(1024 + NLMSVC_XDRSIZE)"
          ],
          "globals_used": [
            "static struct svc_program\tnlmsvc_program;",
            "static unsigned int\t\tnlmsvc_users;",
            "static struct svc_rqst\t\t*nlmsvc_rqst;",
            "unsigned long\t\t\tnlmsvc_timeout;",
            "static unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;",
            "static struct svc_program\tnlmsvc_program = {\n\t.pg_prog\t\t= NLM_PROGRAM,\t\t/* program number */\n\t.pg_nvers\t\t= NLM_NRVERS,\t\t/* number of entries in nlmsvc_version */\n\t.pg_vers\t\t= nlmsvc_version,\t/* version table */\n\t.pg_name\t\t= \"lockd\",\t\t/* service name */\n\t.pg_class\t\t= \"nfsd\",\t\t/* share authentication with nfsd */\n\t.pg_stats\t\t= &nlmsvc_stats,\t/* stats table */\n\t.pg_authenticate = &lockd_authenticate\t/* export authentication */\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define LOCKD_BUFSIZE\t\t(1024 + NLMSVC_XDRSIZE)\n\nstatic struct svc_program\tnlmsvc_program;\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct svc_rqst\t\t*nlmsvc_rqst;\nunsigned long\t\t\tnlmsvc_timeout;\nstatic unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\nstatic struct svc_program\tnlmsvc_program = {\n\t.pg_prog\t\t= NLM_PROGRAM,\t\t/* program number */\n\t.pg_nvers\t\t= NLM_NRVERS,\t\t/* number of entries in nlmsvc_version */\n\t.pg_vers\t\t= nlmsvc_version,\t/* version table */\n\t.pg_name\t\t= \"lockd\",\t\t/* service name */\n\t.pg_class\t\t= \"nfsd\",\t\t/* share authentication with nfsd */\n\t.pg_stats\t\t= &nlmsvc_stats,\t/* stats table */\n\t.pg_authenticate = &lockd_authenticate\t/* export authentication */\n};\n\nstatic struct svc_serv *lockd_create_svc(void)\n{\n\tstruct svc_serv *serv;\n\n\t/*\n\t * Check whether we're already up and running.\n\t */\n\tif (nlmsvc_rqst) {\n\t\t/*\n\t\t * Note: increase service usage, because later in case of error\n\t\t * svc_destroy() will be called.\n\t\t */\n\t\tsvc_get(nlmsvc_rqst->rq_server);\n\t\treturn nlmsvc_rqst->rq_server;\n\t}\n\n\t/*\n\t * Sanity check: if there's no pid,\n\t * we should be the first user ...\n\t */\n\tif (nlmsvc_users)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: no pid, %d users??\\n\", nlmsvc_users);\n\n\tif (!nlm_timeout)\n\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\tnlmsvc_timeout = nlm_timeout * HZ;\n\n\tserv = svc_create(&nlmsvc_program, LOCKD_BUFSIZE, svc_rpcb_cleanup);\n\tif (!serv) {\n\t\tprintk(KERN_WARNING \"lockd_up: create service failed\\n\");\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tdprintk(\"lockd_up: service created\\n\");\n\treturn serv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&nlmsvc_mutex"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic DEFINE_MUTEX(nlmsvc_mutex);\nstatic unsigned int\t\tnlmsvc_users;\n\nint lockd_up(struct net *net)\n{\n\tstruct svc_serv *serv;\n\tint error;\n\n\tmutex_lock(&nlmsvc_mutex);\n\n\tserv = lockd_create_svc();\n\tif (IS_ERR(serv)) {\n\t\terror = PTR_ERR(serv);\n\t\tgoto err_create;\n\t}\n\n\terror = lockd_up_net(serv, net);\n\tif (error < 0)\n\t\tgoto err_net;\n\n\terror = lockd_start_svc(serv);\n\tif (error < 0)\n\t\tgoto err_start;\n\n\tnlmsvc_users++;\n\t/*\n\t * Note: svc_serv structures have an initial use count of 1,\n\t * so we exit through here on both success and failure.\n\t */\nerr_net:\n\tsvc_destroy(serv);\nerr_create:\n\tmutex_unlock(&nlmsvc_mutex);\n\treturn error;\n\nerr_start:\n\tlockd_down_net(serv, net);\n\tgoto err_net;\n}"
  },
  {
    "function_name": "lockd_create_svc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "325-360",
    "snippet": "static struct svc_serv *lockd_create_svc(void)\n{\n\tstruct svc_serv *serv;\n\n\t/*\n\t * Check whether we're already up and running.\n\t */\n\tif (nlmsvc_rqst) {\n\t\t/*\n\t\t * Note: increase service usage, because later in case of error\n\t\t * svc_destroy() will be called.\n\t\t */\n\t\tsvc_get(nlmsvc_rqst->rq_server);\n\t\treturn nlmsvc_rqst->rq_server;\n\t}\n\n\t/*\n\t * Sanity check: if there's no pid,\n\t * we should be the first user ...\n\t */\n\tif (nlmsvc_users)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: no pid, %d users??\\n\", nlmsvc_users);\n\n\tif (!nlm_timeout)\n\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\tnlmsvc_timeout = nlm_timeout * HZ;\n\n\tserv = svc_create(&nlmsvc_program, LOCKD_BUFSIZE, svc_rpcb_cleanup);\n\tif (!serv) {\n\t\tprintk(KERN_WARNING \"lockd_up: create service failed\\n\");\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tdprintk(\"lockd_up: service created\\n\");\n\treturn serv;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define LOCKD_BUFSIZE\t\t(1024 + NLMSVC_XDRSIZE)"
    ],
    "globals_used": [
      "static struct svc_program\tnlmsvc_program;",
      "static unsigned int\t\tnlmsvc_users;",
      "static struct svc_rqst\t\t*nlmsvc_rqst;",
      "unsigned long\t\t\tnlmsvc_timeout;",
      "static unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;",
      "static struct svc_program\tnlmsvc_program = {\n\t.pg_prog\t\t= NLM_PROGRAM,\t\t/* program number */\n\t.pg_nvers\t\t= NLM_NRVERS,\t\t/* number of entries in nlmsvc_version */\n\t.pg_vers\t\t= nlmsvc_version,\t/* version table */\n\t.pg_name\t\t= \"lockd\",\t\t/* service name */\n\t.pg_class\t\t= \"nfsd\",\t\t/* share authentication with nfsd */\n\t.pg_stats\t\t= &nlmsvc_stats,\t/* stats table */\n\t.pg_authenticate = &lockd_authenticate\t/* export authentication */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_up: service created\\n\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"lockd_up: create service failed\\n\""
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "svc_create",
          "args": [
            "&nlmsvc_program",
            "LOCKD_BUFSIZE",
            "svc_rpcb_cleanup"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_get",
          "args": [
            "nlmsvc_rqst->rq_server"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\n#define LOCKD_BUFSIZE\t\t(1024 + NLMSVC_XDRSIZE)\n\nstatic struct svc_program\tnlmsvc_program;\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct svc_rqst\t\t*nlmsvc_rqst;\nunsigned long\t\t\tnlmsvc_timeout;\nstatic unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\nstatic struct svc_program\tnlmsvc_program = {\n\t.pg_prog\t\t= NLM_PROGRAM,\t\t/* program number */\n\t.pg_nvers\t\t= NLM_NRVERS,\t\t/* number of entries in nlmsvc_version */\n\t.pg_vers\t\t= nlmsvc_version,\t/* version table */\n\t.pg_name\t\t= \"lockd\",\t\t/* service name */\n\t.pg_class\t\t= \"nfsd\",\t\t/* share authentication with nfsd */\n\t.pg_stats\t\t= &nlmsvc_stats,\t/* stats table */\n\t.pg_authenticate = &lockd_authenticate\t/* export authentication */\n};\n\nstatic struct svc_serv *lockd_create_svc(void)\n{\n\tstruct svc_serv *serv;\n\n\t/*\n\t * Check whether we're already up and running.\n\t */\n\tif (nlmsvc_rqst) {\n\t\t/*\n\t\t * Note: increase service usage, because later in case of error\n\t\t * svc_destroy() will be called.\n\t\t */\n\t\tsvc_get(nlmsvc_rqst->rq_server);\n\t\treturn nlmsvc_rqst->rq_server;\n\t}\n\n\t/*\n\t * Sanity check: if there's no pid,\n\t * we should be the first user ...\n\t */\n\tif (nlmsvc_users)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: no pid, %d users??\\n\", nlmsvc_users);\n\n\tif (!nlm_timeout)\n\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\tnlmsvc_timeout = nlm_timeout * HZ;\n\n\tserv = svc_create(&nlmsvc_program, LOCKD_BUFSIZE, svc_rpcb_cleanup);\n\tif (!serv) {\n\t\tprintk(KERN_WARNING \"lockd_up: create service failed\\n\");\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tdprintk(\"lockd_up: service created\\n\");\n\treturn serv;\n}"
  },
  {
    "function_name": "lockd_start_svc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "282-323",
    "snippet": "static int lockd_start_svc(struct svc_serv *serv)\n{\n\tint error;\n\n\tif (nlmsvc_rqst)\n\t\treturn 0;\n\n\t/*\n\t * Create the kernel thread and wait for it to start.\n\t */\n\tnlmsvc_rqst = svc_prepare_thread(serv, &serv->sv_pools[0], NUMA_NO_NODE);\n\tif (IS_ERR(nlmsvc_rqst)) {\n\t\terror = PTR_ERR(nlmsvc_rqst);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: svc_rqst allocation failed, error=%d\\n\",\n\t\t\terror);\n\t\tgoto out_rqst;\n\t}\n\n\tsvc_sock_update_bufs(serv);\n\tserv->sv_maxconn = nlm_max_connections;\n\n\tnlmsvc_task = kthread_create(lockd, nlmsvc_rqst, \"%s\", serv->sv_name);\n\tif (IS_ERR(nlmsvc_task)) {\n\t\terror = PTR_ERR(nlmsvc_task);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: kthread_run failed, error=%d\\n\", error);\n\t\tgoto out_task;\n\t}\n\tnlmsvc_rqst->rq_task = nlmsvc_task;\n\twake_up_process(nlmsvc_task);\n\n\tdprintk(\"lockd_up: service started\\n\");\n\treturn 0;\n\nout_task:\n\tsvc_exit_thread(nlmsvc_rqst);\n\tnlmsvc_task = NULL;\nout_rqst:\n\tnlmsvc_rqst = NULL;\n\treturn error;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct task_struct\t*nlmsvc_task;",
      "static struct svc_rqst\t\t*nlmsvc_rqst;",
      "static unsigned int\t\tnlm_max_connections = 1024;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_exit_thread",
          "args": [
            "nlmsvc_rqst"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_up: service started\\n\""
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_process",
          "args": [
            "nlmsvc_task"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t\t\"lockd_up: kthread_run failed, error=%d\\n\"",
            "error"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nlmsvc_task"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nlmsvc_task"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_create",
          "args": [
            "lockd",
            "nlmsvc_rqst",
            "\"%s\"",
            "serv->sv_name"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_sock_update_bufs",
          "args": [
            "serv"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nlmsvc_rqst"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nlmsvc_rqst"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_prepare_thread",
          "args": [
            "serv",
            "&serv->sv_pools[0]",
            "NUMA_NO_NODE"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic struct task_struct\t*nlmsvc_task;\nstatic struct svc_rqst\t\t*nlmsvc_rqst;\nstatic unsigned int\t\tnlm_max_connections = 1024;\n\nstatic int lockd_start_svc(struct svc_serv *serv)\n{\n\tint error;\n\n\tif (nlmsvc_rqst)\n\t\treturn 0;\n\n\t/*\n\t * Create the kernel thread and wait for it to start.\n\t */\n\tnlmsvc_rqst = svc_prepare_thread(serv, &serv->sv_pools[0], NUMA_NO_NODE);\n\tif (IS_ERR(nlmsvc_rqst)) {\n\t\terror = PTR_ERR(nlmsvc_rqst);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: svc_rqst allocation failed, error=%d\\n\",\n\t\t\terror);\n\t\tgoto out_rqst;\n\t}\n\n\tsvc_sock_update_bufs(serv);\n\tserv->sv_maxconn = nlm_max_connections;\n\n\tnlmsvc_task = kthread_create(lockd, nlmsvc_rqst, \"%s\", serv->sv_name);\n\tif (IS_ERR(nlmsvc_task)) {\n\t\terror = PTR_ERR(nlmsvc_task);\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: kthread_run failed, error=%d\\n\", error);\n\t\tgoto out_task;\n\t}\n\tnlmsvc_rqst->rq_task = nlmsvc_task;\n\twake_up_process(nlmsvc_task);\n\n\tdprintk(\"lockd_up: service started\\n\");\n\treturn 0;\n\nout_task:\n\tsvc_exit_thread(nlmsvc_rqst);\n\tnlmsvc_task = NULL;\nout_rqst:\n\tnlmsvc_rqst = NULL;\n\treturn error;\n}"
  },
  {
    "function_name": "lockd_down_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "263-280",
    "snippet": "static void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int\t\tnlmsvc_users;",
      "static struct task_struct\t*nlmsvc_task;",
      "int lockd_net_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\"",
            "nlmsvc_task",
            "net"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_down_net: per-net data destroyed; net=%p\\n\"",
            "net"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_shutdown_net",
          "args": [
            "serv",
            "net"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locks_end_grace",
          "args": [
            "&ln->lockd_manager"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "locks_end_grace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs_common/grace.c",
          "lines": "49-55",
          "snippet": "void\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <net/netns/generic.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(grace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <net/netns/generic.h>\n#include <net/net_namespace.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(grace_lock);\n\nvoid\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&ln->grace_period_end"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlm_shutdown_hosts_net",
          "args": [
            "net"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "nlm_shutdown_hosts_net",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/host.c",
          "lines": "596-621",
          "snippet": "void\nnlm_shutdown_hosts_net(struct net *net)\n{\n\tstruct hlist_head *chain;\n\tstruct nlm_host\t*host;\n\n\tmutex_lock(&nlm_host_mutex);\n\n\t/* First, make all hosts eligible for gc */\n\tdprintk(\"lockd: nuking all hosts in net %p...\\n\", net);\n\tfor_each_host(host, chain, nlm_server_hosts) {\n\t\tif (net && host->net != net)\n\t\t\tcontinue;\n\t\thost->h_expires = jiffies - 1;\n\t\tif (host->h_rpcclnt) {\n\t\t\trpc_shutdown_client(host->h_rpcclnt);\n\t\t\thost->h_rpcclnt = NULL;\n\t\t}\n\t}\n\n\t/* Then, perform a garbage collection pass */\n\tnlm_gc_hosts(net);\n\tmutex_unlock(&nlm_host_mutex);\n\n\tnlm_complain_hosts(net);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <net/ipv6.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_head\tnlm_server_hosts[NLM_HOST_NRHASH];",
            "static DEFINE_MUTEX(nlm_host_mutex);",
            "static void\t\t\tnlm_gc_hosts(struct net *net);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <net/ipv6.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/mutex.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic struct hlist_head\tnlm_server_hosts[NLM_HOST_NRHASH];\nstatic DEFINE_MUTEX(nlm_host_mutex);\nstatic void\t\t\tnlm_gc_hosts(struct net *net);\n\nvoid\nnlm_shutdown_hosts_net(struct net *net)\n{\n\tstruct hlist_head *chain;\n\tstruct nlm_host\t*host;\n\n\tmutex_lock(&nlm_host_mutex);\n\n\t/* First, make all hosts eligible for gc */\n\tdprintk(\"lockd: nuking all hosts in net %p...\\n\", net);\n\tfor_each_host(host, chain, nlm_server_hosts) {\n\t\tif (net && host->net != net)\n\t\t\tcontinue;\n\t\thost->h_expires = jiffies - 1;\n\t\tif (host->h_rpcclnt) {\n\t\t\trpc_shutdown_client(host->h_rpcclnt);\n\t\t\thost->h_rpcclnt = NULL;\n\t\t}\n\t}\n\n\t/* Then, perform a garbage collection pass */\n\tnlm_gc_hosts(net);\n\tmutex_unlock(&nlm_host_mutex);\n\n\tnlm_complain_hosts(net);\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned int\t\tnlmsvc_users;\nstatic struct task_struct\t*nlmsvc_task;\nint lockd_net_id;\n\nstatic void lockd_down_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tif (ln->nlmsvc_users) {\n\t\tif (--ln->nlmsvc_users == 0) {\n\t\t\tnlm_shutdown_hosts_net(net);\n\t\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\t\tlocks_end_grace(&ln->lockd_manager);\n\t\t\tsvc_shutdown_net(serv, net);\n\t\t\tdprintk(\"lockd_down_net: per-net data destroyed; net=%p\\n\", net);\n\t\t}\n\t} else {\n\t\tprintk(KERN_ERR \"lockd_down_net: no users! task=%p, net=%p\\n\",\n\t\t\t\tnlmsvc_task, net);\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "lockd_up_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "239-261",
    "snippet": "static int lockd_up_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tint error;\n\n\tif (ln->nlmsvc_users++)\n\t\treturn 0;\n\n\terror = svc_bind(serv, net);\n\tif (error)\n\t\tgoto err_bind;\n\n\terror = make_socks(serv, net);\n\tif (error < 0)\n\t\tgoto err_bind;\n\tset_grace_period(net);\n\tdprintk(\"lockd_up_net: per-net data created; net=%p\\n\", net);\n\treturn 0;\n\nerr_bind:\n\tln->nlmsvc_users--;\n\treturn error;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int\t\tnlmsvc_users;",
      "int lockd_net_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd_up_net: per-net data created; net=%p\\n\"",
            "net"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_grace_period",
          "args": [
            "net"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "set_grace_period",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "101-109",
          "snippet": "static void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint lockd_net_id;\n\nstatic void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_socks",
          "args": [
            "serv",
            "net"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "make_socks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "215-237",
          "snippet": "static int make_socks(struct svc_serv *serv, struct net *net)\n{\n\tstatic int warned;\n\tint err;\n\n\terr = create_lockd_family(serv, net, PF_INET);\n\tif (err < 0)\n\t\tgoto out_err;\n\n\terr = create_lockd_family(serv, net, PF_INET6);\n\tif (err < 0 && err != -EAFNOSUPPORT)\n\t\tgoto out_err;\n\n\twarned = 0;\n\treturn 0;\n\nout_err:\n\tif (warned++ == 0)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: makesock failed, error=%d\\n\", err);\n\tsvc_shutdown_net(serv, net);\n\treturn err;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int make_socks(struct svc_serv *serv, struct net *net)\n{\n\tstatic int warned;\n\tint err;\n\n\terr = create_lockd_family(serv, net, PF_INET);\n\tif (err < 0)\n\t\tgoto out_err;\n\n\terr = create_lockd_family(serv, net, PF_INET6);\n\tif (err < 0 && err != -EAFNOSUPPORT)\n\t\tgoto out_err;\n\n\twarned = 0;\n\treturn 0;\n\nout_err:\n\tif (warned++ == 0)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: makesock failed, error=%d\\n\", err);\n\tsvc_shutdown_net(serv, net);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "svc_bind",
          "args": [
            "serv",
            "net"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned int\t\tnlmsvc_users;\nint lockd_net_id;\n\nstatic int lockd_up_net(struct svc_serv *serv, struct net *net)\n{\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\tint error;\n\n\tif (ln->nlmsvc_users++)\n\t\treturn 0;\n\n\terror = svc_bind(serv, net);\n\tif (error)\n\t\tgoto err_bind;\n\n\terror = make_socks(serv, net);\n\tif (error < 0)\n\t\tgoto err_bind;\n\tset_grace_period(net);\n\tdprintk(\"lockd_up_net: per-net data created; net=%p\\n\", net);\n\treturn 0;\n\nerr_bind:\n\tln->nlmsvc_users--;\n\treturn error;\n}"
  },
  {
    "function_name": "make_socks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "215-237",
    "snippet": "static int make_socks(struct svc_serv *serv, struct net *net)\n{\n\tstatic int warned;\n\tint err;\n\n\terr = create_lockd_family(serv, net, PF_INET);\n\tif (err < 0)\n\t\tgoto out_err;\n\n\terr = create_lockd_family(serv, net, PF_INET6);\n\tif (err < 0 && err != -EAFNOSUPPORT)\n\t\tgoto out_err;\n\n\twarned = 0;\n\treturn 0;\n\nout_err:\n\tif (warned++ == 0)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: makesock failed, error=%d\\n\", err);\n\tsvc_shutdown_net(serv, net);\n\treturn err;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_shutdown_net",
          "args": [
            "serv",
            "net"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t\t\"lockd_up: makesock failed, error=%d\\n\"",
            "err"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_lockd_family",
          "args": [
            "serv",
            "net",
            "PF_INET6"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "create_lockd_family",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "193-203",
          "snippet": "static int create_lockd_family(struct svc_serv *serv, struct net *net,\n\t\t\t       const int family)\n{\n\tint err;\n\n\terr = create_lockd_listener(serv, \"udp\", net, family, nlm_udpport);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn create_lockd_listener(serv, \"tcp\", net, family, nlm_tcpport);\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t\t\tnlm_udpport, nlm_tcpport;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int\t\t\tnlm_udpport, nlm_tcpport;\n\nstatic int create_lockd_family(struct svc_serv *serv, struct net *net,\n\t\t\t       const int family)\n{\n\tint err;\n\n\terr = create_lockd_listener(serv, \"udp\", net, family, nlm_udpport);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn create_lockd_listener(serv, \"tcp\", net, family, nlm_tcpport);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int make_socks(struct svc_serv *serv, struct net *net)\n{\n\tstatic int warned;\n\tint err;\n\n\terr = create_lockd_family(serv, net, PF_INET);\n\tif (err < 0)\n\t\tgoto out_err;\n\n\terr = create_lockd_family(serv, net, PF_INET6);\n\tif (err < 0 && err != -EAFNOSUPPORT)\n\t\tgoto out_err;\n\n\twarned = 0;\n\treturn 0;\n\nout_err:\n\tif (warned++ == 0)\n\t\tprintk(KERN_WARNING\n\t\t\t\"lockd_up: makesock failed, error=%d\\n\", err);\n\tsvc_shutdown_net(serv, net);\n\treturn err;\n}"
  },
  {
    "function_name": "create_lockd_family",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "193-203",
    "snippet": "static int create_lockd_family(struct svc_serv *serv, struct net *net,\n\t\t\t       const int family)\n{\n\tint err;\n\n\terr = create_lockd_listener(serv, \"udp\", net, family, nlm_udpport);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn create_lockd_listener(serv, \"tcp\", net, family, nlm_tcpport);\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int\t\t\tnlm_udpport, nlm_tcpport;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "create_lockd_listener",
          "args": [
            "serv",
            "\"tcp\"",
            "net",
            "family",
            "nlm_tcpport"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "create_lockd_listener",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "179-191",
          "snippet": "static int create_lockd_listener(struct svc_serv *serv, const char *name,\n\t\t\t\t struct net *net, const int family,\n\t\t\t\t const unsigned short port)\n{\n\tstruct svc_xprt *xprt;\n\n\txprt = svc_find_xprt(serv, name, net, family, 0);\n\tif (xprt == NULL)\n\t\treturn svc_create_xprt(serv, name, net, family, port,\n\t\t\t\t\t\tSVC_SOCK_DEFAULTS);\n\tsvc_xprt_put(xprt);\n\treturn 0;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int create_lockd_listener(struct svc_serv *serv, const char *name,\n\t\t\t\t struct net *net, const int family,\n\t\t\t\t const unsigned short port)\n{\n\tstruct svc_xprt *xprt;\n\n\txprt = svc_find_xprt(serv, name, net, family, 0);\n\tif (xprt == NULL)\n\t\treturn svc_create_xprt(serv, name, net, family, port,\n\t\t\t\t\t\tSVC_SOCK_DEFAULTS);\n\tsvc_xprt_put(xprt);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int\t\t\tnlm_udpport, nlm_tcpport;\n\nstatic int create_lockd_family(struct svc_serv *serv, struct net *net,\n\t\t\t       const int family)\n{\n\tint err;\n\n\terr = create_lockd_listener(serv, \"udp\", net, family, nlm_udpport);\n\tif (err < 0)\n\t\treturn err;\n\n\treturn create_lockd_listener(serv, \"tcp\", net, family, nlm_tcpport);\n}"
  },
  {
    "function_name": "create_lockd_listener",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "179-191",
    "snippet": "static int create_lockd_listener(struct svc_serv *serv, const char *name,\n\t\t\t\t struct net *net, const int family,\n\t\t\t\t const unsigned short port)\n{\n\tstruct svc_xprt *xprt;\n\n\txprt = svc_find_xprt(serv, name, net, family, 0);\n\tif (xprt == NULL)\n\t\treturn svc_create_xprt(serv, name, net, family, port,\n\t\t\t\t\t\tSVC_SOCK_DEFAULTS);\n\tsvc_xprt_put(xprt);\n\treturn 0;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "svc_xprt_put",
          "args": [
            "xprt"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_create_xprt",
          "args": [
            "serv",
            "name",
            "net",
            "family",
            "port",
            "SVC_SOCK_DEFAULTS"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_find_xprt",
          "args": [
            "serv",
            "name",
            "net",
            "family",
            "0"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int create_lockd_listener(struct svc_serv *serv, const char *name,\n\t\t\t\t struct net *net, const int family,\n\t\t\t\t const unsigned short port)\n{\n\tstruct svc_xprt *xprt;\n\n\txprt = svc_find_xprt(serv, name, net, family, 0);\n\tif (xprt == NULL)\n\t\treturn svc_create_xprt(serv, name, net, family, port,\n\t\t\t\t\t\tSVC_SOCK_DEFAULTS);\n\tsvc_xprt_put(xprt);\n\treturn 0;\n}"
  },
  {
    "function_name": "lockd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "127-177",
    "snippet": "static int\nlockd(void *vrqstp)\n{\n\tint\t\terr = 0;\n\tstruct svc_rqst *rqstp = vrqstp;\n\n\t/* try_to_freeze() is called from svc_recv() */\n\tset_freezable();\n\n\t/* Allow SIGKILL to tell lockd to drop all of its locks */\n\tallow_signal(SIGKILL);\n\n\tdprintk(\"NFS locking service started (ver \" LOCKD_VERSION \").\\n\");\n\n\t/*\n\t * The main request loop. We don't terminate until the last\n\t * NFS mount or NFS daemon has gone away.\n\t */\n\twhile (!kthread_should_stop()) {\n\t\tlong timeout = MAX_SCHEDULE_TIMEOUT;\n\t\tRPC_IFDEBUG(char buf[RPC_MAX_ADDRBUFLEN]);\n\n\t\t/* update sv_maxconn if it has changed */\n\t\trqstp->rq_server->sv_maxconn = nlm_max_connections;\n\n\t\tif (signalled()) {\n\t\t\tflush_signals(current);\n\t\t\trestart_grace();\n\t\t\tcontinue;\n\t\t}\n\n\t\ttimeout = nlmsvc_retry_blocked();\n\n\t\t/*\n\t\t * Find a socket with data available and call its\n\t\t * recvfrom routine.\n\t\t */\n\t\terr = svc_recv(rqstp, timeout);\n\t\tif (err == -EAGAIN || err == -EINTR)\n\t\t\tcontinue;\n\t\tdprintk(\"lockd: request from %s\\n\",\n\t\t\t\tsvc_print_addr(rqstp, buf, sizeof(buf)));\n\n\t\tsvc_process(rqstp);\n\t}\n\tflush_signals(current);\n\tif (nlmsvc_ops)\n\t\tnlmsvc_invalidate_all();\n\tnlm_shutdown_hosts();\n\treturn 0;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nlmsvc_binding *\t\tnlmsvc_ops;",
      "static unsigned int\t\tnlm_max_connections = 1024;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlm_shutdown_hosts",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "nlm_shutdown_hosts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/host.c",
          "lines": "627-632",
          "snippet": "void\nnlm_shutdown_hosts(void)\n{\n\tdprintk(\"lockd: shutting down host module\\n\");\n\tnlm_shutdown_hosts_net(NULL);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include <net/ipv6.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include <net/ipv6.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/mutex.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nvoid\nnlm_shutdown_hosts(void)\n{\n\tdprintk(\"lockd: shutting down host module\\n\");\n\tnlm_shutdown_hosts_net(NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsvc_invalidate_all",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsvc_invalidate_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svcsubs.c",
          "lines": "400-410",
          "snippet": "void\nnlmsvc_invalidate_all(void)\n{\n\t/*\n\t * Previously, the code would call\n\t * nlmsvc_free_host_resources for each client in\n\t * turn, which is about as inefficient as it gets.\n\t * Now we just do it once in nlm_traverse_files.\n\t */\n\tnlm_traverse_files(NULL, nlmsvc_is_client, NULL);\n}",
          "includes": [
            "#include <uapi/linux/nfs2.h>",
            "#include <linux/mount.h>",
            "#include <linux/module.h>",
            "#include <linux/lockd/share.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/in.h>",
            "#include <linux/time.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs2.h>\n#include <linux/mount.h>\n#include <linux/module.h>\n#include <linux/lockd/share.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/in.h>\n#include <linux/time.h>\n#include <linux/string.h>\n#include <linux/types.h>\n\nvoid\nnlmsvc_invalidate_all(void)\n{\n\t/*\n\t * Previously, the code would call\n\t * nlmsvc_free_host_resources for each client in\n\t * turn, which is about as inefficient as it gets.\n\t * Now we just do it once in nlm_traverse_files.\n\t */\n\tnlm_traverse_files(NULL, nlmsvc_is_client, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_signals",
          "args": [
            "current"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_process",
          "args": [
            "rqstp"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"lockd: request from %s\\n\"",
            "svc_print_addr(rqstp, buf, sizeof(buf))"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_print_addr",
          "args": [
            "rqstp",
            "buf",
            "sizeof(buf)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "svc_recv",
          "args": [
            "rqstp",
            "timeout"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsvc_retry_blocked",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsvc_retry_blocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svclock.c",
          "lines": "908-939",
          "snippet": "unsigned long\nnlmsvc_retry_blocked(void)\n{\n\tunsigned long\ttimeout = MAX_SCHEDULE_TIMEOUT;\n\tstruct nlm_block *block;\n\n\tspin_lock(&nlm_blocked_lock);\n\twhile (!list_empty(&nlm_blocked) && !kthread_should_stop()) {\n\t\tblock = list_entry(nlm_blocked.next, struct nlm_block, b_list);\n\n\t\tif (block->b_when == NLM_NEVER)\n\t\t\tbreak;\n\t\tif (time_after(block->b_when, jiffies)) {\n\t\t\ttimeout = block->b_when - jiffies;\n\t\t\tbreak;\n\t\t}\n\t\tspin_unlock(&nlm_blocked_lock);\n\n\t\tdprintk(\"nlmsvc_retry_blocked(%p, when=%ld)\\n\",\n\t\t\tblock, block->b_when);\n\t\tif (block->b_flags & B_QUEUED) {\n\t\t\tdprintk(\"nlmsvc_retry_blocked delete block (%p, granted=%d, flags=%d)\\n\",\n\t\t\t\tblock, block->b_granted, block->b_flags);\n\t\t\tretry_deferred_block(block);\n\t\t} else\n\t\t\tnlmsvc_grant_blocked(block);\n\t\tspin_lock(&nlm_blocked_lock);\n\t}\n\tspin_unlock(&nlm_blocked_lock);\n\n\treturn timeout;\n}",
          "includes": [
            "#include <linux/kthread.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/lockd/nlm.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void nlmsvc_release_block(struct nlm_block *block);",
            "static void\tnlmsvc_insert_block(struct nlm_block *block, unsigned long);",
            "static void\tnlmsvc_remove_block(struct nlm_block *block);",
            "static LIST_HEAD(nlm_blocked);",
            "static DEFINE_SPINLOCK(nlm_blocked_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kthread.h>\n#include <linux/lockd/lockd.h>\n#include <linux/lockd/nlm.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n\nstatic void nlmsvc_release_block(struct nlm_block *block);\nstatic void\tnlmsvc_insert_block(struct nlm_block *block, unsigned long);\nstatic void\tnlmsvc_remove_block(struct nlm_block *block);\nstatic LIST_HEAD(nlm_blocked);\nstatic DEFINE_SPINLOCK(nlm_blocked_lock);\n\nunsigned long\nnlmsvc_retry_blocked(void)\n{\n\tunsigned long\ttimeout = MAX_SCHEDULE_TIMEOUT;\n\tstruct nlm_block *block;\n\n\tspin_lock(&nlm_blocked_lock);\n\twhile (!list_empty(&nlm_blocked) && !kthread_should_stop()) {\n\t\tblock = list_entry(nlm_blocked.next, struct nlm_block, b_list);\n\n\t\tif (block->b_when == NLM_NEVER)\n\t\t\tbreak;\n\t\tif (time_after(block->b_when, jiffies)) {\n\t\t\ttimeout = block->b_when - jiffies;\n\t\t\tbreak;\n\t\t}\n\t\tspin_unlock(&nlm_blocked_lock);\n\n\t\tdprintk(\"nlmsvc_retry_blocked(%p, when=%ld)\\n\",\n\t\t\tblock, block->b_when);\n\t\tif (block->b_flags & B_QUEUED) {\n\t\t\tdprintk(\"nlmsvc_retry_blocked delete block (%p, granted=%d, flags=%d)\\n\",\n\t\t\t\tblock, block->b_granted, block->b_flags);\n\t\t\tretry_deferred_block(block);\n\t\t} else\n\t\t\tnlmsvc_grant_blocked(block);\n\t\tspin_lock(&nlm_blocked_lock);\n\t}\n\tspin_unlock(&nlm_blocked_lock);\n\n\treturn timeout;\n}"
        }
      },
      {
        "call_info": {
          "callee": "restart_grace",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "restart_grace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "111-122",
          "snippet": "static void restart_grace(void)\n{\n\tif (nlmsvc_ops) {\n\t\tstruct net *net = &init_net;\n\t\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\tlocks_end_grace(&ln->lockd_manager);\n\t\tnlmsvc_invalidate_all();\n\t\tset_grace_period(net);\n\t}\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct nlmsvc_binding *\t\tnlmsvc_ops;",
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nlmsvc_binding *\t\tnlmsvc_ops;\nint lockd_net_id;\n\nstatic void restart_grace(void)\n{\n\tif (nlmsvc_ops) {\n\t\tstruct net *net = &init_net;\n\t\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\tlocks_end_grace(&ln->lockd_manager);\n\t\tnlmsvc_invalidate_all();\n\t\tset_grace_period(net);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_signals",
          "args": [
            "current"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signalled",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS locking service started (ver \" LOCKD_VERSION \").\\n\""
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allow_signal",
          "args": [
            "SIGKILL"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_freezable",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nlmsvc_binding *\t\tnlmsvc_ops;\nstatic unsigned int\t\tnlm_max_connections = 1024;\n\nstatic int\nlockd(void *vrqstp)\n{\n\tint\t\terr = 0;\n\tstruct svc_rqst *rqstp = vrqstp;\n\n\t/* try_to_freeze() is called from svc_recv() */\n\tset_freezable();\n\n\t/* Allow SIGKILL to tell lockd to drop all of its locks */\n\tallow_signal(SIGKILL);\n\n\tdprintk(\"NFS locking service started (ver \" LOCKD_VERSION \").\\n\");\n\n\t/*\n\t * The main request loop. We don't terminate until the last\n\t * NFS mount or NFS daemon has gone away.\n\t */\n\twhile (!kthread_should_stop()) {\n\t\tlong timeout = MAX_SCHEDULE_TIMEOUT;\n\t\tRPC_IFDEBUG(char buf[RPC_MAX_ADDRBUFLEN]);\n\n\t\t/* update sv_maxconn if it has changed */\n\t\trqstp->rq_server->sv_maxconn = nlm_max_connections;\n\n\t\tif (signalled()) {\n\t\t\tflush_signals(current);\n\t\t\trestart_grace();\n\t\t\tcontinue;\n\t\t}\n\n\t\ttimeout = nlmsvc_retry_blocked();\n\n\t\t/*\n\t\t * Find a socket with data available and call its\n\t\t * recvfrom routine.\n\t\t */\n\t\terr = svc_recv(rqstp, timeout);\n\t\tif (err == -EAGAIN || err == -EINTR)\n\t\t\tcontinue;\n\t\tdprintk(\"lockd: request from %s\\n\",\n\t\t\t\tsvc_print_addr(rqstp, buf, sizeof(buf)));\n\n\t\tsvc_process(rqstp);\n\t}\n\tflush_signals(current);\n\tif (nlmsvc_ops)\n\t\tnlmsvc_invalidate_all();\n\tnlm_shutdown_hosts();\n\treturn 0;\n}"
  },
  {
    "function_name": "restart_grace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "111-122",
    "snippet": "static void restart_grace(void)\n{\n\tif (nlmsvc_ops) {\n\t\tstruct net *net = &init_net;\n\t\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\tlocks_end_grace(&ln->lockd_manager);\n\t\tnlmsvc_invalidate_all();\n\t\tset_grace_period(net);\n\t}\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct nlmsvc_binding *\t\tnlmsvc_ops;",
      "int lockd_net_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_grace_period",
          "args": [
            "net"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "set_grace_period",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "101-109",
          "snippet": "static void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int lockd_net_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint lockd_net_id;\n\nstatic void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsvc_invalidate_all",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsvc_invalidate_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svcsubs.c",
          "lines": "400-410",
          "snippet": "void\nnlmsvc_invalidate_all(void)\n{\n\t/*\n\t * Previously, the code would call\n\t * nlmsvc_free_host_resources for each client in\n\t * turn, which is about as inefficient as it gets.\n\t * Now we just do it once in nlm_traverse_files.\n\t */\n\tnlm_traverse_files(NULL, nlmsvc_is_client, NULL);\n}",
          "includes": [
            "#include <uapi/linux/nfs2.h>",
            "#include <linux/mount.h>",
            "#include <linux/module.h>",
            "#include <linux/lockd/share.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <linux/sunrpc/addr.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/in.h>",
            "#include <linux/time.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfs2.h>\n#include <linux/mount.h>\n#include <linux/module.h>\n#include <linux/lockd/share.h>\n#include <linux/lockd/lockd.h>\n#include <linux/sunrpc/addr.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/in.h>\n#include <linux/time.h>\n#include <linux/string.h>\n#include <linux/types.h>\n\nvoid\nnlmsvc_invalidate_all(void)\n{\n\t/*\n\t * Previously, the code would call\n\t * nlmsvc_free_host_resources for each client in\n\t * turn, which is about as inefficient as it gets.\n\t * Now we just do it once in nlm_traverse_files.\n\t */\n\tnlm_traverse_files(NULL, nlmsvc_is_client, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "locks_end_grace",
          "args": [
            "&ln->lockd_manager"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "locks_end_grace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs_common/grace.c",
          "lines": "49-55",
          "snippet": "void\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <net/netns/generic.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(grace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <net/netns/generic.h>\n#include <net/net_namespace.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(grace_lock);\n\nvoid\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&ln->grace_period_end"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct nlmsvc_binding *\t\tnlmsvc_ops;\nint lockd_net_id;\n\nstatic void restart_grace(void)\n{\n\tif (nlmsvc_ops) {\n\t\tstruct net *net = &init_net;\n\t\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\t\tcancel_delayed_work_sync(&ln->grace_period_end);\n\t\tlocks_end_grace(&ln->lockd_manager);\n\t\tnlmsvc_invalidate_all();\n\t\tset_grace_period(net);\n\t}\n}"
  },
  {
    "function_name": "set_grace_period",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "101-109",
    "snippet": "static void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int lockd_net_id;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_delayed_work",
          "args": [
            "&ln->grace_period_end",
            "grace_period"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&ln->grace_period_end"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locks_start_grace",
          "args": [
            "net",
            "&ln->lockd_manager"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "locks_start_grace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs_common/grace.c",
          "lines": "27-35",
          "snippet": "void\nlocks_start_grace(struct net *net, struct lock_manager *lm)\n{\n\tstruct list_head *grace_list = net_generic(net, grace_net_id);\n\n\tspin_lock(&grace_lock);\n\tlist_add(&lm->list, grace_list);\n\tspin_unlock(&grace_lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <net/netns/generic.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int grace_net_id;",
            "static DEFINE_SPINLOCK(grace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <net/netns/generic.h>\n#include <net/net_namespace.h>\n#include <linux/module.h>\n\nstatic int grace_net_id;\nstatic DEFINE_SPINLOCK(grace_lock);\n\nvoid\nlocks_start_grace(struct net *net, struct lock_manager *lm)\n{\n\tstruct list_head *grace_list = net_generic(net, grace_net_id);\n\n\tspin_lock(&grace_lock);\n\tlist_add(&lm->list, grace_list);\n\tspin_unlock(&grace_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "lockd_net_id"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_lockd_grace_period",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "get_lockd_grace_period",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
          "lines": "82-89",
          "snippet": "static unsigned long get_lockd_grace_period(void)\n{\n\t/* Note: nlm_timeout should always be nonzero */\n\tif (nlm_grace_period)\n\t\treturn roundup(nlm_grace_period, nlm_timeout) * HZ;\n\telse\n\t\treturn nlm_timeout * 5 * HZ;\n}",
          "includes": [
            "#include \"procfs.h\"",
            "#include \"netns.h\"",
            "#include <linux/nfs.h>",
            "#include <linux/lockd/lockd.h>",
            "#include <net/ip.h>",
            "#include <linux/sunrpc/svcsock.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/sunrpc/stats.h>",
            "#include <linux/sunrpc/types.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mutex.h>",
            "#include <linux/smp.h>",
            "#include <linux/uio.h>",
            "#include <linux/in.h>",
            "#include <linux/errno.h>",
            "#include <linux/sched.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long\t\tnlm_grace_period;",
            "static unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned long\t\tnlm_grace_period;\nstatic unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\nstatic unsigned long get_lockd_grace_period(void)\n{\n\t/* Note: nlm_timeout should always be nonzero */\n\tif (nlm_grace_period)\n\t\treturn roundup(nlm_grace_period, nlm_timeout) * HZ;\n\telse\n\t\treturn nlm_timeout * 5 * HZ;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint lockd_net_id;\n\nstatic void set_grace_period(struct net *net)\n{\n\tunsigned long grace_period = get_lockd_grace_period();\n\tstruct lockd_net *ln = net_generic(net, lockd_net_id);\n\n\tlocks_start_grace(net, &ln->lockd_manager);\n\tcancel_delayed_work_sync(&ln->grace_period_end);\n\tschedule_delayed_work(&ln->grace_period_end, grace_period);\n}"
  },
  {
    "function_name": "grace_ender",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "91-99",
    "snippet": "static void grace_ender(struct work_struct *grace)\n{\n\tstruct delayed_work *dwork = container_of(grace, struct delayed_work,\n\t\t\t\t\t\t  work);\n\tstruct lockd_net *ln = container_of(dwork, struct lockd_net,\n\t\t\t\t\t    grace_period_end);\n\n\tlocks_end_grace(&ln->lockd_manager);\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locks_end_grace",
          "args": [
            "&ln->lockd_manager"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "locks_end_grace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs_common/grace.c",
          "lines": "49-55",
          "snippet": "void\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <net/netns/generic.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(grace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <net/netns/generic.h>\n#include <net/net_namespace.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(grace_lock);\n\nvoid\nlocks_end_grace(struct lock_manager *lm)\n{\n\tspin_lock(&grace_lock);\n\tlist_del_init(&lm->list);\n\tspin_unlock(&grace_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "dwork",
            "structlockd_net",
            "grace_period_end"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "grace",
            "structdelayed_work",
            "work"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic void grace_ender(struct work_struct *grace)\n{\n\tstruct delayed_work *dwork = container_of(grace, struct delayed_work,\n\t\t\t\t\t\t  work);\n\tstruct lockd_net *ln = container_of(dwork, struct lockd_net,\n\t\t\t\t\t    grace_period_end);\n\n\tlocks_end_grace(&ln->lockd_manager);\n}"
  },
  {
    "function_name": "get_lockd_grace_period",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/lockd/svc.c",
    "lines": "82-89",
    "snippet": "static unsigned long get_lockd_grace_period(void)\n{\n\t/* Note: nlm_timeout should always be nonzero */\n\tif (nlm_grace_period)\n\t\treturn roundup(nlm_grace_period, nlm_timeout) * HZ;\n\telse\n\t\treturn nlm_timeout * 5 * HZ;\n}",
    "includes": [
      "#include \"procfs.h\"",
      "#include \"netns.h\"",
      "#include <linux/nfs.h>",
      "#include <linux/lockd/lockd.h>",
      "#include <net/ip.h>",
      "#include <linux/sunrpc/svcsock.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/sunrpc/stats.h>",
      "#include <linux/sunrpc/types.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/mutex.h>",
      "#include <linux/smp.h>",
      "#include <linux/uio.h>",
      "#include <linux/in.h>",
      "#include <linux/errno.h>",
      "#include <linux/sched.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long\t\tnlm_grace_period;",
      "static unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "roundup",
          "args": [
            "nlm_grace_period",
            "nlm_timeout"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "roundup_64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_linux.h",
          "lines": "333-338",
          "snippet": "static inline __uint64_t roundup_64(__uint64_t x, __uint32_t y)\n{\n\tx += y - 1;\n\tdo_div(x, y);\n\treturn x * y;\n}",
          "includes": [
            "#include \"xfs_message.h\"",
            "#include \"xfs_buf.h\"",
            "#include \"xfs_cksum.h\"",
            "#include \"xfs_super.h\"",
            "#include \"xfs_aops.h\"",
            "#include \"xfs_iops.h\"",
            "#include \"xfs_sysctl.h\"",
            "#include \"xfs_stats.h\"",
            "#include \"xfs_fs.h\"",
            "#include <asm/unaligned.h>",
            "#include <asm/byteorder.h>",
            "#include <asm/uaccess.h>",
            "#include <asm/param.h>",
            "#include <asm/div64.h>",
            "#include <asm/page.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/capability.h>",
            "#include <linux/writeback.h>",
            "#include <linux/ctype.h>",
            "#include <linux/random.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/log2.h>",
            "#include <linux/delay.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sort.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/vfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/major.h>",
            "#include <linux/bitops.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>",
            "#include <linux/swap.h>",
            "#include <linux/file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/crc32c.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/kernel.h>",
            "#include <linux/mm.h>",
            "#include <linux/semaphore.h>",
            "#include \"uuid.h\"",
            "#include \"mrlock.h\"",
            "#include \"kmem.h\"",
            "#include \"xfs_types.h\"",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xfs_message.h\"\n#include \"xfs_buf.h\"\n#include \"xfs_cksum.h\"\n#include \"xfs_super.h\"\n#include \"xfs_aops.h\"\n#include \"xfs_iops.h\"\n#include \"xfs_sysctl.h\"\n#include \"xfs_stats.h\"\n#include \"xfs_fs.h\"\n#include <asm/unaligned.h>\n#include <asm/byteorder.h>\n#include <asm/uaccess.h>\n#include <asm/param.h>\n#include <asm/div64.h>\n#include <asm/page.h>\n#include <linux/ratelimit.h>\n#include <linux/list_sort.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/capability.h>\n#include <linux/writeback.h>\n#include <linux/ctype.h>\n#include <linux/random.h>\n#include <linux/spinlock.h>\n#include <linux/log2.h>\n#include <linux/delay.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/sort.h>\n#include <linux/proc_fs.h>\n#include <linux/list.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/vfs.h>\n#include <linux/pagemap.h>\n#include <linux/major.h>\n#include <linux/bitops.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n#include <linux/swap.h>\n#include <linux/file.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/crc32c.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/kernel.h>\n#include <linux/mm.h>\n#include <linux/semaphore.h>\n#include \"uuid.h\"\n#include \"mrlock.h\"\n#include \"kmem.h\"\n#include \"xfs_types.h\"\n#include <linux/types.h>\n\nstatic inline __uint64_t roundup_64(__uint64_t x, __uint32_t y)\n{\n\tx += y - 1;\n\tdo_div(x, y);\n\treturn x * y;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"procfs.h\"\n#include \"netns.h\"\n#include <linux/nfs.h>\n#include <linux/lockd/lockd.h>\n#include <net/ip.h>\n#include <linux/sunrpc/svcsock.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/sunrpc/stats.h>\n#include <linux/sunrpc/types.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/mutex.h>\n#include <linux/smp.h>\n#include <linux/uio.h>\n#include <linux/in.h>\n#include <linux/errno.h>\n#include <linux/sched.h>\n#include <linux/moduleparam.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic unsigned long\t\tnlm_grace_period;\nstatic unsigned long\t\tnlm_timeout = LOCKD_DFLT_TIMEO;\n\nstatic unsigned long get_lockd_grace_period(void)\n{\n\t/* Note: nlm_timeout should always be nonzero */\n\tif (nlm_grace_period)\n\t\treturn roundup(nlm_grace_period, nlm_timeout) * HZ;\n\telse\n\t\treturn nlm_timeout * 5 * HZ;\n}"
  }
]