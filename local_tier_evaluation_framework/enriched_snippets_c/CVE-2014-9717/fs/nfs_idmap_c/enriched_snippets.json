[
  {
    "function_name": "nfs_map_gid_to_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "779-792",
    "snippet": "int nfs_map_gid_to_group(const struct nfs_server *server, kgid_t gid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kgid(&init_user_ns, gid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"group\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_gid_to_group(buf, ret, id, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs4_map_gid_to_group",
          "args": [
            "buf",
            "ret",
            "id",
            "ret"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_numeric_to_string",
          "args": [
            "id",
            "buf",
            "buflen"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_numeric_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "171-174",
          "snippet": "static int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_lookup_name",
          "args": [
            "id",
            "\"group\"",
            "buf",
            "buflen",
            "idmap"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_lookup_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "339-351",
          "snippet": "static ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NFS_UINT_MAXLEN 11"
          ],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "gid"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_gid_to_group(const struct nfs_server *server, kgid_t gid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kgid(&init_user_ns, gid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"group\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_gid_to_group(buf, ret, id, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_map_uid_to_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "765-778",
    "snippet": "int nfs_map_uid_to_name(const struct nfs_server *server, kuid_t uid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kuid(&init_user_ns, uid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"user\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_uid_to_name(buf, ret, id, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs4_map_uid_to_name",
          "args": [
            "buf",
            "ret",
            "id",
            "ret"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_map_numeric_to_string",
          "args": [
            "id",
            "buf",
            "buflen"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_numeric_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "171-174",
          "snippet": "static int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_lookup_name",
          "args": [
            "id",
            "\"user\"",
            "buf",
            "buflen",
            "idmap"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_lookup_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "339-351",
          "snippet": "static ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NFS_UINT_MAXLEN 11"
          ],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "uid"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_uid_to_name(const struct nfs_server *server, kuid_t uid, char *buf, size_t buflen)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\tint ret = -EINVAL;\n\t__u32 id;\n\n\tid = from_kuid(&init_user_ns, uid);\n\tif (!(server->caps & NFS_CAP_UIDGID_NOMAP))\n\t\tret = nfs_idmap_lookup_name(id, \"user\", buf, buflen, idmap);\n\tif (ret < 0)\n\t\tret = nfs_map_numeric_to_string(id, buf, buflen);\n\ttrace_nfs4_map_uid_to_name(buf, ret, id, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_map_group_to_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "748-763",
    "snippet": "int nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs4_map_group_to_gid",
          "args": [
            "name",
            "namelen",
            "id",
            "ret"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "*gid"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_lookup_id",
          "args": [
            "name",
            "namelen",
            "\"gid\"",
            "&id",
            "idmap"
          ],
          "line": 755
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_lookup_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "354-370",
          "snippet": "static int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NFS_UINT_MAXLEN 11"
          ],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_map_string_to_numeric",
          "args": [
            "name",
            "namelen",
            "&id"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_string_to_numeric",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "155-168",
          "snippet": "int nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_map_name_to_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "731-746",
    "snippet": "int nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_nfs4_map_name_to_uid",
          "args": [
            "name",
            "namelen",
            "id",
            "ret"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "*uid"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_lookup_id",
          "args": [
            "name",
            "namelen",
            "\"uid\"",
            "&id",
            "idmap"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_lookup_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "354-370",
          "snippet": "static int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NFS_UINT_MAXLEN 11"
          ],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_map_string_to_numeric",
          "args": [
            "name",
            "namelen",
            "&id"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_string_to_numeric",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "155-168",
          "snippet": "int nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "idmap_release_pipe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "722-729",
    "snippet": "static void\nidmap_release_pipe(struct inode *inode)\n{\n\tstruct rpc_inode *rpci = RPC_I(inode);\n\tstruct idmap *idmap = (struct idmap *)rpci->private;\n\n\tnfs_idmap_abort_pipe_upcall(idmap, -EPIPE);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void idmap_release_pipe(struct inode *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_abort_pipe_upcall",
          "args": [
            "idmap",
            "-EPIPE"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_abort_pipe_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "569-574",
          "snippet": "static void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RPC_I",
          "args": [
            "inode"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void idmap_release_pipe(struct inode *);\n\nstatic void\nidmap_release_pipe(struct inode *inode)\n{\n\tstruct rpc_inode *rpci = RPC_I(inode);\n\tstruct idmap *idmap = (struct idmap *)rpci->private;\n\n\tnfs_idmap_abort_pipe_upcall(idmap, -EPIPE);\n}"
  },
  {
    "function_name": "idmap_pipe_destroy_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "710-720",
    "snippet": "static void\nidmap_pipe_destroy_msg(struct rpc_pipe_msg *msg)\n{\n\tstruct idmap_legacy_upcalldata *data = container_of(msg,\n\t\t\tstruct idmap_legacy_upcalldata,\n\t\t\tpipe_msg);\n\tstruct idmap *idmap = data->idmap;\n\n\tif (msg->errno)\n\t\tnfs_idmap_abort_pipe_upcall(idmap, msg->errno);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_abort_pipe_upcall",
          "args": [
            "idmap",
            "msg->errno"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_abort_pipe_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "569-574",
          "snippet": "static void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "msg",
            "structidmap_legacy_upcalldata",
            "pipe_msg"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);\n\nstatic void\nidmap_pipe_destroy_msg(struct rpc_pipe_msg *msg)\n{\n\tstruct idmap_legacy_upcalldata *data = container_of(msg,\n\t\t\tstruct idmap_legacy_upcalldata,\n\t\t\tpipe_msg);\n\tstruct idmap *idmap = data->idmap;\n\n\tif (msg->errno)\n\t\tnfs_idmap_abort_pipe_upcall(idmap, msg->errno);\n}"
  },
  {
    "function_name": "idmap_pipe_downcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "656-708",
    "snippet": "static ssize_t\nidmap_pipe_downcall(struct file *filp, const char __user *src, size_t mlen)\n{\n\tstruct rpc_inode *rpci = RPC_I(file_inode(filp));\n\tstruct idmap *idmap = (struct idmap *)rpci->private;\n\tstruct key_construction *cons;\n\tstruct idmap_msg im;\n\tsize_t namelen_in;\n\tint ret = -ENOKEY;\n\n\t/* If instantiation is successful, anyone waiting for key construction\n\t * will have been woken up and someone else may now have used\n\t * idmap_key_cons - so after this point we may no longer touch it.\n\t */\n\tif (idmap->idmap_upcall_data == NULL)\n\t\tgoto out_noupcall;\n\n\tcons = idmap->idmap_upcall_data->key_cons;\n\n\tif (mlen != sizeof(im)) {\n\t\tret = -ENOSPC;\n\t\tgoto out;\n\t}\n\n\tif (copy_from_user(&im, src, mlen) != 0) {\n\t\tret = -EFAULT;\n\t\tgoto out;\n\t}\n\n\tif (!(im.im_status & IDMAP_STATUS_SUCCESS)) {\n\t\tret = -ENOKEY;\n\t\tgoto out;\n\t}\n\n\tnamelen_in = strnlen(im.im_name, IDMAP_NAMESZ);\n\tif (namelen_in == 0 || namelen_in == IDMAP_NAMESZ) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n}\n\n\tret = nfs_idmap_read_and_verify_message(&im,\n\t\t\t&idmap->idmap_upcall_data->idmap_msg,\n\t\t\tcons->key, cons->authkey);\n\tif (ret >= 0) {\n\t\tkey_set_timeout(cons->key, nfs_idmap_cache_timeout);\n\t\tret = mlen;\n\t}\n\nout:\n\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\nout_noupcall:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);",
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_complete_pipe_upcall_locked",
          "args": [
            "idmap",
            "ret"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_complete_pipe_upcall_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "559-567",
          "snippet": "static void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);\n\nstatic void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "key_set_timeout",
          "args": [
            "cons->key",
            "nfs_idmap_cache_timeout"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_read_and_verify_message",
          "args": [
            "&im",
            "&idmap->idmap_upcall_data->idmap_msg",
            "cons->key",
            "cons->authkey"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_read_and_verify_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "624-654",
          "snippet": "static int nfs_idmap_read_and_verify_message(struct idmap_msg *im,\n\t\tstruct idmap_msg *upcall,\n\t\tstruct key *key, struct key *authkey)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tsize_t len;\n\tint ret = -ENOKEY;\n\n\t/* ret = -ENOKEY */\n\tif (upcall->im_type != im->im_type || upcall->im_conv != im->im_conv)\n\t\tgoto out;\n\tswitch (im->im_conv) {\n\tcase IDMAP_CONV_NAMETOID:\n\t\tif (strcmp(upcall->im_name, im->im_name) != 0)\n\t\t\tbreak;\n\t\t/* Note: here we store the NUL terminator too */\n\t\tlen = sprintf(id_str, \"%d\", im->im_id) + 1;\n\t\tret = nfs_idmap_instantiate(key, authkey, id_str, len);\n\t\tbreak;\n\tcase IDMAP_CONV_IDTONAME:\n\t\tif (upcall->im_id != im->im_id)\n\t\t\tbreak;\n\t\tlen = strlen(im->im_name);\n\t\tret = nfs_idmap_instantiate(key, authkey, im->im_name, len);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NFS_UINT_MAXLEN 11"
          ],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_read_and_verify_message(struct idmap_msg *im,\n\t\tstruct idmap_msg *upcall,\n\t\tstruct key *key, struct key *authkey)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tsize_t len;\n\tint ret = -ENOKEY;\n\n\t/* ret = -ENOKEY */\n\tif (upcall->im_type != im->im_type || upcall->im_conv != im->im_conv)\n\t\tgoto out;\n\tswitch (im->im_conv) {\n\tcase IDMAP_CONV_NAMETOID:\n\t\tif (strcmp(upcall->im_name, im->im_name) != 0)\n\t\t\tbreak;\n\t\t/* Note: here we store the NUL terminator too */\n\t\tlen = sprintf(id_str, \"%d\", im->im_id) + 1;\n\t\tret = nfs_idmap_instantiate(key, authkey, id_str, len);\n\t\tbreak;\n\tcase IDMAP_CONV_IDTONAME:\n\t\tif (upcall->im_id != im->im_id)\n\t\t\tbreak;\n\t\tlen = strlen(im->im_name);\n\t\tret = nfs_idmap_instantiate(key, authkey, im->im_name, len);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strnlen",
          "args": [
            "im.im_name",
            "IDMAP_NAMESZ"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&im",
            "src",
            "mlen"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namespace.c",
          "lines": "2514-2534",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/task_work.h>\n#include <linux/bootmem.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RPC_I",
          "args": [
            "file_inode(filp)"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "filp"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_init_file_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/file.c",
          "lines": "3009-3013",
          "snippet": "void fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}",
          "includes": [
            "#include <linux/falloc.h>",
            "#include <linux/aio.h>",
            "#include <linux/swap.h>",
            "#include <linux/compat.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};",
            "static const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/falloc.h>\n#include <linux/aio.h>\n#include <linux/swap.h>\n#include <linux/compat.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};\nstatic const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};\n\nvoid fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t\nidmap_pipe_downcall(struct file *filp, const char __user *src, size_t mlen)\n{\n\tstruct rpc_inode *rpci = RPC_I(file_inode(filp));\n\tstruct idmap *idmap = (struct idmap *)rpci->private;\n\tstruct key_construction *cons;\n\tstruct idmap_msg im;\n\tsize_t namelen_in;\n\tint ret = -ENOKEY;\n\n\t/* If instantiation is successful, anyone waiting for key construction\n\t * will have been woken up and someone else may now have used\n\t * idmap_key_cons - so after this point we may no longer touch it.\n\t */\n\tif (idmap->idmap_upcall_data == NULL)\n\t\tgoto out_noupcall;\n\n\tcons = idmap->idmap_upcall_data->key_cons;\n\n\tif (mlen != sizeof(im)) {\n\t\tret = -ENOSPC;\n\t\tgoto out;\n\t}\n\n\tif (copy_from_user(&im, src, mlen) != 0) {\n\t\tret = -EFAULT;\n\t\tgoto out;\n\t}\n\n\tif (!(im.im_status & IDMAP_STATUS_SUCCESS)) {\n\t\tret = -ENOKEY;\n\t\tgoto out;\n\t}\n\n\tnamelen_in = strnlen(im.im_name, IDMAP_NAMESZ);\n\tif (namelen_in == 0 || namelen_in == IDMAP_NAMESZ) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n}\n\n\tret = nfs_idmap_read_and_verify_message(&im,\n\t\t\t&idmap->idmap_upcall_data->idmap_msg,\n\t\t\tcons->key, cons->authkey);\n\tif (ret >= 0) {\n\t\tkey_set_timeout(cons->key, nfs_idmap_cache_timeout);\n\t\tret = mlen;\n\t}\n\nout:\n\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\nout_noupcall:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_read_and_verify_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "624-654",
    "snippet": "static int nfs_idmap_read_and_verify_message(struct idmap_msg *im,\n\t\tstruct idmap_msg *upcall,\n\t\tstruct key *key, struct key *authkey)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tsize_t len;\n\tint ret = -ENOKEY;\n\n\t/* ret = -ENOKEY */\n\tif (upcall->im_type != im->im_type || upcall->im_conv != im->im_conv)\n\t\tgoto out;\n\tswitch (im->im_conv) {\n\tcase IDMAP_CONV_NAMETOID:\n\t\tif (strcmp(upcall->im_name, im->im_name) != 0)\n\t\t\tbreak;\n\t\t/* Note: here we store the NUL terminator too */\n\t\tlen = sprintf(id_str, \"%d\", im->im_id) + 1;\n\t\tret = nfs_idmap_instantiate(key, authkey, id_str, len);\n\t\tbreak;\n\tcase IDMAP_CONV_IDTONAME:\n\t\tif (upcall->im_id != im->im_id)\n\t\t\tbreak;\n\t\tlen = strlen(im->im_name);\n\t\tret = nfs_idmap_instantiate(key, authkey, im->im_name, len);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NFS_UINT_MAXLEN 11"
    ],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_instantiate",
          "args": [
            "key",
            "authkey",
            "im->im_name",
            "len"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_instantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "617-622",
          "snippet": "static int nfs_idmap_instantiate(struct key *key, struct key *authkey, char *data, size_t datalen)\n{\n\treturn key_instantiate_and_link(key, data, datalen,\n\t\t\t\t\tid_resolver_cache->thread_keyring,\n\t\t\t\t\tauthkey);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cred *id_resolver_cache;",
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_instantiate(struct key *key, struct key *authkey, char *data, size_t datalen)\n{\n\treturn key_instantiate_and_link(key, data, datalen,\n\t\t\t\t\tid_resolver_cache->thread_keyring,\n\t\t\t\t\tauthkey);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "im->im_name"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "id_str",
            "\"%d\"",
            "im->im_id"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "upcall->im_name",
            "im->im_name"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_read_and_verify_message(struct idmap_msg *im,\n\t\tstruct idmap_msg *upcall,\n\t\tstruct key *key, struct key *authkey)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tsize_t len;\n\tint ret = -ENOKEY;\n\n\t/* ret = -ENOKEY */\n\tif (upcall->im_type != im->im_type || upcall->im_conv != im->im_conv)\n\t\tgoto out;\n\tswitch (im->im_conv) {\n\tcase IDMAP_CONV_NAMETOID:\n\t\tif (strcmp(upcall->im_name, im->im_name) != 0)\n\t\t\tbreak;\n\t\t/* Note: here we store the NUL terminator too */\n\t\tlen = sprintf(id_str, \"%d\", im->im_id) + 1;\n\t\tret = nfs_idmap_instantiate(key, authkey, id_str, len);\n\t\tbreak;\n\tcase IDMAP_CONV_IDTONAME:\n\t\tif (upcall->im_id != im->im_id)\n\t\t\tbreak;\n\t\tlen = strlen(im->im_name);\n\t\tret = nfs_idmap_instantiate(key, authkey, im->im_name, len);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_instantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "617-622",
    "snippet": "static int nfs_idmap_instantiate(struct key *key, struct key *authkey, char *data, size_t datalen)\n{\n\treturn key_instantiate_and_link(key, data, datalen,\n\t\t\t\t\tid_resolver_cache->thread_keyring,\n\t\t\t\t\tauthkey);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cred *id_resolver_cache;",
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "key_instantiate_and_link",
          "args": [
            "key",
            "data",
            "datalen",
            "id_resolver_cache->thread_keyring",
            "authkey"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_instantiate(struct key *key, struct key *authkey, char *data, size_t datalen)\n{\n\treturn key_instantiate_and_link(key, data, datalen,\n\t\t\t\t\tid_resolver_cache->thread_keyring,\n\t\t\t\t\tauthkey);\n}"
  },
  {
    "function_name": "nfs_idmap_legacy_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "576-615",
    "snippet": "static int nfs_idmap_legacy_upcall(struct key_construction *cons,\n\t\t\t\t   const char *op,\n\t\t\t\t   void *aux)\n{\n\tstruct idmap_legacy_upcalldata *data;\n\tstruct rpc_pipe_msg *msg;\n\tstruct idmap_msg *im;\n\tstruct idmap *idmap = (struct idmap *)aux;\n\tstruct key *key = cons->key;\n\tint ret = -ENOMEM;\n\n\t/* msg and im are freed in idmap_pipe_destroy_msg */\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\tgoto out1;\n\n\tmsg = &data->pipe_msg;\n\tim = &data->idmap_msg;\n\tdata->idmap = idmap;\n\tdata->key_cons = cons;\n\n\tret = nfs_idmap_prepare_message(key->description, idmap, im, msg);\n\tif (ret < 0)\n\t\tgoto out2;\n\n\tret = -EAGAIN;\n\tif (!nfs_idmap_prepare_pipe_upcall(idmap, data))\n\t\tgoto out2;\n\n\tret = rpc_queue_upcall(idmap->idmap_pipe, msg);\n\tif (ret < 0)\n\t\tnfs_idmap_abort_pipe_upcall(idmap, ret);\n\n\treturn ret;\nout2:\n\tkfree(data);\nout1:\n\tcomplete_request_key(cons, ret);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);",
      "static void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete_request_key",
          "args": [
            "cons",
            "ret"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "data"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_abort_pipe_upcall",
          "args": [
            "idmap",
            "ret"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_abort_pipe_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "569-574",
          "snippet": "static void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rpc_queue_upcall",
          "args": [
            "idmap->idmap_pipe",
            "msg"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_prepare_pipe_upcall",
          "args": [
            "idmap",
            "data"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_prepare_pipe_upcall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "547-557",
          "snippet": "static bool\nnfs_idmap_prepare_pipe_upcall(struct idmap *idmap,\n\t\tstruct idmap_legacy_upcalldata *data)\n{\n\tif (idmap->idmap_upcall_data != NULL) {\n\t\tWARN_ON_ONCE(1);\n\t\treturn false;\n\t}\n\tidmap->idmap_upcall_data = data;\n\treturn true;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool\nnfs_idmap_prepare_pipe_upcall(struct idmap *idmap,\n\t\tstruct idmap_legacy_upcalldata *data)\n{\n\tif (idmap->idmap_upcall_data != NULL) {\n\t\tWARN_ON_ONCE(1);\n\t\treturn false;\n\t}\n\tidmap->idmap_upcall_data = data;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_idmap_prepare_message",
          "args": [
            "key->description",
            "idmap",
            "im",
            "msg"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_prepare_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "510-545",
          "snippet": "static int nfs_idmap_prepare_message(char *desc, struct idmap *idmap,\n\t\t\t\t     struct idmap_msg *im,\n\t\t\t\t     struct rpc_pipe_msg *msg)\n{\n\tsubstring_t substr;\n\tint token, ret;\n\n\tim->im_type = IDMAP_TYPE_GROUP;\n\ttoken = match_token(desc, nfs_idmap_tokens, &substr);\n\n\tswitch (token) {\n\tcase Opt_find_uid:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_gid:\n\t\tim->im_conv = IDMAP_CONV_NAMETOID;\n\t\tret = match_strlcpy(im->im_name, &substr, IDMAP_NAMESZ);\n\t\tbreak;\n\n\tcase Opt_find_user:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_group:\n\t\tim->im_conv = IDMAP_CONV_IDTONAME;\n\t\tret = match_int(&substr, &im->im_id);\n\t\tbreak;\n\n\tdefault:\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmsg->data = im;\n\tmsg->len  = sizeof(struct idmap_msg);\n\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const match_table_t nfs_idmap_tokens = {\n\t{ Opt_find_uid, \"uid:%s\" },\n\t{ Opt_find_gid, \"gid:%s\" },\n\t{ Opt_find_user, \"user:%s\" },\n\t{ Opt_find_group, \"group:%s\" },\n\t{ Opt_find_err, NULL }\n};",
            "static void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const match_table_t nfs_idmap_tokens = {\n\t{ Opt_find_uid, \"uid:%s\" },\n\t{ Opt_find_gid, \"gid:%s\" },\n\t{ Opt_find_user, \"user:%s\" },\n\t{ Opt_find_group, \"group:%s\" },\n\t{ Opt_find_err, NULL }\n};\nstatic void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);\n\nstatic int nfs_idmap_prepare_message(char *desc, struct idmap *idmap,\n\t\t\t\t     struct idmap_msg *im,\n\t\t\t\t     struct rpc_pipe_msg *msg)\n{\n\tsubstring_t substr;\n\tint token, ret;\n\n\tim->im_type = IDMAP_TYPE_GROUP;\n\ttoken = match_token(desc, nfs_idmap_tokens, &substr);\n\n\tswitch (token) {\n\tcase Opt_find_uid:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_gid:\n\t\tim->im_conv = IDMAP_CONV_NAMETOID;\n\t\tret = match_strlcpy(im->im_name, &substr, IDMAP_NAMESZ);\n\t\tbreak;\n\n\tcase Opt_find_user:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_group:\n\t\tim->im_conv = IDMAP_CONV_IDTONAME;\n\t\tret = match_int(&substr, &im->im_id);\n\t\tbreak;\n\n\tdefault:\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmsg->data = im;\n\tmsg->len  = sizeof(struct idmap_msg);\n\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*data)",
            "GFP_KERNEL"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);\nstatic void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *cons,\n\t\t\t\t   const char *op,\n\t\t\t\t   void *aux)\n{\n\tstruct idmap_legacy_upcalldata *data;\n\tstruct rpc_pipe_msg *msg;\n\tstruct idmap_msg *im;\n\tstruct idmap *idmap = (struct idmap *)aux;\n\tstruct key *key = cons->key;\n\tint ret = -ENOMEM;\n\n\t/* msg and im are freed in idmap_pipe_destroy_msg */\n\tdata = kzalloc(sizeof(*data), GFP_KERNEL);\n\tif (!data)\n\t\tgoto out1;\n\n\tmsg = &data->pipe_msg;\n\tim = &data->idmap_msg;\n\tdata->idmap = idmap;\n\tdata->key_cons = cons;\n\n\tret = nfs_idmap_prepare_message(key->description, idmap, im, msg);\n\tif (ret < 0)\n\t\tgoto out2;\n\n\tret = -EAGAIN;\n\tif (!nfs_idmap_prepare_pipe_upcall(idmap, data))\n\t\tgoto out2;\n\n\tret = rpc_queue_upcall(idmap->idmap_pipe, msg);\n\tif (ret < 0)\n\t\tnfs_idmap_abort_pipe_upcall(idmap, ret);\n\n\treturn ret;\nout2:\n\tkfree(data);\nout1:\n\tcomplete_request_key(cons, ret);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_abort_pipe_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "569-574",
    "snippet": "static void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_complete_pipe_upcall_locked",
          "args": [
            "idmap",
            "ret"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_complete_pipe_upcall_locked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "559-567",
          "snippet": "static void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);\n\nstatic void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void\nnfs_idmap_abort_pipe_upcall(struct idmap *idmap, int ret)\n{\n\tif (idmap->idmap_upcall_data != NULL)\n\t\tnfs_idmap_complete_pipe_upcall_locked(idmap, ret);\n}"
  },
  {
    "function_name": "nfs_idmap_complete_pipe_upcall_locked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "559-567",
    "snippet": "static void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete_request_key",
          "args": [
            "cons",
            "ret"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "idmap->idmap_upcall_data"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_legacy_upcall(struct key_construction *, const char *, void *);\n\nstatic void\nnfs_idmap_complete_pipe_upcall_locked(struct idmap *idmap, int ret)\n{\n\tstruct key_construction *cons = idmap->idmap_upcall_data->key_cons;\n\n\tkfree(idmap->idmap_upcall_data);\n\tidmap->idmap_upcall_data = NULL;\n\tcomplete_request_key(cons, ret);\n}"
  },
  {
    "function_name": "nfs_idmap_prepare_pipe_upcall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "547-557",
    "snippet": "static bool\nnfs_idmap_prepare_pipe_upcall(struct idmap *idmap,\n\t\tstruct idmap_legacy_upcalldata *data)\n{\n\tif (idmap->idmap_upcall_data != NULL) {\n\t\tWARN_ON_ONCE(1);\n\t\treturn false;\n\t}\n\tidmap->idmap_upcall_data = data;\n\treturn true;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool\nnfs_idmap_prepare_pipe_upcall(struct idmap *idmap,\n\t\tstruct idmap_legacy_upcalldata *data)\n{\n\tif (idmap->idmap_upcall_data != NULL) {\n\t\tWARN_ON_ONCE(1);\n\t\treturn false;\n\t}\n\tidmap->idmap_upcall_data = data;\n\treturn true;\n}"
  },
  {
    "function_name": "nfs_idmap_prepare_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "510-545",
    "snippet": "static int nfs_idmap_prepare_message(char *desc, struct idmap *idmap,\n\t\t\t\t     struct idmap_msg *im,\n\t\t\t\t     struct rpc_pipe_msg *msg)\n{\n\tsubstring_t substr;\n\tint token, ret;\n\n\tim->im_type = IDMAP_TYPE_GROUP;\n\ttoken = match_token(desc, nfs_idmap_tokens, &substr);\n\n\tswitch (token) {\n\tcase Opt_find_uid:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_gid:\n\t\tim->im_conv = IDMAP_CONV_NAMETOID;\n\t\tret = match_strlcpy(im->im_name, &substr, IDMAP_NAMESZ);\n\t\tbreak;\n\n\tcase Opt_find_user:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_group:\n\t\tim->im_conv = IDMAP_CONV_IDTONAME;\n\t\tret = match_int(&substr, &im->im_id);\n\t\tbreak;\n\n\tdefault:\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmsg->data = im;\n\tmsg->len  = sizeof(struct idmap_msg);\n\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t nfs_idmap_tokens = {\n\t{ Opt_find_uid, \"uid:%s\" },\n\t{ Opt_find_gid, \"gid:%s\" },\n\t{ Opt_find_user, \"user:%s\" },\n\t{ Opt_find_group, \"group:%s\" },\n\t{ Opt_find_err, NULL }\n};",
      "static void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_int",
          "args": [
            "&substr",
            "&im->im_id"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_strlcpy",
          "args": [
            "im->im_name",
            "&substr",
            "IDMAP_NAMESZ"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "desc",
            "nfs_idmap_tokens",
            "&substr"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const match_table_t nfs_idmap_tokens = {\n\t{ Opt_find_uid, \"uid:%s\" },\n\t{ Opt_find_gid, \"gid:%s\" },\n\t{ Opt_find_user, \"user:%s\" },\n\t{ Opt_find_group, \"group:%s\" },\n\t{ Opt_find_err, NULL }\n};\nstatic void idmap_pipe_destroy_msg(struct rpc_pipe_msg *);\n\nstatic int nfs_idmap_prepare_message(char *desc, struct idmap *idmap,\n\t\t\t\t     struct idmap_msg *im,\n\t\t\t\t     struct rpc_pipe_msg *msg)\n{\n\tsubstring_t substr;\n\tint token, ret;\n\n\tim->im_type = IDMAP_TYPE_GROUP;\n\ttoken = match_token(desc, nfs_idmap_tokens, &substr);\n\n\tswitch (token) {\n\tcase Opt_find_uid:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_gid:\n\t\tim->im_conv = IDMAP_CONV_NAMETOID;\n\t\tret = match_strlcpy(im->im_name, &substr, IDMAP_NAMESZ);\n\t\tbreak;\n\n\tcase Opt_find_user:\n\t\tim->im_type = IDMAP_TYPE_USER;\n\tcase Opt_find_group:\n\t\tim->im_conv = IDMAP_CONV_IDTONAME;\n\t\tret = match_int(&substr, &im->im_id);\n\t\tbreak;\n\n\tdefault:\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmsg->data = im;\n\tmsg->len  = sizeof(struct idmap_msg);\n\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_quit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "505-508",
    "snippet": "void nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_quit_keyring",
          "args": [],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_quit_keyring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "233-239",
          "snippet": "static void nfs_idmap_quit_keyring(void)\n{\n\tkey_revoke(id_resolver_cache->thread_keyring);\n\tunregister_key_type(&key_type_id_resolver);\n\tunregister_key_type(&key_type_id_resolver_legacy);\n\tput_cred(id_resolver_cache);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cred *id_resolver_cache;",
            "static struct key_type key_type_id_resolver_legacy;",
            "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
            "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic void nfs_idmap_quit_keyring(void)\n{\n\tkey_revoke(id_resolver_cache->thread_keyring);\n\tunregister_key_type(&key_type_id_resolver);\n\tunregister_key_type(&key_type_id_resolver_legacy);\n\tput_cred(id_resolver_cache);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_idmap_quit(void)\n{\n\tnfs_idmap_quit_keyring();\n}"
  },
  {
    "function_name": "nfs_idmap_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "495-503",
    "snippet": "int nfs_idmap_init(void)\n{\n\tint ret;\n\tret = nfs_idmap_init_keyring();\n\tif (ret != 0)\n\t\tgoto out;\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_init_keyring",
          "args": [],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_init_keyring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "187-231",
          "snippet": "static int nfs_idmap_init_keyring(void)\n{\n\tstruct cred *cred;\n\tstruct key *keyring;\n\tint ret = 0;\n\n\tprintk(KERN_NOTICE \"NFS: Registering the %s key type\\n\",\n\t\tkey_type_id_resolver.name);\n\n\tcred = prepare_kernel_cred(NULL);\n\tif (!cred)\n\t\treturn -ENOMEM;\n\n\tkeyring = keyring_alloc(\".id_resolver\",\n\t\t\t\tGLOBAL_ROOT_UID, GLOBAL_ROOT_GID, cred,\n\t\t\t\t(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ,\n\t\t\t\tKEY_ALLOC_NOT_IN_QUOTA, NULL);\n\tif (IS_ERR(keyring)) {\n\t\tret = PTR_ERR(keyring);\n\t\tgoto failed_put_cred;\n\t}\n\n\tret = register_key_type(&key_type_id_resolver);\n\tif (ret < 0)\n\t\tgoto failed_put_key;\n\n\tret = register_key_type(&key_type_id_resolver_legacy);\n\tif (ret < 0)\n\t\tgoto failed_reg_legacy;\n\n\tset_bit(KEY_FLAG_ROOT_CAN_CLEAR, &keyring->flags);\n\tcred->thread_keyring = keyring;\n\tcred->jit_keyring = KEY_REQKEY_DEFL_THREAD_KEYRING;\n\tid_resolver_cache = cred;\n\treturn 0;\n\nfailed_reg_legacy:\n\tunregister_key_type(&key_type_id_resolver);\nfailed_put_key:\n\tkey_put(keyring);\nfailed_put_cred:\n\tput_cred(cred);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cred *id_resolver_cache;",
            "static struct key_type key_type_id_resolver_legacy;",
            "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
            "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic int nfs_idmap_init_keyring(void)\n{\n\tstruct cred *cred;\n\tstruct key *keyring;\n\tint ret = 0;\n\n\tprintk(KERN_NOTICE \"NFS: Registering the %s key type\\n\",\n\t\tkey_type_id_resolver.name);\n\n\tcred = prepare_kernel_cred(NULL);\n\tif (!cred)\n\t\treturn -ENOMEM;\n\n\tkeyring = keyring_alloc(\".id_resolver\",\n\t\t\t\tGLOBAL_ROOT_UID, GLOBAL_ROOT_GID, cred,\n\t\t\t\t(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ,\n\t\t\t\tKEY_ALLOC_NOT_IN_QUOTA, NULL);\n\tif (IS_ERR(keyring)) {\n\t\tret = PTR_ERR(keyring);\n\t\tgoto failed_put_cred;\n\t}\n\n\tret = register_key_type(&key_type_id_resolver);\n\tif (ret < 0)\n\t\tgoto failed_put_key;\n\n\tret = register_key_type(&key_type_id_resolver_legacy);\n\tif (ret < 0)\n\t\tgoto failed_reg_legacy;\n\n\tset_bit(KEY_FLAG_ROOT_CAN_CLEAR, &keyring->flags);\n\tcred->thread_keyring = keyring;\n\tcred->jit_keyring = KEY_REQKEY_DEFL_THREAD_KEYRING;\n\tid_resolver_cache = cred;\n\treturn 0;\n\nfailed_reg_legacy:\n\tunregister_key_type(&key_type_id_resolver);\nfailed_put_key:\n\tkey_put(keyring);\nfailed_put_cred:\n\tput_cred(cred);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nint nfs_idmap_init(void)\n{\n\tint ret;\n\tret = nfs_idmap_init_keyring();\n\tif (ret != 0)\n\t\tgoto out;\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "480-493",
    "snippet": "void\nnfs_idmap_delete(struct nfs_client *clp)\n{\n\tstruct idmap *idmap = clp->cl_idmap;\n\n\tif (!idmap)\n\t\treturn;\n\tclp->cl_idmap = NULL;\n\trpc_remove_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\n\tkfree(idmap);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "idmap"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_destroy_pipe_data",
          "args": [
            "idmap->idmap_pipe"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_remove_pipe_dir_object",
          "args": [
            "clp->cl_net",
            "&clp->cl_rpcclient->cl_pipedir_objects",
            "&idmap->idmap_pdo"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid\nnfs_idmap_delete(struct nfs_client *clp)\n{\n\tstruct idmap *idmap = clp->cl_idmap;\n\n\tif (!idmap)\n\t\treturn;\n\tclp->cl_idmap = NULL;\n\trpc_remove_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\n\tkfree(idmap);\n}"
  },
  {
    "function_name": "nfs_idmap_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "442-478",
    "snippet": "int\nnfs_idmap_new(struct nfs_client *clp)\n{\n\tstruct idmap *idmap;\n\tstruct rpc_pipe *pipe;\n\tint error;\n\n\tidmap = kzalloc(sizeof(*idmap), GFP_KERNEL);\n\tif (idmap == NULL)\n\t\treturn -ENOMEM;\n\n\trpc_init_pipe_dir_object(&idmap->idmap_pdo,\n\t\t\t&nfs_idmap_pipe_dir_object_ops,\n\t\t\tidmap);\n\n\tpipe = rpc_mkpipe_data(&idmap_upcall_ops, 0);\n\tif (IS_ERR(pipe)) {\n\t\terror = PTR_ERR(pipe);\n\t\tgoto err;\n\t}\n\tidmap->idmap_pipe = pipe;\n\tmutex_init(&idmap->idmap_mutex);\n\n\terror = rpc_add_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\tif (error)\n\t\tgoto err_destroy_pipe;\n\n\tclp->cl_idmap = idmap;\n\treturn 0;\nerr_destroy_pipe:\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\nerr:\n\tkfree(idmap);\n\treturn error;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct rpc_pipe_ops idmap_upcall_ops = {\n\t.upcall\t\t= rpc_pipe_generic_upcall,\n\t.downcall\t= idmap_pipe_downcall,\n\t.release_pipe\t= idmap_release_pipe,\n\t.destroy_msg\t= idmap_pipe_destroy_msg,\n};",
      "static const struct rpc_pipe_dir_object_ops nfs_idmap_pipe_dir_object_ops = {\n\t.create = nfs_idmap_pipe_create,\n\t.destroy = nfs_idmap_pipe_destroy,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "idmap"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_destroy_pipe_data",
          "args": [
            "idmap->idmap_pipe"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_add_pipe_dir_object",
          "args": [
            "clp->cl_net",
            "&clp->cl_rpcclient->cl_pipedir_objects",
            "&idmap->idmap_pdo"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&idmap->idmap_mutex"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "pipe"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "pipe"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_mkpipe_data",
          "args": [
            "&idmap_upcall_ops",
            "0"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_init_pipe_dir_object",
          "args": [
            "&idmap->idmap_pdo",
            "&nfs_idmap_pipe_dir_object_ops",
            "idmap"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*idmap)",
            "GFP_KERNEL"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct rpc_pipe_ops idmap_upcall_ops = {\n\t.upcall\t\t= rpc_pipe_generic_upcall,\n\t.downcall\t= idmap_pipe_downcall,\n\t.release_pipe\t= idmap_release_pipe,\n\t.destroy_msg\t= idmap_pipe_destroy_msg,\n};\nstatic const struct rpc_pipe_dir_object_ops nfs_idmap_pipe_dir_object_ops = {\n\t.create = nfs_idmap_pipe_create,\n\t.destroy = nfs_idmap_pipe_destroy,\n};\n\nint\nnfs_idmap_new(struct nfs_client *clp)\n{\n\tstruct idmap *idmap;\n\tstruct rpc_pipe *pipe;\n\tint error;\n\n\tidmap = kzalloc(sizeof(*idmap), GFP_KERNEL);\n\tif (idmap == NULL)\n\t\treturn -ENOMEM;\n\n\trpc_init_pipe_dir_object(&idmap->idmap_pdo,\n\t\t\t&nfs_idmap_pipe_dir_object_ops,\n\t\t\tidmap);\n\n\tpipe = rpc_mkpipe_data(&idmap_upcall_ops, 0);\n\tif (IS_ERR(pipe)) {\n\t\terror = PTR_ERR(pipe);\n\t\tgoto err;\n\t}\n\tidmap->idmap_pipe = pipe;\n\tmutex_init(&idmap->idmap_mutex);\n\n\terror = rpc_add_pipe_dir_object(clp->cl_net,\n\t\t\t&clp->cl_rpcclient->cl_pipedir_objects,\n\t\t\t&idmap->idmap_pdo);\n\tif (error)\n\t\tgoto err_destroy_pipe;\n\n\tclp->cl_idmap = idmap;\n\treturn 0;\nerr_destroy_pipe:\n\trpc_destroy_pipe_data(idmap->idmap_pipe);\nerr:\n\tkfree(idmap);\n\treturn error;\n}"
  },
  {
    "function_name": "nfs_idmap_pipe_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "423-435",
    "snippet": "static int nfs_idmap_pipe_create(struct dentry *dir,\n\t\tstruct rpc_pipe_dir_object *pdo)\n{\n\tstruct idmap *idmap = pdo->pdo_data;\n\tstruct rpc_pipe *pipe = idmap->idmap_pipe;\n\tstruct dentry *dentry;\n\n\tdentry = rpc_mkpipe_dentry(dir, \"idmap\", idmap, pipe);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\tpipe->dentry = dentry;\n\treturn 0;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "dentry"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dentry"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rpc_mkpipe_dentry",
          "args": [
            "dir",
            "\"idmap\"",
            "idmap",
            "pipe"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic int nfs_idmap_pipe_create(struct dentry *dir,\n\t\tstruct rpc_pipe_dir_object *pdo)\n{\n\tstruct idmap *idmap = pdo->pdo_data;\n\tstruct rpc_pipe *pipe = idmap->idmap_pipe;\n\tstruct dentry *dentry;\n\n\tdentry = rpc_mkpipe_dentry(dir, \"idmap\", idmap, pipe);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\tpipe->dentry = dentry;\n\treturn 0;\n}"
  },
  {
    "function_name": "nfs_idmap_pipe_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "411-421",
    "snippet": "static void nfs_idmap_pipe_destroy(struct dentry *dir,\n\t\tstruct rpc_pipe_dir_object *pdo)\n{\n\tstruct idmap *idmap = pdo->pdo_data;\n\tstruct rpc_pipe *pipe = idmap->idmap_pipe;\n\n\tif (pipe->dentry) {\n\t\trpc_unlink(pipe->dentry);\n\t\tpipe->dentry = NULL;\n\t}\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rpc_unlink",
          "args": [
            "pipe->dentry"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_idmap_pipe_destroy(struct dentry *dir,\n\t\tstruct rpc_pipe_dir_object *pdo)\n{\n\tstruct idmap *idmap = pdo->pdo_data;\n\tstruct rpc_pipe *pipe = idmap->idmap_pipe;\n\n\tif (pipe->dentry) {\n\t\trpc_unlink(pipe->dentry);\n\t\tpipe->dentry = NULL;\n\t}\n}"
  },
  {
    "function_name": "nfs_idmap_lookup_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "354-370",
    "snippet": "static int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NFS_UINT_MAXLEN 11"
    ],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtol",
          "args": [
            "id_str",
            "10",
            "&id_long"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_get_key",
          "args": [
            "name",
            "namelen",
            "type",
            "id_str",
            "NFS_UINT_MAXLEN",
            "idmap"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "294-336",
          "snippet": "static ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cred *id_resolver_cache;",
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_idmap_lookup_id(const char *name, size_t namelen, const char *type,\n\t\t\t       __u32 *id, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tlong id_long;\n\tssize_t data_size;\n\tint ret = 0;\n\n\tdata_size = nfs_idmap_get_key(name, namelen, type, id_str, NFS_UINT_MAXLEN, idmap);\n\tif (data_size <= 0) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tret = kstrtol(id_str, 10, &id_long);\n\t\t*id = (__u32)id_long;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_lookup_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "339-351",
    "snippet": "static ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define NFS_UINT_MAXLEN 11"
    ],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_idmap_get_key",
          "args": [
            "id_str",
            "id_len",
            "type",
            "buf",
            "buflen",
            "idmap"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "294-336",
          "snippet": "static ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct cred *id_resolver_cache;",
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "id_str",
            "sizeof(id_str)",
            "\"%u\"",
            "id"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\n#define NFS_UINT_MAXLEN 11\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_lookup_name(__u32 id, const char *type, char *buf,\n\t\t\t\t     size_t buflen, struct idmap *idmap)\n{\n\tchar id_str[NFS_UINT_MAXLEN];\n\tint id_len;\n\tssize_t ret;\n\n\tid_len = snprintf(id_str, sizeof(id_str), \"%u\", id);\n\tret = nfs_idmap_get_key(id_str, id_len, type, buf, buflen, idmap);\n\tif (ret < 0)\n\t\treturn -EINVAL;\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_get_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "294-336",
    "snippet": "static ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cred *id_resolver_cache;",
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "rkey"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "expkey_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/export.c",
          "lines": "40-49",
          "snippet": "static void expkey_put(struct kref *ref)\n{\n\tstruct svc_expkey *key = container_of(ref, struct svc_expkey, h.ref);\n\n\tif (test_bit(CACHE_VALID, &key->h.flags) &&\n\t    !test_bit(CACHE_NEGATIVE, &key->h.flags))\n\t\tpath_put(&key->ek_path);\n\tauth_domain_put(key->ek_client);\n\tkfree(key);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"netns.h\"",
            "#include \"nfsfh.h\"",
            "#include \"nfsd.h\"",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/module.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct svc_expkey *svc_expkey_lookup(struct cache_detail *cd, struct svc_expkey *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"netns.h\"\n#include \"nfsfh.h\"\n#include \"nfsd.h\"\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/exportfs.h>\n#include <linux/module.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n\nstatic struct svc_expkey *svc_expkey_lookup(struct cache_detail *cd, struct svc_expkey *);\n\nstatic void expkey_put(struct kref *ref)\n{\n\tstruct svc_expkey *key = container_of(ref, struct svc_expkey, h.ref);\n\n\tif (test_bit(CACHE_VALID, &key->h.flags) &&\n\t    !test_bit(CACHE_NEGATIVE, &key->h.flags))\n\t\tpath_put(&key->ek_path);\n\tauth_domain_put(key->ek_client);\n\tkfree(key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "data",
            "payload->data",
            "ret"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "payload"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "payload"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_dereference",
          "args": [
            "rkey->payload.rcudata"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_validate",
          "args": [
            "rkey"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "rkey"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "rkey"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "revert_creds",
          "args": [
            "saved_cred"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_request_key",
          "args": [
            "name",
            "namelen",
            "type",
            "idmap"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_request_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "269-292",
          "snippet": "static struct key *nfs_idmap_request_key(const char *name, size_t namelen,\n\t\t\t\t\t const char *type, struct idmap *idmap)\n{\n\tchar *desc;\n\tstruct key *rkey;\n\tssize_t ret;\n\n\tret = nfs_idmap_get_desc(name, namelen, type, strlen(type), &desc);\n\tif (ret <= 0)\n\t\treturn ERR_PTR(ret);\n\n\trkey = request_key(&key_type_id_resolver, desc, \"\");\n\tif (IS_ERR(rkey)) {\n\t\tmutex_lock(&idmap->idmap_mutex);\n\t\trkey = request_key_with_auxdata(&key_type_id_resolver_legacy,\n\t\t\t\t\t\tdesc, \"\", 0, idmap);\n\t\tmutex_unlock(&idmap->idmap_mutex);\n\t}\n\tif (!IS_ERR(rkey))\n\t\tset_bit(KEY_FLAG_ROOT_CAN_INVAL, &rkey->flags);\n\n\tkfree(desc);\n\treturn rkey;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct key_type key_type_id_resolver_legacy;",
            "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);",
            "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic struct key *nfs_idmap_request_key(const char *name, size_t namelen,\n\t\t\t\t\t const char *type, struct idmap *idmap)\n{\n\tchar *desc;\n\tstruct key *rkey;\n\tssize_t ret;\n\n\tret = nfs_idmap_get_desc(name, namelen, type, strlen(type), &desc);\n\tif (ret <= 0)\n\t\treturn ERR_PTR(ret);\n\n\trkey = request_key(&key_type_id_resolver, desc, \"\");\n\tif (IS_ERR(rkey)) {\n\t\tmutex_lock(&idmap->idmap_mutex);\n\t\trkey = request_key_with_auxdata(&key_type_id_resolver_legacy,\n\t\t\t\t\t\tdesc, \"\", 0, idmap);\n\t\tmutex_unlock(&idmap->idmap_mutex);\n\t}\n\tif (!IS_ERR(rkey))\n\t\tset_bit(KEY_FLAG_ROOT_CAN_INVAL, &rkey->flags);\n\n\tkfree(desc);\n\treturn rkey;\n}"
        }
      },
      {
        "call_info": {
          "callee": "override_creds",
          "args": [
            "id_resolver_cache"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_get_key(const char *name, size_t namelen,\n\t\t\t\t const char *type, void *data,\n\t\t\t\t size_t data_size, struct idmap *idmap)\n{\n\tconst struct cred *saved_cred;\n\tstruct key *rkey;\n\tstruct user_key_payload *payload;\n\tssize_t ret;\n\n\tsaved_cred = override_creds(id_resolver_cache);\n\trkey = nfs_idmap_request_key(name, namelen, type, idmap);\n\trevert_creds(saved_cred);\n\n\tif (IS_ERR(rkey)) {\n\t\tret = PTR_ERR(rkey);\n\t\tgoto out;\n\t}\n\n\trcu_read_lock();\n\trkey->perm |= KEY_USR_VIEW;\n\n\tret = key_validate(rkey);\n\tif (ret < 0)\n\t\tgoto out_up;\n\n\tpayload = rcu_dereference(rkey->payload.rcudata);\n\tif (IS_ERR_OR_NULL(payload)) {\n\t\tret = PTR_ERR(payload);\n\t\tgoto out_up;\n\t}\n\n\tret = payload->datalen;\n\tif (ret > 0 && ret <= data_size)\n\t\tmemcpy(data, payload->data, ret);\n\telse\n\t\tret = -EINVAL;\n\nout_up:\n\trcu_read_unlock();\n\tkey_put(rkey);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_idmap_request_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "269-292",
    "snippet": "static struct key *nfs_idmap_request_key(const char *name, size_t namelen,\n\t\t\t\t\t const char *type, struct idmap *idmap)\n{\n\tchar *desc;\n\tstruct key *rkey;\n\tssize_t ret;\n\n\tret = nfs_idmap_get_desc(name, namelen, type, strlen(type), &desc);\n\tif (ret <= 0)\n\t\treturn ERR_PTR(ret);\n\n\trkey = request_key(&key_type_id_resolver, desc, \"\");\n\tif (IS_ERR(rkey)) {\n\t\tmutex_lock(&idmap->idmap_mutex);\n\t\trkey = request_key_with_auxdata(&key_type_id_resolver_legacy,\n\t\t\t\t\t\tdesc, \"\", 0, idmap);\n\t\tmutex_unlock(&idmap->idmap_mutex);\n\t}\n\tif (!IS_ERR(rkey))\n\t\tset_bit(KEY_FLAG_ROOT_CAN_INVAL, &rkey->flags);\n\n\tkfree(desc);\n\treturn rkey;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct key_type key_type_id_resolver_legacy;",
      "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);",
      "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "desc"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "KEY_FLAG_ROOT_CAN_INVAL",
            "&rkey->flags"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "rkey"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&idmap->idmap_mutex"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_key_with_auxdata",
          "args": [
            "&key_type_id_resolver_legacy",
            "desc",
            "\"\"",
            "0",
            "idmap"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&idmap->idmap_mutex"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "rkey"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_key",
          "args": [
            "&key_type_id_resolver",
            "desc",
            "\"\""
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_idmap_get_desc",
          "args": [
            "name",
            "namelen",
            "type",
            "strlen(type)",
            "&desc"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_idmap_get_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "248-267",
          "snippet": "static ssize_t nfs_idmap_get_desc(const char *name, size_t namelen,\n\t\t\t\tconst char *type, size_t typelen, char **desc)\n{\n\tchar *cp;\n\tsize_t desclen = typelen + namelen + 2;\n\n\t*desc = kmalloc(desclen, GFP_KERNEL);\n\tif (!*desc)\n\t\treturn -ENOMEM;\n\n\tcp = *desc;\n\tmemcpy(cp, type, typelen);\n\tcp += typelen;\n\t*cp++ = ':';\n\n\tmemcpy(cp, name, namelen);\n\tcp += namelen;\n\t*cp = '\\0';\n\treturn desclen;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_get_desc(const char *name, size_t namelen,\n\t\t\t\tconst char *type, size_t typelen, char **desc)\n{\n\tchar *cp;\n\tsize_t desclen = typelen + namelen + 2;\n\n\t*desc = kmalloc(desclen, GFP_KERNEL);\n\tif (!*desc)\n\t\treturn -ENOMEM;\n\n\tcp = *desc;\n\tmemcpy(cp, type, typelen);\n\tcp += typelen;\n\t*cp++ = ':';\n\n\tmemcpy(cp, name, namelen);\n\tcp += namelen;\n\t*cp = '\\0';\n\treturn desclen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "type"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic struct key *nfs_idmap_request_key(const char *name, size_t namelen,\n\t\t\t\t\t const char *type, struct idmap *idmap)\n{\n\tchar *desc;\n\tstruct key *rkey;\n\tssize_t ret;\n\n\tret = nfs_idmap_get_desc(name, namelen, type, strlen(type), &desc);\n\tif (ret <= 0)\n\t\treturn ERR_PTR(ret);\n\n\trkey = request_key(&key_type_id_resolver, desc, \"\");\n\tif (IS_ERR(rkey)) {\n\t\tmutex_lock(&idmap->idmap_mutex);\n\t\trkey = request_key_with_auxdata(&key_type_id_resolver_legacy,\n\t\t\t\t\t\tdesc, \"\", 0, idmap);\n\t\tmutex_unlock(&idmap->idmap_mutex);\n\t}\n\tif (!IS_ERR(rkey))\n\t\tset_bit(KEY_FLAG_ROOT_CAN_INVAL, &rkey->flags);\n\n\tkfree(desc);\n\treturn rkey;\n}"
  },
  {
    "function_name": "nfs_idmap_get_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "248-267",
    "snippet": "static ssize_t nfs_idmap_get_desc(const char *name, size_t namelen,\n\t\t\t\tconst char *type, size_t typelen, char **desc)\n{\n\tchar *cp;\n\tsize_t desclen = typelen + namelen + 2;\n\n\t*desc = kmalloc(desclen, GFP_KERNEL);\n\tif (!*desc)\n\t\treturn -ENOMEM;\n\n\tcp = *desc;\n\tmemcpy(cp, type, typelen);\n\tcp += typelen;\n\t*cp++ = ':';\n\n\tmemcpy(cp, name, namelen);\n\tcp += namelen;\n\t*cp = '\\0';\n\treturn desclen;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cp",
            "name",
            "namelen"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cp",
            "type",
            "typelen"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "desclen",
            "GFP_KERNEL"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic ssize_t nfs_idmap_get_desc(const char *name, size_t namelen,\n\t\t\t\tconst char *type, size_t typelen, char **desc)\n{\n\tchar *cp;\n\tsize_t desclen = typelen + namelen + 2;\n\n\t*desc = kmalloc(desclen, GFP_KERNEL);\n\tif (!*desc)\n\t\treturn -ENOMEM;\n\n\tcp = *desc;\n\tmemcpy(cp, type, typelen);\n\tcp += typelen;\n\t*cp++ = ':';\n\n\tmemcpy(cp, name, namelen);\n\tcp += namelen;\n\t*cp = '\\0';\n\treturn desclen;\n}"
  },
  {
    "function_name": "nfs_idmap_quit_keyring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "233-239",
    "snippet": "static void nfs_idmap_quit_keyring(void)\n{\n\tkey_revoke(id_resolver_cache->thread_keyring);\n\tunregister_key_type(&key_type_id_resolver);\n\tunregister_key_type(&key_type_id_resolver_legacy);\n\tput_cred(id_resolver_cache);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cred *id_resolver_cache;",
      "static struct key_type key_type_id_resolver_legacy;",
      "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
      "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_cred",
          "args": [
            "id_resolver_cache"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_key_type",
          "args": [
            "&key_type_id_resolver_legacy"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_key_type",
          "args": [
            "&key_type_id_resolver"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_revoke",
          "args": [
            "id_resolver_cache->thread_keyring"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic void nfs_idmap_quit_keyring(void)\n{\n\tkey_revoke(id_resolver_cache->thread_keyring);\n\tunregister_key_type(&key_type_id_resolver);\n\tunregister_key_type(&key_type_id_resolver_legacy);\n\tput_cred(id_resolver_cache);\n}"
  },
  {
    "function_name": "nfs_idmap_init_keyring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "187-231",
    "snippet": "static int nfs_idmap_init_keyring(void)\n{\n\tstruct cred *cred;\n\tstruct key *keyring;\n\tint ret = 0;\n\n\tprintk(KERN_NOTICE \"NFS: Registering the %s key type\\n\",\n\t\tkey_type_id_resolver.name);\n\n\tcred = prepare_kernel_cred(NULL);\n\tif (!cred)\n\t\treturn -ENOMEM;\n\n\tkeyring = keyring_alloc(\".id_resolver\",\n\t\t\t\tGLOBAL_ROOT_UID, GLOBAL_ROOT_GID, cred,\n\t\t\t\t(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ,\n\t\t\t\tKEY_ALLOC_NOT_IN_QUOTA, NULL);\n\tif (IS_ERR(keyring)) {\n\t\tret = PTR_ERR(keyring);\n\t\tgoto failed_put_cred;\n\t}\n\n\tret = register_key_type(&key_type_id_resolver);\n\tif (ret < 0)\n\t\tgoto failed_put_key;\n\n\tret = register_key_type(&key_type_id_resolver_legacy);\n\tif (ret < 0)\n\t\tgoto failed_reg_legacy;\n\n\tset_bit(KEY_FLAG_ROOT_CAN_CLEAR, &keyring->flags);\n\tcred->thread_keyring = keyring;\n\tcred->jit_keyring = KEY_REQKEY_DEFL_THREAD_KEYRING;\n\tid_resolver_cache = cred;\n\treturn 0;\n\nfailed_reg_legacy:\n\tunregister_key_type(&key_type_id_resolver);\nfailed_put_key:\n\tkey_put(keyring);\nfailed_put_cred:\n\tput_cred(cred);\n\treturn ret;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct cred *id_resolver_cache;",
      "static struct key_type key_type_id_resolver_legacy;",
      "static struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};",
      "static struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_cred",
          "args": [
            "cred"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "keyring"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "expkey_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfsd/export.c",
          "lines": "40-49",
          "snippet": "static void expkey_put(struct kref *ref)\n{\n\tstruct svc_expkey *key = container_of(ref, struct svc_expkey, h.ref);\n\n\tif (test_bit(CACHE_VALID, &key->h.flags) &&\n\t    !test_bit(CACHE_NEGATIVE, &key->h.flags))\n\t\tpath_put(&key->ek_path);\n\tauth_domain_put(key->ek_client);\n\tkfree(key);\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"netns.h\"",
            "#include \"nfsfh.h\"",
            "#include \"nfsd.h\"",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/module.h>",
            "#include <linux/namei.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct svc_expkey *svc_expkey_lookup(struct cache_detail *cd, struct svc_expkey *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"netns.h\"\n#include \"nfsfh.h\"\n#include \"nfsd.h\"\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/exportfs.h>\n#include <linux/module.h>\n#include <linux/namei.h>\n#include <linux/slab.h>\n\nstatic struct svc_expkey *svc_expkey_lookup(struct cache_detail *cd, struct svc_expkey *);\n\nstatic void expkey_put(struct kref *ref)\n{\n\tstruct svc_expkey *key = container_of(ref, struct svc_expkey, h.ref);\n\n\tif (test_bit(CACHE_VALID, &key->h.flags) &&\n\t    !test_bit(CACHE_NEGATIVE, &key->h.flags))\n\t\tpath_put(&key->ek_path);\n\tauth_domain_put(key->ek_client);\n\tkfree(key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_key_type",
          "args": [
            "&key_type_id_resolver"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "KEY_FLAG_ROOT_CAN_CLEAR",
            "&keyring->flags"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_key_type",
          "args": [
            "&key_type_id_resolver_legacy"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_key_type",
          "args": [
            "&key_type_id_resolver"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "keyring"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "keyring"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyring_alloc",
          "args": [
            "\".id_resolver\"",
            "GLOBAL_ROOT_UID",
            "GLOBAL_ROOT_GID",
            "cred",
            "(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ",
            "KEY_ALLOC_NOT_IN_QUOTA",
            "NULL"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_kernel_cred",
          "args": [
            "NULL"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"NFS: Registering the %s key type\\n\"",
            "key_type_id_resolver.name"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic const struct cred *id_resolver_cache;\nstatic struct key_type key_type_id_resolver_legacy;\nstatic struct key_type key_type_id_resolver = {\n\t.name\t\t= \"id_resolver\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n};\nstatic struct key_type key_type_id_resolver_legacy = {\n\t.name\t\t= \"id_legacy\",\n\t.preparse\t= user_preparse,\n\t.free_preparse\t= user_free_preparse,\n\t.instantiate\t= generic_key_instantiate,\n\t.revoke\t\t= user_revoke,\n\t.destroy\t= user_destroy,\n\t.describe\t= user_describe,\n\t.read\t\t= user_read,\n\t.request_key\t= nfs_idmap_legacy_upcall,\n};\n\nstatic int nfs_idmap_init_keyring(void)\n{\n\tstruct cred *cred;\n\tstruct key *keyring;\n\tint ret = 0;\n\n\tprintk(KERN_NOTICE \"NFS: Registering the %s key type\\n\",\n\t\tkey_type_id_resolver.name);\n\n\tcred = prepare_kernel_cred(NULL);\n\tif (!cred)\n\t\treturn -ENOMEM;\n\n\tkeyring = keyring_alloc(\".id_resolver\",\n\t\t\t\tGLOBAL_ROOT_UID, GLOBAL_ROOT_GID, cred,\n\t\t\t\t(KEY_POS_ALL & ~KEY_POS_SETATTR) |\n\t\t\t\tKEY_USR_VIEW | KEY_USR_READ,\n\t\t\t\tKEY_ALLOC_NOT_IN_QUOTA, NULL);\n\tif (IS_ERR(keyring)) {\n\t\tret = PTR_ERR(keyring);\n\t\tgoto failed_put_cred;\n\t}\n\n\tret = register_key_type(&key_type_id_resolver);\n\tif (ret < 0)\n\t\tgoto failed_put_key;\n\n\tret = register_key_type(&key_type_id_resolver_legacy);\n\tif (ret < 0)\n\t\tgoto failed_reg_legacy;\n\n\tset_bit(KEY_FLAG_ROOT_CAN_CLEAR, &keyring->flags);\n\tcred->thread_keyring = keyring;\n\tcred->jit_keyring = KEY_REQKEY_DEFL_THREAD_KEYRING;\n\tid_resolver_cache = cred;\n\treturn 0;\n\nfailed_reg_legacy:\n\tunregister_key_type(&key_type_id_resolver);\nfailed_put_key:\n\tkey_put(keyring);\nfailed_put_cred:\n\tput_cred(cred);\n\treturn ret;\n}"
  },
  {
    "function_name": "nfs_map_numeric_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "171-174",
    "snippet": "static int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "buflen",
            "\"%u\"",
            "id"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nstatic int nfs_map_numeric_to_string(__u32 id, char *buf, size_t buflen)\n{\n\treturn snprintf(buf, buflen, \"%u\", id);\n}"
  },
  {
    "function_name": "nfs_map_string_to_numeric",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "155-168",
    "snippet": "int nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoul",
          "args": [
            "buf",
            "0",
            "&val"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "name",
            "namelen"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "name",
            "'@'",
            "namelen"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_string_to_numeric(const char *name, size_t namelen, __u32 *res)\n{\n\tunsigned long val;\n\tchar buf[16];\n\n\tif (memchr(name, '@', namelen) != NULL || namelen >= sizeof(buf))\n\t\treturn 0;\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tif (kstrtoul(buf, 0, &val) != 0)\n\t\treturn 0;\n\t*res = val;\n\treturn 1;\n}"
  },
  {
    "function_name": "nfs_fattr_map_and_free_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "147-153",
    "snippet": "void nfs_fattr_map_and_free_names(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tif (nfs_fattr_map_owner_name(server, fattr))\n\t\tnfs_fattr_free_owner_name(fattr);\n\tif (nfs_fattr_map_group_name(server, fattr))\n\t\tnfs_fattr_free_group_name(fattr);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_free_group_name",
          "args": [
            "fattr"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_free_group_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "93-97",
          "snippet": "static void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_map_group_name",
          "args": [
            "server",
            "fattr"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_map_group_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "113-125",
          "snippet": "static bool nfs_fattr_map_group_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *group = fattr->group_name;\n\tkgid_t gid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_GROUP_NAME))\n\t\treturn false;\n\tif (nfs_map_group_to_gid(server, group->data, group->len, &gid) == 0) {\n\t\tfattr->gid = gid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_GROUP;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool nfs_fattr_map_group_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *group = fattr->group_name;\n\tkgid_t gid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_GROUP_NAME))\n\t\treturn false;\n\tif (nfs_map_group_to_gid(server, group->data, group->len, &gid) == 0) {\n\t\tfattr->gid = gid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_GROUP;\n\t}\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_free_owner_name",
          "args": [
            "fattr"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_free_owner_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "87-91",
          "snippet": "static void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_map_owner_name",
          "args": [
            "server",
            "fattr"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_map_owner_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "99-111",
          "snippet": "static bool nfs_fattr_map_owner_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *owner = fattr->owner_name;\n\tkuid_t uid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_OWNER_NAME))\n\t\treturn false;\n\tif (nfs_map_name_to_uid(server, owner->data, owner->len, &uid) == 0) {\n\t\tfattr->uid = uid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_OWNER;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool nfs_fattr_map_owner_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *owner = fattr->owner_name;\n\tkuid_t uid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_OWNER_NAME))\n\t\treturn false;\n\tif (nfs_map_name_to_uid(server, owner->data, owner->len, &uid) == 0) {\n\t\tfattr->uid = uid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_OWNER;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_fattr_map_and_free_names(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tif (nfs_fattr_map_owner_name(server, fattr))\n\t\tnfs_fattr_free_owner_name(fattr);\n\tif (nfs_fattr_map_group_name(server, fattr))\n\t\tnfs_fattr_free_group_name(fattr);\n}"
  },
  {
    "function_name": "nfs_fattr_free_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "131-137",
    "snippet": "void nfs_fattr_free_names(struct nfs_fattr *fattr)\n{\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER_NAME)\n\t\tnfs_fattr_free_owner_name(fattr);\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP_NAME)\n\t\tnfs_fattr_free_group_name(fattr);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_fattr_free_group_name",
          "args": [
            "fattr"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_free_group_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "93-97",
          "snippet": "static void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nfs_fattr_free_owner_name",
          "args": [
            "fattr"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_fattr_free_owner_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "87-91",
          "snippet": "static void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_fattr_free_names(struct nfs_fattr *fattr)\n{\n\tif (fattr->valid & NFS_ATTR_FATTR_OWNER_NAME)\n\t\tnfs_fattr_free_owner_name(fattr);\n\tif (fattr->valid & NFS_ATTR_FATTR_GROUP_NAME)\n\t\tnfs_fattr_free_group_name(fattr);\n}"
  },
  {
    "function_name": "nfs_fattr_map_group_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "113-125",
    "snippet": "static bool nfs_fattr_map_group_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *group = fattr->group_name;\n\tkgid_t gid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_GROUP_NAME))\n\t\treturn false;\n\tif (nfs_map_group_to_gid(server, group->data, group->len, &gid) == 0) {\n\t\tfattr->gid = gid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_GROUP;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_map_group_to_gid",
          "args": [
            "server",
            "group->data",
            "group->len",
            "&gid"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_group_to_gid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "748-763",
          "snippet": "int nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_group_to_gid(const struct nfs_server *server, const char *name, size_t namelen, kgid_t *gid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"gid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*gid = make_kgid(&init_user_ns, id);\n\t\tif (!gid_valid(*gid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_group_to_gid(name, namelen, id, ret);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool nfs_fattr_map_group_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *group = fattr->group_name;\n\tkgid_t gid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_GROUP_NAME))\n\t\treturn false;\n\tif (nfs_map_group_to_gid(server, group->data, group->len, &gid) == 0) {\n\t\tfattr->gid = gid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_GROUP;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "nfs_fattr_map_owner_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "99-111",
    "snippet": "static bool nfs_fattr_map_owner_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *owner = fattr->owner_name;\n\tkuid_t uid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_OWNER_NAME))\n\t\treturn false;\n\tif (nfs_map_name_to_uid(server, owner->data, owner->len, &uid) == 0) {\n\t\tfattr->uid = uid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_OWNER;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_map_name_to_uid",
          "args": [
            "server",
            "owner->data",
            "owner->len",
            "&uid"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_map_name_to_uid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
          "lines": "731-746",
          "snippet": "int nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"netns.h\"",
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/nfs_fs_sb.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/sunrpc/rpc_pipe_fs.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/fs.h>",
            "#include <linux/parser.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic ssize_t idmap_pipe_downcall(struct file *, const char __user *,\n\t\t\t\t   size_t);\n\nint nfs_map_name_to_uid(const struct nfs_server *server, const char *name, size_t namelen, kuid_t *uid)\n{\n\tstruct idmap *idmap = server->nfs_client->cl_idmap;\n\t__u32 id = -1;\n\tint ret = 0;\n\n\tif (!nfs_map_string_to_numeric(name, namelen, &id))\n\t\tret = nfs_idmap_lookup_id(name, namelen, \"uid\", &id, idmap);\n\tif (ret == 0) {\n\t\t*uid = make_kuid(&init_user_ns, id);\n\t\tif (!uid_valid(*uid))\n\t\t\tret = -ERANGE;\n\t}\n\ttrace_nfs4_map_name_to_uid(name, namelen, id, ret);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic bool nfs_fattr_map_owner_name(struct nfs_server *server, struct nfs_fattr *fattr)\n{\n\tstruct nfs4_string *owner = fattr->owner_name;\n\tkuid_t uid;\n\n\tif (!(fattr->valid & NFS_ATTR_FATTR_OWNER_NAME))\n\t\treturn false;\n\tif (nfs_map_name_to_uid(server, owner->data, owner->len, &uid) == 0) {\n\t\tfattr->uid = uid;\n\t\tfattr->valid |= NFS_ATTR_FATTR_OWNER;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "nfs_fattr_free_group_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "93-97",
    "snippet": "static void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "fattr->group_name->data"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_group_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_GROUP_NAME;\n\tkfree(fattr->group_name->data);\n}"
  },
  {
    "function_name": "nfs_fattr_free_owner_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "87-91",
    "snippet": "static void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "fattr->owner_name->data"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nstatic void nfs_fattr_free_owner_name(struct nfs_fattr *fattr)\n{\n\tfattr->valid &= ~NFS_ATTR_FATTR_OWNER_NAME;\n\tkfree(fattr->owner_name->data);\n}"
  },
  {
    "function_name": "nfs_fattr_init_names",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/idmap.c",
    "lines": "79-85",
    "snippet": "void nfs_fattr_init_names(struct nfs_fattr *fattr,\n\t\tstruct nfs4_string *owner_name,\n\t\tstruct nfs4_string *group_name)\n{\n\tfattr->owner_name = owner_name;\n\tfattr->group_name = group_name;\n}",
    "includes": [
      "#include \"nfs4trace.h\"",
      "#include \"netns.h\"",
      "#include \"internal.h\"",
      "#include <linux/module.h>",
      "#include <keys/user-type.h>",
      "#include <linux/key-type.h>",
      "#include <linux/keyctl.h>",
      "#include <linux/key.h>",
      "#include <linux/nfs_fs_sb.h>",
      "#include <linux/nfs_fs.h>",
      "#include <linux/sunrpc/rpc_pipe_fs.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/nfs_idmap.h>",
      "#include <linux/fs.h>",
      "#include <linux/parser.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"netns.h\"\n#include \"internal.h\"\n#include <linux/module.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/nfs_fs_sb.h>\n#include <linux/nfs_fs.h>\n#include <linux/sunrpc/rpc_pipe_fs.h>\n#include <net/net_namespace.h>\n#include <linux/nfs_idmap.h>\n#include <linux/fs.h>\n#include <linux/parser.h>\n#include <linux/types.h>\n\nvoid nfs_fattr_init_names(struct nfs_fattr *fattr,\n\t\tstruct nfs4_string *owner_name,\n\t\tstruct nfs4_string *group_name)\n{\n\tfattr->owner_name = owner_name;\n\tfattr->group_name = group_name;\n}"
  }
]