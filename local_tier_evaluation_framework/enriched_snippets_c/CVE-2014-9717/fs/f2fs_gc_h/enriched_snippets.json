[
  {
    "function_name": "is_idle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "104-110",
    "snippet": "static inline int is_idle(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\tstruct request_list *rl = &q->root_rl;\n\treturn !(rl->count[BLK_RW_SYNC]) && !(rl->count[BLK_RW_ASYNC]);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdev_get_queue",
          "args": [
            "bdev"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int is_idle(struct f2fs_sb_info *sbi)\n{\n\tstruct block_device *bdev = sbi->sb->s_bdev;\n\tstruct request_queue *q = bdev_get_queue(bdev);\n\tstruct request_list *rl = &q->root_rl;\n\treturn !(rl->count[BLK_RW_SYNC]) && !(rl->count[BLK_RW_ASYNC]);\n}"
  },
  {
    "function_name": "has_enough_invalid_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "89-102",
    "snippet": "static inline bool has_enough_invalid_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t invalid_user_blocks = sbi->user_block_count -\n\t\t\t\t\twritten_block_count(sbi);\n\t/*\n\t * Background GC is triggered with the following conditions.\n\t * 1. There are a number of invalid blocks.\n\t * 2. There is not enough free space.\n\t */\n\tif (invalid_user_blocks > limit_invalid_user_blocks(sbi) &&\n\t\t\tfree_user_blocks(sbi) < limit_free_user_blocks(sbi))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "limit_free_user_blocks",
          "args": [
            "sbi"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "limit_free_user_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
          "lines": "60-65",
          "snippet": "static inline block_t limit_free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t reclaimable_user_blocks = sbi->user_block_count -\n\t\twritten_block_count(sbi);\n\treturn (long)(reclaimable_user_blocks * LIMIT_FREE_BLOCK) / 100;\n}",
          "includes": [],
          "macros_used": [
            "#define LIMIT_FREE_BLOCK\t40 /* percentage over invalid + free space */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define LIMIT_FREE_BLOCK\t40 /* percentage over invalid + free space */\n\nstatic inline block_t limit_free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t reclaimable_user_blocks = sbi->user_block_count -\n\t\twritten_block_count(sbi);\n\treturn (long)(reclaimable_user_blocks * LIMIT_FREE_BLOCK) / 100;\n}"
        }
      },
      {
        "call_info": {
          "callee": "limit_invalid_user_blocks",
          "args": [
            "sbi"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "limit_invalid_user_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
          "lines": "55-58",
          "snippet": "static inline block_t limit_invalid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn (long)(sbi->user_block_count * LIMIT_INVALID_BLOCK) / 100;\n}",
          "includes": [],
          "macros_used": [
            "#define LIMIT_INVALID_BLOCK\t40 /* percentage over total user space */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define LIMIT_INVALID_BLOCK\t40 /* percentage over total user space */\n\nstatic inline block_t limit_invalid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn (long)(sbi->user_block_count * LIMIT_INVALID_BLOCK) / 100;\n}"
        }
      },
      {
        "call_info": {
          "callee": "written_block_count",
          "args": [
            "sbi"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "written_block_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "401-404",
          "snippet": "static inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline bool has_enough_invalid_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t invalid_user_blocks = sbi->user_block_count -\n\t\t\t\t\twritten_block_count(sbi);\n\t/*\n\t * Background GC is triggered with the following conditions.\n\t * 1. There are a number of invalid blocks.\n\t * 2. There is not enough free space.\n\t */\n\tif (invalid_user_blocks > limit_invalid_user_blocks(sbi) &&\n\t\t\tfree_user_blocks(sbi) < limit_free_user_blocks(sbi))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "decrease_sleep_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "78-87",
    "snippet": "static inline void decrease_sleep_time(struct f2fs_gc_kthread *gc_th,\n\t\t\t\t\t\t\t\tlong *wait)\n{\n\tif (*wait == gc_th->no_gc_sleep_time)\n\t\t*wait = gc_th->max_sleep_time;\n\n\t*wait -= gc_th->min_sleep_time;\n\tif (*wait <= gc_th->min_sleep_time)\n\t\t*wait = gc_th->min_sleep_time;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void decrease_sleep_time(struct f2fs_gc_kthread *gc_th,\n\t\t\t\t\t\t\t\tlong *wait)\n{\n\tif (*wait == gc_th->no_gc_sleep_time)\n\t\t*wait = gc_th->max_sleep_time;\n\n\t*wait -= gc_th->min_sleep_time;\n\tif (*wait <= gc_th->min_sleep_time)\n\t\t*wait = gc_th->min_sleep_time;\n}"
  },
  {
    "function_name": "increase_sleep_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "67-76",
    "snippet": "static inline void increase_sleep_time(struct f2fs_gc_kthread *gc_th,\n\t\t\t\t\t\t\t\tlong *wait)\n{\n\tif (*wait == gc_th->no_gc_sleep_time)\n\t\treturn;\n\n\t*wait += gc_th->min_sleep_time;\n\tif (*wait > gc_th->max_sleep_time)\n\t\t*wait = gc_th->max_sleep_time;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void increase_sleep_time(struct f2fs_gc_kthread *gc_th,\n\t\t\t\t\t\t\t\tlong *wait)\n{\n\tif (*wait == gc_th->no_gc_sleep_time)\n\t\treturn;\n\n\t*wait += gc_th->min_sleep_time;\n\tif (*wait > gc_th->max_sleep_time)\n\t\t*wait = gc_th->max_sleep_time;\n}"
  },
  {
    "function_name": "limit_free_user_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "60-65",
    "snippet": "static inline block_t limit_free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t reclaimable_user_blocks = sbi->user_block_count -\n\t\twritten_block_count(sbi);\n\treturn (long)(reclaimable_user_blocks * LIMIT_FREE_BLOCK) / 100;\n}",
    "includes": [],
    "macros_used": [
      "#define LIMIT_FREE_BLOCK\t40 /* percentage over invalid + free space */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "written_block_count",
          "args": [
            "sbi"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "written_block_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "401-404",
          "snippet": "static inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline block_t written_block_count(struct f2fs_sb_info *sbi)\n{\n\treturn SIT_I(sbi)->written_valid_blocks;\n}"
        }
      }
    ],
    "contextual_snippet": "#define LIMIT_FREE_BLOCK\t40 /* percentage over invalid + free space */\n\nstatic inline block_t limit_free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tblock_t reclaimable_user_blocks = sbi->user_block_count -\n\t\twritten_block_count(sbi);\n\treturn (long)(reclaimable_user_blocks * LIMIT_FREE_BLOCK) / 100;\n}"
  },
  {
    "function_name": "limit_invalid_user_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "55-58",
    "snippet": "static inline block_t limit_invalid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn (long)(sbi->user_block_count * LIMIT_INVALID_BLOCK) / 100;\n}",
    "includes": [],
    "macros_used": [
      "#define LIMIT_INVALID_BLOCK\t40 /* percentage over total user space */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define LIMIT_INVALID_BLOCK\t40 /* percentage over total user space */\n\nstatic inline block_t limit_invalid_user_blocks(struct f2fs_sb_info *sbi)\n{\n\treturn (long)(sbi->user_block_count * LIMIT_INVALID_BLOCK) / 100;\n}"
  },
  {
    "function_name": "free_user_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/gc.h",
    "lines": "46-53",
    "snippet": "static inline block_t free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tif (free_segments(sbi) < overprovision_segments(sbi))\n\t\treturn 0;\n\telse\n\t\treturn (free_segments(sbi) - overprovision_segments(sbi))\n\t\t\t<< sbi->log_blocks_per_seg;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "overprovision_segments",
          "args": [
            "sbi"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "overprovision_segments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/segment.h",
          "lines": "436-439",
          "snippet": "static inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}",
          "includes": [
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/blkdev.h>\n\nstatic inline int overprovision_segments(struct f2fs_sb_info *sbi)\n{\n\treturn SM_I(sbi)->ovp_segments;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_segments",
          "args": [
            "sbi"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "no_free_segments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/logfs/gc.c",
          "lines": "31-36",
          "snippet": "static int no_free_segments(struct super_block *sb)\n{\n\tstruct logfs_super *super = logfs_super(sb);\n\n\treturn super->s_free_list.count;\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include \"logfs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/sched.h>\n#include \"logfs.h\"\n\nstatic int no_free_segments(struct super_block *sb)\n{\n\tstruct logfs_super *super = logfs_super(sb);\n\n\treturn super->s_free_list.count;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline block_t free_user_blocks(struct f2fs_sb_info *sbi)\n{\n\tif (free_segments(sbi) < overprovision_segments(sbi))\n\t\treturn 0;\n\telse\n\t\treturn (free_segments(sbi) - overprovision_segments(sbi))\n\t\t\t<< sbi->log_blocks_per_seg;\n}"
  }
]