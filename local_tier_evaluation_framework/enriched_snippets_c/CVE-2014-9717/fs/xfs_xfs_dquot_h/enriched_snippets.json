[
  {
    "function_name": "xfs_qm_dqhold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "180-186",
    "snippet": "static inline struct xfs_dquot *xfs_qm_dqhold(struct xfs_dquot *dqp)\n{\n\txfs_dqlock(dqp);\n\tdqp->q_nrefs++;\n\txfs_dqunlock(dqp);\n\treturn dqp;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_dqunlock",
          "args": [
            "dqp"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_dqunlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
          "lines": "109-112",
          "snippet": "static inline void xfs_dqunlock(struct xfs_dquot *dqp)\n{\n\tmutex_unlock(&dqp->q_qlock);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void xfs_dqunlock(struct xfs_dquot *dqp)\n{\n\tmutex_unlock(&dqp->q_qlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_dqlock",
          "args": [
            "dqp"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_dqlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
          "lines": "104-107",
          "snippet": "static inline void xfs_dqlock(struct xfs_dquot *dqp)\n{\n\tmutex_lock(&dqp->q_qlock);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void xfs_dqlock(struct xfs_dquot *dqp)\n{\n\tmutex_lock(&dqp->q_qlock);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct xfs_dquot *xfs_qm_dqhold(struct xfs_dquot *dqp)\n{\n\txfs_dqlock(dqp);\n\tdqp->q_nrefs++;\n\txfs_dqunlock(dqp);\n\treturn dqp;\n}"
  },
  {
    "function_name": "xfs_dquot_lowsp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "146-155",
    "snippet": "static inline bool xfs_dquot_lowsp(struct xfs_dquot *dqp)\n{\n\tint64_t freesp;\n\n\tfreesp = be64_to_cpu(dqp->q_core.d_blk_hardlimit) - dqp->q_res_bcount;\n\tif (freesp < dqp->q_low_space[XFS_QLOWSP_1_PCNT])\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be64_to_cpu",
          "args": [
            "dqp->q_core.d_blk_hardlimit"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline bool xfs_dquot_lowsp(struct xfs_dquot *dqp)\n{\n\tint64_t freesp;\n\n\tfreesp = be64_to_cpu(dqp->q_core.d_blk_hardlimit) - dqp->q_res_bcount;\n\tif (freesp < dqp->q_low_space[XFS_QLOWSP_1_PCNT])\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "xfs_inode_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "128-140",
    "snippet": "static inline xfs_dquot_t *xfs_inode_dquot(struct xfs_inode *ip, int type)\n{\n\tswitch (type & XFS_DQ_ALLTYPES) {\n\tcase XFS_DQ_USER:\n\t\treturn ip->i_udquot;\n\tcase XFS_DQ_GROUP:\n\t\treturn ip->i_gdquot;\n\tcase XFS_DQ_PROJ:\n\t\treturn ip->i_pdquot;\n\tdefault:\n\t\treturn NULL;\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline xfs_dquot_t *xfs_inode_dquot(struct xfs_inode *ip, int type)\n{\n\tswitch (type & XFS_DQ_ALLTYPES) {\n\tcase XFS_DQ_USER:\n\t\treturn ip->i_udquot;\n\tcase XFS_DQ_GROUP:\n\t\treturn ip->i_gdquot;\n\tcase XFS_DQ_PROJ:\n\t\treturn ip->i_pdquot;\n\tdefault:\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "xfs_this_quota_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "114-126",
    "snippet": "static inline int xfs_this_quota_on(struct xfs_mount *mp, int type)\n{\n\tswitch (type & XFS_DQ_ALLTYPES) {\n\tcase XFS_DQ_USER:\n\t\treturn XFS_IS_UQUOTA_ON(mp);\n\tcase XFS_DQ_GROUP:\n\t\treturn XFS_IS_GQUOTA_ON(mp);\n\tcase XFS_DQ_PROJ:\n\t\treturn XFS_IS_PQUOTA_ON(mp);\n\tdefault:\n\t\treturn 0;\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XFS_IS_PQUOTA_ON",
          "args": [
            "mp"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XFS_IS_GQUOTA_ON",
          "args": [
            "mp"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XFS_IS_UQUOTA_ON",
          "args": [
            "mp"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int xfs_this_quota_on(struct xfs_mount *mp, int type)\n{\n\tswitch (type & XFS_DQ_ALLTYPES) {\n\tcase XFS_DQ_USER:\n\t\treturn XFS_IS_UQUOTA_ON(mp);\n\tcase XFS_DQ_GROUP:\n\t\treturn XFS_IS_GQUOTA_ON(mp);\n\tcase XFS_DQ_PROJ:\n\t\treturn XFS_IS_PQUOTA_ON(mp);\n\tdefault:\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "xfs_dqunlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "109-112",
    "snippet": "static inline void xfs_dqunlock(struct xfs_dquot *dqp)\n{\n\tmutex_unlock(&dqp->q_qlock);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqp->q_qlock"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void xfs_dqunlock(struct xfs_dquot *dqp)\n{\n\tmutex_unlock(&dqp->q_qlock);\n}"
  },
  {
    "function_name": "xfs_dqlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "104-107",
    "snippet": "static inline void xfs_dqlock(struct xfs_dquot *dqp)\n{\n\tmutex_lock(&dqp->q_qlock);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqp->q_qlock"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void xfs_dqlock(struct xfs_dquot *dqp)\n{\n\tmutex_lock(&dqp->q_qlock);\n}"
  },
  {
    "function_name": "xfs_dqlock_nowait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "99-102",
    "snippet": "static inline int xfs_dqlock_nowait(struct xfs_dquot *dqp)\n{\n\treturn mutex_trylock(&dqp->q_qlock);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_trylock",
          "args": [
            "&dqp->q_qlock"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int xfs_dqlock_nowait(struct xfs_dquot *dqp)\n{\n\treturn mutex_trylock(&dqp->q_qlock);\n}"
  },
  {
    "function_name": "xfs_dqfunlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "94-97",
    "snippet": "static inline void xfs_dqfunlock(xfs_dquot_t *dqp)\n{\n\tcomplete(&dqp->q_flush);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&dqp->q_flush"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "dio_aio_complete_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/direct-io.c",
          "lines": "275-280",
          "snippet": "static void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}",
          "includes": [
            "#include <linux/aio.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/atomic.h>",
            "#include <linux/uio.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/err.h>",
            "#include <linux/wait.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/aio.h>\n#include <linux/prefetch.h>\n#include <linux/atomic.h>\n#include <linux/uio.h>\n#include <linux/rwsem.h>\n#include <linux/buffer_head.h>\n#include <linux/blkdev.h>\n#include <linux/err.h>\n#include <linux/wait.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void dio_aio_complete_work(struct work_struct *work)\n{\n\tstruct dio *dio = container_of(work, struct dio, complete_work);\n\n\tdio_complete(dio, dio->iocb->ki_pos, 0, true);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void xfs_dqfunlock(xfs_dquot_t *dqp)\n{\n\tcomplete(&dqp->q_flush);\n}"
  },
  {
    "function_name": "xfs_dqflock_nowait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "89-92",
    "snippet": "static inline bool xfs_dqflock_nowait(xfs_dquot_t *dqp)\n{\n\treturn try_wait_for_completion(&dqp->q_flush);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "try_wait_for_completion",
          "args": [
            "&dqp->q_flush"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline bool xfs_dqflock_nowait(xfs_dquot_t *dqp)\n{\n\treturn try_wait_for_completion(&dqp->q_flush);\n}"
  },
  {
    "function_name": "xfs_dqflock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/xfs_dquot.h",
    "lines": "84-87",
    "snippet": "static inline void xfs_dqflock(xfs_dquot_t *dqp)\n{\n\twait_for_completion(&dqp->q_flush);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&dqp->q_flush"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "nfs4_wait_for_completion_rpc_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs4proc.c",
          "lines": "1116-1122",
          "snippet": "static int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}",
          "includes": [
            "#include \"nfs4trace.h\"",
            "#include \"fscache.h\"",
            "#include \"nfs4session.h\"",
            "#include \"netns.h\"",
            "#include \"pnfs.h\"",
            "#include \"callback.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include \"delegation.h\"",
            "#include \"nfs4_fs.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/xattr.h>",
            "#include <linux/nfs_idmap.h>",
            "#include <linux/module.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/nfs_mount.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs4.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfs4trace.h\"\n#include \"fscache.h\"\n#include \"nfs4session.h\"\n#include \"netns.h\"\n#include \"pnfs.h\"\n#include \"callback.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include \"delegation.h\"\n#include \"nfs4_fs.h\"\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/xattr.h>\n#include <linux/nfs_idmap.h>\n#include <linux/module.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/nfs_mount.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/nfs4.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/ratelimit.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/mm.h>\n\nstatic int nfs4_wait_for_completion_rpc_task(struct rpc_task *task)\n{\n\tint ret;\n\n\tret = rpc_wait_for_completion_task(task);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void xfs_dqflock(xfs_dquot_t *dqp)\n{\n\twait_for_completion(&dqp->q_flush);\n}"
  }
]