[
  {
    "function_name": "xfs_verify_cksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
    "lines": "55-61",
    "snippet": "static inline int\nxfs_verify_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t crc = xfs_start_cksum(buffer, length, cksum_offset);\n\n\treturn *(__le32 *)(buffer + cksum_offset) == xfs_end_cksum(crc);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_end_cksum",
          "args": [
            "crc"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_end_cksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
          "lines": "35-39",
          "snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_start_cksum",
          "args": [
            "buffer",
            "length",
            "cksum_offset"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_start_cksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
          "lines": "11-26",
          "snippet": "static inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}",
          "includes": [],
          "macros_used": [
            "#define XFS_CRC_SEED\t(~(__uint32_t)0)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define XFS_CRC_SEED\t(~(__uint32_t)0)\n\nstatic inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}"
        }
      }
    ],
    "contextual_snippet": "static inline int\nxfs_verify_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t crc = xfs_start_cksum(buffer, length, cksum_offset);\n\n\treturn *(__le32 *)(buffer + cksum_offset) == xfs_end_cksum(crc);\n}"
  },
  {
    "function_name": "xfs_update_cksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
    "lines": "44-50",
    "snippet": "static inline void\nxfs_update_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t crc = xfs_start_cksum(buffer, length, cksum_offset);\n\n\t*(__le32 *)(buffer + cksum_offset) = xfs_end_cksum(crc);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfs_end_cksum",
          "args": [
            "crc"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_end_cksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
          "lines": "35-39",
          "snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xfs_start_cksum",
          "args": [
            "buffer",
            "length",
            "cksum_offset"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "xfs_start_cksum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
          "lines": "11-26",
          "snippet": "static inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}",
          "includes": [],
          "macros_used": [
            "#define XFS_CRC_SEED\t(~(__uint32_t)0)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define XFS_CRC_SEED\t(~(__uint32_t)0)\n\nstatic inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void\nxfs_update_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t crc = xfs_start_cksum(buffer, length, cksum_offset);\n\n\t*(__le32 *)(buffer + cksum_offset) = xfs_end_cksum(crc);\n}"
  },
  {
    "function_name": "xfs_end_cksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
    "lines": "35-39",
    "snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le32",
          "args": [
            "crc"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline __le32\nxfs_end_cksum(__uint32_t crc)\n{\n\treturn ~cpu_to_le32(crc);\n}"
  },
  {
    "function_name": "xfs_start_cksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/libxfs/xfs_cksum.h",
    "lines": "11-26",
    "snippet": "static inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}",
    "includes": [],
    "macros_used": [
      "#define XFS_CRC_SEED\t(~(__uint32_t)0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "crc32c",
          "args": [
            "crc",
            "&buffer[cksum_offset + sizeof(__be32)]",
            "length - (cksum_offset + sizeof(__be32))"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_crc32c",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/hash.c",
          "lines": "32-46",
          "snippet": "u32 btrfs_crc32c(u32 crc, const void *address, unsigned int length)\n{\n\tSHASH_DESC_ON_STACK(shash, tfm);\n\tu32 *ctx = (u32 *)shash_desc_ctx(shash);\n\tint err;\n\n\tshash->tfm = tfm;\n\tshash->flags = 0;\n\t*ctx = crc;\n\n\terr = crypto_shash_update(shash, address, length);\n\tBUG_ON(err);\n\n\treturn *ctx;\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include <linux/err.h>",
            "#include <crypto/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct crypto_shash *tfm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include <linux/err.h>\n#include <crypto/hash.h>\n\nstatic struct crypto_shash *tfm;\n\nu32 btrfs_crc32c(u32 crc, const void *address, unsigned int length)\n{\n\tSHASH_DESC_ON_STACK(shash, tfm);\n\tu32 *ctx = (u32 *)shash_desc_ctx(shash);\n\tint err;\n\n\tshash->tfm = tfm;\n\tshash->flags = 0;\n\t*ctx = crc;\n\n\terr = crypto_shash_update(shash, address, length);\n\tBUG_ON(err);\n\n\treturn *ctx;\n}"
        }
      }
    ],
    "contextual_snippet": "#define XFS_CRC_SEED\t(~(__uint32_t)0)\n\nstatic inline __uint32_t\nxfs_start_cksum(char *buffer, size_t length, unsigned long cksum_offset)\n{\n\t__uint32_t zero = 0;\n\t__uint32_t crc;\n\n\t/* Calculate CRC up to the checksum. */\n\tcrc = crc32c(XFS_CRC_SEED, buffer, cksum_offset);\n\n\t/* Skip checksum field */\n\tcrc = crc32c(crc, &zero, sizeof(__u32));\n\n\t/* Calculate the rest of the CRC. */\n\treturn crc32c(crc, &buffer[cksum_offset + sizeof(__be32)],\n\t\t      length - (cksum_offset + sizeof(__be32)));\n}"
  }
]