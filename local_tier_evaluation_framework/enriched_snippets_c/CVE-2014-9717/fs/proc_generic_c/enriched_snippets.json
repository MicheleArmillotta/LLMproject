[
  {
    "function_name": "PDE_DATA",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "618-621",
    "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__PDE_DATA",
          "args": [
            "inode"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "__PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/internal.h",
          "lines": "85-88",
          "snippet": "static inline void *__PDE_DATA(const struct inode *inode)\n{\n\treturn PDE(inode)->data;\n}",
          "includes": [
            "#include <linux/binfmts.h>",
            "#include <linux/atomic.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/binfmts.h>\n#include <linux/atomic.h>\n#include <linux/spinlock.h>\n#include <linux/proc_ns.h>\n#include <linux/proc_fs.h>\n\nstatic inline void *__PDE_DATA(const struct inode *inode)\n{\n\treturn PDE(inode)->data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
  },
  {
    "function_name": "proc_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "611-615",
    "snippet": "void proc_remove(struct proc_dir_entry *de)\n{\n\tif (de)\n\t\tremove_proc_subtree(de->name, de->parent);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_subtree",
          "args": [
            "de->name",
            "de->parent"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "remove_proc_subtree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "557-601",
          "snippet": "int remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid proc_remove(struct proc_dir_entry *de)\n{\n\tif (de)\n\t\tremove_proc_subtree(de->name, de->parent);\n}"
  },
  {
    "function_name": "proc_get_parent_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "604-608",
    "snippet": "void *proc_get_parent_data(const struct inode *inode)\n{\n\tstruct proc_dir_entry *de = PDE(inode);\n\treturn de->parent->data;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PDE",
          "args": [
            "inode"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "618-621",
          "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *proc_get_parent_data(const struct inode *inode)\n{\n\tstruct proc_dir_entry *de = PDE(inode);\n\treturn de->parent->data;\n}"
  },
  {
    "function_name": "remove_proc_subtree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "557-601",
    "snippet": "int remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pde_put",
          "args": [
            "root"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "pde_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "514-518",
          "snippet": "void pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "de->mode"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_entry_rundown",
          "args": [
            "de"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "proc_entry_rundown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/inode.c",
          "lines": "163-178",
          "snippet": "void proc_entry_rundown(struct proc_dir_entry *de)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\t/* Wait until all existing callers into module are done. */\n\tde->pde_unload_completion = &c;\n\tif (atomic_add_return(BIAS, &de->in_use) != BIAS)\n\t\twait_for_completion(&c);\n\n\tspin_lock(&de->pde_unload_lock);\n\twhile (!list_empty(&de->pde_openers)) {\n\t\tstruct pde_opener *pdeo;\n\t\tpdeo = list_first_entry(&de->pde_openers, struct pde_opener, lh);\n\t\tclose_pdeo(de, pdeo);\n\t}\n\tspin_unlock(&de->pde_unload_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/namei.h>",
            "#include <linux/magic.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/limits.h>",
            "#include <linux/file.h>",
            "#include <linux/printk.h>",
            "#include <linux/poll.h>",
            "#include <linux/completion.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/kernel.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/namei.h>\n#include <linux/magic.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sysctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/limits.h>\n#include <linux/file.h>\n#include <linux/printk.h>\n#include <linux/poll.h>\n#include <linux/completion.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/pid_namespace.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n\nvoid proc_entry_rundown(struct proc_dir_entry *de)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\t/* Wait until all existing callers into module are done. */\n\tde->pde_unload_completion = &c;\n\tif (atomic_add_return(BIAS, &de->in_use) != BIAS)\n\t\twait_for_completion(&c);\n\n\tspin_lock(&de->pde_unload_lock);\n\twhile (!list_empty(&de->pde_openers)) {\n\t\tstruct pde_opener *pdeo;\n\t\tpdeo = list_first_entry(&de->pde_openers, struct pde_opener, lh);\n\t\tclose_pdeo(de, pdeo);\n\t}\n\tspin_unlock(&de->pde_unload_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&next->subdir_node",
            "&de->subdir"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_first",
          "args": [
            "de"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_first",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "41-45",
          "snippet": "static struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&root->subdir_node",
            "&parent->subdir"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_find",
          "args": [
            "parent",
            "fn",
            "len"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "53-73",
          "snippet": "static struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "fn"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "__xlate_proc_name",
          "args": [
            "name",
            "&parent",
            "&fn"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "__xlate_proc_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "141-168",
          "snippet": "static int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint remove_proc_subtree(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *root = NULL, *de, *next;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\tlen = strlen(fn);\n\n\troot = pde_subdir_find(parent, fn, len);\n\tif (!root) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn -ENOENT;\n\t}\n\trb_erase(&root->subdir_node, &parent->subdir);\n\n\tde = root;\n\twhile (1) {\n\t\tnext = pde_subdir_first(de);\n\t\tif (next) {\n\t\t\trb_erase(&next->subdir_node, &de->subdir);\n\t\t\tde = next;\n\t\t\tcontinue;\n\t\t}\n\t\tspin_unlock(&proc_subdir_lock);\n\n\t\tproc_entry_rundown(de);\n\t\tnext = de->parent;\n\t\tif (S_ISDIR(de->mode))\n\t\t\tnext->nlink--;\n\t\tde->nlink = 0;\n\t\tif (de == root)\n\t\t\tbreak;\n\t\tpde_put(de);\n\n\t\tspin_lock(&proc_subdir_lock);\n\t\tde = next;\n\t}\n\tpde_put(root);\n\treturn 0;\n}"
  },
  {
    "function_name": "remove_proc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "523-554",
    "snippet": "void remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pde_put",
          "args": [
            "de"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "pde_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "514-518",
          "snippet": "void pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "pde_subdir_first(de)",
            "\"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\"",
            "__func__",
            "de->parent->name",
            "de->name",
            "pde_subdir_first(de)->name"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_first",
          "args": [
            "de"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_first",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "41-45",
          "snippet": "static struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "de->mode"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_entry_rundown",
          "args": [
            "de"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "proc_entry_rundown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/inode.c",
          "lines": "163-178",
          "snippet": "void proc_entry_rundown(struct proc_dir_entry *de)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\t/* Wait until all existing callers into module are done. */\n\tde->pde_unload_completion = &c;\n\tif (atomic_add_return(BIAS, &de->in_use) != BIAS)\n\t\twait_for_completion(&c);\n\n\tspin_lock(&de->pde_unload_lock);\n\twhile (!list_empty(&de->pde_openers)) {\n\t\tstruct pde_opener *pdeo;\n\t\tpdeo = list_first_entry(&de->pde_openers, struct pde_opener, lh);\n\t\tclose_pdeo(de, pdeo);\n\t}\n\tspin_unlock(&de->pde_unload_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/namei.h>",
            "#include <linux/magic.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/limits.h>",
            "#include <linux/file.h>",
            "#include <linux/printk.h>",
            "#include <linux/poll.h>",
            "#include <linux/completion.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/kernel.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/namei.h>\n#include <linux/magic.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sysctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/limits.h>\n#include <linux/file.h>\n#include <linux/printk.h>\n#include <linux/poll.h>\n#include <linux/completion.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/pid_namespace.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n\nvoid proc_entry_rundown(struct proc_dir_entry *de)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\t/* Wait until all existing callers into module are done. */\n\tde->pde_unload_completion = &c;\n\tif (atomic_add_return(BIAS, &de->in_use) != BIAS)\n\t\twait_for_completion(&c);\n\n\tspin_lock(&de->pde_unload_lock);\n\twhile (!list_empty(&de->pde_openers)) {\n\t\tstruct pde_opener *pdeo;\n\t\tpdeo = list_first_entry(&de->pde_openers, struct pde_opener, lh);\n\t\tclose_pdeo(de, pdeo);\n\t}\n\tspin_unlock(&de->pde_unload_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"name '%s'\\n\"",
            "name"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&de->subdir_node",
            "&parent->subdir"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_find",
          "args": [
            "parent",
            "fn",
            "len"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "53-73",
          "snippet": "static struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "fn"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "__xlate_proc_name",
          "args": [
            "name",
            "&parent",
            "&fn"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "__xlate_proc_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "141-168",
          "snippet": "static int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nvoid remove_proc_entry(const char *name, struct proc_dir_entry *parent)\n{\n\tstruct proc_dir_entry *de = NULL;\n\tconst char *fn = name;\n\tunsigned int len;\n\n\tspin_lock(&proc_subdir_lock);\n\tif (__xlate_proc_name(name, &parent, &fn) != 0) {\n\t\tspin_unlock(&proc_subdir_lock);\n\t\treturn;\n\t}\n\tlen = strlen(fn);\n\n\tde = pde_subdir_find(parent, fn, len);\n\tif (de)\n\t\trb_erase(&de->subdir_node, &parent->subdir);\n\tspin_unlock(&proc_subdir_lock);\n\tif (!de) {\n\t\tWARN(1, \"name '%s'\\n\", name);\n\t\treturn;\n\t}\n\n\tproc_entry_rundown(de);\n\n\tif (S_ISDIR(de->mode))\n\t\tparent->nlink--;\n\tde->nlink = 0;\n\tWARN(pde_subdir_first(de),\n\t     \"%s: removing non-empty directory '%s/%s', leaking at least '%s'\\n\",\n\t     __func__, de->parent->name, de->name, pde_subdir_first(de)->name);\n\tpde_put(de);\n}"
  },
  {
    "function_name": "pde_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "514-518",
    "snippet": "void pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_proc_entry",
          "args": [
            "pde"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "free_proc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "505-512",
          "snippet": "static void free_proc_entry(struct proc_dir_entry *de)\n{\n\tproc_free_inum(de->low_ino);\n\n\tif (S_ISLNK(de->mode))\n\t\tkfree(de->data);\n\tkfree(de);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic void free_proc_entry(struct proc_dir_entry *de)\n{\n\tproc_free_inum(de->low_ino);\n\n\tif (S_ISLNK(de->mode))\n\t\tkfree(de->data);\n\tkfree(de);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&pde->count"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}"
  },
  {
    "function_name": "free_proc_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "505-512",
    "snippet": "static void free_proc_entry(struct proc_dir_entry *de)\n{\n\tproc_free_inum(de->low_ino);\n\n\tif (S_ISLNK(de->mode))\n\t\tkfree(de->data);\n\tkfree(de);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "de"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "de->data"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "de->mode"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_free_inum",
          "args": [
            "de->low_ino"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "proc_free_inum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "217-223",
          "snippet": "void proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define PROC_DYNAMIC_FIRST 0xF0000000U"
          ],
          "globals_used": [
            "static DEFINE_IDA(proc_inum_ida);",
            "static DEFINE_SPINLOCK(proc_inum_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\n#define PROC_DYNAMIC_FIRST 0xF0000000U\n\nstatic DEFINE_IDA(proc_inum_ida);\nstatic DEFINE_SPINLOCK(proc_inum_lock);\n\nvoid proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic void free_proc_entry(struct proc_dir_entry *de)\n{\n\tproc_free_inum(de->low_ino);\n\n\tif (S_ISLNK(de->mode))\n\t\tkfree(de->data);\n\tkfree(de);\n}"
  },
  {
    "function_name": "proc_set_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "498-502",
    "snippet": "void proc_set_user(struct proc_dir_entry *de, kuid_t uid, kgid_t gid)\n{\n\tde->uid = uid;\n\tde->gid = gid;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid proc_set_user(struct proc_dir_entry *de, kuid_t uid, kgid_t gid)\n{\n\tde->uid = uid;\n\tde->gid = gid;\n}"
  },
  {
    "function_name": "proc_set_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "492-495",
    "snippet": "void proc_set_size(struct proc_dir_entry *de, loff_t size)\n{\n\tde->size = size;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid proc_set_size(struct proc_dir_entry *de, loff_t size)\n{\n\tde->size = size;\n}"
  },
  {
    "function_name": "proc_create_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "458-489",
    "snippet": "struct proc_dir_entry *proc_create_data(const char *name, umode_t mode,\n\t\t\t\t\tstruct proc_dir_entry *parent,\n\t\t\t\t\tconst struct file_operations *proc_fops,\n\t\t\t\t\tvoid *data)\n{\n\tstruct proc_dir_entry *pde;\n\tif ((mode & S_IFMT) == 0)\n\t\tmode |= S_IFREG;\n\n\tif (!S_ISREG(mode)) {\n\t\tWARN_ON(1);\t/* use proc_mkdir() */\n\t\treturn NULL;\n\t}\n\n\tBUG_ON(proc_fops == NULL);\n\n\tif ((mode & S_IALLUGO) == 0)\n\t\tmode |= S_IRUGO;\n\tpde = __proc_create(&parent, name, mode, 1);\n\tif (!pde)\n\t\tgoto out;\n\tpde->proc_fops = proc_fops;\n\tpde->data = data;\n\tpde->proc_iops = &proc_file_inode_operations;\n\tif (proc_register(parent, pde) < 0)\n\t\tgoto out_free;\n\treturn pde;\nout_free:\n\tkfree(pde);\nout:\n\treturn NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations proc_file_inode_operations = {\n\t.setattr\t= proc_notify_change,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pde"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_register",
          "args": [
            "parent",
            "pde"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "proc_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "333-353",
          "snippet": "static int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__proc_create",
          "args": [
            "&parent",
            "name",
            "mode",
            "1"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "proc_fops == NULL"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "mode"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic const struct inode_operations proc_file_inode_operations = {\n\t.setattr\t= proc_notify_change,\n};\n\nstruct proc_dir_entry *proc_create_data(const char *name, umode_t mode,\n\t\t\t\t\tstruct proc_dir_entry *parent,\n\t\t\t\t\tconst struct file_operations *proc_fops,\n\t\t\t\t\tvoid *data)\n{\n\tstruct proc_dir_entry *pde;\n\tif ((mode & S_IFMT) == 0)\n\t\tmode |= S_IFREG;\n\n\tif (!S_ISREG(mode)) {\n\t\tWARN_ON(1);\t/* use proc_mkdir() */\n\t\treturn NULL;\n\t}\n\n\tBUG_ON(proc_fops == NULL);\n\n\tif ((mode & S_IALLUGO) == 0)\n\t\tmode |= S_IRUGO;\n\tpde = __proc_create(&parent, name, mode, 1);\n\tif (!pde)\n\t\tgoto out;\n\tpde->proc_fops = proc_fops;\n\tpde->data = data;\n\tpde->proc_iops = &proc_file_inode_operations;\n\tif (proc_register(parent, pde) < 0)\n\t\tgoto out_free;\n\treturn pde;\nout_free:\n\tkfree(pde);\nout:\n\treturn NULL;\n}"
  },
  {
    "function_name": "proc_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "451-455",
    "snippet": "struct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_mkdir_data",
          "args": [
            "name",
            "0",
            "parent",
            "NULL"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "proc_mkdir_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "420-441",
          "snippet": "struct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};",
            "static const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};\nstatic const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};\n\nstruct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_mkdir(const char *name,\n\t\tstruct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, 0, parent, NULL);\n}"
  },
  {
    "function_name": "proc_mkdir_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "444-448",
    "snippet": "struct proc_dir_entry *proc_mkdir_mode(const char *name, umode_t mode,\n\t\t\t\t       struct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, mode, parent, NULL);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_mkdir_data",
          "args": [
            "name",
            "mode",
            "parent",
            "NULL"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "proc_mkdir_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "420-441",
          "snippet": "struct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};",
            "static const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};\nstatic const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};\n\nstruct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_mkdir_mode(const char *name, umode_t mode,\n\t\t\t\t       struct proc_dir_entry *parent)\n{\n\treturn proc_mkdir_data(name, mode, parent, NULL);\n}"
  },
  {
    "function_name": "proc_mkdir_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "420-441",
    "snippet": "struct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};",
      "static const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ent"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_register",
          "args": [
            "parent",
            "ent"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "proc_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "333-353",
          "snippet": "static int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__proc_create",
          "args": [
            "&parent",
            "name",
            "S_IFDIR | mode",
            "2"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic const struct file_operations proc_dir_operations = {\n\t.llseek\t\t\t= generic_file_llseek,\n\t.read\t\t\t= generic_read_dir,\n\t.iterate\t\t= proc_readdir,\n};\nstatic const struct inode_operations proc_dir_inode_operations = {\n\t.lookup\t\t= proc_lookup,\n\t.getattr\t= proc_getattr,\n\t.setattr\t= proc_notify_change,\n};\n\nstruct proc_dir_entry *proc_mkdir_data(const char *name, umode_t mode,\n\t\tstruct proc_dir_entry *parent, void *data)\n{\n\tstruct proc_dir_entry *ent;\n\n\tif (mode == 0)\n\t\tmode = S_IRUGO | S_IXUGO;\n\n\tent = __proc_create(&parent, name, S_IFDIR | mode, 2);\n\tif (ent) {\n\t\tent->data = data;\n\t\tent->proc_fops = &proc_dir_operations;\n\t\tent->proc_iops = &proc_dir_inode_operations;\n\t\tparent->nlink++;\n\t\tif (proc_register(parent, ent) < 0) {\n\t\t\tkfree(ent);\n\t\t\tparent->nlink--;\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}"
  },
  {
    "function_name": "proc_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "393-417",
    "snippet": "struct proc_dir_entry *proc_symlink(const char *name,\n\t\tstruct proc_dir_entry *parent, const char *dest)\n{\n\tstruct proc_dir_entry *ent;\n\n\tent = __proc_create(&parent, name,\n\t\t\t  (S_IFLNK | S_IRUGO | S_IWUGO | S_IXUGO),1);\n\n\tif (ent) {\n\t\tent->data = kmalloc((ent->size=strlen(dest))+1, GFP_KERNEL);\n\t\tif (ent->data) {\n\t\t\tstrcpy((char*)ent->data,dest);\n\t\t\tent->proc_iops = &proc_link_inode_operations;\n\t\t\tif (proc_register(parent, ent) < 0) {\n\t\t\t\tkfree(ent->data);\n\t\t\t\tkfree(ent);\n\t\t\t\tent = NULL;\n\t\t\t}\n\t\t} else {\n\t\t\tkfree(ent);\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ent"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ent"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ent->data"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_register",
          "args": [
            "parent",
            "ent"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "proc_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "333-353",
          "snippet": "static int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "(char*)ent->data",
            "dest"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "(ent->size=strlen(dest))+1",
            "GFP_KERNEL"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "dest"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "__proc_create",
          "args": [
            "&parent",
            "name",
            "(S_IFLNK | S_IRUGO | S_IWUGO | S_IXUGO)",
            "1"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "__proc_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "355-391",
          "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct proc_dir_entry *proc_symlink(const char *name,\n\t\tstruct proc_dir_entry *parent, const char *dest)\n{\n\tstruct proc_dir_entry *ent;\n\n\tent = __proc_create(&parent, name,\n\t\t\t  (S_IFLNK | S_IRUGO | S_IWUGO | S_IXUGO),1);\n\n\tif (ent) {\n\t\tent->data = kmalloc((ent->size=strlen(dest))+1, GFP_KERNEL);\n\t\tif (ent->data) {\n\t\t\tstrcpy((char*)ent->data,dest);\n\t\t\tent->proc_iops = &proc_link_inode_operations;\n\t\t\tif (proc_register(parent, ent) < 0) {\n\t\t\t\tkfree(ent->data);\n\t\t\t\tkfree(ent);\n\t\t\t\tent = NULL;\n\t\t\t}\n\t\t} else {\n\t\t\tkfree(ent);\n\t\t\tent = NULL;\n\t\t}\n\t}\n\treturn ent;\n}"
  },
  {
    "function_name": "__proc_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "355-391",
    "snippet": "static struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ent->pde_openers"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&ent->pde_unload_lock"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&ent->count",
            "1"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent->name",
            "fn",
            "qstr.len + 1"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct proc_dir_entry) + qstr.len + 1",
            "GFP_KERNEL"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"create '/proc/%s' by hand\\n\"",
            "qstr.name"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name_to_int",
          "args": [
            "&qstr"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "name_to_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/internal.h",
          "lines": "115-135",
          "snippet": "static inline unsigned name_to_int(const struct qstr *qstr)\n{\n\tconst char *name = qstr->name;\n\tint len = qstr->len;\n\tunsigned n = 0;\n\n\tif (len > 1 && *name == '0')\n\t\tgoto out;\n\twhile (len-- > 0) {\n\t\tunsigned c = *name++ - '0';\n\t\tif (c > 9)\n\t\t\tgoto out;\n\t\tif (n >= (~0U-9)/10)\n\t\t\tgoto out;\n\t\tn *= 10;\n\t\tn += c;\n\t}\n\treturn n;\nout:\n\treturn ~0U;\n}",
          "includes": [
            "#include <linux/binfmts.h>",
            "#include <linux/atomic.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/binfmts.h>\n#include <linux/atomic.h>\n#include <linux/spinlock.h>\n#include <linux/proc_ns.h>\n#include <linux/proc_fs.h>\n\nstatic inline unsigned name_to_int(const struct qstr *qstr)\n{\n\tconst char *name = qstr->name;\n\tint len = qstr->len;\n\tunsigned n = 0;\n\n\tif (len > 1 && *name == '0')\n\t\tgoto out;\n\twhile (len-- > 0) {\n\t\tunsigned c = *name++ - '0';\n\t\tif (c > 9)\n\t\t\tgoto out;\n\t\tif (n >= (~0U-9)/10)\n\t\t\tgoto out;\n\t\tn *= 10;\n\t\tn += c;\n\t}\n\treturn n;\nout:\n\treturn ~0U;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"name len %u\\n\"",
            "qstr.len"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "fn"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xlate_proc_name",
          "args": [
            "name",
            "parent",
            "&fn"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "xlate_proc_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "170-179",
          "snippet": "static int xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t   const char **residual)\n{\n\tint rv;\n\n\tspin_lock(&proc_subdir_lock);\n\trv = __xlate_proc_name(name, ret, residual);\n\tspin_unlock(&proc_subdir_lock);\n\treturn rv;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t   const char **residual)\n{\n\tint rv;\n\n\tspin_lock(&proc_subdir_lock);\n\trv = __xlate_proc_name(name, ret, residual);\n\tspin_unlock(&proc_subdir_lock);\n\treturn rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *__proc_create(struct proc_dir_entry **parent,\n\t\t\t\t\t  const char *name,\n\t\t\t\t\t  umode_t mode,\n\t\t\t\t\t  nlink_t nlink)\n{\n\tstruct proc_dir_entry *ent = NULL;\n\tconst char *fn;\n\tstruct qstr qstr;\n\n\tif (xlate_proc_name(name, parent, &fn) != 0)\n\t\tgoto out;\n\tqstr.name = fn;\n\tqstr.len = strlen(fn);\n\tif (qstr.len == 0 || qstr.len >= 256) {\n\t\tWARN(1, \"name len %u\\n\", qstr.len);\n\t\treturn NULL;\n\t}\n\tif (*parent == &proc_root && name_to_int(&qstr) != ~0U) {\n\t\tWARN(1, \"create '/proc/%s' by hand\\n\", qstr.name);\n\t\treturn NULL;\n\t}\n\n\tent = kzalloc(sizeof(struct proc_dir_entry) + qstr.len + 1, GFP_KERNEL);\n\tif (!ent)\n\t\tgoto out;\n\n\tmemcpy(ent->name, fn, qstr.len + 1);\n\tent->namelen = qstr.len;\n\tent->mode = mode;\n\tent->nlink = nlink;\n\tent->subdir = RB_ROOT;\n\tatomic_set(&ent->count, 1);\n\tspin_lock_init(&ent->pde_unload_lock);\n\tINIT_LIST_HEAD(&ent->pde_openers);\nout:\n\treturn ent;\n}"
  },
  {
    "function_name": "proc_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "333-353",
    "snippet": "static int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_free_inum",
          "args": [
            "dp->low_ino"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "proc_free_inum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "217-223",
          "snippet": "void proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define PROC_DYNAMIC_FIRST 0xF0000000U"
          ],
          "globals_used": [
            "static DEFINE_IDA(proc_inum_ida);",
            "static DEFINE_SPINLOCK(proc_inum_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\n#define PROC_DYNAMIC_FIRST 0xF0000000U\n\nstatic DEFINE_IDA(proc_inum_ida);\nstatic DEFINE_SPINLOCK(proc_inum_lock);\n\nvoid proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"proc_dir_entry '%s/%s' already registered\\n\"",
            "dir->name",
            "dp->name"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_insert",
          "args": [
            "dir",
            "dp"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "75-100",
          "snippet": "static bool pde_subdir_insert(struct proc_dir_entry *dir,\n\t\t\t      struct proc_dir_entry *de)\n{\n\tstruct rb_root *root = &dir->subdir;\n\tstruct rb_node **new = &root->rb_node, *parent = NULL;\n\n\t/* Figure out where to put new node */\n\twhile (*new) {\n\t\tstruct proc_dir_entry *this =\n\t\t\tcontainer_of(*new, struct proc_dir_entry, subdir_node);\n\t\tint result = proc_match(de->namelen, de->name, this);\n\n\t\tparent = *new;\n\t\tif (result < 0)\n\t\t\tnew = &(*new)->rb_left;\n\t\telse if (result > 0)\n\t\t\tnew = &(*new)->rb_right;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t/* Add new node and rebalance tree. */\n\trb_link_node(&de->subdir_node, parent, new);\n\trb_insert_color(&de->subdir_node, root);\n\treturn true;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic bool pde_subdir_insert(struct proc_dir_entry *dir,\n\t\t\t      struct proc_dir_entry *de)\n{\n\tstruct rb_root *root = &dir->subdir;\n\tstruct rb_node **new = &root->rb_node, *parent = NULL;\n\n\t/* Figure out where to put new node */\n\twhile (*new) {\n\t\tstruct proc_dir_entry *this =\n\t\t\tcontainer_of(*new, struct proc_dir_entry, subdir_node);\n\t\tint result = proc_match(de->namelen, de->name, this);\n\n\t\tparent = *new;\n\t\tif (result < 0)\n\t\t\tnew = &(*new)->rb_left;\n\t\telse if (result > 0)\n\t\t\tnew = &(*new)->rb_right;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t/* Add new node and rebalance tree. */\n\trb_link_node(&de->subdir_node, parent, new);\n\trb_insert_color(&de->subdir_node, root);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_alloc_inum",
          "args": [
            "&dp->low_ino"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "proc_alloc_inum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "190-215",
          "snippet": "int proc_alloc_inum(unsigned int *inum)\n{\n\tunsigned int i;\n\tint error;\n\nretry:\n\tif (!ida_pre_get(&proc_inum_ida, GFP_KERNEL))\n\t\treturn -ENOMEM;\n\n\tspin_lock_irq(&proc_inum_lock);\n\terror = ida_get_new(&proc_inum_ida, &i);\n\tspin_unlock_irq(&proc_inum_lock);\n\tif (error == -EAGAIN)\n\t\tgoto retry;\n\telse if (error)\n\t\treturn error;\n\n\tif (i > UINT_MAX - PROC_DYNAMIC_FIRST) {\n\t\tspin_lock_irq(&proc_inum_lock);\n\t\tida_remove(&proc_inum_ida, i);\n\t\tspin_unlock_irq(&proc_inum_lock);\n\t\treturn -ENOSPC;\n\t}\n\t*inum = PROC_DYNAMIC_FIRST + i;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define PROC_DYNAMIC_FIRST 0xF0000000U"
          ],
          "globals_used": [
            "static DEFINE_IDA(proc_inum_ida);",
            "static DEFINE_SPINLOCK(proc_inum_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\n#define PROC_DYNAMIC_FIRST 0xF0000000U\n\nstatic DEFINE_IDA(proc_inum_ida);\nstatic DEFINE_SPINLOCK(proc_inum_lock);\n\nint proc_alloc_inum(unsigned int *inum)\n{\n\tunsigned int i;\n\tint error;\n\nretry:\n\tif (!ida_pre_get(&proc_inum_ida, GFP_KERNEL))\n\t\treturn -ENOMEM;\n\n\tspin_lock_irq(&proc_inum_lock);\n\terror = ida_get_new(&proc_inum_ida, &i);\n\tspin_unlock_irq(&proc_inum_lock);\n\tif (error == -EAGAIN)\n\t\tgoto retry;\n\telse if (error)\n\t\treturn error;\n\n\tif (i > UINT_MAX - PROC_DYNAMIC_FIRST) {\n\t\tspin_lock_irq(&proc_inum_lock);\n\t\tida_remove(&proc_inum_ida, i);\n\t\tspin_unlock_irq(&proc_inum_lock);\n\t\treturn -ENOSPC;\n\t}\n\t*inum = PROC_DYNAMIC_FIRST + i;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int proc_register(struct proc_dir_entry * dir, struct proc_dir_entry * dp)\n{\n\tint ret;\n\n\tret = proc_alloc_inum(&dp->low_ino);\n\tif (ret)\n\t\treturn ret;\n\n\tspin_lock(&proc_subdir_lock);\n\tdp->parent = dir;\n\tif (pde_subdir_insert(dir, dp) == false) {\n\t\tWARN(1, \"proc_dir_entry '%s/%s' already registered\\n\",\n\t\t     dir->name, dp->name);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tproc_free_inum(dp->low_ino);\n\t\treturn -EEXIST;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "proc_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "306-311",
    "snippet": "int proc_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *inode = file_inode(file);\n\n\treturn proc_readdir_de(PDE(inode), file, ctx);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_readdir_de",
          "args": [
            "PDE(inode)",
            "file",
            "ctx"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "proc_readdir_de",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "265-304",
          "snippet": "int proc_readdir_de(struct proc_dir_entry *de, struct file *file,\n\t\t    struct dir_context *ctx)\n{\n\tint i;\n\n\tif (!dir_emit_dots(file, ctx))\n\t\treturn 0;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_first(de);\n\ti = ctx->pos - 2;\n\tfor (;;) {\n\t\tif (!de) {\n\t\t\tspin_unlock(&proc_subdir_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (!i)\n\t\t\tbreak;\n\t\tde = pde_subdir_next(de);\n\t\ti--;\n\t}\n\n\tdo {\n\t\tstruct proc_dir_entry *next;\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tif (!dir_emit(ctx, de->name, de->namelen,\n\t\t\t    de->low_ino, de->mode >> 12)) {\n\t\t\tpde_put(de);\n\t\t\treturn 0;\n\t\t}\n\t\tspin_lock(&proc_subdir_lock);\n\t\tctx->pos++;\n\t\tnext = pde_subdir_next(de);\n\t\tpde_put(de);\n\t\tde = next;\n\t} while (de);\n\tspin_unlock(&proc_subdir_lock);\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint proc_readdir_de(struct proc_dir_entry *de, struct file *file,\n\t\t    struct dir_context *ctx)\n{\n\tint i;\n\n\tif (!dir_emit_dots(file, ctx))\n\t\treturn 0;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_first(de);\n\ti = ctx->pos - 2;\n\tfor (;;) {\n\t\tif (!de) {\n\t\t\tspin_unlock(&proc_subdir_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (!i)\n\t\t\tbreak;\n\t\tde = pde_subdir_next(de);\n\t\ti--;\n\t}\n\n\tdo {\n\t\tstruct proc_dir_entry *next;\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tif (!dir_emit(ctx, de->name, de->namelen,\n\t\t\t    de->low_ino, de->mode >> 12)) {\n\t\t\tpde_put(de);\n\t\t\treturn 0;\n\t\t}\n\t\tspin_lock(&proc_subdir_lock);\n\t\tctx->pos++;\n\t\tnext = pde_subdir_next(de);\n\t\tpde_put(de);\n\t\tde = next;\n\t} while (de);\n\tspin_unlock(&proc_subdir_lock);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PDE",
          "args": [
            "inode"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "618-621",
          "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_init_file_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fuse/file.c",
          "lines": "3009-3013",
          "snippet": "void fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}",
          "includes": [
            "#include <linux/falloc.h>",
            "#include <linux/aio.h>",
            "#include <linux/swap.h>",
            "#include <linux/compat.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include \"fuse_i.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};",
            "static const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/falloc.h>\n#include <linux/aio.h>\n#include <linux/swap.h>\n#include <linux/compat.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include \"fuse_i.h\"\n\nstatic const struct file_operations fuse_file_operations = {\n\t.llseek\t\t= fuse_file_llseek,\n\t.read\t\t= new_sync_read,\n\t.read_iter\t= fuse_file_read_iter,\n\t.write\t\t= new_sync_write,\n\t.write_iter\t= fuse_file_write_iter,\n\t.mmap\t\t= fuse_file_mmap,\n\t.open\t\t= fuse_open,\n\t.flush\t\t= fuse_flush,\n\t.release\t= fuse_release,\n\t.fsync\t\t= fuse_fsync,\n\t.lock\t\t= fuse_file_lock,\n\t.flock\t\t= fuse_file_flock,\n\t.splice_read\t= generic_file_splice_read,\n\t.unlocked_ioctl\t= fuse_file_ioctl,\n\t.compat_ioctl\t= fuse_file_compat_ioctl,\n\t.poll\t\t= fuse_file_poll,\n\t.fallocate\t= fuse_file_fallocate,\n};\nstatic const struct address_space_operations fuse_file_aops  = {\n\t.readpage\t= fuse_readpage,\n\t.writepage\t= fuse_writepage,\n\t.writepages\t= fuse_writepages,\n\t.launder_page\t= fuse_launder_page,\n\t.readpages\t= fuse_readpages,\n\t.set_page_dirty\t= __set_page_dirty_nobuffers,\n\t.bmap\t\t= fuse_bmap,\n\t.direct_IO\t= fuse_direct_IO,\n\t.write_begin\t= fuse_write_begin,\n\t.write_end\t= fuse_write_end,\n};\n\nvoid fuse_init_file_inode(struct inode *inode)\n{\n\tinode->i_fop = &fuse_file_operations;\n\tinode->i_data.a_ops = &fuse_file_aops;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nint proc_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *inode = file_inode(file);\n\n\treturn proc_readdir_de(PDE(inode), file, ctx);\n}"
  },
  {
    "function_name": "proc_readdir_de",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "265-304",
    "snippet": "int proc_readdir_de(struct proc_dir_entry *de, struct file *file,\n\t\t    struct dir_context *ctx)\n{\n\tint i;\n\n\tif (!dir_emit_dots(file, ctx))\n\t\treturn 0;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_first(de);\n\ti = ctx->pos - 2;\n\tfor (;;) {\n\t\tif (!de) {\n\t\t\tspin_unlock(&proc_subdir_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (!i)\n\t\t\tbreak;\n\t\tde = pde_subdir_next(de);\n\t\ti--;\n\t}\n\n\tdo {\n\t\tstruct proc_dir_entry *next;\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tif (!dir_emit(ctx, de->name, de->namelen,\n\t\t\t    de->low_ino, de->mode >> 12)) {\n\t\t\tpde_put(de);\n\t\t\treturn 0;\n\t\t}\n\t\tspin_lock(&proc_subdir_lock);\n\t\tctx->pos++;\n\t\tnext = pde_subdir_next(de);\n\t\tpde_put(de);\n\t\tde = next;\n\t} while (de);\n\tspin_unlock(&proc_subdir_lock);\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pde_put",
          "args": [
            "de"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "pde_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "514-518",
          "snippet": "void pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid pde_put(struct proc_dir_entry *pde)\n{\n\tif (atomic_dec_and_test(&pde->count))\n\t\tfree_proc_entry(pde);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pde_subdir_next",
          "args": [
            "de"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "47-51",
          "snippet": "static struct proc_dir_entry *pde_subdir_next(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_next(&dir->subdir_node), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_next(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_next(&dir->subdir_node), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_emit",
          "args": [
            "ctx",
            "de->name",
            "de->namelen",
            "de->low_ino",
            "de->mode >> 12"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_get",
          "args": [
            "de"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "pde_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/internal.h",
          "lines": "187-191",
          "snippet": "static inline struct proc_dir_entry *pde_get(struct proc_dir_entry *pde)\n{\n\tatomic_inc(&pde->count);\n\treturn pde;\n}",
          "includes": [
            "#include <linux/binfmts.h>",
            "#include <linux/atomic.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void pde_put(struct proc_dir_entry *);",
            "extern struct inode *proc_get_inode(struct super_block *, struct proc_dir_entry *);",
            "extern void proc_entry_rundown(struct proc_dir_entry *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/binfmts.h>\n#include <linux/atomic.h>\n#include <linux/spinlock.h>\n#include <linux/proc_ns.h>\n#include <linux/proc_fs.h>\n\nextern void pde_put(struct proc_dir_entry *);\nextern struct inode *proc_get_inode(struct super_block *, struct proc_dir_entry *);\nextern void proc_entry_rundown(struct proc_dir_entry *);\n\nstatic inline struct proc_dir_entry *pde_get(struct proc_dir_entry *pde)\n{\n\tatomic_inc(&pde->count);\n\treturn pde;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pde_subdir_first",
          "args": [
            "de"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_first",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "41-45",
          "snippet": "static struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir_emit_dots",
          "args": [
            "file",
            "ctx"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nint proc_readdir_de(struct proc_dir_entry *de, struct file *file,\n\t\t    struct dir_context *ctx)\n{\n\tint i;\n\n\tif (!dir_emit_dots(file, ctx))\n\t\treturn 0;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_first(de);\n\ti = ctx->pos - 2;\n\tfor (;;) {\n\t\tif (!de) {\n\t\t\tspin_unlock(&proc_subdir_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (!i)\n\t\t\tbreak;\n\t\tde = pde_subdir_next(de);\n\t\ti--;\n\t}\n\n\tdo {\n\t\tstruct proc_dir_entry *next;\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tif (!dir_emit(ctx, de->name, de->namelen,\n\t\t\t    de->low_ino, de->mode >> 12)) {\n\t\t\tpde_put(de);\n\t\t\treturn 0;\n\t\t}\n\t\tspin_lock(&proc_subdir_lock);\n\t\tctx->pos++;\n\t\tnext = pde_subdir_next(de);\n\t\tpde_put(de);\n\t\tde = next;\n\t} while (de);\n\tspin_unlock(&proc_subdir_lock);\n\treturn 1;\n}"
  },
  {
    "function_name": "proc_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "250-254",
    "snippet": "struct dentry *proc_lookup(struct inode *dir, struct dentry *dentry,\n\t\tunsigned int flags)\n{\n\treturn proc_lookup_de(PDE(dir), dir, dentry);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_lookup_de",
          "args": [
            "PDE(dir)",
            "dir",
            "dentry"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "proc_lookup_de",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "229-248",
          "snippet": "struct dentry *proc_lookup_de(struct proc_dir_entry *de, struct inode *dir,\n\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_find(de, dentry->d_name.name, dentry->d_name.len);\n\tif (de) {\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tinode = proc_get_inode(dir->i_sb, de);\n\t\tif (!inode)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\td_set_d_op(dentry, &simple_dentry_operations);\n\t\td_add(dentry, inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\treturn ERR_PTR(-ENOENT);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(proc_subdir_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstruct dentry *proc_lookup_de(struct proc_dir_entry *de, struct inode *dir,\n\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_find(de, dentry->d_name.name, dentry->d_name.len);\n\tif (de) {\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tinode = proc_get_inode(dir->i_sb, de);\n\t\tif (!inode)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\td_set_d_op(dentry, &simple_dentry_operations);\n\t\td_add(dentry, inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\treturn ERR_PTR(-ENOENT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PDE",
          "args": [
            "dir"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "618-621",
          "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstruct dentry *proc_lookup(struct inode *dir, struct dentry *dentry,\n\t\tunsigned int flags)\n{\n\treturn proc_lookup_de(PDE(dir), dir, dentry);\n}"
  },
  {
    "function_name": "proc_lookup_de",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "229-248",
    "snippet": "struct dentry *proc_lookup_de(struct proc_dir_entry *de, struct inode *dir,\n\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_find(de, dentry->d_name.name, dentry->d_name.len);\n\tif (de) {\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tinode = proc_get_inode(dir->i_sb, de);\n\t\tif (!inode)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\td_set_d_op(dentry, &simple_dentry_operations);\n\t\td_add(dentry, inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\treturn ERR_PTR(-ENOENT);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOENT"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_add",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "v9fs_fid_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/9p/fid.c",
          "lines": "49-54",
          "snippet": "void v9fs_fid_add(struct dentry *dentry, struct p9_fid *fid)\n{\n\tspin_lock(&dentry->d_lock);\n\t__add_fid(dentry, fid);\n\tspin_unlock(&dentry->d_lock);\n}",
          "includes": [
            "#include \"fid.h\"",
            "#include \"v9fs_vfs.h\"",
            "#include \"v9fs.h\"",
            "#include <net/9p/client.h>",
            "#include <net/9p/9p.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/errno.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fid.h\"\n#include \"v9fs_vfs.h\"\n#include \"v9fs.h\"\n#include <net/9p/client.h>\n#include <net/9p/9p.h>\n#include <linux/idr.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/errno.h>\n#include <linux/module.h>\n\nvoid v9fs_fid_add(struct dentry *dentry, struct p9_fid *fid)\n{\n\tspin_lock(&dentry->d_lock);\n\t__add_fid(dentry, fid);\n\tspin_unlock(&dentry->d_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_set_d_op",
          "args": [
            "dentry",
            "&simple_dentry_operations"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "d_set_d_op",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1635-1659",
          "snippet": "void d_set_d_op(struct dentry *dentry, const struct dentry_operations *op)\n{\n\tWARN_ON_ONCE(dentry->d_op);\n\tWARN_ON_ONCE(dentry->d_flags & (DCACHE_OP_HASH\t|\n\t\t\t\tDCACHE_OP_COMPARE\t|\n\t\t\t\tDCACHE_OP_REVALIDATE\t|\n\t\t\t\tDCACHE_OP_WEAK_REVALIDATE\t|\n\t\t\t\tDCACHE_OP_DELETE ));\n\tdentry->d_op = op;\n\tif (!op)\n\t\treturn;\n\tif (op->d_hash)\n\t\tdentry->d_flags |= DCACHE_OP_HASH;\n\tif (op->d_compare)\n\t\tdentry->d_flags |= DCACHE_OP_COMPARE;\n\tif (op->d_revalidate)\n\t\tdentry->d_flags |= DCACHE_OP_REVALIDATE;\n\tif (op->d_weak_revalidate)\n\t\tdentry->d_flags |= DCACHE_OP_WEAK_REVALIDATE;\n\tif (op->d_delete)\n\t\tdentry->d_flags |= DCACHE_OP_DELETE;\n\tif (op->d_prune)\n\t\tdentry->d_flags |= DCACHE_OP_PRUNE;\n\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid d_set_d_op(struct dentry *dentry, const struct dentry_operations *op)\n{\n\tWARN_ON_ONCE(dentry->d_op);\n\tWARN_ON_ONCE(dentry->d_flags & (DCACHE_OP_HASH\t|\n\t\t\t\tDCACHE_OP_COMPARE\t|\n\t\t\t\tDCACHE_OP_REVALIDATE\t|\n\t\t\t\tDCACHE_OP_WEAK_REVALIDATE\t|\n\t\t\t\tDCACHE_OP_DELETE ));\n\tdentry->d_op = op;\n\tif (!op)\n\t\treturn;\n\tif (op->d_hash)\n\t\tdentry->d_flags |= DCACHE_OP_HASH;\n\tif (op->d_compare)\n\t\tdentry->d_flags |= DCACHE_OP_COMPARE;\n\tif (op->d_revalidate)\n\t\tdentry->d_flags |= DCACHE_OP_REVALIDATE;\n\tif (op->d_weak_revalidate)\n\t\tdentry->d_flags |= DCACHE_OP_WEAK_REVALIDATE;\n\tif (op->d_delete)\n\t\tdentry->d_flags |= DCACHE_OP_DELETE;\n\tif (op->d_prune)\n\t\tdentry->d_flags |= DCACHE_OP_PRUNE;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_get_inode",
          "args": [
            "dir->i_sb",
            "de"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "proc_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/inode.c",
          "lines": "417-453",
          "snippet": "struct inode *proc_get_inode(struct super_block *sb, struct proc_dir_entry *de)\n{\n\tstruct inode *inode = new_inode_pseudo(sb);\n\n\tif (inode) {\n\t\tinode->i_ino = de->low_ino;\n\t\tinode->i_mtime = inode->i_atime = inode->i_ctime = CURRENT_TIME;\n\t\tPROC_I(inode)->pde = de;\n\n\t\tif (de->mode) {\n\t\t\tinode->i_mode = de->mode;\n\t\t\tinode->i_uid = de->uid;\n\t\t\tinode->i_gid = de->gid;\n\t\t}\n\t\tif (de->size)\n\t\t\tinode->i_size = de->size;\n\t\tif (de->nlink)\n\t\t\tset_nlink(inode, de->nlink);\n\t\tWARN_ON(!de->proc_iops);\n\t\tinode->i_op = de->proc_iops;\n\t\tif (de->proc_fops) {\n\t\t\tif (S_ISREG(inode->i_mode)) {\n#ifdef CONFIG_COMPAT\n\t\t\t\tif (!de->proc_fops->compat_ioctl)\n\t\t\t\t\tinode->i_fop =\n\t\t\t\t\t\t&proc_reg_file_ops_no_compat;\n\t\t\t\telse\n#endif\n\t\t\t\t\tinode->i_fop = &proc_reg_file_ops;\n\t\t\t} else {\n\t\t\t\tinode->i_fop = de->proc_fops;\n\t\t\t}\n\t\t}\n\t} else\n\t       pde_put(de);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/namei.h>",
            "#include <linux/magic.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/limits.h>",
            "#include <linux/file.h>",
            "#include <linux/printk.h>",
            "#include <linux/poll.h>",
            "#include <linux/completion.h>",
            "#include <linux/stat.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/kernel.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations proc_reg_file_ops = {\n\t.llseek\t\t= proc_reg_llseek,\n\t.read\t\t= proc_reg_read,\n\t.write\t\t= proc_reg_write,\n\t.poll\t\t= proc_reg_poll,\n\t.unlocked_ioctl\t= proc_reg_unlocked_ioctl,\n#ifdef CONFIG_COMPAT\n\t.compat_ioctl\t= proc_reg_compat_ioctl,\n#endif\n\t.mmap\t\t= proc_reg_mmap,\n\t.get_unmapped_area = proc_reg_get_unmapped_area,\n\t.open\t\t= proc_reg_open,\n\t.release\t= proc_reg_release,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/namei.h>\n#include <linux/magic.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/sysctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/limits.h>\n#include <linux/file.h>\n#include <linux/printk.h>\n#include <linux/poll.h>\n#include <linux/completion.h>\n#include <linux/stat.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/pid_namespace.h>\n#include <linux/kernel.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n\nstatic const struct file_operations proc_reg_file_ops = {\n\t.llseek\t\t= proc_reg_llseek,\n\t.read\t\t= proc_reg_read,\n\t.write\t\t= proc_reg_write,\n\t.poll\t\t= proc_reg_poll,\n\t.unlocked_ioctl\t= proc_reg_unlocked_ioctl,\n#ifdef CONFIG_COMPAT\n\t.compat_ioctl\t= proc_reg_compat_ioctl,\n#endif\n\t.mmap\t\t= proc_reg_mmap,\n\t.get_unmapped_area = proc_reg_get_unmapped_area,\n\t.open\t\t= proc_reg_open,\n\t.release\t= proc_reg_release,\n};\n\nstruct inode *proc_get_inode(struct super_block *sb, struct proc_dir_entry *de)\n{\n\tstruct inode *inode = new_inode_pseudo(sb);\n\n\tif (inode) {\n\t\tinode->i_ino = de->low_ino;\n\t\tinode->i_mtime = inode->i_atime = inode->i_ctime = CURRENT_TIME;\n\t\tPROC_I(inode)->pde = de;\n\n\t\tif (de->mode) {\n\t\t\tinode->i_mode = de->mode;\n\t\t\tinode->i_uid = de->uid;\n\t\t\tinode->i_gid = de->gid;\n\t\t}\n\t\tif (de->size)\n\t\t\tinode->i_size = de->size;\n\t\tif (de->nlink)\n\t\t\tset_nlink(inode, de->nlink);\n\t\tWARN_ON(!de->proc_iops);\n\t\tinode->i_op = de->proc_iops;\n\t\tif (de->proc_fops) {\n\t\t\tif (S_ISREG(inode->i_mode)) {\n#ifdef CONFIG_COMPAT\n\t\t\t\tif (!de->proc_fops->compat_ioctl)\n\t\t\t\t\tinode->i_fop =\n\t\t\t\t\t\t&proc_reg_file_ops_no_compat;\n\t\t\t\telse\n#endif\n\t\t\t\t\tinode->i_fop = &proc_reg_file_ops;\n\t\t\t} else {\n\t\t\t\tinode->i_fop = de->proc_fops;\n\t\t\t}\n\t\t}\n\t} else\n\t       pde_put(de);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pde_get",
          "args": [
            "de"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "pde_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/internal.h",
          "lines": "187-191",
          "snippet": "static inline struct proc_dir_entry *pde_get(struct proc_dir_entry *pde)\n{\n\tatomic_inc(&pde->count);\n\treturn pde;\n}",
          "includes": [
            "#include <linux/binfmts.h>",
            "#include <linux/atomic.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void pde_put(struct proc_dir_entry *);",
            "extern struct inode *proc_get_inode(struct super_block *, struct proc_dir_entry *);",
            "extern void proc_entry_rundown(struct proc_dir_entry *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/binfmts.h>\n#include <linux/atomic.h>\n#include <linux/spinlock.h>\n#include <linux/proc_ns.h>\n#include <linux/proc_fs.h>\n\nextern void pde_put(struct proc_dir_entry *);\nextern struct inode *proc_get_inode(struct super_block *, struct proc_dir_entry *);\nextern void proc_entry_rundown(struct proc_dir_entry *);\n\nstatic inline struct proc_dir_entry *pde_get(struct proc_dir_entry *pde)\n{\n\tatomic_inc(&pde->count);\n\treturn pde;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pde_subdir_find",
          "args": [
            "de",
            "dentry->d_name.name",
            "dentry->d_name.len"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "53-73",
          "snippet": "static struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstruct dentry *proc_lookup_de(struct proc_dir_entry *de, struct inode *dir,\n\t\tstruct dentry *dentry)\n{\n\tstruct inode *inode;\n\n\tspin_lock(&proc_subdir_lock);\n\tde = pde_subdir_find(de, dentry->d_name.name, dentry->d_name.len);\n\tif (de) {\n\t\tpde_get(de);\n\t\tspin_unlock(&proc_subdir_lock);\n\t\tinode = proc_get_inode(dir->i_sb, de);\n\t\tif (!inode)\n\t\t\treturn ERR_PTR(-ENOMEM);\n\t\td_set_d_op(dentry, &simple_dentry_operations);\n\t\td_add(dentry, inode);\n\t\treturn NULL;\n\t}\n\tspin_unlock(&proc_subdir_lock);\n\treturn ERR_PTR(-ENOENT);\n}"
  },
  {
    "function_name": "proc_free_inum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "217-223",
    "snippet": "void proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define PROC_DYNAMIC_FIRST 0xF0000000U"
    ],
    "globals_used": [
      "static DEFINE_IDA(proc_inum_ida);",
      "static DEFINE_SPINLOCK(proc_inum_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&proc_inum_lock",
            "flags"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_remove",
          "args": [
            "&proc_inum_ida",
            "inum - PROC_DYNAMIC_FIRST"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&proc_inum_lock",
            "flags"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\n#define PROC_DYNAMIC_FIRST 0xF0000000U\n\nstatic DEFINE_IDA(proc_inum_ida);\nstatic DEFINE_SPINLOCK(proc_inum_lock);\n\nvoid proc_free_inum(unsigned int inum)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&proc_inum_lock, flags);\n\tida_remove(&proc_inum_ida, inum - PROC_DYNAMIC_FIRST);\n\tspin_unlock_irqrestore(&proc_inum_lock, flags);\n}"
  },
  {
    "function_name": "proc_alloc_inum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "190-215",
    "snippet": "int proc_alloc_inum(unsigned int *inum)\n{\n\tunsigned int i;\n\tint error;\n\nretry:\n\tif (!ida_pre_get(&proc_inum_ida, GFP_KERNEL))\n\t\treturn -ENOMEM;\n\n\tspin_lock_irq(&proc_inum_lock);\n\terror = ida_get_new(&proc_inum_ida, &i);\n\tspin_unlock_irq(&proc_inum_lock);\n\tif (error == -EAGAIN)\n\t\tgoto retry;\n\telse if (error)\n\t\treturn error;\n\n\tif (i > UINT_MAX - PROC_DYNAMIC_FIRST) {\n\t\tspin_lock_irq(&proc_inum_lock);\n\t\tida_remove(&proc_inum_ida, i);\n\t\tspin_unlock_irq(&proc_inum_lock);\n\t\treturn -ENOSPC;\n\t}\n\t*inum = PROC_DYNAMIC_FIRST + i;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define PROC_DYNAMIC_FIRST 0xF0000000U"
    ],
    "globals_used": [
      "static DEFINE_IDA(proc_inum_ida);",
      "static DEFINE_SPINLOCK(proc_inum_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&proc_inum_lock"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_remove",
          "args": [
            "&proc_inum_ida",
            "i"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&proc_inum_lock"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&proc_inum_lock"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_get_new",
          "args": [
            "&proc_inum_ida",
            "&i"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&proc_inum_lock"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ida_pre_get",
          "args": [
            "&proc_inum_ida",
            "GFP_KERNEL"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\n#define PROC_DYNAMIC_FIRST 0xF0000000U\n\nstatic DEFINE_IDA(proc_inum_ida);\nstatic DEFINE_SPINLOCK(proc_inum_lock);\n\nint proc_alloc_inum(unsigned int *inum)\n{\n\tunsigned int i;\n\tint error;\n\nretry:\n\tif (!ida_pre_get(&proc_inum_ida, GFP_KERNEL))\n\t\treturn -ENOMEM;\n\n\tspin_lock_irq(&proc_inum_lock);\n\terror = ida_get_new(&proc_inum_ida, &i);\n\tspin_unlock_irq(&proc_inum_lock);\n\tif (error == -EAGAIN)\n\t\tgoto retry;\n\telse if (error)\n\t\treturn error;\n\n\tif (i > UINT_MAX - PROC_DYNAMIC_FIRST) {\n\t\tspin_lock_irq(&proc_inum_lock);\n\t\tida_remove(&proc_inum_ida, i);\n\t\tspin_unlock_irq(&proc_inum_lock);\n\t\treturn -ENOSPC;\n\t}\n\t*inum = PROC_DYNAMIC_FIRST + i;\n\treturn 0;\n}"
  },
  {
    "function_name": "xlate_proc_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "170-179",
    "snippet": "static int xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t   const char **residual)\n{\n\tint rv;\n\n\tspin_lock(&proc_subdir_lock);\n\trv = __xlate_proc_name(name, ret, residual);\n\tspin_unlock(&proc_subdir_lock);\n\treturn rv;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(proc_subdir_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__xlate_proc_name",
          "args": [
            "name",
            "ret",
            "residual"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "__xlate_proc_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "141-168",
          "snippet": "static int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&proc_subdir_lock"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic DEFINE_SPINLOCK(proc_subdir_lock);\n\nstatic int xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t   const char **residual)\n{\n\tint rv;\n\n\tspin_lock(&proc_subdir_lock);\n\trv = __xlate_proc_name(name, ret, residual);\n\tspin_unlock(&proc_subdir_lock);\n\treturn rv;\n}"
  },
  {
    "function_name": "__xlate_proc_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "141-168",
    "snippet": "static int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"name '%s'\\n\"",
            "name"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pde_subdir_find",
          "args": [
            "de",
            "cp",
            "len"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "pde_subdir_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "53-73",
          "snippet": "static struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cp",
            "'/'"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int __xlate_proc_name(const char *name, struct proc_dir_entry **ret,\n\t\t\t     const char **residual)\n{\n\tconst char     \t\t*cp = name, *next;\n\tstruct proc_dir_entry\t*de;\n\tunsigned int\t\tlen;\n\n\tde = *ret;\n\tif (!de)\n\t\tde = &proc_root;\n\n\twhile (1) {\n\t\tnext = strchr(cp, '/');\n\t\tif (!next)\n\t\t\tbreak;\n\n\t\tlen = next - cp;\n\t\tde = pde_subdir_find(de, cp, len);\n\t\tif (!de) {\n\t\t\tWARN(1, \"name '%s'\\n\", name);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcp += len + 1;\n\t}\n\t*residual = cp;\n\t*ret = de;\n\treturn 0;\n}"
  },
  {
    "function_name": "proc_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "120-130",
    "snippet": "static int proc_getattr(struct vfsmount *mnt, struct dentry *dentry,\n\t\t\tstruct kstat *stat)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct proc_dir_entry *de = PDE(inode);\n\tif (de && de->nlink)\n\t\tset_nlink(inode, de->nlink);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_fillattr",
          "args": [
            "inode",
            "stat"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "generic_fillattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "21-36",
          "snippet": "void generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = (1 << inode->i_blkbits);\n\tstat->blocks = inode->i_blocks;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = (1 << inode->i_blkbits);\n\tstat->blocks = inode->i_blocks;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_nlink",
          "args": [
            "inode",
            "de->nlink"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "set_nlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "305-316",
          "snippet": "void set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid set_nlink(struct inode *inode, unsigned int nlink)\n{\n\tif (!nlink) {\n\t\tclear_nlink(inode);\n\t} else {\n\t\t/* Yes, some filesystems do change nlink from zero to one */\n\t\tif (inode->i_nlink == 0)\n\t\t\tatomic_long_dec(&inode->i_sb->s_remove_count);\n\n\t\tinode->__i_nlink = nlink;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PDE",
          "args": [
            "inode"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "618-621",
          "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int proc_getattr(struct vfsmount *mnt, struct dentry *dentry,\n\t\t\tstruct kstat *stat)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct proc_dir_entry *de = PDE(inode);\n\tif (de && de->nlink)\n\t\tset_nlink(inode, de->nlink);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}"
  },
  {
    "function_name": "proc_notify_change",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "102-118",
    "snippet": "static int proc_notify_change(struct dentry *dentry, struct iattr *iattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct proc_dir_entry *de = PDE(inode);\n\tint error;\n\n\terror = inode_change_ok(inode, iattr);\n\tif (error)\n\t\treturn error;\n\n\tsetattr_copy(inode, iattr);\n\tmark_inode_dirty(inode);\n\n\tproc_set_user(de, inode->i_uid, inode->i_gid);\n\tde->mode = inode->i_mode;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_set_user",
          "args": [
            "de",
            "inode->i_uid",
            "inode->i_gid"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "proc_set_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "498-502",
          "snippet": "void proc_set_user(struct proc_dir_entry *de, kuid_t uid, kgid_t gid)\n{\n\tde->uid = uid;\n\tde->gid = gid;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid proc_set_user(struct proc_dir_entry *de, kuid_t uid, kgid_t gid)\n{\n\tde->uid = uid;\n\tde->gid = gid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_inode_dirty",
          "args": [
            "inode"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "block_dump___mark_inode_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fs-writeback.c",
          "lines": "1134-1154",
          "snippet": "static noinline void block_dump___mark_inode_dirty(struct inode *inode)\n{\n\tif (inode->i_ino || strcmp(inode->i_sb->s_id, \"bdev\")) {\n\t\tstruct dentry *dentry;\n\t\tconst char *name = \"?\";\n\n\t\tdentry = d_find_alias(inode);\n\t\tif (dentry) {\n\t\t\tspin_lock(&dentry->d_lock);\n\t\t\tname = (const char *) dentry->d_name.name;\n\t\t}\n\t\tprintk(KERN_DEBUG\n\t\t       \"%s(%d): dirtied inode %lu (%s) on %s\\n\",\n\t\t       current->comm, task_pid_nr(current), inode->i_ino,\n\t\t       name, inode->i_sb->s_id);\n\t\tif (dentry) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tdput(dentry);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/writeback.h>",
            "#include \"internal.h\"",
            "#include <linux/device.h>",
            "#include <linux/tracepoint.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/kthread.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/writeback.h>\n#include \"internal.h\"\n#include <linux/device.h>\n#include <linux/tracepoint.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/kthread.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic noinline void block_dump___mark_inode_dirty(struct inode *inode)\n{\n\tif (inode->i_ino || strcmp(inode->i_sb->s_id, \"bdev\")) {\n\t\tstruct dentry *dentry;\n\t\tconst char *name = \"?\";\n\n\t\tdentry = d_find_alias(inode);\n\t\tif (dentry) {\n\t\t\tspin_lock(&dentry->d_lock);\n\t\t\tname = (const char *) dentry->d_name.name;\n\t\t}\n\t\tprintk(KERN_DEBUG\n\t\t       \"%s(%d): dirtied inode %lu (%s) on %s\\n\",\n\t\t       current->comm, task_pid_nr(current), inode->i_ino,\n\t\t       name, inode->i_sb->s_id);\n\t\tif (dentry) {\n\t\t\tspin_unlock(&dentry->d_lock);\n\t\t\tdput(dentry);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setattr_copy",
          "args": [
            "inode",
            "iattr"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "setattr_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/attr.c",
          "lines": "142-167",
          "snippet": "void setattr_copy(struct inode *inode, const struct iattr *attr)\n{\n\tunsigned int ia_valid = attr->ia_valid;\n\n\tif (ia_valid & ATTR_UID)\n\t\tinode->i_uid = attr->ia_uid;\n\tif (ia_valid & ATTR_GID)\n\t\tinode->i_gid = attr->ia_gid;\n\tif (ia_valid & ATTR_ATIME)\n\t\tinode->i_atime = timespec_trunc(attr->ia_atime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_MTIME)\n\t\tinode->i_mtime = timespec_trunc(attr->ia_mtime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_CTIME)\n\t\tinode->i_ctime = timespec_trunc(attr->ia_ctime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_MODE) {\n\t\tumode_t mode = attr->ia_mode;\n\n\t\tif (!in_group_p(inode->i_gid) &&\n\t\t    !capable_wrt_inode_uidgid(inode, CAP_FSETID))\n\t\t\tmode &= ~S_ISGID;\n\t\tinode->i_mode = mode;\n\t}\n}",
          "includes": [
            "#include <linux/ima.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/capability.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ima.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/fcntl.h>\n#include <linux/fsnotify.h>\n#include <linux/capability.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/export.h>\n\nvoid setattr_copy(struct inode *inode, const struct iattr *attr)\n{\n\tunsigned int ia_valid = attr->ia_valid;\n\n\tif (ia_valid & ATTR_UID)\n\t\tinode->i_uid = attr->ia_uid;\n\tif (ia_valid & ATTR_GID)\n\t\tinode->i_gid = attr->ia_gid;\n\tif (ia_valid & ATTR_ATIME)\n\t\tinode->i_atime = timespec_trunc(attr->ia_atime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_MTIME)\n\t\tinode->i_mtime = timespec_trunc(attr->ia_mtime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_CTIME)\n\t\tinode->i_ctime = timespec_trunc(attr->ia_ctime,\n\t\t\t\t\t\tinode->i_sb->s_time_gran);\n\tif (ia_valid & ATTR_MODE) {\n\t\tumode_t mode = attr->ia_mode;\n\n\t\tif (!in_group_p(inode->i_gid) &&\n\t\t    !capable_wrt_inode_uidgid(inode, CAP_FSETID))\n\t\t\tmode &= ~S_ISGID;\n\t\tinode->i_mode = mode;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_change_ok",
          "args": [
            "inode",
            "iattr"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "inode_change_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/attr.c",
          "lines": "31-81",
          "snippet": "int inode_change_ok(const struct inode *inode, struct iattr *attr)\n{\n\tunsigned int ia_valid = attr->ia_valid;\n\n\t/*\n\t * First check size constraints.  These can't be overriden using\n\t * ATTR_FORCE.\n\t */\n\tif (ia_valid & ATTR_SIZE) {\n\t\tint error = inode_newsize_ok(inode, attr->ia_size);\n\t\tif (error)\n\t\t\treturn error;\n\t}\n\n\t/* If force is set do it anyway. */\n\tif (ia_valid & ATTR_FORCE)\n\t\treturn 0;\n\n\t/* Make sure a caller can chown. */\n\tif ((ia_valid & ATTR_UID) &&\n\t    (!uid_eq(current_fsuid(), inode->i_uid) ||\n\t     !uid_eq(attr->ia_uid, inode->i_uid)) &&\n\t    !capable_wrt_inode_uidgid(inode, CAP_CHOWN))\n\t\treturn -EPERM;\n\n\t/* Make sure caller can chgrp. */\n\tif ((ia_valid & ATTR_GID) &&\n\t    (!uid_eq(current_fsuid(), inode->i_uid) ||\n\t    (!in_group_p(attr->ia_gid) && !gid_eq(attr->ia_gid, inode->i_gid))) &&\n\t    !capable_wrt_inode_uidgid(inode, CAP_CHOWN))\n\t\treturn -EPERM;\n\n\t/* Make sure a caller can chmod. */\n\tif (ia_valid & ATTR_MODE) {\n\t\tif (!inode_owner_or_capable(inode))\n\t\t\treturn -EPERM;\n\t\t/* Also check the setgid bit! */\n\t\tif (!in_group_p((ia_valid & ATTR_GID) ? attr->ia_gid :\n\t\t\t\tinode->i_gid) &&\n\t\t    !capable_wrt_inode_uidgid(inode, CAP_FSETID))\n\t\t\tattr->ia_mode &= ~S_ISGID;\n\t}\n\n\t/* Check for setting the inode time. */\n\tif (ia_valid & (ATTR_MTIME_SET | ATTR_ATIME_SET | ATTR_TIMES_SET)) {\n\t\tif (!inode_owner_or_capable(inode))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/ima.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/capability.h>",
            "#include <linux/string.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ima.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/fcntl.h>\n#include <linux/fsnotify.h>\n#include <linux/capability.h>\n#include <linux/string.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/export.h>\n\nint inode_change_ok(const struct inode *inode, struct iattr *attr)\n{\n\tunsigned int ia_valid = attr->ia_valid;\n\n\t/*\n\t * First check size constraints.  These can't be overriden using\n\t * ATTR_FORCE.\n\t */\n\tif (ia_valid & ATTR_SIZE) {\n\t\tint error = inode_newsize_ok(inode, attr->ia_size);\n\t\tif (error)\n\t\t\treturn error;\n\t}\n\n\t/* If force is set do it anyway. */\n\tif (ia_valid & ATTR_FORCE)\n\t\treturn 0;\n\n\t/* Make sure a caller can chown. */\n\tif ((ia_valid & ATTR_UID) &&\n\t    (!uid_eq(current_fsuid(), inode->i_uid) ||\n\t     !uid_eq(attr->ia_uid, inode->i_uid)) &&\n\t    !capable_wrt_inode_uidgid(inode, CAP_CHOWN))\n\t\treturn -EPERM;\n\n\t/* Make sure caller can chgrp. */\n\tif ((ia_valid & ATTR_GID) &&\n\t    (!uid_eq(current_fsuid(), inode->i_uid) ||\n\t    (!in_group_p(attr->ia_gid) && !gid_eq(attr->ia_gid, inode->i_gid))) &&\n\t    !capable_wrt_inode_uidgid(inode, CAP_CHOWN))\n\t\treturn -EPERM;\n\n\t/* Make sure a caller can chmod. */\n\tif (ia_valid & ATTR_MODE) {\n\t\tif (!inode_owner_or_capable(inode))\n\t\t\treturn -EPERM;\n\t\t/* Also check the setgid bit! */\n\t\tif (!in_group_p((ia_valid & ATTR_GID) ? attr->ia_gid :\n\t\t\t\tinode->i_gid) &&\n\t\t    !capable_wrt_inode_uidgid(inode, CAP_FSETID))\n\t\t\tattr->ia_mode &= ~S_ISGID;\n\t}\n\n\t/* Check for setting the inode time. */\n\tif (ia_valid & (ATTR_MTIME_SET | ATTR_ATIME_SET | ATTR_TIMES_SET)) {\n\t\tif (!inode_owner_or_capable(inode))\n\t\t\treturn -EPERM;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PDE",
          "args": [
            "inode"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "PDE_DATA",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "618-621",
          "snippet": "void *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nvoid *PDE_DATA(const struct inode *inode)\n{\n\treturn __PDE_DATA(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int proc_notify_change(struct dentry *dentry, struct iattr *iattr)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tstruct proc_dir_entry *de = PDE(inode);\n\tint error;\n\n\terror = inode_change_ok(inode, iattr);\n\tif (error)\n\t\treturn error;\n\n\tsetattr_copy(inode, iattr);\n\tmark_inode_dirty(inode);\n\n\tproc_set_user(de, inode->i_uid, inode->i_gid);\n\tde->mode = inode->i_mode;\n\treturn 0;\n}"
  },
  {
    "function_name": "pde_subdir_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "75-100",
    "snippet": "static bool pde_subdir_insert(struct proc_dir_entry *dir,\n\t\t\t      struct proc_dir_entry *de)\n{\n\tstruct rb_root *root = &dir->subdir;\n\tstruct rb_node **new = &root->rb_node, *parent = NULL;\n\n\t/* Figure out where to put new node */\n\twhile (*new) {\n\t\tstruct proc_dir_entry *this =\n\t\t\tcontainer_of(*new, struct proc_dir_entry, subdir_node);\n\t\tint result = proc_match(de->namelen, de->name, this);\n\n\t\tparent = *new;\n\t\tif (result < 0)\n\t\t\tnew = &(*new)->rb_left;\n\t\telse if (result > 0)\n\t\t\tnew = &(*new)->rb_right;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t/* Add new node and rebalance tree. */\n\trb_link_node(&de->subdir_node, parent, new);\n\trb_insert_color(&de->subdir_node, root);\n\treturn true;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "&de->subdir_node",
            "root"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "&de->subdir_node",
            "parent",
            "new"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_match",
          "args": [
            "de->namelen",
            "de->name",
            "this"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "proc_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "31-39",
          "snippet": "static int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "*new",
            "structproc_dir_entry",
            "subdir_node"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic bool pde_subdir_insert(struct proc_dir_entry *dir,\n\t\t\t      struct proc_dir_entry *de)\n{\n\tstruct rb_root *root = &dir->subdir;\n\tstruct rb_node **new = &root->rb_node, *parent = NULL;\n\n\t/* Figure out where to put new node */\n\twhile (*new) {\n\t\tstruct proc_dir_entry *this =\n\t\t\tcontainer_of(*new, struct proc_dir_entry, subdir_node);\n\t\tint result = proc_match(de->namelen, de->name, this);\n\n\t\tparent = *new;\n\t\tif (result < 0)\n\t\t\tnew = &(*new)->rb_left;\n\t\telse if (result > 0)\n\t\t\tnew = &(*new)->rb_right;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\t/* Add new node and rebalance tree. */\n\trb_link_node(&de->subdir_node, parent, new);\n\trb_insert_color(&de->subdir_node, root);\n\treturn true;\n}"
  },
  {
    "function_name": "pde_subdir_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "53-73",
    "snippet": "static struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_match",
          "args": [
            "len",
            "name",
            "de"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "proc_match",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
          "lines": "31-39",
          "snippet": "static int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/idr.h>",
            "#include <linux/init.h>",
            "#include <linux/mount.h>",
            "#include <linux/printk.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/stat.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "node",
            "structproc_dir_entry",
            "subdir_node"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_find(struct proc_dir_entry *dir,\n\t\t\t\t\t      const char *name,\n\t\t\t\t\t      unsigned int len)\n{\n\tstruct rb_node *node = dir->subdir.rb_node;\n\n\twhile (node) {\n\t\tstruct proc_dir_entry *de = container_of(node,\n\t\t\t\t\t\t\t struct proc_dir_entry,\n\t\t\t\t\t\t\t subdir_node);\n\t\tint result = proc_match(len, name, de);\n\n\t\tif (result < 0)\n\t\t\tnode = node->rb_left;\n\t\telse if (result > 0)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn de;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "pde_subdir_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "47-51",
    "snippet": "static struct proc_dir_entry *pde_subdir_next(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_next(&dir->subdir_node), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry_safe",
          "args": [
            "rb_next(&dir->subdir_node)",
            "structproc_dir_entry",
            "subdir_node"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_next",
          "args": [
            "&dir->subdir_node"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_next(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_next(&dir->subdir_node), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
  },
  {
    "function_name": "pde_subdir_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "41-45",
    "snippet": "static struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry_safe",
          "args": [
            "rb_first(&dir->subdir)",
            "structproc_dir_entry",
            "subdir_node"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_first",
          "args": [
            "&dir->subdir"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic struct proc_dir_entry *pde_subdir_first(struct proc_dir_entry *dir)\n{\n\treturn rb_entry_safe(rb_first(&dir->subdir), struct proc_dir_entry,\n\t\t\t     subdir_node);\n}"
  },
  {
    "function_name": "proc_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/generic.c",
    "lines": "31-39",
    "snippet": "static int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/uaccess.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/idr.h>",
      "#include <linux/init.h>",
      "#include <linux/mount.h>",
      "#include <linux/printk.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/stat.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/time.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "name",
            "de->name",
            "len"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/idr.h>\n#include <linux/init.h>\n#include <linux/mount.h>\n#include <linux/printk.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/stat.h>\n#include <linux/proc_fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n\nstatic int proc_match(unsigned int len, const char *name, struct proc_dir_entry *de)\n{\n\tif (len < de->namelen)\n\t\treturn -1;\n\tif (len > de->namelen)\n\t\treturn 1;\n\n\treturn memcmp(name, de->name, len);\n}"
  }
]