[
  {
    "function_name": "gfs2_fh_to_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "180-199",
    "snippet": "static struct dentry *gfs2_fh_to_parent(struct super_block *sb, struct fid *fid,\n\t\tint fh_len, int fh_type)\n{\n\tstruct gfs2_inum_host parent;\n\t__be32 *fh = (__force __be32 *)fid->raw;\n\n\tswitch (fh_type) {\n\tcase GFS2_LARGE_FH_SIZE:\n\tcase GFS2_OLD_FH_SIZE:\n\t\tif (fh_len < GFS2_LARGE_FH_SIZE)\n\t\t\treturn NULL;\n\t\tparent.no_formal_ino = ((u64)be32_to_cpu(fh[4])) << 32;\n\t\tparent.no_formal_ino |= be32_to_cpu(fh[5]);\n\t\tparent.no_addr = ((u64)be32_to_cpu(fh[6])) << 32;\n\t\tparent.no_addr |= be32_to_cpu(fh[7]);\n\t\treturn gfs2_get_dentry(sb, &parent);\n\tdefault:\n\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [
      "#define GFS2_OLD_FH_SIZE 10",
      "#define GFS2_LARGE_FH_SIZE 8"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_get_dentry",
          "args": [
            "sb",
            "&parent"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_get_dentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
          "lines": "134-156",
          "snippet": "static struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"rgrp.h\"",
            "#include \"super.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"dir.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[7]"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[6]"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[5]"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[4]"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\n#define GFS2_OLD_FH_SIZE 10\n#define GFS2_LARGE_FH_SIZE 8\n\nstatic struct dentry *gfs2_fh_to_parent(struct super_block *sb, struct fid *fid,\n\t\tint fh_len, int fh_type)\n{\n\tstruct gfs2_inum_host parent;\n\t__be32 *fh = (__force __be32 *)fid->raw;\n\n\tswitch (fh_type) {\n\tcase GFS2_LARGE_FH_SIZE:\n\tcase GFS2_OLD_FH_SIZE:\n\t\tif (fh_len < GFS2_LARGE_FH_SIZE)\n\t\t\treturn NULL;\n\t\tparent.no_formal_ino = ((u64)be32_to_cpu(fh[4])) << 32;\n\t\tparent.no_formal_ino |= be32_to_cpu(fh[5]);\n\t\tparent.no_addr = ((u64)be32_to_cpu(fh[6])) << 32;\n\t\tparent.no_addr |= be32_to_cpu(fh[7]);\n\t\treturn gfs2_get_dentry(sb, &parent);\n\tdefault:\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "gfs2_fh_to_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "158-178",
    "snippet": "static struct dentry *gfs2_fh_to_dentry(struct super_block *sb, struct fid *fid,\n\t\tint fh_len, int fh_type)\n{\n\tstruct gfs2_inum_host this;\n\t__be32 *fh = (__force __be32 *)fid->raw;\n\n\tswitch (fh_type) {\n\tcase GFS2_SMALL_FH_SIZE:\n\tcase GFS2_LARGE_FH_SIZE:\n\tcase GFS2_OLD_FH_SIZE:\n\t\tif (fh_len < GFS2_SMALL_FH_SIZE)\n\t\t\treturn NULL;\n\t\tthis.no_formal_ino = ((u64)be32_to_cpu(fh[0])) << 32;\n\t\tthis.no_formal_ino |= be32_to_cpu(fh[1]);\n\t\tthis.no_addr = ((u64)be32_to_cpu(fh[2])) << 32;\n\t\tthis.no_addr |= be32_to_cpu(fh[3]);\n\t\treturn gfs2_get_dentry(sb, &this);\n\tdefault:\n\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [
      "#define GFS2_OLD_FH_SIZE 10",
      "#define GFS2_LARGE_FH_SIZE 8",
      "#define GFS2_SMALL_FH_SIZE 4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_get_dentry",
          "args": [
            "sb",
            "&this"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_get_dentry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
          "lines": "134-156",
          "snippet": "static struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"rgrp.h\"",
            "#include \"super.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"dir.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[3]"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[2]"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[1]"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpu",
          "args": [
            "fh[0]"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\n#define GFS2_OLD_FH_SIZE 10\n#define GFS2_LARGE_FH_SIZE 8\n#define GFS2_SMALL_FH_SIZE 4\n\nstatic struct dentry *gfs2_fh_to_dentry(struct super_block *sb, struct fid *fid,\n\t\tint fh_len, int fh_type)\n{\n\tstruct gfs2_inum_host this;\n\t__be32 *fh = (__force __be32 *)fid->raw;\n\n\tswitch (fh_type) {\n\tcase GFS2_SMALL_FH_SIZE:\n\tcase GFS2_LARGE_FH_SIZE:\n\tcase GFS2_OLD_FH_SIZE:\n\t\tif (fh_len < GFS2_SMALL_FH_SIZE)\n\t\t\treturn NULL;\n\t\tthis.no_formal_ino = ((u64)be32_to_cpu(fh[0])) << 32;\n\t\tthis.no_formal_ino |= be32_to_cpu(fh[1]);\n\t\tthis.no_addr = ((u64)be32_to_cpu(fh[2])) << 32;\n\t\tthis.no_addr |= be32_to_cpu(fh[3]);\n\t\treturn gfs2_get_dentry(sb, &this);\n\tdefault:\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "gfs2_get_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "134-156",
    "snippet": "static struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_obtain_alias",
          "args": [
            "inode"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "d_obtain_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1977-1980",
          "snippet": "struct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "inode"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfs2_lookup_by_inum",
          "args": [
            "sdp",
            "inum->no_addr",
            "&inum->no_formal_ino",
            "GFS2_BLKST_DINODE"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_lookup_by_inum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.c",
          "lines": "206-247",
          "snippet": "struct inode *gfs2_lookup_by_inum(struct gfs2_sbd *sdp, u64 no_addr,\n\t\t\t\t  u64 *no_formal_ino, unsigned int blktype)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tstruct gfs2_holder i_gh;\n\tstruct inode *inode = NULL;\n\tint error;\n\n\t/* Must not read in block until block type is verified */\n\terror = gfs2_glock_nq_num(sdp, no_addr, &gfs2_inode_glops,\n\t\t\t\t  LM_ST_EXCLUSIVE, GL_SKIP, &i_gh);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\terror = gfs2_check_blk_type(sdp, no_addr, blktype);\n\tif (error)\n\t\tgoto fail;\n\n\tinode = gfs2_inode_lookup(sb, DT_UNKNOWN, no_addr, 0, 1);\n\tif (IS_ERR(inode))\n\t\tgoto fail;\n\n\t/* Two extra checks for NFS only */\n\tif (no_formal_ino) {\n\t\terror = -ESTALE;\n\t\tif (GFS2_I(inode)->i_no_formal_ino != *no_formal_ino)\n\t\t\tgoto fail_iput;\n\n\t\terror = -EIO;\n\t\tif (GFS2_I(inode)->i_diskflags & GFS2_DIF_SYSTEM)\n\t\t\tgoto fail_iput;\n\n\t\terror = 0;\n\t}\n\nfail:\n\tgfs2_glock_dq_uninit(&i_gh);\n\treturn error ? ERR_PTR(error) : inode;\nfail_iput:\n\tiput(inode);\n\tgoto fail;\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"super.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/fiemap.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"super.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/fiemap.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct inode *gfs2_lookup_by_inum(struct gfs2_sbd *sdp, u64 no_addr,\n\t\t\t\t  u64 *no_formal_ino, unsigned int blktype)\n{\n\tstruct super_block *sb = sdp->sd_vfs;\n\tstruct gfs2_holder i_gh;\n\tstruct inode *inode = NULL;\n\tint error;\n\n\t/* Must not read in block until block type is verified */\n\terror = gfs2_glock_nq_num(sdp, no_addr, &gfs2_inode_glops,\n\t\t\t\t  LM_ST_EXCLUSIVE, GL_SKIP, &i_gh);\n\tif (error)\n\t\treturn ERR_PTR(error);\n\n\terror = gfs2_check_blk_type(sdp, no_addr, blktype);\n\tif (error)\n\t\tgoto fail;\n\n\tinode = gfs2_inode_lookup(sb, DT_UNKNOWN, no_addr, 0, 1);\n\tif (IS_ERR(inode))\n\t\tgoto fail;\n\n\t/* Two extra checks for NFS only */\n\tif (no_formal_ino) {\n\t\terror = -ESTALE;\n\t\tif (GFS2_I(inode)->i_no_formal_ino != *no_formal_ino)\n\t\t\tgoto fail_iput;\n\n\t\terror = -EIO;\n\t\tif (GFS2_I(inode)->i_diskflags & GFS2_DIF_SYSTEM)\n\t\t\tgoto fail_iput;\n\n\t\terror = 0;\n\t}\n\nfail:\n\tgfs2_glock_dq_uninit(&i_gh);\n\treturn error ? ERR_PTR(error) : inode;\nfail_iput:\n\tiput(inode);\n\tgoto fail;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ESTALE"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "inode"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_ilookup",
          "args": [
            "sb",
            "inum->no_addr",
            "0"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ilookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.c",
          "lines": "74-83",
          "snippet": "struct inode *gfs2_ilookup(struct super_block *sb, u64 no_addr, int non_block)\n{\n\tunsigned long hash = (unsigned long)no_addr;\n\tstruct gfs2_skip_data data;\n\n\tdata.no_addr = no_addr;\n\tdata.skipped = 0;\n\tdata.non_block = non_block;\n\treturn ilookup5(sb, hash, iget_test, &data);\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"super.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/fiemap.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"super.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/fiemap.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct inode *gfs2_ilookup(struct super_block *sb, u64 no_addr, int non_block)\n{\n\tunsigned long hash = (unsigned long)no_addr;\n\tstruct gfs2_skip_data data;\n\n\tdata.no_addr = no_addr;\n\tdata.skipped = 0;\n\tdata.non_block = non_block;\n\treturn ilookup5(sb, hash, iget_test, &data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic struct dentry *gfs2_get_dentry(struct super_block *sb,\n\t\t\t\t      struct gfs2_inum_host *inum)\n{\n\tstruct gfs2_sbd *sdp = sb->s_fs_info;\n\tstruct inode *inode;\n\n\tinode = gfs2_ilookup(sb, inum->no_addr, 0);\n\tif (inode) {\n\t\tif (GFS2_I(inode)->i_no_formal_ino != inum->no_formal_ino) {\n\t\t\tiput(inode);\n\t\t\treturn ERR_PTR(-ESTALE);\n\t\t}\n\t\tgoto out_inode;\n\t}\n\n\tinode = gfs2_lookup_by_inum(sdp, inum->no_addr, &inum->no_formal_ino,\n\t\t\t\t    GFS2_BLKST_DINODE);\n\tif (IS_ERR(inode))\n\t\treturn ERR_CAST(inode);\n\nout_inode:\n\treturn d_obtain_alias(inode);\n}"
  },
  {
    "function_name": "gfs2_get_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "129-132",
    "snippet": "static struct dentry *gfs2_get_parent(struct dentry *child)\n{\n\treturn d_obtain_alias(gfs2_lookupi(child->d_inode, &gfs2_qdotdot, 1));\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_obtain_alias",
          "args": [
            "gfs2_lookupi(child->d_inode, &gfs2_qdotdot, 1)"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "d_obtain_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "1977-1980",
          "snippet": "struct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstruct dentry *d_obtain_alias(struct inode *inode)\n{\n\treturn __d_obtain_alias(inode, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_lookupi",
          "args": [
            "child->d_inode",
            "&gfs2_qdotdot",
            "1"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_lookupi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/inode.c",
          "lines": "283-325",
          "snippet": "struct inode *gfs2_lookupi(struct inode *dir, const struct qstr *name,\n\t\t\t   int is_root)\n{\n\tstruct super_block *sb = dir->i_sb;\n\tstruct gfs2_inode *dip = GFS2_I(dir);\n\tstruct gfs2_holder d_gh;\n\tint error = 0;\n\tstruct inode *inode = NULL;\n\tint unlock = 0;\n\n\tif (!name->len || name->len > GFS2_FNAMESIZE)\n\t\treturn ERR_PTR(-ENAMETOOLONG);\n\n\tif ((name->len == 1 && memcmp(name->name, \".\", 1) == 0) ||\n\t    (name->len == 2 && memcmp(name->name, \"..\", 2) == 0 &&\n\t     dir == sb->s_root->d_inode)) {\n\t\tigrab(dir);\n\t\treturn dir;\n\t}\n\n\tif (gfs2_glock_is_locked_by_me(dip->i_gl) == NULL) {\n\t\terror = gfs2_glock_nq_init(dip->i_gl, LM_ST_SHARED, 0, &d_gh);\n\t\tif (error)\n\t\t\treturn ERR_PTR(error);\n\t\tunlock = 1;\n\t}\n\n\tif (!is_root) {\n\t\terror = gfs2_permission(dir, MAY_EXEC);\n\t\tif (error)\n\t\t\tgoto out;\n\t}\n\n\tinode = gfs2_dir_search(dir, name, false);\n\tif (IS_ERR(inode))\n\t\terror = PTR_ERR(inode);\nout:\n\tif (unlock)\n\t\tgfs2_glock_dq_uninit(&d_gh);\n\tif (error == -ENOENT)\n\t\treturn NULL;\n\treturn inode ? inode : ERR_PTR(error);\n}",
          "includes": [
            "#include \"glops.h\"",
            "#include \"super.h\"",
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"dir.h\"",
            "#include \"bmap.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/security.h>",
            "#include <linux/fiemap.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/xattr.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glops.h\"\n#include \"super.h\"\n#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"dir.h\"\n#include \"bmap.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/security.h>\n#include <linux/fiemap.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/posix_acl.h>\n#include <linux/xattr.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstruct inode *gfs2_lookupi(struct inode *dir, const struct qstr *name,\n\t\t\t   int is_root)\n{\n\tstruct super_block *sb = dir->i_sb;\n\tstruct gfs2_inode *dip = GFS2_I(dir);\n\tstruct gfs2_holder d_gh;\n\tint error = 0;\n\tstruct inode *inode = NULL;\n\tint unlock = 0;\n\n\tif (!name->len || name->len > GFS2_FNAMESIZE)\n\t\treturn ERR_PTR(-ENAMETOOLONG);\n\n\tif ((name->len == 1 && memcmp(name->name, \".\", 1) == 0) ||\n\t    (name->len == 2 && memcmp(name->name, \"..\", 2) == 0 &&\n\t     dir == sb->s_root->d_inode)) {\n\t\tigrab(dir);\n\t\treturn dir;\n\t}\n\n\tif (gfs2_glock_is_locked_by_me(dip->i_gl) == NULL) {\n\t\terror = gfs2_glock_nq_init(dip->i_gl, LM_ST_SHARED, 0, &d_gh);\n\t\tif (error)\n\t\t\treturn ERR_PTR(error);\n\t\tunlock = 1;\n\t}\n\n\tif (!is_root) {\n\t\terror = gfs2_permission(dir, MAY_EXEC);\n\t\tif (error)\n\t\t\tgoto out;\n\t}\n\n\tinode = gfs2_dir_search(dir, name, false);\n\tif (IS_ERR(inode))\n\t\terror = PTR_ERR(inode);\nout:\n\tif (unlock)\n\t\tgfs2_glock_dq_uninit(&d_gh);\n\tif (error == -ENOENT)\n\t\treturn NULL;\n\treturn inode ? inode : ERR_PTR(error);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic struct dentry *gfs2_get_parent(struct dentry *child)\n{\n\treturn d_obtain_alias(gfs2_lookupi(child->d_inode, &gfs2_qdotdot, 1));\n}"
  },
  {
    "function_name": "gfs2_get_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "88-127",
    "snippet": "static int gfs2_get_name(struct dentry *parent, char *name,\n\t\t\t struct dentry *child)\n{\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode = child->d_inode;\n\tstruct gfs2_inode *dip, *ip;\n\tstruct get_name_filldir gnfd = {\n\t\t.ctx.actor = get_name_filldir,\n\t\t.name = name\n\t};\n\tstruct gfs2_holder gh;\n\tint error;\n\tstruct file_ra_state f_ra = { .start = 0 };\n\n\tif (!dir)\n\t\treturn -EINVAL;\n\n\tif (!S_ISDIR(dir->i_mode) || !inode)\n\t\treturn -EINVAL;\n\n\tdip = GFS2_I(dir);\n\tip = GFS2_I(inode);\n\n\t*name = 0;\n\tgnfd.inum.no_addr = ip->i_no_addr;\n\tgnfd.inum.no_formal_ino = ip->i_no_formal_ino;\n\n\terror = gfs2_glock_nq_init(dip->i_gl, LM_ST_SHARED, 0, &gh);\n\tif (error)\n\t\treturn error;\n\n\terror = gfs2_dir_read(dir, &gnfd.ctx, &f_ra);\n\n\tgfs2_glock_dq_uninit(&gh);\n\n\tif (!error && !*name)\n\t\terror = -ENOENT;\n\n\treturn error;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfs2_glock_dq_uninit",
          "args": [
            "&gh"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_dq_uninit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.c",
          "lines": "1110-1114",
          "snippet": "void gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}",
          "includes": [
            "#include \"trace_gfs2.h\"",
            "#include \"bmap.h\"",
            "#include \"util.h\"",
            "#include \"super.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"lops.h\"",
            "#include \"inode.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/lockref.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/list.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jhash.h>",
            "#include <linux/sort.h>",
            "#include <linux/delay.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_gfs2.h\"\n#include \"bmap.h\"\n#include \"util.h\"\n#include \"super.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"lops.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/lockref.h>\n#include <linux/list_sort.h>\n#include <linux/percpu.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/jiffies.h>\n#include <linux/workqueue.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <asm/uaccess.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/list.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/kallsyms.h>\n#include <linux/jhash.h>\n#include <linux/sort.h>\n#include <linux/delay.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nvoid gfs2_glock_dq_uninit(struct gfs2_holder *gh)\n{\n\tgfs2_glock_dq(gh);\n\tgfs2_holder_uninit(gh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_dir_read",
          "args": [
            "dir",
            "&gnfd.ctx",
            "&f_ra"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_dir_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/dir.c",
          "lines": "1475-1534",
          "snippet": "int gfs2_dir_read(struct inode *inode, struct dir_context *ctx,\n\t\t  struct file_ra_state *f_ra)\n{\n\tstruct gfs2_inode *dip = GFS2_I(inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(inode);\n\tstruct dirent_gather g;\n\tconst struct gfs2_dirent **darr, *dent;\n\tstruct buffer_head *dibh;\n\tint copied = 0;\n\tint error;\n\n\tif (!dip->i_entries)\n\t\treturn 0;\n\n\tif (dip->i_diskflags & GFS2_DIF_EXHASH)\n\t\treturn dir_e_read(inode, ctx, f_ra);\n\n\tif (!gfs2_is_stuffed(dip)) {\n\t\tgfs2_consist_inode(dip);\n\t\treturn -EIO;\n\t}\n\n\terror = gfs2_meta_inode_buffer(dip, &dibh);\n\tif (error)\n\t\treturn error;\n\n\terror = -ENOMEM;\n\t/* 96 is max number of dirents which can be stuffed into an inode */\n\tdarr = kmalloc(96 * sizeof(struct gfs2_dirent *), GFP_NOFS);\n\tif (darr) {\n\t\tg.pdent = darr;\n\t\tg.offset = 0;\n\t\tdent = gfs2_dirent_scan(inode, dibh->b_data, dibh->b_size,\n\t\t\t\t\tgfs2_dirent_gather, NULL, &g);\n\t\tif (IS_ERR(dent)) {\n\t\t\terror = PTR_ERR(dent);\n\t\t\tgoto out;\n\t\t}\n\t\tif (dip->i_entries != g.offset) {\n\t\t\tfs_warn(sdp, \"Number of entries corrupt in dir %llu, \"\n\t\t\t\t\"ip->i_entries (%u) != g.offset (%u)\\n\",\n\t\t\t\t(unsigned long long)dip->i_no_addr,\n\t\t\t\tdip->i_entries,\n\t\t\t\tg.offset);\n\t\t\terror = -EIO;\n\t\t\tgoto out;\n\t\t}\n\t\terror = do_filldir_main(dip, ctx, darr,\n\t\t\t\t\tdip->i_entries, &copied);\nout:\n\t\tkfree(darr);\n\t}\n\n\tif (error > 0)\n\t\terror = 0;\n\n\tbrelse(dibh);\n\n\treturn error;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"bmap.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"dir.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/crc32.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"bmap.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nint gfs2_dir_read(struct inode *inode, struct dir_context *ctx,\n\t\t  struct file_ra_state *f_ra)\n{\n\tstruct gfs2_inode *dip = GFS2_I(inode);\n\tstruct gfs2_sbd *sdp = GFS2_SB(inode);\n\tstruct dirent_gather g;\n\tconst struct gfs2_dirent **darr, *dent;\n\tstruct buffer_head *dibh;\n\tint copied = 0;\n\tint error;\n\n\tif (!dip->i_entries)\n\t\treturn 0;\n\n\tif (dip->i_diskflags & GFS2_DIF_EXHASH)\n\t\treturn dir_e_read(inode, ctx, f_ra);\n\n\tif (!gfs2_is_stuffed(dip)) {\n\t\tgfs2_consist_inode(dip);\n\t\treturn -EIO;\n\t}\n\n\terror = gfs2_meta_inode_buffer(dip, &dibh);\n\tif (error)\n\t\treturn error;\n\n\terror = -ENOMEM;\n\t/* 96 is max number of dirents which can be stuffed into an inode */\n\tdarr = kmalloc(96 * sizeof(struct gfs2_dirent *), GFP_NOFS);\n\tif (darr) {\n\t\tg.pdent = darr;\n\t\tg.offset = 0;\n\t\tdent = gfs2_dirent_scan(inode, dibh->b_data, dibh->b_size,\n\t\t\t\t\tgfs2_dirent_gather, NULL, &g);\n\t\tif (IS_ERR(dent)) {\n\t\t\terror = PTR_ERR(dent);\n\t\t\tgoto out;\n\t\t}\n\t\tif (dip->i_entries != g.offset) {\n\t\t\tfs_warn(sdp, \"Number of entries corrupt in dir %llu, \"\n\t\t\t\t\"ip->i_entries (%u) != g.offset (%u)\\n\",\n\t\t\t\t(unsigned long long)dip->i_no_addr,\n\t\t\t\tdip->i_entries,\n\t\t\t\tg.offset);\n\t\t\terror = -EIO;\n\t\t\tgoto out;\n\t\t}\n\t\terror = do_filldir_main(dip, ctx, darr,\n\t\t\t\t\tdip->i_entries, &copied);\nout:\n\t\tkfree(darr);\n\t}\n\n\tif (error > 0)\n\t\terror = 0;\n\n\tbrelse(dibh);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfs2_glock_nq_init",
          "args": [
            "dip->i_gl",
            "LM_ST_SHARED",
            "0",
            "&gh"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_glock_nq_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/glock.h",
          "lines": "204-230",
          "snippet": "extern __printf(2, 3)\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...);\n\n/**\n * gfs2_glock_nq_init - initialize a holder and enqueue it on a glock\n * @gl: the glock\n * @state: the state we're requesting\n * @flags: the modifier flags\n * @gh: the holder structure\n *\n * Returns: 0, GLR_*, or errno\n */\n\nstatic inline int gfs2_glock_nq_init(struct gfs2_glock *gl,\n\t\t\t\t     unsigned int state, int flags,\n\t\t\t\t     struct gfs2_holder *gh)\n{\n\tint error;\n\n\tgfs2_holder_init(gl, state, flags, gh);\n\n\terror = gfs2_glock_nq(gh);\n\tif (error)\n\t\tgfs2_holder_uninit(gh);\n\n\treturn error;\n}",
          "includes": [
            "#include \"incore.h\"",
            "#include <linux/parser.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"incore.h\"\n#include <linux/parser.h>\n#include <linux/sched.h>\n\nextern __printf(2, 3)\nvoid gfs2_print_dbg(struct seq_file *seq, const char *fmt, ...);\n\n/**\n * gfs2_glock_nq_init - initialize a holder and enqueue it on a glock\n * @gl: the glock\n * @state: the state we're requesting\n * @flags: the modifier flags\n * @gh: the holder structure\n *\n * Returns: 0, GLR_*, or errno\n */\n\nstatic inline int gfs2_glock_nq_init(struct gfs2_glock *gl,\n\t\t\t\t     unsigned int state, int flags,\n\t\t\t\t     struct gfs2_holder *gh)\n{\n\tint error;\n\n\tgfs2_holder_init(gl, state, flags, gh);\n\n\terror = gfs2_glock_nq(gh);\n\tif (error)\n\t\tgfs2_holder_uninit(gh);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "inode"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "dir->i_mode"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic int gfs2_get_name(struct dentry *parent, char *name,\n\t\t\t struct dentry *child)\n{\n\tstruct inode *dir = parent->d_inode;\n\tstruct inode *inode = child->d_inode;\n\tstruct gfs2_inode *dip, *ip;\n\tstruct get_name_filldir gnfd = {\n\t\t.ctx.actor = get_name_filldir,\n\t\t.name = name\n\t};\n\tstruct gfs2_holder gh;\n\tint error;\n\tstruct file_ra_state f_ra = { .start = 0 };\n\n\tif (!dir)\n\t\treturn -EINVAL;\n\n\tif (!S_ISDIR(dir->i_mode) || !inode)\n\t\treturn -EINVAL;\n\n\tdip = GFS2_I(dir);\n\tip = GFS2_I(inode);\n\n\t*name = 0;\n\tgnfd.inum.no_addr = ip->i_no_addr;\n\tgnfd.inum.no_formal_ino = ip->i_no_formal_ino;\n\n\terror = gfs2_glock_nq_init(dip->i_gl, LM_ST_SHARED, 0, &gh);\n\tif (error)\n\t\treturn error;\n\n\terror = gfs2_dir_read(dir, &gnfd.ctx, &f_ra);\n\n\tgfs2_glock_dq_uninit(&gh);\n\n\tif (!error && !*name)\n\t\terror = -ENOENT;\n\n\treturn error;\n}"
  },
  {
    "function_name": "get_name_filldir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "72-86",
    "snippet": "static int get_name_filldir(struct dir_context *ctx, const char *name,\n\t\t\t    int length, loff_t offset, u64 inum,\n\t\t\t    unsigned int type)\n{\n\tstruct get_name_filldir *gnfd =\n\t\tcontainer_of(ctx, struct get_name_filldir, ctx);\n\n\tif (inum != gnfd->inum.no_addr)\n\t\treturn 0;\n\n\tmemcpy(gnfd->name, name, length);\n\tgnfd->name[length] = 0;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "gnfd->name",
            "name",
            "length"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ctx",
            "structget_name_filldir",
            "ctx"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\nstatic int get_name_filldir(struct dir_context *ctx, const char *name,\n\t\t\t    int length, loff_t offset, u64 inum,\n\t\t\t    unsigned int type)\n{\n\tstruct get_name_filldir *gnfd =\n\t\tcontainer_of(ctx, struct get_name_filldir, ctx);\n\n\tif (inum != gnfd->inum.no_addr)\n\t\treturn 0;\n\n\tmemcpy(gnfd->name, name, length);\n\tgnfd->name[length] = 0;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "gfs2_encode_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/export.c",
    "lines": "31-64",
    "snippet": "static int gfs2_encode_fh(struct inode *inode, __u32 *p, int *len,\n\t\t\t  struct inode *parent)\n{\n\t__be32 *fh = (__force __be32 *)p;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct gfs2_inode *ip = GFS2_I(inode);\n\n\tif (parent && (*len < GFS2_LARGE_FH_SIZE)) {\n\t\t*len = GFS2_LARGE_FH_SIZE;\n\t\treturn FILEID_INVALID;\n\t} else if (*len < GFS2_SMALL_FH_SIZE) {\n\t\t*len = GFS2_SMALL_FH_SIZE;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tfh[0] = cpu_to_be32(ip->i_no_formal_ino >> 32);\n\tfh[1] = cpu_to_be32(ip->i_no_formal_ino & 0xFFFFFFFF);\n\tfh[2] = cpu_to_be32(ip->i_no_addr >> 32);\n\tfh[3] = cpu_to_be32(ip->i_no_addr & 0xFFFFFFFF);\n\t*len = GFS2_SMALL_FH_SIZE;\n\n\tif (!parent || inode == sb->s_root->d_inode)\n\t\treturn *len;\n\n\tip = GFS2_I(parent);\n\n\tfh[4] = cpu_to_be32(ip->i_no_formal_ino >> 32);\n\tfh[5] = cpu_to_be32(ip->i_no_formal_ino & 0xFFFFFFFF);\n\tfh[6] = cpu_to_be32(ip->i_no_addr >> 32);\n\tfh[7] = cpu_to_be32(ip->i_no_addr & 0xFFFFFFFF);\n\t*len = GFS2_LARGE_FH_SIZE;\n\n\treturn *len;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"rgrp.h\"",
      "#include \"super.h\"",
      "#include \"inode.h\"",
      "#include \"glops.h\"",
      "#include \"glock.h\"",
      "#include \"dir.h\"",
      "#include \"incore.h\"",
      "#include \"gfs2.h\"",
      "#include <linux/crc32.h>",
      "#include <linux/gfs2_ondisk.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [
      "#define GFS2_LARGE_FH_SIZE 8",
      "#define GFS2_SMALL_FH_SIZE 4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_addr & 0xFFFFFFFF"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_addr >> 32"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_formal_ino & 0xFFFFFFFF"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_formal_ino >> 32"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GFS2_I",
          "args": [
            "parent"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "GFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/incore.h",
          "lines": "408-411",
          "snippet": "static inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}",
          "includes": [
            "#include <linux/lockref.h>",
            "#include <linux/percpu.h>",
            "#include <linux/ktime.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/completion.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/dlm.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockref.h>\n#include <linux/percpu.h>\n#include <linux/ktime.h>\n#include <linux/rbtree.h>\n#include <linux/completion.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/buffer_head.h>\n#include <linux/dlm.h>\n#include <linux/workqueue.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n\nstatic inline struct gfs2_inode *GFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct gfs2_inode, i_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_addr & 0xFFFFFFFF"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_addr >> 32"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_formal_ino & 0xFFFFFFFF"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "ip->i_no_formal_ino >> 32"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"rgrp.h\"\n#include \"super.h\"\n#include \"inode.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"dir.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/crc32.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n\n#define GFS2_LARGE_FH_SIZE 8\n#define GFS2_SMALL_FH_SIZE 4\n\nstatic int gfs2_encode_fh(struct inode *inode, __u32 *p, int *len,\n\t\t\t  struct inode *parent)\n{\n\t__be32 *fh = (__force __be32 *)p;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct gfs2_inode *ip = GFS2_I(inode);\n\n\tif (parent && (*len < GFS2_LARGE_FH_SIZE)) {\n\t\t*len = GFS2_LARGE_FH_SIZE;\n\t\treturn FILEID_INVALID;\n\t} else if (*len < GFS2_SMALL_FH_SIZE) {\n\t\t*len = GFS2_SMALL_FH_SIZE;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tfh[0] = cpu_to_be32(ip->i_no_formal_ino >> 32);\n\tfh[1] = cpu_to_be32(ip->i_no_formal_ino & 0xFFFFFFFF);\n\tfh[2] = cpu_to_be32(ip->i_no_addr >> 32);\n\tfh[3] = cpu_to_be32(ip->i_no_addr & 0xFFFFFFFF);\n\t*len = GFS2_SMALL_FH_SIZE;\n\n\tif (!parent || inode == sb->s_root->d_inode)\n\t\treturn *len;\n\n\tip = GFS2_I(parent);\n\n\tfh[4] = cpu_to_be32(ip->i_no_formal_ino >> 32);\n\tfh[5] = cpu_to_be32(ip->i_no_formal_ino & 0xFFFFFFFF);\n\tfh[6] = cpu_to_be32(ip->i_no_addr >> 32);\n\tfh[7] = cpu_to_be32(ip->i_no_addr & 0xFFFFFFFF);\n\t*len = GFS2_LARGE_FH_SIZE;\n\n\treturn *len;\n}"
  }
]