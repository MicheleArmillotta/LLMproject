[
  {
    "function_name": "exit_dlm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/main.c",
    "lines": "74-84",
    "snippet": "static void __exit exit_dlm(void)\n{\n\tdlm_plock_exit();\n\tdlm_netlink_exit();\n\tdlm_user_exit();\n\tdlm_config_exit();\n\tdlm_memory_exit();\n\tdlm_lockspace_exit();\n\tdlm_lowcomms_exit();\n\tdlm_unregister_debugfs();\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include \"memory.h\"",
      "#include \"user.h\"",
      "#include \"lock.h\"",
      "#include \"lockspace.h\"",
      "#include \"dlm_internal.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_unregister_debugfs",
          "args": [],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_unregister_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/debug_fs.c",
          "lines": "787-790",
          "snippet": "void dlm_unregister_debugfs(void)\n{\n\tdebugfs_remove(dlm_root);\n}",
          "includes": [
            "#include \"lock.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *dlm_root;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lock.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n#include <linux/pagemap.h>\n\nstatic struct dentry *dlm_root;\n\nvoid dlm_unregister_debugfs(void)\n{\n\tdebugfs_remove(dlm_root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lowcomms_exit",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lowcomms_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lowcomms.c",
          "lines": "1818-1830",
          "snippet": "void dlm_lowcomms_exit(void)\n{\n\tstruct dlm_node_addr *na, *safe;\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tlist_for_each_entry_safe(na, safe, &dlm_node_addrs, list) {\n\t\tlist_del(&na->list);\n\t\twhile (na->addr_count--)\n\t\t\tkfree(na->addr[na->addr_count]);\n\t\tkfree(na);\n\t}\n\tspin_unlock(&dlm_node_addrs_spin);\n}",
          "includes": [
            "#include \"config.h\"",
            "#include \"midcomms.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dlm_internal.h\"",
            "#include <net/ipv6.h>",
            "#include <net/sctp/sctp.h>",
            "#include <linux/slab.h>",
            "#include <linux/sctp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <net/tcp.h>",
            "#include <net/sock.h>",
            "#include <asm/ioctls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(dlm_node_addrs);",
            "static DEFINE_SPINLOCK(dlm_node_addrs_spin);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include \"midcomms.h\"\n#include \"lowcomms.h\"\n#include \"dlm_internal.h\"\n#include <net/ipv6.h>\n#include <net/sctp/sctp.h>\n#include <linux/slab.h>\n#include <linux/sctp.h>\n#include <linux/mutex.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <net/tcp.h>\n#include <net/sock.h>\n#include <asm/ioctls.h>\n\nstatic LIST_HEAD(dlm_node_addrs);\nstatic DEFINE_SPINLOCK(dlm_node_addrs_spin);\n\nvoid dlm_lowcomms_exit(void)\n{\n\tstruct dlm_node_addr *na, *safe;\n\n\tspin_lock(&dlm_node_addrs_spin);\n\tlist_for_each_entry_safe(na, safe, &dlm_node_addrs, list) {\n\t\tlist_del(&na->list);\n\t\twhile (na->addr_count--)\n\t\t\tkfree(na->addr[na->addr_count]);\n\t\tkfree(na);\n\t}\n\tspin_unlock(&dlm_node_addrs_spin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockspace_exit",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockspace_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lockspace.c",
          "lines": "255-258",
          "snippet": "void dlm_lockspace_exit(void)\n{\n\tkset_unregister(dlm_kset);\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"requestqueue.h\"",
            "#include \"recover.h\"",
            "#include \"lock.h\"",
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dir.h\"",
            "#include \"recoverd.h\"",
            "#include \"member.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kset *dlm_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"requestqueue.h\"\n#include \"recover.h\"\n#include \"lock.h\"\n#include \"memory.h\"\n#include \"config.h\"\n#include \"lowcomms.h\"\n#include \"dir.h\"\n#include \"recoverd.h\"\n#include \"member.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic struct kset *dlm_kset;\n\nvoid dlm_lockspace_exit(void)\n{\n\tkset_unregister(dlm_kset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_memory_exit",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_memory_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/memory.c",
          "lines": "39-45",
          "snippet": "void dlm_memory_exit(void)\n{\n\tif (lkb_cache)\n\t\tkmem_cache_destroy(lkb_cache);\n\tif (rsb_cache)\n\t\tkmem_cache_destroy(rsb_cache);\n}",
          "includes": [
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *lkb_cache;",
            "static struct kmem_cache *rsb_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"memory.h\"\n#include \"config.h\"\n#include \"dlm_internal.h\"\n\nstatic struct kmem_cache *lkb_cache;\nstatic struct kmem_cache *rsb_cache;\n\nvoid dlm_memory_exit(void)\n{\n\tif (lkb_cache)\n\t\tkmem_cache_destroy(lkb_cache);\n\tif (rsb_cache)\n\t\tkmem_cache_destroy(rsb_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_config_exit",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_config_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "681-684",
          "snippet": "void dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nvoid dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_user_exit",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_user_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/user.c",
          "lines": "1010-1014",
          "snippet": "void dlm_user_exit(void)\n{\n\tmisc_deregister(&ctl_device);\n\tmisc_deregister(&monitor_device);\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"lvb_table.h\"",
            "#include \"lock.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/dlm_device.h>",
            "#include <linux/dlm.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/signal.h>",
            "#include <linux/poll.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/init.h>",
            "#include <linux/miscdevice.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"lvb_table.h\"\n#include \"lock.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/dlm_device.h>\n#include <linux/dlm.h>\n#include <linux/spinlock.h>\n#include <linux/signal.h>\n#include <linux/poll.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/init.h>\n#include <linux/miscdevice.h>\n\nvoid dlm_user_exit(void)\n{\n\tmisc_deregister(&ctl_device);\n\tmisc_deregister(&monitor_device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_netlink_exit",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_netlink_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "84-87",
          "snippet": "void dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\n\nvoid dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_plock_exit",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_plock_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/plock.c",
          "lines": "510-514",
          "snippet": "void dlm_plock_exit(void)\n{\n\tif (misc_deregister(&plock_dev_misc) < 0)\n\t\tlog_print(\"dlm_plock_exit: misc_deregister failed\");\n}",
          "includes": [
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/dlm_plock.h>",
            "#include <linux/dlm.h>",
            "#include <linux/poll.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct miscdevice plock_dev_misc = {\n\t.minor = MISC_DYNAMIC_MINOR,\n\t.name = DLM_PLOCK_MISC_NAME,\n\t.fops = &dev_fops\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/dlm_plock.h>\n#include <linux/dlm.h>\n#include <linux/poll.h>\n#include <linux/miscdevice.h>\n#include <linux/fs.h>\n\nstatic struct miscdevice plock_dev_misc = {\n\t.minor = MISC_DYNAMIC_MINOR,\n\t.name = DLM_PLOCK_MISC_NAME,\n\t.fops = &dev_fops\n};\n\nvoid dlm_plock_exit(void)\n{\n\tif (misc_deregister(&plock_dev_misc) < 0)\n\t\tlog_print(\"dlm_plock_exit: misc_deregister failed\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include \"memory.h\"\n#include \"user.h\"\n#include \"lock.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic void __exit exit_dlm(void)\n{\n\tdlm_plock_exit();\n\tdlm_netlink_exit();\n\tdlm_user_exit();\n\tdlm_config_exit();\n\tdlm_memory_exit();\n\tdlm_lockspace_exit();\n\tdlm_lowcomms_exit();\n\tdlm_unregister_debugfs();\n}"
  },
  {
    "function_name": "init_dlm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/main.c",
    "lines": "22-72",
    "snippet": "static int __init init_dlm(void)\n{\n\tint error;\n\n\terror = dlm_memory_init();\n\tif (error)\n\t\tgoto out;\n\n\terror = dlm_lockspace_init();\n\tif (error)\n\t\tgoto out_mem;\n\n\terror = dlm_config_init();\n\tif (error)\n\t\tgoto out_lockspace;\n\n\terror = dlm_register_debugfs();\n\tif (error)\n\t\tgoto out_config;\n\n\terror = dlm_user_init();\n\tif (error)\n\t\tgoto out_debug;\n\n\terror = dlm_netlink_init();\n\tif (error)\n\t\tgoto out_user;\n\n\terror = dlm_plock_init();\n\tif (error)\n\t\tgoto out_netlink;\n\n\tprintk(\"DLM installed\\n\");\n\n\treturn 0;\n\n out_netlink:\n\tdlm_netlink_exit();\n out_user:\n\tdlm_user_exit();\n out_debug:\n\tdlm_unregister_debugfs();\n out_config:\n\tdlm_config_exit();\n out_lockspace:\n\tdlm_lockspace_exit();\n out_mem:\n\tdlm_memory_exit();\n out:\n\treturn error;\n}",
    "includes": [
      "#include \"lowcomms.h\"",
      "#include \"config.h\"",
      "#include \"memory.h\"",
      "#include \"user.h\"",
      "#include \"lock.h\"",
      "#include \"lockspace.h\"",
      "#include \"dlm_internal.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlm_memory_exit",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_memory_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/memory.c",
          "lines": "39-45",
          "snippet": "void dlm_memory_exit(void)\n{\n\tif (lkb_cache)\n\t\tkmem_cache_destroy(lkb_cache);\n\tif (rsb_cache)\n\t\tkmem_cache_destroy(rsb_cache);\n}",
          "includes": [
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *lkb_cache;",
            "static struct kmem_cache *rsb_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"memory.h\"\n#include \"config.h\"\n#include \"dlm_internal.h\"\n\nstatic struct kmem_cache *lkb_cache;\nstatic struct kmem_cache *rsb_cache;\n\nvoid dlm_memory_exit(void)\n{\n\tif (lkb_cache)\n\t\tkmem_cache_destroy(lkb_cache);\n\tif (rsb_cache)\n\t\tkmem_cache_destroy(rsb_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockspace_exit",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockspace_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lockspace.c",
          "lines": "255-258",
          "snippet": "void dlm_lockspace_exit(void)\n{\n\tkset_unregister(dlm_kset);\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"requestqueue.h\"",
            "#include \"recover.h\"",
            "#include \"lock.h\"",
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dir.h\"",
            "#include \"recoverd.h\"",
            "#include \"member.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kset *dlm_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"requestqueue.h\"\n#include \"recover.h\"\n#include \"lock.h\"\n#include \"memory.h\"\n#include \"config.h\"\n#include \"lowcomms.h\"\n#include \"dir.h\"\n#include \"recoverd.h\"\n#include \"member.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic struct kset *dlm_kset;\n\nvoid dlm_lockspace_exit(void)\n{\n\tkset_unregister(dlm_kset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_config_exit",
          "args": [],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_config_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "681-684",
          "snippet": "void dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nvoid dlm_config_exit(void)\n{\n\tconfigfs_unregister_subsystem(&clusters_root.subsys);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_unregister_debugfs",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_unregister_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/debug_fs.c",
          "lines": "787-790",
          "snippet": "void dlm_unregister_debugfs(void)\n{\n\tdebugfs_remove(dlm_root);\n}",
          "includes": [
            "#include \"lock.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *dlm_root;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lock.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n#include <linux/pagemap.h>\n\nstatic struct dentry *dlm_root;\n\nvoid dlm_unregister_debugfs(void)\n{\n\tdebugfs_remove(dlm_root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_user_exit",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_user_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/user.c",
          "lines": "1010-1014",
          "snippet": "void dlm_user_exit(void)\n{\n\tmisc_deregister(&ctl_device);\n\tmisc_deregister(&monitor_device);\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"lvb_table.h\"",
            "#include \"lock.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/dlm_device.h>",
            "#include <linux/dlm.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/signal.h>",
            "#include <linux/poll.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/init.h>",
            "#include <linux/miscdevice.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"lvb_table.h\"\n#include \"lock.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/dlm_device.h>\n#include <linux/dlm.h>\n#include <linux/spinlock.h>\n#include <linux/signal.h>\n#include <linux/poll.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/init.h>\n#include <linux/miscdevice.h>\n\nvoid dlm_user_exit(void)\n{\n\tmisc_deregister(&ctl_device);\n\tmisc_deregister(&monitor_device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_netlink_exit",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_netlink_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "84-87",
          "snippet": "void dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\n\nvoid dlm_netlink_exit(void)\n{\n\tgenl_unregister_family(&family);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"DLM installed\\n\""
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "__ecryptfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/main.c",
          "lines": "86-96",
          "snippet": "void __ecryptfs_printk(const char *fmt, ...)\n{\n\tva_list args;\n\tva_start(args, fmt);\n\tif (fmt[1] == '7') { /* KERN_DEBUG */\n\t\tif (ecryptfs_verbosity >= 1)\n\t\t\tvprintk(fmt, args);\n\t} else\n\t\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"ecryptfs_kernel.h\"",
            "#include <linux/magic.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/parser.h>",
            "#include <linux/key.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/crypto.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/file.h>",
            "#include <linux/dcache.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int ecryptfs_verbosity = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/slab.h>\n#include <linux/fs_stack.h>\n#include <linux/parser.h>\n#include <linux/key.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/crypto.h>\n#include <linux/skbuff.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/file.h>\n#include <linux/dcache.h>\n\nint ecryptfs_verbosity = 0;\n\nvoid __ecryptfs_printk(const char *fmt, ...)\n{\n\tva_list args;\n\tva_start(args, fmt);\n\tif (fmt[1] == '7') { /* KERN_DEBUG */\n\t\tif (ecryptfs_verbosity >= 1)\n\t\t\tvprintk(fmt, args);\n\t} else\n\t\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_plock_init",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_plock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/plock.c",
          "lines": "494-508",
          "snippet": "int dlm_plock_init(void)\n{\n\tint rv;\n\n\tspin_lock_init(&ops_lock);\n\tINIT_LIST_HEAD(&send_list);\n\tINIT_LIST_HEAD(&recv_list);\n\tinit_waitqueue_head(&send_wq);\n\tinit_waitqueue_head(&recv_wq);\n\n\trv = misc_register(&plock_dev_misc);\n\tif (rv)\n\t\tlog_print(\"dlm_plock_init: misc_register failed %d\", rv);\n\treturn rv;\n}",
          "includes": [
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/dlm_plock.h>",
            "#include <linux/dlm.h>",
            "#include <linux/poll.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static spinlock_t ops_lock;",
            "static struct list_head send_list;",
            "static struct list_head recv_list;",
            "static wait_queue_head_t send_wq;",
            "static wait_queue_head_t recv_wq;",
            "static struct miscdevice plock_dev_misc = {\n\t.minor = MISC_DYNAMIC_MINOR,\n\t.name = DLM_PLOCK_MISC_NAME,\n\t.fops = &dev_fops\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/dlm_plock.h>\n#include <linux/dlm.h>\n#include <linux/poll.h>\n#include <linux/miscdevice.h>\n#include <linux/fs.h>\n\nstatic spinlock_t ops_lock;\nstatic struct list_head send_list;\nstatic struct list_head recv_list;\nstatic wait_queue_head_t send_wq;\nstatic wait_queue_head_t recv_wq;\nstatic struct miscdevice plock_dev_misc = {\n\t.minor = MISC_DYNAMIC_MINOR,\n\t.name = DLM_PLOCK_MISC_NAME,\n\t.fops = &dev_fops\n};\n\nint dlm_plock_init(void)\n{\n\tint rv;\n\n\tspin_lock_init(&ops_lock);\n\tINIT_LIST_HEAD(&send_list);\n\tINIT_LIST_HEAD(&recv_list);\n\tinit_waitqueue_head(&send_wq);\n\tinit_waitqueue_head(&recv_wq);\n\n\trv = misc_register(&plock_dev_misc);\n\tif (rv)\n\t\tlog_print(\"dlm_plock_init: misc_register failed %d\", rv);\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_netlink_init",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_netlink_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/netlink.c",
          "lines": "79-82",
          "snippet": "int __init dlm_netlink_init(void)\n{\n\treturn genl_register_family_with_ops(&family, dlm_nl_ops);\n}",
          "includes": [
            "#include \"dlm_internal.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/dlm_netlink.h>",
            "#include <linux/dlm.h>",
            "#include <net/genetlink.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};",
            "static struct genl_ops dlm_nl_ops[] = {\n\t{\n\t\t.cmd\t= DLM_CMD_HELLO,\n\t\t.doit\t= user_cmd,\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dlm_internal.h\"\n#include <linux/gfp.h>\n#include <linux/dlm_netlink.h>\n#include <linux/dlm.h>\n#include <net/genetlink.h>\n\nstatic struct genl_family family = {\n\t.id\t\t= GENL_ID_GENERATE,\n\t.name\t\t= DLM_GENL_NAME,\n\t.version\t= DLM_GENL_VERSION,\n};\nstatic struct genl_ops dlm_nl_ops[] = {\n\t{\n\t\t.cmd\t= DLM_CMD_HELLO,\n\t\t.doit\t= user_cmd,\n\t},\n};\n\nint __init dlm_netlink_init(void)\n{\n\treturn genl_register_family_with_ops(&family, dlm_nl_ops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_user_init",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_user_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/user.c",
          "lines": "989-1008",
          "snippet": "int __init dlm_user_init(void)\n{\n\tint error;\n\n\tatomic_set(&dlm_monitor_opened, 0);\n\n\terror = misc_register(&ctl_device);\n\tif (error) {\n\t\tlog_print(\"misc_register failed for control device\");\n\t\tgoto out;\n\t}\n\n\terror = misc_register(&monitor_device);\n\tif (error) {\n\t\tlog_print(\"misc_register failed for monitor device\");\n\t\tmisc_deregister(&ctl_device);\n\t}\n out:\n\treturn error;\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"lvb_table.h\"",
            "#include \"lock.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/dlm_device.h>",
            "#include <linux/dlm.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/signal.h>",
            "#include <linux/poll.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/module.h>",
            "#include <linux/wait.h>",
            "#include <linux/init.h>",
            "#include <linux/miscdevice.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t dlm_monitor_opened;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"lvb_table.h\"\n#include \"lock.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/dlm_device.h>\n#include <linux/dlm.h>\n#include <linux/spinlock.h>\n#include <linux/signal.h>\n#include <linux/poll.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/module.h>\n#include <linux/wait.h>\n#include <linux/init.h>\n#include <linux/miscdevice.h>\n\nstatic atomic_t dlm_monitor_opened;\n\nint __init dlm_user_init(void)\n{\n\tint error;\n\n\tatomic_set(&dlm_monitor_opened, 0);\n\n\terror = misc_register(&ctl_device);\n\tif (error) {\n\t\tlog_print(\"misc_register failed for control device\");\n\t\tgoto out;\n\t}\n\n\terror = misc_register(&monitor_device);\n\tif (error) {\n\t\tlog_print(\"misc_register failed for monitor device\");\n\t\tmisc_deregister(&ctl_device);\n\t}\n out:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_register_debugfs",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_register_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/debug_fs.c",
          "lines": "780-785",
          "snippet": "int __init dlm_register_debugfs(void)\n{\n\tmutex_init(&debug_buf_lock);\n\tdlm_root = debugfs_create_dir(\"dlm\", NULL);\n\treturn dlm_root ? 0 : -ENOMEM;\n}",
          "includes": [
            "#include \"lock.h\"",
            "#include \"dlm_internal.h\"",
            "#include <linux/slab.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct mutex debug_buf_lock;",
            "static struct dentry *dlm_root;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lock.h\"\n#include \"dlm_internal.h\"\n#include <linux/slab.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/seq_file.h>\n#include <linux/pagemap.h>\n\nstatic struct mutex debug_buf_lock;\nstatic struct dentry *dlm_root;\n\nint __init dlm_register_debugfs(void)\n{\n\tmutex_init(&debug_buf_lock);\n\tdlm_root = debugfs_create_dir(\"dlm\", NULL);\n\treturn dlm_root ? 0 : -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_config_init",
          "args": [],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_config_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/config.c",
          "lines": "674-679",
          "snippet": "int __init dlm_config_init(void)\n{\n\tconfig_group_init(&clusters_root.subsys.su_group);\n\tmutex_init(&clusters_root.subsys.su_mutex);\n\treturn configfs_register_subsystem(&clusters_root.subsys);\n}",
          "includes": [
            "#include \"lowcomms.h\"",
            "#include \"config.h\"",
            "#include <net/sock.h>",
            "#include <net/ipv6.h>",
            "#include <linux/dlmconstants.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/slab.h>",
            "#include <linux/configfs.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include <net/sock.h>\n#include <net/ipv6.h>\n#include <linux/dlmconstants.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/slab.h>\n#include <linux/configfs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct dlm_clusters clusters_root = {\n\t.subsys = {\n\t\t.su_group = {\n\t\t\t.cg_item = {\n\t\t\t\t.ci_namebuf = \"dlm\",\n\t\t\t\t.ci_type = &clusters_type,\n\t\t\t},\n\t\t},\n\t},\n};\n\nint __init dlm_config_init(void)\n{\n\tconfig_group_init(&clusters_root.subsys.su_group);\n\tmutex_init(&clusters_root.subsys.su_mutex);\n\treturn configfs_register_subsystem(&clusters_root.subsys);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_lockspace_init",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_lockspace_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/lockspace.c",
          "lines": "240-253",
          "snippet": "int __init dlm_lockspace_init(void)\n{\n\tls_count = 0;\n\tmutex_init(&ls_lock);\n\tINIT_LIST_HEAD(&lslist);\n\tspin_lock_init(&lslist_lock);\n\n\tdlm_kset = kset_create_and_add(\"dlm\", &dlm_uevent_ops, kernel_kobj);\n\tif (!dlm_kset) {\n\t\tprintk(KERN_WARNING \"%s: can not create kset\\n\", __func__);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"ast.h\"",
            "#include \"user.h\"",
            "#include \"requestqueue.h\"",
            "#include \"recover.h\"",
            "#include \"lock.h\"",
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"lowcomms.h\"",
            "#include \"dir.h\"",
            "#include \"recoverd.h\"",
            "#include \"member.h\"",
            "#include \"lockspace.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t\t\tls_count;",
            "static struct mutex\t\tls_lock;",
            "static struct list_head\t\tlslist;",
            "static spinlock_t\t\tlslist_lock;",
            "static struct kset *dlm_kset;",
            "static struct kset_uevent_ops dlm_uevent_ops = {\n\t.uevent = dlm_uevent,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ast.h\"\n#include \"user.h\"\n#include \"requestqueue.h\"\n#include \"recover.h\"\n#include \"lock.h\"\n#include \"memory.h\"\n#include \"config.h\"\n#include \"lowcomms.h\"\n#include \"dir.h\"\n#include \"recoverd.h\"\n#include \"member.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic int\t\t\tls_count;\nstatic struct mutex\t\tls_lock;\nstatic struct list_head\t\tlslist;\nstatic spinlock_t\t\tlslist_lock;\nstatic struct kset *dlm_kset;\nstatic struct kset_uevent_ops dlm_uevent_ops = {\n\t.uevent = dlm_uevent,\n};\n\nint __init dlm_lockspace_init(void)\n{\n\tls_count = 0;\n\tmutex_init(&ls_lock);\n\tINIT_LIST_HEAD(&lslist);\n\tspin_lock_init(&lslist_lock);\n\n\tdlm_kset = kset_create_and_add(\"dlm\", &dlm_uevent_ops, kernel_kobj);\n\tif (!dlm_kset) {\n\t\tprintk(KERN_WARNING \"%s: can not create kset\\n\", __func__);\n\t\treturn -ENOMEM;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dlm_memory_init",
          "args": [],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_memory_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dlm/memory.c",
          "lines": "22-37",
          "snippet": "int __init dlm_memory_init(void)\n{\n\tlkb_cache = kmem_cache_create(\"dlm_lkb\", sizeof(struct dlm_lkb),\n\t\t\t\t__alignof__(struct dlm_lkb), 0, NULL);\n\tif (!lkb_cache)\n\t\treturn -ENOMEM;\n\n\trsb_cache = kmem_cache_create(\"dlm_rsb\", sizeof(struct dlm_rsb),\n\t\t\t\t__alignof__(struct dlm_rsb), 0, NULL);\n\tif (!rsb_cache) {\n\t\tkmem_cache_destroy(lkb_cache);\n\t\treturn -ENOMEM;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"memory.h\"",
            "#include \"config.h\"",
            "#include \"dlm_internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *lkb_cache;",
            "static struct kmem_cache *rsb_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"memory.h\"\n#include \"config.h\"\n#include \"dlm_internal.h\"\n\nstatic struct kmem_cache *lkb_cache;\nstatic struct kmem_cache *rsb_cache;\n\nint __init dlm_memory_init(void)\n{\n\tlkb_cache = kmem_cache_create(\"dlm_lkb\", sizeof(struct dlm_lkb),\n\t\t\t\t__alignof__(struct dlm_lkb), 0, NULL);\n\tif (!lkb_cache)\n\t\treturn -ENOMEM;\n\n\trsb_cache = kmem_cache_create(\"dlm_rsb\", sizeof(struct dlm_rsb),\n\t\t\t\t__alignof__(struct dlm_rsb), 0, NULL);\n\tif (!rsb_cache) {\n\t\tkmem_cache_destroy(lkb_cache);\n\t\treturn -ENOMEM;\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lowcomms.h\"\n#include \"config.h\"\n#include \"memory.h\"\n#include \"user.h\"\n#include \"lock.h\"\n#include \"lockspace.h\"\n#include \"dlm_internal.h\"\n\nstatic int __init init_dlm(void)\n{\n\tint error;\n\n\terror = dlm_memory_init();\n\tif (error)\n\t\tgoto out;\n\n\terror = dlm_lockspace_init();\n\tif (error)\n\t\tgoto out_mem;\n\n\terror = dlm_config_init();\n\tif (error)\n\t\tgoto out_lockspace;\n\n\terror = dlm_register_debugfs();\n\tif (error)\n\t\tgoto out_config;\n\n\terror = dlm_user_init();\n\tif (error)\n\t\tgoto out_debug;\n\n\terror = dlm_netlink_init();\n\tif (error)\n\t\tgoto out_user;\n\n\terror = dlm_plock_init();\n\tif (error)\n\t\tgoto out_netlink;\n\n\tprintk(\"DLM installed\\n\");\n\n\treturn 0;\n\n out_netlink:\n\tdlm_netlink_exit();\n out_user:\n\tdlm_user_exit();\n out_debug:\n\tdlm_unregister_debugfs();\n out_config:\n\tdlm_config_exit();\n out_lockspace:\n\tdlm_lockspace_exit();\n out_mem:\n\tdlm_memory_exit();\n out:\n\treturn error;\n}"
  }
]