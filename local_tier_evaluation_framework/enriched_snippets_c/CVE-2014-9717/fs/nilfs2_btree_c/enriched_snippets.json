[
  {
    "function_name": "nilfs_btree_init_gc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2346-2351",
    "snippet": "void nilfs_btree_init_gc(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops_gc;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __nilfs_btree_init(struct nilfs_bmap *bmap);",
      "static const struct nilfs_bmap_operations nilfs_btree_ops_gc = {\n\t.bop_lookup\t\t=\tNULL,\n\t.bop_lookup_contig\t=\tNULL,\n\t.bop_insert\t\t=\tNULL,\n\t.bop_delete\t\t=\tNULL,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate_gc,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign_gc,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tNULL,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_BTREE_NODE_NCHILDREN_MAX",
          "args": [
            "nilfs_btree_node_size(bmap)"
          ],
          "line": 2350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_size",
          "args": [
            "bmap"
          ],
          "line": 2350
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "124-127",
          "snippet": "static int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap);\nstatic const struct nilfs_bmap_operations nilfs_btree_ops_gc = {\n\t.bop_lookup\t\t=\tNULL,\n\t.bop_lookup_contig\t=\tNULL,\n\t.bop_insert\t\t=\tNULL,\n\t.bop_delete\t\t=\tNULL,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate_gc,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign_gc,\n\t.bop_mark\t\t=\tNULL,\n\n\t.bop_last_key\t\t=\tNULL,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tNULL,\n\t.bop_gather_data\t=\tNULL,\n};\n\nvoid nilfs_btree_init_gc(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops_gc;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}"
  },
  {
    "function_name": "nilfs_btree_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2334-2344",
    "snippet": "int nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tint ret = 0;\n\n\t__nilfs_btree_init(bmap);\n\n\tif (nilfs_btree_root_broken(nilfs_btree_get_root(bmap),\n\t\t\t\t    bmap->b_inode->i_ino))\n\t\tret = -EIO;\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __nilfs_btree_init(struct nilfs_bmap *bmap);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_root_broken",
          "args": [
            "nilfs_btree_get_root(bmap)",
            "bmap->b_inode->i_ino"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_root_broken",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "380-399",
          "snippet": "static int nilfs_btree_root_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   unsigned long ino)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level > NILFS_BTREE_LEVEL_MAX ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_ROOT_NCHILDREN_MAX)) {\n\t\tpr_crit(\"NILFS: bad btree root (inode number=%lu): level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t\tino, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_root_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   unsigned long ino)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level > NILFS_BTREE_LEVEL_MAX ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_ROOT_NCHILDREN_MAX)) {\n\t\tpr_crit(\"NILFS: bad btree root (inode number=%lu): level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t\tino, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "bmap"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nilfs_btree_init",
          "args": [
            "bmap"
          ],
          "line": 2338
        },
        "resolved": true,
        "details": {
          "function_name": "__nilfs_btree_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "2327-2332",
          "snippet": "static void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __nilfs_btree_init(struct nilfs_bmap *bmap);",
            "static const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap);\nstatic const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap);\n\nint nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tint ret = 0;\n\n\t__nilfs_btree_init(bmap);\n\n\tif (nilfs_btree_root_broken(nilfs_btree_get_root(bmap),\n\t\t\t\t    bmap->b_inode->i_ino))\n\t\tret = -EIO;\n\treturn ret;\n}"
  },
  {
    "function_name": "__nilfs_btree_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2327-2332",
    "snippet": "static void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __nilfs_btree_init(struct nilfs_bmap *bmap);",
      "static const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "NILFS_BTREE_NODE_NCHILDREN_MAX",
          "args": [
            "nilfs_btree_node_size(bmap)"
          ],
          "line": 2331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_size",
          "args": [
            "bmap"
          ],
          "line": 2331
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "124-127",
          "snippet": "static int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap);\nstatic const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}"
  },
  {
    "function_name": "nilfs_btree_mark",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2254-2285",
    "snippet": "static int nilfs_btree_mark(struct nilfs_bmap *btree, __u64 key, int level)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_path *path;\n\t__u64 ptr;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, &ptr, level + 1, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\n\tif (!buffer_dirty(bh))\n\t\tmark_buffer_dirty(bh);\n\tbrelse(bh);\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 2283
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_set_dirty",
          "args": [
            "btree"
          ],
          "line": 2280
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "258-261",
          "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_dirty",
          "args": [
            "btree"
          ],
          "line": 2279
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "252-255",
          "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 2278
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 2277
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 2272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "&bh"
          ],
          "line": 2270
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "&ptr",
            "level + 1",
            "0"
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 2261
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_mark(struct nilfs_bmap *btree, __u64 key, int level)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_path *path;\n\t__u64 ptr;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, &ptr, level + 1, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\n\tif (!buffer_dirty(bh))\n\t\tmark_buffer_dirty(bh);\n\tbrelse(bh);\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_assign_gc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2227-2252",
    "snippet": "static int nilfs_btree_assign_gc(struct nilfs_bmap *btree,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint ret;\n\n\tret = nilfs_dat_move(nilfs_bmap_get_dat(btree), (*bh)->b_blocknr,\n\t\t\t     blocknr);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(*bh)) {\n\t\tnode = (struct nilfs_btree_node *)(*bh)->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t} else\n\t\tkey = nilfs_bmap_data_get_key(btree, *bh);\n\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64((*bh)->b_blocknr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 2249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "(*bh)->b_blocknr"
          ],
          "line": 2248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_data_get_key",
          "args": [
            "btree",
            "*bh"
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_data_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "429-441",
          "snippet": "__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 2243
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "*bh"
          ],
          "line": 2241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_move",
          "args": [
            "nilfs_bmap_get_dat(btree)",
            "(*bh)->b_blocknr",
            "blocknr"
          ],
          "line": 2236
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_move",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "328-376",
          "snippet": "int nilfs_dat_move(struct inode *dat, __u64 vblocknr, sector_t blocknr)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/*\n\t * The given disk block number (blocknr) is not yet written to\n\t * the device at this point.\n\t *\n\t * To prevent nilfs_dat_translate() from returning the\n\t * uncommitted block number, this makes a copy of the entry\n\t * buffer and redirects nilfs_dat_translate() to the copy.\n\t */\n\tif (!buffer_nilfs_redirected(entry_bh)) {\n\t\tret = nilfs_mdt_freeze_buffer(dat, entry_bh);\n\t\tif (ret) {\n\t\t\tbrelse(entry_bh);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tif (unlikely(entry->de_blocknr == cpu_to_le64(0))) {\n\t\tprintk(KERN_CRIT \"%s: vbn = %llu, [%llu, %llu)\\n\", __func__,\n\t\t       (unsigned long long)vblocknr,\n\t\t       (unsigned long long)le64_to_cpu(entry->de_start),\n\t\t       (unsigned long long)le64_to_cpu(entry->de_end));\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t\treturn -EINVAL;\n\t}\n\tWARN_ON(blocknr == 0);\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tmark_buffer_dirty(entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\n\tbrelse(entry_bh);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_move(struct inode *dat, __u64 vblocknr, sector_t blocknr)\n{\n\tstruct buffer_head *entry_bh;\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t/*\n\t * The given disk block number (blocknr) is not yet written to\n\t * the device at this point.\n\t *\n\t * To prevent nilfs_dat_translate() from returning the\n\t * uncommitted block number, this makes a copy of the entry\n\t * buffer and redirects nilfs_dat_translate() to the copy.\n\t */\n\tif (!buffer_nilfs_redirected(entry_bh)) {\n\t\tret = nilfs_mdt_freeze_buffer(dat, entry_bh);\n\t\tif (ret) {\n\t\t\tbrelse(entry_bh);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tif (unlikely(entry->de_blocknr == cpu_to_le64(0))) {\n\t\tprintk(KERN_CRIT \"%s: vbn = %llu, [%llu, %llu)\\n\", __func__,\n\t\t       (unsigned long long)vblocknr,\n\t\t       (unsigned long long)le64_to_cpu(entry->de_start),\n\t\t       (unsigned long long)le64_to_cpu(entry->de_end));\n\t\tkunmap_atomic(kaddr);\n\t\tbrelse(entry_bh);\n\t\treturn -EINVAL;\n\t}\n\tWARN_ON(blocknr == 0);\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tmark_buffer_dirty(entry_bh);\n\tnilfs_mdt_mark_dirty(dat);\n\n\tbrelse(entry_bh);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 2236
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign_gc(struct nilfs_bmap *btree,\n\t\t\t\t struct buffer_head **bh,\n\t\t\t\t sector_t blocknr,\n\t\t\t\t union nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint ret;\n\n\tret = nilfs_dat_move(nilfs_bmap_get_dat(btree), (*bh)->b_blocknr,\n\t\t\t     blocknr);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(*bh)) {\n\t\tnode = (struct nilfs_btree_node *)(*bh)->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t} else\n\t\tkey = nilfs_bmap_data_get_key(btree, *bh);\n\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64((*bh)->b_blocknr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_assign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2188-2225",
    "snippet": "static int nilfs_btree_assign(struct nilfs_bmap *btree,\n\t\t\t      struct buffer_head **bh,\n\t\t\t      sector_t blocknr,\n\t\t\t      union nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tif (buffer_nilfs_node(*bh)) {\n\t\tnode = (struct nilfs_btree_node *)(*bh)->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t\tlevel = nilfs_btree_node_get_level(node);\n\t} else {\n\t\tkey = nilfs_bmap_data_get_key(btree, *bh);\n\t\tlevel = NILFS_BTREE_LEVEL_DATA;\n\t}\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL, level + 1, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\n\tret = NILFS_BMAP_USE_VBN(btree) ?\n\t\tnilfs_btree_assign_v(btree, path, level, bh, blocknr, binfo) :\n\t\tnilfs_btree_assign_p(btree, path, level, bh, blocknr, binfo);\n\n out:\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_assign_p",
          "args": [
            "btree",
            "path",
            "level",
            "bh",
            "blocknr",
            "binfo"
          ],
          "line": 2219
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_assign_p",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "2116-2155",
          "snippet": "static int nilfs_btree_assign_p(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\t__u64 key;\n\t__u64 ptr;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\tif (buffer_nilfs_node(*bh)) {\n\t\tpath[level].bp_ctxt.oldkey = ptr;\n\t\tpath[level].bp_ctxt.newkey = blocknr;\n\t\tpath[level].bp_ctxt.bh = *bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\t*bh = path[level].bp_ctxt.bh;\n\t}\n\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index, blocknr,\n\t\t\t\t ncmax);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = level;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign_p(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\t__u64 key;\n\t__u64 ptr;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\tif (buffer_nilfs_node(*bh)) {\n\t\tpath[level].bp_ctxt.oldkey = ptr;\n\t\tpath[level].bp_ctxt.newkey = blocknr;\n\t\tpath[level].bp_ctxt.bh = *bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\t*bh = path[level].bp_ctxt.bh;\n\t}\n\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index, blocknr,\n\t\t\t\t ncmax);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = level;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_assign_v",
          "args": [
            "btree",
            "path",
            "level",
            "bh",
            "blocknr",
            "binfo"
          ],
          "line": 2218
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_assign_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "2157-2186",
          "snippet": "static int nilfs_btree_assign_v(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 key;\n\t__u64 ptr;\n\tunion nilfs_bmap_ptr_req req;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign_v(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 key;\n\t__u64 ptr;\n\tunion nilfs_bmap_ptr_req req;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 2217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 2213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "NULL",
            "level + 1",
            "0"
          ],
          "line": 2211
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_data_get_key",
          "args": [
            "btree",
            "*bh"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_data_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "429-441",
          "snippet": "__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 2205
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 2204
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "*bh"
          ],
          "line": 2202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 2198
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign(struct nilfs_bmap *btree,\n\t\t\t      struct buffer_head **bh,\n\t\t\t      sector_t blocknr,\n\t\t\t      union nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tif (buffer_nilfs_node(*bh)) {\n\t\tnode = (struct nilfs_btree_node *)(*bh)->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t\tlevel = nilfs_btree_node_get_level(node);\n\t} else {\n\t\tkey = nilfs_bmap_data_get_key(btree, *bh);\n\t\tlevel = NILFS_BTREE_LEVEL_DATA;\n\t}\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL, level + 1, 0);\n\tif (ret < 0) {\n\t\tWARN_ON(ret == -ENOENT);\n\t\tgoto out;\n\t}\n\n\tret = NILFS_BMAP_USE_VBN(btree) ?\n\t\tnilfs_btree_assign_v(btree, path, level, bh, blocknr, binfo) :\n\t\tnilfs_btree_assign_p(btree, path, level, bh, blocknr, binfo);\n\n out:\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_assign_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2157-2186",
    "snippet": "static int nilfs_btree_assign_v(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 key;\n\t__u64 ptr;\n\tunion nilfs_bmap_ptr_req req;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 2183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptr"
          ],
          "line": 2182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "parent",
            "path[level + 1].bp_index"
          ],
          "line": 2180
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_start",
          "args": [
            "dat",
            "&req.bpr_req",
            "blocknr"
          ],
          "line": 2178
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "139-153",
          "snippet": "void nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_start(struct inode *dat, struct nilfs_palloc_req *req,\n\t\t\t    sector_t blocknr)\n{\n\tstruct nilfs_dat_entry *entry;\n\tvoid *kaddr;\n\n\tkaddr = kmap_atomic(req->pr_entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, req->pr_entry_nr,\n\t\t\t\t\t     req->pr_entry_bh, kaddr);\n\tentry->de_start = cpu_to_le64(nilfs_mdt_cno(dat));\n\tentry->de_blocknr = cpu_to_le64(blocknr);\n\tkunmap_atomic(kaddr);\n\n\tnilfs_dat_commit_entry(dat, req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_start",
          "args": [
            "dat",
            "&req.bpr_req"
          ],
          "line": 2175
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "130-137",
          "snippet": "int nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_start(struct inode *dat, struct nilfs_palloc_req *req)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_entry(dat, req, 0);\n\tWARN_ON(ret == -ENOENT);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "ncmax"
          ],
          "line": 2172
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 2171
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign_v(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 key;\n\t__u64 ptr;\n\tunion nilfs_bmap_ptr_req req;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\treq.bpr_ptr = ptr;\n\tret = nilfs_dat_prepare_start(dat, &req.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_dat_commit_start(dat, &req.bpr_req, blocknr);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_v.bi_vblocknr = cpu_to_le64(ptr);\n\tbinfo->bi_v.bi_blkoff = cpu_to_le64(key);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_assign_p",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2116-2155",
    "snippet": "static int nilfs_btree_assign_p(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\t__u64 key;\n\t__u64 ptr;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\tif (buffer_nilfs_node(*bh)) {\n\t\tpath[level].bp_ctxt.oldkey = ptr;\n\t\tpath[level].bp_ctxt.newkey = blocknr;\n\t\tpath[level].bp_ctxt.bh = *bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\t*bh = path[level].bp_ctxt.bh;\n\t}\n\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index, blocknr,\n\t\t\t\t ncmax);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = level;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 2151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "parent",
            "path[level + 1].bp_index"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "blocknr",
            "ncmax"
          ],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "167-172",
          "snippet": "static void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_commit_change_key",
          "args": [
            "&NILFS_BMAP_I(btree)->i_btnode_cache",
            "&path[level].bp_ctxt"
          ],
          "line": 2140
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_commit_change_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "240-275",
          "snippet": "void nilfs_btnode_commit_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh = ctxt->bh, *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tstruct page *opage;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\topage = obh->b_page;\n\t\tif (unlikely(oldkey != opage->index))\n\t\t\tNILFS_PAGE_BUG(opage,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\t\tmark_buffer_dirty(obh);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, oldkey);\n\t\tradix_tree_tag_set(&btnc->page_tree, newkey,\n\t\t\t\t   PAGECACHE_TAG_DIRTY);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\n\t\topage->index = obh->b_blocknr = newkey;\n\t\tunlock_page(opage);\n\t} else {\n\t\tnilfs_copy_buffer(nbh, obh);\n\t\tmark_buffer_dirty(nbh);\n\n\t\tnbh->b_blocknr = newkey;\n\t\tctxt->bh = nbh;\n\t\tnilfs_btnode_delete(obh); /* will decrement bh->b_count */\n\t}\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_commit_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh = ctxt->bh, *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tstruct page *opage;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\topage = obh->b_page;\n\t\tif (unlikely(oldkey != opage->index))\n\t\t\tNILFS_PAGE_BUG(opage,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\t\tmark_buffer_dirty(obh);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, oldkey);\n\t\tradix_tree_tag_set(&btnc->page_tree, newkey,\n\t\t\t\t   PAGECACHE_TAG_DIRTY);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\n\t\topage->index = obh->b_blocknr = newkey;\n\t\tunlock_page(opage);\n\t} else {\n\t\tnilfs_copy_buffer(nbh, obh);\n\t\tmark_buffer_dirty(nbh);\n\n\t\tnbh->b_blocknr = newkey;\n\t\tctxt->bh = nbh;\n\t\tnilfs_btnode_delete(obh); /* will decrement bh->b_count */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 2141
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_prepare_change_key",
          "args": [
            "&NILFS_BMAP_I(btree)->i_btnode_cache",
            "&path[level].bp_ctxt"
          ],
          "line": 2135
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_prepare_change_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "170-234",
          "snippet": "int nilfs_btnode_prepare_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh, *nbh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tint err;\n\n\tif (oldkey == newkey)\n\t\treturn 0;\n\n\tobh = ctxt->bh;\n\tctxt->newbh = NULL;\n\n\tif (inode->i_blkbits == PAGE_CACHE_SHIFT) {\n\t\tlock_page(obh->b_page);\n\t\t/*\n\t\t * We cannot call radix_tree_preload for the kernels older\n\t\t * than 2.6.23, because it is not exported for modules.\n\t\t */\nretry:\n\t\terr = radix_tree_preload(GFP_NOFS & ~__GFP_HIGHMEM);\n\t\tif (err)\n\t\t\tgoto failed_unlock;\n\t\t/* BUG_ON(oldkey != obh->b_page->index); */\n\t\tif (unlikely(oldkey != obh->b_page->index))\n\t\t\tNILFS_PAGE_BUG(obh->b_page,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\terr = radix_tree_insert(&btnc->page_tree, newkey, obh->b_page);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\t/*\n\t\t * Note: page->index will not change to newkey until\n\t\t * nilfs_btnode_commit_change_key() will be called.\n\t\t * To protect the page in intermediate state, the page lock\n\t\t * is held.\n\t\t */\n\t\tradix_tree_preload_end();\n\t\tif (!err)\n\t\t\treturn 0;\n\t\telse if (err != -EEXIST)\n\t\t\tgoto failed_unlock;\n\n\t\terr = invalidate_inode_pages2_range(btnc, newkey, newkey);\n\t\tif (!err)\n\t\t\tgoto retry;\n\t\t/* fallback to copy mode */\n\t\tunlock_page(obh->b_page);\n\t}\n\n\tnbh = nilfs_btnode_create_block(btnc, newkey);\n\tif (!nbh)\n\t\treturn -ENOMEM;\n\n\tBUG_ON(nbh == obh);\n\tctxt->newbh = nbh;\n\treturn 0;\n\n failed_unlock:\n\tunlock_page(obh->b_page);\n\treturn err;\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_btnode_prepare_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh, *nbh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tint err;\n\n\tif (oldkey == newkey)\n\t\treturn 0;\n\n\tobh = ctxt->bh;\n\tctxt->newbh = NULL;\n\n\tif (inode->i_blkbits == PAGE_CACHE_SHIFT) {\n\t\tlock_page(obh->b_page);\n\t\t/*\n\t\t * We cannot call radix_tree_preload for the kernels older\n\t\t * than 2.6.23, because it is not exported for modules.\n\t\t */\nretry:\n\t\terr = radix_tree_preload(GFP_NOFS & ~__GFP_HIGHMEM);\n\t\tif (err)\n\t\t\tgoto failed_unlock;\n\t\t/* BUG_ON(oldkey != obh->b_page->index); */\n\t\tif (unlikely(oldkey != obh->b_page->index))\n\t\t\tNILFS_PAGE_BUG(obh->b_page,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\terr = radix_tree_insert(&btnc->page_tree, newkey, obh->b_page);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\t/*\n\t\t * Note: page->index will not change to newkey until\n\t\t * nilfs_btnode_commit_change_key() will be called.\n\t\t * To protect the page in intermediate state, the page lock\n\t\t * is held.\n\t\t */\n\t\tradix_tree_preload_end();\n\t\tif (!err)\n\t\t\treturn 0;\n\t\telse if (err != -EEXIST)\n\t\t\tgoto failed_unlock;\n\n\t\terr = invalidate_inode_pages2_range(btnc, newkey, newkey);\n\t\tif (!err)\n\t\t\tgoto retry;\n\t\t/* fallback to copy mode */\n\t\tunlock_page(obh->b_page);\n\t}\n\n\tnbh = nilfs_btnode_create_block(btnc, newkey);\n\tif (!nbh)\n\t\treturn -ENOMEM;\n\n\tBUG_ON(nbh == obh);\n\tctxt->newbh = nbh;\n\treturn 0;\n\n failed_unlock:\n\tunlock_page(obh->b_page);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "*bh"
          ],
          "line": 2131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "ncmax"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 2128
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_assign_p(struct nilfs_bmap *btree,\n\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\tint level,\n\t\t\t\tstruct buffer_head **bh,\n\t\t\t\tsector_t blocknr,\n\t\t\t\tunion nilfs_binfo *binfo)\n{\n\tstruct nilfs_btree_node *parent;\n\t__u64 key;\n\t__u64 ptr;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tptr = nilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t       ncmax);\n\tif (buffer_nilfs_node(*bh)) {\n\t\tpath[level].bp_ctxt.oldkey = ptr;\n\t\tpath[level].bp_ctxt.newkey = blocknr;\n\t\tpath[level].bp_ctxt.bh = *bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\t*bh = path[level].bp_ctxt.bh;\n\t}\n\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index, blocknr,\n\t\t\t\t ncmax);\n\n\tkey = nilfs_btree_node_get_key(parent, path[level + 1].bp_index);\n\t/* on-disk format */\n\tbinfo->bi_dat.bi_blkoff = cpu_to_le64(key);\n\tbinfo->bi_dat.bi_level = level;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_lookup_dirty_buffers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2079-2114",
    "snippet": "static void nilfs_btree_lookup_dirty_buffers(struct nilfs_bmap *btree,\n\t\t\t\t\t     struct list_head *listp)\n{\n\tstruct address_space *btcache = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct list_head lists[NILFS_BTREE_LEVEL_MAX];\n\tstruct pagevec pvec;\n\tstruct buffer_head *bh, *head;\n\tpgoff_t index = 0;\n\tint level, i;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < NILFS_BTREE_LEVEL_MAX;\n\t     level++)\n\t\tINIT_LIST_HEAD(&lists[level]);\n\n\tpagevec_init(&pvec, 0);\n\n\twhile (pagevec_lookup_tag(&pvec, btcache, &index, PAGECACHE_TAG_DIRTY,\n\t\t\t\t  PAGEVEC_SIZE)) {\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tbh = head = page_buffers(pvec.pages[i]);\n\t\t\tdo {\n\t\t\t\tif (buffer_dirty(bh))\n\t\t\t\t\tnilfs_btree_add_dirty_buffer(btree,\n\t\t\t\t\t\t\t\t     lists, bh);\n\t\t\t} while ((bh = bh->b_this_page) != head);\n\t\t}\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < NILFS_BTREE_LEVEL_MAX;\n\t     level++)\n\t\tlist_splice_tail(&lists[level], listp);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_splice_tail",
          "args": [
            "&lists[level]",
            "listp"
          ],
          "line": 2113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_release",
          "args": [
            "&pvec"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "huge_pagevec_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/hugetlbfs/inode.c",
          "lines": "84-92",
          "snippet": "static void huge_pagevec_release(struct pagevec *pvec)\n{\n\tint i;\n\n\tfor (i = 0; i < pagevec_count(pvec); ++i)\n\t\tput_page(pvec->pages[i]);\n\n\tpagevec_reinit(pvec);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/migrate.h>",
            "#include <linux/magic.h>",
            "#include <linux/security.h>",
            "#include <linux/statfs.h>",
            "#include <linux/dnotify.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/parser.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/ctype.h>",
            "#include <linux/capability.h>",
            "#include <linux/string.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/kernel.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/sched.h>\t\t/* remove ASAP */",
            "#include <asm/current.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/migrate.h>\n#include <linux/magic.h>\n#include <linux/security.h>\n#include <linux/statfs.h>\n#include <linux/dnotify.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/parser.h>\n#include <linux/pagevec.h>\n#include <linux/hugetlb.h>\n#include <linux/backing-dev.h>\n#include <linux/ctype.h>\n#include <linux/capability.h>\n#include <linux/string.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/kernel.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/sched.h>\t\t/* remove ASAP */\n#include <asm/current.h>\n#include <linux/thread_info.h>\n#include <linux/module.h>\n\nstatic void huge_pagevec_release(struct pagevec *pvec)\n{\n\tint i;\n\n\tfor (i = 0; i < pagevec_count(pvec); ++i)\n\t\tput_page(pvec->pages[i]);\n\n\tpagevec_reinit(pvec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_add_dirty_buffer",
          "args": [
            "btree",
            "lists",
            "bh"
          ],
          "line": 2102
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_add_dirty_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "2043-2077",
          "snippet": "static void nilfs_btree_add_dirty_buffer(struct nilfs_bmap *btree,\n\t\t\t\t\t struct list_head *lists,\n\t\t\t\t\t struct buffer_head *bh)\n{\n\tstruct list_head *head;\n\tstruct buffer_head *cbh;\n\tstruct nilfs_btree_node *node, *cnode;\n\t__u64 key, ckey;\n\tint level;\n\n\tget_bh(bh);\n\tnode = (struct nilfs_btree_node *)bh->b_data;\n\tkey = nilfs_btree_node_get_key(node, 0);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t    level >= NILFS_BTREE_LEVEL_MAX) {\n\t\tdump_stack();\n\t\tprintk(KERN_WARNING\n\t\t       \"%s: invalid btree level: %d (key=%llu, ino=%lu, \"\n\t\t       \"blocknr=%llu)\\n\",\n\t\t       __func__, level, (unsigned long long)key,\n\t\t       NILFS_BMAP_I(btree)->vfs_inode.i_ino,\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn;\n\t}\n\n\tlist_for_each(head, &lists[level]) {\n\t\tcbh = list_entry(head, struct buffer_head, b_assoc_buffers);\n\t\tcnode = (struct nilfs_btree_node *)cbh->b_data;\n\t\tckey = nilfs_btree_node_get_key(cnode, 0);\n\t\tif (key < ckey)\n\t\t\tbreak;\n\t}\n\tlist_add_tail(&bh->b_assoc_buffers, head);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_add_dirty_buffer(struct nilfs_bmap *btree,\n\t\t\t\t\t struct list_head *lists,\n\t\t\t\t\t struct buffer_head *bh)\n{\n\tstruct list_head *head;\n\tstruct buffer_head *cbh;\n\tstruct nilfs_btree_node *node, *cnode;\n\t__u64 key, ckey;\n\tint level;\n\n\tget_bh(bh);\n\tnode = (struct nilfs_btree_node *)bh->b_data;\n\tkey = nilfs_btree_node_get_key(node, 0);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t    level >= NILFS_BTREE_LEVEL_MAX) {\n\t\tdump_stack();\n\t\tprintk(KERN_WARNING\n\t\t       \"%s: invalid btree level: %d (key=%llu, ino=%lu, \"\n\t\t       \"blocknr=%llu)\\n\",\n\t\t       __func__, level, (unsigned long long)key,\n\t\t       NILFS_BMAP_I(btree)->vfs_inode.i_ino,\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn;\n\t}\n\n\tlist_for_each(head, &lists[level]) {\n\t\tcbh = list_entry(head, struct buffer_head, b_assoc_buffers);\n\t\tcnode = (struct nilfs_btree_node *)cbh->b_data;\n\t\tckey = nilfs_btree_node_get_key(cnode, 0);\n\t\tif (key < ckey)\n\t\t\tbreak;\n\t}\n\tlist_add_tail(&bh->b_assoc_buffers, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_buffers",
          "args": [
            "pvec.pages[i]"
          ],
          "line": 2099
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_page_buffers_clean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/page.c",
          "lines": "157-168",
          "snippet": "int nilfs_page_buffers_clean(struct page *page)\n{\n\tstruct buffer_head *bh, *head;\n\n\tbh = head = page_buffers(page);\n\tdo {\n\t\tif (buffer_dirty(bh))\n\t\t\treturn 0;\n\t\tbh = bh->b_this_page;\n\t} while (bh != head);\n\treturn 1;\n}",
          "includes": [
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/highmem.h>",
            "#include <linux/list.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/bitops.h>",
            "#include <linux/swap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mdt.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/pagevec.h>\n#include <linux/highmem.h>\n#include <linux/list.h>\n#include <linux/page-flags.h>\n#include <linux/bitops.h>\n#include <linux/swap.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n\nint nilfs_page_buffers_clean(struct page *page)\n{\n\tstruct buffer_head *bh, *head;\n\n\tbh = head = page_buffers(page);\n\tdo {\n\t\tif (buffer_dirty(bh))\n\t\t\treturn 0;\n\t\tbh = bh->b_this_page;\n\t} while (bh != head);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pagevec_count",
          "args": [
            "&pvec"
          ],
          "line": 2098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_lookup_tag",
          "args": [
            "&pvec",
            "btcache",
            "&index",
            "PAGECACHE_TAG_DIRTY",
            "PAGEVEC_SIZE"
          ],
          "line": 2096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_init",
          "args": [
            "&pvec",
            "0"
          ],
          "line": 2094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&lists[level]"
          ],
          "line": 2092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 2082
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_lookup_dirty_buffers(struct nilfs_bmap *btree,\n\t\t\t\t\t     struct list_head *listp)\n{\n\tstruct address_space *btcache = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct list_head lists[NILFS_BTREE_LEVEL_MAX];\n\tstruct pagevec pvec;\n\tstruct buffer_head *bh, *head;\n\tpgoff_t index = 0;\n\tint level, i;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < NILFS_BTREE_LEVEL_MAX;\n\t     level++)\n\t\tINIT_LIST_HEAD(&lists[level]);\n\n\tpagevec_init(&pvec, 0);\n\n\twhile (pagevec_lookup_tag(&pvec, btcache, &index, PAGECACHE_TAG_DIRTY,\n\t\t\t\t  PAGEVEC_SIZE)) {\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tbh = head = page_buffers(pvec.pages[i]);\n\t\t\tdo {\n\t\t\t\tif (buffer_dirty(bh))\n\t\t\t\t\tnilfs_btree_add_dirty_buffer(btree,\n\t\t\t\t\t\t\t\t     lists, bh);\n\t\t\t} while ((bh = bh->b_this_page) != head);\n\t\t}\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < NILFS_BTREE_LEVEL_MAX;\n\t     level++)\n\t\tlist_splice_tail(&lists[level], listp);\n}"
  },
  {
    "function_name": "nilfs_btree_add_dirty_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2043-2077",
    "snippet": "static void nilfs_btree_add_dirty_buffer(struct nilfs_bmap *btree,\n\t\t\t\t\t struct list_head *lists,\n\t\t\t\t\t struct buffer_head *bh)\n{\n\tstruct list_head *head;\n\tstruct buffer_head *cbh;\n\tstruct nilfs_btree_node *node, *cnode;\n\t__u64 key, ckey;\n\tint level;\n\n\tget_bh(bh);\n\tnode = (struct nilfs_btree_node *)bh->b_data;\n\tkey = nilfs_btree_node_get_key(node, 0);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t    level >= NILFS_BTREE_LEVEL_MAX) {\n\t\tdump_stack();\n\t\tprintk(KERN_WARNING\n\t\t       \"%s: invalid btree level: %d (key=%llu, ino=%lu, \"\n\t\t       \"blocknr=%llu)\\n\",\n\t\t       __func__, level, (unsigned long long)key,\n\t\t       NILFS_BMAP_I(btree)->vfs_inode.i_ino,\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn;\n\t}\n\n\tlist_for_each(head, &lists[level]) {\n\t\tcbh = list_entry(head, struct buffer_head, b_assoc_buffers);\n\t\tcnode = (struct nilfs_btree_node *)cbh->b_data;\n\t\tckey = nilfs_btree_node_get_key(cnode, 0);\n\t\tif (key < ckey)\n\t\t\tbreak;\n\t}\n\tlist_add_tail(&bh->b_assoc_buffers, head);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&bh->b_assoc_buffers",
            "head"
          ],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "cnode",
            "0"
          ],
          "line": 2072
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "head",
            "structbuffer_head",
            "b_assoc_buffers"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "head",
            "&lists[level]"
          ],
          "line": 2069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING\n\t\t       \"%s: invalid btree level: %d (key=%llu, ino=%lu, \"\n\t\t       \"blocknr=%llu)\\n\"",
            "__func__",
            "level",
            "(unsigned long long)key",
            "NILFS_BMAP_I(btree)->vfs_inode.i_ino",
            "(unsigned long long)bh->b_blocknr"
          ],
          "line": 2060
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 2059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "bh"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_add_dirty_buffer(struct nilfs_bmap *btree,\n\t\t\t\t\t struct list_head *lists,\n\t\t\t\t\t struct buffer_head *bh)\n{\n\tstruct list_head *head;\n\tstruct buffer_head *cbh;\n\tstruct nilfs_btree_node *node, *cnode;\n\t__u64 key, ckey;\n\tint level;\n\n\tget_bh(bh);\n\tnode = (struct nilfs_btree_node *)bh->b_data;\n\tkey = nilfs_btree_node_get_key(node, 0);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t    level >= NILFS_BTREE_LEVEL_MAX) {\n\t\tdump_stack();\n\t\tprintk(KERN_WARNING\n\t\t       \"%s: invalid btree level: %d (key=%llu, ino=%lu, \"\n\t\t       \"blocknr=%llu)\\n\",\n\t\t       __func__, level, (unsigned long long)key,\n\t\t       NILFS_BMAP_I(btree)->vfs_inode.i_ino,\n\t\t       (unsigned long long)bh->b_blocknr);\n\t\treturn;\n\t}\n\n\tlist_for_each(head, &lists[level]) {\n\t\tcbh = list_entry(head, struct buffer_head, b_assoc_buffers);\n\t\tcnode = (struct nilfs_btree_node *)cbh->b_data;\n\t\tckey = nilfs_btree_node_get_key(cnode, 0);\n\t\tif (key < ckey)\n\t\t\tbreak;\n\t}\n\tlist_add_tail(&bh->b_assoc_buffers, head);\n}"
  },
  {
    "function_name": "nilfs_btree_propagate_gc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "2037-2041",
    "snippet": "static int nilfs_btree_propagate_gc(struct nilfs_bmap *btree,\n\t\t\t\t    struct buffer_head *bh)\n{\n\treturn nilfs_dat_mark_dirty(nilfs_bmap_get_dat(btree), bh->b_blocknr);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_mark_dirty",
          "args": [
            "nilfs_bmap_get_dat(btree)",
            "bh->b_blocknr"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "277-287",
          "snippet": "int nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate_gc(struct nilfs_bmap *btree,\n\t\t\t\t    struct buffer_head *bh)\n{\n\treturn nilfs_dat_mark_dirty(nilfs_bmap_get_dat(btree), bh->b_blocknr);\n}"
  },
  {
    "function_name": "nilfs_btree_propagate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1996-2035",
    "snippet": "static int nilfs_btree_propagate(struct nilfs_bmap *btree,\n\t\t\t\t struct buffer_head *bh)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint level, ret;\n\n\tWARN_ON(!buffer_dirty(bh));\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tif (buffer_nilfs_node(bh)) {\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t\tlevel = nilfs_btree_node_get_level(node);\n\t} else {\n\t\tkey = nilfs_bmap_data_get_key(btree, bh);\n\t\tlevel = NILFS_BTREE_LEVEL_DATA;\n\t}\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL, level + 1, 0);\n\tif (ret < 0) {\n\t\tif (unlikely(ret == -ENOENT))\n\t\t\tprintk(KERN_CRIT \"%s: key = %llu, level == %d\\n\",\n\t\t\t       __func__, (unsigned long long)key, level);\n\t\tgoto out;\n\t}\n\n\tret = NILFS_BMAP_USE_VBN(btree) ?\n\t\tnilfs_btree_propagate_v(btree, path, level, bh) :\n\t\tnilfs_btree_propagate_p(btree, path, level, bh);\n\n out:\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 2032
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_propagate_p",
          "args": [
            "btree",
            "path",
            "level",
            "bh"
          ],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_propagate_p",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1828-1838",
          "snippet": "static int nilfs_btree_propagate_p(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level,\n\t\t\t\t   struct buffer_head *bh)\n{\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate_p(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level,\n\t\t\t\t   struct buffer_head *bh)\n{\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_propagate_v",
          "args": [
            "btree",
            "path",
            "level",
            "bh"
          ],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_propagate_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1961-1994",
          "snippet": "static int nilfs_btree_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, struct buffer_head *bh)\n{\n\tint maxlevel = 0, ret;\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 ptr;\n\tint ncmax;\n\n\tget_bh(bh);\n\tpath[level].bp_bh = bh;\n\tret = nilfs_btree_prepare_propagate_v(btree, path, level, &maxlevel,\n\t\t\t\t\t      dat);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tptr = nilfs_btree_node_get_ptr(parent,\n\t\t\t\t\t       path[level + 1].bp_index,\n\t\t\t\t\t       ncmax);\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\tnilfs_btree_commit_propagate_v(btree, path, level, maxlevel, bh, dat);\n\n out:\n\tbrelse(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, struct buffer_head *bh)\n{\n\tint maxlevel = 0, ret;\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 ptr;\n\tint ncmax;\n\n\tget_bh(bh);\n\tpath[level].bp_bh = bh;\n\tret = nilfs_btree_prepare_propagate_v(btree, path, level, &maxlevel,\n\t\t\t\t\t      dat);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tptr = nilfs_btree_node_get_ptr(parent,\n\t\t\t\t\t       path[level + 1].bp_index,\n\t\t\t\t\t       ncmax);\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\tnilfs_btree_commit_propagate_v(btree, path, level, maxlevel, bh, dat);\n\n out:\n\tbrelse(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 2027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"%s: key = %llu, level == %d\\n\"",
            "__func__",
            "(unsigned long long)key",
            "level"
          ],
          "line": 2022
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret == -ENOENT"
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "NULL",
            "level + 1",
            "0"
          ],
          "line": 2019
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_data_get_key",
          "args": [
            "btree",
            "bh"
          ],
          "line": 2015
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_data_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "429-441",
          "snippet": "__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_data_get_key(const struct nilfs_bmap *bmap,\n\t\t\t      const struct buffer_head *bh)\n{\n\tstruct buffer_head *pbh;\n\t__u64 key;\n\n\tkey = page_index(bh->b_page) << (PAGE_CACHE_SHIFT -\n\t\t\t\t\t bmap->b_inode->i_blkbits);\n\tfor (pbh = page_buffers(bh->b_page); pbh != bh; pbh = pbh->b_this_page)\n\t\tkey++;\n\n\treturn key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 2013
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 2012
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "bh"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 2006
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!buffer_dirty(bh)"
          ],
          "line": 2004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 2004
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate(struct nilfs_bmap *btree,\n\t\t\t\t struct buffer_head *bh)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\t__u64 key;\n\tint level, ret;\n\n\tWARN_ON(!buffer_dirty(bh));\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tif (buffer_nilfs_node(bh)) {\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tkey = nilfs_btree_node_get_key(node, 0);\n\t\tlevel = nilfs_btree_node_get_level(node);\n\t} else {\n\t\tkey = nilfs_bmap_data_get_key(btree, bh);\n\t\tlevel = NILFS_BTREE_LEVEL_DATA;\n\t}\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL, level + 1, 0);\n\tif (ret < 0) {\n\t\tif (unlikely(ret == -ENOENT))\n\t\t\tprintk(KERN_CRIT \"%s: key = %llu, level == %d\\n\",\n\t\t\t       __func__, (unsigned long long)key, level);\n\t\tgoto out;\n\t}\n\n\tret = NILFS_BMAP_USE_VBN(btree) ?\n\t\tnilfs_btree_propagate_v(btree, path, level, bh) :\n\t\tnilfs_btree_propagate_p(btree, path, level, bh);\n\n out:\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_propagate_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1961-1994",
    "snippet": "static int nilfs_btree_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, struct buffer_head *bh)\n{\n\tint maxlevel = 0, ret;\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 ptr;\n\tint ncmax;\n\n\tget_bh(bh);\n\tpath[level].bp_bh = bh;\n\tret = nilfs_btree_prepare_propagate_v(btree, path, level, &maxlevel,\n\t\t\t\t\t      dat);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tptr = nilfs_btree_node_get_ptr(parent,\n\t\t\t\t\t       path[level + 1].bp_index,\n\t\t\t\t\t       ncmax);\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\tnilfs_btree_commit_propagate_v(btree, path, level, maxlevel, bh, dat);\n\n out:\n\tbrelse(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1991
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_commit_propagate_v",
          "args": [
            "btree",
            "path",
            "level",
            "maxlevel",
            "bh",
            "dat"
          ],
          "line": 1988
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_commit_propagate_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1946-1959",
          "snippet": "static void nilfs_btree_commit_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int maxlevel,\n\t\t\t\t\t   struct buffer_head *bh,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level;\n\n\tif (!buffer_nilfs_volatile(path[minlevel].bp_bh))\n\t\tnilfs_btree_commit_update_v(btree, path, minlevel, dat);\n\n\tfor (level = minlevel + 1; level <= maxlevel; level++)\n\t\tnilfs_btree_commit_update_v(btree, path, level, dat);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int maxlevel,\n\t\t\t\t\t   struct buffer_head *bh,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level;\n\n\tif (!buffer_nilfs_volatile(path[minlevel].bp_bh))\n\t\tnilfs_btree_commit_update_v(btree, path, minlevel, dat);\n\n\tfor (level = minlevel + 1; level <= maxlevel; level++)\n\t\tnilfs_btree_commit_update_v(btree, path, level, dat);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_mark_dirty",
          "args": [
            "dat",
            "ptr"
          ],
          "line": 1983
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_mark_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "277-287",
          "snippet": "int nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_mark_dirty(struct inode *dat, __u64 vblocknr)\n{\n\tstruct nilfs_palloc_req req;\n\tint ret;\n\n\treq.pr_entry_nr = vblocknr;\n\tret = nilfs_dat_prepare_entry(dat, &req, 0);\n\tif (ret == 0)\n\t\tnilfs_dat_commit_entry(dat, &req);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "ncmax"
          ],
          "line": 1980
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 1979
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_prepare_propagate_v",
          "args": [
            "btree",
            "path",
            "level",
            "&maxlevel",
            "dat"
          ],
          "line": 1973
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_prepare_propagate_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1911-1944",
          "snippet": "static int nilfs_btree_prepare_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int *maxlevelp,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level, ret;\n\n\tlevel = minlevel;\n\tif (!buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh)) {\n\n\t\tWARN_ON(buffer_nilfs_volatile(path[level].bp_bh));\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/* success */\n\t*maxlevelp = level - 1;\n\treturn 0;\n\n\t/* error */\n out:\n\twhile (--level > minlevel)\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\tif (!buffer_nilfs_volatile(path[level].bp_bh))\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int *maxlevelp,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level, ret;\n\n\tlevel = minlevel;\n\tif (!buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh)) {\n\n\t\tWARN_ON(buffer_nilfs_volatile(path[level].bp_bh));\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/* success */\n\t*maxlevelp = level - 1;\n\treturn 0;\n\n\t/* error */\n out:\n\twhile (--level > minlevel)\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\tif (!buffer_nilfs_volatile(path[level].bp_bh))\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_bh",
          "args": [
            "bh"
          ],
          "line": 1971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1967
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, struct buffer_head *bh)\n{\n\tint maxlevel = 0, ret;\n\tstruct nilfs_btree_node *parent;\n\tstruct inode *dat = nilfs_bmap_get_dat(btree);\n\t__u64 ptr;\n\tint ncmax;\n\n\tget_bh(bh);\n\tpath[level].bp_bh = bh;\n\tret = nilfs_btree_prepare_propagate_v(btree, path, level, &maxlevel,\n\t\t\t\t\t      dat);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tptr = nilfs_btree_node_get_ptr(parent,\n\t\t\t\t\t       path[level + 1].bp_index,\n\t\t\t\t\t       ncmax);\n\t\tret = nilfs_dat_mark_dirty(dat, ptr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\tnilfs_btree_commit_propagate_v(btree, path, level, maxlevel, bh, dat);\n\n out:\n\tbrelse(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_commit_propagate_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1946-1959",
    "snippet": "static void nilfs_btree_commit_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int maxlevel,\n\t\t\t\t\t   struct buffer_head *bh,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level;\n\n\tif (!buffer_nilfs_volatile(path[minlevel].bp_bh))\n\t\tnilfs_btree_commit_update_v(btree, path, minlevel, dat);\n\n\tfor (level = minlevel + 1; level <= maxlevel; level++)\n\t\tnilfs_btree_commit_update_v(btree, path, level, dat);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_commit_update_v",
          "args": [
            "btree",
            "path",
            "level",
            "dat"
          ],
          "line": 1958
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_commit_update_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1875-1897",
          "snippet": "static void nilfs_btree_commit_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax;\n\n\tnilfs_dat_commit_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t&path[level].bp_newreq.bpr_req,\n\t\t\t\tbtree->b_ptr_type == NILFS_BMAP_PTR_VS);\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tpath[level].bp_bh = path[level].bp_ctxt.bh;\n\t}\n\tset_buffer_nilfs_volatile(path[level].bp_bh);\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t path[level].bp_newreq.bpr_ptr, ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax;\n\n\tnilfs_dat_commit_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t&path[level].bp_newreq.bpr_req,\n\t\t\t\tbtree->b_ptr_type == NILFS_BMAP_PTR_VS);\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tpath[level].bp_bh = path[level].bp_ctxt.bh;\n\t}\n\tset_buffer_nilfs_volatile(path[level].bp_bh);\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t path[level].bp_newreq.bpr_ptr, ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "path[minlevel].bp_bh"
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int maxlevel,\n\t\t\t\t\t   struct buffer_head *bh,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level;\n\n\tif (!buffer_nilfs_volatile(path[minlevel].bp_bh))\n\t\tnilfs_btree_commit_update_v(btree, path, minlevel, dat);\n\n\tfor (level = minlevel + 1; level <= maxlevel; level++)\n\t\tnilfs_btree_commit_update_v(btree, path, level, dat);\n}"
  },
  {
    "function_name": "nilfs_btree_prepare_propagate_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1911-1944",
    "snippet": "static int nilfs_btree_prepare_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int *maxlevelp,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level, ret;\n\n\tlevel = minlevel;\n\tif (!buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh)) {\n\n\t\tWARN_ON(buffer_nilfs_volatile(path[level].bp_bh));\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/* success */\n\t*maxlevelp = level - 1;\n\treturn 0;\n\n\t/* error */\n out:\n\twhile (--level > minlevel)\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\tif (!buffer_nilfs_volatile(path[level].bp_bh))\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_abort_update_v",
          "args": [
            "btree",
            "path",
            "level",
            "dat"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_abort_update_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1899-1909",
          "snippet": "static void nilfs_btree_abort_update_v(struct nilfs_bmap *btree,\n\t\t\t\t       struct nilfs_btree_path *path,\n\t\t\t\t       int level, struct inode *dat)\n{\n\tnilfs_dat_abort_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (buffer_nilfs_node(path[level].bp_bh))\n\t\tnilfs_btnode_abort_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_abort_update_v(struct nilfs_bmap *btree,\n\t\t\t\t       struct nilfs_btree_path *path,\n\t\t\t\t       int level, struct inode *dat)\n{\n\tnilfs_dat_abort_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (buffer_nilfs_node(path[level].bp_bh))\n\t\tnilfs_btnode_abort_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_prepare_update_v",
          "args": [
            "btree",
            "path",
            "level",
            "dat"
          ],
          "line": 1928
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_prepare_update_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1840-1873",
          "snippet": "static int nilfs_btree_prepare_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t\t ncmax);\n\tpath[level].bp_newreq.bpr_ptr = path[level].bp_oldreq.bpr_ptr + 1;\n\tret = nilfs_dat_prepare_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tpath[level].bp_ctxt.oldkey = path[level].bp_oldreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.newkey = path[level].bp_newreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.bh = path[level].bp_bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_update(dat,\n\t\t\t\t\t       &path[level].bp_oldreq.bpr_req,\n\t\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t\t ncmax);\n\tpath[level].bp_newreq.bpr_ptr = path[level].bp_oldreq.bpr_ptr + 1;\n\tret = nilfs_dat_prepare_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tpath[level].bp_ctxt.oldkey = path[level].bp_oldreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.newkey = path[level].bp_newreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.bh = path[level].bp_bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_update(dat,\n\t\t\t\t\t       &path[level].bp_oldreq.bpr_req,\n\t\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "buffer_nilfs_volatile(path[level].bp_bh)"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1925
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1924
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_volatile",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_propagate_v(struct nilfs_bmap *btree,\n\t\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t\t   int minlevel, int *maxlevelp,\n\t\t\t\t\t   struct inode *dat)\n{\n\tint level, ret;\n\n\tlevel = minlevel;\n\tif (!buffer_nilfs_volatile(path[level].bp_bh)) {\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh)) {\n\n\t\tWARN_ON(buffer_nilfs_volatile(path[level].bp_bh));\n\t\tret = nilfs_btree_prepare_update_v(btree, path, level, dat);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\n\t/* success */\n\t*maxlevelp = level - 1;\n\treturn 0;\n\n\t/* error */\n out:\n\twhile (--level > minlevel)\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\tif (!buffer_nilfs_volatile(path[level].bp_bh))\n\t\tnilfs_btree_abort_update_v(btree, path, level, dat);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_abort_update_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1899-1909",
    "snippet": "static void nilfs_btree_abort_update_v(struct nilfs_bmap *btree,\n\t\t\t\t       struct nilfs_btree_path *path,\n\t\t\t\t       int level, struct inode *dat)\n{\n\tnilfs_dat_abort_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (buffer_nilfs_node(path[level].bp_bh))\n\t\tnilfs_btnode_abort_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btnode_abort_change_key",
          "args": [
            "&NILFS_BMAP_I(btree)->i_btnode_cache",
            "&path[level].bp_ctxt"
          ],
          "line": 1906
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_abort_change_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "281-297",
          "snippet": "void nilfs_btnode_abort_change_key(struct address_space *btnc,\n\t\t\t\t   struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, newkey);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\tunlock_page(ctxt->bh->b_page);\n\t} else\n\t\tbrelse(nbh);\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_abort_change_key(struct address_space *btnc,\n\t\t\t\t   struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, newkey);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\tunlock_page(ctxt->bh->b_page);\n\t} else\n\t\tbrelse(nbh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_abort_update",
          "args": [
            "dat",
            "&path[level].bp_oldreq.bpr_req",
            "&path[level].bp_newreq.bpr_req"
          ],
          "line": 1903
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "255-261",
          "snippet": "void nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_abort_update_v(struct nilfs_bmap *btree,\n\t\t\t\t       struct nilfs_btree_path *path,\n\t\t\t\t       int level, struct inode *dat)\n{\n\tnilfs_dat_abort_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (buffer_nilfs_node(path[level].bp_bh))\n\t\tnilfs_btnode_abort_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n}"
  },
  {
    "function_name": "nilfs_btree_commit_update_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1875-1897",
    "snippet": "static void nilfs_btree_commit_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax;\n\n\tnilfs_dat_commit_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t&path[level].bp_newreq.bpr_req,\n\t\t\t\tbtree->b_ptr_type == NILFS_BMAP_PTR_VS);\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tpath[level].bp_bh = path[level].bp_ctxt.bh;\n\t}\n\tset_buffer_nilfs_volatile(path[level].bp_bh);\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t path[level].bp_newreq.bpr_ptr, ncmax);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "path[level].bp_newreq.bpr_ptr",
            "ncmax"
          ],
          "line": 1895
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "167-172",
          "snippet": "static void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_commit_change_key",
          "args": [
            "&NILFS_BMAP_I(btree)->i_btnode_cache",
            "&path[level].bp_ctxt"
          ],
          "line": 1887
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_commit_change_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "240-275",
          "snippet": "void nilfs_btnode_commit_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh = ctxt->bh, *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tstruct page *opage;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\topage = obh->b_page;\n\t\tif (unlikely(oldkey != opage->index))\n\t\t\tNILFS_PAGE_BUG(opage,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\t\tmark_buffer_dirty(obh);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, oldkey);\n\t\tradix_tree_tag_set(&btnc->page_tree, newkey,\n\t\t\t\t   PAGECACHE_TAG_DIRTY);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\n\t\topage->index = obh->b_blocknr = newkey;\n\t\tunlock_page(opage);\n\t} else {\n\t\tnilfs_copy_buffer(nbh, obh);\n\t\tmark_buffer_dirty(nbh);\n\n\t\tnbh->b_blocknr = newkey;\n\t\tctxt->bh = nbh;\n\t\tnilfs_btnode_delete(obh); /* will decrement bh->b_count */\n\t}\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_commit_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh = ctxt->bh, *nbh = ctxt->newbh;\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tstruct page *opage;\n\n\tif (oldkey == newkey)\n\t\treturn;\n\n\tif (nbh == NULL) {\t/* blocksize == pagesize */\n\t\topage = obh->b_page;\n\t\tif (unlikely(oldkey != opage->index))\n\t\t\tNILFS_PAGE_BUG(opage,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\t\tmark_buffer_dirty(obh);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\tradix_tree_delete(&btnc->page_tree, oldkey);\n\t\tradix_tree_tag_set(&btnc->page_tree, newkey,\n\t\t\t\t   PAGECACHE_TAG_DIRTY);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\n\t\topage->index = obh->b_blocknr = newkey;\n\t\tunlock_page(opage);\n\t} else {\n\t\tnilfs_copy_buffer(nbh, obh);\n\t\tmark_buffer_dirty(nbh);\n\n\t\tnbh->b_blocknr = newkey;\n\t\tctxt->bh = nbh;\n\t\tnilfs_btnode_delete(obh); /* will decrement bh->b_count */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_commit_update",
          "args": [
            "dat",
            "&path[level].bp_oldreq.bpr_req",
            "&path[level].bp_newreq.bpr_req",
            "btree->b_ptr_type == NILFS_BMAP_PTR_VS"
          ],
          "line": 1882
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_commit_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "247-253",
          "snippet": "void nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_commit_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq, int dead)\n{\n\tnilfs_dat_commit_end(dat, oldreq, dead);\n\tnilfs_dat_commit_alloc(dat, newreq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax;\n\n\tnilfs_dat_commit_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t&path[level].bp_newreq.bpr_req,\n\t\t\t\tbtree->b_ptr_type == NILFS_BMAP_PTR_VS);\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tnilfs_btnode_commit_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tpath[level].bp_bh = path[level].bp_ctxt.bh;\n\t}\n\tset_buffer_nilfs_volatile(path[level].bp_bh);\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tnilfs_btree_node_set_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t path[level].bp_newreq.bpr_ptr, ncmax);\n}"
  },
  {
    "function_name": "nilfs_btree_prepare_update_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1840-1873",
    "snippet": "static int nilfs_btree_prepare_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t\t ncmax);\n\tpath[level].bp_newreq.bpr_ptr = path[level].bp_oldreq.bpr_ptr + 1;\n\tret = nilfs_dat_prepare_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tpath[level].bp_ctxt.oldkey = path[level].bp_oldreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.newkey = path[level].bp_newreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.bh = path[level].bp_bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_update(dat,\n\t\t\t\t\t       &path[level].bp_oldreq.bpr_req,\n\t\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_dat_abort_update",
          "args": [
            "dat",
            "&path[level].bp_oldreq.bpr_req",
            "&path[level].bp_newreq.bpr_req"
          ],
          "line": 1865
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_abort_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "255-261",
          "snippet": "void nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_dat_abort_update(struct inode *dat,\n\t\t\t    struct nilfs_palloc_req *oldreq,\n\t\t\t    struct nilfs_palloc_req *newreq)\n{\n\tnilfs_dat_abort_end(dat, oldreq);\n\tnilfs_dat_abort_alloc(dat, newreq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_prepare_change_key",
          "args": [
            "&NILFS_BMAP_I(btree)->i_btnode_cache",
            "&path[level].bp_ctxt"
          ],
          "line": 1861
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_prepare_change_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "170-234",
          "snippet": "int nilfs_btnode_prepare_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh, *nbh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tint err;\n\n\tif (oldkey == newkey)\n\t\treturn 0;\n\n\tobh = ctxt->bh;\n\tctxt->newbh = NULL;\n\n\tif (inode->i_blkbits == PAGE_CACHE_SHIFT) {\n\t\tlock_page(obh->b_page);\n\t\t/*\n\t\t * We cannot call radix_tree_preload for the kernels older\n\t\t * than 2.6.23, because it is not exported for modules.\n\t\t */\nretry:\n\t\terr = radix_tree_preload(GFP_NOFS & ~__GFP_HIGHMEM);\n\t\tif (err)\n\t\t\tgoto failed_unlock;\n\t\t/* BUG_ON(oldkey != obh->b_page->index); */\n\t\tif (unlikely(oldkey != obh->b_page->index))\n\t\t\tNILFS_PAGE_BUG(obh->b_page,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\terr = radix_tree_insert(&btnc->page_tree, newkey, obh->b_page);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\t/*\n\t\t * Note: page->index will not change to newkey until\n\t\t * nilfs_btnode_commit_change_key() will be called.\n\t\t * To protect the page in intermediate state, the page lock\n\t\t * is held.\n\t\t */\n\t\tradix_tree_preload_end();\n\t\tif (!err)\n\t\t\treturn 0;\n\t\telse if (err != -EEXIST)\n\t\t\tgoto failed_unlock;\n\n\t\terr = invalidate_inode_pages2_range(btnc, newkey, newkey);\n\t\tif (!err)\n\t\t\tgoto retry;\n\t\t/* fallback to copy mode */\n\t\tunlock_page(obh->b_page);\n\t}\n\n\tnbh = nilfs_btnode_create_block(btnc, newkey);\n\tif (!nbh)\n\t\treturn -ENOMEM;\n\n\tBUG_ON(nbh == obh);\n\tctxt->newbh = nbh;\n\treturn 0;\n\n failed_unlock:\n\tunlock_page(obh->b_page);\n\treturn err;\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_btnode_prepare_change_key(struct address_space *btnc,\n\t\t\t\t    struct nilfs_btnode_chkey_ctxt *ctxt)\n{\n\tstruct buffer_head *obh, *nbh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\t__u64 oldkey = ctxt->oldkey, newkey = ctxt->newkey;\n\tint err;\n\n\tif (oldkey == newkey)\n\t\treturn 0;\n\n\tobh = ctxt->bh;\n\tctxt->newbh = NULL;\n\n\tif (inode->i_blkbits == PAGE_CACHE_SHIFT) {\n\t\tlock_page(obh->b_page);\n\t\t/*\n\t\t * We cannot call radix_tree_preload for the kernels older\n\t\t * than 2.6.23, because it is not exported for modules.\n\t\t */\nretry:\n\t\terr = radix_tree_preload(GFP_NOFS & ~__GFP_HIGHMEM);\n\t\tif (err)\n\t\t\tgoto failed_unlock;\n\t\t/* BUG_ON(oldkey != obh->b_page->index); */\n\t\tif (unlikely(oldkey != obh->b_page->index))\n\t\t\tNILFS_PAGE_BUG(obh->b_page,\n\t\t\t\t       \"invalid oldkey %lld (newkey=%lld)\",\n\t\t\t\t       (unsigned long long)oldkey,\n\t\t\t\t       (unsigned long long)newkey);\n\n\t\tspin_lock_irq(&btnc->tree_lock);\n\t\terr = radix_tree_insert(&btnc->page_tree, newkey, obh->b_page);\n\t\tspin_unlock_irq(&btnc->tree_lock);\n\t\t/*\n\t\t * Note: page->index will not change to newkey until\n\t\t * nilfs_btnode_commit_change_key() will be called.\n\t\t * To protect the page in intermediate state, the page lock\n\t\t * is held.\n\t\t */\n\t\tradix_tree_preload_end();\n\t\tif (!err)\n\t\t\treturn 0;\n\t\telse if (err != -EEXIST)\n\t\t\tgoto failed_unlock;\n\n\t\terr = invalidate_inode_pages2_range(btnc, newkey, newkey);\n\t\tif (!err)\n\t\t\tgoto retry;\n\t\t/* fallback to copy mode */\n\t\tunlock_page(obh->b_page);\n\t}\n\n\tnbh = nilfs_btnode_create_block(btnc, newkey);\n\tif (!nbh)\n\t\treturn -ENOMEM;\n\n\tBUG_ON(nbh == obh);\n\tctxt->newbh = nbh;\n\treturn 0;\n\n failed_unlock:\n\tunlock_page(obh->b_page);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_node",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_dat_prepare_update",
          "args": [
            "dat",
            "&path[level].bp_oldreq.bpr_req",
            "&path[level].bp_newreq.bpr_req"
          ],
          "line": 1852
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_prepare_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "232-245",
          "snippet": "int nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_prepare_update(struct inode *dat,\n\t\t\t     struct nilfs_palloc_req *oldreq,\n\t\t\t     struct nilfs_palloc_req *newreq)\n{\n\tint ret;\n\n\tret = nilfs_dat_prepare_end(dat, oldreq);\n\tif (!ret) {\n\t\tret = nilfs_dat_prepare_alloc(dat, newreq);\n\t\tif (ret < 0)\n\t\t\tnilfs_dat_abort_end(dat, oldreq);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "parent",
            "path[level + 1].bp_index",
            "ncmax"
          ],
          "line": 1849
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 1847
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_update_v(struct nilfs_bmap *btree,\n\t\t\t\t\tstruct nilfs_btree_path *path,\n\t\t\t\t\tint level, struct inode *dat)\n{\n\tstruct nilfs_btree_node *parent;\n\tint ncmax, ret;\n\n\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(parent, path[level + 1].bp_index,\n\t\t\t\t\t ncmax);\n\tpath[level].bp_newreq.bpr_ptr = path[level].bp_oldreq.bpr_ptr + 1;\n\tret = nilfs_dat_prepare_update(dat, &path[level].bp_oldreq.bpr_req,\n\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (buffer_nilfs_node(path[level].bp_bh)) {\n\t\tpath[level].bp_ctxt.oldkey = path[level].bp_oldreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.newkey = path[level].bp_newreq.bpr_ptr;\n\t\tpath[level].bp_ctxt.bh = path[level].bp_bh;\n\t\tret = nilfs_btnode_prepare_change_key(\n\t\t\t&NILFS_BMAP_I(btree)->i_btnode_cache,\n\t\t\t&path[level].bp_ctxt);\n\t\tif (ret < 0) {\n\t\t\tnilfs_dat_abort_update(dat,\n\t\t\t\t\t       &path[level].bp_oldreq.bpr_req,\n\t\t\t\t\t       &path[level].bp_newreq.bpr_req);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_propagate_p",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1828-1838",
    "snippet": "static int nilfs_btree_propagate_p(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level,\n\t\t\t\t   struct buffer_head *bh)\n{\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1833
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_propagate_p(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level,\n\t\t\t\t   struct buffer_head *bh)\n{\n\twhile ((++level < nilfs_btree_height(btree) - 1) &&\n\t       !buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_convert_and_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1796-1826",
    "snippet": "int nilfs_btree_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t   __u64 key, __u64 ptr,\n\t\t\t\t   const __u64 *keys, const __u64 *ptrs, int n)\n{\n\tstruct buffer_head *bh;\n\tunion nilfs_bmap_ptr_req dreq, nreq, *di, *ni;\n\tstruct nilfs_bmap_stats stats;\n\tint ret;\n\n\tif (n + 1 <= NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tdi = &dreq;\n\t\tni = NULL;\n\t} else if ((n + 1) <= NILFS_BTREE_NODE_NCHILDREN_MAX(\n\t\t\t   1 << btree->b_inode->i_blkbits)) {\n\t\tdi = &dreq;\n\t\tni = &nreq;\n\t} else {\n\t\tdi = NULL;\n\t\tni = NULL;\n\t\tBUG();\n\t}\n\n\tret = nilfs_btree_prepare_convert_and_insert(btree, key, di, ni, &bh,\n\t\t\t\t\t\t     &stats);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_btree_commit_convert_and_insert(btree, key, ptr, keys, ptrs, n,\n\t\t\t\t\t      di, ni, bh);\n\tnilfs_inode_add_blocks(btree->b_inode, stats.bs_nblocks);\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_inode_add_blocks",
          "args": [
            "btree->b_inode",
            "stats.bs_nblocks"
          ],
          "line": 1824
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_inode_add_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "54-61",
          "snippet": "void nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_commit_convert_and_insert",
          "args": [
            "btree",
            "key",
            "ptr",
            "keys",
            "ptrs",
            "n",
            "di",
            "ni",
            "bh"
          ],
          "line": 1822
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_commit_convert_and_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1723-1785",
          "snippet": "static void\nnilfs_btree_commit_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t      __u64 key, __u64 ptr,\n\t\t\t\t      const __u64 *keys, const __u64 *ptrs,\n\t\t\t\t      int n,\n\t\t\t\t      union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t      union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t      struct buffer_head *bh)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat;\n\t__u64 tmpptr;\n\tint ncblk;\n\n\t/* free resources */\n\tif (btree->b_ops->bop_clear != NULL)\n\t\tbtree->b_ops->bop_clear(btree);\n\n\t/* ptr must be a pointer to a buffer head. */\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\n\t/* convert and insert */\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\t__nilfs_btree_init(btree);\n\tif (nreq != NULL) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\t\tnilfs_bmap_commit_alloc_ptr(btree, nreq, dat);\n\n\t\t/* create child node at level 1 */\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_init(node, 0, 1, n, ncblk, keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr, ncblk);\n\t\tif (!buffer_dirty(bh))\n\t\t\tmark_buffer_dirty(bh);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\n\t\tbrelse(bh);\n\n\t\t/* create root node at level 2 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\ttmpptr = nreq->bpr_ptr;\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 2, 1,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      &keys[0], &tmpptr);\n\t} else {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\n\t\t/* create root node at level 1 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 1, n,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\t}\n\n\tif (NILFS_BMAP_USE_VBN(btree))\n\t\tnilfs_bmap_set_target_v(btree, key, dreq->bpr_ptr);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_commit_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t      __u64 key, __u64 ptr,\n\t\t\t\t      const __u64 *keys, const __u64 *ptrs,\n\t\t\t\t      int n,\n\t\t\t\t      union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t      union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t      struct buffer_head *bh)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat;\n\t__u64 tmpptr;\n\tint ncblk;\n\n\t/* free resources */\n\tif (btree->b_ops->bop_clear != NULL)\n\t\tbtree->b_ops->bop_clear(btree);\n\n\t/* ptr must be a pointer to a buffer head. */\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\n\t/* convert and insert */\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\t__nilfs_btree_init(btree);\n\tif (nreq != NULL) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\t\tnilfs_bmap_commit_alloc_ptr(btree, nreq, dat);\n\n\t\t/* create child node at level 1 */\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_init(node, 0, 1, n, ncblk, keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr, ncblk);\n\t\tif (!buffer_dirty(bh))\n\t\t\tmark_buffer_dirty(bh);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\n\t\tbrelse(bh);\n\n\t\t/* create root node at level 2 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\ttmpptr = nreq->bpr_ptr;\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 2, 1,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      &keys[0], &tmpptr);\n\t} else {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\n\t\t/* create root node at level 1 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 1, n,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\t}\n\n\tif (NILFS_BMAP_USE_VBN(btree))\n\t\tnilfs_bmap_set_target_v(btree, key, dreq->bpr_ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_prepare_convert_and_insert",
          "args": [
            "btree",
            "key",
            "di",
            "ni",
            "&bh",
            "&stats"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_prepare_convert_and_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1670-1721",
          "snippet": "static int\nnilfs_btree_prepare_convert_and_insert(struct nilfs_bmap *btree, __u64 key,\n\t\t\t\t       union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t       union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t       struct buffer_head **bhp,\n\t\t\t\t       struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *dat = NULL;\n\tint ret;\n\n\tstats->bs_nblocks = 0;\n\n\t/* for data */\n\t/* cannot find near ptr */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdreq->bpr_ptr = nilfs_btree_find_target_v(btree, NULL, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, dreq, dat);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t*bhp = NULL;\n\tstats->bs_nblocks++;\n\tif (nreq != NULL) {\n\t\tnreq->bpr_ptr = dreq->bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree, nreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_dreq;\n\n\t\tret = nilfs_btree_get_new_block(btree, nreq->bpr_ptr, &bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_nreq;\n\n\t\t*bhp = bh;\n\t\tstats->bs_nblocks++;\n\t}\n\n\t/* success */\n\treturn 0;\n\n\t/* error */\n err_out_nreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, nreq, dat);\n err_out_dreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, dreq, dat);\n\tstats->bs_nblocks = 0;\n\treturn ret;\n\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int\nnilfs_btree_prepare_convert_and_insert(struct nilfs_bmap *btree, __u64 key,\n\t\t\t\t       union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t       union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t       struct buffer_head **bhp,\n\t\t\t\t       struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *dat = NULL;\n\tint ret;\n\n\tstats->bs_nblocks = 0;\n\n\t/* for data */\n\t/* cannot find near ptr */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdreq->bpr_ptr = nilfs_btree_find_target_v(btree, NULL, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, dreq, dat);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t*bhp = NULL;\n\tstats->bs_nblocks++;\n\tif (nreq != NULL) {\n\t\tnreq->bpr_ptr = dreq->bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree, nreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_dreq;\n\n\t\tret = nilfs_btree_get_new_block(btree, nreq->bpr_ptr, &bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_nreq;\n\n\t\t*bhp = bh;\n\t\tstats->bs_nblocks++;\n\t}\n\n\t/* success */\n\treturn 0;\n\n\t/* error */\n err_out_nreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, nreq, dat);\n err_out_dreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, dreq, dat);\n\tstats->bs_nblocks = 0;\n\treturn ret;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_BTREE_NODE_NCHILDREN_MAX",
          "args": [
            "1 << btree->b_inode->i_blkbits"
          ],
          "line": 1808
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nint nilfs_btree_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t   __u64 key, __u64 ptr,\n\t\t\t\t   const __u64 *keys, const __u64 *ptrs, int n)\n{\n\tstruct buffer_head *bh;\n\tunion nilfs_bmap_ptr_req dreq, nreq, *di, *ni;\n\tstruct nilfs_bmap_stats stats;\n\tint ret;\n\n\tif (n + 1 <= NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tdi = &dreq;\n\t\tni = NULL;\n\t} else if ((n + 1) <= NILFS_BTREE_NODE_NCHILDREN_MAX(\n\t\t\t   1 << btree->b_inode->i_blkbits)) {\n\t\tdi = &dreq;\n\t\tni = &nreq;\n\t} else {\n\t\tdi = NULL;\n\t\tni = NULL;\n\t\tBUG();\n\t}\n\n\tret = nilfs_btree_prepare_convert_and_insert(btree, key, di, ni, &bh,\n\t\t\t\t\t\t     &stats);\n\tif (ret < 0)\n\t\treturn ret;\n\tnilfs_btree_commit_convert_and_insert(btree, key, ptr, keys, ptrs, n,\n\t\t\t\t\t      di, ni, bh);\n\tnilfs_inode_add_blocks(btree->b_inode, stats.bs_nblocks);\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_commit_convert_and_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1723-1785",
    "snippet": "static void\nnilfs_btree_commit_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t      __u64 key, __u64 ptr,\n\t\t\t\t      const __u64 *keys, const __u64 *ptrs,\n\t\t\t\t      int n,\n\t\t\t\t      union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t      union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t      struct buffer_head *bh)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat;\n\t__u64 tmpptr;\n\tint ncblk;\n\n\t/* free resources */\n\tif (btree->b_ops->bop_clear != NULL)\n\t\tbtree->b_ops->bop_clear(btree);\n\n\t/* ptr must be a pointer to a buffer head. */\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\n\t/* convert and insert */\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\t__nilfs_btree_init(btree);\n\tif (nreq != NULL) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\t\tnilfs_bmap_commit_alloc_ptr(btree, nreq, dat);\n\n\t\t/* create child node at level 1 */\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_init(node, 0, 1, n, ncblk, keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr, ncblk);\n\t\tif (!buffer_dirty(bh))\n\t\t\tmark_buffer_dirty(bh);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\n\t\tbrelse(bh);\n\n\t\t/* create root node at level 2 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\ttmpptr = nreq->bpr_ptr;\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 2, 1,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      &keys[0], &tmpptr);\n\t} else {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\n\t\t/* create root node at level 1 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 1, n,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\t}\n\n\tif (NILFS_BMAP_USE_VBN(btree))\n\t\tnilfs_bmap_set_target_v(btree, key, dreq->bpr_ptr);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_set_target_v",
          "args": [
            "btree",
            "key",
            "dreq->bpr_ptr"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "237-242",
          "snippet": "static inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_set_dirty",
          "args": [
            "btree"
          ],
          "line": 1780
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "258-261",
          "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_dirty",
          "args": [
            "btree"
          ],
          "line": 1779
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "252-255",
          "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_insert",
          "args": [
            "node",
            "n",
            "key",
            "dreq->bpr_ptr",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "251-271",
          "snippet": "static void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_init",
          "args": [
            "node",
            "NILFS_BTREE_NODE_ROOT",
            "1",
            "n",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX",
            "keys",
            "ptrs"
          ],
          "line": 1774
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "174-192",
          "snippet": "static void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_commit_alloc_ptr",
          "args": [
            "btree",
            "dreq",
            "dat"
          ],
          "line": 1770
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_commit_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "195-201",
          "snippet": "static inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 1761
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "bh"
          ],
          "line": 1757
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nilfs_btree_init",
          "args": [
            "btree"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "__nilfs_btree_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "2327-2332",
          "snippet": "static void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __nilfs_btree_init(struct nilfs_bmap *bmap);",
            "static const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap);\nstatic const struct nilfs_bmap_operations nilfs_btree_ops = {\n\t.bop_lookup\t\t=\tnilfs_btree_lookup,\n\t.bop_lookup_contig\t=\tnilfs_btree_lookup_contig,\n\t.bop_insert\t\t=\tnilfs_btree_insert,\n\t.bop_delete\t\t=\tnilfs_btree_delete,\n\t.bop_clear\t\t=\tNULL,\n\n\t.bop_propagate\t\t=\tnilfs_btree_propagate,\n\n\t.bop_lookup_dirty_buffers =\tnilfs_btree_lookup_dirty_buffers,\n\n\t.bop_assign\t\t=\tnilfs_btree_assign,\n\t.bop_mark\t\t=\tnilfs_btree_mark,\n\n\t.bop_last_key\t\t=\tnilfs_btree_last_key,\n\t.bop_check_insert\t=\tNULL,\n\t.bop_check_delete\t=\tnilfs_btree_check_delete,\n\t.bop_gather_data\t=\tnilfs_btree_gather_data,\n};\n\nstatic void __nilfs_btree_init(struct nilfs_bmap *bmap)\n{\n\tbmap->b_ops = &nilfs_btree_ops;\n\tbmap->b_nchildren_per_block =\n\t\tNILFS_BTREE_NODE_NCHILDREN_MAX(nilfs_btree_node_size(bmap));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1745
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "(struct buffer_head *)((unsigned long)ptr)"
          ],
          "line": 1742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btree->b_ops->bop_clear",
          "args": [
            "btree"
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_commit_convert_and_insert(struct nilfs_bmap *btree,\n\t\t\t\t      __u64 key, __u64 ptr,\n\t\t\t\t      const __u64 *keys, const __u64 *ptrs,\n\t\t\t\t      int n,\n\t\t\t\t      union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t      union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t      struct buffer_head *bh)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat;\n\t__u64 tmpptr;\n\tint ncblk;\n\n\t/* free resources */\n\tif (btree->b_ops->bop_clear != NULL)\n\t\tbtree->b_ops->bop_clear(btree);\n\n\t/* ptr must be a pointer to a buffer head. */\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\n\t/* convert and insert */\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\t__nilfs_btree_init(btree);\n\tif (nreq != NULL) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\t\tnilfs_bmap_commit_alloc_ptr(btree, nreq, dat);\n\n\t\t/* create child node at level 1 */\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_init(node, 0, 1, n, ncblk, keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr, ncblk);\n\t\tif (!buffer_dirty(bh))\n\t\t\tmark_buffer_dirty(bh);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\n\t\tbrelse(bh);\n\n\t\t/* create root node at level 2 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\ttmpptr = nreq->bpr_ptr;\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 2, 1,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      &keys[0], &tmpptr);\n\t} else {\n\t\tnilfs_bmap_commit_alloc_ptr(btree, dreq, dat);\n\n\t\t/* create root node at level 1 */\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_init(node, NILFS_BTREE_NODE_ROOT, 1, n,\n\t\t\t\t      NILFS_BTREE_ROOT_NCHILDREN_MAX,\n\t\t\t\t      keys, ptrs);\n\t\tnilfs_btree_node_insert(node, n, key, dreq->bpr_ptr,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tif (!nilfs_bmap_dirty(btree))\n\t\t\tnilfs_bmap_set_dirty(btree);\n\t}\n\n\tif (NILFS_BMAP_USE_VBN(btree))\n\t\tnilfs_bmap_set_target_v(btree, key, dreq->bpr_ptr);\n}"
  },
  {
    "function_name": "nilfs_btree_prepare_convert_and_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1670-1721",
    "snippet": "static int\nnilfs_btree_prepare_convert_and_insert(struct nilfs_bmap *btree, __u64 key,\n\t\t\t\t       union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t       union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t       struct buffer_head **bhp,\n\t\t\t\t       struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *dat = NULL;\n\tint ret;\n\n\tstats->bs_nblocks = 0;\n\n\t/* for data */\n\t/* cannot find near ptr */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdreq->bpr_ptr = nilfs_btree_find_target_v(btree, NULL, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, dreq, dat);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t*bhp = NULL;\n\tstats->bs_nblocks++;\n\tif (nreq != NULL) {\n\t\tnreq->bpr_ptr = dreq->bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree, nreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_dreq;\n\n\t\tret = nilfs_btree_get_new_block(btree, nreq->bpr_ptr, &bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_nreq;\n\n\t\t*bhp = bh;\n\t\tstats->bs_nblocks++;\n\t}\n\n\t/* success */\n\treturn 0;\n\n\t/* error */\n err_out_nreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, nreq, dat);\n err_out_dreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, dreq, dat);\n\tstats->bs_nblocks = 0;\n\treturn ret;\n\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_abort_alloc_ptr",
          "args": [
            "btree",
            "dreq",
            "dat"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_abort_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "203-211",
          "snippet": "static inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_new_block",
          "args": [
            "btree",
            "nreq->bpr_ptr",
            "&bh"
          ],
          "line": 1702
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_new_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "71-84",
          "snippet": "static int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_prepare_alloc_ptr",
          "args": [
            "btree",
            "nreq",
            "dat"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_prepare_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "184-193",
          "snippet": "static inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1687
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_find_target_v",
          "args": [
            "btree",
            "NULL",
            "key"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_find_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "992-1010",
          "snippet": "static __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int\nnilfs_btree_prepare_convert_and_insert(struct nilfs_bmap *btree, __u64 key,\n\t\t\t\t       union nilfs_bmap_ptr_req *dreq,\n\t\t\t\t       union nilfs_bmap_ptr_req *nreq,\n\t\t\t\t       struct buffer_head **bhp,\n\t\t\t\t       struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *dat = NULL;\n\tint ret;\n\n\tstats->bs_nblocks = 0;\n\n\t/* for data */\n\t/* cannot find near ptr */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdreq->bpr_ptr = nilfs_btree_find_target_v(btree, NULL, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, dreq, dat);\n\tif (ret < 0)\n\t\treturn ret;\n\n\t*bhp = NULL;\n\tstats->bs_nblocks++;\n\tif (nreq != NULL) {\n\t\tnreq->bpr_ptr = dreq->bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree, nreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_dreq;\n\n\t\tret = nilfs_btree_get_new_block(btree, nreq->bpr_ptr, &bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_nreq;\n\n\t\t*bhp = bh;\n\t\tstats->bs_nblocks++;\n\t}\n\n\t/* success */\n\treturn 0;\n\n\t/* error */\n err_out_nreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, nreq, dat);\n err_out_dreq:\n\tnilfs_bmap_abort_alloc_ptr(btree, dreq, dat);\n\tstats->bs_nblocks = 0;\n\treturn ret;\n\n}"
  },
  {
    "function_name": "nilfs_btree_gather_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1621-1668",
    "snippet": "static int nilfs_btree_gather_data(struct nilfs_bmap *btree,\n\t\t\t\t   __u64 *keys, __u64 *ptrs, int nitems)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *root;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\t__u64 ptr;\n\tint nchildren, ncmax, i, ret;\n\n\troot = nilfs_btree_get_root(btree);\n\tswitch (nilfs_btree_height(btree)) {\n\tcase 2:\n\t\tbh = NULL;\n\t\tnode = root;\n\t\tncmax = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t\tbreak;\n\tcase 3:\n\t\tnchildren = nilfs_btree_node_get_nchildren(root);\n\t\tWARN_ON(nchildren > 1);\n\t\tptr = nilfs_btree_node_get_ptr(root, nchildren - 1,\n\t\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncmax = nilfs_btree_nchildren_per_block(btree);\n\t\tbreak;\n\tdefault:\n\t\tnode = NULL;\n\t\treturn -EINVAL;\n\t}\n\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (nchildren < nitems)\n\t\tnitems = nchildren;\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nitems; i++) {\n\t\tkeys[i] = le64_to_cpu(dkeys[i]);\n\t\tptrs[i] = le64_to_cpu(dptrs[i]);\n\t}\n\n\tif (bh != NULL)\n\t\tbrelse(bh);\n\n\treturn nitems;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 1665
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "dptrs[i]"
          ],
          "line": 1661
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 1658
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 1654
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "&bh"
          ],
          "line": 1643
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "root",
            "nchildren - 1",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1641
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "nchildren > 1"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1631
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_gather_data(struct nilfs_bmap *btree,\n\t\t\t\t   __u64 *keys, __u64 *ptrs, int nitems)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *root;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\t__u64 ptr;\n\tint nchildren, ncmax, i, ret;\n\n\troot = nilfs_btree_get_root(btree);\n\tswitch (nilfs_btree_height(btree)) {\n\tcase 2:\n\t\tbh = NULL;\n\t\tnode = root;\n\t\tncmax = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t\tbreak;\n\tcase 3:\n\t\tnchildren = nilfs_btree_node_get_nchildren(root);\n\t\tWARN_ON(nchildren > 1);\n\t\tptr = nilfs_btree_node_get_ptr(root, nchildren - 1,\n\t\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tncmax = nilfs_btree_nchildren_per_block(btree);\n\t\tbreak;\n\tdefault:\n\t\tnode = NULL;\n\t\treturn -EINVAL;\n\t}\n\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (nchildren < nitems)\n\t\tnitems = nchildren;\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nitems; i++) {\n\t\tkeys[i] = le64_to_cpu(dkeys[i]);\n\t\tptrs[i] = le64_to_cpu(dptrs[i]);\n\t}\n\n\tif (bh != NULL)\n\t\tbrelse(bh);\n\n\treturn nitems;\n}"
  },
  {
    "function_name": "nilfs_btree_check_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1582-1619",
    "snippet": "static int nilfs_btree_check_delete(struct nilfs_bmap *btree, __u64 key)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *root, *node;\n\t__u64 maxkey, nextmaxkey;\n\t__u64 ptr;\n\tint nchildren, ret;\n\n\troot = nilfs_btree_get_root(btree);\n\tswitch (nilfs_btree_height(btree)) {\n\tcase 2:\n\t\tbh = NULL;\n\t\tnode = root;\n\t\tbreak;\n\tcase 3:\n\t\tnchildren = nilfs_btree_node_get_nchildren(root);\n\t\tif (nchildren > 1)\n\t\t\treturn 0;\n\t\tptr = nilfs_btree_node_get_ptr(root, nchildren - 1,\n\t\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tmaxkey = nilfs_btree_node_get_key(node, nchildren - 1);\n\tnextmaxkey = (nchildren > 1) ?\n\t\tnilfs_btree_node_get_key(node, nchildren - 2) : 0;\n\tif (bh != NULL)\n\t\tbrelse(bh);\n\n\treturn (maxkey == key) && (nextmaxkey < NILFS_BMAP_LARGE_LOW);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "nchildren - 2"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "&bh"
          ],
          "line": 1602
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "root",
            "nchildren - 1",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1600
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1590
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_check_delete(struct nilfs_bmap *btree, __u64 key)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *root, *node;\n\t__u64 maxkey, nextmaxkey;\n\t__u64 ptr;\n\tint nchildren, ret;\n\n\troot = nilfs_btree_get_root(btree);\n\tswitch (nilfs_btree_height(btree)) {\n\tcase 2:\n\t\tbh = NULL;\n\t\tnode = root;\n\t\tbreak;\n\tcase 3:\n\t\tnchildren = nilfs_btree_node_get_nchildren(root);\n\t\tif (nchildren > 1)\n\t\t\treturn 0;\n\t\tptr = nilfs_btree_node_get_ptr(root, nchildren - 1,\n\t\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t\tret = nilfs_btree_get_block(btree, ptr, &bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = (struct nilfs_btree_node *)bh->b_data;\n\t\tbreak;\n\tdefault:\n\t\treturn 0;\n\t}\n\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tmaxkey = nilfs_btree_node_get_key(node, nchildren - 1);\n\tnextmaxkey = (nchildren > 1) ?\n\t\tnilfs_btree_node_get_key(node, nchildren - 2) : 0;\n\tif (bh != NULL)\n\t\tbrelse(bh);\n\n\treturn (maxkey == key) && (nextmaxkey < NILFS_BMAP_LARGE_LOW);\n}"
  },
  {
    "function_name": "nilfs_btree_last_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1566-1580",
    "snippet": "static int nilfs_btree_last_key(const struct nilfs_bmap *btree, __u64 *keyp)\n{\n\tstruct nilfs_btree_path *path;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup_last(btree, path, keyp, NULL);\n\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 1577
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup_last",
          "args": [
            "btree",
            "path",
            "keyp",
            "NULL"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup_last",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "597-634",
          "snippet": "static int nilfs_btree_do_lookup_last(const struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 ptr;\n\tint index, level, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\tif (index < 0)\n\t\treturn -ENOENT;\n\tlevel = nilfs_btree_node_get_level(node);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level--; level > 0; level--) {\n\t\tret = nilfs_btree_get_block(btree, ptr, &path[level].bp_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\tpath[level].bp_index = index;\n\t}\n\n\tif (keyp != NULL)\n\t\t*keyp = nilfs_btree_node_get_key(node, index);\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup_last(const struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 ptr;\n\tint index, level, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\tif (index < 0)\n\t\treturn -ENOENT;\n\tlevel = nilfs_btree_node_get_level(node);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level--; level > 0; level--) {\n\t\tret = nilfs_btree_get_block(btree, ptr, &path[level].bp_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\tpath[level].bp_index = index;\n\t}\n\n\tif (keyp != NULL)\n\t\t*keyp = nilfs_btree_node_get_key(node, index);\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 1571
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_last_key(const struct nilfs_bmap *btree, __u64 *keyp)\n{\n\tstruct nilfs_btree_path *path;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup_last(btree, path, keyp, NULL);\n\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1535-1564",
    "snippet": "static int nilfs_btree_delete(struct nilfs_bmap *btree, __u64 key)\n\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_bmap_stats stats;\n\tstruct inode *dat;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL,\n\t\t\t\t    NILFS_BTREE_LEVEL_NODE_MIN, 0);\n\tif (ret < 0)\n\t\tgoto out;\n\n\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\n\tret = nilfs_btree_prepare_delete(btree, path, &level, &stats, dat);\n\tif (ret < 0)\n\t\tgoto out;\n\tnilfs_btree_commit_delete(btree, path, level, dat);\n\tnilfs_inode_sub_blocks(btree->b_inode, stats.bs_nblocks);\n\nout:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 1562
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_inode_sub_blocks",
          "args": [
            "btree->b_inode",
            "stats.bs_nblocks"
          ],
          "line": 1559
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_inode_sub_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "63-70",
          "snippet": "void nilfs_inode_sub_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_sub_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_sub(n, &root->blocks_count);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_inode_sub_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_sub_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_sub(n, &root->blocks_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_commit_delete",
          "args": [
            "btree",
            "path",
            "level",
            "dat"
          ],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_commit_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1520-1533",
          "snippet": "static void nilfs_btree_commit_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, struct inode *dat)\n{\n\tint level;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t\tpath[level].bp_op(btree, path, level, NULL, NULL);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, struct inode *dat)\n{\n\tint level;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t\tpath[level].bp_op(btree, path, level, NULL, NULL);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_prepare_delete",
          "args": [
            "btree",
            "path",
            "&level",
            "&stats",
            "dat"
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_prepare_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1385-1518",
          "snippet": "static int nilfs_btree_prepare_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp,\n\t\t\t\t      struct nilfs_bmap_stats *stats,\n\t\t\t\t      struct inode *dat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, dindex, level, ncmin, ncmax, ncblk, ret;\n\n\tret = 0;\n\tstats->bs_nblocks = 0;\n\tncmin = NILFS_BTREE_NODE_NCHILDREN_MIN(nilfs_btree_node_size(btree));\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN, dindex = path[level].bp_index;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tpath[level].bp_oldreq.bpr_ptr =\n\t\t\tnilfs_btree_node_get_ptr(node, dindex, ncblk);\n\t\tret = nilfs_bmap_prepare_end_ptr(btree,\n\t\t\t\t\t\t &path[level].bp_oldreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\n\t\tif (nilfs_btree_node_get_nchildren(node) > ncmin) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\t\tdindex = pindex;\n\n\t\tif (pindex > 0) {\n\t\t\t/* left sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else if (pindex <\n\t\t\t   nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\t/* right sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/*\n\t\t\t\t * When merging right sibling node\n\t\t\t\t * into the current node, pointer to\n\t\t\t\t * the right sibling node must be\n\t\t\t\t * terminated instead.  The adjustment\n\t\t\t\t * below is required for that.\n\t\t\t\t */\n\t\t\t\tdindex = pindex + 1;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else {\n\t\t\t/* no siblings */\n\t\t\t/* the only child of the root node */\n\t\t\tWARN_ON(level != nilfs_btree_height(btree) - 2);\n\t\t\tif (nilfs_btree_node_get_nchildren(node) - 1 <=\n\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\t\t\tpath[level].bp_op = nilfs_btree_shrink;\n\t\t\t\tstats->bs_nblocks += 2;\n\t\t\t\tlevel++;\n\t\t\t\tpath[level].bp_op = nilfs_btree_nop;\n\t\t\t\tgoto shrink_root_child;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* child of the root node is deleted */\n\tpath[level].bp_op = nilfs_btree_do_delete;\n\tstats->bs_nblocks++;\n\nshrink_root_child:\n\tnode = nilfs_btree_get_root(btree);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(node, dindex,\n\t\t\t\t\t NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\n\tret = nilfs_bmap_prepare_end_ptr(btree, &path[level].bp_oldreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n err_out_child_node:\n\tfor (level--; level >= NILFS_BTREE_LEVEL_NODE_MIN; level--) {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t}\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp,\n\t\t\t\t      struct nilfs_bmap_stats *stats,\n\t\t\t\t      struct inode *dat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, dindex, level, ncmin, ncmax, ncblk, ret;\n\n\tret = 0;\n\tstats->bs_nblocks = 0;\n\tncmin = NILFS_BTREE_NODE_NCHILDREN_MIN(nilfs_btree_node_size(btree));\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN, dindex = path[level].bp_index;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tpath[level].bp_oldreq.bpr_ptr =\n\t\t\tnilfs_btree_node_get_ptr(node, dindex, ncblk);\n\t\tret = nilfs_bmap_prepare_end_ptr(btree,\n\t\t\t\t\t\t &path[level].bp_oldreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\n\t\tif (nilfs_btree_node_get_nchildren(node) > ncmin) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\t\tdindex = pindex;\n\n\t\tif (pindex > 0) {\n\t\t\t/* left sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else if (pindex <\n\t\t\t   nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\t/* right sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/*\n\t\t\t\t * When merging right sibling node\n\t\t\t\t * into the current node, pointer to\n\t\t\t\t * the right sibling node must be\n\t\t\t\t * terminated instead.  The adjustment\n\t\t\t\t * below is required for that.\n\t\t\t\t */\n\t\t\t\tdindex = pindex + 1;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else {\n\t\t\t/* no siblings */\n\t\t\t/* the only child of the root node */\n\t\t\tWARN_ON(level != nilfs_btree_height(btree) - 2);\n\t\t\tif (nilfs_btree_node_get_nchildren(node) - 1 <=\n\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\t\t\tpath[level].bp_op = nilfs_btree_shrink;\n\t\t\t\tstats->bs_nblocks += 2;\n\t\t\t\tlevel++;\n\t\t\t\tpath[level].bp_op = nilfs_btree_nop;\n\t\t\t\tgoto shrink_root_child;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* child of the root node is deleted */\n\tpath[level].bp_op = nilfs_btree_do_delete;\n\tstats->bs_nblocks++;\n\nshrink_root_child:\n\tnode = nilfs_btree_get_root(btree);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(node, dindex,\n\t\t\t\t\t NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\n\tret = nilfs_bmap_prepare_end_ptr(btree, &path[level].bp_oldreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n err_out_child_node:\n\tfor (level--; level >= NILFS_BTREE_LEVEL_NODE_MIN; level--) {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t}\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1553
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "NULL",
            "NILFS_BTREE_LEVEL_NODE_MIN",
            "0"
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 1543
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_delete(struct nilfs_bmap *btree, __u64 key)\n\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_bmap_stats stats;\n\tstruct inode *dat;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL,\n\t\t\t\t    NILFS_BTREE_LEVEL_NODE_MIN, 0);\n\tif (ret < 0)\n\t\tgoto out;\n\n\n\tdat = NILFS_BMAP_USE_VBN(btree) ? nilfs_bmap_get_dat(btree) : NULL;\n\n\tret = nilfs_btree_prepare_delete(btree, path, &level, &stats, dat);\n\tif (ret < 0)\n\t\tgoto out;\n\tnilfs_btree_commit_delete(btree, path, level, dat);\n\tnilfs_inode_sub_blocks(btree->b_inode, stats.bs_nblocks);\n\nout:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_commit_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1520-1533",
    "snippet": "static void nilfs_btree_commit_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, struct inode *dat)\n{\n\tint level;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t\tpath[level].bp_op(btree, path, level, NULL, NULL);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_set_dirty",
          "args": [
            "btree"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "258-261",
          "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_dirty",
          "args": [
            "btree"
          ],
          "line": 1531
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "252-255",
          "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "path[level].bp_op",
          "args": [
            "btree",
            "path",
            "level",
            "NULL",
            "NULL"
          ],
          "line": 1528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_commit_end_ptr",
          "args": [
            "btree",
            "&path[level].bp_oldreq",
            "dat"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_commit_end_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "220-227",
          "snippet": "static inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_PTR_VS\t1\t/* virtual block number (single\n\t\t\t\t\t   version) */\n\nstatic inline void nilfs_bmap_commit_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_end(dat, &req->bpr_req,\n\t\t\t\t     bmap->b_ptr_type == NILFS_BMAP_PTR_VS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, struct inode *dat)\n{\n\tint level;\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t\tpath[level].bp_op(btree, path, level, NULL, NULL);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}"
  },
  {
    "function_name": "nilfs_btree_prepare_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1385-1518",
    "snippet": "static int nilfs_btree_prepare_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp,\n\t\t\t\t      struct nilfs_bmap_stats *stats,\n\t\t\t\t      struct inode *dat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, dindex, level, ncmin, ncmax, ncblk, ret;\n\n\tret = 0;\n\tstats->bs_nblocks = 0;\n\tncmin = NILFS_BTREE_NODE_NCHILDREN_MIN(nilfs_btree_node_size(btree));\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN, dindex = path[level].bp_index;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tpath[level].bp_oldreq.bpr_ptr =\n\t\t\tnilfs_btree_node_get_ptr(node, dindex, ncblk);\n\t\tret = nilfs_bmap_prepare_end_ptr(btree,\n\t\t\t\t\t\t &path[level].bp_oldreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\n\t\tif (nilfs_btree_node_get_nchildren(node) > ncmin) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\t\tdindex = pindex;\n\n\t\tif (pindex > 0) {\n\t\t\t/* left sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else if (pindex <\n\t\t\t   nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\t/* right sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/*\n\t\t\t\t * When merging right sibling node\n\t\t\t\t * into the current node, pointer to\n\t\t\t\t * the right sibling node must be\n\t\t\t\t * terminated instead.  The adjustment\n\t\t\t\t * below is required for that.\n\t\t\t\t */\n\t\t\t\tdindex = pindex + 1;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else {\n\t\t\t/* no siblings */\n\t\t\t/* the only child of the root node */\n\t\t\tWARN_ON(level != nilfs_btree_height(btree) - 2);\n\t\t\tif (nilfs_btree_node_get_nchildren(node) - 1 <=\n\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\t\t\tpath[level].bp_op = nilfs_btree_shrink;\n\t\t\t\tstats->bs_nblocks += 2;\n\t\t\t\tlevel++;\n\t\t\t\tpath[level].bp_op = nilfs_btree_nop;\n\t\t\t\tgoto shrink_root_child;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* child of the root node is deleted */\n\tpath[level].bp_op = nilfs_btree_do_delete;\n\tstats->bs_nblocks++;\n\nshrink_root_child:\n\tnode = nilfs_btree_get_root(btree);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(node, dindex,\n\t\t\t\t\t NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\n\tret = nilfs_bmap_prepare_end_ptr(btree, &path[level].bp_oldreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n err_out_child_node:\n\tfor (level--; level >= NILFS_BTREE_LEVEL_NODE_MIN; level--) {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t}\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_abort_end_ptr",
          "args": [
            "btree",
            "&path[level].bp_oldreq",
            "dat"
          ],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_abort_end_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "229-235",
          "snippet": "static inline void nilfs_bmap_abort_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t    union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t    struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_end(dat, &req->bpr_req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_abort_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t    union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t    struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_end(dat, &req->bpr_req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_prepare_end_ptr",
          "args": [
            "btree",
            "&path[level].bp_oldreq",
            "dat"
          ],
          "line": 1498
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_prepare_end_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "213-218",
          "snippet": "static inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_end_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t     union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t     struct inode *dat)\n{\n\treturn dat ? nilfs_dat_prepare_end(dat, &req->bpr_req) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "node",
            "dindex",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1495
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1493
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "level != nilfs_btree_height(btree) - 2"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "sibptr",
            "&bh"
          ],
          "line": 1446
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 1418
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BTREE_NODE_NCHILDREN_MIN",
          "args": [
            "nilfs_btree_node_size(btree)"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_size",
          "args": [
            "btree"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "124-127",
          "snippet": "static int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_delete(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp,\n\t\t\t\t      struct nilfs_bmap_stats *stats,\n\t\t\t\t      struct inode *dat)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, dindex, level, ncmin, ncmax, ncblk, ret;\n\n\tret = 0;\n\tstats->bs_nblocks = 0;\n\tncmin = NILFS_BTREE_NODE_NCHILDREN_MIN(nilfs_btree_node_size(btree));\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN, dindex = path[level].bp_index;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tpath[level].bp_oldreq.bpr_ptr =\n\t\t\tnilfs_btree_node_get_ptr(node, dindex, ncblk);\n\t\tret = nilfs_bmap_prepare_end_ptr(btree,\n\t\t\t\t\t\t &path[level].bp_oldreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\n\t\tif (nilfs_btree_node_get_nchildren(node) > ncmin) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\t\tdindex = pindex;\n\n\t\tif (pindex > 0) {\n\t\t\t/* left sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else if (pindex <\n\t\t\t   nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\t/* right sibling */\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_curr_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) > ncmin) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_borrow_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_concat_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\t/*\n\t\t\t\t * When merging right sibling node\n\t\t\t\t * into the current node, pointer to\n\t\t\t\t * the right sibling node must be\n\t\t\t\t * terminated instead.  The adjustment\n\t\t\t\t * below is required for that.\n\t\t\t\t */\n\t\t\t\tdindex = pindex + 1;\n\t\t\t\t/* continue; */\n\t\t\t}\n\t\t} else {\n\t\t\t/* no siblings */\n\t\t\t/* the only child of the root node */\n\t\t\tWARN_ON(level != nilfs_btree_height(btree) - 2);\n\t\t\tif (nilfs_btree_node_get_nchildren(node) - 1 <=\n\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\t\t\tpath[level].bp_op = nilfs_btree_shrink;\n\t\t\t\tstats->bs_nblocks += 2;\n\t\t\t\tlevel++;\n\t\t\t\tpath[level].bp_op = nilfs_btree_nop;\n\t\t\t\tgoto shrink_root_child;\n\t\t\t} else {\n\t\t\t\tpath[level].bp_op = nilfs_btree_do_delete;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* child of the root node is deleted */\n\tpath[level].bp_op = nilfs_btree_do_delete;\n\tstats->bs_nblocks++;\n\nshrink_root_child:\n\tnode = nilfs_btree_get_root(btree);\n\tpath[level].bp_oldreq.bpr_ptr =\n\t\tnilfs_btree_node_get_ptr(node, dindex,\n\t\t\t\t\t NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\n\tret = nilfs_bmap_prepare_end_ptr(btree, &path[level].bp_oldreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n err_out_child_node:\n\tfor (level--; level >= NILFS_BTREE_LEVEL_NODE_MIN; level--) {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_end_ptr(btree, &path[level].bp_oldreq, dat);\n\t}\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_nop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1379-1383",
    "snippet": "static void nilfs_btree_nop(struct nilfs_bmap *btree,\n\t\t\t    struct nilfs_btree_path *path,\n\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_nop(struct nilfs_bmap *btree,\n\t\t\t    struct nilfs_btree_path *path,\n\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n}"
  },
  {
    "function_name": "nilfs_btree_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1355-1377",
    "snippet": "static void nilfs_btree_shrink(struct nilfs_bmap *btree,\n\t\t\t       struct nilfs_btree_path *path,\n\t\t\t       int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *root, *child;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\troot = nilfs_btree_get_root(btree);\n\tchild = nilfs_btree_get_nonroot_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tnilfs_btree_node_delete(root, 0, NULL, NULL,\n\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tnilfs_btree_node_set_level(root, level);\n\tn = nilfs_btree_node_get_nchildren(child);\n\tnilfs_btree_node_move_left(root, child, n,\n\t\t\t\t   NILFS_BTREE_ROOT_NCHILDREN_MAX, ncblk);\n\n\tnilfs_btnode_delete(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btnode_delete",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "142-161",
          "snippet": "void nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_left",
          "args": [
            "root",
            "child",
            "n",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX",
            "ncblk"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "195-220",
          "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "child"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_level",
          "args": [
            "root",
            "level"
          ],
          "line": 1370
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "107-111",
          "snippet": "static void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_delete",
          "args": [
            "root",
            "0",
            "NULL",
            "NULL",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1368
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "274-301",
          "snippet": "static void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1366
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1364
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_delete",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1214-1237",
          "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_shrink(struct nilfs_bmap *btree,\n\t\t\t       struct nilfs_btree_path *path,\n\t\t\t       int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *root, *child;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\troot = nilfs_btree_get_root(btree);\n\tchild = nilfs_btree_get_nonroot_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tnilfs_btree_node_delete(root, 0, NULL, NULL,\n\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tnilfs_btree_node_set_level(root, level);\n\tn = nilfs_btree_node_get_nchildren(child);\n\tnilfs_btree_node_move_left(root, child, n,\n\t\t\t\t   NILFS_BTREE_ROOT_NCHILDREN_MAX, ncblk);\n\n\tnilfs_btnode_delete(path[level].bp_bh);\n\tpath[level].bp_bh = NULL;\n}"
  },
  {
    "function_name": "nilfs_btree_concat_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1330-1353",
    "snippet": "static void nilfs_btree_concat_right(struct nilfs_bmap *btree,\n\t\t\t\t     struct nilfs_btree_path *path,\n\t\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(right);\n\n\tnilfs_btree_node_move_left(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level + 1].bp_index++;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btnode_delete",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1350
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "142-161",
          "snippet": "void nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_left",
          "args": [
            "node",
            "right",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "195-220",
          "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "right"
          ],
          "line": 1343
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_delete",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1214-1237",
          "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_concat_right(struct nilfs_bmap *btree,\n\t\t\t\t     struct nilfs_btree_path *path,\n\t\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(right);\n\n\tnilfs_btree_node_move_left(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level + 1].bp_index++;\n}"
  },
  {
    "function_name": "nilfs_btree_concat_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1304-1328",
    "snippet": "static void nilfs_btree_concat_left(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(node);\n\n\tnilfs_btree_node_move_left(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btnode_delete(path[level].bp_bh);\n\tpath[level].bp_bh = path[level].bp_sib_bh;\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level].bp_index += nilfs_btree_node_get_nchildren(left);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "left"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_delete",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "142-161",
          "snippet": "void nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_left",
          "args": [
            "left",
            "node",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "195-220",
          "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1315
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1313
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_delete",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 1311
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1214-1237",
          "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_concat_left(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(node);\n\n\tnilfs_btree_node_move_left(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btnode_delete(path[level].bp_bh);\n\tpath[level].bp_bh = path[level].bp_sib_bh;\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level].bp_index += nilfs_btree_node_get_nchildren(left);\n}"
  },
  {
    "function_name": "nilfs_btree_borrow_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1271-1302",
    "snippet": "static void nilfs_btree_borrow_right(struct nilfs_bmap *btree,\n\t\t\t\t     struct nilfs_btree_path *path,\n\t\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint nchildren, rnchildren, n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = (nchildren + rnchildren) / 2 - nchildren;\n\n\tnilfs_btree_node_move_left(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level + 1].bp_index++;\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(right, 0));\n\tpath[level + 1].bp_index--;\n\n\tbrelse(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1300
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(right, 0)"
          ],
          "line": 1296
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "right",
            "0"
          ],
          "line": 1297
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1293
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_left",
          "args": [
            "node",
            "right",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 1288
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "195-220",
          "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "right"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1281
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_delete",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1214-1237",
          "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_borrow_right(struct nilfs_bmap *btree,\n\t\t\t\t     struct nilfs_btree_path *path,\n\t\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint nchildren, rnchildren, n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = (nchildren + rnchildren) / 2 - nchildren;\n\n\tnilfs_btree_node_move_left(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level + 1].bp_index++;\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(right, 0));\n\tpath[level + 1].bp_index--;\n\n\tbrelse(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n}"
  },
  {
    "function_name": "nilfs_btree_borrow_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1239-1269",
    "snippet": "static void nilfs_btree_borrow_left(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint nchildren, lnchildren, n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = (nchildren + lnchildren) / 2 - nchildren;\n\n\tnilfs_btree_node_move_right(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\n\tbrelse(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level].bp_index += n;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(node, 0)"
          ],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 1264
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_right",
          "args": [
            "left",
            "node",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 1256
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_right",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "223-248",
          "snippet": "static void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "left"
          ],
          "line": 1251
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_delete",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1214-1237",
          "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_borrow_left(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint nchildren, lnchildren, n, ncblk;\n\n\tnilfs_btree_do_delete(btree, path, level, keyp, ptrp);\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = (nchildren + lnchildren) / 2 - nchildren;\n\n\tnilfs_btree_node_move_right(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\n\tbrelse(path[level].bp_sib_bh);\n\tpath[level].bp_sib_bh = NULL;\n\tpath[level].bp_index += n;\n}"
  },
  {
    "function_name": "nilfs_btree_do_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1214-1237",
    "snippet": "static void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_delete",
          "args": [
            "node",
            "path[level].bp_index",
            "keyp",
            "ptrp",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "274-301",
          "snippet": "static void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(node, 0)"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1223
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_delete(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_delete(node, path[level].bp_index,\n\t\t\t\t\tkeyp, ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
  },
  {
    "function_name": "nilfs_btree_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1185-1212",
    "snippet": "static int nilfs_btree_insert(struct nilfs_bmap *btree, __u64 key, __u64 ptr)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_bmap_stats stats;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL,\n\t\t\t\t    NILFS_BTREE_LEVEL_NODE_MIN, 0);\n\tif (ret != -ENOENT) {\n\t\tif (ret == 0)\n\t\t\tret = -EEXIST;\n\t\tgoto out;\n\t}\n\n\tret = nilfs_btree_prepare_insert(btree, path, &level, key, ptr, &stats);\n\tif (ret < 0)\n\t\tgoto out;\n\tnilfs_btree_commit_insert(btree, path, level, key, ptr);\n\tnilfs_inode_add_blocks(btree->b_inode, stats.bs_nblocks);\n\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_inode_add_blocks",
          "args": [
            "btree->b_inode",
            "stats.bs_nblocks"
          ],
          "line": 1207
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_inode_add_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/inode.c",
          "lines": "54-61",
          "snippet": "void nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}",
          "includes": [
            "#include \"ifile.h\"",
            "#include \"cpfile.h\"",
            "#include \"mdt.h\"",
            "#include \"page.h\"",
            "#include \"segment.h\"",
            "#include \"btnode.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/aio.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/gfp.h>",
            "#include <linux/buffer_head.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ifile.h\"\n#include \"cpfile.h\"\n#include \"mdt.h\"\n#include \"page.h\"\n#include \"segment.h\"\n#include \"btnode.h\"\n#include \"nilfs.h\"\n#include <linux/aio.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/mpage.h>\n#include <linux/gfp.h>\n#include <linux/buffer_head.h>\n\nvoid nilfs_inode_add_blocks(struct inode *inode, int n)\n{\n\tstruct nilfs_root *root = NILFS_I(inode)->i_root;\n\n\tinode_add_bytes(inode, (1 << inode->i_blkbits) * n);\n\tif (root)\n\t\tatomic64_add(n, &root->blocks_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_commit_insert",
          "args": [
            "btree",
            "path",
            "level",
            "key",
            "ptr"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_commit_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1161-1183",
          "snippet": "static void nilfs_btree_commit_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, __u64 key, __u64 ptr)\n{\n\tstruct inode *dat = NULL;\n\tint level;\n\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\tptr = path[NILFS_BTREE_LEVEL_DATA].bp_newreq.bpr_ptr;\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tnilfs_bmap_set_target_v(btree, key, ptr);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree,\n\t\t\t\t\t    &path[level - 1].bp_newreq, dat);\n\t\tpath[level].bp_op(btree, path, level, &key, &ptr);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, __u64 key, __u64 ptr)\n{\n\tstruct inode *dat = NULL;\n\tint level;\n\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\tptr = path[NILFS_BTREE_LEVEL_DATA].bp_newreq.bpr_ptr;\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tnilfs_bmap_set_target_v(btree, key, ptr);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree,\n\t\t\t\t\t    &path[level - 1].bp_newreq, dat);\n\t\tpath[level].bp_op(btree, path, level, &key, &ptr);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_prepare_insert",
          "args": [
            "btree",
            "path",
            "&level",
            "key",
            "ptr",
            "&stats"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_prepare_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "1012-1159",
          "snippet": "static int nilfs_btree_prepare_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp, __u64 key, __u64 ptr,\n\t\t\t\t      struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, level, ncmax, ncblk, ret;\n\tstruct inode *dat = NULL;\n\n\tstats->bs_nblocks = 0;\n\tlevel = NILFS_BTREE_LEVEL_DATA;\n\n\t/* allocate a new ptr for data block */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tnilfs_btree_find_target_v(btree, path, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_data;\n\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_node_get_nchildren(node) < ncblk) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\n\t\t/* left sibling */\n\t\tif (pindex > 0) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* right sibling */\n\t\tif (pindex < nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* split */\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tpath[level - 1].bp_newreq.bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree,\n\t\t\t\t\t\t   &path[level].bp_newreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\t\tret = nilfs_btree_get_new_block(btree,\n\t\t\t\t\t\tpath[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t\t&bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_curr_node;\n\n\t\tstats->bs_nblocks++;\n\n\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\tnilfs_btree_node_init(sib, 0, level, 0, ncblk, NULL, NULL);\n\t\tpath[level].bp_sib_bh = bh;\n\t\tpath[level].bp_op = nilfs_btree_split;\n\t}\n\n\t/* root */\n\tnode = nilfs_btree_get_root(btree);\n\tif (nilfs_btree_node_get_nchildren(node) <\n\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\tstats->bs_nblocks++;\n\t\tgoto out;\n\t}\n\n\t/* grow */\n\tpath[level].bp_newreq.bpr_ptr = path[level - 1].bp_newreq.bpr_ptr + 1;\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\tret = nilfs_btree_get_new_block(btree, path[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t&bh);\n\tif (ret < 0)\n\t\tgoto err_out_curr_node;\n\n\tnilfs_btree_node_init((struct nilfs_btree_node *)bh->b_data,\n\t\t\t      0, level, 0, ncblk, NULL, NULL);\n\tpath[level].bp_sib_bh = bh;\n\tpath[level].bp_op = nilfs_btree_grow;\n\n\tlevel++;\n\tpath[level].bp_op = nilfs_btree_do_insert;\n\n\t/* a newly-created node block and a data block are added */\n\tstats->bs_nblocks += 2;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_child_node:\n\tfor (level--; level > NILFS_BTREE_LEVEL_DATA; level--) {\n\t\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\n\t}\n\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_data:\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp, __u64 key, __u64 ptr,\n\t\t\t\t      struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, level, ncmax, ncblk, ret;\n\tstruct inode *dat = NULL;\n\n\tstats->bs_nblocks = 0;\n\tlevel = NILFS_BTREE_LEVEL_DATA;\n\n\t/* allocate a new ptr for data block */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tnilfs_btree_find_target_v(btree, path, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_data;\n\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_node_get_nchildren(node) < ncblk) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\n\t\t/* left sibling */\n\t\tif (pindex > 0) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* right sibling */\n\t\tif (pindex < nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* split */\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tpath[level - 1].bp_newreq.bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree,\n\t\t\t\t\t\t   &path[level].bp_newreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\t\tret = nilfs_btree_get_new_block(btree,\n\t\t\t\t\t\tpath[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t\t&bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_curr_node;\n\n\t\tstats->bs_nblocks++;\n\n\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\tnilfs_btree_node_init(sib, 0, level, 0, ncblk, NULL, NULL);\n\t\tpath[level].bp_sib_bh = bh;\n\t\tpath[level].bp_op = nilfs_btree_split;\n\t}\n\n\t/* root */\n\tnode = nilfs_btree_get_root(btree);\n\tif (nilfs_btree_node_get_nchildren(node) <\n\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\tstats->bs_nblocks++;\n\t\tgoto out;\n\t}\n\n\t/* grow */\n\tpath[level].bp_newreq.bpr_ptr = path[level - 1].bp_newreq.bpr_ptr + 1;\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\tret = nilfs_btree_get_new_block(btree, path[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t&bh);\n\tif (ret < 0)\n\t\tgoto err_out_curr_node;\n\n\tnilfs_btree_node_init((struct nilfs_btree_node *)bh->b_data,\n\t\t\t      0, level, 0, ncblk, NULL, NULL);\n\tpath[level].bp_sib_bh = bh;\n\tpath[level].bp_op = nilfs_btree_grow;\n\n\tlevel++;\n\tpath[level].bp_op = nilfs_btree_do_insert;\n\n\t/* a newly-created node block and a data block are added */\n\tstats->bs_nblocks += 2;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_child_node:\n\tfor (level--; level > NILFS_BTREE_LEVEL_DATA; level--) {\n\t\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\n\t}\n\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_data:\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "NULL",
            "NILFS_BTREE_LEVEL_NODE_MIN",
            "0"
          ],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_insert(struct nilfs_bmap *btree, __u64 key, __u64 ptr)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_bmap_stats stats;\n\tint level, ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, NULL,\n\t\t\t\t    NILFS_BTREE_LEVEL_NODE_MIN, 0);\n\tif (ret != -ENOENT) {\n\t\tif (ret == 0)\n\t\t\tret = -EEXIST;\n\t\tgoto out;\n\t}\n\n\tret = nilfs_btree_prepare_insert(btree, path, &level, key, ptr, &stats);\n\tif (ret < 0)\n\t\tgoto out;\n\tnilfs_btree_commit_insert(btree, path, level, key, ptr);\n\tnilfs_inode_add_blocks(btree->b_inode, stats.bs_nblocks);\n\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_commit_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1161-1183",
    "snippet": "static void nilfs_btree_commit_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, __u64 key, __u64 ptr)\n{\n\tstruct inode *dat = NULL;\n\tint level;\n\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\tptr = path[NILFS_BTREE_LEVEL_DATA].bp_newreq.bpr_ptr;\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tnilfs_bmap_set_target_v(btree, key, ptr);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree,\n\t\t\t\t\t    &path[level - 1].bp_newreq, dat);\n\t\tpath[level].bp_op(btree, path, level, &key, &ptr);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_set_dirty",
          "args": [
            "btree"
          ],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "258-261",
          "snippet": "static inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline void nilfs_bmap_set_dirty(struct nilfs_bmap *bmap)\n{\n\tbmap->b_state |= NILFS_BMAP_DIRTY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_dirty",
          "args": [
            "btree"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "252-255",
          "snippet": "static inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_DIRTY\t0x00000001"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\n#define NILFS_BMAP_DIRTY\t0x00000001\n\nstatic inline int nilfs_bmap_dirty(const struct nilfs_bmap *bmap)\n{\n\treturn !!(bmap->b_state & NILFS_BMAP_DIRTY);\n}"
        }
      },
      {
        "call_info": {
          "callee": "path[level].bp_op",
          "args": [
            "btree",
            "path",
            "level",
            "&key",
            "&ptr"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_commit_alloc_ptr",
          "args": [
            "btree",
            "&path[level - 1].bp_newreq",
            "dat"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_commit_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "195-201",
          "snippet": "static inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_commit_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_commit_alloc(dat, &req->bpr_req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1172
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_set_target_v",
          "args": [
            "btree",
            "key",
            "ptr"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_set_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "237-242",
          "snippet": "static inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_set_target_v(struct nilfs_bmap *bmap, __u64 key,\n\t\t\t\t\t   __u64 ptr)\n{\n\tbmap->b_last_allocated_key = key;\n\tbmap->b_last_allocated_ptr = ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "(struct buffer_head *)((unsigned long)ptr)"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_commit_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int maxlevel, __u64 key, __u64 ptr)\n{\n\tstruct inode *dat = NULL;\n\tint level;\n\n\tset_buffer_nilfs_volatile((struct buffer_head *)((unsigned long)ptr));\n\tptr = path[NILFS_BTREE_LEVEL_DATA].bp_newreq.bpr_ptr;\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tnilfs_bmap_set_target_v(btree, key, ptr);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN; level <= maxlevel; level++) {\n\t\tnilfs_bmap_commit_alloc_ptr(btree,\n\t\t\t\t\t    &path[level - 1].bp_newreq, dat);\n\t\tpath[level].bp_op(btree, path, level, &key, &ptr);\n\t}\n\n\tif (!nilfs_bmap_dirty(btree))\n\t\tnilfs_bmap_set_dirty(btree);\n}"
  },
  {
    "function_name": "nilfs_btree_prepare_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "1012-1159",
    "snippet": "static int nilfs_btree_prepare_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp, __u64 key, __u64 ptr,\n\t\t\t\t      struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, level, ncmax, ncblk, ret;\n\tstruct inode *dat = NULL;\n\n\tstats->bs_nblocks = 0;\n\tlevel = NILFS_BTREE_LEVEL_DATA;\n\n\t/* allocate a new ptr for data block */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tnilfs_btree_find_target_v(btree, path, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_data;\n\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_node_get_nchildren(node) < ncblk) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\n\t\t/* left sibling */\n\t\tif (pindex > 0) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* right sibling */\n\t\tif (pindex < nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* split */\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tpath[level - 1].bp_newreq.bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree,\n\t\t\t\t\t\t   &path[level].bp_newreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\t\tret = nilfs_btree_get_new_block(btree,\n\t\t\t\t\t\tpath[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t\t&bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_curr_node;\n\n\t\tstats->bs_nblocks++;\n\n\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\tnilfs_btree_node_init(sib, 0, level, 0, ncblk, NULL, NULL);\n\t\tpath[level].bp_sib_bh = bh;\n\t\tpath[level].bp_op = nilfs_btree_split;\n\t}\n\n\t/* root */\n\tnode = nilfs_btree_get_root(btree);\n\tif (nilfs_btree_node_get_nchildren(node) <\n\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\tstats->bs_nblocks++;\n\t\tgoto out;\n\t}\n\n\t/* grow */\n\tpath[level].bp_newreq.bpr_ptr = path[level - 1].bp_newreq.bpr_ptr + 1;\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\tret = nilfs_btree_get_new_block(btree, path[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t&bh);\n\tif (ret < 0)\n\t\tgoto err_out_curr_node;\n\n\tnilfs_btree_node_init((struct nilfs_btree_node *)bh->b_data,\n\t\t\t      0, level, 0, ncblk, NULL, NULL);\n\tpath[level].bp_sib_bh = bh;\n\tpath[level].bp_op = nilfs_btree_grow;\n\n\tlevel++;\n\tpath[level].bp_op = nilfs_btree_do_insert;\n\n\t/* a newly-created node block and a data block are added */\n\tstats->bs_nblocks += 2;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_child_node:\n\tfor (level--; level > NILFS_BTREE_LEVEL_DATA; level--) {\n\t\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\n\t}\n\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_data:\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_abort_alloc_ptr",
          "args": [
            "btree",
            "&path[level].bp_newreq",
            "dat"
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_abort_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "203-211",
          "snippet": "static inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline void nilfs_bmap_abort_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t      union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t      struct inode *dat)\n{\n\tif (dat)\n\t\tnilfs_dat_abort_alloc(dat, &req->bpr_req);\n\telse\n\t\tbmap->b_last_allocated_ptr--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_delete",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_delete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "142-161",
          "snippet": "void nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nvoid nilfs_btnode_delete(struct buffer_head *bh)\n{\n\tstruct address_space *mapping;\n\tstruct page *page = bh->b_page;\n\tpgoff_t index = page_index(page);\n\tint still_dirty;\n\n\tpage_cache_get(page);\n\tlock_page(page);\n\twait_on_page_writeback(page);\n\n\tnilfs_forget_buffer(bh);\n\tstill_dirty = PageDirty(page);\n\tmapping = page->mapping;\n\tunlock_page(page);\n\tpage_cache_release(page);\n\n\tif (!still_dirty && mapping)\n\t\tinvalidate_inode_pages2_range(mapping, index, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_init",
          "args": [
            "(struct nilfs_btree_node *)bh->b_data",
            "0",
            "level",
            "0",
            "ncblk",
            "NULL",
            "NULL"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "174-192",
          "snippet": "static void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_new_block",
          "args": [
            "btree",
            "path[level].bp_newreq.bpr_ptr",
            "&bh"
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_new_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "71-84",
          "snippet": "static int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_prepare_alloc_ptr",
          "args": [
            "btree",
            "&path[level].bp_newreq",
            "dat"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_prepare_alloc_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.h",
          "lines": "184-193",
          "snippet": "static inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n#include <linux/types.h>\n\nstatic inline int nilfs_bmap_prepare_alloc_ptr(struct nilfs_bmap *bmap,\n\t\t\t\t\t       union nilfs_bmap_ptr_req *req,\n\t\t\t\t\t       struct inode *dat)\n{\n\tif (dat)\n\t\treturn nilfs_dat_prepare_alloc(dat, &req->bpr_req);\n\t/* ignore target ptr */\n\treq->bpr_ptr = bmap->b_last_allocated_ptr++;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 1110
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "sibptr",
            "&bh"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "parent",
            "pindex + 1",
            "ncmax"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&ncmax"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_find_target_v",
          "args": [
            "btree",
            "path",
            "key"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_find_target_v",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "992-1010",
          "snippet": "static __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_prepare_insert(struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      int *levelp, __u64 key, __u64 ptr,\n\t\t\t\t      struct nilfs_bmap_stats *stats)\n{\n\tstruct buffer_head *bh;\n\tstruct nilfs_btree_node *node, *parent, *sib;\n\t__u64 sibptr;\n\tint pindex, level, ncmax, ncblk, ret;\n\tstruct inode *dat = NULL;\n\n\tstats->bs_nblocks = 0;\n\tlevel = NILFS_BTREE_LEVEL_DATA;\n\n\t/* allocate a new ptr for data block */\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tnilfs_btree_find_target_v(btree, path, key);\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t}\n\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_data;\n\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level = NILFS_BTREE_LEVEL_NODE_MIN;\n\t     level < nilfs_btree_height(btree) - 1;\n\t     level++) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_node_get_nchildren(node) < ncblk) {\n\t\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\t\tstats->bs_nblocks++;\n\t\t\tgoto out;\n\t\t}\n\n\t\tparent = nilfs_btree_get_node(btree, path, level + 1, &ncmax);\n\t\tpindex = path[level + 1].bp_index;\n\n\t\t/* left sibling */\n\t\tif (pindex > 0) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex - 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_left;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* right sibling */\n\t\tif (pindex < nilfs_btree_node_get_nchildren(parent) - 1) {\n\t\t\tsibptr = nilfs_btree_node_get_ptr(parent, pindex + 1,\n\t\t\t\t\t\t\t  ncmax);\n\t\t\tret = nilfs_btree_get_block(btree, sibptr, &bh);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto err_out_child_node;\n\t\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\t\tif (nilfs_btree_node_get_nchildren(sib) < ncblk) {\n\t\t\t\tpath[level].bp_sib_bh = bh;\n\t\t\t\tpath[level].bp_op = nilfs_btree_carry_right;\n\t\t\t\tstats->bs_nblocks++;\n\t\t\t\tgoto out;\n\t\t\t} else {\n\t\t\t\tbrelse(bh);\n\t\t\t}\n\t\t}\n\n\t\t/* split */\n\t\tpath[level].bp_newreq.bpr_ptr =\n\t\t\tpath[level - 1].bp_newreq.bpr_ptr + 1;\n\t\tret = nilfs_bmap_prepare_alloc_ptr(btree,\n\t\t\t\t\t\t   &path[level].bp_newreq, dat);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_child_node;\n\t\tret = nilfs_btree_get_new_block(btree,\n\t\t\t\t\t\tpath[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t\t&bh);\n\t\tif (ret < 0)\n\t\t\tgoto err_out_curr_node;\n\n\t\tstats->bs_nblocks++;\n\n\t\tsib = (struct nilfs_btree_node *)bh->b_data;\n\t\tnilfs_btree_node_init(sib, 0, level, 0, ncblk, NULL, NULL);\n\t\tpath[level].bp_sib_bh = bh;\n\t\tpath[level].bp_op = nilfs_btree_split;\n\t}\n\n\t/* root */\n\tnode = nilfs_btree_get_root(btree);\n\tif (nilfs_btree_node_get_nchildren(node) <\n\t    NILFS_BTREE_ROOT_NCHILDREN_MAX) {\n\t\tpath[level].bp_op = nilfs_btree_do_insert;\n\t\tstats->bs_nblocks++;\n\t\tgoto out;\n\t}\n\n\t/* grow */\n\tpath[level].bp_newreq.bpr_ptr = path[level - 1].bp_newreq.bpr_ptr + 1;\n\tret = nilfs_bmap_prepare_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\tif (ret < 0)\n\t\tgoto err_out_child_node;\n\tret = nilfs_btree_get_new_block(btree, path[level].bp_newreq.bpr_ptr,\n\t\t\t\t\t&bh);\n\tif (ret < 0)\n\t\tgoto err_out_curr_node;\n\n\tnilfs_btree_node_init((struct nilfs_btree_node *)bh->b_data,\n\t\t\t      0, level, 0, ncblk, NULL, NULL);\n\tpath[level].bp_sib_bh = bh;\n\tpath[level].bp_op = nilfs_btree_grow;\n\n\tlevel++;\n\tpath[level].bp_op = nilfs_btree_do_insert;\n\n\t/* a newly-created node block and a data block are added */\n\tstats->bs_nblocks += 2;\n\n\t/* success */\n out:\n\t*levelp = level;\n\treturn ret;\n\n\t/* error */\n err_out_curr_node:\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_child_node:\n\tfor (level--; level > NILFS_BTREE_LEVEL_DATA; level--) {\n\t\tnilfs_btnode_delete(path[level].bp_sib_bh);\n\t\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n\n\t}\n\n\tnilfs_bmap_abort_alloc_ptr(btree, &path[level].bp_newreq, dat);\n err_out_data:\n\t*levelp = level;\n\tstats->bs_nblocks = 0;\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_find_target_v",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "992-1010",
    "snippet": "static __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_bmap_find_target_in_group",
          "args": [
            "btree"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_find_target_in_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "457-466",
          "snippet": "__u64 nilfs_bmap_find_target_in_group(const struct nilfs_bmap *bmap)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(bmap);\n\tunsigned long entries_per_group = nilfs_palloc_entries_per_group(dat);\n\tunsigned long group = bmap->b_inode->i_ino / entries_per_group;\n\n\treturn group * entries_per_group +\n\t\t(bmap->b_inode->i_ino % NILFS_BMAP_GROUP_DIV) *\n\t\t(entries_per_group / NILFS_BMAP_GROUP_DIV);\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define NILFS_BMAP_GROUP_DIV\t8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n#define NILFS_BMAP_GROUP_DIV\t8\n\n__u64 nilfs_bmap_find_target_in_group(const struct nilfs_bmap *bmap)\n{\n\tstruct inode *dat = nilfs_bmap_get_dat(bmap);\n\tunsigned long entries_per_group = nilfs_palloc_entries_per_group(dat);\n\tunsigned long group = bmap->b_inode->i_ino / entries_per_group;\n\n\treturn group * entries_per_group +\n\t\t(bmap->b_inode->i_ino % NILFS_BMAP_GROUP_DIV) *\n\t\t(entries_per_group / NILFS_BMAP_GROUP_DIV);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_find_near",
          "args": [
            "btree",
            "path"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_find_near",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "963-990",
          "snippet": "static __u64 nilfs_btree_find_near(const struct nilfs_bmap *btree,\n\t\t\t\t   const struct nilfs_btree_path *path)\n{\n\tstruct nilfs_btree_node *node;\n\tint level, ncmax;\n\n\tif (path == NULL)\n\t\treturn NILFS_BMAP_INVALID_PTR;\n\n\t/* left sibling */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN;\n\tif (path[level].bp_index > 0) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node,\n\t\t\t\t\t\tpath[level].bp_index - 1,\n\t\t\t\t\t\tncmax);\n\t}\n\n\t/* parent */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN + 1;\n\tif (level <= nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node, path[level].bp_index,\n\t\t\t\t\t\tncmax);\n\t}\n\n\treturn NILFS_BMAP_INVALID_PTR;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64 nilfs_btree_find_near(const struct nilfs_bmap *btree,\n\t\t\t\t   const struct nilfs_btree_path *path)\n{\n\tstruct nilfs_btree_node *node;\n\tint level, ncmax;\n\n\tif (path == NULL)\n\t\treturn NILFS_BMAP_INVALID_PTR;\n\n\t/* left sibling */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN;\n\tif (path[level].bp_index > 0) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node,\n\t\t\t\t\t\tpath[level].bp_index - 1,\n\t\t\t\t\t\tncmax);\n\t}\n\n\t/* parent */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN + 1;\n\tif (level <= nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node, path[level].bp_index,\n\t\t\t\t\t\tncmax);\n\t}\n\n\treturn NILFS_BMAP_INVALID_PTR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_find_target_seq",
          "args": [
            "btree",
            "key"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_find_target_seq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "443-454",
          "snippet": "__u64 nilfs_bmap_find_target_seq(const struct nilfs_bmap *bmap, __u64 key)\n{\n\t__s64 diff;\n\n\tdiff = key - bmap->b_last_allocated_key;\n\tif ((nilfs_bmap_keydiff_abs(diff) < NILFS_INODE_BMAP_SIZE) &&\n\t    (bmap->b_last_allocated_ptr != NILFS_BMAP_INVALID_PTR) &&\n\t    (bmap->b_last_allocated_ptr + diff > 0))\n\t\treturn bmap->b_last_allocated_ptr + diff;\n\telse\n\t\treturn NILFS_BMAP_INVALID_PTR;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\n__u64 nilfs_bmap_find_target_seq(const struct nilfs_bmap *bmap, __u64 key)\n{\n\t__s64 diff;\n\n\tdiff = key - bmap->b_last_allocated_key;\n\tif ((nilfs_bmap_keydiff_abs(diff) < NILFS_INODE_BMAP_SIZE) &&\n\t    (bmap->b_last_allocated_ptr != NILFS_BMAP_INVALID_PTR) &&\n\t    (bmap->b_last_allocated_ptr + diff > 0))\n\t\treturn bmap->b_last_allocated_ptr + diff;\n\telse\n\t\treturn NILFS_BMAP_INVALID_PTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64 nilfs_btree_find_target_v(const struct nilfs_bmap *btree,\n\t\t\t\t       const struct nilfs_btree_path *path,\n\t\t\t\t       __u64 key)\n{\n\t__u64 ptr;\n\n\tptr = nilfs_bmap_find_target_seq(btree, key);\n\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t/* sequential access */\n\t\treturn ptr;\n\telse {\n\t\tptr = nilfs_btree_find_near(btree, path);\n\t\tif (ptr != NILFS_BMAP_INVALID_PTR)\n\t\t\t/* near */\n\t\t\treturn ptr;\n\t}\n\t/* block group */\n\treturn nilfs_bmap_find_target_in_group(btree);\n}"
  },
  {
    "function_name": "nilfs_btree_find_near",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "963-990",
    "snippet": "static __u64 nilfs_btree_find_near(const struct nilfs_bmap *btree,\n\t\t\t\t   const struct nilfs_btree_path *path)\n{\n\tstruct nilfs_btree_node *node;\n\tint level, ncmax;\n\n\tif (path == NULL)\n\t\treturn NILFS_BMAP_INVALID_PTR;\n\n\t/* left sibling */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN;\n\tif (path[level].bp_index > 0) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node,\n\t\t\t\t\t\tpath[level].bp_index - 1,\n\t\t\t\t\t\tncmax);\n\t}\n\n\t/* parent */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN + 1;\n\tif (level <= nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node, path[level].bp_index,\n\t\t\t\t\t\tncmax);\n\t}\n\n\treturn NILFS_BMAP_INVALID_PTR;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "node",
            "path[level].bp_index",
            "ncmax"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level",
            "&ncmax"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64 nilfs_btree_find_near(const struct nilfs_bmap *btree,\n\t\t\t\t   const struct nilfs_btree_path *path)\n{\n\tstruct nilfs_btree_node *node;\n\tint level, ncmax;\n\n\tif (path == NULL)\n\t\treturn NILFS_BMAP_INVALID_PTR;\n\n\t/* left sibling */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN;\n\tif (path[level].bp_index > 0) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node,\n\t\t\t\t\t\tpath[level].bp_index - 1,\n\t\t\t\t\t\tncmax);\n\t}\n\n\t/* parent */\n\tlevel = NILFS_BTREE_LEVEL_NODE_MIN + 1;\n\tif (level <= nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\t\treturn nilfs_btree_node_get_ptr(node, path[level].bp_index,\n\t\t\t\t\t\tncmax);\n\t}\n\n\treturn NILFS_BMAP_INVALID_PTR;\n}"
  },
  {
    "function_name": "nilfs_btree_grow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "934-961",
    "snippet": "static void nilfs_btree_grow(struct nilfs_bmap *btree,\n\t\t\t     struct nilfs_btree_path *path,\n\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *root, *child;\n\tint n, ncblk;\n\n\troot = nilfs_btree_get_root(btree);\n\tchild = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(root);\n\n\tnilfs_btree_node_move_right(root, child, n,\n\t\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX, ncblk);\n\tnilfs_btree_node_set_level(root, level + 1);\n\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level].bp_bh = path[level].bp_sib_bh;\n\tpath[level].bp_sib_bh = NULL;\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n\n\t*keyp = nilfs_btree_node_get_key(child, 0);\n\t*ptrp = path[level].bp_newreq.bpr_ptr;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "child",
            "0"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_insert",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "759-784",
          "snippet": "static void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_level",
          "args": [
            "root",
            "level + 1"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "107-111",
          "snippet": "static void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_right",
          "args": [
            "root",
            "child",
            "n",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX",
            "ncblk"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_right",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "223-248",
          "snippet": "static void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "root"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_grow(struct nilfs_bmap *btree,\n\t\t\t     struct nilfs_btree_path *path,\n\t\t\t     int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *root, *child;\n\tint n, ncblk;\n\n\troot = nilfs_btree_get_root(btree);\n\tchild = nilfs_btree_get_sib_node(path, level);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\n\tn = nilfs_btree_node_get_nchildren(root);\n\n\tnilfs_btree_node_move_right(root, child, n,\n\t\t\t\t    NILFS_BTREE_ROOT_NCHILDREN_MAX, ncblk);\n\tnilfs_btree_node_set_level(root, level + 1);\n\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level].bp_bh = path[level].bp_sib_bh;\n\tpath[level].bp_sib_bh = NULL;\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n\n\t*keyp = nilfs_btree_node_get_key(child, 0);\n\t*ptrp = path[level].bp_newreq.bpr_ptr;\n}"
  },
  {
    "function_name": "nilfs_btree_split",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "879-932",
    "snippet": "static void nilfs_btree_split(struct nilfs_bmap *btree,\n\t\t\t      struct nilfs_btree_path *path,\n\t\t\t      int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\t__u64 newkey;\n\t__u64 newptr;\n\tint nchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + 1) / 2;\n\tif (n > nchildren - path[level].bp_index) {\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_right(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnewkey = nilfs_btree_node_get_key(right, 0);\n\tnewptr = path[level].bp_newreq.bpr_ptr;\n\n\tif (move) {\n\t\tpath[level].bp_index -= nilfs_btree_node_get_nchildren(node);\n\t\tnilfs_btree_node_insert(right, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\n\t\t*keyp = nilfs_btree_node_get_key(right, 0);\n\t\t*ptrp = path[level].bp_newreq.bpr_ptr;\n\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t} else {\n\t\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n\n\t\t*keyp = nilfs_btree_node_get_key(right, 0);\n\t\t*ptrp = path[level].bp_newreq.bpr_ptr;\n\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t}\n\n\tpath[level + 1].bp_index++;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "right",
            "0"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_insert",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "759-784",
          "snippet": "static void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_insert",
          "args": [
            "right",
            "path[level].bp_index",
            "*keyp",
            "*ptrp",
            "ncblk"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "251-271",
          "snippet": "static void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_right",
          "args": [
            "node",
            "right",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 900
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_right",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "223-248",
          "snippet": "static void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_split(struct nilfs_bmap *btree,\n\t\t\t      struct nilfs_btree_path *path,\n\t\t\t      int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\t__u64 newkey;\n\t__u64 newptr;\n\tint nchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + 1) / 2;\n\tif (n > nchildren - path[level].bp_index) {\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_right(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnewkey = nilfs_btree_node_get_key(right, 0);\n\tnewptr = path[level].bp_newreq.bpr_ptr;\n\n\tif (move) {\n\t\tpath[level].bp_index -= nilfs_btree_node_get_nchildren(node);\n\t\tnilfs_btree_node_insert(right, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\n\t\t*keyp = nilfs_btree_node_get_key(right, 0);\n\t\t*ptrp = path[level].bp_newreq.bpr_ptr;\n\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t} else {\n\t\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n\n\t\t*keyp = nilfs_btree_node_get_key(right, 0);\n\t\t*ptrp = path[level].bp_newreq.bpr_ptr;\n\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t}\n\n\tpath[level + 1].bp_index++;\n}"
  },
  {
    "function_name": "nilfs_btree_carry_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "832-877",
    "snippet": "static void nilfs_btree_carry_right(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint nchildren, rnchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + rnchildren + 1) / 2 - rnchildren;\n\tif (n > nchildren - path[level].bp_index) {\n\t\t/* move insert point */\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_right(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level + 1].bp_index++;\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(right, 0));\n\tpath[level + 1].bp_index--;\n\n\tif (move) {\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index -= nilfs_btree_node_get_nchildren(node);\n\t\tpath[level + 1].bp_index++;\n\t} else {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t}\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_do_insert",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "759-784",
          "snippet": "static void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(right, 0)"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "right",
            "0"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_right",
          "args": [
            "node",
            "right",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_right",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "223-248",
          "snippet": "static void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_carry_right(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *right;\n\tint nchildren, rnchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tright = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + rnchildren + 1) / 2 - rnchildren;\n\tif (n > nchildren - path[level].bp_index) {\n\t\t/* move insert point */\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_right(node, right, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tpath[level + 1].bp_index++;\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(right, 0));\n\tpath[level + 1].bp_index--;\n\n\tif (move) {\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index -= nilfs_btree_node_get_nchildren(node);\n\t\tpath[level + 1].bp_index++;\n\t} else {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t}\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n}"
  },
  {
    "function_name": "nilfs_btree_carry_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "786-830",
    "snippet": "static void nilfs_btree_carry_left(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint nchildren, lnchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + lnchildren + 1) / 2 - lnchildren;\n\tif (n > path[level].bp_index) {\n\t\t/* move insert point */\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_left(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\n\tif (move) {\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index += lnchildren;\n\t\tpath[level + 1].bp_index--;\n\t} else {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index -= n;\n\t}\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_do_insert",
          "args": [
            "btree",
            "path",
            "level",
            "keyp",
            "ptrp"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "759-784",
          "snippet": "static void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(node, 0)"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_sib_bh"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_move_left",
          "args": [
            "left",
            "node",
            "n",
            "ncblk",
            "ncblk"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_move_left",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "195-220",
          "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "left"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_sib_node",
          "args": [
            "path",
            "level"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_sib_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "427-431",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_carry_left(struct nilfs_bmap *btree,\n\t\t\t\t   struct nilfs_btree_path *path,\n\t\t\t\t   int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node, *left;\n\tint nchildren, lnchildren, n, move, ncblk;\n\n\tnode = nilfs_btree_get_nonroot_node(path, level);\n\tleft = nilfs_btree_get_sib_node(path, level);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\tncblk = nilfs_btree_nchildren_per_block(btree);\n\tmove = 0;\n\n\tn = (nchildren + lnchildren + 1) / 2 - lnchildren;\n\tif (n > path[level].bp_index) {\n\t\t/* move insert point */\n\t\tn--;\n\t\tmove = 1;\n\t}\n\n\tnilfs_btree_node_move_left(left, node, n, ncblk, ncblk);\n\n\tif (!buffer_dirty(path[level].bp_bh))\n\t\tmark_buffer_dirty(path[level].bp_bh);\n\tif (!buffer_dirty(path[level].bp_sib_bh))\n\t\tmark_buffer_dirty(path[level].bp_sib_bh);\n\n\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\tnilfs_btree_node_get_key(node, 0));\n\n\tif (move) {\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = path[level].bp_sib_bh;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index += lnchildren;\n\t\tpath[level + 1].bp_index--;\n\t} else {\n\t\tbrelse(path[level].bp_sib_bh);\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index -= n;\n\t}\n\n\tnilfs_btree_do_insert(btree, path, level, keyp, ptrp);\n}"
  },
  {
    "function_name": "nilfs_btree_do_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "759-784",
    "snippet": "static void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_insert",
          "args": [
            "node",
            "path[level].bp_index",
            "*keyp",
            "*ptrp",
            "NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "251-271",
          "snippet": "static void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_promote_key",
          "args": [
            "btree",
            "path",
            "level + 1",
            "nilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0)"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_promote_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "737-757",
          "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "0"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_do_insert(struct nilfs_bmap *btree,\n\t\t\t\t  struct nilfs_btree_path *path,\n\t\t\t\t  int level, __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\tint ncblk;\n\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncblk = nilfs_btree_nchildren_per_block(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp, ncblk);\n\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\n\t\tif (path[level].bp_index == 0)\n\t\t\tnilfs_btree_promote_key(btree, path, level + 1,\n\t\t\t\t\t\tnilfs_btree_node_get_key(node,\n\t\t\t\t\t\t\t\t\t 0));\n\t} else {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\tnilfs_btree_node_insert(node, path[level].bp_index,\n\t\t\t\t\t*keyp, *ptrp,\n\t\t\t\t\tNILFS_BTREE_ROOT_NCHILDREN_MAX);\n\t}\n}"
  },
  {
    "function_name": "nilfs_btree_promote_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "737-757",
    "snippet": "static void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_key",
          "args": [
            "nilfs_btree_get_root(btree)",
            "path[level].bp_index",
            "key"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "154-158",
          "snippet": "static void\nnilfs_btree_node_set_key(struct nilfs_btree_node *node, int index, __u64 key)\n{\n\t*(nilfs_btree_node_dkeys(node) + index) = cpu_to_le64(key);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_key(struct nilfs_btree_node *node, int index, __u64 key)\n{\n\t*(nilfs_btree_node_dkeys(node) + index) = cpu_to_le64(key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_buffer_dirty",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "mark_buffer_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1141-1167",
          "snippet": "void mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid mark_buffer_dirty(struct buffer_head *bh)\n{\n\tWARN_ON_ONCE(!buffer_uptodate(bh));\n\n\ttrace_block_dirty_buffer(bh);\n\n\t/*\n\t * Very *carefully* optimize the it-is-already-dirty case.\n\t *\n\t * Don't let the final \"is it dirty\" escape to before we\n\t * perhaps modified the buffer.\n\t */\n\tif (buffer_dirty(bh)) {\n\t\tsmp_mb();\n\t\tif (buffer_dirty(bh))\n\t\t\treturn;\n\t}\n\n\tif (!test_set_buffer_dirty(bh)) {\n\t\tstruct page *page = bh->b_page;\n\t\tif (!TestSetPageDirty(page)) {\n\t\t\tstruct address_space *mapping = page_mapping(page);\n\t\t\tif (mapping)\n\t\t\t\t__set_page_dirty(page, mapping, 0);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_promote_key(struct nilfs_bmap *btree,\n\t\t\t\t    struct nilfs_btree_path *path,\n\t\t\t\t    int level, __u64 key)\n{\n\tif (level < nilfs_btree_height(btree) - 1) {\n\t\tdo {\n\t\t\tnilfs_btree_node_set_key(\n\t\t\t\tnilfs_btree_get_nonroot_node(path, level),\n\t\t\t\tpath[level].bp_index, key);\n\t\t\tif (!buffer_dirty(path[level].bp_bh))\n\t\t\t\tmark_buffer_dirty(path[level].bp_bh);\n\t\t} while ((path[level].bp_index == 0) &&\n\t\t\t (++level < nilfs_btree_height(btree) - 1));\n\t}\n\n\t/* root */\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnilfs_btree_node_set_key(nilfs_btree_get_root(btree),\n\t\t\t\t\t path[level].bp_index, key);\n\t}\n}"
  },
  {
    "function_name": "nilfs_btree_lookup_contig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "653-735",
    "snippet": "static int nilfs_btree_lookup_contig(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 key, __u64 *ptrp, unsigned maxblocks)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat = NULL;\n\t__u64 ptr, ptr2;\n\tsector_t blocknr;\n\tint level = NILFS_BTREE_LEVEL_NODE_MIN;\n\tint ret, cnt, index, maxlevel, ncmax;\n\tstruct nilfs_btree_readahead_info p;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, &ptr, level, 1);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t\tret = nilfs_dat_translate(dat, ptr, &blocknr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tptr = blocknr;\n\t}\n\tcnt = 1;\n\tif (cnt == maxblocks)\n\t\tgoto end;\n\n\tmaxlevel = nilfs_btree_height(btree) - 1;\n\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\tindex = path[level].bp_index + 1;\n\tfor (;;) {\n\t\twhile (index < nilfs_btree_node_get_nchildren(node)) {\n\t\t\tif (nilfs_btree_node_get_key(node, index) !=\n\t\t\t    key + cnt)\n\t\t\t\tgoto end;\n\t\t\tptr2 = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t\tif (dat) {\n\t\t\t\tret = nilfs_dat_translate(dat, ptr2, &blocknr);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out;\n\t\t\t\tptr2 = blocknr;\n\t\t\t}\n\t\t\tif (ptr2 != ptr + cnt || ++cnt == maxblocks)\n\t\t\t\tgoto end;\n\t\t\tindex++;\n\t\t\tcontinue;\n\t\t}\n\t\tif (level == maxlevel)\n\t\t\tbreak;\n\n\t\t/* look-up right sibling node */\n\t\tp.node = nilfs_btree_get_node(btree, path, level + 1, &p.ncmax);\n\t\tp.index = path[level + 1].bp_index + 1;\n\t\tp.max_ra_blocks = 7;\n\t\tif (p.index >= nilfs_btree_node_get_nchildren(p.node) ||\n\t\t    nilfs_btree_node_get_key(p.node, p.index) != key + cnt)\n\t\t\tbreak;\n\t\tptr2 = nilfs_btree_node_get_ptr(p.node, p.index, p.ncmax);\n\t\tpath[level + 1].bp_index = p.index;\n\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = NULL;\n\n\t\tret = __nilfs_btree_get_block(btree, ptr2, &path[level].bp_bh,\n\t\t\t\t\t      &p);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncmax = nilfs_btree_nchildren_per_block(btree);\n\t\tindex = 0;\n\t\tpath[level].bp_index = index;\n\t}\n end:\n\t*ptrp = ptr;\n\tret = cnt;\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr2",
            "&path[level].bp_bh",
            "&p"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "__nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "474-527",
          "snippet": "static int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "p.node",
            "p.index",
            "p.ncmax"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "p.node",
            "p.index"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "p.node"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&p.ncmax"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_dat_translate",
          "args": [
            "dat",
            "ptr2",
            "&blocknr"
          ],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_dat_translate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/dat.c",
          "lines": "397-431",
          "snippet": "int nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_dat_translate(struct inode *dat, __u64 vblocknr, sector_t *blocknrp)\n{\n\tstruct buffer_head *entry_bh, *bh;\n\tstruct nilfs_dat_entry *entry;\n\tsector_t blocknr;\n\tvoid *kaddr;\n\tint ret;\n\n\tret = nilfs_palloc_get_entry_block(dat, vblocknr, 0, &entry_bh);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (!nilfs_doing_gc() && buffer_nilfs_redirected(entry_bh)) {\n\t\tbh = nilfs_mdt_get_frozen_buffer(dat, entry_bh);\n\t\tif (bh) {\n\t\t\tWARN_ON(!buffer_uptodate(bh));\n\t\t\tbrelse(entry_bh);\n\t\t\tentry_bh = bh;\n\t\t}\n\t}\n\n\tkaddr = kmap_atomic(entry_bh->b_page);\n\tentry = nilfs_palloc_block_get_entry(dat, vblocknr, entry_bh, kaddr);\n\tblocknr = le64_to_cpu(entry->de_blocknr);\n\tif (blocknr == 0) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\t*blocknrp = blocknr;\n\n out:\n\tkunmap_atomic(kaddr);\n\tbrelse(entry_bh);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_bmap_get_dat",
          "args": [
            "btree"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_bmap_get_dat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/bmap.c",
          "lines": "35-40",
          "snippet": "struct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}",
          "includes": [
            "#include \"alloc.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"btnode.h\"",
            "#include \"direct.h\"",
            "#include \"btree.h\"",
            "#include \"bmap.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"alloc.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"btnode.h\"\n#include \"direct.h\"\n#include \"btree.h\"\n#include \"bmap.h\"\n#include \"nilfs.h\"\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/fs.h>\n\nstruct inode *nilfs_bmap_get_dat(const struct nilfs_bmap *bmap)\n{\n\tstruct the_nilfs *nilfs = bmap->b_inode->i_sb->s_fs_info;\n\n\treturn nilfs->ns_dat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_USE_VBN",
          "args": [
            "btree"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "&ptr",
            "level",
            "1"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_lookup_contig(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 key, __u64 *ptrp, unsigned maxblocks)\n{\n\tstruct nilfs_btree_path *path;\n\tstruct nilfs_btree_node *node;\n\tstruct inode *dat = NULL;\n\t__u64 ptr, ptr2;\n\tsector_t blocknr;\n\tint level = NILFS_BTREE_LEVEL_NODE_MIN;\n\tint ret, cnt, index, maxlevel, ncmax;\n\tstruct nilfs_btree_readahead_info p;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, &ptr, level, 1);\n\tif (ret < 0)\n\t\tgoto out;\n\n\tif (NILFS_BMAP_USE_VBN(btree)) {\n\t\tdat = nilfs_bmap_get_dat(btree);\n\t\tret = nilfs_dat_translate(dat, ptr, &blocknr);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tptr = blocknr;\n\t}\n\tcnt = 1;\n\tif (cnt == maxblocks)\n\t\tgoto end;\n\n\tmaxlevel = nilfs_btree_height(btree) - 1;\n\tnode = nilfs_btree_get_node(btree, path, level, &ncmax);\n\tindex = path[level].bp_index + 1;\n\tfor (;;) {\n\t\twhile (index < nilfs_btree_node_get_nchildren(node)) {\n\t\t\tif (nilfs_btree_node_get_key(node, index) !=\n\t\t\t    key + cnt)\n\t\t\t\tgoto end;\n\t\t\tptr2 = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t\tif (dat) {\n\t\t\t\tret = nilfs_dat_translate(dat, ptr2, &blocknr);\n\t\t\t\tif (ret < 0)\n\t\t\t\t\tgoto out;\n\t\t\t\tptr2 = blocknr;\n\t\t\t}\n\t\t\tif (ptr2 != ptr + cnt || ++cnt == maxblocks)\n\t\t\t\tgoto end;\n\t\t\tindex++;\n\t\t\tcontinue;\n\t\t}\n\t\tif (level == maxlevel)\n\t\t\tbreak;\n\n\t\t/* look-up right sibling node */\n\t\tp.node = nilfs_btree_get_node(btree, path, level + 1, &p.ncmax);\n\t\tp.index = path[level + 1].bp_index + 1;\n\t\tp.max_ra_blocks = 7;\n\t\tif (p.index >= nilfs_btree_node_get_nchildren(p.node) ||\n\t\t    nilfs_btree_node_get_key(p.node, p.index) != key + cnt)\n\t\t\tbreak;\n\t\tptr2 = nilfs_btree_node_get_ptr(p.node, p.index, p.ncmax);\n\t\tpath[level + 1].bp_index = p.index;\n\n\t\tbrelse(path[level].bp_bh);\n\t\tpath[level].bp_bh = NULL;\n\n\t\tret = __nilfs_btree_get_block(btree, ptr2, &path[level].bp_bh,\n\t\t\t\t\t      &p);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tncmax = nilfs_btree_nchildren_per_block(btree);\n\t\tindex = 0;\n\t\tpath[level].bp_index = index;\n\t}\n end:\n\t*ptrp = ptr;\n\tret = cnt;\n out:\n\tnilfs_btree_free_path(path);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "636-651",
    "snippet": "static int nilfs_btree_lookup(const struct nilfs_bmap *btree,\n\t\t\t      __u64 key, int level, __u64 *ptrp)\n{\n\tstruct nilfs_btree_path *path;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, ptrp, level, 0);\n\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_free_path",
          "args": [
            "path"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_free_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "58-66",
          "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_do_lookup",
          "args": [
            "btree",
            "path",
            "key",
            "ptrp",
            "level",
            "0"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_do_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "535-595",
          "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_alloc_path",
          "args": [],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_alloc_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "36-56",
          "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_lookup(const struct nilfs_bmap *btree,\n\t\t\t      __u64 key, int level, __u64 *ptrp)\n{\n\tstruct nilfs_btree_path *path;\n\tint ret;\n\n\tpath = nilfs_btree_alloc_path();\n\tif (path == NULL)\n\t\treturn -ENOMEM;\n\n\tret = nilfs_btree_do_lookup(btree, path, key, ptrp, level, 0);\n\n\tnilfs_btree_free_path(path);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_do_lookup_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "597-634",
    "snippet": "static int nilfs_btree_do_lookup_last(const struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 ptr;\n\tint index, level, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\tif (index < 0)\n\t\treturn -ENOENT;\n\tlevel = nilfs_btree_node_get_level(node);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level--; level > 0; level--) {\n\t\tret = nilfs_btree_get_block(btree, ptr, &path[level].bp_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\tpath[level].bp_index = index;\n\t}\n\n\tif (keyp != NULL)\n\t\t*keyp = nilfs_btree_node_get_key(node, index);\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "index"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "node",
            "index",
            "ncmax"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_bad_node",
          "args": [
            "node",
            "level"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_bad_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "455-465",
          "snippet": "static int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "&path[level].bp_bh"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "529-533",
          "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup_last(const struct nilfs_bmap *btree,\n\t\t\t\t      struct nilfs_btree_path *path,\n\t\t\t\t      __u64 *keyp, __u64 *ptrp)\n{\n\tstruct nilfs_btree_node *node;\n\t__u64 ptr;\n\tint index, level, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\tif (index < 0)\n\t\treturn -ENOENT;\n\tlevel = nilfs_btree_node_get_level(node);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\tfor (level--; level > 0; level--) {\n\t\tret = nilfs_btree_get_block(btree, ptr, &path[level].bp_bh);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tindex = nilfs_btree_node_get_nchildren(node) - 1;\n\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\tpath[level].bp_index = index;\n\t}\n\n\tif (keyp != NULL)\n\t\t*keyp = nilfs_btree_node_get_key(node, index);\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_do_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "535-595",
    "snippet": "static int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "found || level != NILFS_BTREE_LEVEL_NODE_MIN"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "node",
            "index",
            "ncmax"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_lookup",
          "args": [
            "node",
            "key",
            "&index"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "303-340",
          "snippet": "static int nilfs_btree_node_lookup(const struct nilfs_btree_node *node,\n\t\t\t\t   __u64 key, int *indexp)\n{\n\t__u64 nkey;\n\tint index, low, high, s;\n\n\t/* binary search */\n\tlow = 0;\n\thigh = nilfs_btree_node_get_nchildren(node) - 1;\n\tindex = 0;\n\ts = 0;\n\twhile (low <= high) {\n\t\tindex = (low + high) / 2;\n\t\tnkey = nilfs_btree_node_get_key(node, index);\n\t\tif (nkey == key) {\n\t\t\ts = 0;\n\t\t\tgoto out;\n\t\t} else if (nkey < key) {\n\t\t\tlow = index + 1;\n\t\t\ts = -1;\n\t\t} else {\n\t\t\thigh = index - 1;\n\t\t\ts = 1;\n\t\t}\n\t}\n\n\t/* adjust index */\n\tif (nilfs_btree_node_get_level(node) > NILFS_BTREE_LEVEL_NODE_MIN) {\n\t\tif (s > 0 && index > 0)\n\t\t\tindex--;\n\t} else if (s < 0)\n\t\tindex++;\n\n out:\n\t*indexp = index;\n\n\treturn s == 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_lookup(const struct nilfs_btree_node *node,\n\t\t\t\t   __u64 key, int *indexp)\n{\n\t__u64 nkey;\n\tint index, low, high, s;\n\n\t/* binary search */\n\tlow = 0;\n\thigh = nilfs_btree_node_get_nchildren(node) - 1;\n\tindex = 0;\n\ts = 0;\n\twhile (low <= high) {\n\t\tindex = (low + high) / 2;\n\t\tnkey = nilfs_btree_node_get_key(node, index);\n\t\tif (nkey == key) {\n\t\t\ts = 0;\n\t\t\tgoto out;\n\t\t} else if (nkey < key) {\n\t\t\tlow = index + 1;\n\t\t\ts = -1;\n\t\t} else {\n\t\t\thigh = index - 1;\n\t\t\ts = 1;\n\t\t}\n\t}\n\n\t/* adjust index */\n\tif (nilfs_btree_node_get_level(node) > NILFS_BTREE_LEVEL_NODE_MIN) {\n\t\tif (s > 0 && index > 0)\n\t\t\tindex--;\n\t} else if (s < 0)\n\t\tindex++;\n\n out:\n\t*indexp = index;\n\n\treturn s == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_bad_node",
          "args": [
            "node",
            "level"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_bad_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "455-465",
          "snippet": "static int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "&path[level].bp_bh",
            "ra"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "__nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "474-527",
          "snippet": "static int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_node",
          "args": [
            "btree",
            "path",
            "level + 1",
            "&p.ncmax"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "438-453",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_do_lookup(const struct nilfs_bmap *btree,\n\t\t\t\t struct nilfs_btree_path *path,\n\t\t\t\t __u64 key, __u64 *ptrp, int minlevel,\n\t\t\t\t int readahead)\n{\n\tstruct nilfs_btree_node *node;\n\tstruct nilfs_btree_readahead_info p, *ra;\n\t__u64 ptr;\n\tint level, index, found, ncmax, ret;\n\n\tnode = nilfs_btree_get_root(btree);\n\tlevel = nilfs_btree_node_get_level(node);\n\tif (level < minlevel || nilfs_btree_node_get_nchildren(node) <= 0)\n\t\treturn -ENOENT;\n\n\tfound = nilfs_btree_node_lookup(node, key, &index);\n\tptr = nilfs_btree_node_get_ptr(node, index,\n\t\t\t\t       NILFS_BTREE_ROOT_NCHILDREN_MAX);\n\tpath[level].bp_bh = NULL;\n\tpath[level].bp_index = index;\n\n\tncmax = nilfs_btree_nchildren_per_block(btree);\n\n\twhile (--level >= minlevel) {\n\t\tra = NULL;\n\t\tif (level == NILFS_BTREE_LEVEL_NODE_MIN && readahead) {\n\t\t\tp.node = nilfs_btree_get_node(btree, path, level + 1,\n\t\t\t\t\t\t      &p.ncmax);\n\t\t\tp.index = index;\n\t\t\tp.max_ra_blocks = 7;\n\t\t\tra = &p;\n\t\t}\n\t\tret = __nilfs_btree_get_block(btree, ptr, &path[level].bp_bh,\n\t\t\t\t\t      ra);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\tif (nilfs_btree_bad_node(node, level))\n\t\t\treturn -EINVAL;\n\t\tif (!found)\n\t\t\tfound = nilfs_btree_node_lookup(node, key, &index);\n\t\telse\n\t\t\tindex = 0;\n\t\tif (index < ncmax) {\n\t\t\tptr = nilfs_btree_node_get_ptr(node, index, ncmax);\n\t\t} else {\n\t\t\tWARN_ON(found || level != NILFS_BTREE_LEVEL_NODE_MIN);\n\t\t\t/* insert */\n\t\t\tptr = NILFS_BMAP_INVALID_PTR;\n\t\t}\n\t\tpath[level].bp_index = index;\n\t}\n\tif (!found)\n\t\treturn -ENOENT;\n\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_get_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "529-533",
    "snippet": "static int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__nilfs_btree_get_block",
          "args": [
            "btree",
            "ptr",
            "bhp",
            "NULL"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "__nilfs_btree_get_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "474-527",
          "snippet": "static int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp)\n{\n\treturn __nilfs_btree_get_block(btree, ptr, bhp, NULL);\n}"
  },
  {
    "function_name": "__nilfs_btree_get_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "474-527",
    "snippet": "static int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bh"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_broken_node_block",
          "args": [
            "bh"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_broken_node_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "401-413",
          "snippet": "int nilfs_btree_broken_node_block(struct buffer_head *bh)\n{\n\tint ret;\n\n\tif (buffer_nilfs_checked(bh))\n\t\treturn 0;\n\n\tret = nilfs_btree_node_broken((struct nilfs_btree_node *)bh->b_data,\n\t\t\t\t       bh->b_size, bh->b_blocknr);\n\tif (likely(!ret))\n\t\tset_buffer_nilfs_checked(bh);\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nint nilfs_btree_broken_node_block(struct buffer_head *bh)\n{\n\tint ret;\n\n\tif (buffer_nilfs_checked(bh))\n\t\treturn 0;\n\n\tret = nilfs_btree_node_broken((struct nilfs_btree_node *)bh->b_data,\n\t\t\t\t       bh->b_size, bh->b_blocknr);\n\tif (likely(!ret))\n\t\tset_buffer_nilfs_checked(bh);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_uptodate",
          "args": [
            "bh"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_set_buffer_uptodate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "3758-3761",
          "snippet": "int btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nint btrfs_set_buffer_uptodate(struct extent_buffer *buf)\n{\n\treturn set_extent_buffer_uptodate(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_on_buffer",
          "args": [
            "bh"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "__wait_on_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "117-120",
          "snippet": "void __wait_on_buffer(struct buffer_head * bh)\n{\n\twait_on_bit_io(&bh->b_state, BH_Lock, TASK_UNINTERRUPTIBLE);\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __wait_on_buffer(struct buffer_head * bh)\n{\n\twait_on_bit_io(&bh->b_state, BH_Lock, TASK_UNINTERRUPTIBLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_locked",
          "args": [
            "bh"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!ret || ret == -EEXIST"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_submit_block",
          "args": [
            "btnc",
            "ptr2",
            "0",
            "READA",
            "&ra_bh",
            "&submit_ptr"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_submit_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "69-133",
          "snippet": "int nilfs_btnode_submit_block(struct address_space *btnc, __u64 blocknr,\n\t\t\t      sector_t pblocknr, int mode,\n\t\t\t      struct buffer_head **pbh, sector_t *submit_ptr)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\tstruct page *page;\n\tint err;\n\n\tbh = nilfs_grab_buffer(inode, btnc, blocknr, 1 << BH_NILFS_Node);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\terr = -EEXIST; /* internal code */\n\tpage = bh->b_page;\n\n\tif (buffer_uptodate(bh) || buffer_dirty(bh))\n\t\tgoto found;\n\n\tif (pblocknr == 0) {\n\t\tpblocknr = blocknr;\n\t\tif (inode->i_ino != NILFS_DAT_INO) {\n\t\t\tstruct the_nilfs *nilfs = inode->i_sb->s_fs_info;\n\n\t\t\t/* blocknr is a virtual block number */\n\t\t\terr = nilfs_dat_translate(nilfs->ns_dat, blocknr,\n\t\t\t\t\t\t  &pblocknr);\n\t\t\tif (unlikely(err)) {\n\t\t\t\tbrelse(bh);\n\t\t\t\tgoto out_locked;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (mode == READA) {\n\t\tif (pblocknr != *submit_ptr + 1 || !trylock_buffer(bh)) {\n\t\t\terr = -EBUSY; /* internal code */\n\t\t\tbrelse(bh);\n\t\t\tgoto out_locked;\n\t\t}\n\t} else { /* mode == READ */\n\t\tlock_buffer(bh);\n\t}\n\tif (buffer_uptodate(bh)) {\n\t\tunlock_buffer(bh);\n\t\terr = -EEXIST; /* internal code */\n\t\tgoto found;\n\t}\n\tset_buffer_mapped(bh);\n\tbh->b_bdev = inode->i_sb->s_bdev;\n\tbh->b_blocknr = pblocknr; /* set block address for read */\n\tbh->b_end_io = end_buffer_read_sync;\n\tget_bh(bh);\n\tsubmit_bh(mode, bh);\n\tbh->b_blocknr = blocknr; /* set back to the given block address */\n\t*submit_ptr = pblocknr;\n\terr = 0;\nfound:\n\t*pbh = bh;\n\nout_locked:\n\tunlock_page(page);\n\tpage_cache_release(page);\n\treturn err;\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nint nilfs_btnode_submit_block(struct address_space *btnc, __u64 blocknr,\n\t\t\t      sector_t pblocknr, int mode,\n\t\t\t      struct buffer_head **pbh, sector_t *submit_ptr)\n{\n\tstruct buffer_head *bh;\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\tstruct page *page;\n\tint err;\n\n\tbh = nilfs_grab_buffer(inode, btnc, blocknr, 1 << BH_NILFS_Node);\n\tif (unlikely(!bh))\n\t\treturn -ENOMEM;\n\n\terr = -EEXIST; /* internal code */\n\tpage = bh->b_page;\n\n\tif (buffer_uptodate(bh) || buffer_dirty(bh))\n\t\tgoto found;\n\n\tif (pblocknr == 0) {\n\t\tpblocknr = blocknr;\n\t\tif (inode->i_ino != NILFS_DAT_INO) {\n\t\t\tstruct the_nilfs *nilfs = inode->i_sb->s_fs_info;\n\n\t\t\t/* blocknr is a virtual block number */\n\t\t\terr = nilfs_dat_translate(nilfs->ns_dat, blocknr,\n\t\t\t\t\t\t  &pblocknr);\n\t\t\tif (unlikely(err)) {\n\t\t\t\tbrelse(bh);\n\t\t\t\tgoto out_locked;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (mode == READA) {\n\t\tif (pblocknr != *submit_ptr + 1 || !trylock_buffer(bh)) {\n\t\t\terr = -EBUSY; /* internal code */\n\t\t\tbrelse(bh);\n\t\t\tgoto out_locked;\n\t\t}\n\t} else { /* mode == READ */\n\t\tlock_buffer(bh);\n\t}\n\tif (buffer_uptodate(bh)) {\n\t\tunlock_buffer(bh);\n\t\terr = -EEXIST; /* internal code */\n\t\tgoto found;\n\t}\n\tset_buffer_mapped(bh);\n\tbh->b_bdev = inode->i_sb->s_bdev;\n\tbh->b_blocknr = pblocknr; /* set block address for read */\n\tbh->b_end_io = end_buffer_read_sync;\n\tget_bh(bh);\n\tsubmit_bh(mode, bh);\n\tbh->b_blocknr = blocknr; /* set back to the given block address */\n\t*submit_ptr = pblocknr;\n\terr = 0;\nfound:\n\t*pbh = bh;\n\nout_locked:\n\tunlock_page(page);\n\tpage_cache_release(page);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_ptr",
          "args": [
            "ra->node",
            "i",
            "ra->ncmax"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "160-165",
          "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int __nilfs_btree_get_block(const struct nilfs_bmap *btree, __u64 ptr,\n\t\t\t\t   struct buffer_head **bhp,\n\t\t\t\t   const struct nilfs_btree_readahead_info *ra)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh, *ra_bh;\n\tsector_t submit_ptr = 0;\n\tint ret;\n\n\tret = nilfs_btnode_submit_block(btnc, ptr, 0, READ, &bh, &submit_ptr);\n\tif (ret) {\n\t\tif (ret != -EEXIST)\n\t\t\treturn ret;\n\t\tgoto out_check;\n\t}\n\n\tif (ra) {\n\t\tint i, n;\n\t\t__u64 ptr2;\n\n\t\t/* read ahead sibling nodes */\n\t\tfor (n = ra->max_ra_blocks, i = ra->index + 1;\n\t\t     n > 0 && i < ra->ncmax; n--, i++) {\n\t\t\tptr2 = nilfs_btree_node_get_ptr(ra->node, i, ra->ncmax);\n\n\t\t\tret = nilfs_btnode_submit_block(btnc, ptr2, 0, READA,\n\t\t\t\t\t\t\t&ra_bh, &submit_ptr);\n\t\t\tif (likely(!ret || ret == -EEXIST))\n\t\t\t\tbrelse(ra_bh);\n\t\t\telse if (ret != -EBUSY)\n\t\t\t\tbreak;\n\t\t\tif (!buffer_locked(bh))\n\t\t\t\tgoto out_no_wait;\n\t\t}\n\t}\n\n\twait_on_buffer(bh);\n\n out_no_wait:\n\tif (!buffer_uptodate(bh)) {\n\t\tbrelse(bh);\n\t\treturn -EIO;\n\t}\n\n out_check:\n\tif (nilfs_btree_broken_node_block(bh)) {\n\t\tclear_buffer_uptodate(bh);\n\t\tbrelse(bh);\n\t\treturn -EINVAL;\n\t}\n\n\t*bhp = bh;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_bad_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "455-465",
    "snippet": "static int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\"",
            "nilfs_btree_node_get_level(node)",
            "level"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "nilfs_btree_node_get_level(node) != level"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int\nnilfs_btree_bad_node(struct nilfs_btree_node *node, int level)\n{\n\tif (unlikely(nilfs_btree_node_get_level(node) != level)) {\n\t\tdump_stack();\n\t\tprintk(KERN_CRIT \"NILFS: btree level mismatch: %d != %d\\n\",\n\t\t       nilfs_btree_node_get_level(node), level);\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_get_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "438-453",
    "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_nchildren_per_block",
          "args": [
            "btree"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_nchildren_per_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "129-132",
          "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_nonroot_node",
          "args": [
            "path",
            "level"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_nonroot_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "421-425",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_height",
          "args": [
            "btree"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "433-436",
          "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_node(const struct nilfs_bmap *btree,\n\t\t     const struct nilfs_btree_path *path,\n\t\t     int level, int *ncmaxp)\n{\n\tstruct nilfs_btree_node *node;\n\n\tif (level == nilfs_btree_height(btree) - 1) {\n\t\tnode = nilfs_btree_get_root(btree);\n\t\t*ncmaxp = NILFS_BTREE_ROOT_NCHILDREN_MAX;\n\t} else {\n\t\tnode = nilfs_btree_get_nonroot_node(path, level);\n\t\t*ncmaxp = nilfs_btree_nchildren_per_block(btree);\n\t}\n\treturn node;\n}"
  },
  {
    "function_name": "nilfs_btree_height",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "433-436",
    "snippet": "static int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "nilfs_btree_get_root(btree)"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_get_root",
          "args": [
            "btree"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_get_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "415-419",
          "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_height(const struct nilfs_bmap *btree)\n{\n\treturn nilfs_btree_node_get_level(nilfs_btree_get_root(btree)) + 1;\n}"
  },
  {
    "function_name": "nilfs_btree_get_sib_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "427-431",
    "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_sib_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_sib_bh->b_data;\n}"
  },
  {
    "function_name": "nilfs_btree_get_nonroot_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "421-425",
    "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_nonroot_node(const struct nilfs_btree_path *path, int level)\n{\n\treturn (struct nilfs_btree_node *)path[level].bp_bh->b_data;\n}"
  },
  {
    "function_name": "nilfs_btree_get_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "415-419",
    "snippet": "static struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_node *\nnilfs_btree_get_root(const struct nilfs_bmap *btree)\n{\n\treturn (struct nilfs_btree_node *)btree->b_u.u_data;\n}"
  },
  {
    "function_name": "nilfs_btree_broken_node_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "401-413",
    "snippet": "int nilfs_btree_broken_node_block(struct buffer_head *bh)\n{\n\tint ret;\n\n\tif (buffer_nilfs_checked(bh))\n\t\treturn 0;\n\n\tret = nilfs_btree_node_broken((struct nilfs_btree_node *)bh->b_data,\n\t\t\t\t       bh->b_size, bh->b_blocknr);\n\tif (likely(!ret))\n\t\tset_buffer_nilfs_checked(bh);\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_buffer_nilfs_checked",
          "args": [
            "bh"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!ret"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_broken",
          "args": [
            "(struct nilfs_btree_node *)bh->b_data",
            "bh->b_size",
            "bh->b_blocknr"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_broken",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "350-371",
          "snippet": "static int nilfs_btree_node_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   size_t size, sector_t blocknr)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level >= NILFS_BTREE_LEVEL_MAX ||\n\t\t     (flags & NILFS_BTREE_NODE_ROOT) ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_NODE_NCHILDREN_MAX(size))) {\n\t\tprintk(KERN_CRIT \"NILFS: bad btree node (blocknr=%llu): \"\n\t\t       \"level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t       (unsigned long long)blocknr, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   size_t size, sector_t blocknr)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level >= NILFS_BTREE_LEVEL_MAX ||\n\t\t     (flags & NILFS_BTREE_NODE_ROOT) ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_NODE_NCHILDREN_MAX(size))) {\n\t\tprintk(KERN_CRIT \"NILFS: bad btree node (blocknr=%llu): \"\n\t\t       \"level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t       (unsigned long long)blocknr, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_nilfs_checked",
          "args": [
            "bh"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nint nilfs_btree_broken_node_block(struct buffer_head *bh)\n{\n\tint ret;\n\n\tif (buffer_nilfs_checked(bh))\n\t\treturn 0;\n\n\tret = nilfs_btree_node_broken((struct nilfs_btree_node *)bh->b_data,\n\t\t\t\t       bh->b_size, bh->b_blocknr);\n\tif (likely(!ret))\n\t\tset_buffer_nilfs_checked(bh);\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_root_broken",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "380-399",
    "snippet": "static int nilfs_btree_root_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   unsigned long ino)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level > NILFS_BTREE_LEVEL_MAX ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_ROOT_NCHILDREN_MAX)) {\n\t\tpr_crit(\"NILFS: bad btree root (inode number=%lu): level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t\tino, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_crit",
          "args": [
            "\"NILFS: bad btree root (inode number=%lu): level = %d, flags = 0x%x, nchildren = %d\\n\"",
            "ino",
            "level",
            "flags",
            "nchildren"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level > NILFS_BTREE_LEVEL_MAX ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_ROOT_NCHILDREN_MAX"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_flags",
          "args": [
            "node"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "86-89",
          "snippet": "static int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_root_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   unsigned long ino)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level > NILFS_BTREE_LEVEL_MAX ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_ROOT_NCHILDREN_MAX)) {\n\t\tpr_crit(\"NILFS: bad btree root (inode number=%lu): level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t\tino, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_node_broken",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "350-371",
    "snippet": "static int nilfs_btree_node_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   size_t size, sector_t blocknr)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level >= NILFS_BTREE_LEVEL_MAX ||\n\t\t     (flags & NILFS_BTREE_NODE_ROOT) ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_NODE_NCHILDREN_MAX(size))) {\n\t\tprintk(KERN_CRIT \"NILFS: bad btree node (blocknr=%llu): \"\n\t\t       \"level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t       (unsigned long long)blocknr, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_CRIT \"NILFS: bad btree node (blocknr=%llu): \"\n\t\t       \"level = %d, flags = 0x%x, nchildren = %d\\n\"",
            "(unsigned long long)blocknr",
            "level",
            "flags",
            "nchildren"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level >= NILFS_BTREE_LEVEL_MAX ||\n\t\t     (flags & NILFS_BTREE_NODE_ROOT) ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_NODE_NCHILDREN_MAX(size)"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NILFS_BTREE_NODE_NCHILDREN_MAX",
          "args": [
            "size"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_flags",
          "args": [
            "node"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "86-89",
          "snippet": "static int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_broken(const struct nilfs_btree_node *node,\n\t\t\t\t   size_t size, sector_t blocknr)\n{\n\tint level, flags, nchildren;\n\tint ret = 0;\n\n\tlevel = nilfs_btree_node_get_level(node);\n\tflags = nilfs_btree_node_get_flags(node);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\n\tif (unlikely(level < NILFS_BTREE_LEVEL_NODE_MIN ||\n\t\t     level >= NILFS_BTREE_LEVEL_MAX ||\n\t\t     (flags & NILFS_BTREE_NODE_ROOT) ||\n\t\t     nchildren < 0 ||\n\t\t     nchildren > NILFS_BTREE_NODE_NCHILDREN_MAX(size))) {\n\t\tprintk(KERN_CRIT \"NILFS: bad btree node (blocknr=%llu): \"\n\t\t       \"level = %d, flags = 0x%x, nchildren = %d\\n\",\n\t\t       (unsigned long long)blocknr, level, flags, nchildren);\n\t\tret = 1;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nilfs_btree_node_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "303-340",
    "snippet": "static int nilfs_btree_node_lookup(const struct nilfs_btree_node *node,\n\t\t\t\t   __u64 key, int *indexp)\n{\n\t__u64 nkey;\n\tint index, low, high, s;\n\n\t/* binary search */\n\tlow = 0;\n\thigh = nilfs_btree_node_get_nchildren(node) - 1;\n\tindex = 0;\n\ts = 0;\n\twhile (low <= high) {\n\t\tindex = (low + high) / 2;\n\t\tnkey = nilfs_btree_node_get_key(node, index);\n\t\tif (nkey == key) {\n\t\t\ts = 0;\n\t\t\tgoto out;\n\t\t} else if (nkey < key) {\n\t\t\tlow = index + 1;\n\t\t\ts = -1;\n\t\t} else {\n\t\t\thigh = index - 1;\n\t\t\ts = 1;\n\t\t}\n\t}\n\n\t/* adjust index */\n\tif (nilfs_btree_node_get_level(node) > NILFS_BTREE_LEVEL_NODE_MIN) {\n\t\tif (s > 0 && index > 0)\n\t\t\tindex--;\n\t} else if (s < 0)\n\t\tindex++;\n\n out:\n\t*indexp = index;\n\n\treturn s == 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_level",
          "args": [
            "node"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "102-105",
          "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_key",
          "args": [
            "node",
            "index"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "148-152",
          "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_lookup(const struct nilfs_btree_node *node,\n\t\t\t\t   __u64 key, int *indexp)\n{\n\t__u64 nkey;\n\tint index, low, high, s;\n\n\t/* binary search */\n\tlow = 0;\n\thigh = nilfs_btree_node_get_nchildren(node) - 1;\n\tindex = 0;\n\ts = 0;\n\twhile (low <= high) {\n\t\tindex = (low + high) / 2;\n\t\tnkey = nilfs_btree_node_get_key(node, index);\n\t\tif (nkey == key) {\n\t\t\ts = 0;\n\t\t\tgoto out;\n\t\t} else if (nkey < key) {\n\t\t\tlow = index + 1;\n\t\t\ts = -1;\n\t\t} else {\n\t\t\thigh = index - 1;\n\t\t\ts = 1;\n\t\t}\n\t}\n\n\t/* adjust index */\n\tif (nilfs_btree_node_get_level(node) > NILFS_BTREE_LEVEL_NODE_MIN) {\n\t\tif (s > 0 && index > 0)\n\t\t\tindex--;\n\t} else if (s < 0)\n\t\tindex++;\n\n out:\n\t*indexp = index;\n\n\treturn s == 0;\n}"
  },
  {
    "function_name": "nilfs_btree_node_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "274-301",
    "snippet": "static void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_nchildren",
          "args": [
            "node",
            "nchildren"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "118-122",
          "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "dptrs + index",
            "dptrs + index + 1",
            "(nchildren - index - 1) * sizeof(*dptrs)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "dkeys + index",
            "dkeys + index + 1",
            "(nchildren - index - 1) * sizeof(*dkeys)"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "dptrs[index]"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_delete(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 *keyp, __u64 *ptrp, int ncmax)\n{\n\t__u64 key;\n\t__u64 ptr;\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tkey = le64_to_cpu(dkeys[index]);\n\tptr = le64_to_cpu(dptrs[index]);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (keyp != NULL)\n\t\t*keyp = key;\n\tif (ptrp != NULL)\n\t\t*ptrp = ptr;\n\n\tif (index < nchildren - 1) {\n\t\tmemmove(dkeys + index, dkeys + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index, dptrs + index + 1,\n\t\t\t(nchildren - index - 1) * sizeof(*dptrs));\n\t}\n\tnchildren--;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "251-271",
    "snippet": "static void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_nchildren",
          "args": [
            "node",
            "nchildren"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "118-122",
          "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptr"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "dptrs + index + 1",
            "dptrs + index",
            "(nchildren - index) * sizeof(*dptrs)"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "dkeys + index + 1",
            "dkeys + index",
            "(nchildren - index) * sizeof(*dkeys)"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "node"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_insert(struct nilfs_btree_node *node, int index,\n\t\t\t\t    __u64 key, __u64 ptr, int ncmax)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint nchildren;\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tnchildren = nilfs_btree_node_get_nchildren(node);\n\tif (index < nchildren) {\n\t\tmemmove(dkeys + index + 1, dkeys + index,\n\t\t\t(nchildren - index) * sizeof(*dkeys));\n\t\tmemmove(dptrs + index + 1, dptrs + index,\n\t\t\t(nchildren - index) * sizeof(*dptrs));\n\t}\n\tdkeys[index] = cpu_to_le64(key);\n\tdptrs[index] = cpu_to_le64(ptr);\n\tnchildren++;\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_move_right",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "223-248",
    "snippet": "static void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_nchildren",
          "args": [
            "right",
            "rnchildren"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "118-122",
          "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "rdptrs",
            "ldptrs + lnchildren - n",
            "n * sizeof(*rdptrs)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "rdkeys",
            "ldkeys + lnchildren - n",
            "n * sizeof(*rdkeys)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "rdptrs + n",
            "rdptrs",
            "rnchildren * sizeof(*rdptrs)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "rdkeys + n",
            "rdkeys",
            "rnchildren * sizeof(*rdkeys)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "right"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "right",
            "rncmax"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "right"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_right(struct nilfs_btree_node *left,\n\t\t\t\t\tstruct nilfs_btree_node *right,\n\t\t\t\t\tint n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemmove(rdkeys + n, rdkeys, rnchildren * sizeof(*rdkeys));\n\tmemmove(rdptrs + n, rdptrs, rnchildren * sizeof(*rdptrs));\n\tmemcpy(rdkeys, ldkeys + lnchildren - n, n * sizeof(*rdkeys));\n\tmemcpy(rdptrs, ldptrs + lnchildren - n, n * sizeof(*rdptrs));\n\n\tlnchildren -= n;\n\trnchildren += n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_move_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "195-220",
    "snippet": "static void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_nchildren",
          "args": [
            "right",
            "rnchildren"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "118-122",
          "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "rdptrs",
            "rdptrs + n",
            "(rnchildren - n) * sizeof(*rdptrs)"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "rdkeys",
            "rdkeys + n",
            "(rnchildren - n) * sizeof(*rdkeys)"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ldptrs + lnchildren",
            "rdptrs",
            "n * sizeof(*rdptrs)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ldkeys + lnchildren",
            "rdkeys",
            "n * sizeof(*rdkeys)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_nchildren",
          "args": [
            "right"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "113-116",
          "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "right",
            "rncmax"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "right"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_move_left(struct nilfs_btree_node *left,\n\t\t\t\t       struct nilfs_btree_node *right,\n\t\t\t\t       int n, int lncmax, int rncmax)\n{\n\t__le64 *ldkeys, *rdkeys;\n\t__le64 *ldptrs, *rdptrs;\n\tint lnchildren, rnchildren;\n\n\tldkeys = nilfs_btree_node_dkeys(left);\n\tldptrs = nilfs_btree_node_dptrs(left, lncmax);\n\tlnchildren = nilfs_btree_node_get_nchildren(left);\n\n\trdkeys = nilfs_btree_node_dkeys(right);\n\trdptrs = nilfs_btree_node_dptrs(right, rncmax);\n\trnchildren = nilfs_btree_node_get_nchildren(right);\n\n\tmemcpy(ldkeys + lnchildren, rdkeys, n * sizeof(*rdkeys));\n\tmemcpy(ldptrs + lnchildren, rdptrs, n * sizeof(*rdptrs));\n\tmemmove(rdkeys, rdkeys + n, (rnchildren - n) * sizeof(*rdkeys));\n\tmemmove(rdptrs, rdptrs + n, (rnchildren - n) * sizeof(*rdptrs));\n\n\tlnchildren += n;\n\trnchildren -= n;\n\tnilfs_btree_node_set_nchildren(left, lnchildren);\n\tnilfs_btree_node_set_nchildren(right, rnchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "174-192",
    "snippet": "static void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptrs[i]"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "keys[i]"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_nchildren",
          "args": [
            "node",
            "nchildren"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_nchildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "118-122",
          "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_level",
          "args": [
            "node",
            "level"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "107-111",
          "snippet": "static void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_set_flags",
          "args": [
            "node",
            "flags"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_set_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "91-95",
          "snippet": "static void\nnilfs_btree_node_set_flags(struct nilfs_btree_node *node, int flags)\n{\n\tnode->bn_flags = flags;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_flags(struct nilfs_btree_node *node, int flags)\n{\n\tnode->bn_flags = flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_node_init(struct nilfs_btree_node *node, int flags,\n\t\t\t\t  int level, int nchildren, int ncmax,\n\t\t\t\t  const __u64 *keys, const __u64 *ptrs)\n{\n\t__le64 *dkeys;\n\t__le64 *dptrs;\n\tint i;\n\n\tnilfs_btree_node_set_flags(node, flags);\n\tnilfs_btree_node_set_level(node, level);\n\tnilfs_btree_node_set_nchildren(node, nchildren);\n\n\tdkeys = nilfs_btree_node_dkeys(node);\n\tdptrs = nilfs_btree_node_dptrs(node, ncmax);\n\tfor (i = 0; i < nchildren; i++) {\n\t\tdkeys[i] = cpu_to_le64(keys[i]);\n\t\tdptrs[i] = cpu_to_le64(ptrs[i]);\n\t}\n}"
  },
  {
    "function_name": "nilfs_btree_node_set_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "167-172",
    "snippet": "static void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "ptr"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_ptr(struct nilfs_btree_node *node, int index, __u64 ptr,\n\t\t\t int ncmax)\n{\n\t*(nilfs_btree_node_dptrs(node, ncmax) + index) = cpu_to_le64(ptr);\n}"
  },
  {
    "function_name": "nilfs_btree_node_get_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "160-165",
    "snippet": "static __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "*(nilfs_btree_node_dptrs(node, ncmax) + index)"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dptrs",
          "args": [
            "node",
            "ncmax"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dptrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "142-146",
          "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_ptr(const struct nilfs_btree_node *node, int index,\n\t\t\t int ncmax)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dptrs(node, ncmax) + index));\n}"
  },
  {
    "function_name": "nilfs_btree_node_set_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "154-158",
    "snippet": "static void\nnilfs_btree_node_set_key(struct nilfs_btree_node *node, int index, __u64 key)\n{\n\t*(nilfs_btree_node_dkeys(node) + index) = cpu_to_le64(key);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le64",
          "args": [
            "key"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_key(struct nilfs_btree_node *node, int index, __u64 key)\n{\n\t*(nilfs_btree_node_dkeys(node) + index) = cpu_to_le64(key);\n}"
  },
  {
    "function_name": "nilfs_btree_node_get_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "148-152",
    "snippet": "static __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "*(nilfs_btree_node_dkeys(node) + index)"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __u64\nnilfs_btree_node_get_key(const struct nilfs_btree_node *node, int index)\n{\n\treturn le64_to_cpu(*(nilfs_btree_node_dkeys(node) + index));\n}"
  },
  {
    "function_name": "nilfs_btree_node_dptrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "142-146",
    "snippet": "static __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_dkeys",
          "args": [
            "node"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_dkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "134-140",
          "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dptrs(const struct nilfs_btree_node *node, int ncmax)\n{\n\treturn (__le64 *)(nilfs_btree_node_dkeys(node) + ncmax);\n}"
  },
  {
    "function_name": "nilfs_btree_node_dkeys",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "134-140",
    "snippet": "static __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_root",
          "args": [
            "node"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "97-100",
          "snippet": "static int nilfs_btree_node_root(const struct nilfs_btree_node *node)\n{\n\treturn nilfs_btree_node_get_flags(node) & NILFS_BTREE_NODE_ROOT;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_root(const struct nilfs_btree_node *node)\n{\n\treturn nilfs_btree_node_get_flags(node) & NILFS_BTREE_NODE_ROOT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic __le64 *\nnilfs_btree_node_dkeys(const struct nilfs_btree_node *node)\n{\n\treturn (__le64 *)((char *)(node + 1) +\n\t\t\t  (nilfs_btree_node_root(node) ?\n\t\t\t   0 : NILFS_BTREE_NODE_EXTRA_PAD_SIZE));\n}"
  },
  {
    "function_name": "nilfs_btree_nchildren_per_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "129-132",
    "snippet": "static int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_nchildren_per_block(const struct nilfs_bmap *btree)\n{\n\treturn btree->b_nchildren_per_block;\n}"
  },
  {
    "function_name": "nilfs_btree_node_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "124-127",
    "snippet": "static int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_size(const struct nilfs_bmap *btree)\n{\n\treturn 1 << btree->b_inode->i_blkbits;\n}"
  },
  {
    "function_name": "nilfs_btree_node_set_nchildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "118-122",
    "snippet": "static void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "nchildren"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_nchildren(struct nilfs_btree_node *node, int nchildren)\n{\n\tnode->bn_nchildren = cpu_to_le16(nchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_get_nchildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "113-116",
    "snippet": "static int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "node->bn_nchildren"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_nchildren(const struct nilfs_btree_node *node)\n{\n\treturn le16_to_cpu(node->bn_nchildren);\n}"
  },
  {
    "function_name": "nilfs_btree_node_set_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "107-111",
    "snippet": "static void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_level(struct nilfs_btree_node *node, int level)\n{\n\tnode->bn_level = level;\n}"
  },
  {
    "function_name": "nilfs_btree_node_get_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "102-105",
    "snippet": "static int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_level(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_level;\n}"
  },
  {
    "function_name": "nilfs_btree_node_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "97-100",
    "snippet": "static int nilfs_btree_node_root(const struct nilfs_btree_node *node)\n{\n\treturn nilfs_btree_node_get_flags(node) & NILFS_BTREE_NODE_ROOT;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nilfs_btree_node_get_flags",
          "args": [
            "node"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btree_node_get_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
          "lines": "86-89",
          "snippet": "static int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}",
          "includes": [
            "#include \"dat.h\"",
            "#include \"alloc.h\"",
            "#include \"btree.h\"",
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/pagevec.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_root(const struct nilfs_btree_node *node)\n{\n\treturn nilfs_btree_node_get_flags(node) & NILFS_BTREE_NODE_ROOT;\n}"
  },
  {
    "function_name": "nilfs_btree_node_set_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "91-95",
    "snippet": "static void\nnilfs_btree_node_set_flags(struct nilfs_btree_node *node, int flags)\n{\n\tnode->bn_flags = flags;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void\nnilfs_btree_node_set_flags(struct nilfs_btree_node *node, int flags)\n{\n\tnode->bn_flags = flags;\n}"
  },
  {
    "function_name": "nilfs_btree_node_get_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "86-89",
    "snippet": "static int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_node_get_flags(const struct nilfs_btree_node *node)\n{\n\treturn node->bn_flags;\n}"
  },
  {
    "function_name": "nilfs_btree_get_new_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "71-84",
    "snippet": "static int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_buffer_nilfs_volatile",
          "args": [
            "bh"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nilfs_btnode_create_block",
          "args": [
            "btnc",
            "ptr"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_btnode_create_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btnode.c",
          "lines": "43-67",
          "snippet": "struct buffer_head *\nnilfs_btnode_create_block(struct address_space *btnc, __u64 blocknr)\n{\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_grab_buffer(inode, btnc, blocknr, 1 << BH_NILFS_Node);\n\tif (unlikely(!bh))\n\t\treturn NULL;\n\n\tif (unlikely(buffer_mapped(bh) || buffer_uptodate(bh) ||\n\t\t     buffer_dirty(bh))) {\n\t\tbrelse(bh);\n\t\tBUG();\n\t}\n\tmemset(bh->b_data, 0, 1 << inode->i_blkbits);\n\tbh->b_bdev = inode->i_sb->s_bdev;\n\tbh->b_blocknr = blocknr;\n\tset_buffer_mapped(bh);\n\tset_buffer_uptodate(bh);\n\n\tunlock_page(bh->b_page);\n\tpage_cache_release(bh->b_page);\n\treturn bh;\n}",
          "includes": [
            "#include \"btnode.h\"",
            "#include \"page.h\"",
            "#include \"dat.h\"",
            "#include \"mdt.h\"",
            "#include \"nilfs.h\"",
            "#include <linux/gfp.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"btnode.h\"\n#include \"page.h\"\n#include \"dat.h\"\n#include \"mdt.h\"\n#include \"nilfs.h\"\n#include <linux/gfp.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/buffer_head.h>\n#include <linux/types.h>\n\nstruct buffer_head *\nnilfs_btnode_create_block(struct address_space *btnc, __u64 blocknr)\n{\n\tstruct inode *inode = NILFS_BTNC_I(btnc);\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_grab_buffer(inode, btnc, blocknr, 1 << BH_NILFS_Node);\n\tif (unlikely(!bh))\n\t\treturn NULL;\n\n\tif (unlikely(buffer_mapped(bh) || buffer_uptodate(bh) ||\n\t\t     buffer_dirty(bh))) {\n\t\tbrelse(bh);\n\t\tBUG();\n\t}\n\tmemset(bh->b_data, 0, 1 << inode->i_blkbits);\n\tbh->b_bdev = inode->i_sb->s_bdev;\n\tbh->b_blocknr = blocknr;\n\tset_buffer_mapped(bh);\n\tset_buffer_uptodate(bh);\n\n\tunlock_page(bh->b_page);\n\tpage_cache_release(bh->b_page);\n\treturn bh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NILFS_BMAP_I",
          "args": [
            "btree"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "NILFS_BMAP_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "83-87",
          "snippet": "static inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline struct nilfs_inode_info *\nNILFS_BMAP_I(const struct nilfs_bmap *bmap)\n{\n\treturn container_of(bmap, struct nilfs_inode_info, i_bmap_data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic int nilfs_btree_get_new_block(const struct nilfs_bmap *btree,\n\t\t\t\t     __u64 ptr, struct buffer_head **bhp)\n{\n\tstruct address_space *btnc = &NILFS_BMAP_I(btree)->i_btnode_cache;\n\tstruct buffer_head *bh;\n\n\tbh = nilfs_btnode_create_block(btnc, ptr);\n\tif (!bh)\n\t\treturn -ENOMEM;\n\n\tset_buffer_nilfs_volatile(bh);\n\t*bhp = bh;\n\treturn 0;\n}"
  },
  {
    "function_name": "nilfs_btree_free_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "58-66",
    "snippet": "static void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "nilfs_btree_path_cache",
            "path"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "path[level].bp_bh"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic void nilfs_btree_free_path(struct nilfs_btree_path *path)\n{\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++)\n\t\tbrelse(path[level].bp_bh);\n\n\tkmem_cache_free(nilfs_btree_path_cache, path);\n}"
  },
  {
    "function_name": "nilfs_btree_alloc_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/btree.c",
    "lines": "36-56",
    "snippet": "static struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}",
    "includes": [
      "#include \"dat.h\"",
      "#include \"alloc.h\"",
      "#include \"btree.h\"",
      "#include \"btnode.h\"",
      "#include \"page.h\"",
      "#include \"nilfs.h\"",
      "#include <linux/pagevec.h>",
      "#include <linux/errno.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "nilfs_btree_path_cache",
            "GFP_NOFS"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"dat.h\"\n#include \"alloc.h\"\n#include \"btree.h\"\n#include \"btnode.h\"\n#include \"page.h\"\n#include \"nilfs.h\"\n#include <linux/pagevec.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n\nstatic struct nilfs_btree_path *nilfs_btree_alloc_path(void)\n{\n\tstruct nilfs_btree_path *path;\n\tint level = NILFS_BTREE_LEVEL_DATA;\n\n\tpath = kmem_cache_alloc(nilfs_btree_path_cache, GFP_NOFS);\n\tif (path == NULL)\n\t\tgoto out;\n\n\tfor (; level < NILFS_BTREE_LEVEL_MAX; level++) {\n\t\tpath[level].bp_bh = NULL;\n\t\tpath[level].bp_sib_bh = NULL;\n\t\tpath[level].bp_index = 0;\n\t\tpath[level].bp_oldreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_newreq.bpr_ptr = NILFS_BMAP_INVALID_PTR;\n\t\tpath[level].bp_op = NULL;\n\t}\n\nout:\n\treturn path;\n}"
  }
]