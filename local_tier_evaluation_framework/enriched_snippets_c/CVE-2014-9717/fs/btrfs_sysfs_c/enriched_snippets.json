[
  {
    "function_name": "btrfs_exit_sysfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "752-757",
    "snippet": "void btrfs_exit_sysfs(void)\n{\n\tsysfs_remove_group(&btrfs_kset->kobj, &btrfs_feature_attr_group);\n\tkset_unregister(btrfs_kset);\n\tdebugfs_remove_recursive(btrfs_debugfs_root_dentry);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};",
      "static struct kset *btrfs_kset;",
      "static struct dentry *btrfs_debugfs_root_dentry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "btrfs_debugfs_root_dentry"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_remove_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "580-641",
          "snippet": "void debugfs_remove_recursive(struct dentry *dentry)\n{\n\tstruct dentry *child, *parent;\n\n\tif (IS_ERR_OR_NULL(dentry))\n\t\treturn;\n\n\tparent = dentry->d_parent;\n\tif (!parent || !parent->d_inode)\n\t\treturn;\n\n\tparent = dentry;\n down:\n\tmutex_lock(&parent->d_inode->i_mutex);\n loop:\n\t/*\n\t * The parent->d_subdirs is protected by the d_lock. Outside that\n\t * lock, the child can be unlinked and set to be freed which can\n\t * use the d_u.d_child as the rcu head and corrupt this list.\n\t */\n\tspin_lock(&parent->d_lock);\n\tlist_for_each_entry(child, &parent->d_subdirs, d_child) {\n\t\tif (!debugfs_positive(child))\n\t\t\tcontinue;\n\n\t\t/* perhaps simple_empty(child) makes more sense */\n\t\tif (!list_empty(&child->d_subdirs)) {\n\t\t\tspin_unlock(&parent->d_lock);\n\t\t\tmutex_unlock(&parent->d_inode->i_mutex);\n\t\t\tparent = child;\n\t\t\tgoto down;\n\t\t}\n\n\t\tspin_unlock(&parent->d_lock);\n\n\t\tif (!__debugfs_remove(child, parent))\n\t\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\n\t\t/*\n\t\t * The parent->d_lock protects agaist child from unlinking\n\t\t * from d_subdirs. When releasing the parent->d_lock we can\n\t\t * no longer trust that the next pointer is valid.\n\t\t * Restart the loop. We'll skip this one with the\n\t\t * debugfs_positive() check.\n\t\t */\n\t\tgoto loop;\n\t}\n\tspin_unlock(&parent->d_lock);\n\n\tmutex_unlock(&parent->d_inode->i_mutex);\n\tchild = parent;\n\tparent = parent->d_parent;\n\tmutex_lock(&parent->d_inode->i_mutex);\n\n\tif (child != dentry)\n\t\t/* go up */\n\t\tgoto loop;\n\n\tif (!__debugfs_remove(child, parent))\n\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\tmutex_unlock(&parent->d_inode->i_mutex);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct vfsmount *debugfs_mount;",
            "static int debugfs_mount_count;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic struct vfsmount *debugfs_mount;\nstatic int debugfs_mount_count;\n\nvoid debugfs_remove_recursive(struct dentry *dentry)\n{\n\tstruct dentry *child, *parent;\n\n\tif (IS_ERR_OR_NULL(dentry))\n\t\treturn;\n\n\tparent = dentry->d_parent;\n\tif (!parent || !parent->d_inode)\n\t\treturn;\n\n\tparent = dentry;\n down:\n\tmutex_lock(&parent->d_inode->i_mutex);\n loop:\n\t/*\n\t * The parent->d_subdirs is protected by the d_lock. Outside that\n\t * lock, the child can be unlinked and set to be freed which can\n\t * use the d_u.d_child as the rcu head and corrupt this list.\n\t */\n\tspin_lock(&parent->d_lock);\n\tlist_for_each_entry(child, &parent->d_subdirs, d_child) {\n\t\tif (!debugfs_positive(child))\n\t\t\tcontinue;\n\n\t\t/* perhaps simple_empty(child) makes more sense */\n\t\tif (!list_empty(&child->d_subdirs)) {\n\t\t\tspin_unlock(&parent->d_lock);\n\t\t\tmutex_unlock(&parent->d_inode->i_mutex);\n\t\t\tparent = child;\n\t\t\tgoto down;\n\t\t}\n\n\t\tspin_unlock(&parent->d_lock);\n\n\t\tif (!__debugfs_remove(child, parent))\n\t\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\n\t\t/*\n\t\t * The parent->d_lock protects agaist child from unlinking\n\t\t * from d_subdirs. When releasing the parent->d_lock we can\n\t\t * no longer trust that the next pointer is valid.\n\t\t * Restart the loop. We'll skip this one with the\n\t\t * debugfs_positive() check.\n\t\t */\n\t\tgoto loop;\n\t}\n\tspin_unlock(&parent->d_lock);\n\n\tmutex_unlock(&parent->d_inode->i_mutex);\n\tchild = parent;\n\tparent = parent->d_parent;\n\tmutex_lock(&parent->d_inode->i_mutex);\n\n\tif (child != dentry)\n\t\t/* go up */\n\t\tgoto loop;\n\n\tif (!__debugfs_remove(child, parent))\n\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\tmutex_unlock(&parent->d_inode->i_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "btrfs_kset"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&btrfs_kset->kobj",
            "&btrfs_feature_attr_group"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "243-252",
          "snippet": "void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};\nstatic struct kset *btrfs_kset;\nstatic struct dentry *btrfs_debugfs_root_dentry;\n\nvoid btrfs_exit_sysfs(void)\n{\n\tsysfs_remove_group(&btrfs_kset->kobj, &btrfs_feature_attr_group);\n\tkset_unregister(btrfs_kset);\n\tdebugfs_remove_recursive(btrfs_debugfs_root_dentry);\n}"
  },
  {
    "function_name": "btrfs_init_sysfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "726-750",
    "snippet": "int btrfs_init_sysfs(void)\n{\n\tint ret;\n\n\tbtrfs_kset = kset_create_and_add(\"btrfs\", NULL, fs_kobj);\n\tif (!btrfs_kset)\n\t\treturn -ENOMEM;\n\n\tret = btrfs_init_debugfs();\n\tif (ret)\n\t\tgoto out1;\n\n\tinit_feature_attrs();\n\tret = sysfs_create_group(&btrfs_kset->kobj, &btrfs_feature_attr_group);\n\tif (ret)\n\t\tgoto out2;\n\n\treturn 0;\nout2:\n\tdebugfs_remove_recursive(btrfs_debugfs_root_dentry);\nout1:\n\tkset_unregister(btrfs_kset);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};",
      "static struct kset *btrfs_kset;",
      "static struct dentry *btrfs_debugfs_root_dentry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "btrfs_kset"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "btrfs_debugfs_root_dentry"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_remove_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "580-641",
          "snippet": "void debugfs_remove_recursive(struct dentry *dentry)\n{\n\tstruct dentry *child, *parent;\n\n\tif (IS_ERR_OR_NULL(dentry))\n\t\treturn;\n\n\tparent = dentry->d_parent;\n\tif (!parent || !parent->d_inode)\n\t\treturn;\n\n\tparent = dentry;\n down:\n\tmutex_lock(&parent->d_inode->i_mutex);\n loop:\n\t/*\n\t * The parent->d_subdirs is protected by the d_lock. Outside that\n\t * lock, the child can be unlinked and set to be freed which can\n\t * use the d_u.d_child as the rcu head and corrupt this list.\n\t */\n\tspin_lock(&parent->d_lock);\n\tlist_for_each_entry(child, &parent->d_subdirs, d_child) {\n\t\tif (!debugfs_positive(child))\n\t\t\tcontinue;\n\n\t\t/* perhaps simple_empty(child) makes more sense */\n\t\tif (!list_empty(&child->d_subdirs)) {\n\t\t\tspin_unlock(&parent->d_lock);\n\t\t\tmutex_unlock(&parent->d_inode->i_mutex);\n\t\t\tparent = child;\n\t\t\tgoto down;\n\t\t}\n\n\t\tspin_unlock(&parent->d_lock);\n\n\t\tif (!__debugfs_remove(child, parent))\n\t\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\n\t\t/*\n\t\t * The parent->d_lock protects agaist child from unlinking\n\t\t * from d_subdirs. When releasing the parent->d_lock we can\n\t\t * no longer trust that the next pointer is valid.\n\t\t * Restart the loop. We'll skip this one with the\n\t\t * debugfs_positive() check.\n\t\t */\n\t\tgoto loop;\n\t}\n\tspin_unlock(&parent->d_lock);\n\n\tmutex_unlock(&parent->d_inode->i_mutex);\n\tchild = parent;\n\tparent = parent->d_parent;\n\tmutex_lock(&parent->d_inode->i_mutex);\n\n\tif (child != dentry)\n\t\t/* go up */\n\t\tgoto loop;\n\n\tif (!__debugfs_remove(child, parent))\n\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\tmutex_unlock(&parent->d_inode->i_mutex);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct vfsmount *debugfs_mount;",
            "static int debugfs_mount_count;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic struct vfsmount *debugfs_mount;\nstatic int debugfs_mount_count;\n\nvoid debugfs_remove_recursive(struct dentry *dentry)\n{\n\tstruct dentry *child, *parent;\n\n\tif (IS_ERR_OR_NULL(dentry))\n\t\treturn;\n\n\tparent = dentry->d_parent;\n\tif (!parent || !parent->d_inode)\n\t\treturn;\n\n\tparent = dentry;\n down:\n\tmutex_lock(&parent->d_inode->i_mutex);\n loop:\n\t/*\n\t * The parent->d_subdirs is protected by the d_lock. Outside that\n\t * lock, the child can be unlinked and set to be freed which can\n\t * use the d_u.d_child as the rcu head and corrupt this list.\n\t */\n\tspin_lock(&parent->d_lock);\n\tlist_for_each_entry(child, &parent->d_subdirs, d_child) {\n\t\tif (!debugfs_positive(child))\n\t\t\tcontinue;\n\n\t\t/* perhaps simple_empty(child) makes more sense */\n\t\tif (!list_empty(&child->d_subdirs)) {\n\t\t\tspin_unlock(&parent->d_lock);\n\t\t\tmutex_unlock(&parent->d_inode->i_mutex);\n\t\t\tparent = child;\n\t\t\tgoto down;\n\t\t}\n\n\t\tspin_unlock(&parent->d_lock);\n\n\t\tif (!__debugfs_remove(child, parent))\n\t\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\n\t\t/*\n\t\t * The parent->d_lock protects agaist child from unlinking\n\t\t * from d_subdirs. When releasing the parent->d_lock we can\n\t\t * no longer trust that the next pointer is valid.\n\t\t * Restart the loop. We'll skip this one with the\n\t\t * debugfs_positive() check.\n\t\t */\n\t\tgoto loop;\n\t}\n\tspin_unlock(&parent->d_lock);\n\n\tmutex_unlock(&parent->d_inode->i_mutex);\n\tchild = parent;\n\tparent = parent->d_parent;\n\tmutex_lock(&parent->d_inode->i_mutex);\n\n\tif (child != dentry)\n\t\t/* go up */\n\t\tgoto loop;\n\n\tif (!__debugfs_remove(child, parent))\n\t\tsimple_release_fs(&debugfs_mount, &debugfs_mount_count);\n\tmutex_unlock(&parent->d_inode->i_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&btrfs_kset->kobj",
            "&btrfs_feature_attr_group"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "155-173",
          "snippet": "int sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_feature_attrs",
          "args": [],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "init_feature_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "561-603",
          "snippet": "static void init_feature_attrs(void)\n{\n\tstruct btrfs_feature_attr *fa;\n\tint set, i;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs));\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names[0]) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs[0]));\n\n\tmemset(btrfs_feature_attrs, 0, sizeof(btrfs_feature_attrs));\n\tmemset(btrfs_unknown_feature_names, 0,\n\t       sizeof(btrfs_unknown_feature_names));\n\n\tfor (i = 0; btrfs_supported_feature_attrs[i]; i++) {\n\t\tstruct btrfs_feature_attr *sfa;\n\t\tstruct attribute *a = btrfs_supported_feature_attrs[i];\n\t\tint bit;\n\t\tsfa = attr_to_btrfs_feature_attr(a);\n\t\tbit = ilog2(sfa->feature_bit);\n\t\tfa = &btrfs_feature_attrs[sfa->feature_set][bit];\n\n\t\tfa->kobj_attr.attr.name = sfa->kobj_attr.attr.name;\n\t}\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\t\tchar *name = btrfs_unknown_feature_names[set][i];\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\n\t\t\tif (fa->kobj_attr.attr.name)\n\t\t\t\tcontinue;\n\n\t\t\tsnprintf(name, 13, \"%s:%u\",\n\t\t\t\t btrfs_feature_set_names[set], i);\n\n\t\t\tfa->kobj_attr.attr.name = name;\n\t\t\tfa->kobj_attr.attr.mode = S_IRUGO;\n\t\t\tfa->feature_set = set;\n\t\t\tfa->feature_bit = 1ULL << i;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct attribute *btrfs_supported_feature_attrs[] = {\n\tBTRFS_FEAT_ATTR_PTR(mixed_backref),\n\tBTRFS_FEAT_ATTR_PTR(default_subvol),\n\tBTRFS_FEAT_ATTR_PTR(mixed_groups),\n\tBTRFS_FEAT_ATTR_PTR(compress_lzo),\n\tBTRFS_FEAT_ATTR_PTR(big_metadata),\n\tBTRFS_FEAT_ATTR_PTR(extended_iref),\n\tBTRFS_FEAT_ATTR_PTR(raid56),\n\tBTRFS_FEAT_ATTR_PTR(skinny_metadata),\n\tBTRFS_FEAT_ATTR_PTR(no_holes),\n\tNULL\n};",
            "static char btrfs_unknown_feature_names[3][NUM_FEATURE_BITS][13];",
            "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];",
            "const char * const btrfs_feature_set_names[3] = {\n\t[FEAT_COMPAT]\t = \"compat\",\n\t[FEAT_COMPAT_RO] = \"compat_ro\",\n\t[FEAT_INCOMPAT]\t = \"incompat\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct attribute *btrfs_supported_feature_attrs[] = {\n\tBTRFS_FEAT_ATTR_PTR(mixed_backref),\n\tBTRFS_FEAT_ATTR_PTR(default_subvol),\n\tBTRFS_FEAT_ATTR_PTR(mixed_groups),\n\tBTRFS_FEAT_ATTR_PTR(compress_lzo),\n\tBTRFS_FEAT_ATTR_PTR(big_metadata),\n\tBTRFS_FEAT_ATTR_PTR(extended_iref),\n\tBTRFS_FEAT_ATTR_PTR(raid56),\n\tBTRFS_FEAT_ATTR_PTR(skinny_metadata),\n\tBTRFS_FEAT_ATTR_PTR(no_holes),\n\tNULL\n};\nstatic char btrfs_unknown_feature_names[3][NUM_FEATURE_BITS][13];\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\nconst char * const btrfs_feature_set_names[3] = {\n\t[FEAT_COMPAT]\t = \"compat\",\n\t[FEAT_COMPAT_RO] = \"compat_ro\",\n\t[FEAT_INCOMPAT]\t = \"incompat\",\n};\n\nstatic void init_feature_attrs(void)\n{\n\tstruct btrfs_feature_attr *fa;\n\tint set, i;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs));\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names[0]) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs[0]));\n\n\tmemset(btrfs_feature_attrs, 0, sizeof(btrfs_feature_attrs));\n\tmemset(btrfs_unknown_feature_names, 0,\n\t       sizeof(btrfs_unknown_feature_names));\n\n\tfor (i = 0; btrfs_supported_feature_attrs[i]; i++) {\n\t\tstruct btrfs_feature_attr *sfa;\n\t\tstruct attribute *a = btrfs_supported_feature_attrs[i];\n\t\tint bit;\n\t\tsfa = attr_to_btrfs_feature_attr(a);\n\t\tbit = ilog2(sfa->feature_bit);\n\t\tfa = &btrfs_feature_attrs[sfa->feature_set][bit];\n\n\t\tfa->kobj_attr.attr.name = sfa->kobj_attr.attr.name;\n\t}\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\t\tchar *name = btrfs_unknown_feature_names[set][i];\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\n\t\t\tif (fa->kobj_attr.attr.name)\n\t\t\t\tcontinue;\n\n\t\t\tsnprintf(name, 13, \"%s:%u\",\n\t\t\t\t btrfs_feature_set_names[set], i);\n\n\t\t\tfa->kobj_attr.attr.name = name;\n\t\t\tfa->kobj_attr.attr.mode = S_IRUGO;\n\t\t\tfa->feature_set = set;\n\t\t\tfa->feature_bit = 1ULL << i;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_init_debugfs",
          "args": [],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_init_debugfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "713-724",
          "snippet": "static int btrfs_init_debugfs(void)\n{\n#ifdef CONFIG_DEBUG_FS\n\tbtrfs_debugfs_root_dentry = debugfs_create_dir(\"btrfs\", NULL);\n\tif (!btrfs_debugfs_root_dentry)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"test\", S_IRUGO | S_IWUGO, btrfs_debugfs_root_dentry,\n\t\t\t&btrfs_debugfs_test);\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *btrfs_debugfs_root_dentry;",
            "u64 btrfs_debugfs_test;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *btrfs_debugfs_root_dentry;\nu64 btrfs_debugfs_test;\n\nstatic int btrfs_init_debugfs(void)\n{\n#ifdef CONFIG_DEBUG_FS\n\tbtrfs_debugfs_root_dentry = debugfs_create_dir(\"btrfs\", NULL);\n\tif (!btrfs_debugfs_root_dentry)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"test\", S_IRUGO | S_IWUGO, btrfs_debugfs_root_dentry,\n\t\t\t&btrfs_debugfs_test);\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "\"btrfs\"",
            "NULL",
            "fs_kobj"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};\nstatic struct kset *btrfs_kset;\nstatic struct dentry *btrfs_debugfs_root_dentry;\n\nint btrfs_init_sysfs(void)\n{\n\tint ret;\n\n\tbtrfs_kset = kset_create_and_add(\"btrfs\", NULL, fs_kobj);\n\tif (!btrfs_kset)\n\t\treturn -ENOMEM;\n\n\tret = btrfs_init_debugfs();\n\tif (ret)\n\t\tgoto out1;\n\n\tinit_feature_attrs();\n\tret = sysfs_create_group(&btrfs_kset->kobj, &btrfs_feature_attr_group);\n\tif (ret)\n\t\tgoto out2;\n\n\treturn 0;\nout2:\n\tdebugfs_remove_recursive(btrfs_debugfs_root_dentry);\nout1:\n\tkset_unregister(btrfs_kset);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "btrfs_init_debugfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "713-724",
    "snippet": "static int btrfs_init_debugfs(void)\n{\n#ifdef CONFIG_DEBUG_FS\n\tbtrfs_debugfs_root_dentry = debugfs_create_dir(\"btrfs\", NULL);\n\tif (!btrfs_debugfs_root_dentry)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"test\", S_IRUGO | S_IWUGO, btrfs_debugfs_root_dentry,\n\t\t\t&btrfs_debugfs_test);\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *btrfs_debugfs_root_dentry;",
      "u64 btrfs_debugfs_test;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"test\"",
            "S_IRUGO | S_IWUGO",
            "btrfs_debugfs_root_dentry",
            "&btrfs_debugfs_test"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_u64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/file.c",
          "lines": "252-263",
          "snippet": "struct dentry *debugfs_create_u64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u64);\n}",
          "includes": [
            "#include <linux/device.h>",
            "#include <linux/atomic.h>",
            "#include <linux/slab.h>",
            "#include <linux/io.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/device.h>\n#include <linux/atomic.h>\n#include <linux/slab.h>\n#include <linux/io.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_u64(const char *name, umode_t mode,\n\t\t\t\t struct dentry *parent, u64 *value)\n{\n\t/* if there are no write bits set, make read only */\n\tif (!(mode & S_IWUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_ro);\n\t/* if there are no read bits set, make write only */\n\tif (!(mode & S_IRUGO))\n\t\treturn debugfs_create_file(name, mode, parent, value, &fops_u64_wo);\n\n\treturn debugfs_create_file(name, mode, parent, value, &fops_u64);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"btrfs\"",
            "NULL"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "debugfs_create_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/debugfs/inode.c",
          "lines": "407-429",
          "snippet": "struct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/parser.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/string.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/kobject.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/parser.h>\n#include <linux/seq_file.h>\n#include <linux/string.h>\n#include <linux/fsnotify.h>\n#include <linux/debugfs.h>\n#include <linux/namei.h>\n#include <linux/kobject.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstruct dentry *debugfs_create_dir(const char *name, struct dentry *parent)\n{\n\tstruct dentry *dentry = start_creating(name, parent);\n\tstruct inode *inode;\n\n\tif (IS_ERR(dentry))\n\t\treturn NULL;\n\n\tinode = debugfs_get_inode(dentry->d_sb);\n\tif (unlikely(!inode))\n\t\treturn failed_creating(dentry);\n\n\tinode->i_mode = S_IFDIR | S_IRWXU | S_IRUGO | S_IXUGO;\n\tinode->i_op = &simple_dir_inode_operations;\n\tinode->i_fop = &simple_dir_operations;\n\n\t/* directory inodes start off with i_nlink == 2 (for \".\" entry) */\n\tinc_nlink(inode);\n\td_instantiate(dentry, inode);\n\tinc_nlink(dentry->d_parent->d_inode);\n\tfsnotify_mkdir(dentry->d_parent->d_inode, dentry);\n\treturn end_creating(dentry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct dentry *btrfs_debugfs_root_dentry;\nu64 btrfs_debugfs_test;\n\nstatic int btrfs_init_debugfs(void)\n{\n#ifdef CONFIG_DEBUG_FS\n\tbtrfs_debugfs_root_dentry = debugfs_create_dir(\"btrfs\", NULL);\n\tif (!btrfs_debugfs_root_dentry)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"test\", S_IRUGO | S_IWUGO, btrfs_debugfs_root_dentry,\n\t\t\t&btrfs_debugfs_test);\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "btrfs_sysfs_add_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "670-711",
    "snippet": "int btrfs_sysfs_add_one(struct btrfs_fs_info *fs_info)\n{\n\tint error;\n\n\tinit_completion(&fs_info->kobj_unregister);\n\tfs_info->super_kobj.kset = btrfs_kset;\n\terror = kobject_init_and_add(&fs_info->super_kobj, &btrfs_ktype, NULL,\n\t\t\t\t     \"%pU\", fs_info->fsid);\n\tif (error)\n\t\treturn error;\n\n\terror = sysfs_create_group(&fs_info->super_kobj,\n\t\t\t\t   &btrfs_feature_attr_group);\n\tif (error) {\n\t\t__btrfs_sysfs_remove_one(fs_info);\n\t\treturn error;\n\t}\n\n\terror = addrm_unknown_feature_attrs(fs_info, true);\n\tif (error)\n\t\tgoto failure;\n\n\terror = btrfs_kobj_add_device(fs_info, NULL);\n\tif (error)\n\t\tgoto failure;\n\n\tfs_info->space_info_kobj = kobject_create_and_add(\"allocation\",\n\t\t\t\t\t\t  &fs_info->super_kobj);\n\tif (!fs_info->space_info_kobj) {\n\t\terror = -ENOMEM;\n\t\tgoto failure;\n\t}\n\n\terror = sysfs_create_files(fs_info->space_info_kobj, allocation_attrs);\n\tif (error)\n\t\tgoto failure;\n\n\treturn 0;\nfailure:\n\tbtrfs_sysfs_remove_one(fs_info);\n\treturn error;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};",
      "static const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};",
      "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};",
      "static struct kset *btrfs_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_sysfs_remove_one",
          "args": [
            "fs_info"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_sysfs_remove_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "516-528",
          "snippet": "void btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tif (fs_info->space_info_kobj) {\n\t\tsysfs_remove_files(fs_info->space_info_kobj, allocation_attrs);\n\t\tkobject_del(fs_info->space_info_kobj);\n\t\tkobject_put(fs_info->space_info_kobj);\n\t}\n\tkobject_del(fs_info->device_dir_kobj);\n\tkobject_put(fs_info->device_dir_kobj);\n\taddrm_unknown_feature_attrs(fs_info, false);\n\tsysfs_remove_group(&fs_info->super_kobj, &btrfs_feature_attr_group);\n\t__btrfs_sysfs_remove_one(fs_info);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};",
            "static const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};\nstatic const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};\n\nvoid btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tif (fs_info->space_info_kobj) {\n\t\tsysfs_remove_files(fs_info->space_info_kobj, allocation_attrs);\n\t\tkobject_del(fs_info->space_info_kobj);\n\t\tkobject_put(fs_info->space_info_kobj);\n\t}\n\tkobject_del(fs_info->device_dir_kobj);\n\tkobject_put(fs_info->device_dir_kobj);\n\taddrm_unknown_feature_attrs(fs_info, false);\n\tsysfs_remove_group(&fs_info->super_kobj, &btrfs_feature_attr_group);\n\t__btrfs_sysfs_remove_one(fs_info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_files",
          "args": [
            "fs_info->space_info_kobj",
            "allocation_attrs"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/file.c",
          "lines": "329-340",
          "snippet": "int sysfs_create_files(struct kobject *kobj, const struct attribute **ptr)\n{\n\tint err = 0;\n\tint i;\n\n\tfor (i = 0; ptr[i] && !err; i++)\n\t\terr = sysfs_create_file(kobj, ptr[i]);\n\tif (err)\n\t\twhile (--i >= 0)\n\t\t\tsysfs_remove_file(kobj, ptr[i]);\n\treturn err;\n}",
          "includes": [
            "#include \"../kernfs/kernfs-internal.h\"",
            "#include \"sysfs.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../kernfs/kernfs-internal.h\"\n#include \"sysfs.h\"\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kallsyms.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n\nint sysfs_create_files(struct kobject *kobj, const struct attribute **ptr)\n{\n\tint err = 0;\n\tint i;\n\n\tfor (i = 0; ptr[i] && !err; i++)\n\t\terr = sysfs_create_file(kobj, ptr[i]);\n\tif (err)\n\t\twhile (--i >= 0)\n\t\t\tsysfs_remove_file(kobj, ptr[i]);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"allocation\"",
            "&fs_info->super_kobj"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_kobj_add_device",
          "args": [
            "fs_info",
            "NULL"
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_kobj_add_device",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "625-659",
          "snippet": "int btrfs_kobj_add_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tint error = 0;\n\tstruct btrfs_fs_devices *fs_devices = fs_info->fs_devices;\n\tstruct btrfs_device *dev;\n\n\tif (!fs_info->device_dir_kobj)\n\t\tfs_info->device_dir_kobj = kobject_create_and_add(\"devices\",\n\t\t\t\t\t\t&fs_info->super_kobj);\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -ENOMEM;\n\n\tlist_for_each_entry(dev, &fs_devices->devices, dev_list) {\n\t\tstruct hd_struct *disk;\n\t\tstruct kobject *disk_kobj;\n\n\t\tif (!dev->bdev)\n\t\t\tcontinue;\n\n\t\tif (one_device && one_device != dev)\n\t\t\tcontinue;\n\n\t\tdisk = dev->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\terror = sysfs_create_link(fs_info->device_dir_kobj,\n\t\t\t\t\t  disk_kobj, disk_kobj->name);\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nint btrfs_kobj_add_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tint error = 0;\n\tstruct btrfs_fs_devices *fs_devices = fs_info->fs_devices;\n\tstruct btrfs_device *dev;\n\n\tif (!fs_info->device_dir_kobj)\n\t\tfs_info->device_dir_kobj = kobject_create_and_add(\"devices\",\n\t\t\t\t\t\t&fs_info->super_kobj);\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -ENOMEM;\n\n\tlist_for_each_entry(dev, &fs_devices->devices, dev_list) {\n\t\tstruct hd_struct *disk;\n\t\tstruct kobject *disk_kobj;\n\n\t\tif (!dev->bdev)\n\t\t\tcontinue;\n\n\t\tif (one_device && one_device != dev)\n\t\t\tcontinue;\n\n\t\tdisk = dev->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\terror = sysfs_create_link(fs_info->device_dir_kobj,\n\t\t\t\t\t  disk_kobj, disk_kobj->name);\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "addrm_unknown_feature_attrs",
          "args": [
            "fs_info",
            "true"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "addrm_unknown_feature_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "468-507",
          "snippet": "static int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define NUM_FEATURE_BITS 64"
          ],
          "globals_used": [
            "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];",
            "static u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define NUM_FEATURE_BITS 64\n\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\nstatic u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};\n\nstatic int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__btrfs_sysfs_remove_one",
          "args": [
            "fs_info"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "__btrfs_sysfs_remove_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "509-514",
          "snippet": "static void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&fs_info->super_kobj",
            "&btrfs_feature_attr_group"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "155-173",
          "snippet": "int sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&fs_info->super_kobj",
            "&btrfs_ktype",
            "NULL",
            "\"%pU\"",
            "fs_info->fsid"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&fs_info->kobj_unregister"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};\nstatic const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\nstatic struct kset *btrfs_kset;\n\nint btrfs_sysfs_add_one(struct btrfs_fs_info *fs_info)\n{\n\tint error;\n\n\tinit_completion(&fs_info->kobj_unregister);\n\tfs_info->super_kobj.kset = btrfs_kset;\n\terror = kobject_init_and_add(&fs_info->super_kobj, &btrfs_ktype, NULL,\n\t\t\t\t     \"%pU\", fs_info->fsid);\n\tif (error)\n\t\treturn error;\n\n\terror = sysfs_create_group(&fs_info->super_kobj,\n\t\t\t\t   &btrfs_feature_attr_group);\n\tif (error) {\n\t\t__btrfs_sysfs_remove_one(fs_info);\n\t\treturn error;\n\t}\n\n\terror = addrm_unknown_feature_attrs(fs_info, true);\n\tif (error)\n\t\tgoto failure;\n\n\terror = btrfs_kobj_add_device(fs_info, NULL);\n\tif (error)\n\t\tgoto failure;\n\n\tfs_info->space_info_kobj = kobject_create_and_add(\"allocation\",\n\t\t\t\t\t\t  &fs_info->super_kobj);\n\tif (!fs_info->space_info_kobj) {\n\t\terror = -ENOMEM;\n\t\tgoto failure;\n\t}\n\n\terror = sysfs_create_files(fs_info->space_info_kobj, allocation_attrs);\n\tif (error)\n\t\tgoto failure;\n\n\treturn 0;\nfailure:\n\tbtrfs_sysfs_remove_one(fs_info);\n\treturn error;\n}"
  },
  {
    "function_name": "btrfs_kobj_add_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "625-659",
    "snippet": "int btrfs_kobj_add_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tint error = 0;\n\tstruct btrfs_fs_devices *fs_devices = fs_info->fs_devices;\n\tstruct btrfs_device *dev;\n\n\tif (!fs_info->device_dir_kobj)\n\t\tfs_info->device_dir_kobj = kobject_create_and_add(\"devices\",\n\t\t\t\t\t\t&fs_info->super_kobj);\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -ENOMEM;\n\n\tlist_for_each_entry(dev, &fs_devices->devices, dev_list) {\n\t\tstruct hd_struct *disk;\n\t\tstruct kobject *disk_kobj;\n\n\t\tif (!dev->bdev)\n\t\t\tcontinue;\n\n\t\tif (one_device && one_device != dev)\n\t\t\tcontinue;\n\n\t\tdisk = dev->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\terror = sysfs_create_link(fs_info->device_dir_kobj,\n\t\t\t\t\t  disk_kobj, disk_kobj->name);\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_create_link",
          "args": [
            "fs_info->device_dir_kobj",
            "disk_kobj",
            "disk_kobj->name"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_link_nowarn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/symlink.c",
          "lines": "105-109",
          "snippet": "int sysfs_create_link_nowarn(struct kobject *kobj, struct kobject *target,\n\t\t\t     const char *name)\n{\n\treturn sysfs_do_create_link(kobj, target, name, 0);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/security.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/security.h>\n#include <linux/mutex.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nint sysfs_create_link_nowarn(struct kobject *kobj, struct kobject *target,\n\t\t\t     const char *name)\n{\n\treturn sysfs_do_create_link(kobj, target, name, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "part_to_dev",
          "args": [
            "disk"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "dev",
            "&fs_devices->devices",
            "dev_list"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"devices\"",
            "&fs_info->super_kobj"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nint btrfs_kobj_add_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tint error = 0;\n\tstruct btrfs_fs_devices *fs_devices = fs_info->fs_devices;\n\tstruct btrfs_device *dev;\n\n\tif (!fs_info->device_dir_kobj)\n\t\tfs_info->device_dir_kobj = kobject_create_and_add(\"devices\",\n\t\t\t\t\t\t&fs_info->super_kobj);\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -ENOMEM;\n\n\tlist_for_each_entry(dev, &fs_devices->devices, dev_list) {\n\t\tstruct hd_struct *disk;\n\t\tstruct kobject *disk_kobj;\n\n\t\tif (!dev->bdev)\n\t\t\tcontinue;\n\n\t\tif (one_device && one_device != dev)\n\t\t\tcontinue;\n\n\t\tdisk = dev->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\terror = sysfs_create_link(fs_info->device_dir_kobj,\n\t\t\t\t\t  disk_kobj, disk_kobj->name);\n\t\tif (error)\n\t\t\tbreak;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "btrfs_kobj_rm_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "605-623",
    "snippet": "int btrfs_kobj_rm_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tstruct hd_struct *disk;\n\tstruct kobject *disk_kobj;\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -EINVAL;\n\n\tif (one_device && one_device->bdev) {\n\t\tdisk = one_device->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\tsysfs_remove_link(fs_info->device_dir_kobj,\n\t\t\t\t\t\tdisk_kobj->name);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_remove_link",
          "args": [
            "fs_info->device_dir_kobj",
            "disk_kobj->name"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/symlink.c",
          "lines": "142-152",
          "snippet": "void sysfs_remove_link(struct kobject *kobj, const char *name)\n{\n\tstruct kernfs_node *parent = NULL;\n\n\tif (!kobj)\n\t\tparent = sysfs_root_kn;\n\telse\n\t\tparent = kobj->sd;\n\n\tkernfs_remove_by_name(parent, name);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/security.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/security.h>\n#include <linux/mutex.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/fs.h>\n\nvoid sysfs_remove_link(struct kobject *kobj, const char *name)\n{\n\tstruct kernfs_node *parent = NULL;\n\n\tif (!kobj)\n\t\tparent = sysfs_root_kn;\n\telse\n\t\tparent = kobj->sd;\n\n\tkernfs_remove_by_name(parent, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "part_to_dev",
          "args": [
            "disk"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nint btrfs_kobj_rm_device(struct btrfs_fs_info *fs_info,\n\t\tstruct btrfs_device *one_device)\n{\n\tstruct hd_struct *disk;\n\tstruct kobject *disk_kobj;\n\n\tif (!fs_info->device_dir_kobj)\n\t\treturn -EINVAL;\n\n\tif (one_device && one_device->bdev) {\n\t\tdisk = one_device->bdev->bd_part;\n\t\tdisk_kobj = &part_to_dev(disk)->kobj;\n\n\t\tsysfs_remove_link(fs_info->device_dir_kobj,\n\t\t\t\t\t\tdisk_kobj->name);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "init_feature_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "561-603",
    "snippet": "static void init_feature_attrs(void)\n{\n\tstruct btrfs_feature_attr *fa;\n\tint set, i;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs));\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names[0]) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs[0]));\n\n\tmemset(btrfs_feature_attrs, 0, sizeof(btrfs_feature_attrs));\n\tmemset(btrfs_unknown_feature_names, 0,\n\t       sizeof(btrfs_unknown_feature_names));\n\n\tfor (i = 0; btrfs_supported_feature_attrs[i]; i++) {\n\t\tstruct btrfs_feature_attr *sfa;\n\t\tstruct attribute *a = btrfs_supported_feature_attrs[i];\n\t\tint bit;\n\t\tsfa = attr_to_btrfs_feature_attr(a);\n\t\tbit = ilog2(sfa->feature_bit);\n\t\tfa = &btrfs_feature_attrs[sfa->feature_set][bit];\n\n\t\tfa->kobj_attr.attr.name = sfa->kobj_attr.attr.name;\n\t}\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\t\tchar *name = btrfs_unknown_feature_names[set][i];\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\n\t\t\tif (fa->kobj_attr.attr.name)\n\t\t\t\tcontinue;\n\n\t\t\tsnprintf(name, 13, \"%s:%u\",\n\t\t\t\t btrfs_feature_set_names[set], i);\n\n\t\t\tfa->kobj_attr.attr.name = name;\n\t\t\tfa->kobj_attr.attr.mode = S_IRUGO;\n\t\t\tfa->feature_set = set;\n\t\t\tfa->feature_bit = 1ULL << i;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct attribute *btrfs_supported_feature_attrs[] = {\n\tBTRFS_FEAT_ATTR_PTR(mixed_backref),\n\tBTRFS_FEAT_ATTR_PTR(default_subvol),\n\tBTRFS_FEAT_ATTR_PTR(mixed_groups),\n\tBTRFS_FEAT_ATTR_PTR(compress_lzo),\n\tBTRFS_FEAT_ATTR_PTR(big_metadata),\n\tBTRFS_FEAT_ATTR_PTR(extended_iref),\n\tBTRFS_FEAT_ATTR_PTR(raid56),\n\tBTRFS_FEAT_ATTR_PTR(skinny_metadata),\n\tBTRFS_FEAT_ATTR_PTR(no_holes),\n\tNULL\n};",
      "static char btrfs_unknown_feature_names[3][NUM_FEATURE_BITS][13];",
      "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];",
      "const char * const btrfs_feature_set_names[3] = {\n\t[FEAT_COMPAT]\t = \"compat\",\n\t[FEAT_COMPAT_RO] = \"compat_ro\",\n\t[FEAT_INCOMPAT]\t = \"incompat\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "name",
            "13",
            "\"%s:%u\"",
            "btrfs_feature_set_names[set]",
            "i"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_feature_attrs[set]"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "sfa->feature_bit"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "attr_to_btrfs_feature_attr",
          "args": [
            "a"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "btrfs_unknown_feature_names",
            "0",
            "sizeof(btrfs_unknown_feature_names)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "btrfs_feature_attrs",
            "0",
            "sizeof(btrfs_feature_attrs)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "ARRAY_SIZE(btrfs_unknown_feature_names[0]) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs[0])"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_feature_attrs[0]"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_unknown_feature_names[0]"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "ARRAY_SIZE(btrfs_unknown_feature_names) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs)"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_feature_attrs"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_unknown_feature_names"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct attribute *btrfs_supported_feature_attrs[] = {\n\tBTRFS_FEAT_ATTR_PTR(mixed_backref),\n\tBTRFS_FEAT_ATTR_PTR(default_subvol),\n\tBTRFS_FEAT_ATTR_PTR(mixed_groups),\n\tBTRFS_FEAT_ATTR_PTR(compress_lzo),\n\tBTRFS_FEAT_ATTR_PTR(big_metadata),\n\tBTRFS_FEAT_ATTR_PTR(extended_iref),\n\tBTRFS_FEAT_ATTR_PTR(raid56),\n\tBTRFS_FEAT_ATTR_PTR(skinny_metadata),\n\tBTRFS_FEAT_ATTR_PTR(no_holes),\n\tNULL\n};\nstatic char btrfs_unknown_feature_names[3][NUM_FEATURE_BITS][13];\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\nconst char * const btrfs_feature_set_names[3] = {\n\t[FEAT_COMPAT]\t = \"compat\",\n\t[FEAT_COMPAT_RO] = \"compat_ro\",\n\t[FEAT_INCOMPAT]\t = \"incompat\",\n};\n\nstatic void init_feature_attrs(void)\n{\n\tstruct btrfs_feature_attr *fa;\n\tint set, i;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs));\n\tBUILD_BUG_ON(ARRAY_SIZE(btrfs_unknown_feature_names[0]) !=\n\t\t     ARRAY_SIZE(btrfs_feature_attrs[0]));\n\n\tmemset(btrfs_feature_attrs, 0, sizeof(btrfs_feature_attrs));\n\tmemset(btrfs_unknown_feature_names, 0,\n\t       sizeof(btrfs_unknown_feature_names));\n\n\tfor (i = 0; btrfs_supported_feature_attrs[i]; i++) {\n\t\tstruct btrfs_feature_attr *sfa;\n\t\tstruct attribute *a = btrfs_supported_feature_attrs[i];\n\t\tint bit;\n\t\tsfa = attr_to_btrfs_feature_attr(a);\n\t\tbit = ilog2(sfa->feature_bit);\n\t\tfa = &btrfs_feature_attrs[sfa->feature_set][bit];\n\n\t\tfa->kobj_attr.attr.name = sfa->kobj_attr.attr.name;\n\t}\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\t\tchar *name = btrfs_unknown_feature_names[set][i];\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\n\t\t\tif (fa->kobj_attr.attr.name)\n\t\t\t\tcontinue;\n\n\t\t\tsnprintf(name, 13, \"%s:%u\",\n\t\t\t\t btrfs_feature_set_names[set], i);\n\n\t\t\tfa->kobj_attr.attr.name = name;\n\t\t\tfa->kobj_attr.attr.mode = S_IRUGO;\n\t\t\tfa->feature_set = set;\n\t\t\tfa->feature_bit = 1ULL << i;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "btrfs_printable_features",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "536-559",
    "snippet": "char *btrfs_printable_features(enum btrfs_feature_set set, u64 flags)\n{\n\tsize_t bufsize = 4096; /* safe max, 64 names * 64 bytes */\n\tint len = 0;\n\tint i;\n\tchar *str;\n\n\tstr = kmalloc(bufsize, GFP_KERNEL);\n\tif (!str)\n\t\treturn str;\n\n\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\tconst char *name;\n\n\t\tif (!(flags & (1ULL << i)))\n\t\t\tcontinue;\n\n\t\tname = btrfs_feature_attrs[set][i].kobj_attr.attr.name;\n\t\tlen += snprintf(str + len, bufsize - len, \"%s%s\",\n\t\t\t\tlen ? \",\" : \"\", name);\n\t}\n\n\treturn str;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "str + len",
            "bufsize - len",
            "\"%s%s\"",
            "len ? \",\" : \"\"",
            "name"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "btrfs_feature_attrs[set]"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "bufsize",
            "GFP_KERNEL"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\n\nchar *btrfs_printable_features(enum btrfs_feature_set set, u64 flags)\n{\n\tsize_t bufsize = 4096; /* safe max, 64 names * 64 bytes */\n\tint len = 0;\n\tint i;\n\tchar *str;\n\n\tstr = kmalloc(bufsize, GFP_KERNEL);\n\tif (!str)\n\t\treturn str;\n\n\tfor (i = 0; i < ARRAY_SIZE(btrfs_feature_attrs[set]); i++) {\n\t\tconst char *name;\n\n\t\tif (!(flags & (1ULL << i)))\n\t\t\tcontinue;\n\n\t\tname = btrfs_feature_attrs[set][i].kobj_attr.attr.name;\n\t\tlen += snprintf(str + len, bufsize - len, \"%s%s\",\n\t\t\t\tlen ? \",\" : \"\", name);\n\t}\n\n\treturn str;\n}"
  },
  {
    "function_name": "btrfs_sysfs_remove_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "516-528",
    "snippet": "void btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tif (fs_info->space_info_kobj) {\n\t\tsysfs_remove_files(fs_info->space_info_kobj, allocation_attrs);\n\t\tkobject_del(fs_info->space_info_kobj);\n\t\tkobject_put(fs_info->space_info_kobj);\n\t}\n\tkobject_del(fs_info->device_dir_kobj);\n\tkobject_put(fs_info->device_dir_kobj);\n\taddrm_unknown_feature_attrs(fs_info, false);\n\tsysfs_remove_group(&fs_info->super_kobj, &btrfs_feature_attr_group);\n\t__btrfs_sysfs_remove_one(fs_info);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};",
      "static const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__btrfs_sysfs_remove_one",
          "args": [
            "fs_info"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "__btrfs_sysfs_remove_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "509-514",
          "snippet": "static void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&fs_info->super_kobj",
            "&btrfs_feature_attr_group"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "243-252",
          "snippet": "void sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_remove_groups(struct kobject *kobj,\n\t\t\t const struct attribute_group **groups)\n{\n\tint i;\n\n\tif (!groups)\n\t\treturn;\n\tfor (i = 0; groups[i]; i++)\n\t\tsysfs_remove_group(kobj, groups[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "addrm_unknown_feature_attrs",
          "args": [
            "fs_info",
            "false"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "addrm_unknown_feature_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "468-507",
          "snippet": "static int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [
            "#define NUM_FEATURE_BITS 64"
          ],
          "globals_used": [
            "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];",
            "static u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define NUM_FEATURE_BITS 64\n\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\nstatic u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};\n\nstatic int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "fs_info->device_dir_kobj"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "fs_info->device_dir_kobj"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "fs_info->space_info_kobj"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "fs_info->space_info_kobj"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_files",
          "args": [
            "fs_info->space_info_kobj",
            "allocation_attrs"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_remove_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/file.c",
          "lines": "440-445",
          "snippet": "void sysfs_remove_files(struct kobject *kobj, const struct attribute **ptr)\n{\n\tint i;\n\tfor (i = 0; ptr[i]; i++)\n\t\tsysfs_remove_file(kobj, ptr[i]);\n}",
          "includes": [
            "#include \"../kernfs/kernfs-internal.h\"",
            "#include \"sysfs.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../kernfs/kernfs-internal.h\"\n#include \"sysfs.h\"\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kallsyms.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n\nvoid sysfs_remove_files(struct kobject *kobj, const struct attribute **ptr)\n{\n\tint i;\n\tfor (i = 0; ptr[i]; i++)\n\t\tsysfs_remove_file(kobj, ptr[i]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic const struct attribute_group btrfs_feature_attr_group = {\n\t.name = \"features\",\n\t.is_visible = btrfs_feature_visible,\n\t.attrs = btrfs_supported_feature_attrs,\n};\nstatic const struct attribute *allocation_attrs[] = {\n\tBTRFS_ATTR_PTR(global_rsv_reserved),\n\tBTRFS_ATTR_PTR(global_rsv_size),\n\tNULL,\n};\n\nvoid btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tif (fs_info->space_info_kobj) {\n\t\tsysfs_remove_files(fs_info->space_info_kobj, allocation_attrs);\n\t\tkobject_del(fs_info->space_info_kobj);\n\t\tkobject_put(fs_info->space_info_kobj);\n\t}\n\tkobject_del(fs_info->device_dir_kobj);\n\tkobject_put(fs_info->device_dir_kobj);\n\taddrm_unknown_feature_attrs(fs_info, false);\n\tsysfs_remove_group(&fs_info->super_kobj, &btrfs_feature_attr_group);\n\t__btrfs_sysfs_remove_one(fs_info);\n}"
  },
  {
    "function_name": "__btrfs_sysfs_remove_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "509-514",
    "snippet": "static void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&fs_info->kobj_unregister"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_qgroup_wait_for_completion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/qgroup.c",
          "lines": "2798-2814",
          "snippet": "int btrfs_qgroup_wait_for_completion(struct btrfs_fs_info *fs_info)\n{\n\tint running;\n\tint ret = 0;\n\n\tmutex_lock(&fs_info->qgroup_rescan_lock);\n\tspin_lock(&fs_info->qgroup_lock);\n\trunning = fs_info->qgroup_flags & BTRFS_QGROUP_STATUS_FLAG_RESCAN;\n\tspin_unlock(&fs_info->qgroup_lock);\n\tmutex_unlock(&fs_info->qgroup_rescan_lock);\n\n\tif (running)\n\t\tret = wait_for_completion_interruptible(\n\t\t\t\t\t&fs_info->qgroup_rescan_completion);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"qgroup.h\"",
            "#include \"extent_io.h\"",
            "#include \"backref.h\"",
            "#include \"ulist.h\"",
            "#include \"locking.h\"",
            "#include \"disk-io.h\"",
            "#include \"transaction.h\"",
            "#include \"ctree.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void qgroup_rescan_zero_tracking(struct btrfs_fs_info *fs_info);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qgroup.h\"\n#include \"extent_io.h\"\n#include \"backref.h\"\n#include \"ulist.h\"\n#include \"locking.h\"\n#include \"disk-io.h\"\n#include \"transaction.h\"\n#include \"ctree.h\"\n#include <linux/btrfs.h>\n#include <linux/workqueue.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/sched.h>\n\nstatic void qgroup_rescan_zero_tracking(struct btrfs_fs_info *fs_info);\n\nint btrfs_qgroup_wait_for_completion(struct btrfs_fs_info *fs_info)\n{\n\tint running;\n\tint ret = 0;\n\n\tmutex_lock(&fs_info->qgroup_rescan_lock);\n\tspin_lock(&fs_info->qgroup_lock);\n\trunning = fs_info->qgroup_flags & BTRFS_QGROUP_STATUS_FLAG_RESCAN;\n\tspin_unlock(&fs_info->qgroup_lock);\n\tmutex_unlock(&fs_info->qgroup_rescan_lock);\n\n\tif (running)\n\t\tret = wait_for_completion_interruptible(\n\t\t\t\t\t&fs_info->qgroup_rescan_completion);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&fs_info->super_kobj"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&fs_info->super_kobj"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void __btrfs_sysfs_remove_one(struct btrfs_fs_info *fs_info)\n{\n\tkobject_del(&fs_info->super_kobj);\n\tkobject_put(&fs_info->super_kobj);\n\twait_for_completion(&fs_info->kobj_unregister);\n}"
  },
  {
    "function_name": "addrm_unknown_feature_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "468-507",
    "snippet": "static int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [
      "#define NUM_FEATURE_BITS 64"
    ],
    "globals_used": [
      "static struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];",
      "static u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_unmerge_group",
          "args": [
            "&fs_info->super_kobj",
            "&agroup"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_unmerge_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "293-305",
          "snippet": "void sysfs_unmerge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n\tstruct kernfs_node *parent;\n\tstruct attribute *const *attr;\n\n\tparent = kernfs_find_and_get(kobj->sd, grp->name);\n\tif (parent) {\n\t\tfor (attr = grp->attrs; *attr; ++attr)\n\t\t\tkernfs_remove_by_name(parent, (*attr)->name);\n\t\tkernfs_put(parent);\n\t}\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nvoid sysfs_unmerge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n\tstruct kernfs_node *parent;\n\tstruct attribute *const *attr;\n\n\tparent = kernfs_find_and_get(kobj->sd, grp->name);\n\tif (parent) {\n\t\tfor (attr = grp->attrs; *attr; ++attr)\n\t\t\tkernfs_remove_by_name(parent, (*attr)->name);\n\t\tkernfs_put(parent);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_merge_group",
          "args": [
            "&fs_info->super_kobj",
            "&agroup"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_merge_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sysfs/group.c",
          "lines": "264-285",
          "snippet": "int sysfs_merge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n\tstruct kernfs_node *parent;\n\tint error = 0;\n\tstruct attribute *const *attr;\n\tint i;\n\n\tparent = kernfs_find_and_get(kobj->sd, grp->name);\n\tif (!parent)\n\t\treturn -ENOENT;\n\n\tfor ((i = 0, attr = grp->attrs); *attr && !error; (++i, ++attr))\n\t\terror = sysfs_add_file(parent, *attr, false);\n\tif (error) {\n\t\twhile (--i >= 0)\n\t\t\tkernfs_remove_by_name(parent, (*--attr)->name);\n\t}\n\tkernfs_put(parent);\n\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_merge_group(struct kobject *kobj,\n\t\t       const struct attribute_group *grp)\n{\n\tstruct kernfs_node *parent;\n\tint error = 0;\n\tstruct attribute *const *attr;\n\tint i;\n\n\tparent = kernfs_find_and_get(kobj->sd, grp->name);\n\tif (!parent)\n\t\treturn -ENOENT;\n\n\tfor ((i = 0, attr = grp->attrs); *attr && !error; (++i, ++attr))\n\t\terror = sysfs_add_file(parent, *attr, false);\n\tif (error) {\n\t\twhile (--i >= 0)\n\t\t\tkernfs_remove_by_name(parent, (*--attr)->name);\n\t}\n\tkernfs_put(parent);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_features",
          "args": [
            "fs_info",
            "set"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "get_features",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "37-47",
          "snippet": "static u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\n#define NUM_FEATURE_BITS 64\n\nstatic struct btrfs_feature_attr btrfs_feature_attrs[3][NUM_FEATURE_BITS];\nstatic u64 supported_feature_masks[3] = {\n\t[FEAT_COMPAT]    = BTRFS_FEATURE_COMPAT_SUPP,\n\t[FEAT_COMPAT_RO] = BTRFS_FEATURE_COMPAT_RO_SUPP,\n\t[FEAT_INCOMPAT]  = BTRFS_FEATURE_INCOMPAT_SUPP,\n};\n\nstatic int addrm_unknown_feature_attrs(struct btrfs_fs_info *fs_info, bool add)\n{\n\tint set;\n\n\tfor (set = 0; set < FEAT_MAX; set++) {\n\t\tint i;\n\t\tstruct attribute *attrs[2];\n\t\tstruct attribute_group agroup = {\n\t\t\t.name = \"features\",\n\t\t\t.attrs = attrs,\n\t\t};\n\t\tu64 features = get_features(fs_info, set);\n\t\tfeatures &= ~supported_feature_masks[set];\n\n\t\tif (!features)\n\t\t\tcontinue;\n\n\t\tattrs[1] = NULL;\n\t\tfor (i = 0; i < NUM_FEATURE_BITS; i++) {\n\t\t\tstruct btrfs_feature_attr *fa;\n\n\t\t\tif (!(features & (1ULL << i)))\n\t\t\t\tcontinue;\n\n\t\t\tfa = &btrfs_feature_attrs[set][i];\n\t\t\tattrs[0] = &fa->kobj_attr.attr;\n\t\t\tif (add) {\n\t\t\t\tint ret;\n\t\t\t\tret = sysfs_merge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t\t&agroup);\n\t\t\t\tif (ret)\n\t\t\t\t\treturn ret;\n\t\t\t} else\n\t\t\t\tsysfs_unmerge_group(&fs_info->super_kobj,\n\t\t\t\t\t\t    &agroup);\n\t\t}\n\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "to_fs_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "451-456",
    "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structbtrfs_fs_info",
            "super_kobj"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
  },
  {
    "function_name": "btrfs_release_super_kobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "439-443",
    "snippet": "static void btrfs_release_super_kobj(struct kobject *kobj)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tcomplete(&fs_info->kobj_unregister);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&fs_info->kobj_unregister"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "scrub_block_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/scrub.c",
          "lines": "2357-2383",
          "snippet": "static void scrub_block_complete(struct scrub_block *sblock)\n{\n\tint corrupted = 0;\n\n\tif (!sblock->no_io_error_seen) {\n\t\tcorrupted = 1;\n\t\tscrub_handle_errored_block(sblock);\n\t} else {\n\t\t/*\n\t\t * if has checksum error, write via repair mechanism in\n\t\t * dev replace case, otherwise write here in dev replace\n\t\t * case.\n\t\t */\n\t\tcorrupted = scrub_checksum(sblock);\n\t\tif (!corrupted && sblock->sctx->is_dev_replace)\n\t\t\tscrub_write_block_to_dev_replace(sblock);\n\t}\n\n\tif (sblock->sparity && corrupted && !sblock->data_corrected) {\n\t\tu64 start = sblock->pagev[0]->logical;\n\t\tu64 end = sblock->pagev[sblock->page_count - 1]->logical +\n\t\t\t  PAGE_SIZE;\n\n\t\tscrub_parity_mark_sectors_error(sblock->sparity,\n\t\t\t\t\t\tstart, end - start);\n\t}\n}",
          "includes": [
            "#include \"raid56.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"dev-replace.h\"",
            "#include \"extent_io.h\"",
            "#include \"backref.h\"",
            "#include \"transaction.h\"",
            "#include \"ordered-data.h\"",
            "#include \"disk-io.h\"",
            "#include \"volumes.h\"",
            "#include \"ctree.h\"",
            "#include <linux/ratelimit.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void scrub_pending_bio_inc(struct scrub_ctx *sctx);",
            "static void scrub_pending_bio_dec(struct scrub_ctx *sctx);",
            "static void scrub_pending_trans_workers_inc(struct scrub_ctx *sctx);",
            "static void scrub_pending_trans_workers_dec(struct scrub_ctx *sctx);",
            "static void scrub_write_block_to_dev_replace(struct scrub_block *sblock);",
            "static int scrub_checksum_data(struct scrub_block *sblock);",
            "static int scrub_checksum_tree_block(struct scrub_block *sblock);",
            "static int scrub_checksum_super(struct scrub_block *sblock);",
            "static void scrub_block_get(struct scrub_block *sblock);",
            "static void scrub_block_put(struct scrub_block *sblock);",
            "static void scrub_parity_get(struct scrub_parity *sparity);",
            "static void scrub_parity_put(struct scrub_parity *sparity);",
            "static void scrub_block_complete(struct scrub_block *sblock);",
            "static int scrub_setup_wr_ctx(struct scrub_ctx *sctx,\n\t\t\t      struct scrub_wr_ctx *wr_ctx,\n\t\t\t      struct btrfs_fs_info *fs_info,\n\t\t\t      struct btrfs_device *dev,\n\t\t\t      int is_dev_replace);",
            "static void scrub_wr_submit(struct scrub_ctx *sctx);",
            "static void scrub_put_ctx(struct scrub_ctx *sctx);",
            "static noinline_for_stack\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"raid56.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"dev-replace.h\"\n#include \"extent_io.h\"\n#include \"backref.h\"\n#include \"transaction.h\"\n#include \"ordered-data.h\"\n#include \"disk-io.h\"\n#include \"volumes.h\"\n#include \"ctree.h\"\n#include <linux/ratelimit.h>\n#include <linux/blkdev.h>\n\nstatic void scrub_pending_bio_inc(struct scrub_ctx *sctx);\nstatic void scrub_pending_bio_dec(struct scrub_ctx *sctx);\nstatic void scrub_pending_trans_workers_inc(struct scrub_ctx *sctx);\nstatic void scrub_pending_trans_workers_dec(struct scrub_ctx *sctx);\nstatic void scrub_write_block_to_dev_replace(struct scrub_block *sblock);\nstatic int scrub_checksum_data(struct scrub_block *sblock);\nstatic int scrub_checksum_tree_block(struct scrub_block *sblock);\nstatic int scrub_checksum_super(struct scrub_block *sblock);\nstatic void scrub_block_get(struct scrub_block *sblock);\nstatic void scrub_block_put(struct scrub_block *sblock);\nstatic void scrub_parity_get(struct scrub_parity *sparity);\nstatic void scrub_parity_put(struct scrub_parity *sparity);\nstatic void scrub_block_complete(struct scrub_block *sblock);\nstatic int scrub_setup_wr_ctx(struct scrub_ctx *sctx,\n\t\t\t      struct scrub_wr_ctx *wr_ctx,\n\t\t\t      struct btrfs_fs_info *fs_info,\n\t\t\t      struct btrfs_device *dev,\n\t\t\t      int is_dev_replace);\nstatic void scrub_wr_submit(struct scrub_ctx *sctx);\nstatic void scrub_put_ctx(struct scrub_ctx *sctx);\nstatic noinline_for_stack\nstruct;\n\nstatic void scrub_block_complete(struct scrub_block *sblock)\n{\n\tint corrupted = 0;\n\n\tif (!sblock->no_io_error_seen) {\n\t\tcorrupted = 1;\n\t\tscrub_handle_errored_block(sblock);\n\t} else {\n\t\t/*\n\t\t * if has checksum error, write via repair mechanism in\n\t\t * dev replace case, otherwise write here in dev replace\n\t\t * case.\n\t\t */\n\t\tcorrupted = scrub_checksum(sblock);\n\t\tif (!corrupted && sblock->sctx->is_dev_replace)\n\t\t\tscrub_write_block_to_dev_replace(sblock);\n\t}\n\n\tif (sblock->sparity && corrupted && !sblock->data_corrected) {\n\t\tu64 start = sblock->pagev[0]->logical;\n\t\tu64 end = sblock->pagev[sblock->page_count - 1]->logical +\n\t\t\t  PAGE_SIZE;\n\n\t\tscrub_parity_mark_sectors_error(sblock->sparity,\n\t\t\t\t\t\tstart, end - start);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nstatic void btrfs_release_super_kobj(struct kobject *kobj)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tcomplete(&fs_info->kobj_unregister);\n}"
  },
  {
    "function_name": "btrfs_clone_alignment_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "421-427",
    "snippet": "static ssize_t btrfs_clone_alignment_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->sectorsize);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "fs_info->super_copy->sectorsize"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_clone_alignment_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->sectorsize);\n}"
  },
  {
    "function_name": "btrfs_sectorsize_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "411-417",
    "snippet": "static ssize_t btrfs_sectorsize_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->sectorsize);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "fs_info->super_copy->sectorsize"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_sectorsize_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->sectorsize);\n}"
  },
  {
    "function_name": "btrfs_nodesize_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "401-407",
    "snippet": "static ssize_t btrfs_nodesize_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->nodesize);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u\\n\"",
            "fs_info->super_copy->nodesize"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_nodesize_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%u\\n\", fs_info->super_copy->nodesize);\n}"
  },
  {
    "function_name": "btrfs_label_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "367-398",
    "snippet": "static ssize_t btrfs_label_store(struct kobject *kobj,\n\t\t\t\t struct kobj_attribute *a,\n\t\t\t\t const char *buf, size_t len)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tsize_t p_len;\n\n\tif (fs_info->sb->s_flags & MS_RDONLY)\n\t\treturn -EROFS;\n\n\t/*\n\t * p_len is the len until the first occurrence of either\n\t * '\\n' or '\\0'\n\t */\n\tp_len = strcspn(buf, \"\\n\");\n\n\tif (p_len >= BTRFS_LABEL_SIZE)\n\t\treturn -EINVAL;\n\n\tspin_lock(&fs_info->super_lock);\n\tmemset(fs_info->super_copy->label, 0, BTRFS_LABEL_SIZE);\n\tmemcpy(fs_info->super_copy->label, buf, p_len);\n\tspin_unlock(&fs_info->super_lock);\n\n\t/*\n\t * We don't want to do full transaction commit from inside sysfs\n\t */\n\tbtrfs_set_pending(fs_info, COMMIT);\n\twake_up_process(fs_info->transaction_kthread);\n\n\treturn len;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_process",
          "args": [
            "fs_info->transaction_kthread"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_set_pending",
          "args": [
            "fs_info",
            "COMMIT"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&fs_info->super_lock"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fs_info->super_copy->label",
            "buf",
            "p_len"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fs_info->super_copy->label",
            "0",
            "BTRFS_LABEL_SIZE"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&fs_info->super_lock"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "buf",
            "\"\\n\""
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_label_store(struct kobject *kobj,\n\t\t\t\t struct kobj_attribute *a,\n\t\t\t\t const char *buf, size_t len)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tsize_t p_len;\n\n\tif (fs_info->sb->s_flags & MS_RDONLY)\n\t\treturn -EROFS;\n\n\t/*\n\t * p_len is the len until the first occurrence of either\n\t * '\\n' or '\\0'\n\t */\n\tp_len = strcspn(buf, \"\\n\");\n\n\tif (p_len >= BTRFS_LABEL_SIZE)\n\t\treturn -EINVAL;\n\n\tspin_lock(&fs_info->super_lock);\n\tmemset(fs_info->super_copy->label, 0, BTRFS_LABEL_SIZE);\n\tmemcpy(fs_info->super_copy->label, buf, p_len);\n\tspin_unlock(&fs_info->super_lock);\n\n\t/*\n\t * We don't want to do full transaction commit from inside sysfs\n\t */\n\tbtrfs_set_pending(fs_info, COMMIT);\n\twake_up_process(fs_info->transaction_kthread);\n\n\treturn len;\n}"
  },
  {
    "function_name": "btrfs_label_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "359-365",
    "snippet": "static ssize_t btrfs_label_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tchar *label = fs_info->super_copy->label;\n\treturn snprintf(buf, PAGE_SIZE, label[0] ? \"%s\\n\" : \"%s\", label);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "label[0] ? \"%s\\n\" : \"%s\"",
            "label"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_label_show(struct kobject *kobj,\n\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tchar *label = fs_info->super_copy->label;\n\treturn snprintf(buf, PAGE_SIZE, label[0] ? \"%s\\n\" : \"%s\", label);\n}"
  },
  {
    "function_name": "space_info_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "340-345",
    "snippet": "static void space_info_release(struct kobject *kobj)\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj);\n\tpercpu_counter_destroy(&sinfo->total_bytes_pinned);\n\tkfree(sinfo);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sinfo"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_destroy",
          "args": [
            "&sinfo->total_bytes_pinned"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_space_info",
          "args": [
            "kobj"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nstatic void space_info_release(struct kobject *kobj)\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj);\n\tpercpu_counter_destroy(&sinfo->total_bytes_pinned);\n\tkfree(sinfo);\n}"
  },
  {
    "function_name": "btrfs_space_info_show_total_bytes_pinned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "308-315",
    "snippet": "static ssize_t btrfs_space_info_show_total_bytes_pinned(struct kobject *kobj,\n\t\t\t\t\t\t       struct kobj_attribute *a,\n\t\t\t\t\t\t       char *buf)\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj);\n\ts64 val = percpu_counter_sum(&sinfo->total_bytes_pinned);\n\treturn snprintf(buf, PAGE_SIZE, \"%lld\\n\", val);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%lld\\n\"",
            "val"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_sum",
          "args": [
            "&sinfo->total_bytes_pinned"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_space_info",
          "args": [
            "kobj"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_space_info_show_total_bytes_pinned(struct kobject *kobj,\n\t\t\t\t\t\t       struct kobj_attribute *a,\n\t\t\t\t\t\t       char *buf)\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj);\n\ts64 val = percpu_counter_sum(&sinfo->total_bytes_pinned);\n\treturn snprintf(buf, PAGE_SIZE, \"%lld\\n\", val);\n}"
  },
  {
    "function_name": "release_raid_kobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "287-290",
    "snippet": "static void release_raid_kobj(struct kobject *kobj)\n{\n\tkfree(to_raid_kobj(kobj));\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "to_raid_kobj(kobj)"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_raid_kobj",
          "args": [
            "kobj"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nstatic void release_raid_kobj(struct kobject *kobj)\n{\n\tkfree(to_raid_kobj(kobj));\n}"
  },
  {
    "function_name": "raid_bytes_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "261-279",
    "snippet": "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf)\n\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj->parent);\n\tstruct btrfs_block_group_cache *block_group;\n\tint index = to_raid_kobj(kobj)->raid_type;\n\tu64 val = 0;\n\n\tdown_read(&sinfo->groups_sem);\n\tlist_for_each_entry(block_group, &sinfo->block_groups[index], list) {\n\t\tif (&attr->attr == BTRFS_RAID_ATTR_PTR(total_bytes))\n\t\t\tval += block_group->key.offset;\n\t\telse\n\t\t\tval += btrfs_block_group_used(&block_group->item);\n\t}\n\tup_read(&sinfo->groups_sem);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "val"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&sinfo->groups_sem"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_block_group_used",
          "args": [
            "&block_group->item"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BTRFS_RAID_ATTR_PTR",
          "args": [
            "total_bytes"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "block_group",
            "&sinfo->block_groups[index]",
            "list"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_read",
          "args": [
            "&sinfo->groups_sem"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_raid_kobj",
          "args": [
            "kobj"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_space_info",
          "args": [
            "kobj->parent"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf)\n\n{\n\tstruct btrfs_space_info *sinfo = to_space_info(kobj->parent);\n\tstruct btrfs_block_group_cache *block_group;\n\tint index = to_raid_kobj(kobj)->raid_type;\n\tu64 val = 0;\n\n\tdown_read(&sinfo->groups_sem);\n\tlist_for_each_entry(block_group, &sinfo->block_groups[index], list) {\n\t\tif (&attr->attr == BTRFS_RAID_ATTR_PTR(total_bytes))\n\t\t\tval += block_group->key.offset;\n\t\telse\n\t\t\tval += btrfs_block_group_used(&block_group->item);\n\t}\n\tup_read(&sinfo->groups_sem);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}"
  },
  {
    "function_name": "global_rsv_reserved_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "244-250",
    "snippet": "static ssize_t global_rsv_reserved_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj->parent);\n\tstruct btrfs_block_rsv *block_rsv = &fs_info->global_block_rsv;\n\treturn btrfs_show_u64(&block_rsv->reserved, &block_rsv->lock, buf);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_show_u64",
          "args": [
            "&block_rsv->reserved",
            "&block_rsv->lock",
            "buf"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_show_u64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "224-233",
          "snippet": "static ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj->parent"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t global_rsv_reserved_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *a, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj->parent);\n\tstruct btrfs_block_rsv *block_rsv = &fs_info->global_block_rsv;\n\treturn btrfs_show_u64(&block_rsv->reserved, &block_rsv->lock, buf);\n}"
  },
  {
    "function_name": "global_rsv_size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "235-241",
    "snippet": "static ssize_t global_rsv_size_show(struct kobject *kobj,\n\t\t\t\t    struct kobj_attribute *ka, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj->parent);\n\tstruct btrfs_block_rsv *block_rsv = &fs_info->global_block_rsv;\n\treturn btrfs_show_u64(&block_rsv->size, &block_rsv->lock, buf);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_show_u64",
          "args": [
            "&block_rsv->size",
            "&block_rsv->lock",
            "buf"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_show_u64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "224-233",
          "snippet": "static ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj->parent"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t global_rsv_size_show(struct kobject *kobj,\n\t\t\t\t    struct kobj_attribute *ka, char *buf)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj->parent);\n\tstruct btrfs_block_rsv *block_rsv = &fs_info->global_block_rsv;\n\treturn btrfs_show_u64(&block_rsv->size, &block_rsv->lock, buf);\n}"
  },
  {
    "function_name": "btrfs_show_u64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "224-233",
    "snippet": "static ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%llu\\n\"",
            "val"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "lock"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "lock"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_show_u64(u64 *value_ptr, spinlock_t *lock, char *buf)\n{\n\tu64 val;\n\tif (lock)\n\t\tspin_lock(lock);\n\tval = *value_ptr;\n\tif (lock)\n\t\tspin_unlock(lock);\n\treturn snprintf(buf, PAGE_SIZE, \"%llu\\n\", val);\n}"
  },
  {
    "function_name": "btrfs_feature_visible",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "173-193",
    "snippet": "static umode_t btrfs_feature_visible(struct kobject *kobj,\n\t\t\t\t     struct attribute *attr, int unused)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tumode_t mode = attr->mode;\n\n\tif (fs_info) {\n\t\tstruct btrfs_feature_attr *fa;\n\t\tu64 features;\n\n\t\tfa = attr_to_btrfs_feature_attr(attr);\n\t\tfeatures = get_features(fs_info, fa->feature_set);\n\n\t\tif (can_modify_feature(fa))\n\t\t\tmode |= S_IWUSR;\n\t\telse if (!(features & fa->feature_bit))\n\t\t\tmode = 0;\n\t}\n\n\treturn mode;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "can_modify_feature",
          "args": [
            "fa"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "can_modify_feature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "61-90",
          "snippet": "static int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_features",
          "args": [
            "fs_info",
            "fa->feature_set"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "get_features",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "37-47",
          "snippet": "static u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr_to_btrfs_feature_attr",
          "args": [
            "attr"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\n\nstatic umode_t btrfs_feature_visible(struct kobject *kobj,\n\t\t\t\t     struct attribute *attr, int unused)\n{\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tumode_t mode = attr->mode;\n\n\tif (fs_info) {\n\t\tstruct btrfs_feature_attr *fa;\n\t\tu64 features;\n\n\t\tfa = attr_to_btrfs_feature_attr(attr);\n\t\tfeatures = get_features(fs_info, fa->feature_set);\n\n\t\tif (can_modify_feature(fa))\n\t\t\tmode |= S_IWUSR;\n\t\telse if (!(features & fa->feature_bit))\n\t\t\tmode = 0;\n\t}\n\n\treturn mode;\n}"
  },
  {
    "function_name": "btrfs_feature_attr_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "108-171",
    "snippet": "static ssize_t btrfs_feature_attr_store(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *a,\n\t\t\t\t\tconst char *buf, size_t count)\n{\n\tstruct btrfs_fs_info *fs_info;\n\tstruct btrfs_feature_attr *fa = to_btrfs_feature_attr(a);\n\tu64 features, set, clear;\n\tunsigned long val;\n\tint ret;\n\n\tfs_info = to_fs_info(kobj);\n\tif (!fs_info)\n\t\treturn -EPERM;\n\n\tret = kstrtoul(skip_spaces(buf), 0, &val);\n\tif (ret)\n\t\treturn ret;\n\n\tif (fa->feature_set == FEAT_COMPAT) {\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t} else if (fa->feature_set == FEAT_COMPAT_RO) {\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t} else {\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t}\n\n\tfeatures = get_features(fs_info, fa->feature_set);\n\n\t/* Nothing to do */\n\tif ((val && (features & fa->feature_bit)) ||\n\t    (!val && !(features & fa->feature_bit)))\n\t\treturn count;\n\n\tif ((val && !(set & fa->feature_bit)) ||\n\t    (!val && !(clear & fa->feature_bit))) {\n\t\tbtrfs_info(fs_info,\n\t\t\t\"%sabling feature %s on mounted fs is not supported.\",\n\t\t\tval ? \"En\" : \"Dis\", fa->kobj_attr.attr.name);\n\t\treturn -EPERM;\n\t}\n\n\tbtrfs_info(fs_info, \"%s %s feature flag\",\n\t\t   val ? \"Setting\" : \"Clearing\", fa->kobj_attr.attr.name);\n\n\tspin_lock(&fs_info->super_lock);\n\tfeatures = get_features(fs_info, fa->feature_set);\n\tif (val)\n\t\tfeatures |= fa->feature_bit;\n\telse\n\t\tfeatures &= ~fa->feature_bit;\n\tset_features(fs_info, fa->feature_set, features);\n\tspin_unlock(&fs_info->super_lock);\n\n\t/*\n\t * We don't want to do full transaction commit from inside sysfs\n\t */\n\tbtrfs_set_pending(fs_info, COMMIT);\n\twake_up_process(fs_info->transaction_kthread);\n\n\treturn count;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_process",
          "args": [
            "fs_info->transaction_kthread"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_set_pending",
          "args": [
            "fs_info",
            "COMMIT"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&fs_info->super_lock"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_features",
          "args": [
            "fs_info",
            "fa->feature_set",
            "features"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "set_features",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "49-59",
          "snippet": "static void set_features(struct btrfs_fs_info *fs_info,\n\t\t\t enum btrfs_feature_set set, u64 features)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\tbtrfs_set_super_compat_flags(disk_super, features);\n\telse if (set == FEAT_COMPAT_RO)\n\t\tbtrfs_set_super_compat_ro_flags(disk_super, features);\n\telse\n\t\tbtrfs_set_super_incompat_flags(disk_super, features);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void set_features(struct btrfs_fs_info *fs_info,\n\t\t\t enum btrfs_feature_set set, u64 features)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\tbtrfs_set_super_compat_flags(disk_super, features);\n\telse if (set == FEAT_COMPAT_RO)\n\t\tbtrfs_set_super_compat_ro_flags(disk_super, features);\n\telse\n\t\tbtrfs_set_super_incompat_flags(disk_super, features);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_features",
          "args": [
            "fs_info",
            "fa->feature_set"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "get_features",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "37-47",
          "snippet": "static u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&fs_info->super_lock"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_info",
          "args": [
            "fs_info",
            "\"%s %s feature flag\"",
            "val ? \"Setting\" : \"Clearing\"",
            "fa->kobj_attr.attr.name"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_info",
          "args": [
            "fs_info",
            "\"%sabling feature %s on mounted fs is not supported.\"",
            "val ? \"En\" : \"Dis\"",
            "fa->kobj_attr.attr.name"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrtoul",
          "args": [
            "skip_spaces(buf)",
            "0",
            "&val"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "skip_spaces",
          "args": [
            "buf"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_btrfs_feature_attr",
          "args": [
            "a"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_feature_attr_store(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *a,\n\t\t\t\t\tconst char *buf, size_t count)\n{\n\tstruct btrfs_fs_info *fs_info;\n\tstruct btrfs_feature_attr *fa = to_btrfs_feature_attr(a);\n\tu64 features, set, clear;\n\tunsigned long val;\n\tint ret;\n\n\tfs_info = to_fs_info(kobj);\n\tif (!fs_info)\n\t\treturn -EPERM;\n\n\tret = kstrtoul(skip_spaces(buf), 0, &val);\n\tif (ret)\n\t\treturn ret;\n\n\tif (fa->feature_set == FEAT_COMPAT) {\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t} else if (fa->feature_set == FEAT_COMPAT_RO) {\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t} else {\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t}\n\n\tfeatures = get_features(fs_info, fa->feature_set);\n\n\t/* Nothing to do */\n\tif ((val && (features & fa->feature_bit)) ||\n\t    (!val && !(features & fa->feature_bit)))\n\t\treturn count;\n\n\tif ((val && !(set & fa->feature_bit)) ||\n\t    (!val && !(clear & fa->feature_bit))) {\n\t\tbtrfs_info(fs_info,\n\t\t\t\"%sabling feature %s on mounted fs is not supported.\",\n\t\t\tval ? \"En\" : \"Dis\", fa->kobj_attr.attr.name);\n\t\treturn -EPERM;\n\t}\n\n\tbtrfs_info(fs_info, \"%s %s feature flag\",\n\t\t   val ? \"Setting\" : \"Clearing\", fa->kobj_attr.attr.name);\n\n\tspin_lock(&fs_info->super_lock);\n\tfeatures = get_features(fs_info, fa->feature_set);\n\tif (val)\n\t\tfeatures |= fa->feature_bit;\n\telse\n\t\tfeatures &= ~fa->feature_bit;\n\tset_features(fs_info, fa->feature_set, features);\n\tspin_unlock(&fs_info->super_lock);\n\n\t/*\n\t * We don't want to do full transaction commit from inside sysfs\n\t */\n\tbtrfs_set_pending(fs_info, COMMIT);\n\twake_up_process(fs_info->transaction_kthread);\n\n\treturn count;\n}"
  },
  {
    "function_name": "btrfs_feature_attr_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "92-106",
    "snippet": "static ssize_t btrfs_feature_attr_show(struct kobject *kobj,\n\t\t\t\t       struct kobj_attribute *a, char *buf)\n{\n\tint val = 0;\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tstruct btrfs_feature_attr *fa = to_btrfs_feature_attr(a);\n\tif (fs_info) {\n\t\tu64 features = get_features(fs_info, fa->feature_set);\n\t\tif (features & fa->feature_bit)\n\t\t\tval = 1;\n\t} else\n\t\tval = can_modify_feature(fa);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", val);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
      "static ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%d\\n\"",
            "val"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "can_modify_feature",
          "args": [
            "fa"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "can_modify_feature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "61-90",
          "snippet": "static int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_features",
          "args": [
            "fs_info",
            "fa->feature_set"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "get_features",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "37-47",
          "snippet": "static u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_btrfs_feature_attr",
          "args": [
            "a"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_fs_info",
          "args": [
            "kobj"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "to_fs_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
          "lines": "451-456",
          "snippet": "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}",
          "includes": [
            "#include \"volumes.h\"",
            "#include \"sysfs.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/debugfs.h>",
            "#include <linux/genhd.h>",
            "#include <linux/bug.h>",
            "#include <linux/kobject.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);",
            "static struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic struct kobj_type btrfs_ktype = {\n\t.sysfs_ops\t= &kobj_sysfs_ops,\n\t.release\t= btrfs_release_super_kobj,\n\t.default_attrs\t= btrfs_attrs,\n};\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj)\n{\n\tif (kobj->ktype != &btrfs_ktype)\n\t\treturn NULL;\n\treturn container_of(kobj, struct btrfs_fs_info, super_kobj);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic inline struct btrfs_fs_info *to_fs_info(struct kobject *kobj);\nstatic ssize_t raid_bytes_show(struct kobject *kobj,\n\t\t\t       struct kobj_attribute *attr, char *buf);\n\nstatic ssize_t btrfs_feature_attr_show(struct kobject *kobj,\n\t\t\t\t       struct kobj_attribute *a, char *buf)\n{\n\tint val = 0;\n\tstruct btrfs_fs_info *fs_info = to_fs_info(kobj);\n\tstruct btrfs_feature_attr *fa = to_btrfs_feature_attr(a);\n\tif (fs_info) {\n\t\tu64 features = get_features(fs_info, fa->feature_set);\n\t\tif (features & fa->feature_bit)\n\t\t\tval = 1;\n\t} else\n\t\tval = can_modify_feature(fa);\n\n\treturn snprintf(buf, PAGE_SIZE, \"%d\\n\", val);\n}"
  },
  {
    "function_name": "can_modify_feature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "61-90",
    "snippet": "static int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\"",
            "fa->feature_set"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic int can_modify_feature(struct btrfs_feature_attr *fa)\n{\n\tint val = 0;\n\tu64 set, clear;\n\tswitch (fa->feature_set) {\n\tcase FEAT_COMPAT:\n\t\tset = BTRFS_FEATURE_COMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_COMPAT_RO:\n\t\tset = BTRFS_FEATURE_COMPAT_RO_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR;\n\t\tbreak;\n\tcase FEAT_INCOMPAT:\n\t\tset = BTRFS_FEATURE_INCOMPAT_SAFE_SET;\n\t\tclear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR;\n\t\tbreak;\n\tdefault:\n\t\tprintk(KERN_WARNING \"btrfs: sysfs: unknown feature set %d\\n\",\n\t\t\t\tfa->feature_set);\n\t\treturn 0;\n\t}\n\n\tif (set & fa->feature_bit)\n\t\tval |= 1;\n\tif (clear & fa->feature_bit)\n\t\tval |= 2;\n\n\treturn val;\n}"
  },
  {
    "function_name": "set_features",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "49-59",
    "snippet": "static void set_features(struct btrfs_fs_info *fs_info,\n\t\t\t enum btrfs_feature_set set, u64 features)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\tbtrfs_set_super_compat_flags(disk_super, features);\n\telse if (set == FEAT_COMPAT_RO)\n\t\tbtrfs_set_super_compat_ro_flags(disk_super, features);\n\telse\n\t\tbtrfs_set_super_incompat_flags(disk_super, features);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_set_super_incompat_flags",
          "args": [
            "disk_super",
            "features"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_set_super_compat_ro_flags",
          "args": [
            "disk_super",
            "features"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_set_super_compat_flags",
          "args": [
            "disk_super",
            "features"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic void set_features(struct btrfs_fs_info *fs_info,\n\t\t\t enum btrfs_feature_set set, u64 features)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\tbtrfs_set_super_compat_flags(disk_super, features);\n\telse if (set == FEAT_COMPAT_RO)\n\t\tbtrfs_set_super_compat_ro_flags(disk_super, features);\n\telse\n\t\tbtrfs_set_super_incompat_flags(disk_super, features);\n}"
  },
  {
    "function_name": "get_features",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/sysfs.c",
    "lines": "37-47",
    "snippet": "static u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}",
    "includes": [
      "#include \"volumes.h\"",
      "#include \"sysfs.h\"",
      "#include \"transaction.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/genhd.h>",
      "#include <linux/bug.h>",
      "#include <linux/kobject.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/completion.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_super_incompat_flags",
          "args": [
            "disk_super"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_super_compat_ro_flags",
          "args": [
            "disk_super"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_super_compat_flags",
          "args": [
            "disk_super"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"volumes.h\"\n#include \"sysfs.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/debugfs.h>\n#include <linux/genhd.h>\n#include <linux/bug.h>\n#include <linux/kobject.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic u64 get_features(struct btrfs_fs_info *fs_info,\n\t\t\tenum btrfs_feature_set set)\n{\n\tstruct btrfs_super_block *disk_super = fs_info->super_copy;\n\tif (set == FEAT_COMPAT)\n\t\treturn btrfs_super_compat_flags(disk_super);\n\telse if (set == FEAT_COMPAT_RO)\n\t\treturn btrfs_super_compat_ro_flags(disk_super);\n\telse\n\t\treturn btrfs_super_incompat_flags(disk_super);\n}"
  }
]