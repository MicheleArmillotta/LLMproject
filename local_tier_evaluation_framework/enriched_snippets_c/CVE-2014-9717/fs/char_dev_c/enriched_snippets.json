[
  {
    "function_name": "chrdev_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "554-557",
    "snippet": "void __init chrdev_init(void)\n{\n\tcdev_map = kobj_map_init(base_probe, &chrdevs_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;",
      "static DEFINE_MUTEX(chrdevs_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_map_init",
          "args": [
            "base_probe",
            "&chrdevs_lock"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nvoid __init chrdev_init(void)\n{\n\tcdev_map = kobj_map_init(base_probe, &chrdevs_lock);\n}"
  },
  {
    "function_name": "base_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "546-552",
    "snippet": "static struct kobject *base_probe(dev_t dev, int *part, void *data)\n{\n\tif (request_module(\"char-major-%d-%d\", MAJOR(dev), MINOR(dev)) > 0)\n\t\t/* Make old-style 2.4 aliases work */\n\t\trequest_module(\"char-major-%d\", MAJOR(dev));\n\treturn NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"char-major-%d\"",
            "MAJOR(dev)"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"char-major-%d-%d\"",
            "MAJOR(dev)",
            "MINOR(dev)"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *base_probe(dev_t dev, int *part, void *data)\n{\n\tif (request_module(\"char-major-%d-%d\", MAJOR(dev), MINOR(dev)) > 0)\n\t\t/* Make old-style 2.4 aliases work */\n\t\trequest_module(\"char-major-%d\", MAJOR(dev));\n\treturn NULL;\n}"
  },
  {
    "function_name": "cdev_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "538-544",
    "snippet": "void cdev_init(struct cdev *cdev, const struct file_operations *fops)\n{\n\tmemset(cdev, 0, sizeof *cdev);\n\tINIT_LIST_HEAD(&cdev->list);\n\tkobject_init(&cdev->kobj, &ktype_cdev_default);\n\tcdev->ops = fops;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_type ktype_cdev_default = {\n\t.release\t= cdev_default_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "&cdev->kobj",
            "&ktype_cdev_default"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&cdev->list"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cdev",
            "0",
            "sizeof *cdev"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_default = {\n\t.release\t= cdev_default_release,\n};\n\nvoid cdev_init(struct cdev *cdev, const struct file_operations *fops)\n{\n\tmemset(cdev, 0, sizeof *cdev);\n\tINIT_LIST_HEAD(&cdev->list);\n\tkobject_init(&cdev->kobj, &ktype_cdev_default);\n\tcdev->ops = fops;\n}"
  },
  {
    "function_name": "cdev_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "520-528",
    "snippet": "struct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "&p->kobj",
            "&ktype_cdev_dynamic"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&p->list"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct cdev)",
            "GFP_KERNEL"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};\n\nstruct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}"
  },
  {
    "function_name": "cdev_dynamic_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "497-505",
    "snippet": "static void cdev_dynamic_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkfree(p);\n\tkobject_put(parent);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "parent"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "p"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_purge",
          "args": [
            "p"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "408-418",
          "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic void cdev_dynamic_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkfree(p);\n\tkobject_put(parent);\n}"
  },
  {
    "function_name": "cdev_default_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "488-495",
    "snippet": "static void cdev_default_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkobject_put(parent);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "parent"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_purge",
          "args": [
            "p"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "408-418",
          "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic void cdev_default_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkobject_put(parent);\n}"
  },
  {
    "function_name": "cdev_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "481-485",
    "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&p->kobj"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_unmap",
          "args": [
            "p->dev",
            "p->count"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_unmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "469-472",
          "snippet": "static void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_map *cdev_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nstatic void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
  },
  {
    "function_name": "cdev_unmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "469-472",
    "snippet": "static void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_unmap",
          "args": [
            "cdev_map",
            "dev",
            "count"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nstatic void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}"
  },
  {
    "function_name": "cdev_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "452-467",
    "snippet": "int cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_get",
          "args": [
            "p->kobj.parent"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobj_map",
          "args": [
            "cdev_map",
            "dev",
            "count",
            "NULL",
            "exact_match",
            "exact_lock",
            "p"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "exact_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "436-440",
    "snippet": "static int exact_lock(dev_t dev, void *data)\n{\n\tstruct cdev *p = data;\n\treturn cdev_get(p) ? 0 : -1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_get",
          "args": [
            "p"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "322-333",
          "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic int exact_lock(dev_t dev, void *data)\n{\n\tstruct cdev *p = data;\n\treturn cdev_get(p) ? 0 : -1;\n}"
  },
  {
    "function_name": "exact_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "430-434",
    "snippet": "static struct kobject *exact_match(dev_t dev, int *part, void *data)\n{\n\tstruct cdev *p = data;\n\treturn &p->kobj;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *exact_match(dev_t dev, int *part, void *data)\n{\n\tstruct cdev *p = data;\n\treturn &p->kobj;\n}"
  },
  {
    "function_name": "cdev_purge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "408-418",
    "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&inode->i_devices"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cdev->list.next",
            "structinode",
            "i_devices"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&cdev->list"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
  },
  {
    "function_name": "cd_forget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "400-406",
    "snippet": "void cd_forget(struct inode *inode)\n{\n\tspin_lock(&cdev_lock);\n\tlist_del_init(&inode->i_devices);\n\tinode->i_cdev = NULL;\n\tspin_unlock(&cdev_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&inode->i_devices"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nvoid cd_forget(struct inode *inode)\n{\n\tspin_lock(&cdev_lock);\n\tlist_del_init(&inode->i_devices);\n\tinode->i_cdev = NULL;\n\tspin_unlock(&cdev_lock);\n}"
  },
  {
    "function_name": "chrdev_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "347-398",
    "snippet": "static int chrdev_open(struct inode *inode, struct file *filp)\n{\n\tconst struct file_operations *fops;\n\tstruct cdev *p;\n\tstruct cdev *new = NULL;\n\tint ret = 0;\n\n\tspin_lock(&cdev_lock);\n\tp = inode->i_cdev;\n\tif (!p) {\n\t\tstruct kobject *kobj;\n\t\tint idx;\n\t\tspin_unlock(&cdev_lock);\n\t\tkobj = kobj_lookup(cdev_map, inode->i_rdev, &idx);\n\t\tif (!kobj)\n\t\t\treturn -ENXIO;\n\t\tnew = container_of(kobj, struct cdev, kobj);\n\t\tspin_lock(&cdev_lock);\n\t\t/* Check i_cdev again in case somebody beat us to it while\n\t\t   we dropped the lock. */\n\t\tp = inode->i_cdev;\n\t\tif (!p) {\n\t\t\tinode->i_cdev = p = new;\n\t\t\tlist_add(&inode->i_devices, &p->list);\n\t\t\tnew = NULL;\n\t\t} else if (!cdev_get(p))\n\t\t\tret = -ENXIO;\n\t} else if (!cdev_get(p))\n\t\tret = -ENXIO;\n\tspin_unlock(&cdev_lock);\n\tcdev_put(new);\n\tif (ret)\n\t\treturn ret;\n\n\tret = -ENXIO;\n\tfops = fops_get(p->ops);\n\tif (!fops)\n\t\tgoto out_cdev_put;\n\n\treplace_fops(filp, fops);\n\tif (filp->f_op->open) {\n\t\tret = filp->f_op->open(inode, filp);\n\t\tif (ret)\n\t\t\tgoto out_cdev_put;\n\t}\n\n\treturn 0;\n\n out_cdev_put:\n\tcdev_put(p);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;",
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_put",
          "args": [
            "p"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "335-342",
          "snippet": "void cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "filp->f_op->open",
          "args": [
            "inode",
            "filp"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "replace_fops",
          "args": [
            "filp",
            "fops"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fops_get",
          "args": [
            "p->ops"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_get",
          "args": [
            "p"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "322-333",
          "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&inode->i_devices",
            "&p->list"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobj_lookup",
          "args": [
            "cdev_map",
            "inode->i_rdev",
            "&idx"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic int chrdev_open(struct inode *inode, struct file *filp)\n{\n\tconst struct file_operations *fops;\n\tstruct cdev *p;\n\tstruct cdev *new = NULL;\n\tint ret = 0;\n\n\tspin_lock(&cdev_lock);\n\tp = inode->i_cdev;\n\tif (!p) {\n\t\tstruct kobject *kobj;\n\t\tint idx;\n\t\tspin_unlock(&cdev_lock);\n\t\tkobj = kobj_lookup(cdev_map, inode->i_rdev, &idx);\n\t\tif (!kobj)\n\t\t\treturn -ENXIO;\n\t\tnew = container_of(kobj, struct cdev, kobj);\n\t\tspin_lock(&cdev_lock);\n\t\t/* Check i_cdev again in case somebody beat us to it while\n\t\t   we dropped the lock. */\n\t\tp = inode->i_cdev;\n\t\tif (!p) {\n\t\t\tinode->i_cdev = p = new;\n\t\t\tlist_add(&inode->i_devices, &p->list);\n\t\t\tnew = NULL;\n\t\t} else if (!cdev_get(p))\n\t\t\tret = -ENXIO;\n\t} else if (!cdev_get(p))\n\t\tret = -ENXIO;\n\tspin_unlock(&cdev_lock);\n\tcdev_put(new);\n\tif (ret)\n\t\treturn ret;\n\n\tret = -ENXIO;\n\tfops = fops_get(p->ops);\n\tif (!fops)\n\t\tgoto out_cdev_put;\n\n\treplace_fops(filp, fops);\n\tif (filp->f_op->open) {\n\t\tret = filp->f_op->open(inode, filp);\n\t\tif (ret)\n\t\t\tgoto out_cdev_put;\n\t}\n\n\treturn 0;\n\n out_cdev_put:\n\tcdev_put(p);\n\treturn ret;\n}"
  },
  {
    "function_name": "cdev_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "335-342",
    "snippet": "void cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "owner"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&p->kobj"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}"
  },
  {
    "function_name": "cdev_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "322-333",
    "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "owner"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_get",
          "args": [
            "&p->kobj"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "owner"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
  },
  {
    "function_name": "__unregister_chrdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "309-318",
    "snippet": "void __unregister_chrdev(unsigned int major, unsigned int baseminor,\n\t\t\t unsigned int count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\n\tcd = __unregister_chrdev_region(major, baseminor, count);\n\tif (cd && cd->cdev)\n\t\tcdev_del(cd->cdev);\n\tkfree(cd);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cd"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_del",
          "args": [
            "cd->cdev"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "481-485",
          "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "major",
            "baseminor",
            "count"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "145-163",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nvoid __unregister_chrdev(unsigned int major, unsigned int baseminor,\n\t\t\t unsigned int count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\n\tcd = __unregister_chrdev_region(major, baseminor, count);\n\tif (cd && cd->cdev)\n\t\tcdev_del(cd->cdev);\n\tkfree(cd);\n}"
  },
  {
    "function_name": "unregister_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "285-296",
    "snippet": "void unregister_chrdev_region(dev_t from, unsigned count)\n{\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n)"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "145-163",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid unregister_chrdev_region(dev_t from, unsigned count)\n{\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n}"
  },
  {
    "function_name": "__register_chrdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "242-274",
    "snippet": "int __register_chrdev(unsigned int major, unsigned int baseminor,\n\t\t      unsigned int count, const char *name,\n\t\t      const struct file_operations *fops)\n{\n\tstruct char_device_struct *cd;\n\tstruct cdev *cdev;\n\tint err = -ENOMEM;\n\n\tcd = __register_chrdev_region(major, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\n\tcdev = cdev_alloc();\n\tif (!cdev)\n\t\tgoto out2;\n\n\tcdev->owner = fops->owner;\n\tcdev->ops = fops;\n\tkobject_set_name(&cdev->kobj, \"%s\", name);\n\n\terr = cdev_add(cdev, MKDEV(cd->major, baseminor), count);\n\tif (err)\n\t\tgoto out;\n\n\tcd->cdev = cdev;\n\n\treturn major ? 0 : cd->major;\nout:\n\tkobject_put(&cdev->kobj);\nout2:\n\tkfree(__unregister_chrdev_region(cd->major, baseminor, count));\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(cd->major, baseminor, count)"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "cd->major",
            "baseminor",
            "count"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "145-163",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&cdev->kobj"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_add",
          "args": [
            "cdev",
            "MKDEV(cd->major, baseminor)",
            "count"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "452-467",
          "snippet": "int cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_map *cdev_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "cd->major",
            "baseminor"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_set_name",
          "args": [
            "&cdev->kobj",
            "\"%s\"",
            "name"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_alloc",
          "args": [],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "520-528",
          "snippet": "struct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};\n\nstruct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "major",
            "baseminor",
            "count",
            "name"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "73-143",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint __register_chrdev(unsigned int major, unsigned int baseminor,\n\t\t      unsigned int count, const char *name,\n\t\t      const struct file_operations *fops)\n{\n\tstruct char_device_struct *cd;\n\tstruct cdev *cdev;\n\tint err = -ENOMEM;\n\n\tcd = __register_chrdev_region(major, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\n\tcdev = cdev_alloc();\n\tif (!cdev)\n\t\tgoto out2;\n\n\tcdev->owner = fops->owner;\n\tcdev->ops = fops;\n\tkobject_set_name(&cdev->kobj, \"%s\", name);\n\n\terr = cdev_add(cdev, MKDEV(cd->major, baseminor), count);\n\tif (err)\n\t\tgoto out;\n\n\tcd->cdev = cdev;\n\n\treturn major ? 0 : cd->major;\nout:\n\tkobject_put(&cdev->kobj);\nout2:\n\tkfree(__unregister_chrdev_region(cd->major, baseminor, count));\n\treturn err;\n}"
  },
  {
    "function_name": "alloc_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "210-219",
    "snippet": "int alloc_chrdev_region(dev_t *dev, unsigned baseminor, unsigned count,\n\t\t\tconst char *name)\n{\n\tstruct char_device_struct *cd;\n\tcd = __register_chrdev_region(0, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\t*dev = MKDEV(cd->major, cd->baseminor);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "cd->major",
            "cd->baseminor"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "0",
            "baseminor",
            "count",
            "name"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "73-143",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint alloc_chrdev_region(dev_t *dev, unsigned baseminor, unsigned count,\n\t\t\tconst char *name)\n{\n\tstruct char_device_struct *cd;\n\tcd = __register_chrdev_region(0, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\t*dev = MKDEV(cd->major, cd->baseminor);\n\treturn 0;\n}"
  },
  {
    "function_name": "register_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "174-197",
    "snippet": "int register_chrdev_region(dev_t from, unsigned count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tcd = __register_chrdev_region(MAJOR(n), MINOR(n),\n\t\t\t       next - n, name);\n\t\tif (IS_ERR(cd))\n\t\t\tgoto fail;\n\t}\n\treturn 0;\nfail:\n\tto = n;\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n\treturn PTR_ERR(cd);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n)"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "145-163",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n",
            "name"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "73-143",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint register_chrdev_region(dev_t from, unsigned count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tcd = __register_chrdev_region(MAJOR(n), MINOR(n),\n\t\t\t       next - n, name);\n\t\tif (IS_ERR(cd))\n\t\t\tgoto fail;\n\t}\n\treturn 0;\nfail:\n\tto = n;\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n\treturn PTR_ERR(cd);\n}"
  },
  {
    "function_name": "__unregister_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "145-163",
    "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "major"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "41-44",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
  },
  {
    "function_name": "__register_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "73-143",
    "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);",
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cd"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "major"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
          "lines": "41-44",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "cd->name",
            "name",
            "sizeof(cd->name)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "chrdevs"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct char_device_struct)",
            "GFP_KERNEL"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\t/* temporary */\n\tif (major == 0) {\n\t\tfor (i = ARRAY_SIZE(chrdevs)-1; i > 0; i--) {\n\t\t\tif (chrdevs[i] == NULL)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i == 0) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = i;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
  },
  {
    "function_name": "chrdev_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "48-58",
    "snippet": "void chrdev_show(struct seq_file *f, off_t offset)\n{\n\tstruct char_device_struct *cd;\n\n\tif (offset < CHRDEV_MAJOR_HASH_SIZE) {\n\t\tmutex_lock(&chrdevs_lock);\n\t\tfor (cd = chrdevs[offset]; cd; cd = cd->next)\n\t\t\tseq_printf(f, \"%3d %s\\n\", cd->major, cd->name);\n\t\tmutex_unlock(&chrdevs_lock);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);",
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "f",
            "\"%3d %s\\n\"",
            "cd->major",
            "cd->name"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nvoid chrdev_show(struct seq_file *f, off_t offset)\n{\n\tstruct char_device_struct *cd;\n\n\tif (offset < CHRDEV_MAJOR_HASH_SIZE) {\n\t\tmutex_lock(&chrdevs_lock);\n\t\tfor (cd = chrdevs[offset]; cd; cd = cd->next)\n\t\t\tseq_printf(f, \"%3d %s\\n\", cd->major, cd->name);\n\t\tmutex_unlock(&chrdevs_lock);\n\t}\n}"
  },
  {
    "function_name": "major_to_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/char_dev.c",
    "lines": "41-44",
    "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
  }
]