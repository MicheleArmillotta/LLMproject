[
  {
    "function_name": "btrfs_print_tree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "313-349",
    "snippet": "void btrfs_print_tree(struct btrfs_root *root, struct extent_buffer *c)\n{\n\tint i; u32 nr;\n\tstruct btrfs_key key;\n\tint level;\n\n\tif (!c)\n\t\treturn;\n\tnr = btrfs_header_nritems(c);\n\tlevel = btrfs_header_level(c);\n\tif (level == 0) {\n\t\tbtrfs_print_leaf(root, c);\n\t\treturn;\n\t}\n\tbtrfs_info(root->fs_info, \"node %llu level %d total ptrs %d free spc %u\",\n\t\tbtrfs_header_bytenr(c), level, nr,\n\t\t(u32)BTRFS_NODEPTRS_PER_BLOCK(root) - nr);\n\tfor (i = 0; i < nr; i++) {\n\t\tbtrfs_node_key_to_cpu(c, &key, i);\n\t\tprintk(KERN_INFO \"\\tkey %d (%llu %u %llu) block %llu\\n\",\n\t\t       i, key.objectid, key.type, key.offset,\n\t\t       btrfs_node_blockptr(c, i));\n\t}\n\tfor (i = 0; i < nr; i++) {\n\t\tstruct extent_buffer *next = read_tree_block(root,\n\t\t\t\t\tbtrfs_node_blockptr(c, i),\n\t\t\t\t\tbtrfs_node_ptr_generation(c, i));\n\t\tif (btrfs_is_leaf(next) &&\n\t\t   level != 1)\n\t\t\tBUG();\n\t\tif (btrfs_header_level(next) !=\n\t\t       level - 1)\n\t\t\tBUG();\n\t\tbtrfs_print_tree(root, next);\n\t\tfree_extent_buffer(next);\n\t}\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_extent_buffer",
          "args": [
            "next"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "free_extent_buffer_stale",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/extent_io.c",
          "lines": "5019-5031",
          "snippet": "void free_extent_buffer_stale(struct extent_buffer *eb)\n{\n\tif (!eb)\n\t\treturn;\n\n\tspin_lock(&eb->refs_lock);\n\tset_bit(EXTENT_BUFFER_STALE, &eb->bflags);\n\n\tif (atomic_read(&eb->refs) == 2 && !extent_buffer_under_io(eb) &&\n\t    test_and_clear_bit(EXTENT_BUFFER_TREE_REF, &eb->bflags))\n\t\tatomic_dec(&eb->refs);\n\trelease_extent_buffer(eb);\n}",
          "includes": [
            "#include \"backref.h\"",
            "#include \"rcu-string.h\"",
            "#include \"locking.h\"",
            "#include \"check-integrity.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"ctree.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/cleancache.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mm.h>",
            "#include <linux/bio.h>",
            "#include <linux/slab.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"backref.h\"\n#include \"rcu-string.h\"\n#include \"locking.h\"\n#include \"check-integrity.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"ctree.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/cleancache.h>\n#include <linux/prefetch.h>\n#include <linux/pagevec.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/page-flags.h>\n#include <linux/pagemap.h>\n#include <linux/mm.h>\n#include <linux/bio.h>\n#include <linux/slab.h>\n#include <linux/bitops.h>\n\nvoid free_extent_buffer_stale(struct extent_buffer *eb)\n{\n\tif (!eb)\n\t\treturn;\n\n\tspin_lock(&eb->refs_lock);\n\tset_bit(EXTENT_BUFFER_STALE, &eb->bflags);\n\n\tif (atomic_read(&eb->refs) == 2 && !extent_buffer_under_io(eb) &&\n\t    test_and_clear_bit(EXTENT_BUFFER_TREE_REF, &eb->bflags))\n\t\tatomic_dec(&eb->refs);\n\trelease_extent_buffer(eb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_print_tree",
          "args": [
            "root",
            "next"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_print_tree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "313-349",
          "snippet": "void btrfs_print_tree(struct btrfs_root *root, struct extent_buffer *c)\n{\n\tint i; u32 nr;\n\tstruct btrfs_key key;\n\tint level;\n\n\tif (!c)\n\t\treturn;\n\tnr = btrfs_header_nritems(c);\n\tlevel = btrfs_header_level(c);\n\tif (level == 0) {\n\t\tbtrfs_print_leaf(root, c);\n\t\treturn;\n\t}\n\tbtrfs_info(root->fs_info, \"node %llu level %d total ptrs %d free spc %u\",\n\t\tbtrfs_header_bytenr(c), level, nr,\n\t\t(u32)BTRFS_NODEPTRS_PER_BLOCK(root) - nr);\n\tfor (i = 0; i < nr; i++) {\n\t\tbtrfs_node_key_to_cpu(c, &key, i);\n\t\tprintk(KERN_INFO \"\\tkey %d (%llu %u %llu) block %llu\\n\",\n\t\t       i, key.objectid, key.type, key.offset,\n\t\t       btrfs_node_blockptr(c, i));\n\t}\n\tfor (i = 0; i < nr; i++) {\n\t\tstruct extent_buffer *next = read_tree_block(root,\n\t\t\t\t\tbtrfs_node_blockptr(c, i),\n\t\t\t\t\tbtrfs_node_ptr_generation(c, i));\n\t\tif (btrfs_is_leaf(next) &&\n\t\t   level != 1)\n\t\t\tBUG();\n\t\tif (btrfs_header_level(next) !=\n\t\t       level - 1)\n\t\t\tBUG();\n\t\tbtrfs_print_tree(root, next);\n\t\tfree_extent_buffer(next);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_header_level",
          "args": [
            "next"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_is_leaf",
          "args": [
            "next"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_is_leaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2842-2845",
          "snippet": "static inline int btrfs_is_leaf(struct extent_buffer *eb)\n{\n\treturn btrfs_header_level(eb) == 0;\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline int btrfs_is_leaf(struct extent_buffer *eb)\n{\n\treturn btrfs_header_level(eb) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_tree_block",
          "args": [
            "root",
            "btrfs_node_blockptr(c, i)",
            "btrfs_node_ptr_generation(c, i)"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "read_tree_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "1149-1166",
          "snippet": "struct extent_buffer *read_tree_block(struct btrfs_root *root, u64 bytenr,\n\t\t\t\t      u64 parent_transid)\n{\n\tstruct extent_buffer *buf = NULL;\n\tint ret;\n\n\tbuf = btrfs_find_create_tree_block(root, bytenr);\n\tif (!buf)\n\t\treturn NULL;\n\n\tret = btree_read_extent_buffer_pages(root, buf, 0, parent_transid);\n\tif (ret) {\n\t\tfree_extent_buffer(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_fs_root(struct btrfs_root *root);",
            "static void btrfs_destroy_ordered_extents(struct btrfs_root *root);",
            "static int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);",
            "static void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);",
            "static int btrfs_cleanup_transaction(struct btrfs_root *root);",
            "static void btrfs_error_commit_super(struct btrfs_root *root);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nstatic void free_fs_root(struct btrfs_root *root);\nstatic void btrfs_destroy_ordered_extents(struct btrfs_root *root);\nstatic int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);\nstatic void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);\nstatic int btrfs_cleanup_transaction(struct btrfs_root *root);\nstatic void btrfs_error_commit_super(struct btrfs_root *root);\n\nstruct extent_buffer *read_tree_block(struct btrfs_root *root, u64 bytenr,\n\t\t\t\t      u64 parent_transid)\n{\n\tstruct extent_buffer *buf = NULL;\n\tint ret;\n\n\tbuf = btrfs_find_create_tree_block(root, bytenr);\n\tif (!buf)\n\t\treturn NULL;\n\n\tret = btree_read_extent_buffer_pages(root, buf, 0, parent_transid);\n\tif (ret) {\n\t\tfree_extent_buffer(buf);\n\t\treturn NULL;\n\t}\n\treturn buf;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_node_ptr_generation",
          "args": [
            "c",
            "i"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_node_ptr_generation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2581-2587",
          "snippet": "static inline u64 btrfs_node_ptr_generation(struct extent_buffer *eb, int nr)\n{\n\tunsigned long ptr;\n\tptr = offsetof(struct btrfs_node, ptrs) +\n\t\tsizeof(struct btrfs_key_ptr) * nr;\n\treturn btrfs_key_generation(eb, (struct btrfs_key_ptr *)ptr);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u64 btrfs_node_ptr_generation(struct extent_buffer *eb, int nr)\n{\n\tunsigned long ptr;\n\tptr = offsetof(struct btrfs_node, ptrs) +\n\t\tsizeof(struct btrfs_key_ptr) * nr;\n\treturn btrfs_key_generation(eb, (struct btrfs_key_ptr *)ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_node_blockptr",
          "args": [
            "c",
            "i"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_node_blockptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2564-2570",
          "snippet": "static inline u64 btrfs_node_blockptr(struct extent_buffer *eb, int nr)\n{\n\tunsigned long ptr;\n\tptr = offsetof(struct btrfs_node, ptrs) +\n\t\tsizeof(struct btrfs_key_ptr) * nr;\n\treturn btrfs_key_blockptr(eb, (struct btrfs_key_ptr *)ptr);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u64 btrfs_node_blockptr(struct extent_buffer *eb, int nr)\n{\n\tunsigned long ptr;\n\tptr = offsetof(struct btrfs_node, ptrs) +\n\t\tsizeof(struct btrfs_key_ptr) * nr;\n\treturn btrfs_key_blockptr(eb, (struct btrfs_key_ptr *)ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\tkey %d (%llu %u %llu) block %llu\\n\"",
            "i",
            "key.objectid",
            "key.type",
            "key.offset",
            "btrfs_node_blockptr(c, i)"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_node_key_to_cpu",
          "args": [
            "c",
            "&key",
            "i"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_node_key_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2747-2753",
          "snippet": "static inline void btrfs_node_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_key *key, int nr)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_node_key(eb, &disk_key, nr);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline void btrfs_node_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_key *key, int nr)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_node_key(eb, &disk_key, nr);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_info",
          "args": [
            "root->fs_info",
            "\"node %llu level %d total ptrs %d free spc %u\"",
            "btrfs_header_bytenr(c)",
            "level",
            "nr",
            "(u32)BTRFS_NODEPTRS_PER_BLOCK(root) - nr"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BTRFS_NODEPTRS_PER_BLOCK",
          "args": [
            "root"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_header_bytenr",
          "args": [
            "c"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_print_leaf",
          "args": [
            "root",
            "c"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_print_leaf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "172-311",
          "snippet": "void btrfs_print_leaf(struct btrfs_root *root, struct extent_buffer *l)\n{\n\tint i;\n\tu32 type, nr;\n\tstruct btrfs_item *item;\n\tstruct btrfs_root_item *ri;\n\tstruct btrfs_dir_item *di;\n\tstruct btrfs_inode_item *ii;\n\tstruct btrfs_block_group_item *bi;\n\tstruct btrfs_file_extent_item *fi;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_dev_extent *dev_extent;\n\tstruct btrfs_key key;\n\tstruct btrfs_key found_key;\n\n\tif (!l)\n\t\treturn;\n\n\tnr = btrfs_header_nritems(l);\n\n\tbtrfs_info(root->fs_info, \"leaf %llu total ptrs %d free space %d\",\n\t\t   btrfs_header_bytenr(l), nr, btrfs_leaf_free_space(root, l));\n\tfor (i = 0 ; i < nr ; i++) {\n\t\titem = btrfs_item_nr(i);\n\t\tbtrfs_item_key_to_cpu(l, &key, i);\n\t\ttype = key.type;\n\t\tprintk(KERN_INFO \"\\titem %d key (%llu %u %llu) itemoff %d \"\n\t\t       \"itemsize %d\\n\",\n\t\t\ti, key.objectid, type, key.offset,\n\t\t\tbtrfs_item_offset(l, item), btrfs_item_size(l, item));\n\t\tswitch (type) {\n\t\tcase BTRFS_INODE_ITEM_KEY:\n\t\t\tii = btrfs_item_ptr(l, i, struct btrfs_inode_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tinode generation %llu size %llu \"\n\t\t\t       \"mode %o\\n\",\n\t\t\t       btrfs_inode_generation(l, ii),\n\t\t\t       btrfs_inode_size(l, ii),\n\t\t\t       btrfs_inode_mode(l, ii));\n\t\t\tbreak;\n\t\tcase BTRFS_DIR_ITEM_KEY:\n\t\t\tdi = btrfs_item_ptr(l, i, struct btrfs_dir_item);\n\t\t\tbtrfs_dir_item_key_to_cpu(l, di, &found_key);\n\t\t\tprintk(KERN_INFO \"\\t\\tdir oid %llu type %u\\n\",\n\t\t\t\tfound_key.objectid,\n\t\t\t\tbtrfs_dir_type(l, di));\n\t\t\tbreak;\n\t\tcase BTRFS_ROOT_ITEM_KEY:\n\t\t\tri = btrfs_item_ptr(l, i, struct btrfs_root_item);\n\t\t\tprintk(KERN_INFO \"\\t\\troot data bytenr %llu refs %u\\n\",\n\t\t\t\tbtrfs_disk_root_bytenr(l, ri),\n\t\t\t\tbtrfs_disk_root_refs(l, ri));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_ITEM_KEY:\n\t\tcase BTRFS_METADATA_ITEM_KEY:\n\t\t\tprint_extent_item(l, i, type);\n\t\t\tbreak;\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_extent_data_ref);\n\t\t\tprint_extent_data_ref(l, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_shared_data_ref);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref count %u\\n\",\n\t\t\t       btrfs_shared_data_ref_count(l, sref));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_KEY:\n\t\t\tfi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_file_extent_item);\n\t\t\tif (btrfs_file_extent_type(l, fi) ==\n\t\t\t    BTRFS_FILE_EXTENT_INLINE) {\n\t\t\t\tprintk(KERN_INFO \"\\t\\tinline extent data \"\n\t\t\t\t       \"size %u\\n\",\n\t\t\t\t       btrfs_file_extent_inline_len(l, i, fi));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprintk(KERN_INFO \"\\t\\textent data disk bytenr %llu \"\n\t\t\t       \"nr %llu\\n\",\n\t\t\t       btrfs_file_extent_disk_bytenr(l, fi),\n\t\t\t       btrfs_file_extent_disk_num_bytes(l, fi));\n\t\t\tprintk(KERN_INFO \"\\t\\textent data offset %llu \"\n\t\t\t       \"nr %llu ram %llu\\n\",\n\t\t\t       btrfs_file_extent_offset(l, fi),\n\t\t\t       btrfs_file_extent_num_bytes(l, fi),\n\t\t\t       btrfs_file_extent_ram_bytes(l, fi));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_REF_V0_KEY:\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\t\tprint_extent_ref_v0(l, i);\n#else\n\t\t\tBUG();\n#endif\n\t\t\tbreak;\n\t\tcase BTRFS_BLOCK_GROUP_ITEM_KEY:\n\t\t\tbi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_block_group_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tblock group used %llu\\n\",\n\t\t\t       btrfs_disk_block_group_used(l, bi));\n\t\t\tbreak;\n\t\tcase BTRFS_CHUNK_ITEM_KEY:\n\t\t\tprint_chunk(l, btrfs_item_ptr(l, i,\n\t\t\t\t\t\t      struct btrfs_chunk));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_ITEM_KEY:\n\t\t\tprint_dev_item(l, btrfs_item_ptr(l, i,\n\t\t\t\t\tstruct btrfs_dev_item));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_EXTENT_KEY:\n\t\t\tdev_extent = btrfs_item_ptr(l, i,\n\t\t\t\t\t\t    struct btrfs_dev_extent);\n\t\t\tprintk(KERN_INFO \"\\t\\tdev extent chunk_tree %llu\\n\"\n\t\t\t       \"\\t\\tchunk objectid %llu chunk offset %llu \"\n\t\t\t       \"length %llu\\n\",\n\t\t\t       btrfs_dev_extent_chunk_tree(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_objectid(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_offset(l, dev_extent),\n\t\t\t       btrfs_dev_extent_length(l, dev_extent));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_STATS_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdevice stats\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_REPLACE_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdev replace\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_UUID_KEY_SUBVOL:\n\t\tcase BTRFS_UUID_KEY_RECEIVED_SUBVOL:\n\t\t\tprint_uuid_item(l, btrfs_item_ptr_offset(l, i),\n\t\t\t\t\tbtrfs_item_size_nr(l, i));\n\t\t\tbreak;\n\t\t};\n\t}\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nvoid btrfs_print_leaf(struct btrfs_root *root, struct extent_buffer *l)\n{\n\tint i;\n\tu32 type, nr;\n\tstruct btrfs_item *item;\n\tstruct btrfs_root_item *ri;\n\tstruct btrfs_dir_item *di;\n\tstruct btrfs_inode_item *ii;\n\tstruct btrfs_block_group_item *bi;\n\tstruct btrfs_file_extent_item *fi;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_dev_extent *dev_extent;\n\tstruct btrfs_key key;\n\tstruct btrfs_key found_key;\n\n\tif (!l)\n\t\treturn;\n\n\tnr = btrfs_header_nritems(l);\n\n\tbtrfs_info(root->fs_info, \"leaf %llu total ptrs %d free space %d\",\n\t\t   btrfs_header_bytenr(l), nr, btrfs_leaf_free_space(root, l));\n\tfor (i = 0 ; i < nr ; i++) {\n\t\titem = btrfs_item_nr(i);\n\t\tbtrfs_item_key_to_cpu(l, &key, i);\n\t\ttype = key.type;\n\t\tprintk(KERN_INFO \"\\titem %d key (%llu %u %llu) itemoff %d \"\n\t\t       \"itemsize %d\\n\",\n\t\t\ti, key.objectid, type, key.offset,\n\t\t\tbtrfs_item_offset(l, item), btrfs_item_size(l, item));\n\t\tswitch (type) {\n\t\tcase BTRFS_INODE_ITEM_KEY:\n\t\t\tii = btrfs_item_ptr(l, i, struct btrfs_inode_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tinode generation %llu size %llu \"\n\t\t\t       \"mode %o\\n\",\n\t\t\t       btrfs_inode_generation(l, ii),\n\t\t\t       btrfs_inode_size(l, ii),\n\t\t\t       btrfs_inode_mode(l, ii));\n\t\t\tbreak;\n\t\tcase BTRFS_DIR_ITEM_KEY:\n\t\t\tdi = btrfs_item_ptr(l, i, struct btrfs_dir_item);\n\t\t\tbtrfs_dir_item_key_to_cpu(l, di, &found_key);\n\t\t\tprintk(KERN_INFO \"\\t\\tdir oid %llu type %u\\n\",\n\t\t\t\tfound_key.objectid,\n\t\t\t\tbtrfs_dir_type(l, di));\n\t\t\tbreak;\n\t\tcase BTRFS_ROOT_ITEM_KEY:\n\t\t\tri = btrfs_item_ptr(l, i, struct btrfs_root_item);\n\t\t\tprintk(KERN_INFO \"\\t\\troot data bytenr %llu refs %u\\n\",\n\t\t\t\tbtrfs_disk_root_bytenr(l, ri),\n\t\t\t\tbtrfs_disk_root_refs(l, ri));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_ITEM_KEY:\n\t\tcase BTRFS_METADATA_ITEM_KEY:\n\t\t\tprint_extent_item(l, i, type);\n\t\t\tbreak;\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_extent_data_ref);\n\t\t\tprint_extent_data_ref(l, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_shared_data_ref);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref count %u\\n\",\n\t\t\t       btrfs_shared_data_ref_count(l, sref));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_KEY:\n\t\t\tfi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_file_extent_item);\n\t\t\tif (btrfs_file_extent_type(l, fi) ==\n\t\t\t    BTRFS_FILE_EXTENT_INLINE) {\n\t\t\t\tprintk(KERN_INFO \"\\t\\tinline extent data \"\n\t\t\t\t       \"size %u\\n\",\n\t\t\t\t       btrfs_file_extent_inline_len(l, i, fi));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprintk(KERN_INFO \"\\t\\textent data disk bytenr %llu \"\n\t\t\t       \"nr %llu\\n\",\n\t\t\t       btrfs_file_extent_disk_bytenr(l, fi),\n\t\t\t       btrfs_file_extent_disk_num_bytes(l, fi));\n\t\t\tprintk(KERN_INFO \"\\t\\textent data offset %llu \"\n\t\t\t       \"nr %llu ram %llu\\n\",\n\t\t\t       btrfs_file_extent_offset(l, fi),\n\t\t\t       btrfs_file_extent_num_bytes(l, fi),\n\t\t\t       btrfs_file_extent_ram_bytes(l, fi));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_REF_V0_KEY:\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\t\tprint_extent_ref_v0(l, i);\n#else\n\t\t\tBUG();\n#endif\n\t\t\tbreak;\n\t\tcase BTRFS_BLOCK_GROUP_ITEM_KEY:\n\t\t\tbi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_block_group_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tblock group used %llu\\n\",\n\t\t\t       btrfs_disk_block_group_used(l, bi));\n\t\t\tbreak;\n\t\tcase BTRFS_CHUNK_ITEM_KEY:\n\t\t\tprint_chunk(l, btrfs_item_ptr(l, i,\n\t\t\t\t\t\t      struct btrfs_chunk));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_ITEM_KEY:\n\t\t\tprint_dev_item(l, btrfs_item_ptr(l, i,\n\t\t\t\t\tstruct btrfs_dev_item));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_EXTENT_KEY:\n\t\t\tdev_extent = btrfs_item_ptr(l, i,\n\t\t\t\t\t\t    struct btrfs_dev_extent);\n\t\t\tprintk(KERN_INFO \"\\t\\tdev extent chunk_tree %llu\\n\"\n\t\t\t       \"\\t\\tchunk objectid %llu chunk offset %llu \"\n\t\t\t       \"length %llu\\n\",\n\t\t\t       btrfs_dev_extent_chunk_tree(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_objectid(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_offset(l, dev_extent),\n\t\t\t       btrfs_dev_extent_length(l, dev_extent));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_STATS_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdevice stats\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_REPLACE_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdev replace\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_UUID_KEY_SUBVOL:\n\t\tcase BTRFS_UUID_KEY_RECEIVED_SUBVOL:\n\t\t\tprint_uuid_item(l, btrfs_item_ptr_offset(l, i),\n\t\t\t\t\tbtrfs_item_size_nr(l, i));\n\t\t\tbreak;\n\t\t};\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_header_level",
          "args": [
            "c"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_header_nritems",
          "args": [
            "c"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nvoid btrfs_print_tree(struct btrfs_root *root, struct extent_buffer *c)\n{\n\tint i; u32 nr;\n\tstruct btrfs_key key;\n\tint level;\n\n\tif (!c)\n\t\treturn;\n\tnr = btrfs_header_nritems(c);\n\tlevel = btrfs_header_level(c);\n\tif (level == 0) {\n\t\tbtrfs_print_leaf(root, c);\n\t\treturn;\n\t}\n\tbtrfs_info(root->fs_info, \"node %llu level %d total ptrs %d free spc %u\",\n\t\tbtrfs_header_bytenr(c), level, nr,\n\t\t(u32)BTRFS_NODEPTRS_PER_BLOCK(root) - nr);\n\tfor (i = 0; i < nr; i++) {\n\t\tbtrfs_node_key_to_cpu(c, &key, i);\n\t\tprintk(KERN_INFO \"\\tkey %d (%llu %u %llu) block %llu\\n\",\n\t\t       i, key.objectid, key.type, key.offset,\n\t\t       btrfs_node_blockptr(c, i));\n\t}\n\tfor (i = 0; i < nr; i++) {\n\t\tstruct extent_buffer *next = read_tree_block(root,\n\t\t\t\t\tbtrfs_node_blockptr(c, i),\n\t\t\t\t\tbtrfs_node_ptr_generation(c, i));\n\t\tif (btrfs_is_leaf(next) &&\n\t\t   level != 1)\n\t\t\tBUG();\n\t\tif (btrfs_header_level(next) !=\n\t\t       level - 1)\n\t\t\tBUG();\n\t\tbtrfs_print_tree(root, next);\n\t\tfree_extent_buffer(next);\n\t}\n}"
  },
  {
    "function_name": "btrfs_print_leaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "172-311",
    "snippet": "void btrfs_print_leaf(struct btrfs_root *root, struct extent_buffer *l)\n{\n\tint i;\n\tu32 type, nr;\n\tstruct btrfs_item *item;\n\tstruct btrfs_root_item *ri;\n\tstruct btrfs_dir_item *di;\n\tstruct btrfs_inode_item *ii;\n\tstruct btrfs_block_group_item *bi;\n\tstruct btrfs_file_extent_item *fi;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_dev_extent *dev_extent;\n\tstruct btrfs_key key;\n\tstruct btrfs_key found_key;\n\n\tif (!l)\n\t\treturn;\n\n\tnr = btrfs_header_nritems(l);\n\n\tbtrfs_info(root->fs_info, \"leaf %llu total ptrs %d free space %d\",\n\t\t   btrfs_header_bytenr(l), nr, btrfs_leaf_free_space(root, l));\n\tfor (i = 0 ; i < nr ; i++) {\n\t\titem = btrfs_item_nr(i);\n\t\tbtrfs_item_key_to_cpu(l, &key, i);\n\t\ttype = key.type;\n\t\tprintk(KERN_INFO \"\\titem %d key (%llu %u %llu) itemoff %d \"\n\t\t       \"itemsize %d\\n\",\n\t\t\ti, key.objectid, type, key.offset,\n\t\t\tbtrfs_item_offset(l, item), btrfs_item_size(l, item));\n\t\tswitch (type) {\n\t\tcase BTRFS_INODE_ITEM_KEY:\n\t\t\tii = btrfs_item_ptr(l, i, struct btrfs_inode_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tinode generation %llu size %llu \"\n\t\t\t       \"mode %o\\n\",\n\t\t\t       btrfs_inode_generation(l, ii),\n\t\t\t       btrfs_inode_size(l, ii),\n\t\t\t       btrfs_inode_mode(l, ii));\n\t\t\tbreak;\n\t\tcase BTRFS_DIR_ITEM_KEY:\n\t\t\tdi = btrfs_item_ptr(l, i, struct btrfs_dir_item);\n\t\t\tbtrfs_dir_item_key_to_cpu(l, di, &found_key);\n\t\t\tprintk(KERN_INFO \"\\t\\tdir oid %llu type %u\\n\",\n\t\t\t\tfound_key.objectid,\n\t\t\t\tbtrfs_dir_type(l, di));\n\t\t\tbreak;\n\t\tcase BTRFS_ROOT_ITEM_KEY:\n\t\t\tri = btrfs_item_ptr(l, i, struct btrfs_root_item);\n\t\t\tprintk(KERN_INFO \"\\t\\troot data bytenr %llu refs %u\\n\",\n\t\t\t\tbtrfs_disk_root_bytenr(l, ri),\n\t\t\t\tbtrfs_disk_root_refs(l, ri));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_ITEM_KEY:\n\t\tcase BTRFS_METADATA_ITEM_KEY:\n\t\t\tprint_extent_item(l, i, type);\n\t\t\tbreak;\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_extent_data_ref);\n\t\t\tprint_extent_data_ref(l, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_shared_data_ref);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref count %u\\n\",\n\t\t\t       btrfs_shared_data_ref_count(l, sref));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_KEY:\n\t\t\tfi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_file_extent_item);\n\t\t\tif (btrfs_file_extent_type(l, fi) ==\n\t\t\t    BTRFS_FILE_EXTENT_INLINE) {\n\t\t\t\tprintk(KERN_INFO \"\\t\\tinline extent data \"\n\t\t\t\t       \"size %u\\n\",\n\t\t\t\t       btrfs_file_extent_inline_len(l, i, fi));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprintk(KERN_INFO \"\\t\\textent data disk bytenr %llu \"\n\t\t\t       \"nr %llu\\n\",\n\t\t\t       btrfs_file_extent_disk_bytenr(l, fi),\n\t\t\t       btrfs_file_extent_disk_num_bytes(l, fi));\n\t\t\tprintk(KERN_INFO \"\\t\\textent data offset %llu \"\n\t\t\t       \"nr %llu ram %llu\\n\",\n\t\t\t       btrfs_file_extent_offset(l, fi),\n\t\t\t       btrfs_file_extent_num_bytes(l, fi),\n\t\t\t       btrfs_file_extent_ram_bytes(l, fi));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_REF_V0_KEY:\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\t\tprint_extent_ref_v0(l, i);\n#else\n\t\t\tBUG();\n#endif\n\t\t\tbreak;\n\t\tcase BTRFS_BLOCK_GROUP_ITEM_KEY:\n\t\t\tbi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_block_group_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tblock group used %llu\\n\",\n\t\t\t       btrfs_disk_block_group_used(l, bi));\n\t\t\tbreak;\n\t\tcase BTRFS_CHUNK_ITEM_KEY:\n\t\t\tprint_chunk(l, btrfs_item_ptr(l, i,\n\t\t\t\t\t\t      struct btrfs_chunk));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_ITEM_KEY:\n\t\t\tprint_dev_item(l, btrfs_item_ptr(l, i,\n\t\t\t\t\tstruct btrfs_dev_item));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_EXTENT_KEY:\n\t\t\tdev_extent = btrfs_item_ptr(l, i,\n\t\t\t\t\t\t    struct btrfs_dev_extent);\n\t\t\tprintk(KERN_INFO \"\\t\\tdev extent chunk_tree %llu\\n\"\n\t\t\t       \"\\t\\tchunk objectid %llu chunk offset %llu \"\n\t\t\t       \"length %llu\\n\",\n\t\t\t       btrfs_dev_extent_chunk_tree(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_objectid(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_offset(l, dev_extent),\n\t\t\t       btrfs_dev_extent_length(l, dev_extent));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_STATS_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdevice stats\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_REPLACE_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdev replace\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_UUID_KEY_SUBVOL:\n\t\tcase BTRFS_UUID_KEY_RECEIVED_SUBVOL:\n\t\t\tprint_uuid_item(l, btrfs_item_ptr_offset(l, i),\n\t\t\t\t\tbtrfs_item_size_nr(l, i));\n\t\t\tbreak;\n\t\t};\n\t}\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_uuid_item",
          "args": [
            "l",
            "btrfs_item_ptr_offset(l, i)",
            "btrfs_item_size_nr(l, i)"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "print_uuid_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "153-170",
          "snippet": "static void print_uuid_item(struct extent_buffer *l, unsigned long offset,\n\t\t\t    u32 item_size)\n{\n\tif (!IS_ALIGNED(item_size, sizeof(u64))) {\n\t\tpr_warn(\"BTRFS: uuid item with illegal size %lu!\\n\",\n\t\t\t(unsigned long)item_size);\n\t\treturn;\n\t}\n\twhile (item_size) {\n\t\t__le64 subvol_id;\n\n\t\tread_extent_buffer(l, &subvol_id, offset, sizeof(subvol_id));\n\t\tprintk(KERN_INFO \"\\t\\tsubvol_id %llu\\n\",\n\t\t       (unsigned long long)le64_to_cpu(subvol_id));\n\t\titem_size -= sizeof(u64);\n\t\toffset += sizeof(u64);\n\t}\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_uuid_item(struct extent_buffer *l, unsigned long offset,\n\t\t\t    u32 item_size)\n{\n\tif (!IS_ALIGNED(item_size, sizeof(u64))) {\n\t\tpr_warn(\"BTRFS: uuid item with illegal size %lu!\\n\",\n\t\t\t(unsigned long)item_size);\n\t\treturn;\n\t}\n\twhile (item_size) {\n\t\t__le64 subvol_id;\n\n\t\tread_extent_buffer(l, &subvol_id, offset, sizeof(subvol_id));\n\t\tprintk(KERN_INFO \"\\t\\tsubvol_id %llu\\n\",\n\t\t       (unsigned long long)le64_to_cpu(subvol_id));\n\t\titem_size -= sizeof(u64);\n\t\toffset += sizeof(u64);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_size_nr",
          "args": [
            "l",
            "i"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_item_size_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2649-2652",
          "snippet": "static inline u32 btrfs_item_size_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_size(eb, btrfs_item_nr(nr));\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u32 btrfs_item_size_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_size(eb, btrfs_item_nr(nr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr_offset",
          "args": [
            "l",
            "i"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\tdev replace\\n\""
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\tdev extent chunk_tree %llu\\n\"\n\t\t\t       \"\\t\\tchunk objectid %llu chunk offset %llu \"\n\t\t\t       \"length %llu\\n\"",
            "btrfs_dev_extent_chunk_tree(l, dev_extent)",
            "btrfs_dev_extent_chunk_objectid(l, dev_extent)",
            "btrfs_dev_extent_chunk_offset(l, dev_extent)",
            "btrfs_dev_extent_length(l, dev_extent)"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_dev_extent_length",
          "args": [
            "l",
            "dev_extent"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_dev_extent_chunk_offset",
          "args": [
            "l",
            "dev_extent"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_dev_extent_chunk_objectid",
          "args": [
            "l",
            "dev_extent"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_dev_extent_chunk_tree",
          "args": [
            "l",
            "dev_extent"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_dev_extent"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_dev_item",
          "args": [
            "l",
            "btrfs_item_ptr(l, i,\n\t\t\t\t\tstruct btrfs_dev_item)"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "print_dev_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "37-45",
          "snippet": "static void print_dev_item(struct extent_buffer *eb,\n\t\t\t   struct btrfs_dev_item *dev_item)\n{\n\tprintk(KERN_INFO \"\\t\\tdev item devid %llu \"\n\t       \"total_bytes %llu bytes used %llu\\n\",\n\t       btrfs_device_id(eb, dev_item),\n\t       btrfs_device_total_bytes(eb, dev_item),\n\t       btrfs_device_bytes_used(eb, dev_item));\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_dev_item(struct extent_buffer *eb,\n\t\t\t   struct btrfs_dev_item *dev_item)\n{\n\tprintk(KERN_INFO \"\\t\\tdev item devid %llu \"\n\t       \"total_bytes %llu bytes used %llu\\n\",\n\t       btrfs_device_id(eb, dev_item),\n\t       btrfs_device_total_bytes(eb, dev_item),\n\t       btrfs_device_bytes_used(eb, dev_item));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_dev_item"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_chunk",
          "args": [
            "l",
            "btrfs_item_ptr(l, i,\n\t\t\t\t\t\t      struct btrfs_chunk)"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "print_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "23-36",
          "snippet": "static void print_chunk(struct extent_buffer *eb, struct btrfs_chunk *chunk)\n{\n\tint num_stripes = btrfs_chunk_num_stripes(eb, chunk);\n\tint i;\n\tprintk(KERN_INFO \"\\t\\tchunk length %llu owner %llu type %llu \"\n\t       \"num_stripes %d\\n\",\n\t       btrfs_chunk_length(eb, chunk), btrfs_chunk_owner(eb, chunk),\n\t       btrfs_chunk_type(eb, chunk), num_stripes);\n\tfor (i = 0 ; i < num_stripes ; i++) {\n\t\tprintk(KERN_INFO \"\\t\\t\\tstripe %d devid %llu offset %llu\\n\", i,\n\t\t      btrfs_stripe_devid_nr(eb, chunk, i),\n\t\t      btrfs_stripe_offset_nr(eb, chunk, i));\n\t}\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_chunk(struct extent_buffer *eb, struct btrfs_chunk *chunk)\n{\n\tint num_stripes = btrfs_chunk_num_stripes(eb, chunk);\n\tint i;\n\tprintk(KERN_INFO \"\\t\\tchunk length %llu owner %llu type %llu \"\n\t       \"num_stripes %d\\n\",\n\t       btrfs_chunk_length(eb, chunk), btrfs_chunk_owner(eb, chunk),\n\t       btrfs_chunk_type(eb, chunk), num_stripes);\n\tfor (i = 0 ; i < num_stripes ; i++) {\n\t\tprintk(KERN_INFO \"\\t\\t\\tstripe %d devid %llu offset %llu\\n\", i,\n\t\t      btrfs_stripe_devid_nr(eb, chunk, i),\n\t\t      btrfs_stripe_offset_nr(eb, chunk, i));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_chunk"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_disk_block_group_used",
          "args": [
            "l",
            "bi"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_block_group_item"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_extent_ref_v0",
          "args": [
            "l",
            "i"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "print_extent_ref_v0",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "139-150",
          "snippet": "static void print_extent_ref_v0(struct extent_buffer *eb, int slot)\n{\n\tstruct btrfs_extent_ref_v0 *ref0;\n\n\tref0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_ref_v0);\n\tprintk(\"\\t\\textent back ref root %llu gen %llu \"\n\t\t\"owner %llu num_refs %lu\\n\",\n\t\tbtrfs_ref_root_v0(eb, ref0),\n\t\tbtrfs_ref_generation_v0(eb, ref0),\n\t\tbtrfs_ref_objectid_v0(eb, ref0),\n\t\t(unsigned long)btrfs_ref_count_v0(eb, ref0));\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_ref_v0(struct extent_buffer *eb, int slot)\n{\n\tstruct btrfs_extent_ref_v0 *ref0;\n\n\tref0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_ref_v0);\n\tprintk(\"\\t\\textent back ref root %llu gen %llu \"\n\t\t\"owner %llu num_refs %lu\\n\",\n\t\tbtrfs_ref_root_v0(eb, ref0),\n\t\tbtrfs_ref_generation_v0(eb, ref0),\n\t\tbtrfs_ref_objectid_v0(eb, ref0),\n\t\t(unsigned long)btrfs_ref_count_v0(eb, ref0));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_ram_bytes",
          "args": [
            "l",
            "fi"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_num_bytes",
          "args": [
            "l",
            "fi"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_offset",
          "args": [
            "l",
            "fi"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_disk_num_bytes",
          "args": [
            "l",
            "fi"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_disk_bytenr",
          "args": [
            "l",
            "fi"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_inline_len",
          "args": [
            "l",
            "i",
            "fi"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_file_extent_inline_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "3139-3159",
          "snippet": "static inline u32 btrfs_file_extent_inline_len(struct extent_buffer *eb,\n\t\t\t\t\t       int slot,\n\t\t\t\t\t       struct btrfs_file_extent_item *fi)\n{\n\tstruct btrfs_map_token token;\n\n\tbtrfs_init_map_token(&token);\n\t/*\n\t * return the space used on disk if this item isn't\n\t * compressed or encoded\n\t */\n\tif (btrfs_token_file_extent_compression(eb, fi, &token) == 0 &&\n\t    btrfs_token_file_extent_encryption(eb, fi, &token) == 0 &&\n\t    btrfs_token_file_extent_other_encoding(eb, fi, &token) == 0) {\n\t\treturn btrfs_file_extent_inline_item_len(eb,\n\t\t\t\t\t\t\t btrfs_item_nr(slot));\n\t}\n\n\t/* otherwise use the ram bytes field */\n\treturn btrfs_token_file_extent_ram_bytes(eb, fi, &token);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u32 btrfs_file_extent_inline_len(struct extent_buffer *eb,\n\t\t\t\t\t       int slot,\n\t\t\t\t\t       struct btrfs_file_extent_item *fi)\n{\n\tstruct btrfs_map_token token;\n\n\tbtrfs_init_map_token(&token);\n\t/*\n\t * return the space used on disk if this item isn't\n\t * compressed or encoded\n\t */\n\tif (btrfs_token_file_extent_compression(eb, fi, &token) == 0 &&\n\t    btrfs_token_file_extent_encryption(eb, fi, &token) == 0 &&\n\t    btrfs_token_file_extent_other_encoding(eb, fi, &token) == 0) {\n\t\treturn btrfs_file_extent_inline_item_len(eb,\n\t\t\t\t\t\t\t btrfs_item_nr(slot));\n\t}\n\n\t/* otherwise use the ram bytes field */\n\treturn btrfs_token_file_extent_ram_bytes(eb, fi, &token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_file_extent_type",
          "args": [
            "l",
            "fi"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_file_extent_item"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_shared_data_ref_count",
          "args": [
            "l",
            "sref"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_shared_data_ref"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_extent_data_ref",
          "args": [
            "l",
            "dref"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "print_extent_data_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "46-55",
          "snippet": "static void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_extent_data_ref"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_extent_item",
          "args": [
            "l",
            "i",
            "type"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "print_extent_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "57-136",
          "snippet": "static void print_extent_item(struct extent_buffer *eb, int slot, int type)\n{\n\tstruct btrfs_extent_item *ei;\n\tstruct btrfs_extent_inline_ref *iref;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_disk_key key;\n\tunsigned long end;\n\tunsigned long ptr;\n\tu32 item_size = btrfs_item_size_nr(eb, slot);\n\tu64 flags;\n\tu64 offset;\n\n\tif (item_size < sizeof(*ei)) {\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\tstruct btrfs_extent_item_v0 *ei0;\n\t\tBUG_ON(item_size != sizeof(*ei0));\n\t\tei0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_item_v0);\n\t\tprintk(KERN_INFO \"\\t\\textent refs %u\\n\",\n\t\t       btrfs_extent_refs_v0(eb, ei0));\n\t\treturn;\n#else\n\t\tBUG();\n#endif\n\t}\n\n\tei = btrfs_item_ptr(eb, slot, struct btrfs_extent_item);\n\tflags = btrfs_extent_flags(eb, ei);\n\n\tprintk(KERN_INFO \"\\t\\textent refs %llu gen %llu flags %llu\\n\",\n\t       btrfs_extent_refs(eb, ei), btrfs_extent_generation(eb, ei),\n\t       flags);\n\n\tif ((type == BTRFS_EXTENT_ITEM_KEY) &&\n\t    flags & BTRFS_EXTENT_FLAG_TREE_BLOCK) {\n\t\tstruct btrfs_tree_block_info *info;\n\t\tinfo = (struct btrfs_tree_block_info *)(ei + 1);\n\t\tbtrfs_tree_block_key(eb, info, &key);\n\t\tprintk(KERN_INFO \"\\t\\ttree block key (%llu %u %llu) \"\n\t\t       \"level %d\\n\",\n\t\t       btrfs_disk_key_objectid(&key), key.type,\n\t\t       btrfs_disk_key_offset(&key),\n\t\t       btrfs_tree_block_level(eb, info));\n\t\tiref = (struct btrfs_extent_inline_ref *)(info + 1);\n\t} else {\n\t\tiref = (struct btrfs_extent_inline_ref *)(ei + 1);\n\t}\n\n\tptr = (unsigned long)iref;\n\tend = (unsigned long)ei + item_size;\n\twhile (ptr < end) {\n\t\tiref = (struct btrfs_extent_inline_ref *)ptr;\n\t\ttype = btrfs_extent_inline_ref_type(eb, iref);\n\t\toffset = btrfs_extent_inline_ref_offset(eb, iref);\n\t\tswitch (type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref \"\n\t\t\t\t\"root %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref \"\n\t\t\t\t\"parent %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = (struct btrfs_extent_data_ref *)(&iref->offset);\n\t\t\tprint_extent_data_ref(eb, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = (struct btrfs_shared_data_ref *)(iref + 1);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref \"\n\t\t\t       \"parent %llu count %u\\n\",\n\t\t\t       offset, btrfs_shared_data_ref_count(eb, sref));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tptr += btrfs_extent_inline_ref_size(type);\n\t}\n\tWARN_ON(ptr > end);\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_item(struct extent_buffer *eb, int slot, int type)\n{\n\tstruct btrfs_extent_item *ei;\n\tstruct btrfs_extent_inline_ref *iref;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_disk_key key;\n\tunsigned long end;\n\tunsigned long ptr;\n\tu32 item_size = btrfs_item_size_nr(eb, slot);\n\tu64 flags;\n\tu64 offset;\n\n\tif (item_size < sizeof(*ei)) {\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\tstruct btrfs_extent_item_v0 *ei0;\n\t\tBUG_ON(item_size != sizeof(*ei0));\n\t\tei0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_item_v0);\n\t\tprintk(KERN_INFO \"\\t\\textent refs %u\\n\",\n\t\t       btrfs_extent_refs_v0(eb, ei0));\n\t\treturn;\n#else\n\t\tBUG();\n#endif\n\t}\n\n\tei = btrfs_item_ptr(eb, slot, struct btrfs_extent_item);\n\tflags = btrfs_extent_flags(eb, ei);\n\n\tprintk(KERN_INFO \"\\t\\textent refs %llu gen %llu flags %llu\\n\",\n\t       btrfs_extent_refs(eb, ei), btrfs_extent_generation(eb, ei),\n\t       flags);\n\n\tif ((type == BTRFS_EXTENT_ITEM_KEY) &&\n\t    flags & BTRFS_EXTENT_FLAG_TREE_BLOCK) {\n\t\tstruct btrfs_tree_block_info *info;\n\t\tinfo = (struct btrfs_tree_block_info *)(ei + 1);\n\t\tbtrfs_tree_block_key(eb, info, &key);\n\t\tprintk(KERN_INFO \"\\t\\ttree block key (%llu %u %llu) \"\n\t\t       \"level %d\\n\",\n\t\t       btrfs_disk_key_objectid(&key), key.type,\n\t\t       btrfs_disk_key_offset(&key),\n\t\t       btrfs_tree_block_level(eb, info));\n\t\tiref = (struct btrfs_extent_inline_ref *)(info + 1);\n\t} else {\n\t\tiref = (struct btrfs_extent_inline_ref *)(ei + 1);\n\t}\n\n\tptr = (unsigned long)iref;\n\tend = (unsigned long)ei + item_size;\n\twhile (ptr < end) {\n\t\tiref = (struct btrfs_extent_inline_ref *)ptr;\n\t\ttype = btrfs_extent_inline_ref_type(eb, iref);\n\t\toffset = btrfs_extent_inline_ref_offset(eb, iref);\n\t\tswitch (type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref \"\n\t\t\t\t\"root %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref \"\n\t\t\t\t\"parent %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = (struct btrfs_extent_data_ref *)(&iref->offset);\n\t\t\tprint_extent_data_ref(eb, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = (struct btrfs_shared_data_ref *)(iref + 1);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref \"\n\t\t\t       \"parent %llu count %u\\n\",\n\t\t\t       offset, btrfs_shared_data_ref_count(eb, sref));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tptr += btrfs_extent_inline_ref_size(type);\n\t}\n\tWARN_ON(ptr > end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_disk_root_refs",
          "args": [
            "l",
            "ri"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_disk_root_bytenr",
          "args": [
            "l",
            "ri"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_root_item"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_dir_type",
          "args": [
            "l",
            "di"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_dir_item_key_to_cpu",
          "args": [
            "l",
            "di",
            "&found_key"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_dir_item_key_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2763-2770",
          "snippet": "static inline void btrfs_dir_item_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t      struct btrfs_dir_item *item,\n\t\t\t\t      struct btrfs_key *key)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_dir_item_key(eb, item, &disk_key);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline void btrfs_dir_item_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t      struct btrfs_dir_item *item,\n\t\t\t\t      struct btrfs_key *key)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_dir_item_key(eb, item, &disk_key);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_dir_item"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_inode_mode",
          "args": [
            "l",
            "ii"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_inode_size",
          "args": [
            "l",
            "ii"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_inode_generation",
          "args": [
            "l",
            "ii"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "l",
            "i",
            "structbtrfs_inode_item"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_offset",
          "args": [
            "l",
            "item"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_item_offset_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2644-2647",
          "snippet": "static inline u32 btrfs_item_offset_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_offset(eb, btrfs_item_nr(nr));\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u32 btrfs_item_offset_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_offset(eb, btrfs_item_nr(nr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_key_to_cpu",
          "args": [
            "l",
            "&key",
            "i"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_item_key_to_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2755-2761",
          "snippet": "static inline void btrfs_item_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_key *key, int nr)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_item_key(eb, &disk_key, nr);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline void btrfs_item_key_to_cpu(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_key *key, int nr)\n{\n\tstruct btrfs_disk_key disk_key;\n\tbtrfs_item_key(eb, &disk_key, nr);\n\tbtrfs_disk_key_to_cpu(key, &disk_key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_item_nr",
          "args": [
            "i"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_item_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2628-2631",
          "snippet": "static inline struct btrfs_item *btrfs_item_nr(int nr)\n{\n\treturn (struct btrfs_item *)btrfs_item_nr_offset(nr);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline struct btrfs_item *btrfs_item_nr(int nr)\n{\n\treturn (struct btrfs_item *)btrfs_item_nr_offset(nr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_info",
          "args": [
            "root->fs_info",
            "\"leaf %llu total ptrs %d free space %d\"",
            "btrfs_header_bytenr(l)",
            "nr",
            "btrfs_leaf_free_space(root, l)"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_leaf_free_space",
          "args": [
            "root",
            "l"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_leaf_free_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.c",
          "lines": "3566-3579",
          "snippet": "noinline int btrfs_leaf_free_space(struct btrfs_root *root,\n\t\t\t\t   struct extent_buffer *leaf)\n{\n\tint nritems = btrfs_header_nritems(leaf);\n\tint ret;\n\tret = BTRFS_LEAF_DATA_SIZE(root) - leaf_space_used(leaf, 0, nritems);\n\tif (ret < 0) {\n\t\tbtrfs_crit(root->fs_info,\n\t\t\t\"leaf free space ret %d, leaf data size %lu, used %d nritems %d\",\n\t\t       ret, (unsigned long) BTRFS_LEAF_DATA_SIZE(root),\n\t\t       leaf_space_used(leaf, 0, nritems), nritems);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <linux/rbtree.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <linux/rbtree.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic noinline struct;\n\nnoinline int btrfs_leaf_free_space(struct btrfs_root *root,\n\t\t\t\t   struct extent_buffer *leaf)\n{\n\tint nritems = btrfs_header_nritems(leaf);\n\tint ret;\n\tret = BTRFS_LEAF_DATA_SIZE(root) - leaf_space_used(leaf, 0, nritems);\n\tif (ret < 0) {\n\t\tbtrfs_crit(root->fs_info,\n\t\t\t\"leaf free space ret %d, leaf data size %lu, used %d nritems %d\",\n\t\t       ret, (unsigned long) BTRFS_LEAF_DATA_SIZE(root),\n\t\t       leaf_space_used(leaf, 0, nritems), nritems);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_header_bytenr",
          "args": [
            "l"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_header_nritems",
          "args": [
            "l"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nvoid btrfs_print_leaf(struct btrfs_root *root, struct extent_buffer *l)\n{\n\tint i;\n\tu32 type, nr;\n\tstruct btrfs_item *item;\n\tstruct btrfs_root_item *ri;\n\tstruct btrfs_dir_item *di;\n\tstruct btrfs_inode_item *ii;\n\tstruct btrfs_block_group_item *bi;\n\tstruct btrfs_file_extent_item *fi;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_dev_extent *dev_extent;\n\tstruct btrfs_key key;\n\tstruct btrfs_key found_key;\n\n\tif (!l)\n\t\treturn;\n\n\tnr = btrfs_header_nritems(l);\n\n\tbtrfs_info(root->fs_info, \"leaf %llu total ptrs %d free space %d\",\n\t\t   btrfs_header_bytenr(l), nr, btrfs_leaf_free_space(root, l));\n\tfor (i = 0 ; i < nr ; i++) {\n\t\titem = btrfs_item_nr(i);\n\t\tbtrfs_item_key_to_cpu(l, &key, i);\n\t\ttype = key.type;\n\t\tprintk(KERN_INFO \"\\titem %d key (%llu %u %llu) itemoff %d \"\n\t\t       \"itemsize %d\\n\",\n\t\t\ti, key.objectid, type, key.offset,\n\t\t\tbtrfs_item_offset(l, item), btrfs_item_size(l, item));\n\t\tswitch (type) {\n\t\tcase BTRFS_INODE_ITEM_KEY:\n\t\t\tii = btrfs_item_ptr(l, i, struct btrfs_inode_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tinode generation %llu size %llu \"\n\t\t\t       \"mode %o\\n\",\n\t\t\t       btrfs_inode_generation(l, ii),\n\t\t\t       btrfs_inode_size(l, ii),\n\t\t\t       btrfs_inode_mode(l, ii));\n\t\t\tbreak;\n\t\tcase BTRFS_DIR_ITEM_KEY:\n\t\t\tdi = btrfs_item_ptr(l, i, struct btrfs_dir_item);\n\t\t\tbtrfs_dir_item_key_to_cpu(l, di, &found_key);\n\t\t\tprintk(KERN_INFO \"\\t\\tdir oid %llu type %u\\n\",\n\t\t\t\tfound_key.objectid,\n\t\t\t\tbtrfs_dir_type(l, di));\n\t\t\tbreak;\n\t\tcase BTRFS_ROOT_ITEM_KEY:\n\t\t\tri = btrfs_item_ptr(l, i, struct btrfs_root_item);\n\t\t\tprintk(KERN_INFO \"\\t\\troot data bytenr %llu refs %u\\n\",\n\t\t\t\tbtrfs_disk_root_bytenr(l, ri),\n\t\t\t\tbtrfs_disk_root_refs(l, ri));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_ITEM_KEY:\n\t\tcase BTRFS_METADATA_ITEM_KEY:\n\t\t\tprint_extent_item(l, i, type);\n\t\t\tbreak;\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_extent_data_ref);\n\t\t\tprint_extent_data_ref(l, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = btrfs_item_ptr(l, i,\n\t\t\t\t\t      struct btrfs_shared_data_ref);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref count %u\\n\",\n\t\t\t       btrfs_shared_data_ref_count(l, sref));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_KEY:\n\t\t\tfi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_file_extent_item);\n\t\t\tif (btrfs_file_extent_type(l, fi) ==\n\t\t\t    BTRFS_FILE_EXTENT_INLINE) {\n\t\t\t\tprintk(KERN_INFO \"\\t\\tinline extent data \"\n\t\t\t\t       \"size %u\\n\",\n\t\t\t\t       btrfs_file_extent_inline_len(l, i, fi));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tprintk(KERN_INFO \"\\t\\textent data disk bytenr %llu \"\n\t\t\t       \"nr %llu\\n\",\n\t\t\t       btrfs_file_extent_disk_bytenr(l, fi),\n\t\t\t       btrfs_file_extent_disk_num_bytes(l, fi));\n\t\t\tprintk(KERN_INFO \"\\t\\textent data offset %llu \"\n\t\t\t       \"nr %llu ram %llu\\n\",\n\t\t\t       btrfs_file_extent_offset(l, fi),\n\t\t\t       btrfs_file_extent_num_bytes(l, fi),\n\t\t\t       btrfs_file_extent_ram_bytes(l, fi));\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_REF_V0_KEY:\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\t\tprint_extent_ref_v0(l, i);\n#else\n\t\t\tBUG();\n#endif\n\t\t\tbreak;\n\t\tcase BTRFS_BLOCK_GROUP_ITEM_KEY:\n\t\t\tbi = btrfs_item_ptr(l, i,\n\t\t\t\t\t    struct btrfs_block_group_item);\n\t\t\tprintk(KERN_INFO \"\\t\\tblock group used %llu\\n\",\n\t\t\t       btrfs_disk_block_group_used(l, bi));\n\t\t\tbreak;\n\t\tcase BTRFS_CHUNK_ITEM_KEY:\n\t\t\tprint_chunk(l, btrfs_item_ptr(l, i,\n\t\t\t\t\t\t      struct btrfs_chunk));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_ITEM_KEY:\n\t\t\tprint_dev_item(l, btrfs_item_ptr(l, i,\n\t\t\t\t\tstruct btrfs_dev_item));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_EXTENT_KEY:\n\t\t\tdev_extent = btrfs_item_ptr(l, i,\n\t\t\t\t\t\t    struct btrfs_dev_extent);\n\t\t\tprintk(KERN_INFO \"\\t\\tdev extent chunk_tree %llu\\n\"\n\t\t\t       \"\\t\\tchunk objectid %llu chunk offset %llu \"\n\t\t\t       \"length %llu\\n\",\n\t\t\t       btrfs_dev_extent_chunk_tree(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_objectid(l, dev_extent),\n\t\t\t       btrfs_dev_extent_chunk_offset(l, dev_extent),\n\t\t\t       btrfs_dev_extent_length(l, dev_extent));\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_STATS_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdevice stats\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_DEV_REPLACE_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tdev replace\\n\");\n\t\t\tbreak;\n\t\tcase BTRFS_UUID_KEY_SUBVOL:\n\t\tcase BTRFS_UUID_KEY_RECEIVED_SUBVOL:\n\t\t\tprint_uuid_item(l, btrfs_item_ptr_offset(l, i),\n\t\t\t\t\tbtrfs_item_size_nr(l, i));\n\t\t\tbreak;\n\t\t};\n\t}\n}"
  },
  {
    "function_name": "print_uuid_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "153-170",
    "snippet": "static void print_uuid_item(struct extent_buffer *l, unsigned long offset,\n\t\t\t    u32 item_size)\n{\n\tif (!IS_ALIGNED(item_size, sizeof(u64))) {\n\t\tpr_warn(\"BTRFS: uuid item with illegal size %lu!\\n\",\n\t\t\t(unsigned long)item_size);\n\t\treturn;\n\t}\n\twhile (item_size) {\n\t\t__le64 subvol_id;\n\n\t\tread_extent_buffer(l, &subvol_id, offset, sizeof(subvol_id));\n\t\tprintk(KERN_INFO \"\\t\\tsubvol_id %llu\\n\",\n\t\t       (unsigned long long)le64_to_cpu(subvol_id));\n\t\titem_size -= sizeof(u64);\n\t\toffset += sizeof(u64);\n\t}\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\tsubvol_id %llu\\n\"",
            "(unsigned long long)le64_to_cpu(subvol_id)"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "le64_to_cpu",
          "args": [
            "subvol_id"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "sle64_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ntfs/endian.h",
          "lines": "58-61",
          "snippet": "static inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s64 sle64_to_cpup(sle64 *x)\n{\n\treturn le64_to_cpu(*(__force le64*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_extent_buffer",
          "args": [
            "l",
            "&subvol_id",
            "offset",
            "sizeof(subvol_id)"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "btree_read_extent_buffer_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "442-497",
          "snippet": "static int btree_read_extent_buffer_pages(struct btrfs_root *root,\n\t\t\t\t\t  struct extent_buffer *eb,\n\t\t\t\t\t  u64 start, u64 parent_transid)\n{\n\tstruct extent_io_tree *io_tree;\n\tint failed = 0;\n\tint ret;\n\tint num_copies = 0;\n\tint mirror_num = 0;\n\tint failed_mirror = 0;\n\n\tclear_bit(EXTENT_BUFFER_CORRUPT, &eb->bflags);\n\tio_tree = &BTRFS_I(root->fs_info->btree_inode)->io_tree;\n\twhile (1) {\n\t\tret = read_extent_buffer_pages(io_tree, eb, start,\n\t\t\t\t\t       WAIT_COMPLETE,\n\t\t\t\t\t       btree_get_extent, mirror_num);\n\t\tif (!ret) {\n\t\t\tif (!verify_parent_transid(io_tree, eb,\n\t\t\t\t\t\t   parent_transid, 0))\n\t\t\t\tbreak;\n\t\t\telse\n\t\t\t\tret = -EIO;\n\t\t}\n\n\t\t/*\n\t\t * This buffer's crc is fine, but its contents are corrupted, so\n\t\t * there is no reason to read the other copies, they won't be\n\t\t * any less wrong.\n\t\t */\n\t\tif (test_bit(EXTENT_BUFFER_CORRUPT, &eb->bflags))\n\t\t\tbreak;\n\n\t\tnum_copies = btrfs_num_copies(root->fs_info,\n\t\t\t\t\t      eb->start, eb->len);\n\t\tif (num_copies == 1)\n\t\t\tbreak;\n\n\t\tif (!failed_mirror) {\n\t\t\tfailed = 1;\n\t\t\tfailed_mirror = eb->read_mirror;\n\t\t}\n\n\t\tmirror_num++;\n\t\tif (mirror_num == failed_mirror)\n\t\t\tmirror_num++;\n\n\t\tif (mirror_num > num_copies)\n\t\t\tbreak;\n\t}\n\n\tif (failed && !ret && failed_mirror)\n\t\trepair_eb_io_failure(root, eb, failed_mirror);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_fs_root(struct btrfs_root *root);",
            "static void btrfs_destroy_ordered_extents(struct btrfs_root *root);",
            "static int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);",
            "static void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);",
            "static int btrfs_cleanup_transaction(struct btrfs_root *root);",
            "static void btrfs_error_commit_super(struct btrfs_root *root);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nstatic void free_fs_root(struct btrfs_root *root);\nstatic void btrfs_destroy_ordered_extents(struct btrfs_root *root);\nstatic int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);\nstatic void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);\nstatic int btrfs_cleanup_transaction(struct btrfs_root *root);\nstatic void btrfs_error_commit_super(struct btrfs_root *root);\n\nstatic int btree_read_extent_buffer_pages(struct btrfs_root *root,\n\t\t\t\t\t  struct extent_buffer *eb,\n\t\t\t\t\t  u64 start, u64 parent_transid)\n{\n\tstruct extent_io_tree *io_tree;\n\tint failed = 0;\n\tint ret;\n\tint num_copies = 0;\n\tint mirror_num = 0;\n\tint failed_mirror = 0;\n\n\tclear_bit(EXTENT_BUFFER_CORRUPT, &eb->bflags);\n\tio_tree = &BTRFS_I(root->fs_info->btree_inode)->io_tree;\n\twhile (1) {\n\t\tret = read_extent_buffer_pages(io_tree, eb, start,\n\t\t\t\t\t       WAIT_COMPLETE,\n\t\t\t\t\t       btree_get_extent, mirror_num);\n\t\tif (!ret) {\n\t\t\tif (!verify_parent_transid(io_tree, eb,\n\t\t\t\t\t\t   parent_transid, 0))\n\t\t\t\tbreak;\n\t\t\telse\n\t\t\t\tret = -EIO;\n\t\t}\n\n\t\t/*\n\t\t * This buffer's crc is fine, but its contents are corrupted, so\n\t\t * there is no reason to read the other copies, they won't be\n\t\t * any less wrong.\n\t\t */\n\t\tif (test_bit(EXTENT_BUFFER_CORRUPT, &eb->bflags))\n\t\t\tbreak;\n\n\t\tnum_copies = btrfs_num_copies(root->fs_info,\n\t\t\t\t\t      eb->start, eb->len);\n\t\tif (num_copies == 1)\n\t\t\tbreak;\n\n\t\tif (!failed_mirror) {\n\t\t\tfailed = 1;\n\t\t\tfailed_mirror = eb->read_mirror;\n\t\t}\n\n\t\tmirror_num++;\n\t\tif (mirror_num == failed_mirror)\n\t\t\tmirror_num++;\n\n\t\tif (mirror_num > num_copies)\n\t\t\tbreak;\n\t}\n\n\tif (failed && !ret && failed_mirror)\n\t\trepair_eb_io_failure(root, eb, failed_mirror);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"BTRFS: uuid item with illegal size %lu!\\n\"",
            "(unsigned long)item_size"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "item_size",
            "sizeof(u64)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_uuid_item(struct extent_buffer *l, unsigned long offset,\n\t\t\t    u32 item_size)\n{\n\tif (!IS_ALIGNED(item_size, sizeof(u64))) {\n\t\tpr_warn(\"BTRFS: uuid item with illegal size %lu!\\n\",\n\t\t\t(unsigned long)item_size);\n\t\treturn;\n\t}\n\twhile (item_size) {\n\t\t__le64 subvol_id;\n\n\t\tread_extent_buffer(l, &subvol_id, offset, sizeof(subvol_id));\n\t\tprintk(KERN_INFO \"\\t\\tsubvol_id %llu\\n\",\n\t\t       (unsigned long long)le64_to_cpu(subvol_id));\n\t\titem_size -= sizeof(u64);\n\t\toffset += sizeof(u64);\n\t}\n}"
  },
  {
    "function_name": "print_extent_ref_v0",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "139-150",
    "snippet": "static void print_extent_ref_v0(struct extent_buffer *eb, int slot)\n{\n\tstruct btrfs_extent_ref_v0 *ref0;\n\n\tref0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_ref_v0);\n\tprintk(\"\\t\\textent back ref root %llu gen %llu \"\n\t\t\"owner %llu num_refs %lu\\n\",\n\t\tbtrfs_ref_root_v0(eb, ref0),\n\t\tbtrfs_ref_generation_v0(eb, ref0),\n\t\tbtrfs_ref_objectid_v0(eb, ref0),\n\t\t(unsigned long)btrfs_ref_count_v0(eb, ref0));\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"\\t\\textent back ref root %llu gen %llu \"\n\t\t\"owner %llu num_refs %lu\\n\"",
            "btrfs_ref_root_v0(eb, ref0)",
            "btrfs_ref_generation_v0(eb, ref0)",
            "btrfs_ref_objectid_v0(eb, ref0)",
            "(unsigned long)btrfs_ref_count_v0(eb, ref0)"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_ref_count_v0",
          "args": [
            "eb",
            "ref0"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_ref_objectid_v0",
          "args": [
            "eb",
            "ref0"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_ref_generation_v0",
          "args": [
            "eb",
            "ref0"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_ref_root_v0",
          "args": [
            "eb",
            "ref0"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "eb",
            "slot",
            "structbtrfs_extent_ref_v0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_ref_v0(struct extent_buffer *eb, int slot)\n{\n\tstruct btrfs_extent_ref_v0 *ref0;\n\n\tref0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_ref_v0);\n\tprintk(\"\\t\\textent back ref root %llu gen %llu \"\n\t\t\"owner %llu num_refs %lu\\n\",\n\t\tbtrfs_ref_root_v0(eb, ref0),\n\t\tbtrfs_ref_generation_v0(eb, ref0),\n\t\tbtrfs_ref_objectid_v0(eb, ref0),\n\t\t(unsigned long)btrfs_ref_count_v0(eb, ref0));\n}"
  },
  {
    "function_name": "print_extent_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "57-136",
    "snippet": "static void print_extent_item(struct extent_buffer *eb, int slot, int type)\n{\n\tstruct btrfs_extent_item *ei;\n\tstruct btrfs_extent_inline_ref *iref;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_disk_key key;\n\tunsigned long end;\n\tunsigned long ptr;\n\tu32 item_size = btrfs_item_size_nr(eb, slot);\n\tu64 flags;\n\tu64 offset;\n\n\tif (item_size < sizeof(*ei)) {\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\tstruct btrfs_extent_item_v0 *ei0;\n\t\tBUG_ON(item_size != sizeof(*ei0));\n\t\tei0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_item_v0);\n\t\tprintk(KERN_INFO \"\\t\\textent refs %u\\n\",\n\t\t       btrfs_extent_refs_v0(eb, ei0));\n\t\treturn;\n#else\n\t\tBUG();\n#endif\n\t}\n\n\tei = btrfs_item_ptr(eb, slot, struct btrfs_extent_item);\n\tflags = btrfs_extent_flags(eb, ei);\n\n\tprintk(KERN_INFO \"\\t\\textent refs %llu gen %llu flags %llu\\n\",\n\t       btrfs_extent_refs(eb, ei), btrfs_extent_generation(eb, ei),\n\t       flags);\n\n\tif ((type == BTRFS_EXTENT_ITEM_KEY) &&\n\t    flags & BTRFS_EXTENT_FLAG_TREE_BLOCK) {\n\t\tstruct btrfs_tree_block_info *info;\n\t\tinfo = (struct btrfs_tree_block_info *)(ei + 1);\n\t\tbtrfs_tree_block_key(eb, info, &key);\n\t\tprintk(KERN_INFO \"\\t\\ttree block key (%llu %u %llu) \"\n\t\t       \"level %d\\n\",\n\t\t       btrfs_disk_key_objectid(&key), key.type,\n\t\t       btrfs_disk_key_offset(&key),\n\t\t       btrfs_tree_block_level(eb, info));\n\t\tiref = (struct btrfs_extent_inline_ref *)(info + 1);\n\t} else {\n\t\tiref = (struct btrfs_extent_inline_ref *)(ei + 1);\n\t}\n\n\tptr = (unsigned long)iref;\n\tend = (unsigned long)ei + item_size;\n\twhile (ptr < end) {\n\t\tiref = (struct btrfs_extent_inline_ref *)ptr;\n\t\ttype = btrfs_extent_inline_ref_type(eb, iref);\n\t\toffset = btrfs_extent_inline_ref_offset(eb, iref);\n\t\tswitch (type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref \"\n\t\t\t\t\"root %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref \"\n\t\t\t\t\"parent %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = (struct btrfs_extent_data_ref *)(&iref->offset);\n\t\t\tprint_extent_data_ref(eb, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = (struct btrfs_shared_data_ref *)(iref + 1);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref \"\n\t\t\t       \"parent %llu count %u\\n\",\n\t\t\t       offset, btrfs_shared_data_ref_count(eb, sref));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tptr += btrfs_extent_inline_ref_size(type);\n\t}\n\tWARN_ON(ptr > end);\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ptr > end"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_inline_ref_size",
          "args": [
            "type"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_extent_inline_ref_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2535-2548",
          "snippet": "static inline u32 btrfs_extent_inline_ref_size(int type)\n{\n\tif (type == BTRFS_TREE_BLOCK_REF_KEY ||\n\t    type == BTRFS_SHARED_BLOCK_REF_KEY)\n\t\treturn sizeof(struct btrfs_extent_inline_ref);\n\tif (type == BTRFS_SHARED_DATA_REF_KEY)\n\t\treturn sizeof(struct btrfs_shared_data_ref) +\n\t\t       sizeof(struct btrfs_extent_inline_ref);\n\tif (type == BTRFS_EXTENT_DATA_REF_KEY)\n\t\treturn sizeof(struct btrfs_extent_data_ref) +\n\t\t       offsetof(struct btrfs_extent_inline_ref, offset);\n\tBUG();\n\treturn 0;\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [
            "#define BTRFS_SHARED_DATA_REF_KEY\t184",
            "#define BTRFS_SHARED_BLOCK_REF_KEY\t182",
            "#define BTRFS_EXTENT_DATA_REF_KEY\t178",
            "#define BTRFS_TREE_BLOCK_REF_KEY\t176"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\n#define BTRFS_SHARED_DATA_REF_KEY\t184\n#define BTRFS_SHARED_BLOCK_REF_KEY\t182\n#define BTRFS_EXTENT_DATA_REF_KEY\t178\n#define BTRFS_TREE_BLOCK_REF_KEY\t176\n\nstatic inline u32 btrfs_extent_inline_ref_size(int type)\n{\n\tif (type == BTRFS_TREE_BLOCK_REF_KEY ||\n\t    type == BTRFS_SHARED_BLOCK_REF_KEY)\n\t\treturn sizeof(struct btrfs_extent_inline_ref);\n\tif (type == BTRFS_SHARED_DATA_REF_KEY)\n\t\treturn sizeof(struct btrfs_shared_data_ref) +\n\t\t       sizeof(struct btrfs_extent_inline_ref);\n\tif (type == BTRFS_EXTENT_DATA_REF_KEY)\n\t\treturn sizeof(struct btrfs_extent_data_ref) +\n\t\t       offsetof(struct btrfs_extent_inline_ref, offset);\n\tBUG();\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\tshared data backref \"\n\t\t\t       \"parent %llu count %u\\n\"",
            "offset",
            "btrfs_shared_data_ref_count(eb, sref)"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_shared_data_ref_count",
          "args": [
            "eb",
            "sref"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_extent_data_ref",
          "args": [
            "eb",
            "dref"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "print_extent_data_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
          "lines": "46-55",
          "snippet": "static void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}",
          "includes": [
            "#include \"print-tree.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_extent_inline_ref_offset",
          "args": [
            "eb",
            "iref"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_inline_ref_type",
          "args": [
            "eb",
            "iref"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_tree_block_level",
          "args": [
            "eb",
            "info"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_disk_key_offset",
          "args": [
            "&key"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_disk_key_objectid",
          "args": [
            "&key"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_tree_block_key",
          "args": [
            "eb",
            "info",
            "&key"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_tree_block_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2504-2509",
          "snippet": "static inline void btrfs_tree_block_key(struct extent_buffer *eb,\n\t\t\t\t\tstruct btrfs_tree_block_info *item,\n\t\t\t\t\tstruct btrfs_disk_key *key)\n{\n\tread_eb_member(eb, item, struct btrfs_tree_block_info, key, key);\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline void btrfs_tree_block_key(struct extent_buffer *eb,\n\t\t\t\t\tstruct btrfs_tree_block_info *item,\n\t\t\t\t\tstruct btrfs_disk_key *key)\n{\n\tread_eb_member(eb, item, struct btrfs_tree_block_info, key, key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_extent_generation",
          "args": [
            "eb",
            "ei"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_refs",
          "args": [
            "eb",
            "ei"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_flags",
          "args": [
            "eb",
            "ei"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "eb",
            "slot",
            "structbtrfs_extent_item"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_refs_v0",
          "args": [
            "eb",
            "ei0"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_ptr",
          "args": [
            "eb",
            "slot",
            "structbtrfs_extent_item_v0"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "item_size != sizeof(*ei0)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_item_size_nr",
          "args": [
            "eb",
            "slot"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_item_size_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2649-2652",
          "snippet": "static inline u32 btrfs_item_size_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_size(eb, btrfs_item_nr(nr));\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u32 btrfs_item_size_nr(struct extent_buffer *eb, int nr)\n{\n\treturn btrfs_item_size(eb, btrfs_item_nr(nr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_item(struct extent_buffer *eb, int slot, int type)\n{\n\tstruct btrfs_extent_item *ei;\n\tstruct btrfs_extent_inline_ref *iref;\n\tstruct btrfs_extent_data_ref *dref;\n\tstruct btrfs_shared_data_ref *sref;\n\tstruct btrfs_disk_key key;\n\tunsigned long end;\n\tunsigned long ptr;\n\tu32 item_size = btrfs_item_size_nr(eb, slot);\n\tu64 flags;\n\tu64 offset;\n\n\tif (item_size < sizeof(*ei)) {\n#ifdef BTRFS_COMPAT_EXTENT_TREE_V0\n\t\tstruct btrfs_extent_item_v0 *ei0;\n\t\tBUG_ON(item_size != sizeof(*ei0));\n\t\tei0 = btrfs_item_ptr(eb, slot, struct btrfs_extent_item_v0);\n\t\tprintk(KERN_INFO \"\\t\\textent refs %u\\n\",\n\t\t       btrfs_extent_refs_v0(eb, ei0));\n\t\treturn;\n#else\n\t\tBUG();\n#endif\n\t}\n\n\tei = btrfs_item_ptr(eb, slot, struct btrfs_extent_item);\n\tflags = btrfs_extent_flags(eb, ei);\n\n\tprintk(KERN_INFO \"\\t\\textent refs %llu gen %llu flags %llu\\n\",\n\t       btrfs_extent_refs(eb, ei), btrfs_extent_generation(eb, ei),\n\t       flags);\n\n\tif ((type == BTRFS_EXTENT_ITEM_KEY) &&\n\t    flags & BTRFS_EXTENT_FLAG_TREE_BLOCK) {\n\t\tstruct btrfs_tree_block_info *info;\n\t\tinfo = (struct btrfs_tree_block_info *)(ei + 1);\n\t\tbtrfs_tree_block_key(eb, info, &key);\n\t\tprintk(KERN_INFO \"\\t\\ttree block key (%llu %u %llu) \"\n\t\t       \"level %d\\n\",\n\t\t       btrfs_disk_key_objectid(&key), key.type,\n\t\t       btrfs_disk_key_offset(&key),\n\t\t       btrfs_tree_block_level(eb, info));\n\t\tiref = (struct btrfs_extent_inline_ref *)(info + 1);\n\t} else {\n\t\tiref = (struct btrfs_extent_inline_ref *)(ei + 1);\n\t}\n\n\tptr = (unsigned long)iref;\n\tend = (unsigned long)ei + item_size;\n\twhile (ptr < end) {\n\t\tiref = (struct btrfs_extent_inline_ref *)ptr;\n\t\ttype = btrfs_extent_inline_ref_type(eb, iref);\n\t\toffset = btrfs_extent_inline_ref_offset(eb, iref);\n\t\tswitch (type) {\n\t\tcase BTRFS_TREE_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\ttree block backref \"\n\t\t\t\t\"root %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_BLOCK_REF_KEY:\n\t\t\tprintk(KERN_INFO \"\\t\\tshared block backref \"\n\t\t\t\t\"parent %llu\\n\", offset);\n\t\t\tbreak;\n\t\tcase BTRFS_EXTENT_DATA_REF_KEY:\n\t\t\tdref = (struct btrfs_extent_data_ref *)(&iref->offset);\n\t\t\tprint_extent_data_ref(eb, dref);\n\t\t\tbreak;\n\t\tcase BTRFS_SHARED_DATA_REF_KEY:\n\t\t\tsref = (struct btrfs_shared_data_ref *)(iref + 1);\n\t\t\tprintk(KERN_INFO \"\\t\\tshared data backref \"\n\t\t\t       \"parent %llu count %u\\n\",\n\t\t\t       offset, btrfs_shared_data_ref_count(eb, sref));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tptr += btrfs_extent_inline_ref_size(type);\n\t}\n\tWARN_ON(ptr > end);\n}"
  },
  {
    "function_name": "print_extent_data_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "46-55",
    "snippet": "static void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\"",
            "btrfs_extent_data_ref_root(eb, ref)",
            "btrfs_extent_data_ref_objectid(eb, ref)",
            "btrfs_extent_data_ref_offset(eb, ref)",
            "btrfs_extent_data_ref_count(eb, ref)"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_extent_data_ref_count",
          "args": [
            "eb",
            "ref"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_data_ref_offset",
          "args": [
            "eb",
            "ref"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_data_ref_objectid",
          "args": [
            "eb",
            "ref"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_extent_data_ref_root",
          "args": [
            "eb",
            "ref"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_extent_data_ref(struct extent_buffer *eb,\n\t\t\t\t  struct btrfs_extent_data_ref *ref)\n{\n\tprintk(KERN_INFO \"\\t\\textent data backref root %llu \"\n\t       \"objectid %llu offset %llu count %u\\n\",\n\t       btrfs_extent_data_ref_root(eb, ref),\n\t       btrfs_extent_data_ref_objectid(eb, ref),\n\t       btrfs_extent_data_ref_offset(eb, ref),\n\t       btrfs_extent_data_ref_count(eb, ref));\n}"
  },
  {
    "function_name": "print_dev_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "37-45",
    "snippet": "static void print_dev_item(struct extent_buffer *eb,\n\t\t\t   struct btrfs_dev_item *dev_item)\n{\n\tprintk(KERN_INFO \"\\t\\tdev item devid %llu \"\n\t       \"total_bytes %llu bytes used %llu\\n\",\n\t       btrfs_device_id(eb, dev_item),\n\t       btrfs_device_total_bytes(eb, dev_item),\n\t       btrfs_device_bytes_used(eb, dev_item));\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\tdev item devid %llu \"\n\t       \"total_bytes %llu bytes used %llu\\n\"",
            "btrfs_device_id(eb, dev_item)",
            "btrfs_device_total_bytes(eb, dev_item)",
            "btrfs_device_bytes_used(eb, dev_item)"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_device_bytes_used",
          "args": [
            "eb",
            "dev_item"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_device_total_bytes",
          "args": [
            "eb",
            "dev_item"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_device_id",
          "args": [
            "eb",
            "dev_item"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_dev_item(struct extent_buffer *eb,\n\t\t\t   struct btrfs_dev_item *dev_item)\n{\n\tprintk(KERN_INFO \"\\t\\tdev item devid %llu \"\n\t       \"total_bytes %llu bytes used %llu\\n\",\n\t       btrfs_device_id(eb, dev_item),\n\t       btrfs_device_total_bytes(eb, dev_item),\n\t       btrfs_device_bytes_used(eb, dev_item));\n}"
  },
  {
    "function_name": "print_chunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/print-tree.c",
    "lines": "23-36",
    "snippet": "static void print_chunk(struct extent_buffer *eb, struct btrfs_chunk *chunk)\n{\n\tint num_stripes = btrfs_chunk_num_stripes(eb, chunk);\n\tint i;\n\tprintk(KERN_INFO \"\\t\\tchunk length %llu owner %llu type %llu \"\n\t       \"num_stripes %d\\n\",\n\t       btrfs_chunk_length(eb, chunk), btrfs_chunk_owner(eb, chunk),\n\t       btrfs_chunk_type(eb, chunk), num_stripes);\n\tfor (i = 0 ; i < num_stripes ; i++) {\n\t\tprintk(KERN_INFO \"\\t\\t\\tstripe %d devid %llu offset %llu\\n\", i,\n\t\t      btrfs_stripe_devid_nr(eb, chunk, i),\n\t\t      btrfs_stripe_offset_nr(eb, chunk, i));\n\t}\n}",
    "includes": [
      "#include \"print-tree.h\"",
      "#include \"disk-io.h\"",
      "#include \"ctree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"\\t\\t\\tstripe %d devid %llu offset %llu\\n\"",
            "i",
            "btrfs_stripe_devid_nr(eb, chunk, i)",
            "btrfs_stripe_offset_nr(eb, chunk, i)"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/super.c",
          "lines": "186-213",
          "snippet": "void btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include <trace/events/btrfs.h>",
            "#include \"qgroup.h\"",
            "#include \"tests/btrfs-tests.h\"",
            "#include \"backref.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"compression.h\"",
            "#include \"export.h\"",
            "#include \"volumes.h\"",
            "#include \"xattr.h\"",
            "#include \"props.h\"",
            "#include \"hash.h\"",
            "#include \"print-tree.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include \"delayed-inode.h\"",
            "#include <linux/btrfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/slab.h>",
            "#include <linux/magic.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/namei.h>",
            "#include <linux/ctype.h>",
            "#include <linux/parser.h>",
            "#include <linux/compat.h>",
            "#include <linux/statfs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/mount.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/string.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/time.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/btrfs.h>\n#include \"qgroup.h\"\n#include \"tests/btrfs-tests.h\"\n#include \"backref.h\"\n#include \"free-space-cache.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"compression.h\"\n#include \"export.h\"\n#include \"volumes.h\"\n#include \"xattr.h\"\n#include \"props.h\"\n#include \"hash.h\"\n#include \"print-tree.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include \"delayed-inode.h\"\n#include <linux/btrfs.h>\n#include <linux/ratelimit.h>\n#include <linux/cleancache.h>\n#include <linux/slab.h>\n#include <linux/magic.h>\n#include <linux/miscdevice.h>\n#include <linux/namei.h>\n#include <linux/ctype.h>\n#include <linux/parser.h>\n#include <linux/compat.h>\n#include <linux/statfs.h>\n#include <linux/writeback.h>\n#include <linux/swap.h>\n#include <linux/mpage.h>\n#include <linux/mount.h>\n#include <linux/backing-dev.h>\n#include <linux/string.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/time.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/buffer_head.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n\nvoid btrfs_printk(const struct btrfs_fs_info *fs_info, const char *fmt, ...)\n{\n\tstruct super_block *sb = fs_info->sb;\n\tchar lvl[4];\n\tstruct va_format vaf;\n\tva_list args;\n\tconst char *type = logtypes[4];\n\tint kern_level;\n\n\tva_start(args, fmt);\n\n\tkern_level = printk_get_level(fmt);\n\tif (kern_level) {\n\t\tsize_t size = printk_skip_level(fmt) - fmt;\n\t\tmemcpy(lvl, fmt,  size);\n\t\tlvl[size] = '\\0';\n\t\tfmt += size;\n\t\ttype = logtypes[kern_level - '0'];\n\t} else\n\t\t*lvl = '\\0';\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tprintk(\"%sBTRFS %s (device %s): %pV\\n\", lvl, type, sb->s_id, &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_stripe_offset_nr",
          "args": [
            "eb",
            "chunk",
            "i"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_stripe_offset_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2406-2410",
          "snippet": "static inline u64 btrfs_stripe_offset_nr(struct extent_buffer *eb,\n\t\t\t\t\t struct btrfs_chunk *c, int nr)\n{\n\treturn btrfs_stripe_offset(eb, btrfs_stripe_nr(c, nr));\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u64 btrfs_stripe_offset_nr(struct extent_buffer *eb,\n\t\t\t\t\t struct btrfs_chunk *c, int nr)\n{\n\treturn btrfs_stripe_offset(eb, btrfs_stripe_nr(c, nr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_stripe_devid_nr",
          "args": [
            "eb",
            "chunk",
            "i"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_stripe_devid_nr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ctree.h",
          "lines": "2412-2416",
          "snippet": "static inline u64 btrfs_stripe_devid_nr(struct extent_buffer *eb,\n\t\t\t\t\t struct btrfs_chunk *c, int nr)\n{\n\treturn btrfs_stripe_devid(eb, btrfs_stripe_nr(c, nr));\n}",
          "includes": [
            "#include \"async-thread.h\"",
            "#include \"extent_map.h\"",
            "#include \"extent_io.h\"",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/btrfs.h>",
            "#include <linux/pagemap.h>",
            "#include <asm/kmap_types.h>",
            "#include <trace/events/btrfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/slab.h>",
            "#include <linux/wait.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/completion.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/fs.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"async-thread.h\"\n#include \"extent_map.h\"\n#include \"extent_io.h\"\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/btrfs.h>\n#include <linux/pagemap.h>\n#include <asm/kmap_types.h>\n#include <trace/events/btrfs.h>\n#include <linux/kobject.h>\n#include <linux/slab.h>\n#include <linux/wait.h>\n#include <linux/backing-dev.h>\n#include <linux/completion.h>\n#include <linux/semaphore.h>\n#include <linux/rwsem.h>\n#include <linux/fs.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n\nstatic inline u64 btrfs_stripe_devid_nr(struct extent_buffer *eb,\n\t\t\t\t\t struct btrfs_chunk *c, int nr)\n{\n\treturn btrfs_stripe_devid(eb, btrfs_stripe_nr(c, nr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "btrfs_chunk_type",
          "args": [
            "eb",
            "chunk"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_chunk_owner",
          "args": [
            "eb",
            "chunk"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_chunk_length",
          "args": [
            "eb",
            "chunk"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btrfs_chunk_num_stripes",
          "args": [
            "eb",
            "chunk"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"print-tree.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n\nstatic void print_chunk(struct extent_buffer *eb, struct btrfs_chunk *chunk)\n{\n\tint num_stripes = btrfs_chunk_num_stripes(eb, chunk);\n\tint i;\n\tprintk(KERN_INFO \"\\t\\tchunk length %llu owner %llu type %llu \"\n\t       \"num_stripes %d\\n\",\n\t       btrfs_chunk_length(eb, chunk), btrfs_chunk_owner(eb, chunk),\n\t       btrfs_chunk_type(eb, chunk), num_stripes);\n\tfor (i = 0 ; i < num_stripes ; i++) {\n\t\tprintk(KERN_INFO \"\\t\\t\\tstripe %d devid %llu offset %llu\\n\", i,\n\t\t      btrfs_stripe_devid_nr(eb, chunk, i),\n\t\t      btrfs_stripe_offset_nr(eb, chunk, i));\n\t}\n}"
  }
]