[
  {
    "function_name": "btrfs_set_buffer_lockdep_class",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "154-157",
    "snippet": "static inline void btrfs_set_buffer_lockdep_class(u64 objectid,\n\t\t\t\t\tstruct extent_buffer *eb, int level)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void btrfs_set_buffer_lockdep_class(u64 objectid,\n\t\t\t\t\tstruct extent_buffer *eb, int level)\n{\n}"
  },
  {
    "function_name": "btrfs_init_lockdep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "152-153",
    "snippet": "static inline void btrfs_init_lockdep(void)\n{ }",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void btrfs_init_lockdep(void)\n{ }"
  },
  {
    "function_name": "btrfs_put_fs_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "108-112",
    "snippet": "static inline void btrfs_put_fs_root(struct btrfs_root *root)\n{\n\tif (atomic_dec_and_test(&root->refs))\n\t\tkfree(root);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "root"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&root->refs"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void btrfs_put_fs_root(struct btrfs_root *root)\n{\n\tif (atomic_dec_and_test(&root->refs))\n\t\tkfree(root);\n}"
  },
  {
    "function_name": "btrfs_grab_fs_root",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "101-106",
    "snippet": "static inline struct btrfs_root *btrfs_grab_fs_root(struct btrfs_root *root)\n{\n\tif (atomic_inc_not_zero(&root->refs))\n\t\treturn root;\n\treturn NULL;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc_not_zero",
          "args": [
            "&root->refs"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline struct btrfs_root *btrfs_grab_fs_root(struct btrfs_root *root)\n{\n\tif (atomic_inc_not_zero(&root->refs))\n\t\treturn root;\n\treturn NULL;\n}"
  },
  {
    "function_name": "btrfs_read_fs_root_no_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "76-81",
    "snippet": "static inline struct btrfs_root *\nbtrfs_read_fs_root_no_name(struct btrfs_fs_info *fs_info,\n\t\t\t   struct btrfs_key *location)\n{\n\treturn btrfs_get_fs_root(fs_info, location, true);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btrfs_get_fs_root",
          "args": [
            "fs_info",
            "location",
            "true"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_get_fs_root",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.c",
          "lines": "1626-1700",
          "snippet": "struct btrfs_root *btrfs_get_fs_root(struct btrfs_fs_info *fs_info,\n\t\t\t\t     struct btrfs_key *location,\n\t\t\t\t     bool check_ref)\n{\n\tstruct btrfs_root *root;\n\tstruct btrfs_path *path;\n\tstruct btrfs_key key;\n\tint ret;\n\n\tif (location->objectid == BTRFS_ROOT_TREE_OBJECTID)\n\t\treturn fs_info->tree_root;\n\tif (location->objectid == BTRFS_EXTENT_TREE_OBJECTID)\n\t\treturn fs_info->extent_root;\n\tif (location->objectid == BTRFS_CHUNK_TREE_OBJECTID)\n\t\treturn fs_info->chunk_root;\n\tif (location->objectid == BTRFS_DEV_TREE_OBJECTID)\n\t\treturn fs_info->dev_root;\n\tif (location->objectid == BTRFS_CSUM_TREE_OBJECTID)\n\t\treturn fs_info->csum_root;\n\tif (location->objectid == BTRFS_QUOTA_TREE_OBJECTID)\n\t\treturn fs_info->quota_root ? fs_info->quota_root :\n\t\t\t\t\t     ERR_PTR(-ENOENT);\n\tif (location->objectid == BTRFS_UUID_TREE_OBJECTID)\n\t\treturn fs_info->uuid_root ? fs_info->uuid_root :\n\t\t\t\t\t    ERR_PTR(-ENOENT);\nagain:\n\troot = btrfs_lookup_fs_root(fs_info, location->objectid);\n\tif (root) {\n\t\tif (check_ref && btrfs_root_refs(&root->root_item) == 0)\n\t\t\treturn ERR_PTR(-ENOENT);\n\t\treturn root;\n\t}\n\n\troot = btrfs_read_fs_root(fs_info->tree_root, location);\n\tif (IS_ERR(root))\n\t\treturn root;\n\n\tif (check_ref && btrfs_root_refs(&root->root_item) == 0) {\n\t\tret = -ENOENT;\n\t\tgoto fail;\n\t}\n\n\tret = btrfs_init_fs_root(root);\n\tif (ret)\n\t\tgoto fail;\n\n\tpath = btrfs_alloc_path();\n\tif (!path) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tkey.objectid = BTRFS_ORPHAN_OBJECTID;\n\tkey.type = BTRFS_ORPHAN_ITEM_KEY;\n\tkey.offset = location->objectid;\n\n\tret = btrfs_search_slot(NULL, fs_info->tree_root, &key, path, 0, 0);\n\tbtrfs_free_path(path);\n\tif (ret < 0)\n\t\tgoto fail;\n\tif (ret == 0)\n\t\tset_bit(BTRFS_ROOT_ORPHAN_ITEM_INSERTED, &root->state);\n\n\tret = btrfs_insert_fs_root(fs_info, root);\n\tif (ret) {\n\t\tif (ret == -EEXIST) {\n\t\t\tfree_fs_root(root);\n\t\t\tgoto again;\n\t\t}\n\t\tgoto fail;\n\t}\n\treturn root;\nfail:\n\tfree_fs_root(root);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include <asm/cpufeature.h>",
            "#include \"qgroup.h\"",
            "#include \"sysfs.h\"",
            "#include \"raid56.h\"",
            "#include \"dev-replace.h\"",
            "#include \"rcu-string.h\"",
            "#include \"check-integrity.h\"",
            "#include \"inode-map.h\"",
            "#include \"free-space-cache.h\"",
            "#include \"tree-log.h\"",
            "#include \"locking.h\"",
            "#include \"print-tree.h\"",
            "#include \"volumes.h\"",
            "#include \"btrfs_inode.h\"",
            "#include \"transaction.h\"",
            "#include \"hash.h\"",
            "#include \"disk-io.h\"",
            "#include \"ctree.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/uuid.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/migrate.h>",
            "#include <linux/slab.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/swap.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_fs_root(struct btrfs_root *root);",
            "static void btrfs_destroy_ordered_extents(struct btrfs_root *root);",
            "static int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);",
            "static void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);",
            "static int btrfs_cleanup_transaction(struct btrfs_root *root);",
            "static void btrfs_error_commit_super(struct btrfs_root *root);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/cpufeature.h>\n#include \"qgroup.h\"\n#include \"sysfs.h\"\n#include \"raid56.h\"\n#include \"dev-replace.h\"\n#include \"rcu-string.h\"\n#include \"check-integrity.h\"\n#include \"inode-map.h\"\n#include \"free-space-cache.h\"\n#include \"tree-log.h\"\n#include \"locking.h\"\n#include \"print-tree.h\"\n#include \"volumes.h\"\n#include \"btrfs_inode.h\"\n#include \"transaction.h\"\n#include \"hash.h\"\n#include \"disk-io.h\"\n#include \"ctree.h\"\n#include <asm/unaligned.h>\n#include <linux/semaphore.h>\n#include <linux/uuid.h>\n#include <linux/ratelimit.h>\n#include <linux/migrate.h>\n#include <linux/slab.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/workqueue.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/radix-tree.h>\n#include <linux/swap.h>\n#include <linux/scatterlist.h>\n#include <linux/blkdev.h>\n#include <linux/fs.h>\n\nstatic void free_fs_root(struct btrfs_root *root);\nstatic void btrfs_destroy_ordered_extents(struct btrfs_root *root);\nstatic int btrfs_destroy_delayed_refs(struct btrfs_transaction *trans,\n\t\t\t\t      struct btrfs_root *root);\nstatic void btrfs_destroy_delalloc_inodes(struct btrfs_root *root);\nstatic int btrfs_cleanup_transaction(struct btrfs_root *root);\nstatic void btrfs_error_commit_super(struct btrfs_root *root);\n\nstruct btrfs_root *btrfs_get_fs_root(struct btrfs_fs_info *fs_info,\n\t\t\t\t     struct btrfs_key *location,\n\t\t\t\t     bool check_ref)\n{\n\tstruct btrfs_root *root;\n\tstruct btrfs_path *path;\n\tstruct btrfs_key key;\n\tint ret;\n\n\tif (location->objectid == BTRFS_ROOT_TREE_OBJECTID)\n\t\treturn fs_info->tree_root;\n\tif (location->objectid == BTRFS_EXTENT_TREE_OBJECTID)\n\t\treturn fs_info->extent_root;\n\tif (location->objectid == BTRFS_CHUNK_TREE_OBJECTID)\n\t\treturn fs_info->chunk_root;\n\tif (location->objectid == BTRFS_DEV_TREE_OBJECTID)\n\t\treturn fs_info->dev_root;\n\tif (location->objectid == BTRFS_CSUM_TREE_OBJECTID)\n\t\treturn fs_info->csum_root;\n\tif (location->objectid == BTRFS_QUOTA_TREE_OBJECTID)\n\t\treturn fs_info->quota_root ? fs_info->quota_root :\n\t\t\t\t\t     ERR_PTR(-ENOENT);\n\tif (location->objectid == BTRFS_UUID_TREE_OBJECTID)\n\t\treturn fs_info->uuid_root ? fs_info->uuid_root :\n\t\t\t\t\t    ERR_PTR(-ENOENT);\nagain:\n\troot = btrfs_lookup_fs_root(fs_info, location->objectid);\n\tif (root) {\n\t\tif (check_ref && btrfs_root_refs(&root->root_item) == 0)\n\t\t\treturn ERR_PTR(-ENOENT);\n\t\treturn root;\n\t}\n\n\troot = btrfs_read_fs_root(fs_info->tree_root, location);\n\tif (IS_ERR(root))\n\t\treturn root;\n\n\tif (check_ref && btrfs_root_refs(&root->root_item) == 0) {\n\t\tret = -ENOENT;\n\t\tgoto fail;\n\t}\n\n\tret = btrfs_init_fs_root(root);\n\tif (ret)\n\t\tgoto fail;\n\n\tpath = btrfs_alloc_path();\n\tif (!path) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tkey.objectid = BTRFS_ORPHAN_OBJECTID;\n\tkey.type = BTRFS_ORPHAN_ITEM_KEY;\n\tkey.offset = location->objectid;\n\n\tret = btrfs_search_slot(NULL, fs_info->tree_root, &key, path, 0, 0);\n\tbtrfs_free_path(path);\n\tif (ret < 0)\n\t\tgoto fail;\n\tif (ret == 0)\n\t\tset_bit(BTRFS_ROOT_ORPHAN_ITEM_INSERTED, &root->state);\n\n\tret = btrfs_insert_fs_root(fs_info, root);\n\tif (ret) {\n\t\tif (ret == -EEXIST) {\n\t\t\tfree_fs_root(root);\n\t\t\tgoto again;\n\t\t}\n\t\tgoto fail;\n\t}\n\treturn root;\nfail:\n\tfree_fs_root(root);\n\treturn ERR_PTR(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline struct btrfs_root *\nbtrfs_read_fs_root_no_name(struct btrfs_fs_info *fs_info,\n\t\t\t   struct btrfs_key *location)\n{\n\treturn btrfs_get_fs_root(fs_info, location, true);\n}"
  },
  {
    "function_name": "btrfs_sb_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/disk-io.h",
    "lines": "36-42",
    "snippet": "static inline u64 btrfs_sb_offset(int mirror)\n{\n\tu64 start = 16 * 1024;\n\tif (mirror)\n\t\treturn start << (BTRFS_SUPER_MIRROR_SHIFT * mirror);\n\treturn BTRFS_SUPER_INFO_OFFSET;\n}",
    "includes": [],
    "macros_used": [
      "#define BTRFS_SUPER_MIRROR_SHIFT 12",
      "#define BTRFS_SUPER_INFO_OFFSET (64 * 1024)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define BTRFS_SUPER_MIRROR_SHIFT 12\n#define BTRFS_SUPER_INFO_OFFSET (64 * 1024)\n\nstatic inline u64 btrfs_sb_offset(int mirror)\n{\n\tu64 start = 16 * 1024;\n\tif (mirror)\n\t\treturn start << (BTRFS_SUPER_MIRROR_SHIFT * mirror);\n\treturn BTRFS_SUPER_INFO_OFFSET;\n}"
  }
]