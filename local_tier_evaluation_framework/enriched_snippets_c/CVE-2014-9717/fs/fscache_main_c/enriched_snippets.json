[
  {
    "function_name": "fscache_wait_atomic_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/main.c",
    "lines": "202-206",
    "snippet": "int fscache_wait_atomic_t(atomic_t *p)\n{\n\tschedule();\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/completion.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/completion.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nint fscache_wait_atomic_t(atomic_t *p)\n{\n\tschedule();\n\treturn 0;\n}"
  },
  {
    "function_name": "fscache_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/main.c",
    "lines": "182-195",
    "snippet": "static void __exit fscache_exit(void)\n{\n\t_enter(\"\");\n\n\tkobject_put(fscache_root);\n\tkmem_cache_destroy(fscache_cookie_jar);\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(fscache_sysctl_header);\n#endif\n\tfscache_proc_cleanup();\n\tdestroy_workqueue(fscache_op_wq);\n\tdestroy_workqueue(fscache_object_wq);\n\tpr_notice(\"Unloaded\\n\");\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/completion.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kobject *fscache_root;",
      "struct workqueue_struct *fscache_object_wq;",
      "struct workqueue_struct *fscache_op_wq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_notice",
          "args": [
            "\"Unloaded\\n\""
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "fscache_object_wq"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fscache_proc_cleanup",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "fscache_proc_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/proc.c",
          "lines": "69-81",
          "snippet": "void fscache_proc_cleanup(void)\n{\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tremove_proc_entry(\"fs/fscache/objects\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n\nvoid fscache_proc_cleanup(void)\n{\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tremove_proc_entry(\"fs/fscache/objects\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_sysctl_table",
          "args": [
            "fscache_sysctl_header"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "fscache_cookie_jar"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "fscache_root"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_enter",
          "args": [
            "\"\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/completion.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct kobject *fscache_root;\nstruct workqueue_struct *fscache_object_wq;\nstruct workqueue_struct *fscache_op_wq;\n\nstatic void __exit fscache_exit(void)\n{\n\t_enter(\"\");\n\n\tkobject_put(fscache_root);\n\tkmem_cache_destroy(fscache_cookie_jar);\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(fscache_sysctl_header);\n#endif\n\tfscache_proc_cleanup();\n\tdestroy_workqueue(fscache_op_wq);\n\tdestroy_workqueue(fscache_object_wq);\n\tpr_notice(\"Unloaded\\n\");\n}"
  },
  {
    "function_name": "fscache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/main.c",
    "lines": "103-175",
    "snippet": "static int __init fscache_init(void)\n{\n\tunsigned int nr_cpus = num_possible_cpus();\n\tunsigned int cpu;\n\tint ret;\n\n\tfscache_object_max_active =\n\t\tclamp_val(nr_cpus,\n\t\t\t  fscache_object_max_active, WQ_UNBOUND_MAX_ACTIVE);\n\n\tret = -ENOMEM;\n\tfscache_object_wq = alloc_workqueue(\"fscache_object\", WQ_UNBOUND,\n\t\t\t\t\t    fscache_object_max_active);\n\tif (!fscache_object_wq)\n\t\tgoto error_object_wq;\n\n\tfscache_op_max_active =\n\t\tclamp_val(fscache_object_max_active / 2,\n\t\t\t  fscache_op_max_active, WQ_UNBOUND_MAX_ACTIVE);\n\n\tret = -ENOMEM;\n\tfscache_op_wq = alloc_workqueue(\"fscache_operation\", WQ_UNBOUND,\n\t\t\t\t\tfscache_op_max_active);\n\tif (!fscache_op_wq)\n\t\tgoto error_op_wq;\n\n\tfor_each_possible_cpu(cpu)\n\t\tinit_waitqueue_head(&per_cpu(fscache_object_cong_wait, cpu));\n\n\tret = fscache_proc_init();\n\tif (ret < 0)\n\t\tgoto error_proc;\n\n#ifdef CONFIG_SYSCTL\n\tret = -ENOMEM;\n\tfscache_sysctl_header = register_sysctl_table(fscache_sysctls_root);\n\tif (!fscache_sysctl_header)\n\t\tgoto error_sysctl;\n#endif\n\n\tfscache_cookie_jar = kmem_cache_create(\"fscache_cookie_jar\",\n\t\t\t\t\t       sizeof(struct fscache_cookie),\n\t\t\t\t\t       0,\n\t\t\t\t\t       0,\n\t\t\t\t\t       fscache_cookie_init_once);\n\tif (!fscache_cookie_jar) {\n\t\tpr_notice(\"Failed to allocate a cookie jar\\n\");\n\t\tret = -ENOMEM;\n\t\tgoto error_cookie_jar;\n\t}\n\n\tfscache_root = kobject_create_and_add(\"fscache\", kernel_kobj);\n\tif (!fscache_root)\n\t\tgoto error_kobj;\n\n\tpr_notice(\"Loaded\\n\");\n\treturn 0;\n\nerror_kobj:\n\tkmem_cache_destroy(fscache_cookie_jar);\nerror_cookie_jar:\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(fscache_sysctl_header);\nerror_sysctl:\n#endif\n\tfscache_proc_cleanup();\nerror_proc:\n\tdestroy_workqueue(fscache_op_wq);\nerror_op_wq:\n\tdestroy_workqueue(fscache_object_wq);\nerror_object_wq:\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/completion.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kobject *fscache_root;",
      "struct workqueue_struct *fscache_object_wq;",
      "struct workqueue_struct *fscache_op_wq;",
      "static unsigned fscache_object_max_active = 4;",
      "static unsigned fscache_op_max_active = 2;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_workqueue",
          "args": [
            "fscache_object_wq"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "btrfs_destroy_workqueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/async-thread.c",
          "lines": "343-351",
          "snippet": "void btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"async-thread.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kthread.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"async-thread.h\"\n#include <linux/freezer.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kthread.h>\n\nstatic inline void\n__btrfs_destroy_workqueue(struct __btrfs_workqueue *wq);\n\nvoid btrfs_destroy_workqueue(struct btrfs_workqueue *wq)\n{\n\tif (!wq)\n\t\treturn;\n\tif (wq->high)\n\t\t__btrfs_destroy_workqueue(wq->high);\n\t__btrfs_destroy_workqueue(wq->normal);\n\tkfree(wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fscache_proc_cleanup",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "fscache_proc_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/proc.c",
          "lines": "69-81",
          "snippet": "void fscache_proc_cleanup(void)\n{\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tremove_proc_entry(\"fs/fscache/objects\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n\nvoid fscache_proc_cleanup(void)\n{\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tremove_proc_entry(\"fs/fscache/objects\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "fscache_cookie_jar"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_notice",
          "args": [
            "\"Loaded\\n\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"fscache\"",
            "kernel_kobj"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_notice",
          "args": [
            "\"Failed to allocate a cookie jar\\n\""
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"fscache_cookie_jar\"",
            "sizeof(struct fscache_cookie)",
            "0",
            "0",
            "fscache_cookie_init_once"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "fscache_sysctls_root"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fscache_proc_init",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "fscache_proc_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/proc.c",
          "lines": "21-64",
          "snippet": "int __init fscache_proc_init(void)\n{\n\t_enter(\"\");\n\n\tif (!proc_mkdir(\"fs/fscache\", NULL))\n\t\tgoto error_dir;\n\n#ifdef CONFIG_FSCACHE_STATS\n\tif (!proc_create(\"fs/fscache/stats\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_stats_fops))\n\t\tgoto error_stats;\n#endif\n\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tif (!proc_create(\"fs/fscache/histogram\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_histogram_fops))\n\t\tgoto error_histogram;\n#endif\n\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tif (!proc_create(\"fs/fscache/objects\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_objlist_fops))\n\t\tgoto error_objects;\n#endif\n\n\t_leave(\" = 0\");\n\treturn 0;\n\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\nerror_objects:\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\nerror_histogram:\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\nerror_stats:\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\nerror_dir:\n\t_leave(\" = -ENOMEM\");\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n\nint __init fscache_proc_init(void)\n{\n\t_enter(\"\");\n\n\tif (!proc_mkdir(\"fs/fscache\", NULL))\n\t\tgoto error_dir;\n\n#ifdef CONFIG_FSCACHE_STATS\n\tif (!proc_create(\"fs/fscache/stats\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_stats_fops))\n\t\tgoto error_stats;\n#endif\n\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tif (!proc_create(\"fs/fscache/histogram\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_histogram_fops))\n\t\tgoto error_histogram;\n#endif\n\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\n\tif (!proc_create(\"fs/fscache/objects\", S_IFREG | 0444, NULL,\n\t\t\t &fscache_objlist_fops))\n\t\tgoto error_objects;\n#endif\n\n\t_leave(\" = 0\");\n\treturn 0;\n\n#ifdef CONFIG_FSCACHE_OBJECT_LIST\nerror_objects:\n#endif\n#ifdef CONFIG_FSCACHE_HISTOGRAM\n\tremove_proc_entry(\"fs/fscache/histogram\", NULL);\nerror_histogram:\n#endif\n#ifdef CONFIG_FSCACHE_STATS\n\tremove_proc_entry(\"fs/fscache/stats\", NULL);\nerror_stats:\n#endif\n\tremove_proc_entry(\"fs/fscache\", NULL);\nerror_dir:\n\t_leave(\" = -ENOMEM\");\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"fscache_operation\"",
            "WQ_UNBOUND",
            "fscache_op_max_active"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clamp_val",
          "args": [
            "fscache_object_max_active / 2",
            "fscache_op_max_active",
            "WQ_UNBOUND_MAX_ACTIVE"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"fscache_object\"",
            "WQ_UNBOUND",
            "fscache_object_max_active"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clamp_val",
          "args": [
            "nr_cpus",
            "fscache_object_max_active",
            "WQ_UNBOUND_MAX_ACTIVE"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "num_possible_cpus",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/completion.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstruct kobject *fscache_root;\nstruct workqueue_struct *fscache_object_wq;\nstruct workqueue_struct *fscache_op_wq;\nstatic unsigned fscache_object_max_active = 4;\nstatic unsigned fscache_op_max_active = 2;\n\nstatic int __init fscache_init(void)\n{\n\tunsigned int nr_cpus = num_possible_cpus();\n\tunsigned int cpu;\n\tint ret;\n\n\tfscache_object_max_active =\n\t\tclamp_val(nr_cpus,\n\t\t\t  fscache_object_max_active, WQ_UNBOUND_MAX_ACTIVE);\n\n\tret = -ENOMEM;\n\tfscache_object_wq = alloc_workqueue(\"fscache_object\", WQ_UNBOUND,\n\t\t\t\t\t    fscache_object_max_active);\n\tif (!fscache_object_wq)\n\t\tgoto error_object_wq;\n\n\tfscache_op_max_active =\n\t\tclamp_val(fscache_object_max_active / 2,\n\t\t\t  fscache_op_max_active, WQ_UNBOUND_MAX_ACTIVE);\n\n\tret = -ENOMEM;\n\tfscache_op_wq = alloc_workqueue(\"fscache_operation\", WQ_UNBOUND,\n\t\t\t\t\tfscache_op_max_active);\n\tif (!fscache_op_wq)\n\t\tgoto error_op_wq;\n\n\tfor_each_possible_cpu(cpu)\n\t\tinit_waitqueue_head(&per_cpu(fscache_object_cong_wait, cpu));\n\n\tret = fscache_proc_init();\n\tif (ret < 0)\n\t\tgoto error_proc;\n\n#ifdef CONFIG_SYSCTL\n\tret = -ENOMEM;\n\tfscache_sysctl_header = register_sysctl_table(fscache_sysctls_root);\n\tif (!fscache_sysctl_header)\n\t\tgoto error_sysctl;\n#endif\n\n\tfscache_cookie_jar = kmem_cache_create(\"fscache_cookie_jar\",\n\t\t\t\t\t       sizeof(struct fscache_cookie),\n\t\t\t\t\t       0,\n\t\t\t\t\t       0,\n\t\t\t\t\t       fscache_cookie_init_once);\n\tif (!fscache_cookie_jar) {\n\t\tpr_notice(\"Failed to allocate a cookie jar\\n\");\n\t\tret = -ENOMEM;\n\t\tgoto error_cookie_jar;\n\t}\n\n\tfscache_root = kobject_create_and_add(\"fscache\", kernel_kobj);\n\tif (!fscache_root)\n\t\tgoto error_kobj;\n\n\tpr_notice(\"Loaded\\n\");\n\treturn 0;\n\nerror_kobj:\n\tkmem_cache_destroy(fscache_cookie_jar);\nerror_cookie_jar:\n#ifdef CONFIG_SYSCTL\n\tunregister_sysctl_table(fscache_sysctl_header);\nerror_sysctl:\n#endif\n\tfscache_proc_cleanup();\nerror_proc:\n\tdestroy_workqueue(fscache_op_wq);\nerror_op_wq:\n\tdestroy_workqueue(fscache_object_wq);\nerror_object_wq:\n\treturn ret;\n}"
  },
  {
    "function_name": "fscache_max_active_sysctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fscache/main.c",
    "lines": "56-68",
    "snippet": "static int fscache_max_active_sysctl(struct ctl_table *table, int write,\n\t\t\t\t     void __user *buffer,\n\t\t\t\t     size_t *lenp, loff_t *ppos)\n{\n\tstruct workqueue_struct **wqp = table->extra1;\n\tunsigned int *datap = table->data;\n\tint ret;\n\n\tret = proc_dointvec(table, write, buffer, lenp, ppos);\n\tif (ret == 0)\n\t\tworkqueue_set_max_active(*wqp, *datap);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/completion.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "workqueue_set_max_active",
          "args": [
            "*wqp",
            "*datap"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_dointvec",
          "args": [
            "table",
            "write",
            "buffer",
            "lenp",
            "ppos"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/completion.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n#include <linux/module.h>\n\nstatic int fscache_max_active_sysctl(struct ctl_table *table, int write,\n\t\t\t\t     void __user *buffer,\n\t\t\t\t     size_t *lenp, loff_t *ppos)\n{\n\tstruct workqueue_struct **wqp = table->extra1;\n\tunsigned int *datap = table->data;\n\tint ret;\n\n\tret = proc_dointvec(table, write, buffer, lenp, ppos);\n\tif (ret == 0)\n\t\tworkqueue_set_max_active(*wqp, *datap);\n\treturn ret;\n}"
  }
]