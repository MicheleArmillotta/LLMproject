[
  {
    "function_name": "ext2_init_acl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext2/acl.h",
    "lines": "66-69",
    "snippet": "static inline int ext2_init_acl (struct inode *inode, struct inode *dir)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/posix_acl_xattr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/posix_acl_xattr.h>\n\nstatic inline int ext2_init_acl (struct inode *inode, struct inode *dir)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "ext2_acl_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext2/acl.h",
    "lines": "38-52",
    "snippet": "static inline int ext2_acl_count(size_t size)\n{\n\tssize_t s;\n\tsize -= sizeof(ext2_acl_header);\n\ts = size - 4 * sizeof(ext2_acl_entry_short);\n\tif (s < 0) {\n\t\tif (size % sizeof(ext2_acl_entry_short))\n\t\t\treturn -1;\n\t\treturn size / sizeof(ext2_acl_entry_short);\n\t} else {\n\t\tif (s % sizeof(ext2_acl_entry))\n\t\t\treturn -1;\n\t\treturn s / sizeof(ext2_acl_entry) + 4;\n\t}\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/posix_acl_xattr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/posix_acl_xattr.h>\n\nstatic inline int ext2_acl_count(size_t size)\n{\n\tssize_t s;\n\tsize -= sizeof(ext2_acl_header);\n\ts = size - 4 * sizeof(ext2_acl_entry_short);\n\tif (s < 0) {\n\t\tif (size % sizeof(ext2_acl_entry_short))\n\t\t\treturn -1;\n\t\treturn size / sizeof(ext2_acl_entry_short);\n\t} else {\n\t\tif (s % sizeof(ext2_acl_entry))\n\t\t\treturn -1;\n\t\treturn s / sizeof(ext2_acl_entry) + 4;\n\t}\n}"
  },
  {
    "function_name": "ext2_acl_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext2/acl.h",
    "lines": "26-36",
    "snippet": "static inline size_t ext2_acl_size(int count)\n{\n\tif (count <= 4) {\n\t\treturn sizeof(ext2_acl_header) +\n\t\t       count * sizeof(ext2_acl_entry_short);\n\t} else {\n\t\treturn sizeof(ext2_acl_header) +\n\t\t       4 * sizeof(ext2_acl_entry_short) +\n\t\t       (count - 4) * sizeof(ext2_acl_entry);\n\t}\n}",
    "includes": [
      "#include <linux/sched.h>",
      "#include <linux/posix_acl_xattr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/sched.h>\n#include <linux/posix_acl_xattr.h>\n\nstatic inline size_t ext2_acl_size(int count)\n{\n\tif (count <= 4) {\n\t\treturn sizeof(ext2_acl_header) +\n\t\t       count * sizeof(ext2_acl_entry_short);\n\t} else {\n\t\treturn sizeof(ext2_acl_header) +\n\t\t       4 * sizeof(ext2_acl_entry_short) +\n\t\t       (count - 4) * sizeof(ext2_acl_entry);\n\t}\n}"
  }
]