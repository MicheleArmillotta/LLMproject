[
  {
    "function_name": "g_lnum(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "294-301",
    "snippet": "int ubifs_next_log_lnum(const struct ubifs_info *c, int lnum)\n{\n\tlnum += 1;\n\tif (lnum > c->log_last)\n\t\tlnum = UBIFS_LOG_LNUM;\n\n\treturn lnum;\n}\n\n#endif /* _",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "int ubifs_next_log_lnum(const struct ubifs_info *c, int lnum)\n{\n\tlnum += 1;\n\tif (lnum > c->log_last)\n\t\tlnum = UBIFS_LOG_LNUM;\n\n\treturn lnum;\n}\n\n#endif /* _"
  },
  {
    "function_name": "_lprops(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "278-284",
    "snippet": "void ubifs_release_lprops(struct ubifs_info *c)\n{\n\tubifs_assert(mutex_is_locked(&c->lp_mutex));\n\tubifs_assert(c->lst.empty_lebs >= 0 &&\n\t\t     c->lst.empty_lebs <= c->main_lebs);\n\tmutex_unlock(&c->lp_mutex);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "&c->lp_mutex",
          "args": [
            ";\n}\n\n/**\n *"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->lst.empty",
          "args": [
            "lebs >= 0 &&\n\t\t     c->lst.empty_lebs <= c->main_lebs);\n\tmutex_unl"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_is_loc",
          "args": [
            "ed(&c->lp_mutex));\n\tubifs_ass"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ed(&c->lp_mutex",
          "args": [
            ");\n\tubifs_as"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "void ubifs_release_lprops(struct ubifs_info *c)\n{\n\tubifs_assert(mutex_is_locked(&c->lp_mutex));\n\tubifs_assert(c->lst.empty_lebs >= 0 &&\n\t\t     c->lst.empty_lebs <= c->main_lebs);\n\tmutex_unlock(&c->lp_mutex);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "ops(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "266-269",
    "snippet": "void ubifs_get_lprops(struct ubifs_info *c)\n{\n\tmutex_lock(&c->lp_mutex);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->lp_mutex",
          "args": [
            ";\n}\n\n/**\n *"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "void ubifs_get_lprops(struct ubifs_info *c)\n{\n\tmutex_lock(&c->lp_mutex);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "kup(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "253-257",
    "snippet": "int ubifs_tnc_lookup(struct ubifs_info *c,\n\t\t\t\t   const union ubifs_key *key, void *node)\n{\n\treturn ubifs_tnc_locate(c, key, node, NULL, NULL);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ate(c, key, node",
          "args": [
            "LL,",
            "ULL)",
            "}\n\n/",
            "*"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_tnc_lookup(struct ubifs_info *c,\n\t\t\t\t   const union ubifs_key *key, void *node)\n{\n\treturn ubifs_tnc_locate(c, key, node, NULL, NULL);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "_time(struct inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "236-240",
    "snippet": "struct timespec ubifs_current_time(struct inode *inode)\n{\n\treturn (inode->i_sb->s_time_gran < NSEC_PER_SEC) ?\n\t\tcurrent_fs_time(inode->i_sb) : CURRENT_TIME_SEC;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "me(inode->i_sb)",
          "args": [
            ": CURRENT_T"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "struct timespec ubifs_current_time(struct inode *inode)\n{\n\treturn (inode->i_sb->s_time_gran < NSEC_PER_SEC) ?\n\t\tcurrent_fs_time(inode->i_sb) : CURRENT_TIME_SEC;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "226-230",
    "snippet": "void *ubifs_idx_key(const struct ubifs_info *c,\n\t\t\t\t  const struct ubifs_idx_node *idx)\n{\n\treturn (void *)((struct ubifs_branch *)idx->branches)->key;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "void *ubifs_idx_key(const struct ubifs_info *c,\n\t\t\t\t  const struct ubifs_idx_node *idx)\n{\n\treturn (void *)((struct ubifs_branch *)idx->branches)->key;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "nch(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "212-219",
    "snippet": "struct ubifs_branch *ubifs_idx_branch(const struct ubifs_info *c,\n\t\t\t\t      const struct ubifs_idx_node *idx,\n\t\t\t\t      int bnum)\n{\n\treturn (struct ubifs_branch *)((void *)idx->branches +\n\t\t\t\t       (UBIFS_BRANCH_SZ + c->key_len) * bnum);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "struct ubifs_branch *ubifs_idx_branch(const struct ubifs_info *c,\n\t\t\t\t      const struct ubifs_idx_node *idx,\n\t\t\t\t      int bnum)\n{\n\treturn (struct ubifs_branch *)((void *)idx->branches +\n\t\t\t\t       (UBIFS_BRANCH_SZ + c->key_len) * bnum);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "e_sz(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "201-204",
    "snippet": "int ubifs_idx_node_sz(const struct ubifs_info *c, int child_cnt)\n{\n\treturn UBIFS_IDX_NODE_SZ + (UBIFS_BRANCH_SZ + c->key_len) * child_cnt;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "int ubifs_idx_node_sz(const struct ubifs_info *c, int child_cnt)\n{\n\treturn UBIFS_IDX_NODE_SZ + (UBIFS_BRANCH_SZ + c->key_len) * child_cnt;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "leb(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "190-194",
    "snippet": "int ubifs_return_leb(struct ubifs_info *c, int lnum)\n{\n\treturn ubifs_change_one_lp(c, lnum, LPROPS_NC, LPROPS_NC, 0,\n\t\t\t\t   LPROPS_TAKEN, 0);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "one_lp(c, lnum, LPR",
          "args": [
            "P",
            "NC,",
            "ROPS_NC,",
            "L",
            "O",
            "0);\n}\n\n/**"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_return_leb(struct ubifs_info *c, int lnum)\n{\n\treturn ubifs_change_one_lp(c, lnum, LPROPS_NC, LPROPS_NC, 0,\n\t\t\t\t   LPROPS_TAKEN, 0);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "t(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "176-179",
    "snippet": "int ubifs_add_dirt(struct ubifs_info *c, int lnum, int dirty)\n{\n\treturn ubifs_update_one_lp(c, lnum, LPROPS_NC, dirty, 0, 0);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "one_lp(c, lnum, LPR",
          "args": [
            "P",
            "NC,",
            "rty, 0, 0",
            "}\n\n/"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_add_dirt(struct ubifs_info *c, int lnum, int dirty)\n{\n\treturn ubifs_update_one_lp(c, lnum, LPROPS_NC, dirty, 0, 0);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "dev(union ubifs_",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "156-165",
    "snippet": "int ubifs_encode_dev(union ubifs_dev_desc *dev, dev_t rdev)\n{\n\tif (new_valid_dev(rdev)) {\n\t\tdev->new = cpu_to_le32(new_encode_dev(rdev));\n\t\treturn sizeof(dev->new);\n\t} else {\n\t\tdev->huge = cpu_to_le64(huge_encode_dev(rdev));\n\t\treturn sizeof(dev->huge);\n\t}\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uge_encode_",
          "args": [
            "ev(rdev));\n\t\treturn s"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ev(rdev));\n\t\tre",
          "args": [
            "urn"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ew_encode_d",
          "args": [
            "v(rdev));\n\t\treturn s"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v(rdev));\n\t\tre",
          "args": [
            "urn"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(rdev)) {\n\t\td",
          "args": [
            "v->n"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_encode_dev(union ubifs_dev_desc *dev, dev_t rdev)\n{\n\tif (new_valid_dev(rdev)) {\n\t\tdev->new = cpu_to_le32(new_encode_dev(rdev));\n\t\treturn sizeof(dev->new);\n\t} else {\n\t\tdev->huge = cpu_to_le64(huge_encode_dev(rdev));\n\t\treturn sizeof(dev->huge);\n\t}\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "nc(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "137-145",
    "snippet": "int ubifs_wbuf_sync(struct ubifs_wbuf *wbuf)\n{\n\tint err;\n\n\tmutex_lock_nested(&wbuf->io_mutex, wbuf->jhead);\n\terr = ubifs_wbuf_sync_nolock(wbuf);\n\tmutex_unlock(&wbuf->io_mutex);\n\treturn err;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "&wbuf->io_mu",
          "args": [
            "ex);\n\treturn er"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nc_nolock(wbuf);\n\tmute",
          "args": [
            "_unl"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sted(&wbuf->io_mu",
          "args": [
            "ex, wbuf->jhead",
            "err = ubi"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_wbuf_sync(struct ubifs_wbuf *wbuf)\n{\n\tint err;\n\n\tmutex_lock_nested(&wbuf->io_mutex, wbuf->jhead);\n\terr = ubifs_wbuf_sync_nolock(wbuf);\n\tmutex_unlock(&wbuf->io_mutex);\n\treturn err;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "ame(int compr_ty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "124-128",
    "snippet": "const char *ubifs_compr_name(int compr_type)\n{\n\tubifs_assert(compr_type >= 0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn ubifs_compressors[compr_type]->name;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compr_type >",
          "args": [
            "0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn ub"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "const char *ubifs_compr_name(int compr_type)\n{\n\tubifs_assert(compr_type >= 0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn ubifs_compressors[compr_type]->name;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "resent(int compr_ty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "112-116",
    "snippet": "int ubifs_compr_present(int compr_type)\n{\n\tubifs_assert(compr_type >= 0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn !!ubifs_compressors[compr_type]->capi_name;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compr_type >",
          "args": [
            "0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn !!"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_compr_present(int compr_type)\n{\n\tubifs_assert(compr_type >= 0 && compr_type < UBIFS_COMPR_TYPES_CNT);\n\treturn !!ubifs_compressors[compr_type]->capi_name;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "onst struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "100-103",
    "snippet": "struct ubifs_inode *ubifs_inode(const struct inode *inode)\n{\n\treturn container_of(inode, struct ubifs_inode, vfs_inode);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode, struc",
          "args": [
            "ubif",
            "inode,vfs_inode);",
            "/**\n *"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "struct ubifs_inode *ubifs_inode(const struct inode *inode)\n{\n\treturn container_of(inode, struct ubifs_inode, vfs_inode);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "d_child(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "84-94",
    "snippet": "struct ubifs_znode *\nubifs_tnc_find_child(struct ubifs_znode *znode, int start)\n{\n\twhile (start < znode->child_cnt) {\n\t\tif (znode->zbranch[start].znode)\n\t\t\treturn znode->zbranch[start].znode;\n\t\tstart += 1;\n\t}\n\n\treturn NULL;\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "struct ubifs_znode *\nubifs_tnc_find_child(struct ubifs_znode *znode, int start)\n{\n\twhile (start < znode->child_cnt) {\n\t\tif (znode->zbranch[start].znode)\n\t\t\treturn znode->zbranch[start].znode;\n\t\tstart += 1;\n\t}\n\n\treturn NULL;\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "_bgt(struct ubifs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "68-74",
    "snippet": "void ubifs_wake_up_bgt(struct ubifs_info *c)\n{\n\tif (c->bgt && !c->need_bgt) {\n\t\tc->need_bgt = 1;\n\t\twake_up_process(c->bgt);\n\t}\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ss(c->bgt);\n\t}",
          "args": [
            "/**"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "void ubifs_wake_up_bgt(struct ubifs_info *c)\n{\n\tif (c->bgt && !c->need_bgt) {\n\t\tc->need_bgt = 1;\n\t\twake_up_process(c->bgt);\n\t}\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "59-62",
    "snippet": "int ubifs_zn_cow(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(COW_ZNODE, &znode->flags);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ZNODE, &",
          "args": [
            "node->fla",
            ");\n}\n\n/**\n *"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_zn_cow(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(COW_ZNODE, &znode->flags);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "lete(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "47-50",
    "snippet": "int ubifs_zn_obsolete(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(OBSOLETE_ZNODE, &znode->flags);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LETE_ZNO",
          "args": [
            "E, &znode->fla",
            ");\n}\n\n/**\n *"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_zn_obsolete(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(OBSOLETE_ZNODE, &znode->flags);\n}\n\n/**\n * ubif"
  },
  {
    "function_name": "y(const struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ubifs/misc.h",
    "lines": "36-39",
    "snippet": "int ubifs_zn_dirty(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(DIRTY_ZNODE, &znode->flags);\n}\n\n/**\n * ubif",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Y_ZNODE,",
          "args": [
            "&znode->fla",
            ");\n}\n\n/**\n *"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "int ubifs_zn_dirty(const struct ubifs_znode *znode)\n{\n\treturn !!test_bit(DIRTY_ZNODE, &znode->flags);\n}\n\n/**\n * ubif"
  }
]