[
  {
    "function_name": "configfs_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "157-162",
    "snippet": "static inline void configfs_put(struct configfs_dirent * sd)\n{\n\tWARN_ON(!atomic_read(&sd->s_count));\n\tif (atomic_dec_and_test(&sd->s_count))\n\t\trelease_configfs_dirent(sd);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "release_configfs_dirent",
          "args": [
            "sd"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "release_configfs_dirent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
          "lines": "140-146",
          "snippet": "static inline void release_configfs_dirent(struct configfs_dirent * sd)\n{\n\tif (!(sd->s_type & CONFIGFS_ROOT)) {\n\t\tkfree(sd->s_iattr);\n\t\tkmem_cache_free(configfs_dir_cachep, sd);\n\t}\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [
            "#define CONFIGFS_ROOT\t\t0x0001"
          ],
          "globals_used": [
            "extern struct kmem_cache *configfs_dir_cachep;",
            "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
            "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ROOT\t\t0x0001\n\nextern struct kmem_cache *configfs_dir_cachep;\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\n\nstatic inline void release_configfs_dirent(struct configfs_dirent * sd)\n{\n\tif (!(sd->s_type & CONFIGFS_ROOT)) {\n\t\tkfree(sd->s_iattr);\n\t\tkmem_cache_free(configfs_dir_cachep, sd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec_and_test",
          "args": [
            "&sd->s_count"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!atomic_read(&sd->s_count)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&sd->s_count"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\n\nstatic inline void configfs_put(struct configfs_dirent * sd)\n{\n\tWARN_ON(!atomic_read(&sd->s_count));\n\tif (atomic_dec_and_test(&sd->s_count))\n\t\trelease_configfs_dirent(sd);\n}"
  },
  {
    "function_name": "configfs_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "148-155",
    "snippet": "static inline struct configfs_dirent * configfs_get(struct configfs_dirent * sd)\n{\n\tif (sd) {\n\t\tWARN_ON(!atomic_read(&sd->s_count));\n\t\tatomic_inc(&sd->s_count);\n\t}\n\treturn sd;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&sd->s_count"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!atomic_read(&sd->s_count)"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&sd->s_count"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\n\nstatic inline struct configfs_dirent * configfs_get(struct configfs_dirent * sd)\n{\n\tif (sd) {\n\t\tWARN_ON(!atomic_read(&sd->s_count));\n\t\tatomic_inc(&sd->s_count);\n\t}\n\treturn sd;\n}"
  },
  {
    "function_name": "release_configfs_dirent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "140-146",
    "snippet": "static inline void release_configfs_dirent(struct configfs_dirent * sd)\n{\n\tif (!(sd->s_type & CONFIGFS_ROOT)) {\n\t\tkfree(sd->s_iattr);\n\t\tkmem_cache_free(configfs_dir_cachep, sd);\n\t}\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define CONFIGFS_ROOT\t\t0x0001"
    ],
    "globals_used": [
      "extern struct kmem_cache *configfs_dir_cachep;",
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "configfs_dir_cachep",
            "sd"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sd->s_iattr"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ROOT\t\t0x0001\n\nextern struct kmem_cache *configfs_dir_cachep;\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\n\nstatic inline void release_configfs_dirent(struct configfs_dirent * sd)\n{\n\tif (!(sd->s_type & CONFIGFS_ROOT)) {\n\t\tkfree(sd->s_iattr);\n\t\tkmem_cache_free(configfs_dir_cachep, sd);\n\t}\n}"
  },
  {
    "function_name": "configfs_get_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "122-138",
    "snippet": "static inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define CONFIGFS_ITEM_LINK\t0x0020"
    ],
    "globals_used": [
      "extern int configfs_is_root(struct config_item *item);",
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
      "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
      "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dentry->d_lock"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_get",
          "args": [
            "sd->s_element"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "134-139",
          "snippet": "struct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_unhashed",
          "args": [
            "dentry"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dentry->d_lock"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\n#define CONFIGFS_ITEM_LINK\t0x0020\n\nextern int configfs_is_root(struct config_item *item);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item *configfs_get_config_item(struct dentry *dentry)\n{\n\tstruct config_item * item = NULL;\n\n\tspin_lock(&dentry->d_lock);\n\tif (!d_unhashed(dentry)) {\n\t\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\t\tif (sd->s_type & CONFIGFS_ITEM_LINK) {\n\t\t\tstruct configfs_symlink * sl = sd->s_element;\n\t\t\titem = config_item_get(sl->sl_target);\n\t\t} else\n\t\t\titem = config_item_get(sd->s_element);\n\t}\n\tspin_unlock(&dentry->d_lock);\n\n\treturn item;\n}"
  },
  {
    "function_name": "to_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "116-120",
    "snippet": "static inline struct configfs_attribute * to_attr(struct dentry * dentry)\n{\n\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\treturn ((struct configfs_attribute *) sd->s_element);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int configfs_create_file(struct config_item *, const struct configfs_attribute *);",
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
      "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
      "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\nextern int configfs_create_file(struct config_item *, const struct configfs_attribute *);\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct configfs_attribute * to_attr(struct dentry * dentry)\n{\n\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\treturn ((struct configfs_attribute *) sd->s_element);\n}"
  },
  {
    "function_name": "to_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/configfs_internal.h",
    "lines": "110-114",
    "snippet": "static inline struct config_item * to_item(struct dentry * dentry)\n{\n\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\treturn ((struct config_item *) sd->s_element);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int configfs_dirent_is_ready(struct configfs_dirent *);",
      "extern const unsigned char * configfs_get_name(struct configfs_dirent *sd);",
      "extern int configfs_unlink(struct inode *dir, struct dentry *dentry);",
      "extern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n\nextern int configfs_dirent_is_ready(struct configfs_dirent *);\nextern const unsigned char * configfs_get_name(struct configfs_dirent *sd);\nextern int configfs_unlink(struct inode *dir, struct dentry *dentry);\nextern int configfs_create_link(struct configfs_symlink *sl,\n\t\t\t\tstruct dentry *parent,\n\t\t\t\tstruct dentry *dentry);\n\nstatic inline struct config_item * to_item(struct dentry * dentry)\n{\n\tstruct configfs_dirent * sd = dentry->d_fsdata;\n\treturn ((struct config_item *) sd->s_element);\n}"
  }
]