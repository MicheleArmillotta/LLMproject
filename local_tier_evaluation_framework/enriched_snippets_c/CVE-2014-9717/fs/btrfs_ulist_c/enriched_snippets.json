[
  {
    "function_name": "ulist_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "228-251",
    "snippet": "struct ulist_node *ulist_next(struct ulist *ulist, struct ulist_iterator *uiter)\n{\n\tstruct ulist_node *node;\n\n\tif (list_empty(&ulist->nodes))\n\t\treturn NULL;\n\tif (uiter->cur_list && uiter->cur_list->next == &ulist->nodes)\n\t\treturn NULL;\n\tif (uiter->cur_list) {\n\t\tuiter->cur_list = uiter->cur_list->next;\n\t} else {\n\t\tuiter->cur_list = ulist->nodes.next;\n#ifdef CONFIG_BTRFS_DEBUG\n\t\tuiter->i = 0;\n#endif\n\t}\n\tnode = list_entry(uiter->cur_list, struct ulist_node, list);\n#ifdef CONFIG_BTRFS_DEBUG\n\tASSERT(node->seqnum == uiter->i);\n\tASSERT(uiter->i >= 0 && uiter->i < ulist->nnodes);\n\tuiter->i++;\n#endif\n\treturn node;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "uiter->i >= 0 && uiter->i < ulist->nnodes"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "node->seqnum == uiter->i"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "uiter->cur_list",
            "structulist_node",
            "list"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ulist->nodes"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstruct ulist_node *ulist_next(struct ulist *ulist, struct ulist_iterator *uiter)\n{\n\tstruct ulist_node *node;\n\n\tif (list_empty(&ulist->nodes))\n\t\treturn NULL;\n\tif (uiter->cur_list && uiter->cur_list->next == &ulist->nodes)\n\t\treturn NULL;\n\tif (uiter->cur_list) {\n\t\tuiter->cur_list = uiter->cur_list->next;\n\t} else {\n\t\tuiter->cur_list = ulist->nodes.next;\n#ifdef CONFIG_BTRFS_DEBUG\n\t\tuiter->i = 0;\n#endif\n\t}\n\tnode = list_entry(uiter->cur_list, struct ulist_node, list);\n#ifdef CONFIG_BTRFS_DEBUG\n\tASSERT(node->seqnum == uiter->i);\n\tASSERT(uiter->i >= 0 && uiter->i < ulist->nnodes);\n\tuiter->i++;\n#endif\n\treturn node;\n}"
  },
  {
    "function_name": "ulist_add_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "182-210",
    "snippet": "int ulist_add_merge(struct ulist *ulist, u64 val, u64 aux,\n\t\t    u64 *old_aux, gfp_t gfp_mask)\n{\n\tint ret;\n\tstruct ulist_node *node;\n\n\tnode = ulist_rbtree_search(ulist, val);\n\tif (node) {\n\t\tif (old_aux)\n\t\t\t*old_aux = node->aux;\n\t\treturn 0;\n\t}\n\tnode = kmalloc(sizeof(*node), gfp_mask);\n\tif (!node)\n\t\treturn -ENOMEM;\n\n\tnode->val = val;\n\tnode->aux = aux;\n#ifdef CONFIG_BTRFS_DEBUG\n\tnode->seqnum = ulist->nnodes;\n#endif\n\n\tret = ulist_rbtree_insert(ulist, node);\n\tASSERT(!ret);\n\tlist_add_tail(&node->list, &ulist->nodes);\n\tulist->nnodes++;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&node->list",
            "&ulist->nodes"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT",
          "args": [
            "!ret"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ulist_rbtree_insert",
          "args": [
            "ulist",
            "node"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_rbtree_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "135-155",
          "snippet": "static int ulist_rbtree_insert(struct ulist *ulist, struct ulist_node *ins)\n{\n\tstruct rb_node **p = &ulist->root.rb_node;\n\tstruct rb_node *parent = NULL;\n\tstruct ulist_node *cur = NULL;\n\n\twhile (*p) {\n\t\tparent = *p;\n\t\tcur = rb_entry(parent, struct ulist_node, rb_node);\n\n\t\tif (cur->val < ins->val)\n\t\t\tp = &(*p)->rb_right;\n\t\telse if (cur->val > ins->val)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\treturn -EEXIST;\n\t}\n\trb_link_node(&ins->rb_node, parent, p);\n\trb_insert_color(&ins->rb_node, &ulist->root);\n\treturn 0;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic int ulist_rbtree_insert(struct ulist *ulist, struct ulist_node *ins)\n{\n\tstruct rb_node **p = &ulist->root.rb_node;\n\tstruct rb_node *parent = NULL;\n\tstruct ulist_node *cur = NULL;\n\n\twhile (*p) {\n\t\tparent = *p;\n\t\tcur = rb_entry(parent, struct ulist_node, rb_node);\n\n\t\tif (cur->val < ins->val)\n\t\t\tp = &(*p)->rb_right;\n\t\telse if (cur->val > ins->val)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\treturn -EEXIST;\n\t}\n\trb_link_node(&ins->rb_node, parent, p);\n\trb_insert_color(&ins->rb_node, &ulist->root);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*node)",
            "gfp_mask"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ulist_rbtree_search",
          "args": [
            "ulist",
            "val"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_rbtree_search",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "118-133",
          "snippet": "static struct ulist_node *ulist_rbtree_search(struct ulist *ulist, u64 val)\n{\n\tstruct rb_node *n = ulist->root.rb_node;\n\tstruct ulist_node *u = NULL;\n\n\twhile (n) {\n\t\tu = rb_entry(n, struct ulist_node, rb_node);\n\t\tif (u->val < val)\n\t\t\tn = n->rb_right;\n\t\telse if (u->val > val)\n\t\t\tn = n->rb_left;\n\t\telse\n\t\t\treturn u;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic struct ulist_node *ulist_rbtree_search(struct ulist *ulist, u64 val)\n{\n\tstruct rb_node *n = ulist->root.rb_node;\n\tstruct ulist_node *u = NULL;\n\n\twhile (n) {\n\t\tu = rb_entry(n, struct ulist_node, rb_node);\n\t\tif (u->val < val)\n\t\t\tn = n->rb_right;\n\t\telse if (u->val > val)\n\t\t\tn = n->rb_left;\n\t\telse\n\t\t\treturn u;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nint ulist_add_merge(struct ulist *ulist, u64 val, u64 aux,\n\t\t    u64 *old_aux, gfp_t gfp_mask)\n{\n\tint ret;\n\tstruct ulist_node *node;\n\n\tnode = ulist_rbtree_search(ulist, val);\n\tif (node) {\n\t\tif (old_aux)\n\t\t\t*old_aux = node->aux;\n\t\treturn 0;\n\t}\n\tnode = kmalloc(sizeof(*node), gfp_mask);\n\tif (!node)\n\t\treturn -ENOMEM;\n\n\tnode->val = val;\n\tnode->aux = aux;\n#ifdef CONFIG_BTRFS_DEBUG\n\tnode->seqnum = ulist->nnodes;\n#endif\n\n\tret = ulist_rbtree_insert(ulist, node);\n\tASSERT(!ret);\n\tlist_add_tail(&node->list, &ulist->nodes);\n\tulist->nnodes++;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "ulist_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "177-180",
    "snippet": "int ulist_add(struct ulist *ulist, u64 val, u64 aux, gfp_t gfp_mask)\n{\n\treturn ulist_add_merge(ulist, val, aux, NULL, gfp_mask);\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ulist_add_merge",
          "args": [
            "ulist",
            "val",
            "aux",
            "NULL",
            "gfp_mask"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_add_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "182-210",
          "snippet": "int ulist_add_merge(struct ulist *ulist, u64 val, u64 aux,\n\t\t    u64 *old_aux, gfp_t gfp_mask)\n{\n\tint ret;\n\tstruct ulist_node *node;\n\n\tnode = ulist_rbtree_search(ulist, val);\n\tif (node) {\n\t\tif (old_aux)\n\t\t\t*old_aux = node->aux;\n\t\treturn 0;\n\t}\n\tnode = kmalloc(sizeof(*node), gfp_mask);\n\tif (!node)\n\t\treturn -ENOMEM;\n\n\tnode->val = val;\n\tnode->aux = aux;\n#ifdef CONFIG_BTRFS_DEBUG\n\tnode->seqnum = ulist->nnodes;\n#endif\n\n\tret = ulist_rbtree_insert(ulist, node);\n\tASSERT(!ret);\n\tlist_add_tail(&node->list, &ulist->nodes);\n\tulist->nnodes++;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nint ulist_add_merge(struct ulist *ulist, u64 val, u64 aux,\n\t\t    u64 *old_aux, gfp_t gfp_mask)\n{\n\tint ret;\n\tstruct ulist_node *node;\n\n\tnode = ulist_rbtree_search(ulist, val);\n\tif (node) {\n\t\tif (old_aux)\n\t\t\t*old_aux = node->aux;\n\t\treturn 0;\n\t}\n\tnode = kmalloc(sizeof(*node), gfp_mask);\n\tif (!node)\n\t\treturn -ENOMEM;\n\n\tnode->val = val;\n\tnode->aux = aux;\n#ifdef CONFIG_BTRFS_DEBUG\n\tnode->seqnum = ulist->nnodes;\n#endif\n\n\tret = ulist_rbtree_insert(ulist, node);\n\tASSERT(!ret);\n\tlist_add_tail(&node->list, &ulist->nodes);\n\tulist->nnodes++;\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nint ulist_add(struct ulist *ulist, u64 val, u64 aux, gfp_t gfp_mask)\n{\n\treturn ulist_add_merge(ulist, val, aux, NULL, gfp_mask);\n}"
  },
  {
    "function_name": "ulist_rbtree_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "135-155",
    "snippet": "static int ulist_rbtree_insert(struct ulist *ulist, struct ulist_node *ins)\n{\n\tstruct rb_node **p = &ulist->root.rb_node;\n\tstruct rb_node *parent = NULL;\n\tstruct ulist_node *cur = NULL;\n\n\twhile (*p) {\n\t\tparent = *p;\n\t\tcur = rb_entry(parent, struct ulist_node, rb_node);\n\n\t\tif (cur->val < ins->val)\n\t\t\tp = &(*p)->rb_right;\n\t\telse if (cur->val > ins->val)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\treturn -EEXIST;\n\t}\n\trb_link_node(&ins->rb_node, parent, p);\n\trb_insert_color(&ins->rb_node, &ulist->root);\n\treturn 0;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "&ins->rb_node",
            "&ulist->root"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "&ins->rb_node",
            "parent",
            "p"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "parent",
            "structulist_node",
            "rb_node"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic int ulist_rbtree_insert(struct ulist *ulist, struct ulist_node *ins)\n{\n\tstruct rb_node **p = &ulist->root.rb_node;\n\tstruct rb_node *parent = NULL;\n\tstruct ulist_node *cur = NULL;\n\n\twhile (*p) {\n\t\tparent = *p;\n\t\tcur = rb_entry(parent, struct ulist_node, rb_node);\n\n\t\tif (cur->val < ins->val)\n\t\t\tp = &(*p)->rb_right;\n\t\telse if (cur->val > ins->val)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\treturn -EEXIST;\n\t}\n\trb_link_node(&ins->rb_node, parent, p);\n\trb_insert_color(&ins->rb_node, &ulist->root);\n\treturn 0;\n}"
  },
  {
    "function_name": "ulist_rbtree_search",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "118-133",
    "snippet": "static struct ulist_node *ulist_rbtree_search(struct ulist *ulist, u64 val)\n{\n\tstruct rb_node *n = ulist->root.rb_node;\n\tstruct ulist_node *u = NULL;\n\n\twhile (n) {\n\t\tu = rb_entry(n, struct ulist_node, rb_node);\n\t\tif (u->val < val)\n\t\t\tn = n->rb_right;\n\t\telse if (u->val > val)\n\t\t\tn = n->rb_left;\n\t\telse\n\t\t\treturn u;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "n",
            "structulist_node",
            "rb_node"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic struct ulist_node *ulist_rbtree_search(struct ulist *ulist, u64 val)\n{\n\tstruct rb_node *n = ulist->root.rb_node;\n\tstruct ulist_node *u = NULL;\n\n\twhile (n) {\n\t\tu = rb_entry(n, struct ulist_node, rb_node);\n\t\tif (u->val < val)\n\t\t\tn = n->rb_right;\n\t\telse if (u->val > val)\n\t\t\tn = n->rb_left;\n\t\telse\n\t\t\treturn u;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "ulist_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "110-116",
    "snippet": "void ulist_free(struct ulist *ulist)\n{\n\tif (!ulist)\n\t\treturn;\n\tulist_fini(ulist);\n\tkfree(ulist);\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ulist"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ulist_fini",
          "args": [
            "ulist"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "61-71",
          "snippet": "static void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nvoid ulist_free(struct ulist *ulist)\n{\n\tif (!ulist)\n\t\treturn;\n\tulist_fini(ulist);\n\tkfree(ulist);\n}"
  },
  {
    "function_name": "ulist_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "92-102",
    "snippet": "struct ulist *ulist_alloc(gfp_t gfp_mask)\n{\n\tstruct ulist *ulist = kmalloc(sizeof(*ulist), gfp_mask);\n\n\tif (!ulist)\n\t\treturn NULL;\n\n\tulist_init(ulist);\n\n\treturn ulist;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ulist_init",
          "args": [
            "ulist"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "47-52",
          "snippet": "void ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nvoid ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*ulist)",
            "gfp_mask"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstruct ulist *ulist_alloc(gfp_t gfp_mask)\n{\n\tstruct ulist *ulist = kmalloc(sizeof(*ulist), gfp_mask);\n\n\tif (!ulist)\n\t\treturn NULL;\n\n\tulist_init(ulist);\n\n\treturn ulist;\n}"
  },
  {
    "function_name": "ulist_reinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "80-84",
    "snippet": "void ulist_reinit(struct ulist *ulist)\n{\n\tulist_fini(ulist);\n\tulist_init(ulist);\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ulist_init",
          "args": [
            "ulist"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "47-52",
          "snippet": "void ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nvoid ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ulist_fini",
          "args": [
            "ulist"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "ulist_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
          "lines": "61-71",
          "snippet": "static void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}",
          "includes": [
            "#include \"ctree.h\"",
            "#include \"ulist.h\"",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nvoid ulist_reinit(struct ulist *ulist)\n{\n\tulist_fini(ulist);\n\tulist_init(ulist);\n}"
  },
  {
    "function_name": "ulist_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "61-71",
    "snippet": "static void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ulist->nodes"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "node"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "node",
            "next",
            "&ulist->nodes",
            "list"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nstatic void ulist_fini(struct ulist *ulist)\n{\n\tstruct ulist_node *node;\n\tstruct ulist_node *next;\n\n\tlist_for_each_entry_safe(node, next, &ulist->nodes, list) {\n\t\tkfree(node);\n\t}\n\tulist->root = RB_ROOT;\n\tINIT_LIST_HEAD(&ulist->nodes);\n}"
  },
  {
    "function_name": "ulist_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/btrfs/ulist.c",
    "lines": "47-52",
    "snippet": "void ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}",
    "includes": [
      "#include \"ctree.h\"",
      "#include \"ulist.h\"",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ulist->nodes"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ctree.h\"\n#include \"ulist.h\"\n#include <linux/slab.h>\n\nvoid ulist_init(struct ulist *ulist)\n{\n\tINIT_LIST_HEAD(&ulist->nodes);\n\tulist->root = RB_ROOT;\n\tulist->nnodes = 0;\n}"
  }
]