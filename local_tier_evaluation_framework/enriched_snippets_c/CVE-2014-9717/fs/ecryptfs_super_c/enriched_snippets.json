[
  {
    "function_name": "ecryptfs_show_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "146-182",
    "snippet": "static int ecryptfs_show_options(struct seq_file *m, struct dentry *root)\n{\n\tstruct super_block *sb = root->d_sb;\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat =\n\t\t&ecryptfs_superblock_to_private(sb)->mount_crypt_stat;\n\tstruct ecryptfs_global_auth_tok *walker;\n\n\tmutex_lock(&mount_crypt_stat->global_auth_tok_list_mutex);\n\tlist_for_each_entry(walker,\n\t\t\t    &mount_crypt_stat->global_auth_tok_list,\n\t\t\t    mount_crypt_stat_list) {\n\t\tif (walker->flags & ECRYPTFS_AUTH_TOK_FNEK)\n\t\t\tseq_printf(m, \",ecryptfs_fnek_sig=%s\", walker->sig);\n\t\telse\n\t\t\tseq_printf(m, \",ecryptfs_sig=%s\", walker->sig);\n\t}\n\tmutex_unlock(&mount_crypt_stat->global_auth_tok_list_mutex);\n\n\tseq_printf(m, \",ecryptfs_cipher=%s\",\n\t\tmount_crypt_stat->global_default_cipher_name);\n\n\tif (mount_crypt_stat->global_default_cipher_key_size)\n\t\tseq_printf(m, \",ecryptfs_key_bytes=%zd\",\n\t\t\t   mount_crypt_stat->global_default_cipher_key_size);\n\tif (mount_crypt_stat->flags & ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_passthrough\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_XATTR_METADATA_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_xattr_metadata\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_ENCRYPTED_VIEW_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_encrypted_view\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_UNLINK_SIGS)\n\t\tseq_printf(m, \",ecryptfs_unlink_sigs\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_GLOBAL_MOUNT_AUTH_TOK_ONLY)\n\t\tseq_printf(m, \",ecryptfs_mount_auth_tok_only\");\n\n\treturn 0;\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",ecryptfs_mount_auth_tok_only\""
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/seq_file.c",
          "lines": "416-426",
          "snippet": "int seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <asm/uaccess.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n\nint seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tint ret;\n\tva_list args;\n\n\tva_start(args, f);\n\tret = seq_vprintf(m, f, args);\n\tva_end(args);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&mount_crypt_stat->global_auth_tok_list_mutex"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "walker",
            "&mount_crypt_stat->global_auth_tok_list",
            "mount_crypt_stat_list"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&mount_crypt_stat->global_auth_tok_list_mutex"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_superblock_to_private",
          "args": [
            "sb"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_superblock_to_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "473-477",
          "snippet": "static inline struct ecryptfs_sb_info *\necryptfs_superblock_to_private(struct super_block *sb)\n{\n\treturn (struct ecryptfs_sb_info *)sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct ecryptfs_sb_info *\necryptfs_superblock_to_private(struct super_block *sb)\n{\n\treturn (struct ecryptfs_sb_info *)sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic int ecryptfs_show_options(struct seq_file *m, struct dentry *root)\n{\n\tstruct super_block *sb = root->d_sb;\n\tstruct ecryptfs_mount_crypt_stat *mount_crypt_stat =\n\t\t&ecryptfs_superblock_to_private(sb)->mount_crypt_stat;\n\tstruct ecryptfs_global_auth_tok *walker;\n\n\tmutex_lock(&mount_crypt_stat->global_auth_tok_list_mutex);\n\tlist_for_each_entry(walker,\n\t\t\t    &mount_crypt_stat->global_auth_tok_list,\n\t\t\t    mount_crypt_stat_list) {\n\t\tif (walker->flags & ECRYPTFS_AUTH_TOK_FNEK)\n\t\t\tseq_printf(m, \",ecryptfs_fnek_sig=%s\", walker->sig);\n\t\telse\n\t\t\tseq_printf(m, \",ecryptfs_sig=%s\", walker->sig);\n\t}\n\tmutex_unlock(&mount_crypt_stat->global_auth_tok_list_mutex);\n\n\tseq_printf(m, \",ecryptfs_cipher=%s\",\n\t\tmount_crypt_stat->global_default_cipher_name);\n\n\tif (mount_crypt_stat->global_default_cipher_key_size)\n\t\tseq_printf(m, \",ecryptfs_key_bytes=%zd\",\n\t\t\t   mount_crypt_stat->global_default_cipher_key_size);\n\tif (mount_crypt_stat->flags & ECRYPTFS_PLAINTEXT_PASSTHROUGH_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_passthrough\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_XATTR_METADATA_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_xattr_metadata\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_ENCRYPTED_VIEW_ENABLED)\n\t\tseq_printf(m, \",ecryptfs_encrypted_view\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_UNLINK_SIGS)\n\t\tseq_printf(m, \",ecryptfs_unlink_sigs\");\n\tif (mount_crypt_stat->flags & ECRYPTFS_GLOBAL_MOUNT_AUTH_TOK_ONLY)\n\t\tseq_printf(m, \",ecryptfs_mount_auth_tok_only\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ecryptfs_evict_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "133-138",
    "snippet": "static void ecryptfs_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tiput(ecryptfs_inode_to_lower(inode));\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "ecryptfs_inode_to_lower(inode)"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecryptfs_inode_to_lower",
          "args": [
            "inode"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_inode_to_lower",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "462-465",
          "snippet": "static inline struct inode *ecryptfs_inode_to_lower(struct inode *inode)\n{\n\treturn ecryptfs_inode_to_private(inode)->wii_inode;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct inode *ecryptfs_inode_to_lower(struct inode *inode)\n{\n\treturn ecryptfs_inode_to_private(inode)->wii_inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_inode",
          "args": [
            "inode"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_clear_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/super.c",
          "lines": "960-973",
          "snippet": "void ext4_clear_inode(struct inode *inode)\n{\n\tinvalidate_inode_buffers(inode);\n\tclear_inode(inode);\n\tdquot_drop(inode);\n\text4_discard_preallocations(inode);\n\text4_es_remove_extent(inode, 0, EXT_MAX_BLOCKS);\n\tif (EXT4_I(inode)->jinode) {\n\t\tjbd2_journal_release_jbd_inode(EXT4_JOURNAL(inode),\n\t\t\t\t\t       EXT4_I(inode)->jinode);\n\t\tjbd2_free_inode(EXT4_I(inode)->jinode);\n\t\tEXT4_I(inode)->jinode = NULL;\n\t}\n}",
          "includes": [
            "#include <trace/events/ext4.h>",
            "#include \"mballoc.h\"",
            "#include \"acl.h\"",
            "#include \"xattr.h\"",
            "#include \"ext4_jbd2.h\"",
            "#include \"ext4_extents.h\"\t/* Needed for trace points definition */",
            "#include \"ext4.h\"",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/crc16.h>",
            "#include <linux/log2.h>",
            "#include <linux/ctype.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/random.h>",
            "#include <linux/vfs.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/parser.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/time.h>",
            "#include <linux/fs.h>",
            "#include <linux/string.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/ext4.h>\n#include \"mballoc.h\"\n#include \"acl.h\"\n#include \"xattr.h\"\n#include \"ext4_jbd2.h\"\n#include \"ext4_extents.h\"\t/* Needed for trace points definition */\n#include \"ext4.h\"\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <asm/uaccess.h>\n#include <linux/cleancache.h>\n#include <linux/crc16.h>\n#include <linux/log2.h>\n#include <linux/ctype.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/quotaops.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/random.h>\n#include <linux/vfs.h>\n#include <linux/exportfs.h>\n#include <linux/buffer_head.h>\n#include <linux/parser.h>\n#include <linux/blkdev.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/jbd2.h>\n#include <linux/vmalloc.h>\n#include <linux/time.h>\n#include <linux/fs.h>\n#include <linux/string.h>\n#include <linux/module.h>\n\nvoid ext4_clear_inode(struct inode *inode)\n{\n\tinvalidate_inode_buffers(inode);\n\tclear_inode(inode);\n\tdquot_drop(inode);\n\text4_discard_preallocations(inode);\n\text4_es_remove_extent(inode, 0, EXT_MAX_BLOCKS);\n\tif (EXT4_I(inode)->jinode) {\n\t\tjbd2_journal_release_jbd_inode(EXT4_JOURNAL(inode),\n\t\t\t\t\t       EXT4_I(inode)->jinode);\n\t\tjbd2_free_inode(EXT4_I(inode)->jinode);\n\t\tEXT4_I(inode)->jinode = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages_final",
          "args": [
            "&inode->i_data"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic void ecryptfs_evict_inode(struct inode *inode)\n{\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\tiput(ecryptfs_inode_to_lower(inode));\n}"
  },
  {
    "function_name": "ecryptfs_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "104-121",
    "snippet": "static int ecryptfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct dentry *lower_dentry = ecryptfs_dentry_to_lower(dentry);\n\tint rc;\n\n\tif (!lower_dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\trc = lower_dentry->d_sb->s_op->statfs(lower_dentry, buf);\n\tif (rc)\n\t\treturn rc;\n\n\tbuf->f_type = ECRYPTFS_SUPER_MAGIC;\n\trc = ecryptfs_set_f_namelen(&buf->f_namelen, buf->f_namelen,\n\t       &ecryptfs_superblock_to_private(dentry->d_sb)->mount_crypt_stat);\n\n\treturn rc;\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ecryptfs_set_f_namelen",
          "args": [
            "&buf->f_namelen",
            "buf->f_namelen",
            "&ecryptfs_superblock_to_private(dentry->d_sb)->mount_crypt_stat"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_set_f_namelen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/crypto.c",
          "lines": "2121-2166",
          "snippet": "int ecryptfs_set_f_namelen(long *namelen, long lower_namelen,\n\t\t\t   struct ecryptfs_mount_crypt_stat *mount_crypt_stat)\n{\n\tstruct blkcipher_desc desc;\n\tstruct mutex *tfm_mutex;\n\tsize_t cipher_blocksize;\n\tint rc;\n\n\tif (!(mount_crypt_stat->flags & ECRYPTFS_GLOBAL_ENCRYPT_FILENAMES)) {\n\t\t(*namelen) = lower_namelen;\n\t\treturn 0;\n\t}\n\n\trc = ecryptfs_get_tfm_and_mutex_for_cipher_name(&desc.tfm, &tfm_mutex,\n\t\t\tmount_crypt_stat->global_default_fn_cipher_name);\n\tif (unlikely(rc)) {\n\t\t(*namelen) = 0;\n\t\treturn rc;\n\t}\n\n\tmutex_lock(tfm_mutex);\n\tcipher_blocksize = crypto_blkcipher_blocksize(desc.tfm);\n\tmutex_unlock(tfm_mutex);\n\n\t/* Return an exact amount for the common cases */\n\tif (lower_namelen == NAME_MAX\n\t    && (cipher_blocksize == 8 || cipher_blocksize == 16)) {\n\t\t(*namelen) = ENC_NAME_MAX_BLOCKLEN_8_OR_16;\n\t\treturn 0;\n\t}\n\n\t/* Return a safe estimate for the uncommon cases */\n\t(*namelen) = lower_namelen;\n\t(*namelen) -= ECRYPTFS_FNEK_ENCRYPTED_FILENAME_PREFIX_SIZE;\n\t/* Since this is the max decoded size, subtract 1 \"decoded block\" len */\n\t(*namelen) = ecryptfs_max_decoded_size(*namelen) - 3;\n\t(*namelen) -= ECRYPTFS_TAG_70_MAX_METADATA_SIZE;\n\t(*namelen) -= ECRYPTFS_FILENAME_MIN_RANDOM_PREPEND_BYTES;\n\t/* Worst case is that the filename is padded nearly a full block size */\n\t(*namelen) -= cipher_blocksize - 1;\n\n\tif ((*namelen) < 0)\n\t\t(*namelen) = 0;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"ecryptfs_kernel.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/slab.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/file.h>",
            "#include <linux/crypto.h>",
            "#include <linux/namei.h>",
            "#include <linux/key.h>",
            "#include <linux/compiler.h>",
            "#include <linux/random.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define ENC_NAME_MAX_BLOCKLEN_8_OR_16\t143"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <asm/unaligned.h>\n#include <linux/slab.h>\n#include <linux/scatterlist.h>\n#include <linux/file.h>\n#include <linux/crypto.h>\n#include <linux/namei.h>\n#include <linux/key.h>\n#include <linux/compiler.h>\n#include <linux/random.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\n#define ENC_NAME_MAX_BLOCKLEN_8_OR_16\t143\n\nint ecryptfs_set_f_namelen(long *namelen, long lower_namelen,\n\t\t\t   struct ecryptfs_mount_crypt_stat *mount_crypt_stat)\n{\n\tstruct blkcipher_desc desc;\n\tstruct mutex *tfm_mutex;\n\tsize_t cipher_blocksize;\n\tint rc;\n\n\tif (!(mount_crypt_stat->flags & ECRYPTFS_GLOBAL_ENCRYPT_FILENAMES)) {\n\t\t(*namelen) = lower_namelen;\n\t\treturn 0;\n\t}\n\n\trc = ecryptfs_get_tfm_and_mutex_for_cipher_name(&desc.tfm, &tfm_mutex,\n\t\t\tmount_crypt_stat->global_default_fn_cipher_name);\n\tif (unlikely(rc)) {\n\t\t(*namelen) = 0;\n\t\treturn rc;\n\t}\n\n\tmutex_lock(tfm_mutex);\n\tcipher_blocksize = crypto_blkcipher_blocksize(desc.tfm);\n\tmutex_unlock(tfm_mutex);\n\n\t/* Return an exact amount for the common cases */\n\tif (lower_namelen == NAME_MAX\n\t    && (cipher_blocksize == 8 || cipher_blocksize == 16)) {\n\t\t(*namelen) = ENC_NAME_MAX_BLOCKLEN_8_OR_16;\n\t\treturn 0;\n\t}\n\n\t/* Return a safe estimate for the uncommon cases */\n\t(*namelen) = lower_namelen;\n\t(*namelen) -= ECRYPTFS_FNEK_ENCRYPTED_FILENAME_PREFIX_SIZE;\n\t/* Since this is the max decoded size, subtract 1 \"decoded block\" len */\n\t(*namelen) = ecryptfs_max_decoded_size(*namelen) - 3;\n\t(*namelen) -= ECRYPTFS_TAG_70_MAX_METADATA_SIZE;\n\t(*namelen) -= ECRYPTFS_FILENAME_MIN_RANDOM_PREPEND_BYTES;\n\t/* Worst case is that the filename is padded nearly a full block size */\n\t(*namelen) -= cipher_blocksize - 1;\n\n\tif ((*namelen) < 0)\n\t\t(*namelen) = 0;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecryptfs_superblock_to_private",
          "args": [
            "dentry->d_sb"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_superblock_to_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "473-477",
          "snippet": "static inline struct ecryptfs_sb_info *\necryptfs_superblock_to_private(struct super_block *sb)\n{\n\treturn (struct ecryptfs_sb_info *)sb->s_fs_info;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct ecryptfs_sb_info *\necryptfs_superblock_to_private(struct super_block *sb)\n{\n\treturn (struct ecryptfs_sb_info *)sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lower_dentry->d_sb->s_op->statfs",
          "args": [
            "lower_dentry",
            "buf"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_dentry_to_lower",
          "args": [
            "dentry"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_dentry_to_lower_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "524-528",
          "snippet": "static inline struct path *\necryptfs_dentry_to_lower_path(struct dentry *dentry)\n{\n\treturn &((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path;\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct path *\necryptfs_dentry_to_lower_path(struct dentry *dentry)\n{\n\treturn &((struct ecryptfs_dentry_info *)dentry->d_fsdata)->lower_path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic int ecryptfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct dentry *lower_dentry = ecryptfs_dentry_to_lower(dentry);\n\tint rc;\n\n\tif (!lower_dentry->d_sb->s_op->statfs)\n\t\treturn -ENOSYS;\n\n\trc = lower_dentry->d_sb->s_op->statfs(lower_dentry, buf);\n\tif (rc)\n\t\treturn rc;\n\n\tbuf->f_type = ECRYPTFS_SUPER_MAGIC;\n\trc = ecryptfs_set_f_namelen(&buf->f_namelen, buf->f_namelen,\n\t       &ecryptfs_superblock_to_private(dentry->d_sb)->mount_crypt_stat);\n\n\treturn rc;\n}"
  },
  {
    "function_name": "ecryptfs_destroy_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "86-94",
    "snippet": "static void ecryptfs_destroy_inode(struct inode *inode)\n{\n\tstruct ecryptfs_inode_info *inode_info;\n\n\tinode_info = ecryptfs_inode_to_private(inode);\n\tBUG_ON(inode_info->lower_file);\n\tecryptfs_destroy_crypt_stat(&inode_info->crypt_stat);\n\tcall_rcu(&inode->i_rcu, ecryptfs_i_callback);\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&inode->i_rcu",
            "ecryptfs_i_callback"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_destroy_crypt_stat",
          "args": [
            "&inode_info->crypt_stat"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_destroy_crypt_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/crypto.c",
          "lines": "233-247",
          "snippet": "void ecryptfs_destroy_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat)\n{\n\tstruct ecryptfs_key_sig *key_sig, *key_sig_tmp;\n\n\tif (crypt_stat->tfm)\n\t\tcrypto_free_ablkcipher(crypt_stat->tfm);\n\tif (crypt_stat->hash_tfm)\n\t\tcrypto_free_hash(crypt_stat->hash_tfm);\n\tlist_for_each_entry_safe(key_sig, key_sig_tmp,\n\t\t\t\t &crypt_stat->keysig_list, crypt_stat_list) {\n\t\tlist_del(&key_sig->crypt_stat_list);\n\t\tkmem_cache_free(ecryptfs_key_sig_cache, key_sig);\n\t}\n\tmemset(crypt_stat, 0, sizeof(struct ecryptfs_crypt_stat));\n}",
          "includes": [
            "#include \"ecryptfs_kernel.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/slab.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/file.h>",
            "#include <linux/crypto.h>",
            "#include <linux/namei.h>",
            "#include <linux/key.h>",
            "#include <linux/compiler.h>",
            "#include <linux/random.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <asm/unaligned.h>\n#include <linux/slab.h>\n#include <linux/scatterlist.h>\n#include <linux/file.h>\n#include <linux/crypto.h>\n#include <linux/namei.h>\n#include <linux/key.h>\n#include <linux/compiler.h>\n#include <linux/random.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nvoid ecryptfs_destroy_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat)\n{\n\tstruct ecryptfs_key_sig *key_sig, *key_sig_tmp;\n\n\tif (crypt_stat->tfm)\n\t\tcrypto_free_ablkcipher(crypt_stat->tfm);\n\tif (crypt_stat->hash_tfm)\n\t\tcrypto_free_hash(crypt_stat->hash_tfm);\n\tlist_for_each_entry_safe(key_sig, key_sig_tmp,\n\t\t\t\t &crypt_stat->keysig_list, crypt_stat_list) {\n\t\tlist_del(&key_sig->crypt_stat_list);\n\t\tkmem_cache_free(ecryptfs_key_sig_cache, key_sig);\n\t}\n\tmemset(crypt_stat, 0, sizeof(struct ecryptfs_crypt_stat));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "inode_info->lower_file"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_inode_to_private",
          "args": [
            "inode"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_inode_to_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "456-460",
          "snippet": "static inline struct ecryptfs_inode_info *\necryptfs_inode_to_private(struct inode *inode)\n{\n\treturn container_of(inode, struct ecryptfs_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct ecryptfs_inode_info *\necryptfs_inode_to_private(struct inode *inode)\n{\n\treturn container_of(inode, struct ecryptfs_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstatic void ecryptfs_destroy_inode(struct inode *inode)\n{\n\tstruct ecryptfs_inode_info *inode_info;\n\n\tinode_info = ecryptfs_inode_to_private(inode);\n\tBUG_ON(inode_info->lower_file);\n\tecryptfs_destroy_crypt_stat(&inode_info->crypt_stat);\n\tcall_rcu(&inode->i_rcu, ecryptfs_i_callback);\n}"
  },
  {
    "function_name": "ecryptfs_i_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "68-75",
    "snippet": "static void ecryptfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tstruct ecryptfs_inode_info *inode_info;\n\tinode_info = ecryptfs_inode_to_private(inode);\n\n\tkmem_cache_free(ecryptfs_inode_info_cache, inode_info);\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kmem_cache *ecryptfs_inode_info_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "ecryptfs_inode_info_cache",
            "inode_info"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_inode_to_private",
          "args": [
            "inode"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_inode_to_private",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/ecryptfs_kernel.h",
          "lines": "456-460",
          "snippet": "static inline struct ecryptfs_inode_info *\necryptfs_inode_to_private(struct inode *inode)\n{\n\treturn container_of(inode, struct ecryptfs_inode_info, vfs_inode);\n}",
          "includes": [
            "#include <linux/crypto.h>",
            "#include <linux/ecryptfs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/hash.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs_stack.h>",
            "#include <linux/fs.h>",
            "#include <keys/encrypted-type.h>",
            "#include <keys/user-type.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/crypto.h>\n#include <linux/ecryptfs.h>\n#include <linux/backing-dev.h>\n#include <linux/nsproxy.h>\n#include <linux/hash.h>\n#include <linux/scatterlist.h>\n#include <linux/namei.h>\n#include <linux/fs_stack.h>\n#include <linux/fs.h>\n#include <keys/encrypted-type.h>\n#include <keys/user-type.h>\n\nstatic inline struct ecryptfs_inode_info *\necryptfs_inode_to_private(struct inode *inode)\n{\n\treturn container_of(inode, struct ecryptfs_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "head",
            "structinode",
            "i_rcu"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstruct kmem_cache *ecryptfs_inode_info_cache;\n\nstatic void ecryptfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tstruct ecryptfs_inode_info *inode_info;\n\tinode_info = ecryptfs_inode_to_private(inode);\n\n\tkmem_cache_free(ecryptfs_inode_info_cache, inode_info);\n}"
  },
  {
    "function_name": "ecryptfs_alloc_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/super.c",
    "lines": "51-66",
    "snippet": "static struct inode *ecryptfs_alloc_inode(struct super_block *sb)\n{\n\tstruct ecryptfs_inode_info *inode_info;\n\tstruct inode *inode = NULL;\n\n\tinode_info = kmem_cache_alloc(ecryptfs_inode_info_cache, GFP_KERNEL);\n\tif (unlikely(!inode_info))\n\t\tgoto out;\n\tecryptfs_init_crypt_stat(&inode_info->crypt_stat);\n\tmutex_init(&inode_info->lower_file_mutex);\n\tatomic_set(&inode_info->lower_file_count, 0);\n\tinode_info->lower_file = NULL;\n\tinode = &inode_info->vfs_inode;\nout:\n\treturn inode;\n}",
    "includes": [
      "#include \"ecryptfs_kernel.h\"",
      "#include <linux/magic.h>",
      "#include <linux/statfs.h>",
      "#include <linux/crypto.h>",
      "#include <linux/file.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/slab.h>",
      "#include <linux/key.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kmem_cache *ecryptfs_inode_info_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&inode_info->lower_file_count",
            "0"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&inode_info->lower_file_mutex"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecryptfs_init_crypt_stat",
          "args": [
            "&inode_info->crypt_stat"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "ecryptfs_init_crypt_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ecryptfs/crypto.c",
          "lines": "215-225",
          "snippet": "void\necryptfs_init_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat)\n{\n\tmemset((void *)crypt_stat, 0, sizeof(struct ecryptfs_crypt_stat));\n\tINIT_LIST_HEAD(&crypt_stat->keysig_list);\n\tmutex_init(&crypt_stat->keysig_list_mutex);\n\tmutex_init(&crypt_stat->cs_mutex);\n\tmutex_init(&crypt_stat->cs_tfm_mutex);\n\tmutex_init(&crypt_stat->cs_hash_tfm_mutex);\n\tcrypt_stat->flags |= ECRYPTFS_STRUCT_INITIALIZED;\n}",
          "includes": [
            "#include \"ecryptfs_kernel.h\"",
            "#include <asm/unaligned.h>",
            "#include <linux/slab.h>",
            "#include <linux/scatterlist.h>",
            "#include <linux/file.h>",
            "#include <linux/crypto.h>",
            "#include <linux/namei.h>",
            "#include <linux/key.h>",
            "#include <linux/compiler.h>",
            "#include <linux/random.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <asm/unaligned.h>\n#include <linux/slab.h>\n#include <linux/scatterlist.h>\n#include <linux/file.h>\n#include <linux/crypto.h>\n#include <linux/namei.h>\n#include <linux/key.h>\n#include <linux/compiler.h>\n#include <linux/random.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nvoid\necryptfs_init_crypt_stat(struct ecryptfs_crypt_stat *crypt_stat)\n{\n\tmemset((void *)crypt_stat, 0, sizeof(struct ecryptfs_crypt_stat));\n\tINIT_LIST_HEAD(&crypt_stat->keysig_list);\n\tmutex_init(&crypt_stat->keysig_list_mutex);\n\tmutex_init(&crypt_stat->cs_mutex);\n\tmutex_init(&crypt_stat->cs_tfm_mutex);\n\tmutex_init(&crypt_stat->cs_hash_tfm_mutex);\n\tcrypt_stat->flags |= ECRYPTFS_STRUCT_INITIALIZED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!inode_info"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "ecryptfs_inode_info_cache",
            "GFP_KERNEL"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1064-1076",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\nretry:\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry) {\n\t\tcond_resched();\n\t\tgoto retry;\n\t}\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecryptfs_kernel.h\"\n#include <linux/magic.h>\n#include <linux/statfs.h>\n#include <linux/crypto.h>\n#include <linux/file.h>\n#include <linux/seq_file.h>\n#include <linux/slab.h>\n#include <linux/key.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n\nstruct kmem_cache *ecryptfs_inode_info_cache;\n\nstatic struct inode *ecryptfs_alloc_inode(struct super_block *sb)\n{\n\tstruct ecryptfs_inode_info *inode_info;\n\tstruct inode *inode = NULL;\n\n\tinode_info = kmem_cache_alloc(ecryptfs_inode_info_cache, GFP_KERNEL);\n\tif (unlikely(!inode_info))\n\t\tgoto out;\n\tecryptfs_init_crypt_stat(&inode_info->crypt_stat);\n\tmutex_init(&inode_info->lower_file_mutex);\n\tatomic_set(&inode_info->lower_file_count, 0);\n\tinode_info->lower_file = NULL;\n\tinode = &inode_info->vfs_inode;\nout:\n\treturn inode;\n}"
  }
]