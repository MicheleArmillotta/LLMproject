[
  {
    "function_name": "dquot_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2796-2841",
    "snippet": "static int __init dquot_init(void)\n{\n\tint i, ret;\n\tunsigned long nr_hash, order;\n\n\tprintk(KERN_NOTICE \"VFS: Disk quotas %s\\n\", __DQUOT_VERSION__);\n\n\tregister_sysctl_table(sys_table);\n\n\tdquot_cachep = kmem_cache_create(\"dquot\",\n\t\t\tsizeof(struct dquot), sizeof(unsigned long) * 4,\n\t\t\t(SLAB_HWCACHE_ALIGN|SLAB_RECLAIM_ACCOUNT|\n\t\t\t\tSLAB_MEM_SPREAD|SLAB_PANIC),\n\t\t\tNULL);\n\n\torder = 0;\n\tdquot_hash = (struct hlist_head *)__get_free_pages(GFP_ATOMIC, order);\n\tif (!dquot_hash)\n\t\tpanic(\"Cannot create dquot hash table\");\n\n\tfor (i = 0; i < _DQST_DQSTAT_LAST; i++) {\n\t\tret = percpu_counter_init(&dqstats.counter[i], 0, GFP_KERNEL);\n\t\tif (ret)\n\t\t\tpanic(\"Cannot create dquot stat counters\");\n\t}\n\n\t/* Find power-of-two hlist_heads which can fit into allocation */\n\tnr_hash = (1UL << order) * PAGE_SIZE / sizeof(struct hlist_head);\n\tdq_hash_bits = 0;\n\tdo {\n\t\tdq_hash_bits++;\n\t} while (nr_hash >> dq_hash_bits);\n\tdq_hash_bits--;\n\n\tnr_hash = 1UL << dq_hash_bits;\n\tdq_hash_mask = nr_hash - 1;\n\tfor (i = 0; i < nr_hash; i++)\n\t\tINIT_HLIST_HEAD(dquot_hash + i);\n\n\tpr_info(\"VFS: Dquot-cache hash table entries: %ld (order %ld,\"\n\t\t\" %ld bytes)\\n\", nr_hash, order, (PAGE_SIZE << order));\n\n\tregister_shrinker(&dqcache_shrinker);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *dquot_cachep;",
      "static unsigned int dq_hash_bits, dq_hash_mask;",
      "static struct hlist_head *dquot_hash;",
      "struct dqstats dqstats;",
      "static struct shrinker dqcache_shrinker = {\n\t.count_objects = dqcache_shrink_count,\n\t.scan_objects = dqcache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};",
      "static struct ctl_table sys_table[] = {\n\t{\n\t\t.procname\t= \"fs\",\n\t\t.mode\t\t= 0555,\n\t\t.child\t\t= fs_table,\n\t},\n\t{ },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&dqcache_shrinker"
          ],
          "line": 2838
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ext4/extents_status.c",
          "lines": "1220-1227",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"extents_status.h\"",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>",
            "#include <linux/rbtree.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"extents_status.h\"\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n#include <linux/rbtree.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tif (sbi->s_proc)\n\t\tremove_proc_entry(\"es_shrinker_info\", sbi->s_proc);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"VFS: Dquot-cache hash table entries: %ld (order %ld,\"\n\t\t\" %ld bytes)\\n\"",
            "nr_hash",
            "order",
            "(PAGE_SIZE << order)"
          ],
          "line": 2835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_HEAD",
          "args": [
            "dquot_hash + i"
          ],
          "line": 2833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Cannot create dquot stat counters\""
          ],
          "line": 2819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_init",
          "args": [
            "&dqstats.counter[i]",
            "0",
            "GFP_KERNEL"
          ],
          "line": 2817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"Cannot create dquot hash table\""
          ],
          "line": 2814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_free_pages",
          "args": [
            "GFP_ATOMIC",
            "order"
          ],
          "line": 2812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"dquot\"",
            "sizeof(struct dquot)",
            "sizeof(unsigned long) * 4",
            "(SLAB_HWCACHE_ALIGN|SLAB_RECLAIM_ACCOUNT|\n\t\t\t\tSLAB_MEM_SPREAD|SLAB_PANIC)",
            "NULL"
          ],
          "line": 2805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "sys_table"
          ],
          "line": 2803
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/proc/proc_sysctl.c",
          "lines": "1528-1555",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_NOTICE \"VFS: Disk quotas %s\\n\"",
            "__DQUOT_VERSION__"
          ],
          "line": 2801
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *dquot_cachep;\nstatic unsigned int dq_hash_bits, dq_hash_mask;\nstatic struct hlist_head *dquot_hash;\nstruct dqstats dqstats;\nstatic struct shrinker dqcache_shrinker = {\n\t.count_objects = dqcache_shrink_count,\n\t.scan_objects = dqcache_shrink_scan,\n\t.seeks = DEFAULT_SEEKS,\n};\nstatic struct ctl_table sys_table[] = {\n\t{\n\t\t.procname\t= \"fs\",\n\t\t.mode\t\t= 0555,\n\t\t.child\t\t= fs_table,\n\t},\n\t{ },\n};\n\nstatic int __init dquot_init(void)\n{\n\tint i, ret;\n\tunsigned long nr_hash, order;\n\n\tprintk(KERN_NOTICE \"VFS: Disk quotas %s\\n\", __DQUOT_VERSION__);\n\n\tregister_sysctl_table(sys_table);\n\n\tdquot_cachep = kmem_cache_create(\"dquot\",\n\t\t\tsizeof(struct dquot), sizeof(unsigned long) * 4,\n\t\t\t(SLAB_HWCACHE_ALIGN|SLAB_RECLAIM_ACCOUNT|\n\t\t\t\tSLAB_MEM_SPREAD|SLAB_PANIC),\n\t\t\tNULL);\n\n\torder = 0;\n\tdquot_hash = (struct hlist_head *)__get_free_pages(GFP_ATOMIC, order);\n\tif (!dquot_hash)\n\t\tpanic(\"Cannot create dquot hash table\");\n\n\tfor (i = 0; i < _DQST_DQSTAT_LAST; i++) {\n\t\tret = percpu_counter_init(&dqstats.counter[i], 0, GFP_KERNEL);\n\t\tif (ret)\n\t\t\tpanic(\"Cannot create dquot stat counters\");\n\t}\n\n\t/* Find power-of-two hlist_heads which can fit into allocation */\n\tnr_hash = (1UL << order) * PAGE_SIZE / sizeof(struct hlist_head);\n\tdq_hash_bits = 0;\n\tdo {\n\t\tdq_hash_bits++;\n\t} while (nr_hash >> dq_hash_bits);\n\tdq_hash_bits--;\n\n\tnr_hash = 1UL << dq_hash_bits;\n\tdq_hash_mask = nr_hash - 1;\n\tfor (i = 0; i < nr_hash; i++)\n\t\tINIT_HLIST_HEAD(dquot_hash + i);\n\n\tpr_info(\"VFS: Dquot-cache hash table entries: %ld (order %ld,\"\n\t\t\" %ld bytes)\\n\", nr_hash, order, (PAGE_SIZE << order));\n\n\tregister_shrinker(&dqcache_shrinker);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "do_proc_dqstats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2698-2707",
    "snippet": "static int do_proc_dqstats(struct ctl_table *table, int write,\n\t\t     void __user *buffer, size_t *lenp, loff_t *ppos)\n{\n\tunsigned int type = (int *)table->data - dqstats.stat;\n\n\t/* Update global table */\n\tdqstats.stat[type] =\n\t\t\tpercpu_counter_sum_positive(&dqstats.counter[type]);\n\treturn proc_dointvec(table, write, buffer, lenp, ppos);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct dqstats dqstats;",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_dointvec",
          "args": [
            "table",
            "write",
            "buffer",
            "lenp",
            "ppos"
          ],
          "line": 2706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_sum_positive",
          "args": [
            "&dqstats.counter[type]"
          ],
          "line": 2705
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstruct dqstats dqstats;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int do_proc_dqstats(struct ctl_table *table, int write,\n\t\t     void __user *buffer, size_t *lenp, loff_t *ppos)\n{\n\tunsigned int type = (int *)table->data - dqstats.stat;\n\n\t/* Update global table */\n\tdqstats.stat[type] =\n\t\t\tpercpu_counter_sum_positive(&dqstats.counter[type]);\n\treturn proc_dointvec(table, write, buffer, lenp, ppos);\n}"
  },
  {
    "function_name": "dquot_set_dqinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2639-2673",
    "snippet": "int dquot_set_dqinfo(struct super_block *sb, int type, struct if_dqinfo *ii)\n{\n\tstruct mem_dqinfo *mi;\n\tint err = 0;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\terr = -ESRCH;\n\t\tgoto out;\n\t}\n\tmi = sb_dqopt(sb)->info + type;\n\tif (ii->dqi_valid & IIF_FLAGS) {\n\t\tif (ii->dqi_flags & ~DQF_SETINFO_MASK ||\n\t\t    (ii->dqi_flags & DQF_ROOT_SQUASH &&\n\t\t     mi->dqi_format->qf_fmt_id != QFMT_VFS_OLD)) {\n\t\t\terr = -EINVAL;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tspin_lock(&dq_data_lock);\n\tif (ii->dqi_valid & IIF_BGRACE)\n\t\tmi->dqi_bgrace = ii->dqi_bgrace;\n\tif (ii->dqi_valid & IIF_IGRACE)\n\t\tmi->dqi_igrace = ii->dqi_igrace;\n\tif (ii->dqi_valid & IIF_FLAGS)\n\t\tmi->dqi_flags = (mi->dqi_flags & ~DQF_SETINFO_MASK) |\n\t\t\t\t(ii->dqi_flags & DQF_SETINFO_MASK);\n\tspin_unlock(&dq_data_lock);\n\tmark_info_dirty(sb, type);\n\t/* Force write to disk */\n\tsb->dq_op->write_info(sb, type);\nout:\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn err;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 2671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->dq_op->write_info",
          "args": [
            "sb",
            "type"
          ],
          "line": 2669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_info_dirty",
          "args": [
            "sb",
            "type"
          ],
          "line": 2667
        },
        "resolved": true,
        "details": {
          "function_name": "mark_info_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "393-396",
          "snippet": "void mark_info_dirty(struct super_block *sb, int type)\n{\n\tset_bit(DQF_INFO_DIRTY_B, &sb_dqopt(sb)->info[type].dqi_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid mark_info_dirty(struct super_block *sb, int type)\n{\n\tset_bit(DQF_INFO_DIRTY_B, &sb_dqopt(sb)->info[type].dqi_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2666
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2658
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "type"
          ],
          "line": 2645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 2644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_set_dqinfo(struct super_block *sb, int type, struct if_dqinfo *ii)\n{\n\tstruct mem_dqinfo *mi;\n\tint err = 0;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\terr = -ESRCH;\n\t\tgoto out;\n\t}\n\tmi = sb_dqopt(sb)->info + type;\n\tif (ii->dqi_valid & IIF_FLAGS) {\n\t\tif (ii->dqi_flags & ~DQF_SETINFO_MASK ||\n\t\t    (ii->dqi_flags & DQF_ROOT_SQUASH &&\n\t\t     mi->dqi_format->qf_fmt_id != QFMT_VFS_OLD)) {\n\t\t\terr = -EINVAL;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tspin_lock(&dq_data_lock);\n\tif (ii->dqi_valid & IIF_BGRACE)\n\t\tmi->dqi_bgrace = ii->dqi_bgrace;\n\tif (ii->dqi_valid & IIF_IGRACE)\n\t\tmi->dqi_igrace = ii->dqi_igrace;\n\tif (ii->dqi_valid & IIF_FLAGS)\n\t\tmi->dqi_flags = (mi->dqi_flags & ~DQF_SETINFO_MASK) |\n\t\t\t\t(ii->dqi_flags & DQF_SETINFO_MASK);\n\tspin_unlock(&dq_data_lock);\n\tmark_info_dirty(sb, type);\n\t/* Force write to disk */\n\tsb->dq_op->write_info(sb, type);\nout:\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn err;\n}"
  },
  {
    "function_name": "dquot_get_dqinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2617-2635",
    "snippet": "int dquot_get_dqinfo(struct super_block *sb, int type, struct if_dqinfo *ii)\n{\n\tstruct mem_dqinfo *mi;\n  \n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tmi = sb_dqopt(sb)->info + type;\n\tspin_lock(&dq_data_lock);\n\tii->dqi_bgrace = mi->dqi_bgrace;\n\tii->dqi_igrace = mi->dqi_igrace;\n\tii->dqi_flags = mi->dqi_flags & DQF_GETINFO_MASK;\n\tii->dqi_valid = IIF_ALL;\n\tspin_unlock(&dq_data_lock);\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2632
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2627
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 2623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "type"
          ],
          "line": 2622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 2621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_get_dqinfo(struct super_block *sb, int type, struct if_dqinfo *ii)\n{\n\tstruct mem_dqinfo *mi;\n  \n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tif (!sb_has_quota_active(sb, type)) {\n\t\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\t\treturn -ESRCH;\n\t}\n\tmi = sb_dqopt(sb)->info + type;\n\tspin_lock(&dq_data_lock);\n\tii->dqi_bgrace = mi->dqi_bgrace;\n\tii->dqi_igrace = mi->dqi_igrace;\n\tii->dqi_flags = mi->dqi_flags & DQF_GETINFO_MASK;\n\tii->dqi_valid = IIF_ALL;\n\tspin_unlock(&dq_data_lock);\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn 0;\n}"
  },
  {
    "function_name": "dquot_set_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2598-2613",
    "snippet": "int dquot_set_dqblk(struct super_block *sb, struct kqid qid,\n\t\t  struct qc_dqblk *di)\n{\n\tstruct dquot *dquot;\n\tint rc;\n\n\tdquot = dqget(sb, qid);\n\tif (!dquot) {\n\t\trc = -ESRCH;\n\t\tgoto out;\n\t}\n\trc = do_set_dqblk(dquot, di);\n\tdqput(dquot);\nout:\n\treturn rc;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 2610
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_set_dqblk",
          "args": [
            "dquot",
            "di"
          ],
          "line": 2609
        },
        "resolved": true,
        "details": {
          "function_name": "do_set_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2507-2596",
          "snippet": "static int do_set_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\tint check_blim = 0, check_ilim = 0;\n\tstruct mem_dqinfo *dqi = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\tif (di->d_fieldmask & ~VFS_QC_MASK)\n\t\treturn -EINVAL;\n\n\tif (((di->d_fieldmask & QC_SPC_SOFT) &&\n\t     di->d_spc_softlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_SPC_HARD) &&\n\t     di->d_spc_hardlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_INO_SOFT) &&\n\t     (di->d_ino_softlimit > dqi->dqi_max_ino_limit)) ||\n\t    ((di->d_fieldmask & QC_INO_HARD) &&\n\t     (di->d_ino_hardlimit > dqi->dqi_max_ino_limit)))\n\t\treturn -ERANGE;\n\n\tspin_lock(&dq_data_lock);\n\tif (di->d_fieldmask & QC_SPACE) {\n\t\tdm->dqb_curspace = di->d_space - dm->dqb_rsvspace;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_SPACE_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_SOFT)\n\t\tdm->dqb_bsoftlimit = di->d_spc_softlimit;\n\tif (di->d_fieldmask & QC_SPC_HARD)\n\t\tdm->dqb_bhardlimit = di->d_spc_hardlimit;\n\tif (di->d_fieldmask & (QC_SPC_SOFT | QC_SPC_HARD)) {\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BLIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_COUNT) {\n\t\tdm->dqb_curinodes = di->d_ino_count;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_INODES_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_SOFT)\n\t\tdm->dqb_isoftlimit = di->d_ino_softlimit;\n\tif (di->d_fieldmask & QC_INO_HARD)\n\t\tdm->dqb_ihardlimit = di->d_ino_hardlimit;\n\tif (di->d_fieldmask & (QC_INO_SOFT | QC_INO_HARD)) {\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ILIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_TIMER) {\n\t\tdm->dqb_btime = di->d_spc_timer;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BTIME_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_TIMER) {\n\t\tdm->dqb_itime = di->d_ino_timer;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ITIME_B, &dquot->dq_flags);\n\t}\n\n\tif (check_blim) {\n\t\tif (!dm->dqb_bsoftlimit ||\n\t\t    dm->dqb_curspace < dm->dqb_bsoftlimit) {\n\t\t\tdm->dqb_btime = 0;\n\t\t\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_SPC_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_btime = get_seconds() + dqi->dqi_bgrace;\n\t}\n\tif (check_ilim) {\n\t\tif (!dm->dqb_isoftlimit ||\n\t\t    dm->dqb_curinodes < dm->dqb_isoftlimit) {\n\t\t\tdm->dqb_itime = 0;\n\t\t\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_INO_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_itime = get_seconds() + dqi->dqi_igrace;\n\t}\n\tif (dm->dqb_bhardlimit || dm->dqb_bsoftlimit || dm->dqb_ihardlimit ||\n\t    dm->dqb_isoftlimit)\n\t\tclear_bit(DQ_FAKE_B, &dquot->dq_flags);\n\telse\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tmark_dquot_dirty(dquot);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define VFS_QC_MASK \\\n\t(QC_SPACE | QC_SPC_SOFT | QC_SPC_HARD | \\\n\t QC_INO_COUNT | QC_INO_SOFT | QC_INO_HARD | \\\n\t QC_SPC_TIMER | QC_INO_TIMER)"
          ],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n#define VFS_QC_MASK \\\n\t(QC_SPACE | QC_SPC_SOFT | QC_SPC_HARD | \\\n\t QC_INO_COUNT | QC_INO_SOFT | QC_INO_HARD | \\\n\t QC_SPC_TIMER | QC_INO_TIMER)\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int do_set_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\tint check_blim = 0, check_ilim = 0;\n\tstruct mem_dqinfo *dqi = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\tif (di->d_fieldmask & ~VFS_QC_MASK)\n\t\treturn -EINVAL;\n\n\tif (((di->d_fieldmask & QC_SPC_SOFT) &&\n\t     di->d_spc_softlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_SPC_HARD) &&\n\t     di->d_spc_hardlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_INO_SOFT) &&\n\t     (di->d_ino_softlimit > dqi->dqi_max_ino_limit)) ||\n\t    ((di->d_fieldmask & QC_INO_HARD) &&\n\t     (di->d_ino_hardlimit > dqi->dqi_max_ino_limit)))\n\t\treturn -ERANGE;\n\n\tspin_lock(&dq_data_lock);\n\tif (di->d_fieldmask & QC_SPACE) {\n\t\tdm->dqb_curspace = di->d_space - dm->dqb_rsvspace;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_SPACE_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_SOFT)\n\t\tdm->dqb_bsoftlimit = di->d_spc_softlimit;\n\tif (di->d_fieldmask & QC_SPC_HARD)\n\t\tdm->dqb_bhardlimit = di->d_spc_hardlimit;\n\tif (di->d_fieldmask & (QC_SPC_SOFT | QC_SPC_HARD)) {\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BLIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_COUNT) {\n\t\tdm->dqb_curinodes = di->d_ino_count;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_INODES_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_SOFT)\n\t\tdm->dqb_isoftlimit = di->d_ino_softlimit;\n\tif (di->d_fieldmask & QC_INO_HARD)\n\t\tdm->dqb_ihardlimit = di->d_ino_hardlimit;\n\tif (di->d_fieldmask & (QC_INO_SOFT | QC_INO_HARD)) {\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ILIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_TIMER) {\n\t\tdm->dqb_btime = di->d_spc_timer;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BTIME_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_TIMER) {\n\t\tdm->dqb_itime = di->d_ino_timer;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ITIME_B, &dquot->dq_flags);\n\t}\n\n\tif (check_blim) {\n\t\tif (!dm->dqb_bsoftlimit ||\n\t\t    dm->dqb_curspace < dm->dqb_bsoftlimit) {\n\t\t\tdm->dqb_btime = 0;\n\t\t\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_SPC_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_btime = get_seconds() + dqi->dqi_bgrace;\n\t}\n\tif (check_ilim) {\n\t\tif (!dm->dqb_isoftlimit ||\n\t\t    dm->dqb_curinodes < dm->dqb_isoftlimit) {\n\t\t\tdm->dqb_itime = 0;\n\t\t\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_INO_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_itime = get_seconds() + dqi->dqi_igrace;\n\t}\n\tif (dm->dqb_bhardlimit || dm->dqb_bsoftlimit || dm->dqb_ihardlimit ||\n\t    dm->dqb_isoftlimit)\n\t\tclear_bit(DQ_FAKE_B, &dquot->dq_flags);\n\telse\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tmark_dquot_dirty(dquot);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqget",
          "args": [
            "sb",
            "qid"
          ],
          "line": 2604
        },
        "resolved": true,
        "details": {
          "function_name": "dqget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "832-893",
          "snippet": "struct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static LIST_HEAD(inuse_list);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nint dquot_set_dqblk(struct super_block *sb, struct kqid qid,\n\t\t  struct qc_dqblk *di)\n{\n\tstruct dquot *dquot;\n\tint rc;\n\n\tdquot = dqget(sb, qid);\n\tif (!dquot) {\n\t\trc = -ESRCH;\n\t\tgoto out;\n\t}\n\trc = do_set_dqblk(dquot, di);\n\tdqput(dquot);\nout:\n\treturn rc;\n}"
  },
  {
    "function_name": "do_set_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2507-2596",
    "snippet": "static int do_set_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\tint check_blim = 0, check_ilim = 0;\n\tstruct mem_dqinfo *dqi = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\tif (di->d_fieldmask & ~VFS_QC_MASK)\n\t\treturn -EINVAL;\n\n\tif (((di->d_fieldmask & QC_SPC_SOFT) &&\n\t     di->d_spc_softlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_SPC_HARD) &&\n\t     di->d_spc_hardlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_INO_SOFT) &&\n\t     (di->d_ino_softlimit > dqi->dqi_max_ino_limit)) ||\n\t    ((di->d_fieldmask & QC_INO_HARD) &&\n\t     (di->d_ino_hardlimit > dqi->dqi_max_ino_limit)))\n\t\treturn -ERANGE;\n\n\tspin_lock(&dq_data_lock);\n\tif (di->d_fieldmask & QC_SPACE) {\n\t\tdm->dqb_curspace = di->d_space - dm->dqb_rsvspace;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_SPACE_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_SOFT)\n\t\tdm->dqb_bsoftlimit = di->d_spc_softlimit;\n\tif (di->d_fieldmask & QC_SPC_HARD)\n\t\tdm->dqb_bhardlimit = di->d_spc_hardlimit;\n\tif (di->d_fieldmask & (QC_SPC_SOFT | QC_SPC_HARD)) {\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BLIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_COUNT) {\n\t\tdm->dqb_curinodes = di->d_ino_count;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_INODES_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_SOFT)\n\t\tdm->dqb_isoftlimit = di->d_ino_softlimit;\n\tif (di->d_fieldmask & QC_INO_HARD)\n\t\tdm->dqb_ihardlimit = di->d_ino_hardlimit;\n\tif (di->d_fieldmask & (QC_INO_SOFT | QC_INO_HARD)) {\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ILIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_TIMER) {\n\t\tdm->dqb_btime = di->d_spc_timer;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BTIME_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_TIMER) {\n\t\tdm->dqb_itime = di->d_ino_timer;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ITIME_B, &dquot->dq_flags);\n\t}\n\n\tif (check_blim) {\n\t\tif (!dm->dqb_bsoftlimit ||\n\t\t    dm->dqb_curspace < dm->dqb_bsoftlimit) {\n\t\t\tdm->dqb_btime = 0;\n\t\t\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_SPC_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_btime = get_seconds() + dqi->dqi_bgrace;\n\t}\n\tif (check_ilim) {\n\t\tif (!dm->dqb_isoftlimit ||\n\t\t    dm->dqb_curinodes < dm->dqb_isoftlimit) {\n\t\t\tdm->dqb_itime = 0;\n\t\t\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_INO_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_itime = get_seconds() + dqi->dqi_igrace;\n\t}\n\tif (dm->dqb_bhardlimit || dm->dqb_bsoftlimit || dm->dqb_ihardlimit ||\n\t    dm->dqb_isoftlimit)\n\t\tclear_bit(DQ_FAKE_B, &dquot->dq_flags);\n\telse\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tmark_dquot_dirty(dquot);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [
      "#define VFS_QC_MASK \\\n\t(QC_SPACE | QC_SPC_SOFT | QC_SPC_HARD | \\\n\t QC_INO_COUNT | QC_INO_SOFT | QC_INO_HARD | \\\n\t QC_SPC_TIMER | QC_INO_TIMER)"
    ],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_dquot_dirty",
          "args": [
            "dquot"
          ],
          "line": 2593
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_mark_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "341-357",
          "snippet": "int dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2592
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 2591
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 2589
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 2585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 2576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2526
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 2511
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n#define VFS_QC_MASK \\\n\t(QC_SPACE | QC_SPC_SOFT | QC_SPC_HARD | \\\n\t QC_INO_COUNT | QC_INO_SOFT | QC_INO_HARD | \\\n\t QC_SPC_TIMER | QC_INO_TIMER)\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int do_set_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\tint check_blim = 0, check_ilim = 0;\n\tstruct mem_dqinfo *dqi = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\tif (di->d_fieldmask & ~VFS_QC_MASK)\n\t\treturn -EINVAL;\n\n\tif (((di->d_fieldmask & QC_SPC_SOFT) &&\n\t     di->d_spc_softlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_SPC_HARD) &&\n\t     di->d_spc_hardlimit > dqi->dqi_max_spc_limit) ||\n\t    ((di->d_fieldmask & QC_INO_SOFT) &&\n\t     (di->d_ino_softlimit > dqi->dqi_max_ino_limit)) ||\n\t    ((di->d_fieldmask & QC_INO_HARD) &&\n\t     (di->d_ino_hardlimit > dqi->dqi_max_ino_limit)))\n\t\treturn -ERANGE;\n\n\tspin_lock(&dq_data_lock);\n\tif (di->d_fieldmask & QC_SPACE) {\n\t\tdm->dqb_curspace = di->d_space - dm->dqb_rsvspace;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_SPACE_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_SOFT)\n\t\tdm->dqb_bsoftlimit = di->d_spc_softlimit;\n\tif (di->d_fieldmask & QC_SPC_HARD)\n\t\tdm->dqb_bhardlimit = di->d_spc_hardlimit;\n\tif (di->d_fieldmask & (QC_SPC_SOFT | QC_SPC_HARD)) {\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BLIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_COUNT) {\n\t\tdm->dqb_curinodes = di->d_ino_count;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_INODES_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_SOFT)\n\t\tdm->dqb_isoftlimit = di->d_ino_softlimit;\n\tif (di->d_fieldmask & QC_INO_HARD)\n\t\tdm->dqb_ihardlimit = di->d_ino_hardlimit;\n\tif (di->d_fieldmask & (QC_INO_SOFT | QC_INO_HARD)) {\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ILIMITS_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_SPC_TIMER) {\n\t\tdm->dqb_btime = di->d_spc_timer;\n\t\tcheck_blim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_BTIME_B, &dquot->dq_flags);\n\t}\n\n\tif (di->d_fieldmask & QC_INO_TIMER) {\n\t\tdm->dqb_itime = di->d_ino_timer;\n\t\tcheck_ilim = 1;\n\t\tset_bit(DQ_LASTSET_B + QIF_ITIME_B, &dquot->dq_flags);\n\t}\n\n\tif (check_blim) {\n\t\tif (!dm->dqb_bsoftlimit ||\n\t\t    dm->dqb_curspace < dm->dqb_bsoftlimit) {\n\t\t\tdm->dqb_btime = 0;\n\t\t\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_SPC_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_btime = get_seconds() + dqi->dqi_bgrace;\n\t}\n\tif (check_ilim) {\n\t\tif (!dm->dqb_isoftlimit ||\n\t\t    dm->dqb_curinodes < dm->dqb_isoftlimit) {\n\t\t\tdm->dqb_itime = 0;\n\t\t\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n\t\t} else if (!(di->d_fieldmask & QC_INO_TIMER))\n\t\t\t/* Set grace only if user hasn't provided his own... */\n\t\t\tdm->dqb_itime = get_seconds() + dqi->dqi_igrace;\n\t}\n\tif (dm->dqb_bhardlimit || dm->dqb_bsoftlimit || dm->dqb_ihardlimit ||\n\t    dm->dqb_isoftlimit)\n\t\tclear_bit(DQ_FAKE_B, &dquot->dq_flags);\n\telse\n\t\tset_bit(DQ_FAKE_B, &dquot->dq_flags);\n\tspin_unlock(&dq_data_lock);\n\tmark_dquot_dirty(dquot);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "dquot_get_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2486-2498",
    "snippet": "int dquot_get_dqblk(struct super_block *sb, struct kqid qid,\n\t\t    struct qc_dqblk *di)\n{\n\tstruct dquot *dquot;\n\n\tdquot = dqget(sb, qid);\n\tif (!dquot)\n\t\treturn -ESRCH;\n\tdo_get_dqblk(dquot, di);\n\tdqput(dquot);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 2495
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_get_dqblk",
          "args": [
            "dquot",
            "di"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "do_get_dqblk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2469-2484",
          "snippet": "static void do_get_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\n\tmemset(di, 0, sizeof(*di));\n\tspin_lock(&dq_data_lock);\n\tdi->d_spc_hardlimit = dm->dqb_bhardlimit;\n\tdi->d_spc_softlimit = dm->dqb_bsoftlimit;\n\tdi->d_ino_hardlimit = dm->dqb_ihardlimit;\n\tdi->d_ino_softlimit = dm->dqb_isoftlimit;\n\tdi->d_space = dm->dqb_curspace + dm->dqb_rsvspace;\n\tdi->d_ino_count = dm->dqb_curinodes;\n\tdi->d_spc_timer = dm->dqb_btime;\n\tdi->d_ino_timer = dm->dqb_itime;\n\tspin_unlock(&dq_data_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\n\nstatic void do_get_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\n\tmemset(di, 0, sizeof(*di));\n\tspin_lock(&dq_data_lock);\n\tdi->d_spc_hardlimit = dm->dqb_bhardlimit;\n\tdi->d_spc_softlimit = dm->dqb_bsoftlimit;\n\tdi->d_ino_hardlimit = dm->dqb_ihardlimit;\n\tdi->d_ino_softlimit = dm->dqb_isoftlimit;\n\tdi->d_space = dm->dqb_curspace + dm->dqb_rsvspace;\n\tdi->d_ino_count = dm->dqb_curinodes;\n\tdi->d_spc_timer = dm->dqb_btime;\n\tdi->d_ino_timer = dm->dqb_itime;\n\tspin_unlock(&dq_data_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqget",
          "args": [
            "sb",
            "qid"
          ],
          "line": 2491
        },
        "resolved": true,
        "details": {
          "function_name": "dqget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "832-893",
          "snippet": "struct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static LIST_HEAD(inuse_list);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nint dquot_get_dqblk(struct super_block *sb, struct kqid qid,\n\t\t    struct qc_dqblk *di)\n{\n\tstruct dquot *dquot;\n\n\tdquot = dqget(sb, qid);\n\tif (!dquot)\n\t\treturn -ESRCH;\n\tdo_get_dqblk(dquot, di);\n\tdqput(dquot);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "do_get_dqblk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2469-2484",
    "snippet": "static void do_get_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\n\tmemset(di, 0, sizeof(*di));\n\tspin_lock(&dq_data_lock);\n\tdi->d_spc_hardlimit = dm->dqb_bhardlimit;\n\tdi->d_spc_softlimit = dm->dqb_bsoftlimit;\n\tdi->d_ino_hardlimit = dm->dqb_ihardlimit;\n\tdi->d_ino_softlimit = dm->dqb_isoftlimit;\n\tdi->d_space = dm->dqb_curspace + dm->dqb_rsvspace;\n\tdi->d_ino_count = dm->dqb_curinodes;\n\tdi->d_spc_timer = dm->dqb_btime;\n\tdi->d_ino_timer = dm->dqb_itime;\n\tspin_unlock(&dq_data_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2483
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 2474
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "di",
            "0",
            "sizeof(*di)"
          ],
          "line": 2473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\n\nstatic void do_get_dqblk(struct dquot *dquot, struct qc_dqblk *di)\n{\n\tstruct mem_dqblk *dm = &dquot->dq_dqb;\n\n\tmemset(di, 0, sizeof(*di));\n\tspin_lock(&dq_data_lock);\n\tdi->d_spc_hardlimit = dm->dqb_bhardlimit;\n\tdi->d_spc_softlimit = dm->dqb_bsoftlimit;\n\tdi->d_ino_hardlimit = dm->dqb_ihardlimit;\n\tdi->d_ino_softlimit = dm->dqb_isoftlimit;\n\tdi->d_space = dm->dqb_curspace + dm->dqb_rsvspace;\n\tdi->d_ino_count = dm->dqb_curinodes;\n\tdi->d_spc_timer = dm->dqb_btime;\n\tdi->d_ino_timer = dm->dqb_itime;\n\tspin_unlock(&dq_data_lock);\n}"
  },
  {
    "function_name": "dquot_quota_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2425-2466",
    "snippet": "static int dquot_quota_disable(struct super_block *sb, unsigned int flags)\n{\n\tint ret;\n\tint type;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE))\n\t\treturn -ENOSYS;\n\t/*\n\t * We don't support turning off accounting via quotactl. In principle\n\t * quota infrastructure can do this but filesystems don't expect\n\t * userspace to be able to do it.\n\t */\n\tif (flags &\n\t\t  (FS_QUOTA_UDQ_ACCT | FS_QUOTA_GDQ_ACCT | FS_QUOTA_PDQ_ACCT))\n\t\treturn -EOPNOTSUPP;\n\n\t/* Filter out limits not enabled */\n\tfor (type = 0; type < MAXQUOTAS; type++)\n\t\tif (!sb_has_quota_limits_enabled(sb, type))\n\t\t\tflags &= ~qtype_enforce_flag(type);\n\t/* Nothing left? */\n\tif (!flags)\n\t\treturn -EEXIST;\n\tfor (type = 0; type < MAXQUOTAS; type++) {\n\t\tif (flags & qtype_enforce_flag(type)) {\n\t\t\tret = dquot_disable(sb, type, DQUOT_LIMITS_ENABLED);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto out_err;\n\t\t}\n\t}\n\treturn 0;\nout_err:\n\t/* Backout enforcement disabling we already did */\n\tfor (type--; type >= 0; type--)  {\n\t\tif (flags & qtype_enforce_flag(type))\n\t\t\tdquot_enable(dqopt->files[type], type,\n\t\t\t\t     dqopt->info[type].dqi_fmt_id,\n\t\t\t\t     DQUOT_LIMITS_ENABLED);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot_enable",
          "args": [
            "dqopt->files[type]",
            "type",
            "dqopt->info[type].dqi_fmt_id",
            "DQUOT_LIMITS_ENABLED"
          ],
          "line": 2461
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2313-2353",
          "snippet": "int dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtype_enforce_flag",
          "args": [
            "type"
          ],
          "line": 2460
        },
        "resolved": true,
        "details": {
          "function_name": "qtype_enforce_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "69-80",
          "snippet": "unsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nunsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_disable",
          "args": [
            "sb",
            "type",
            "DQUOT_LIMITS_ENABLED"
          ],
          "line": 2451
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1999-2127",
          "snippet": "int dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_limits_enabled",
          "args": [
            "sb",
            "type"
          ],
          "line": 2444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int dquot_quota_disable(struct super_block *sb, unsigned int flags)\n{\n\tint ret;\n\tint type;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE))\n\t\treturn -ENOSYS;\n\t/*\n\t * We don't support turning off accounting via quotactl. In principle\n\t * quota infrastructure can do this but filesystems don't expect\n\t * userspace to be able to do it.\n\t */\n\tif (flags &\n\t\t  (FS_QUOTA_UDQ_ACCT | FS_QUOTA_GDQ_ACCT | FS_QUOTA_PDQ_ACCT))\n\t\treturn -EOPNOTSUPP;\n\n\t/* Filter out limits not enabled */\n\tfor (type = 0; type < MAXQUOTAS; type++)\n\t\tif (!sb_has_quota_limits_enabled(sb, type))\n\t\t\tflags &= ~qtype_enforce_flag(type);\n\t/* Nothing left? */\n\tif (!flags)\n\t\treturn -EEXIST;\n\tfor (type = 0; type < MAXQUOTAS; type++) {\n\t\tif (flags & qtype_enforce_flag(type)) {\n\t\t\tret = dquot_disable(sb, type, DQUOT_LIMITS_ENABLED);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto out_err;\n\t\t}\n\t}\n\treturn 0;\nout_err:\n\t/* Backout enforcement disabling we already did */\n\tfor (type--; type >= 0; type--)  {\n\t\tif (flags & qtype_enforce_flag(type))\n\t\t\tdquot_enable(dqopt->files[type], type,\n\t\t\t\t     dqopt->info[type].dqi_fmt_id,\n\t\t\t\t     DQUOT_LIMITS_ENABLED);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_quota_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2388-2423",
    "snippet": "static int dquot_quota_enable(struct super_block *sb, unsigned int flags)\n{\n\tint ret;\n\tint type;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE))\n\t\treturn -ENOSYS;\n\t/* Accounting cannot be turned on while fs is mounted */\n\tflags &= ~(FS_QUOTA_UDQ_ACCT | FS_QUOTA_GDQ_ACCT | FS_QUOTA_PDQ_ACCT);\n\tif (!flags)\n\t\treturn -EINVAL;\n\tfor (type = 0; type < MAXQUOTAS; type++) {\n\t\tif (!(flags & qtype_enforce_flag(type)))\n\t\t\tcontinue;\n\t\t/* Can't enforce without accounting */\n\t\tif (!sb_has_quota_usage_enabled(sb, type))\n\t\t\treturn -EINVAL;\n\t\tret = dquot_enable(dqopt->files[type], type,\n\t\t\t\t   dqopt->info[type].dqi_fmt_id,\n\t\t\t\t   DQUOT_LIMITS_ENABLED);\n\t\tif (ret < 0)\n\t\t\tgoto out_err;\n\t}\n\treturn 0;\nout_err:\n\t/* Backout enforcement enablement we already did */\n\tfor (type--; type >= 0; type--)  {\n\t\tif (flags & qtype_enforce_flag(type))\n\t\t\tdquot_disable(sb, type, DQUOT_LIMITS_ENABLED);\n\t}\n\t/* Error code translation for better compatibility with XFS */\n\tif (ret == -EBUSY)\n\t\tret = -EEXIST;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot_disable",
          "args": [
            "sb",
            "type",
            "DQUOT_LIMITS_ENABLED"
          ],
          "line": 2417
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1999-2127",
          "snippet": "int dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qtype_enforce_flag",
          "args": [
            "type"
          ],
          "line": 2416
        },
        "resolved": true,
        "details": {
          "function_name": "qtype_enforce_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/quota.c",
          "lines": "69-80",
          "snippet": "unsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/writeback.h>",
            "#include <linux/types.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/current.h>",
            "#include <linux/slab.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/writeback.h>\n#include <linux/types.h>\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <asm/current.h>\n#include <linux/slab.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n\nunsigned int qtype_enforce_flag(int type)\n{\n\tswitch (type) {\n\tcase USRQUOTA:\n\t\treturn FS_QUOTA_UDQ_ENFD;\n\tcase GRPQUOTA:\n\t\treturn FS_QUOTA_GDQ_ENFD;\n\tcase PRJQUOTA:\n\t\treturn FS_QUOTA_PDQ_ENFD;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_enable",
          "args": [
            "dqopt->files[type]",
            "type",
            "dqopt->info[type].dqi_fmt_id",
            "DQUOT_LIMITS_ENABLED"
          ],
          "line": 2406
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2313-2353",
          "snippet": "int dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_usage_enabled",
          "args": [
            "sb",
            "type"
          ],
          "line": 2404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int dquot_quota_enable(struct super_block *sb, unsigned int flags)\n{\n\tint ret;\n\tint type;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE))\n\t\treturn -ENOSYS;\n\t/* Accounting cannot be turned on while fs is mounted */\n\tflags &= ~(FS_QUOTA_UDQ_ACCT | FS_QUOTA_GDQ_ACCT | FS_QUOTA_PDQ_ACCT);\n\tif (!flags)\n\t\treturn -EINVAL;\n\tfor (type = 0; type < MAXQUOTAS; type++) {\n\t\tif (!(flags & qtype_enforce_flag(type)))\n\t\t\tcontinue;\n\t\t/* Can't enforce without accounting */\n\t\tif (!sb_has_quota_usage_enabled(sb, type))\n\t\t\treturn -EINVAL;\n\t\tret = dquot_enable(dqopt->files[type], type,\n\t\t\t\t   dqopt->info[type].dqi_fmt_id,\n\t\t\t\t   DQUOT_LIMITS_ENABLED);\n\t\tif (ret < 0)\n\t\t\tgoto out_err;\n\t}\n\treturn 0;\nout_err:\n\t/* Backout enforcement enablement we already did */\n\tfor (type--; type >= 0; type--)  {\n\t\tif (flags & qtype_enforce_flag(type))\n\t\t\tdquot_disable(sb, type, DQUOT_LIMITS_ENABLED);\n\t}\n\t/* Error code translation for better compatibility with XFS */\n\tif (ret == -EBUSY)\n\t\tret = -EEXIST;\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_quota_on_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2360-2385",
    "snippet": "int dquot_quota_on_mount(struct super_block *sb, char *qf_name,\n\t\tint format_id, int type)\n{\n\tstruct dentry *dentry;\n\tint error;\n\n\tmutex_lock(&sb->s_root->d_inode->i_mutex);\n\tdentry = lookup_one_len(qf_name, sb->s_root, strlen(qf_name));\n\tmutex_unlock(&sb->s_root->d_inode->i_mutex);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tif (!dentry->d_inode) {\n\t\terror = -ENOENT;\n\t\tgoto out;\n\t}\n\n\terror = security_quota_on(dentry);\n\tif (!error)\n\t\terror = vfs_load_quota_inode(dentry->d_inode, type, format_id,\n\t\t\t\tDQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED);\n\nout:\n\tdput(dentry);\n\treturn error;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "dentry"
          ],
          "line": 2383
        },
        "resolved": true,
        "details": {
          "function_name": "dput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "726-762",
          "snippet": "void dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nvoid dput(struct dentry *dentry)\n{\n\tif (unlikely(!dentry))\n\t\treturn;\n\nrepeat:\n\trcu_read_lock();\n\tif (likely(fast_dput(dentry))) {\n\t\trcu_read_unlock();\n\t\treturn;\n\t}\n\n\t/* Slow case: now with the dentry lock held */\n\trcu_read_unlock();\n\n\t/* Unreachable? Get rid of it */\n\tif (unlikely(d_unhashed(dentry)))\n\t\tgoto kill_it;\n\n\tif (unlikely(dentry->d_flags & DCACHE_OP_DELETE)) {\n\t\tif (dentry->d_op->d_delete(dentry))\n\t\t\tgoto kill_it;\n\t}\n\n\tif (!(dentry->d_flags & DCACHE_REFERENCED))\n\t\tdentry->d_flags |= DCACHE_REFERENCED;\n\tdentry_lru_add(dentry);\n\n\tdentry->d_lockref.count--;\n\tspin_unlock(&dentry->d_lock);\n\treturn;\n\nkill_it:\n\tdentry = dentry_kill(dentry);\n\tif (dentry)\n\t\tgoto repeat;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_load_quota_inode",
          "args": [
            "dentry->d_inode",
            "type",
            "format_id",
            "DQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED"
          ],
          "line": 2379
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_load_quota_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2145-2253",
          "snippet": "static int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}"
        }
      },
      {
        "call_info": {
          "callee": "security_quota_on",
          "args": [
            "dentry"
          ],
          "line": 2377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "dentry"
          ],
          "line": 2370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dentry"
          ],
          "line": 2369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb->s_root->d_inode->i_mutex"
          ],
          "line": 2368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookup_one_len",
          "args": [
            "qf_name",
            "sb->s_root",
            "strlen(qf_name)"
          ],
          "line": 2367
        },
        "resolved": true,
        "details": {
          "function_name": "lookup_one_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/namei.c",
          "lines": "2145-2184",
          "snippet": "struct dentry *lookup_one_len(const char *name, struct dentry *base, int len)\n{\n\tstruct qstr this;\n\tunsigned int c;\n\tint err;\n\n\tWARN_ON_ONCE(!mutex_is_locked(&base->d_inode->i_mutex));\n\n\tthis.name = name;\n\tthis.len = len;\n\tthis.hash = full_name_hash(name, len);\n\tif (!len)\n\t\treturn ERR_PTR(-EACCES);\n\n\tif (unlikely(name[0] == '.')) {\n\t\tif (len < 2 || (len == 2 && name[1] == '.'))\n\t\t\treturn ERR_PTR(-EACCES);\n\t}\n\n\twhile (len--) {\n\t\tc = *(const unsigned char *)name++;\n\t\tif (c == '/' || c == '\\0')\n\t\t\treturn ERR_PTR(-EACCES);\n\t}\n\t/*\n\t * See if the low-level filesystem might want\n\t * to use its own hash..\n\t */\n\tif (base->d_flags & DCACHE_OP_HASH) {\n\t\tint err = base->d_op->d_hash(base, &this);\n\t\tif (err < 0)\n\t\t\treturn ERR_PTR(err);\n\t}\n\n\terr = inode_permission(base->d_inode, MAY_EXEC);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\treturn __lookup_hash(&this, base, 0);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nstruct dentry *lookup_one_len(const char *name, struct dentry *base, int len)\n{\n\tstruct qstr this;\n\tunsigned int c;\n\tint err;\n\n\tWARN_ON_ONCE(!mutex_is_locked(&base->d_inode->i_mutex));\n\n\tthis.name = name;\n\tthis.len = len;\n\tthis.hash = full_name_hash(name, len);\n\tif (!len)\n\t\treturn ERR_PTR(-EACCES);\n\n\tif (unlikely(name[0] == '.')) {\n\t\tif (len < 2 || (len == 2 && name[1] == '.'))\n\t\t\treturn ERR_PTR(-EACCES);\n\t}\n\n\twhile (len--) {\n\t\tc = *(const unsigned char *)name++;\n\t\tif (c == '/' || c == '\\0')\n\t\t\treturn ERR_PTR(-EACCES);\n\t}\n\t/*\n\t * See if the low-level filesystem might want\n\t * to use its own hash..\n\t */\n\tif (base->d_flags & DCACHE_OP_HASH) {\n\t\tint err = base->d_op->d_hash(base, &this);\n\t\tif (err < 0)\n\t\t\treturn ERR_PTR(err);\n\t}\n\n\terr = inode_permission(base->d_inode, MAY_EXEC);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\treturn __lookup_hash(&this, base, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "qf_name"
          ],
          "line": 2367
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_ea_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/xattr.c",
          "lines": "351-363",
          "snippet": "static inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"trans.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"inode.h\"",
            "#include \"glock.h\"",
            "#include \"xattr.h\"",
            "#include \"acl.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/xattr.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"trans.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"inode.h\"\n#include \"glock.h\"\n#include \"xattr.h\"\n#include \"acl.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/xattr.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int gfs2_ea_strlen(struct gfs2_ea_header *ea)\n{\n\tswitch (ea->ea_type) {\n\tcase GFS2_EATYPE_USR:\n\t\treturn 5 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SYS:\n\t\treturn 7 + ea->ea_name_len + 1;\n\tcase GFS2_EATYPE_SECURITY:\n\t\treturn 9 + ea->ea_name_len + 1;\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sb->s_root->d_inode->i_mutex"
          ],
          "line": 2366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_quota_on_mount(struct super_block *sb, char *qf_name,\n\t\tint format_id, int type)\n{\n\tstruct dentry *dentry;\n\tint error;\n\n\tmutex_lock(&sb->s_root->d_inode->i_mutex);\n\tdentry = lookup_one_len(qf_name, sb->s_root, strlen(qf_name));\n\tmutex_unlock(&sb->s_root->d_inode->i_mutex);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tif (!dentry->d_inode) {\n\t\terror = -ENOENT;\n\t\tgoto out;\n\t}\n\n\terror = security_quota_on(dentry);\n\tif (!error)\n\t\terror = vfs_load_quota_inode(dentry->d_inode, type, format_id,\n\t\t\t\tDQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED);\n\nout:\n\tdput(dentry);\n\treturn error;\n}"
  },
  {
    "function_name": "dquot_enable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2313-2353",
    "snippet": "int dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_load_quota_inode",
          "args": [
            "inode",
            "type",
            "format_id",
            "flags"
          ],
          "line": 2352
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_load_quota_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2145-2253",
          "snippet": "static int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2345
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "flags",
            "type"
          ],
          "line": 2344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2343
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_limits_enabled",
          "args": [
            "sb",
            "type"
          ],
          "line": 2339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_usage_enabled",
          "args": [
            "sb",
            "type"
          ],
          "line": 2334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "type"
          ],
          "line": 2329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "type"
          ],
          "line": 2326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "flags & DQUOT_SUSPENDED"
          ],
          "line": 2321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_enable(struct inode *inode, int type, int format_id,\n\t\t unsigned int flags)\n{\n\tint ret = 0;\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\t/* Just unsuspend quotas? */\n\tBUG_ON(flags & DQUOT_SUSPENDED);\n\n\tif (!flags)\n\t\treturn 0;\n\t/* Just updating flags needed? */\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t/* Now do a reliable test... */\n\t\tif (!sb_has_quota_loaded(sb, type)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tgoto load_quota;\n\t\t}\n\t\tif (flags & DQUOT_USAGE_ENABLED &&\n\t\t    sb_has_quota_usage_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tif (flags & DQUOT_LIMITS_ENABLED &&\n\t\t    sb_has_quota_limits_enabled(sb, type)) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out_lock;\n\t\t}\n\t\tspin_lock(&dq_state_lock);\n\t\tsb_dqopt(sb)->flags |= dquot_state_flag(flags, type);\n\t\tspin_unlock(&dq_state_lock);\nout_lock:\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn ret;\n\t}\n\nload_quota:\n\treturn vfs_load_quota_inode(inode, type, format_id, flags);\n}"
  },
  {
    "function_name": "dquot_quota_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2292-2306",
    "snippet": "int dquot_quota_on(struct super_block *sb, int type, int format_id,\n\t\t   struct path *path)\n{\n\tint error = security_quota_on(path->dentry);\n\tif (error)\n\t\treturn error;\n\t/* Quota file not on the same filesystem? */\n\tif (path->dentry->d_sb != sb)\n\t\terror = -EXDEV;\n\telse\n\t\terror = vfs_load_quota_inode(path->dentry->d_inode, type,\n\t\t\t\t\t     format_id, DQUOT_USAGE_ENABLED |\n\t\t\t\t\t     DQUOT_LIMITS_ENABLED);\n\treturn error;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_load_quota_inode",
          "args": [
            "path->dentry->d_inode",
            "type",
            "format_id",
            "DQUOT_USAGE_ENABLED |\n\t\t\t\t\t     DQUOT_LIMITS_ENABLED"
          ],
          "line": 2302
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_load_quota_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2145-2253",
          "snippet": "static int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}"
        }
      },
      {
        "call_info": {
          "callee": "security_quota_on",
          "args": [
            "path->dentry"
          ],
          "line": 2295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_quota_on(struct super_block *sb, int type, int format_id,\n\t\t   struct path *path)\n{\n\tint error = security_quota_on(path->dentry);\n\tif (error)\n\t\treturn error;\n\t/* Quota file not on the same filesystem? */\n\tif (path->dentry->d_sb != sb)\n\t\terror = -EXDEV;\n\telse\n\t\terror = vfs_load_quota_inode(path->dentry->d_inode, type,\n\t\t\t\t\t     format_id, DQUOT_USAGE_ENABLED |\n\t\t\t\t\t     DQUOT_LIMITS_ENABLED);\n\treturn error;\n}"
  },
  {
    "function_name": "dquot_resume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2256-2289",
    "snippet": "int dquot_resume(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *inode;\n\tint ret = 0, cnt;\n\tunsigned int flags;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\tif (!sb_has_quota_suspended(sb, cnt)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tcontinue;\n\t\t}\n\t\tinode = dqopt->files[cnt];\n\t\tdqopt->files[cnt] = NULL;\n\t\tspin_lock(&dq_state_lock);\n\t\tflags = dqopt->flags & dquot_state_flag(DQUOT_USAGE_ENABLED |\n\t\t\t\t\t\t\tDQUOT_LIMITS_ENABLED,\n\t\t\t\t\t\t\tcnt);\n\t\tdqopt->flags &= ~dquot_state_flag(DQUOT_STATE_FLAGS, cnt);\n\t\tspin_unlock(&dq_state_lock);\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t\tflags = dquot_generic_flag(flags, cnt);\n\t\tret = vfs_load_quota_inode(inode, cnt,\n\t\t\t\tdqopt->info[cnt].dqi_fmt_id, flags);\n\t\tiput(inode);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2285
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_load_quota_inode",
          "args": [
            "inode",
            "cnt",
            "dqopt->info[cnt].dqi_fmt_id",
            "flags"
          ],
          "line": 2283
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_load_quota_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "2145-2253",
          "snippet": "static int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_generic_flag",
          "args": [
            "flags",
            "cnt"
          ],
          "line": 2282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2279
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "DQUOT_STATE_FLAGS",
            "cnt"
          ],
          "line": 2278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "DQUOT_USAGE_ENABLED |\n\t\t\t\t\t\t\tDQUOT_LIMITS_ENABLED",
            "cnt"
          ],
          "line": 2275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2274
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_suspended",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_resume(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *inode;\n\tint ret = 0, cnt;\n\tunsigned int flags;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\n\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\tif (!sb_has_quota_suspended(sb, cnt)) {\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t\tcontinue;\n\t\t}\n\t\tinode = dqopt->files[cnt];\n\t\tdqopt->files[cnt] = NULL;\n\t\tspin_lock(&dq_state_lock);\n\t\tflags = dqopt->flags & dquot_state_flag(DQUOT_USAGE_ENABLED |\n\t\t\t\t\t\t\tDQUOT_LIMITS_ENABLED,\n\t\t\t\t\t\t\tcnt);\n\t\tdqopt->flags &= ~dquot_state_flag(DQUOT_STATE_FLAGS, cnt);\n\t\tspin_unlock(&dq_state_lock);\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t\tflags = dquot_generic_flag(flags, cnt);\n\t\tret = vfs_load_quota_inode(inode, cnt,\n\t\t\t\tdqopt->info[cnt].dqi_fmt_id, flags);\n\t\tiput(inode);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "vfs_load_quota_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2145-2253",
    "snippet": "static int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_quota_format",
          "args": [
            "fmt"
          ],
          "line": 2250
        },
        "resolved": true,
        "details": {
          "function_name": "put_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "216-219",
          "snippet": "static void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 2246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 2241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2238
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_dquot_ref",
          "args": [
            "sb",
            "type"
          ],
          "line": 2231
        },
        "resolved": true,
        "details": {
          "function_name": "add_dquot_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "916-964",
          "snippet": "static void add_dquot_ref(struct super_block *sb, int type)\n{\n\tstruct inode *inode, *old_inode = NULL;\n#ifdef CONFIG_QUOTA_DEBUG\n\tint reserved = 0;\n#endif\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\tspin_lock(&inode->i_lock);\n\t\tif ((inode->i_state & (I_FREEING|I_WILL_FREE|I_NEW)) ||\n\t\t    !atomic_read(&inode->i_writecount) ||\n\t\t    !dqinit_needed(inode, type)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t\tspin_unlock(&inode_sb_list_lock);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\treserved = 1;\n#endif\n\t\tiput(old_inode);\n\t\t__dquot_initialize(inode, type);\n\n\t\t/*\n\t\t * We hold a reference to 'inode' so it couldn't have been\n\t\t * removed from s_inodes list while we dropped the\n\t\t * inode_sb_list_lock We cannot iput the inode now as we can be\n\t\t * holding the last reference and we cannot iput it under\n\t\t * inode_sb_list_lock. So we keep the reference and iput it\n\t\t * later.\n\t\t */\n\t\told_inode = inode;\n\t\tspin_lock(&inode_sb_list_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n\tiput(old_inode);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tquota_error(sb, \"Writes happened before quota was turned on \"\n\t\t\t\"thus quota information is probably inconsistent. \"\n\t\t\t\"Please run quotacheck(8)\");\n\t}\n#endif\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void add_dquot_ref(struct super_block *sb, int type)\n{\n\tstruct inode *inode, *old_inode = NULL;\n#ifdef CONFIG_QUOTA_DEBUG\n\tint reserved = 0;\n#endif\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\tspin_lock(&inode->i_lock);\n\t\tif ((inode->i_state & (I_FREEING|I_WILL_FREE|I_NEW)) ||\n\t\t    !atomic_read(&inode->i_writecount) ||\n\t\t    !dqinit_needed(inode, type)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t\tspin_unlock(&inode_sb_list_lock);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\treserved = 1;\n#endif\n\t\tiput(old_inode);\n\t\t__dquot_initialize(inode, type);\n\n\t\t/*\n\t\t * We hold a reference to 'inode' so it couldn't have been\n\t\t * removed from s_inodes list while we dropped the\n\t\t * inode_sb_list_lock We cannot iput the inode now as we can be\n\t\t * holding the last reference and we cannot iput it under\n\t\t * inode_sb_list_lock. So we keep the reference and iput it\n\t\t * later.\n\t\t */\n\t\told_inode = inode;\n\t\tspin_lock(&inode_sb_list_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n\tiput(old_inode);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tquota_error(sb, \"Writes happened before quota was turned on \"\n\t\t\t\"thus quota information is probably inconsistent. \"\n\t\t\t\"Please run quotacheck(8)\");\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "flags",
            "type"
          ],
          "line": 2228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 2226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 2221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqopt->ops[type]->read_file_info",
          "args": [
            "sb",
            "type"
          ],
          "line": 2219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 2218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dqopt->info[type].dqi_dirty_list"
          ],
          "line": 2217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fmt->qf_ops->check_quota_file",
          "args": [
            "sb",
            "type"
          ],
          "line": 2211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "igrab",
          "args": [
            "inode"
          ],
          "line": 2207
        },
        "resolved": true,
        "details": {
          "function_name": "igrab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1173-1189",
          "snippet": "struct inode *igrab(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tif (!(inode->i_state & (I_FREEING|I_WILL_FREE))) {\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t} else {\n\t\tspin_unlock(&inode->i_lock);\n\t\t/*\n\t\t * Handle the case where s_op->clear_inode is not been\n\t\t * called yet, and somebody is calling igrab\n\t\t * while the inode is getting freed.\n\t\t */\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstruct inode *igrab(struct inode *inode)\n{\n\tspin_lock(&inode->i_lock);\n\tif (!(inode->i_state & (I_FREEING|I_WILL_FREE))) {\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t} else {\n\t\tspin_unlock(&inode->i_lock);\n\t\t/*\n\t\t * Handle the case where s_op->clear_inode is not been\n\t\t * called yet, and somebody is calling igrab\n\t\t * while the inode is getting freed.\n\t\t */\n\t\tinode = NULL;\n\t}\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__dquot_drop",
          "args": [
            "inode"
          ],
          "line": 2203
        },
        "resolved": true,
        "details": {
          "function_name": "__dquot_drop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1473-1485",
          "snippet": "static void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 2198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&inode->i_mutex"
          ],
          "line": 2194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "type"
          ],
          "line": 2185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "invalidate_bdev",
          "args": [
            "sb->s_bdev"
          ],
          "line": 2182
        },
        "resolved": true,
        "details": {
          "function_name": "invalidate_bdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "77-91",
          "snippet": "void invalidate_bdev(struct block_device *bdev)\n{\n\tstruct address_space *mapping = bdev->bd_inode->i_mapping;\n\n\tif (mapping->nrpages == 0)\n\t\treturn;\n\n\tinvalidate_bh_lrus();\n\tlru_add_drain_all();\t/* make sure all lru add caches are flushed */\n\tinvalidate_mapping_pages(mapping, 0, -1);\n\t/* 99% of the time, we don't need to flush the cleancache on the bdev.\n\t * But, for the strange corners, lets be cautious\n\t */\n\tcleancache_invalidate_inode(mapping);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nvoid invalidate_bdev(struct block_device *bdev)\n{\n\tstruct address_space *mapping = bdev->bd_inode->i_mapping;\n\n\tif (mapping->nrpages == 0)\n\t\treturn;\n\n\tinvalidate_bh_lrus();\n\tlru_add_drain_all();\t/* make sure all lru add caches are flushed */\n\tinvalidate_mapping_pages(mapping, 0, -1);\n\t/* 99% of the time, we don't need to flush the cleancache on the bdev.\n\t * But, for the strange corners, lets be cautious\n\t */\n\tcleancache_invalidate_inode(mapping);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sync_filesystem",
          "args": [
            "sb"
          ],
          "line": 2181
        },
        "resolved": true,
        "details": {
          "function_name": "sync_filesystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/sync.c",
          "lines": "47-67",
          "snippet": "int sync_filesystem(struct super_block *sb)\n{\n\tint ret;\n\n\t/*\n\t * We need to be protected against the filesystem going from\n\t * r/o to r/w or vice versa.\n\t */\n\tWARN_ON(!rwsem_is_locked(&sb->s_umount));\n\n\t/*\n\t * No point in syncing out anything if the filesystem is read-only.\n\t */\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn 0;\n\n\tret = __sync_filesystem(sb, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\treturn __sync_filesystem(sb, 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/backing-dev.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/linkage.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/writeback.h>",
            "#include <linux/sched.h>",
            "#include <linux/namei.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/backing-dev.h>\n#include <linux/quotaops.h>\n#include <linux/pagemap.h>\n#include <linux/linkage.h>\n#include <linux/syscalls.h>\n#include <linux/writeback.h>\n#include <linux/sched.h>\n#include <linux/namei.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n\nint sync_filesystem(struct super_block *sb)\n{\n\tint ret;\n\n\t/*\n\t * We need to be protected against the filesystem going from\n\t * r/o to r/w or vice versa.\n\t */\n\tWARN_ON(!rwsem_is_locked(&sb->s_umount));\n\n\t/*\n\t * No point in syncing out anything if the filesystem is read-only.\n\t */\n\tif (sb->s_flags & MS_RDONLY)\n\t\treturn 0;\n\n\tret = __sync_filesystem(sb, 0);\n\tif (ret < 0)\n\t\treturn ret;\n\treturn __sync_filesystem(sb, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_RDONLY",
          "args": [
            "inode"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 2156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_quota_format",
          "args": [
            "format_id"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "find_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "185-214",
          "snippet": "static struct quota_format_type *find_quota_format(int id)\n{\n\tstruct quota_format_type *actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t     actqf = actqf->qf_next)\n\t\t;\n\tif (!actqf || !try_module_get(actqf->qf_owner)) {\n\t\tint qm;\n\n\t\tspin_unlock(&dq_list_lock);\n\t\t\n\t\tfor (qm = 0; module_names[qm].qm_fmt_id &&\n\t\t\t     module_names[qm].qm_fmt_id != id; qm++)\n\t\t\t;\n\t\tif (!module_names[qm].qm_fmt_id ||\n\t\t    request_module(module_names[qm].qm_mod_name))\n\t\t\treturn NULL;\n\n\t\tspin_lock(&dq_list_lock);\n\t\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t\t     actqf = actqf->qf_next)\n\t\t\t;\n\t\tif (actqf && !try_module_get(actqf->qf_owner))\n\t\t\tactqf = NULL;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn actqf;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static struct quota_format_type *quota_formats;",
            "static struct quota_module_name module_names[] = INIT_QUOTA_MODULE_NAMES;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\nstatic struct quota_module_name module_names[] = INIT_QUOTA_MODULE_NAMES;\n\nstatic struct quota_format_type *find_quota_format(int id)\n{\n\tstruct quota_format_type *actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t     actqf = actqf->qf_next)\n\t\t;\n\tif (!actqf || !try_module_get(actqf->qf_owner)) {\n\t\tint qm;\n\n\t\tspin_unlock(&dq_list_lock);\n\t\t\n\t\tfor (qm = 0; module_names[qm].qm_fmt_id &&\n\t\t\t     module_names[qm].qm_fmt_id != id; qm++)\n\t\t\t;\n\t\tif (!module_names[qm].qm_fmt_id ||\n\t\t    request_module(module_names[qm].qm_mod_name))\n\t\t\treturn NULL;\n\n\t\tspin_lock(&dq_list_lock);\n\t\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t\t     actqf = actqf->qf_next)\n\t\t\t;\n\t\tif (actqf && !try_module_get(actqf->qf_owner))\n\t\t\tactqf = NULL;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn actqf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int vfs_load_quota_inode(struct inode *inode, int type, int format_id,\n\tunsigned int flags)\n{\n\tstruct quota_format_type *fmt = find_quota_format(format_id);\n\tstruct super_block *sb = inode->i_sb;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint error;\n\tint oldflags = -1;\n\n\tif (!fmt)\n\t\treturn -ESRCH;\n\tif (!S_ISREG(inode->i_mode)) {\n\t\terror = -EACCES;\n\t\tgoto out_fmt;\n\t}\n\tif (IS_RDONLY(inode)) {\n\t\terror = -EROFS;\n\t\tgoto out_fmt;\n\t}\n\tif (!sb->s_op->quota_write || !sb->s_op->quota_read) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\t/* Usage always has to be set... */\n\tif (!(flags & DQUOT_USAGE_ENABLED)) {\n\t\terror = -EINVAL;\n\t\tgoto out_fmt;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* As we bypass the pagecache we must now flush all the\n\t\t * dirty data and invalidate caches so that kernel sees\n\t\t * changes from userspace. It is not enough to just flush\n\t\t * the quota file since if blocksize < pagesize, invalidation\n\t\t * of the cache could fail because of other unrelated dirty\n\t\t * data */\n\t\tsync_filesystem(sb);\n\t\tinvalidate_bdev(sb->s_bdev);\n\t}\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tif (sb_has_quota_loaded(sb, type)) {\n\t\terror = -EBUSY;\n\t\tgoto out_lock;\n\t}\n\n\tif (!(dqopt->flags & DQUOT_QUOTA_SYS_FILE)) {\n\t\t/* We don't want quota and atime on quota files (deadlocks\n\t\t * possible) Also nobody should write to the file - we use\n\t\t * special IO operations which ignore the immutable bit. */\n\t\tmutex_lock(&inode->i_mutex);\n\t\toldflags = inode->i_flags & (S_NOATIME | S_IMMUTABLE |\n\t\t\t\t\t     S_NOQUOTA);\n\t\tinode->i_flags |= S_NOQUOTA | S_NOATIME | S_IMMUTABLE;\n\t\tmutex_unlock(&inode->i_mutex);\n\t\t/*\n\t\t * When S_NOQUOTA is set, remove dquot references as no more\n\t\t * references can be added\n\t\t */\n\t\t__dquot_drop(inode);\n\t}\n\n\terror = -EIO;\n\tdqopt->files[type] = igrab(inode);\n\tif (!dqopt->files[type])\n\t\tgoto out_lock;\n\terror = -EINVAL;\n\tif (!fmt->qf_ops->check_quota_file(sb, type))\n\t\tgoto out_file_init;\n\n\tdqopt->ops[type] = fmt->qf_ops;\n\tdqopt->info[type].dqi_format = fmt;\n\tdqopt->info[type].dqi_fmt_id = format_id;\n\tINIT_LIST_HEAD(&dqopt->info[type].dqi_dirty_list);\n\tmutex_lock(&dqopt->dqio_mutex);\n\terror = dqopt->ops[type]->read_file_info(sb, type);\n\tif (error < 0) {\n\t\tmutex_unlock(&dqopt->dqio_mutex);\n\t\tgoto out_file_init;\n\t}\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tdqopt->info[type].dqi_flags |= DQF_SYS_FILE;\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_state_lock);\n\tdqopt->flags |= dquot_state_flag(flags, type);\n\tspin_unlock(&dq_state_lock);\n\n\tadd_dquot_ref(sb, type);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n\nout_file_init:\n\tdqopt->files[type] = NULL;\n\tiput(inode);\nout_lock:\n\tif (oldflags != -1) {\n\t\tmutex_lock(&inode->i_mutex);\n\t\t/* Set the flags back (in the case of accidental quotaon()\n\t\t * on a wrong file we don't want to mess up the flags) */\n\t\tinode->i_flags &= ~(S_NOATIME | S_NOQUOTA | S_IMMUTABLE);\n\t\tinode->i_flags |= oldflags;\n\t\tmutex_unlock(&inode->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\nout_fmt:\n\tput_quota_format(fmt);\n\n\treturn error; \n}"
  },
  {
    "function_name": "dquot_quota_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "2130-2134",
    "snippet": "int dquot_quota_off(struct super_block *sb, int type)\n{\n\treturn dquot_disable(sb, type,\n\t\t\t     DQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot_disable",
          "args": [
            "sb",
            "type",
            "DQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED"
          ],
          "line": 2132
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_disable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1999-2127",
          "snippet": "int dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_quota_off(struct super_block *sb, int type)\n{\n\treturn dquot_disable(sb, type,\n\t\t\t     DQUOT_USAGE_ENABLED | DQUOT_LIMITS_ENABLED);\n}"
  },
  {
    "function_name": "dquot_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1999-2127",
    "snippet": "int dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "toputinode[cnt]"
          ],
          "line": 2122
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "invalidate_bdev",
          "args": [
            "sb->s_bdev"
          ],
          "line": 2110
        },
        "resolved": true,
        "details": {
          "function_name": "invalidate_bdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "77-91",
          "snippet": "void invalidate_bdev(struct block_device *bdev)\n{\n\tstruct address_space *mapping = bdev->bd_inode->i_mapping;\n\n\tif (mapping->nrpages == 0)\n\t\treturn;\n\n\tinvalidate_bh_lrus();\n\tlru_add_drain_all();\t/* make sure all lru add caches are flushed */\n\tinvalidate_mapping_pages(mapping, 0, -1);\n\t/* 99% of the time, we don't need to flush the cleancache on the bdev.\n\t * But, for the strange corners, lets be cautious\n\t */\n\tcleancache_invalidate_inode(mapping);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nvoid invalidate_bdev(struct block_device *bdev)\n{\n\tstruct address_space *mapping = bdev->bd_inode->i_mapping;\n\n\tif (mapping->nrpages == 0)\n\t\treturn;\n\n\tinvalidate_bh_lrus();\n\tlru_add_drain_all();\t/* make sure all lru add caches are flushed */\n\tinvalidate_mapping_pages(mapping, 0, -1);\n\t/* 99% of the time, we don't need to flush the cleancache on the bdev.\n\t * But, for the strange corners, lets be cautious\n\t */\n\tcleancache_invalidate_inode(mapping);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_inode_dirty_sync",
          "args": [
            "toputinode[cnt]"
          ],
          "line": 2105
        },
        "resolved": true,
        "details": {
          "function_name": "nilfs_mark_inode_dirty_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nilfs2/nilfs.h",
          "lines": "291-294",
          "snippet": "static inline int nilfs_mark_inode_dirty_sync(struct inode *inode)\n{\n\treturn __nilfs_mark_inode_dirty(inode, I_DIRTY_SYNC);\n}",
          "includes": [
            "#include \"bmap.h\"",
            "#include \"the_nilfs.h\"",
            "#include <linux/nilfs2_fs.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bmap.h\"\n#include \"the_nilfs.h\"\n#include <linux/nilfs2_fs.h>\n#include <linux/blkdev.h>\n#include <linux/spinlock.h>\n#include <linux/buffer_head.h>\n#include <linux/kernel.h>\n\nstatic inline int nilfs_mark_inode_dirty_sync(struct inode *inode)\n{\n\treturn __nilfs_mark_inode_dirty(inode, I_DIRTY_SYNC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&toputinode[cnt]->i_mutex"
          ],
          "line": 2104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages",
          "args": [
            "&toputinode[cnt]->i_data",
            "0"
          ],
          "line": 2102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&toputinode[cnt]->i_mutex"
          ],
          "line": 2099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sync_blockdev",
          "args": [
            "sb->s_bdev"
          ],
          "line": 2087
        },
        "resolved": true,
        "details": {
          "function_name": "sync_blockdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "174-177",
          "snippet": "int sync_blockdev(struct block_device *bdev)\n{\n\treturn __sync_blockdev(bdev, 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nint sync_blockdev(struct block_device *bdev)\n{\n\treturn __sync_blockdev(bdev, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_op->sync_fs",
          "args": [
            "sb",
            "1"
          ],
          "line": 2086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_quota_format",
          "args": [
            "dqopt->info[cnt].dqi_format"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "put_quota_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "216-219",
          "snippet": "static void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[cnt]->free_file_info",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->dq_op->write_info",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info_dirty",
          "args": [
            "&dqopt->info[cnt]"
          ],
          "line": 2063
        },
        "resolved": true,
        "details": {
          "function_name": "mark_fsinfo_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fatent.c",
          "lines": "311-319",
          "snippet": "static void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/msdos_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/blkdev.h>\n#include <linux/msdos_fs.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "invalidate_dquots",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2058
        },
        "resolved": true,
        "details": {
          "function_name": "invalidate_dquots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "513-558",
          "snippet": "static void invalidate_dquots(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot, *tmp;\n\nrestart:\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry_safe(dquot, tmp, &inuse_list, dq_inuse) {\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\tif (dquot->dq_id.type != type)\n\t\t\tcontinue;\n\t\t/* Wait for dquot users */\n\t\tif (atomic_read(&dquot->dq_count)) {\n\t\t\tDEFINE_WAIT(wait);\n\n\t\t\tdqgrab(dquot);\n\t\t\tprepare_to_wait(&dquot->dq_wait_unused, &wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\t/* Once dqput() wakes us up, we know it's time to free\n\t\t\t * the dquot.\n\t\t\t * IMPORTANT: we rely on the fact that there is always\n\t\t\t * at most one process waiting for dquot to free.\n\t\t\t * Otherwise dq_count would be > 1 and we would never\n\t\t\t * wake up.\n\t\t\t */\n\t\t\tif (atomic_read(&dquot->dq_count) > 1)\n\t\t\t\tschedule();\n\t\t\tfinish_wait(&dquot->dq_wait_unused, &wait);\n\t\t\tdqput(dquot);\n\t\t\t/* At this moment dquot() need not exist (it could be\n\t\t\t * reclaimed by prune_dqcache(). Hence we must\n\t\t\t * restart. */\n\t\t\tgoto restart;\n\t\t}\n\t\t/*\n\t\t * Quota now has no users and it has been written on last\n\t\t * dqput()\n\t\t */\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t}\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static LIST_HEAD(inuse_list);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void invalidate_dquots(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot, *tmp;\n\nrestart:\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry_safe(dquot, tmp, &inuse_list, dq_inuse) {\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\tif (dquot->dq_id.type != type)\n\t\t\tcontinue;\n\t\t/* Wait for dquot users */\n\t\tif (atomic_read(&dquot->dq_count)) {\n\t\t\tDEFINE_WAIT(wait);\n\n\t\t\tdqgrab(dquot);\n\t\t\tprepare_to_wait(&dquot->dq_wait_unused, &wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\t/* Once dqput() wakes us up, we know it's time to free\n\t\t\t * the dquot.\n\t\t\t * IMPORTANT: we rely on the fact that there is always\n\t\t\t * at most one process waiting for dquot to free.\n\t\t\t * Otherwise dq_count would be > 1 and we would never\n\t\t\t * wake up.\n\t\t\t */\n\t\t\tif (atomic_read(&dquot->dq_count) > 1)\n\t\t\t\tschedule();\n\t\t\tfinish_wait(&dquot->dq_wait_unused, &wait);\n\t\t\tdqput(dquot);\n\t\t\t/* At this moment dquot() need not exist (it could be\n\t\t\t * reclaimed by prune_dqcache(). Hence we must\n\t\t\t * restart. */\n\t\t\tgoto restart;\n\t\t}\n\t\t/*\n\t\t * Quota now has no users and it has been written on last\n\t\t * dqput()\n\t\t */\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t}\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "drop_dquot_ref",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2057
        },
        "resolved": true,
        "details": {
          "function_name": "drop_dquot_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1049-1058",
          "snippet": "static void drop_dquot_ref(struct super_block *sb, int type)\n{\n\tLIST_HEAD(tofree_head);\n\n\tif (sb->dq_op) {\n\t\tremove_dquot_ref(sb, type, &tofree_head);\n\t\tsynchronize_srcu(&dquot_srcu);\n\t\tput_dquot_list(&tofree_head);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void drop_dquot_ref(struct super_block *sb, int type)\n{\n\tLIST_HEAD(tofree_head);\n\n\tif (sb->dq_op) {\n\t\tremove_dquot_ref(sb, type, &tofree_head);\n\t\tsynchronize_srcu(&dquot_srcu);\n\t\tput_dquot_list(&tofree_head);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2049
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "DQUOT_SUSPENDED",
            "cnt"
          ],
          "line": 2042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_suspended",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "flags",
            "cnt"
          ],
          "line": 2038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 2037
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_state_flag",
          "args": [
            "DQUOT_SUSPENDED",
            "cnt"
          ],
          "line": 2034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_loaded",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 2028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_any_quota_loaded",
          "args": [
            "sb"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 2002
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_disable(struct super_block *sb, int type, unsigned int flags)\n{\n\tint cnt, ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tstruct inode *toputinode[MAXQUOTAS];\n\n\t/* Cannot turn off usage accounting without turning off limits, or\n\t * suspend quotas and simultaneously turn quotas off. */\n\tif ((flags & DQUOT_USAGE_ENABLED && !(flags & DQUOT_LIMITS_ENABLED))\n\t    || (flags & DQUOT_SUSPENDED && flags & (DQUOT_LIMITS_ENABLED |\n\t    DQUOT_USAGE_ENABLED)))\n\t\treturn -EINVAL;\n\n\t/* We need to serialize quota_off() for device */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\n\t/*\n\t * Skip everything if there's nothing to do. We have to do this because\n\t * sometimes we are called when fill_super() failed and calling\n\t * sync_fs() in such cases does no good.\n\t */\n\tif (!sb_any_quota_loaded(sb)) {\n\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\treturn 0;\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\ttoputinode[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tcontinue;\n\n\t\tif (flags & DQUOT_SUSPENDED) {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags |=\n\t\t\t\tdquot_state_flag(DQUOT_SUSPENDED, cnt);\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t} else {\n\t\t\tspin_lock(&dq_state_lock);\n\t\t\tdqopt->flags &= ~dquot_state_flag(flags, cnt);\n\t\t\t/* Turning off suspended quotas? */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt) &&\n\t\t\t    sb_has_quota_suspended(sb, cnt)) {\n\t\t\t\tdqopt->flags &=\t~dquot_state_flag(\n\t\t\t\t\t\t\tDQUOT_SUSPENDED, cnt);\n\t\t\t\tspin_unlock(&dq_state_lock);\n\t\t\t\tiput(dqopt->files[cnt]);\n\t\t\t\tdqopt->files[cnt] = NULL;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tspin_unlock(&dq_state_lock);\n\t\t}\n\n\t\t/* We still have to keep quota loaded? */\n\t\tif (sb_has_quota_loaded(sb, cnt) && !(flags & DQUOT_SUSPENDED))\n\t\t\tcontinue;\n\n\t\t/* Note: these are blocking operations */\n\t\tdrop_dquot_ref(sb, cnt);\n\t\tinvalidate_dquots(sb, cnt);\n\t\t/*\n\t\t * Now all dquots should be invalidated, all writes done so we\n\t\t * should be only users of the info. No locks needed.\n\t\t */\n\t\tif (info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\t\tif (dqopt->ops[cnt]->free_file_info)\n\t\t\tdqopt->ops[cnt]->free_file_info(sb, cnt);\n\t\tput_quota_format(dqopt->info[cnt].dqi_format);\n\n\t\ttoputinode[cnt] = dqopt->files[cnt];\n\t\tif (!sb_has_quota_loaded(sb, cnt))\n\t\t\tdqopt->files[cnt] = NULL;\n\t\tdqopt->info[cnt].dqi_flags = 0;\n\t\tdqopt->info[cnt].dqi_igrace = 0;\n\t\tdqopt->info[cnt].dqi_bgrace = 0;\n\t\tdqopt->ops[cnt] = NULL;\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\t/* Skip syncing and setting flags if quota files are hidden */\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\tgoto put_inodes;\n\n\t/* Sync the superblock so that buffers with quota data are written to\n\t * disk (and so userspace sees correct data afterwards). */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\t/* Now the quota files are just ordinary files and we can set the\n\t * inode flags back. Moreover we discard the pagecache so that\n\t * userspace sees the writes we did bypassing the pagecache. We\n\t * must also discard the blockdev buffers so that we see the\n\t * changes done by userspace on the next quotaon() */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\tmutex_lock(&dqopt->dqonoff_mutex);\n\t\t\t/* If quota was reenabled in the meantime, we have\n\t\t\t * nothing to do */\n\t\t\tif (!sb_has_quota_loaded(sb, cnt)) {\n\t\t\t\tmutex_lock(&toputinode[cnt]->i_mutex);\n\t\t\t\ttoputinode[cnt]->i_flags &= ~(S_IMMUTABLE |\n\t\t\t\t  S_NOATIME | S_NOQUOTA);\n\t\t\t\ttruncate_inode_pages(&toputinode[cnt]->i_data,\n\t\t\t\t\t\t     0);\n\t\t\t\tmutex_unlock(&toputinode[cnt]->i_mutex);\n\t\t\t\tmark_inode_dirty_sync(toputinode[cnt]);\n\t\t\t}\n\t\t\tmutex_unlock(&dqopt->dqonoff_mutex);\n\t\t}\n\tif (sb->s_bdev)\n\t\tinvalidate_bdev(sb->s_bdev);\nput_inodes:\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (toputinode[cnt]) {\n\t\t\t/* On remount RO, we keep the inode pointer so that we\n\t\t\t * can reenable quota on the subsequent remount RW. We\n\t\t\t * have to check 'flags' variable and not use sb_has_\n\t\t\t * function because another quotaon / quotaoff could\n\t\t\t * change global state before we got here. We refuse\n\t\t\t * to suspend quotas when there is pending delete on\n\t\t\t * the quota file... */\n\t\t\tif (!(flags & DQUOT_SUSPENDED))\n\t\t\t\tiput(toputinode[cnt]);\n\t\t\telse if (!toputinode[cnt]->i_nlink)\n\t\t\t\tret = -EBUSY;\n\t\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_file_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1985-1993",
    "snippet": "int dquot_file_open(struct inode *inode, struct file *file)\n{\n\tint error;\n\n\terror = generic_file_open(inode, file);\n\tif (!error && (file->f_mode & FMODE_WRITE))\n\t\tdquot_initialize(inode);\n\treturn error;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot_initialize",
          "args": [
            "inode"
          ],
          "line": 1991
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1459-1462",
          "snippet": "void dquot_initialize(struct inode *inode)\n{\n\t__dquot_initialize(inode, -1);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid dquot_initialize(struct inode *inode)\n{\n\t__dquot_initialize(inode, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "generic_file_open",
          "args": [
            "inode",
            "file"
          ],
          "line": 1989
        },
        "resolved": true,
        "details": {
          "function_name": "generic_file_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/open.c",
          "lines": "1121-1126",
          "snippet": "int generic_file_open(struct inode * inode, struct file * filp)\n{\n\tif (!(filp->f_flags & O_LARGEFILE) && i_size_read(inode) > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/compat.h>",
            "#include <linux/dnotify.h>",
            "#include <linux/ima.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/falloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mount.h>",
            "#include <linux/security.h>",
            "#include <linux/securebits.h>",
            "#include <linux/capability.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/namei.h>",
            "#include <linux/tty.h>",
            "#include <linux/module.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/compat.h>\n#include <linux/dnotify.h>\n#include <linux/ima.h>\n#include <linux/fs_struct.h>\n#include <linux/falloc.h>\n#include <linux/audit.h>\n#include <linux/rcupdate.h>\n#include <linux/syscalls.h>\n#include <linux/pagemap.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <asm/uaccess.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mount.h>\n#include <linux/security.h>\n#include <linux/securebits.h>\n#include <linux/capability.h>\n#include <linux/backing-dev.h>\n#include <linux/namei.h>\n#include <linux/tty.h>\n#include <linux/module.h>\n#include <linux/fsnotify.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n\nint generic_file_open(struct inode * inode, struct file * filp)\n{\n\tif (!(filp->f_flags & O_LARGEFILE) && i_size_read(inode) > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nint dquot_file_open(struct inode *inode, struct file *file)\n{\n\tint error;\n\n\terror = generic_file_open(inode, file);\n\tif (!error && (file->f_mode & FMODE_WRITE))\n\t\tdquot_initialize(inode);\n\treturn error;\n}"
  },
  {
    "function_name": "dquot_commit_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1956-1965",
    "snippet": "int dquot_commit_info(struct super_block *sb, int type)\n{\n\tint ret;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tmutex_lock(&dqopt->dqio_mutex);\n\tret = dqopt->ops[type]->write_file_info(sb, type);\n\tmutex_unlock(&dqopt->dqio_mutex);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 1963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqopt->ops[type]->write_file_info",
          "args": [
            "sb",
            "type"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 1961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_commit_info(struct super_block *sb, int type)\n{\n\tint ret;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\n\tmutex_lock(&dqopt->dqio_mutex);\n\tret = dqopt->ops[type]->write_file_info(sb, type);\n\tmutex_unlock(&dqopt->dqio_mutex);\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_transfer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1933-1950",
    "snippet": "int dquot_transfer(struct inode *inode, struct iattr *iattr)\n{\n\tstruct dquot *transfer_to[MAXQUOTAS] = {};\n\tstruct super_block *sb = inode->i_sb;\n\tint ret;\n\n\tif (!dquot_active(inode))\n\t\treturn 0;\n\n\tif (iattr->ia_valid & ATTR_UID && !uid_eq(iattr->ia_uid, inode->i_uid))\n\t\ttransfer_to[USRQUOTA] = dqget(sb, make_kqid_uid(iattr->ia_uid));\n\tif (iattr->ia_valid & ATTR_GID && !gid_eq(iattr->ia_gid, inode->i_gid))\n\t\ttransfer_to[GRPQUOTA] = dqget(sb, make_kqid_gid(iattr->ia_gid));\n\n\tret = __dquot_transfer(inode, transfer_to);\n\tdqput_all(transfer_to);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput_all",
          "args": [
            "transfer_to"
          ],
          "line": 1948
        },
        "resolved": true,
        "details": {
          "function_name": "dqput_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "376-382",
          "snippet": "static inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__dquot_transfer",
          "args": [
            "inode",
            "transfer_to"
          ],
          "line": 1947
        },
        "resolved": true,
        "details": {
          "function_name": "__dquot_transfer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1834-1927",
          "snippet": "int __dquot_transfer(struct inode *inode, struct dquot **transfer_to)\n{\n\tqsize_t space, cur_space;\n\tqsize_t rsv_space = 0;\n\tstruct dquot *transfer_from[MAXQUOTAS] = {};\n\tint cnt, ret = 0;\n\tchar is_valid[MAXQUOTAS] = {};\n\tstruct dquot_warn warn_to[MAXQUOTAS];\n\tstruct dquot_warn warn_from_inodes[MAXQUOTAS];\n\tstruct dquot_warn warn_from_space[MAXQUOTAS];\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\t/* Initialize the arrays */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\twarn_to[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_inodes[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_space[cnt].w_type = QUOTA_NL_NOWARN;\n\t}\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode)) {\t/* File without quota accounting? */\n\t\tspin_unlock(&dq_data_lock);\n\t\treturn 0;\n\t}\n\tcur_space = inode_get_bytes(inode);\n\trsv_space = inode_get_rsv_space(inode);\n\tspace = cur_space + rsv_space;\n\t/* Build the transfer_from list and check the limits */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\t/*\n\t\t * Skip changes for same uid or gid or for turned off quota-type.\n\t\t */\n\t\tif (!transfer_to[cnt])\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(inode->i_sb, cnt))\n\t\t\tcontinue;\n\t\tis_valid[cnt] = 1;\n\t\ttransfer_from[cnt] = i_dquot(inode)[cnt];\n\t\tret = check_idq(transfer_to[cnt], 1, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t\tret = check_bdq(transfer_to[cnt], space, 0, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t}\n\n\t/*\n\t * Finally perform the needed transfer from transfer_from to transfer_to\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!is_valid[cnt])\n\t\t\tcontinue;\n\t\t/* Due to IO error we might not have transfer_from[] structure */\n\t\tif (transfer_from[cnt]) {\n\t\t\tint wtype;\n\t\t\twtype = info_idq_free(transfer_from[cnt], 1);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_inodes[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\twtype = info_bdq_free(transfer_from[cnt], space);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_space[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\tdquot_decr_inodes(transfer_from[cnt], 1);\n\t\t\tdquot_decr_space(transfer_from[cnt], cur_space);\n\t\t\tdquot_free_reserved_space(transfer_from[cnt],\n\t\t\t\t\t\t  rsv_space);\n\t\t}\n\n\t\tdquot_incr_inodes(transfer_to[cnt], 1);\n\t\tdquot_incr_space(transfer_to[cnt], cur_space);\n\t\tdquot_resv_space(transfer_to[cnt], rsv_space);\n\n\t\ti_dquot(inode)[cnt] = transfer_to[cnt];\n\t}\n\tspin_unlock(&dq_data_lock);\n\n\tmark_all_dquot_dirty(transfer_from);\n\tmark_all_dquot_dirty(transfer_to);\n\tflush_warnings(warn_to);\n\tflush_warnings(warn_from_inodes);\n\tflush_warnings(warn_from_space);\n\t/* Pass back references to put */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (is_valid[cnt])\n\t\t\ttransfer_to[cnt] = transfer_from[cnt];\n\treturn 0;\nover_quota:\n\tspin_unlock(&dq_data_lock);\n\tflush_warnings(warn_to);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint __dquot_transfer(struct inode *inode, struct dquot **transfer_to)\n{\n\tqsize_t space, cur_space;\n\tqsize_t rsv_space = 0;\n\tstruct dquot *transfer_from[MAXQUOTAS] = {};\n\tint cnt, ret = 0;\n\tchar is_valid[MAXQUOTAS] = {};\n\tstruct dquot_warn warn_to[MAXQUOTAS];\n\tstruct dquot_warn warn_from_inodes[MAXQUOTAS];\n\tstruct dquot_warn warn_from_space[MAXQUOTAS];\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\t/* Initialize the arrays */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\twarn_to[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_inodes[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_space[cnt].w_type = QUOTA_NL_NOWARN;\n\t}\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode)) {\t/* File without quota accounting? */\n\t\tspin_unlock(&dq_data_lock);\n\t\treturn 0;\n\t}\n\tcur_space = inode_get_bytes(inode);\n\trsv_space = inode_get_rsv_space(inode);\n\tspace = cur_space + rsv_space;\n\t/* Build the transfer_from list and check the limits */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\t/*\n\t\t * Skip changes for same uid or gid or for turned off quota-type.\n\t\t */\n\t\tif (!transfer_to[cnt])\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(inode->i_sb, cnt))\n\t\t\tcontinue;\n\t\tis_valid[cnt] = 1;\n\t\ttransfer_from[cnt] = i_dquot(inode)[cnt];\n\t\tret = check_idq(transfer_to[cnt], 1, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t\tret = check_bdq(transfer_to[cnt], space, 0, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t}\n\n\t/*\n\t * Finally perform the needed transfer from transfer_from to transfer_to\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!is_valid[cnt])\n\t\t\tcontinue;\n\t\t/* Due to IO error we might not have transfer_from[] structure */\n\t\tif (transfer_from[cnt]) {\n\t\t\tint wtype;\n\t\t\twtype = info_idq_free(transfer_from[cnt], 1);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_inodes[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\twtype = info_bdq_free(transfer_from[cnt], space);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_space[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\tdquot_decr_inodes(transfer_from[cnt], 1);\n\t\t\tdquot_decr_space(transfer_from[cnt], cur_space);\n\t\t\tdquot_free_reserved_space(transfer_from[cnt],\n\t\t\t\t\t\t  rsv_space);\n\t\t}\n\n\t\tdquot_incr_inodes(transfer_to[cnt], 1);\n\t\tdquot_incr_space(transfer_to[cnt], cur_space);\n\t\tdquot_resv_space(transfer_to[cnt], rsv_space);\n\n\t\ti_dquot(inode)[cnt] = transfer_to[cnt];\n\t}\n\tspin_unlock(&dq_data_lock);\n\n\tmark_all_dquot_dirty(transfer_from);\n\tmark_all_dquot_dirty(transfer_to);\n\tflush_warnings(warn_to);\n\tflush_warnings(warn_from_inodes);\n\tflush_warnings(warn_from_space);\n\t/* Pass back references to put */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (is_valid[cnt])\n\t\t\ttransfer_to[cnt] = transfer_from[cnt];\n\treturn 0;\nover_quota:\n\tspin_unlock(&dq_data_lock);\n\tflush_warnings(warn_to);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqget",
          "args": [
            "sb",
            "make_kqid_gid(iattr->ia_gid)"
          ],
          "line": 1945
        },
        "resolved": true,
        "details": {
          "function_name": "dqget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "832-893",
          "snippet": "struct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static LIST_HEAD(inuse_list);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid_gid",
          "args": [
            "iattr->ia_gid"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "iattr->ia_gid",
            "inode->i_gid"
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kqid_uid",
          "args": [
            "iattr->ia_uid"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "iattr->ia_uid",
            "inode->i_uid"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1939
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nint dquot_transfer(struct inode *inode, struct iattr *iattr)\n{\n\tstruct dquot *transfer_to[MAXQUOTAS] = {};\n\tstruct super_block *sb = inode->i_sb;\n\tint ret;\n\n\tif (!dquot_active(inode))\n\t\treturn 0;\n\n\tif (iattr->ia_valid & ATTR_UID && !uid_eq(iattr->ia_uid, inode->i_uid))\n\t\ttransfer_to[USRQUOTA] = dqget(sb, make_kqid_uid(iattr->ia_uid));\n\tif (iattr->ia_valid & ATTR_GID && !gid_eq(iattr->ia_gid, inode->i_gid))\n\t\ttransfer_to[GRPQUOTA] = dqget(sb, make_kqid_gid(iattr->ia_gid));\n\n\tret = __dquot_transfer(inode, transfer_to);\n\tdqput_all(transfer_to);\n\treturn ret;\n}"
  },
  {
    "function_name": "__dquot_transfer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1834-1927",
    "snippet": "int __dquot_transfer(struct inode *inode, struct dquot **transfer_to)\n{\n\tqsize_t space, cur_space;\n\tqsize_t rsv_space = 0;\n\tstruct dquot *transfer_from[MAXQUOTAS] = {};\n\tint cnt, ret = 0;\n\tchar is_valid[MAXQUOTAS] = {};\n\tstruct dquot_warn warn_to[MAXQUOTAS];\n\tstruct dquot_warn warn_from_inodes[MAXQUOTAS];\n\tstruct dquot_warn warn_from_space[MAXQUOTAS];\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\t/* Initialize the arrays */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\twarn_to[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_inodes[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_space[cnt].w_type = QUOTA_NL_NOWARN;\n\t}\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode)) {\t/* File without quota accounting? */\n\t\tspin_unlock(&dq_data_lock);\n\t\treturn 0;\n\t}\n\tcur_space = inode_get_bytes(inode);\n\trsv_space = inode_get_rsv_space(inode);\n\tspace = cur_space + rsv_space;\n\t/* Build the transfer_from list and check the limits */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\t/*\n\t\t * Skip changes for same uid or gid or for turned off quota-type.\n\t\t */\n\t\tif (!transfer_to[cnt])\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(inode->i_sb, cnt))\n\t\t\tcontinue;\n\t\tis_valid[cnt] = 1;\n\t\ttransfer_from[cnt] = i_dquot(inode)[cnt];\n\t\tret = check_idq(transfer_to[cnt], 1, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t\tret = check_bdq(transfer_to[cnt], space, 0, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t}\n\n\t/*\n\t * Finally perform the needed transfer from transfer_from to transfer_to\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!is_valid[cnt])\n\t\t\tcontinue;\n\t\t/* Due to IO error we might not have transfer_from[] structure */\n\t\tif (transfer_from[cnt]) {\n\t\t\tint wtype;\n\t\t\twtype = info_idq_free(transfer_from[cnt], 1);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_inodes[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\twtype = info_bdq_free(transfer_from[cnt], space);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_space[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\tdquot_decr_inodes(transfer_from[cnt], 1);\n\t\t\tdquot_decr_space(transfer_from[cnt], cur_space);\n\t\t\tdquot_free_reserved_space(transfer_from[cnt],\n\t\t\t\t\t\t  rsv_space);\n\t\t}\n\n\t\tdquot_incr_inodes(transfer_to[cnt], 1);\n\t\tdquot_incr_space(transfer_to[cnt], cur_space);\n\t\tdquot_resv_space(transfer_to[cnt], rsv_space);\n\n\t\ti_dquot(inode)[cnt] = transfer_to[cnt];\n\t}\n\tspin_unlock(&dq_data_lock);\n\n\tmark_all_dquot_dirty(transfer_from);\n\tmark_all_dquot_dirty(transfer_to);\n\tflush_warnings(warn_to);\n\tflush_warnings(warn_from_inodes);\n\tflush_warnings(warn_from_space);\n\t/* Pass back references to put */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (is_valid[cnt])\n\t\t\ttransfer_to[cnt] = transfer_from[cnt];\n\treturn 0;\nover_quota:\n\tspin_unlock(&dq_data_lock);\n\tflush_warnings(warn_to);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_warnings",
          "args": [
            "warn_to"
          ],
          "line": 1925
        },
        "resolved": true,
        "details": {
          "function_name": "flush_warnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1230-1243",
          "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1924
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "transfer_to"
          ],
          "line": 1914
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1909
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_resv_space",
          "args": [
            "transfer_to[cnt]",
            "rsv_space"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_resv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1070-1073",
          "snippet": "static inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_incr_space",
          "args": [
            "transfer_to[cnt]",
            "cur_space"
          ],
          "line": 1906
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_incr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1065-1068",
          "snippet": "static inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_incr_inodes",
          "args": [
            "transfer_to[cnt]",
            "1"
          ],
          "line": 1905
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_incr_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1060-1063",
          "snippet": "static inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_free_reserved_space",
          "args": [
            "transfer_from[cnt]",
            "rsv_space"
          ],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_free_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1096-1105",
          "snippet": "static inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_decr_space",
          "args": [
            "transfer_from[cnt]",
            "cur_space"
          ],
          "line": 1900
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_decr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1119-1129",
          "snippet": "static void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_decr_inodes",
          "args": [
            "transfer_from[cnt]",
            "1"
          ],
          "line": 1899
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_decr_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1107-1117",
          "snippet": "static void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_warning",
          "args": [
            "&warn_from_space[cnt]",
            "transfer_from[cnt]",
            "wtype"
          ],
          "line": 1897
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1215-1223",
          "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info_bdq_free",
          "args": [
            "transfer_from[cnt]",
            "space"
          ],
          "line": 1895
        },
        "resolved": true,
        "details": {
          "function_name": "info_bdq_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1360-1372",
          "snippet": "static int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info_idq_free",
          "args": [
            "transfer_from[cnt]",
            "1"
          ],
          "line": 1891
        },
        "resolved": true,
        "details": {
          "function_name": "info_idq_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1342-1358",
          "snippet": "static int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_bdq",
          "args": [
            "transfer_to[cnt]",
            "space",
            "0",
            "&warn_to[cnt]"
          ],
          "line": 1877
        },
        "resolved": true,
        "details": {
          "function_name": "check_bdq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1292-1340",
          "snippet": "static int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_idq",
          "args": [
            "transfer_to[cnt]",
            "1",
            "&warn_to[cnt]"
          ],
          "line": 1874
        },
        "resolved": true,
        "details": {
          "function_name": "check_idq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1255-1289",
          "snippet": "static int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "inode->i_sb",
            "cnt"
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_get_rsv_space",
          "args": [
            "inode"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "inode_get_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1557-1567",
          "snippet": "static qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_get_bytes",
          "args": [
            "inode"
          ],
          "line": 1859
        },
        "resolved": true,
        "details": {
          "function_name": "inode_get_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "491-499",
          "snippet": "loff_t inode_get_bytes(struct inode *inode)\n{\n\tloff_t ret;\n\n\tspin_lock(&inode->i_lock);\n\tret = (((loff_t)inode->i_blocks) << 9) + inode->i_bytes;\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nloff_t inode_get_bytes(struct inode *inode)\n{\n\tloff_t ret;\n\n\tspin_lock(&inode->i_lock);\n\tret = (((loff_t)inode->i_blocks) << 9) + inode->i_bytes;\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint __dquot_transfer(struct inode *inode, struct dquot **transfer_to)\n{\n\tqsize_t space, cur_space;\n\tqsize_t rsv_space = 0;\n\tstruct dquot *transfer_from[MAXQUOTAS] = {};\n\tint cnt, ret = 0;\n\tchar is_valid[MAXQUOTAS] = {};\n\tstruct dquot_warn warn_to[MAXQUOTAS];\n\tstruct dquot_warn warn_from_inodes[MAXQUOTAS];\n\tstruct dquot_warn warn_from_space[MAXQUOTAS];\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\t/* Initialize the arrays */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\twarn_to[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_inodes[cnt].w_type = QUOTA_NL_NOWARN;\n\t\twarn_from_space[cnt].w_type = QUOTA_NL_NOWARN;\n\t}\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode)) {\t/* File without quota accounting? */\n\t\tspin_unlock(&dq_data_lock);\n\t\treturn 0;\n\t}\n\tcur_space = inode_get_bytes(inode);\n\trsv_space = inode_get_rsv_space(inode);\n\tspace = cur_space + rsv_space;\n\t/* Build the transfer_from list and check the limits */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\t/*\n\t\t * Skip changes for same uid or gid or for turned off quota-type.\n\t\t */\n\t\tif (!transfer_to[cnt])\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(inode->i_sb, cnt))\n\t\t\tcontinue;\n\t\tis_valid[cnt] = 1;\n\t\ttransfer_from[cnt] = i_dquot(inode)[cnt];\n\t\tret = check_idq(transfer_to[cnt], 1, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t\tret = check_bdq(transfer_to[cnt], space, 0, &warn_to[cnt]);\n\t\tif (ret)\n\t\t\tgoto over_quota;\n\t}\n\n\t/*\n\t * Finally perform the needed transfer from transfer_from to transfer_to\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!is_valid[cnt])\n\t\t\tcontinue;\n\t\t/* Due to IO error we might not have transfer_from[] structure */\n\t\tif (transfer_from[cnt]) {\n\t\t\tint wtype;\n\t\t\twtype = info_idq_free(transfer_from[cnt], 1);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_inodes[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\twtype = info_bdq_free(transfer_from[cnt], space);\n\t\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\t\tprepare_warning(&warn_from_space[cnt],\n\t\t\t\t\t\ttransfer_from[cnt], wtype);\n\t\t\tdquot_decr_inodes(transfer_from[cnt], 1);\n\t\t\tdquot_decr_space(transfer_from[cnt], cur_space);\n\t\t\tdquot_free_reserved_space(transfer_from[cnt],\n\t\t\t\t\t\t  rsv_space);\n\t\t}\n\n\t\tdquot_incr_inodes(transfer_to[cnt], 1);\n\t\tdquot_incr_space(transfer_to[cnt], cur_space);\n\t\tdquot_resv_space(transfer_to[cnt], rsv_space);\n\n\t\ti_dquot(inode)[cnt] = transfer_to[cnt];\n\t}\n\tspin_unlock(&dq_data_lock);\n\n\tmark_all_dquot_dirty(transfer_from);\n\tmark_all_dquot_dirty(transfer_to);\n\tflush_warnings(warn_to);\n\tflush_warnings(warn_from_inodes);\n\tflush_warnings(warn_from_space);\n\t/* Pass back references to put */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (is_valid[cnt])\n\t\t\ttransfer_to[cnt] = transfer_from[cnt];\n\treturn 0;\nover_quota:\n\tspin_unlock(&dq_data_lock);\n\tflush_warnings(warn_to);\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_free_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1792-1819",
    "snippet": "void dquot_free_inode(struct inode *inode)\n{\n\tunsigned int cnt;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot * const *dquots = i_dquot(inode);\n\tint index;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tint wtype;\n\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\twtype = info_idq_free(dquots[cnt], 1);\n\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\tprepare_warning(&warn[cnt], dquots[cnt], wtype);\n\t\tdquot_decr_inodes(dquots[cnt], 1);\n\t}\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(dquots);\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_warnings",
          "args": [
            "warn"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "flush_warnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1230-1243",
          "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "dquots"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1815
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_decr_inodes",
          "args": [
            "dquots[cnt]",
            "1"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_decr_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1107-1117",
          "snippet": "static void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_warning",
          "args": [
            "&warn[cnt]",
            "dquots[cnt]",
            "wtype"
          ],
          "line": 1812
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1215-1223",
          "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info_idq_free",
          "args": [
            "dquots[cnt]",
            "1"
          ],
          "line": 1810
        },
        "resolved": true,
        "details": {
          "function_name": "info_idq_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1342-1358",
          "snippet": "static int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1799
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1796
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid dquot_free_inode(struct inode *inode)\n{\n\tunsigned int cnt;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot * const *dquots = i_dquot(inode);\n\tint index;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tint wtype;\n\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\twtype = info_idq_free(dquots[cnt], 1);\n\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\tprepare_warning(&warn[cnt], dquots[cnt], wtype);\n\t\tdquot_decr_inodes(dquots[cnt], 1);\n\t}\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(dquots);\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n}"
  },
  {
    "function_name": "__dquot_free_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1749-1786",
    "snippet": "void __dquot_free_space(struct inode *inode, qsize_t number, int flags)\n{\n\tunsigned int cnt;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot **dquots = i_dquot(inode);\n\tint reserve = flags & DQUOT_SPACE_RESERVE, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_decr_space(inode, number, reserve);\n\t\treturn;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tint wtype;\n\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\twtype = info_bdq_free(dquots[cnt], number);\n\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\tprepare_warning(&warn[cnt], dquots[cnt], wtype);\n\t\tif (reserve)\n\t\t\tdquot_free_reserved_space(dquots[cnt], number);\n\t\telse\n\t\t\tdquot_decr_space(dquots[cnt], number);\n\t}\n\tinode_decr_space(inode, number, reserve);\n\tspin_unlock(&dq_data_lock);\n\n\tif (reserve)\n\t\tgoto out_unlock;\n\tmark_all_dquot_dirty(dquots);\nout_unlock:\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_warnings",
          "args": [
            "warn"
          ],
          "line": 1785
        },
        "resolved": true,
        "details": {
          "function_name": "flush_warnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1230-1243",
          "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "dquots"
          ],
          "line": 1782
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_decr_space",
          "args": [
            "inode",
            "number",
            "reserve"
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "inode_decr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1578-1584",
          "snippet": "static void inode_decr_space(struct inode *inode, qsize_t number, int reserve)\n{\n\tif (reserve)\n\t\tinode_sub_rsv_space(inode, number);\n\telse\n\t\tinode_sub_bytes(inode, number);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void inode_decr_space(struct inode *inode, qsize_t number, int reserve)\n{\n\tif (reserve)\n\t\tinode_sub_rsv_space(inode, number);\n\telse\n\t\tinode_sub_bytes(inode, number);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_decr_space",
          "args": [
            "dquots[cnt]",
            "number"
          ],
          "line": 1775
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_decr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1119-1129",
          "snippet": "static void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_free_reserved_space",
          "args": [
            "dquots[cnt]",
            "number"
          ],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_free_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1096-1105",
          "snippet": "static inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_warning",
          "args": [
            "&warn[cnt]",
            "dquots[cnt]",
            "wtype"
          ],
          "line": 1771
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1215-1223",
          "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "info_bdq_free",
          "args": [
            "dquots[cnt]",
            "number"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "info_bdq_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1360-1372",
          "snippet": "static int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1762
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1756
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1753
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid __dquot_free_space(struct inode *inode, qsize_t number, int flags)\n{\n\tunsigned int cnt;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot **dquots = i_dquot(inode);\n\tint reserve = flags & DQUOT_SPACE_RESERVE, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_decr_space(inode, number, reserve);\n\t\treturn;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tint wtype;\n\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\twtype = info_bdq_free(dquots[cnt], number);\n\t\tif (wtype != QUOTA_NL_NOWARN)\n\t\t\tprepare_warning(&warn[cnt], dquots[cnt], wtype);\n\t\tif (reserve)\n\t\t\tdquot_free_reserved_space(dquots[cnt], number);\n\t\telse\n\t\t\tdquot_decr_space(dquots[cnt], number);\n\t}\n\tinode_decr_space(inode, number, reserve);\n\tspin_unlock(&dq_data_lock);\n\n\tif (reserve)\n\t\tgoto out_unlock;\n\tmark_all_dquot_dirty(dquots);\nout_unlock:\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n}"
  },
  {
    "function_name": "dquot_reclaim_space_nodirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1720-1743",
    "snippet": "void dquot_reclaim_space_nodirty(struct inode *inode, qsize_t number)\n{\n\tint cnt, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_reclaim_rsv_space(inode, number);\n\t\treturn;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\t/* Claim reserved quotas to allocated quotas */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tdquot_reclaim_reserved_space(i_dquot(inode)[cnt],\n\t\t\t\t\t\t     number);\n\t}\n\t/* Update inode bytes */\n\tinode_reclaim_rsv_space(inode, number);\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(i_dquot(inode));\n\tsrcu_read_unlock(&dquot_srcu, index);\n\treturn;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "i_dquot(inode)"
          ],
          "line": 1740
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1740
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reclaim_rsv_space",
          "args": [
            "inode",
            "number"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reclaim_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1540-1546",
          "snippet": "void inode_reclaim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\t__inode_sub_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_reclaim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\t__inode_sub_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_reclaim_reserved_space",
          "args": [
            "i_dquot(inode)[cnt]",
            "number"
          ],
          "line": 1734
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_reclaim_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1088-1094",
          "snippet": "static void dquot_reclaim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (WARN_ON_ONCE(dquot->dq_dqb.dqb_curspace < number))\n\t\tnumber = dquot->dq_dqb.dqb_curspace;\n\tdquot->dq_dqb.dqb_rsvspace += number;\n\tdquot->dq_dqb.dqb_curspace -= number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_reclaim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (WARN_ON_ONCE(dquot->dq_dqb.dqb_curspace < number))\n\t\tnumber = dquot->dq_dqb.dqb_curspace;\n\tdquot->dq_dqb.dqb_rsvspace += number;\n\tdquot->dq_dqb.dqb_curspace -= number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1730
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid dquot_reclaim_space_nodirty(struct inode *inode, qsize_t number)\n{\n\tint cnt, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_reclaim_rsv_space(inode, number);\n\t\treturn;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\t/* Claim reserved quotas to allocated quotas */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tdquot_reclaim_reserved_space(i_dquot(inode)[cnt],\n\t\t\t\t\t\t     number);\n\t}\n\t/* Update inode bytes */\n\tinode_reclaim_rsv_space(inode, number);\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(i_dquot(inode));\n\tsrcu_read_unlock(&dquot_srcu, index);\n\treturn;\n}"
  },
  {
    "function_name": "dquot_claim_space_nodirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1691-1714",
    "snippet": "int dquot_claim_space_nodirty(struct inode *inode, qsize_t number)\n{\n\tint cnt, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_claim_rsv_space(inode, number);\n\t\treturn 0;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\t/* Claim reserved quotas to allocated quotas */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tdquot_claim_reserved_space(i_dquot(inode)[cnt],\n\t\t\t\t\t\t\tnumber);\n\t}\n\t/* Update inode bytes */\n\tinode_claim_rsv_space(inode, number);\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(i_dquot(inode));\n\tsrcu_read_unlock(&dquot_srcu, index);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "i_dquot(inode)"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1710
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_claim_rsv_space",
          "args": [
            "inode",
            "number"
          ],
          "line": 1709
        },
        "resolved": true,
        "details": {
          "function_name": "inode_claim_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1531-1537",
          "snippet": "void inode_claim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\t__inode_add_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_claim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\t__inode_add_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_claim_reserved_space",
          "args": [
            "i_dquot(inode)[cnt]",
            "number"
          ],
          "line": 1705
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_claim_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1078-1086",
          "snippet": "static void dquot_claim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace < number) {\n\t\tWARN_ON_ONCE(1);\n\t\tnumber = dquot->dq_dqb.dqb_rsvspace;\n\t}\n\tdquot->dq_dqb.dqb_curspace += number;\n\tdquot->dq_dqb.dqb_rsvspace -= number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_claim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace < number) {\n\t\tWARN_ON_ONCE(1);\n\t\tnumber = dquot->dq_dqb.dqb_rsvspace;\n\t}\n\tdquot->dq_dqb.dqb_curspace += number;\n\tdquot->dq_dqb.dqb_rsvspace -= number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1701
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1695
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nint dquot_claim_space_nodirty(struct inode *inode, qsize_t number)\n{\n\tint cnt, index;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_claim_rsv_space(inode, number);\n\t\treturn 0;\n\t}\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\t/* Claim reserved quotas to allocated quotas */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tdquot_claim_reserved_space(i_dquot(inode)[cnt],\n\t\t\t\t\t\t\tnumber);\n\t}\n\t/* Update inode bytes */\n\tinode_claim_rsv_space(inode, number);\n\tspin_unlock(&dq_data_lock);\n\tmark_all_dquot_dirty(i_dquot(inode));\n\tsrcu_read_unlock(&dquot_srcu, index);\n\treturn 0;\n}"
  },
  {
    "function_name": "dquot_alloc_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1651-1685",
    "snippet": "int dquot_alloc_inode(struct inode *inode)\n{\n\tint cnt, ret = 0, index;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot * const *dquots = i_dquot(inode);\n\n\tif (!dquot_active(inode))\n\t\treturn 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tret = check_idq(dquots[cnt], 1, &warn[cnt]);\n\t\tif (ret)\n\t\t\tgoto warn_put_all;\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tdquot_incr_inodes(dquots[cnt], 1);\n\t}\n\nwarn_put_all:\n\tspin_unlock(&dq_data_lock);\n\tif (ret == 0)\n\t\tmark_all_dquot_dirty(dquots);\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_warnings",
          "args": [
            "warn"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "flush_warnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1230-1243",
          "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "dquots"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1679
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_incr_inodes",
          "args": [
            "dquots[cnt]",
            "1"
          ],
          "line": 1675
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_incr_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1060-1063",
          "snippet": "static inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_idq",
          "args": [
            "dquots[cnt]",
            "1",
            "&warn[cnt]"
          ],
          "line": 1667
        },
        "resolved": true,
        "details": {
          "function_name": "check_idq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1255-1289",
          "snippet": "static int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1655
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nint dquot_alloc_inode(struct inode *inode)\n{\n\tint cnt, ret = 0, index;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot * const *dquots = i_dquot(inode);\n\n\tif (!dquot_active(inode))\n\t\treturn 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tret = check_idq(dquots[cnt], 1, &warn[cnt]);\n\t\tif (ret)\n\t\t\tgoto warn_put_all;\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tdquot_incr_inodes(dquots[cnt], 1);\n\t}\n\nwarn_put_all:\n\tspin_unlock(&dq_data_lock);\n\tif (ret == 0)\n\t\tmark_all_dquot_dirty(dquots);\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\n\treturn ret;\n}"
  },
  {
    "function_name": "__dquot_alloc_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1599-1645",
    "snippet": "int __dquot_alloc_space(struct inode *inode, qsize_t number, int flags)\n{\n\tint cnt, ret = 0, index;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot **dquots = i_dquot(inode);\n\tint reserve = flags & DQUOT_SPACE_RESERVE;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_incr_space(inode, number, reserve);\n\t\tgoto out;\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tret = check_bdq(dquots[cnt], number,\n\t\t\t\t!(flags & DQUOT_SPACE_WARN), &warn[cnt]);\n\t\tif (ret && !(flags & DQUOT_SPACE_NOFAIL)) {\n\t\t\tspin_unlock(&dq_data_lock);\n\t\t\tgoto out_flush_warn;\n\t\t}\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tif (reserve)\n\t\t\tdquot_resv_space(dquots[cnt], number);\n\t\telse\n\t\t\tdquot_incr_space(dquots[cnt], number);\n\t}\n\tinode_incr_space(inode, number, reserve);\n\tspin_unlock(&dq_data_lock);\n\n\tif (reserve)\n\t\tgoto out_flush_warn;\n\tmark_all_dquot_dirty(dquots);\nout_flush_warn:\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_warnings",
          "args": [
            "warn"
          ],
          "line": 1642
        },
        "resolved": true,
        "details": {
          "function_name": "flush_warnings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1230-1243",
          "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&dquot_srcu",
            "index"
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_all_dquot_dirty",
          "args": [
            "dquots"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "mark_all_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "361-374",
          "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1635
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_incr_space",
          "args": [
            "inode",
            "number",
            "reserve"
          ],
          "line": 1634
        },
        "resolved": true,
        "details": {
          "function_name": "inode_incr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1569-1576",
          "snippet": "static void inode_incr_space(struct inode *inode, qsize_t number,\n\t\t\t\tint reserve)\n{\n\tif (reserve)\n\t\tinode_add_rsv_space(inode, number);\n\telse\n\t\tinode_add_bytes(inode, number);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void inode_incr_space(struct inode *inode, qsize_t number,\n\t\t\t\tint reserve)\n{\n\tif (reserve)\n\t\tinode_add_rsv_space(inode, number);\n\telse\n\t\tinode_add_bytes(inode, number);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_incr_space",
          "args": [
            "dquots[cnt]",
            "number"
          ],
          "line": 1632
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_incr_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1065-1068",
          "snippet": "static inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_resv_space",
          "args": [
            "dquots[cnt]",
            "number"
          ],
          "line": 1630
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_resv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1070-1073",
          "snippet": "static inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_bdq",
          "args": [
            "dquots[cnt]",
            "number",
            "!(flags & DQUOT_SPACE_WARN)",
            "&warn[cnt]"
          ],
          "line": 1619
        },
        "resolved": true,
        "details": {
          "function_name": "check_bdq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1292-1340",
          "snippet": "static int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1615
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1606
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1603
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nint __dquot_alloc_space(struct inode *inode, qsize_t number, int flags)\n{\n\tint cnt, ret = 0, index;\n\tstruct dquot_warn warn[MAXQUOTAS];\n\tstruct dquot **dquots = i_dquot(inode);\n\tint reserve = flags & DQUOT_SPACE_RESERVE;\n\n\tif (!dquot_active(inode)) {\n\t\tinode_incr_space(inode, number, reserve);\n\t\tgoto out;\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\twarn[cnt].w_type = QUOTA_NL_NOWARN;\n\n\tindex = srcu_read_lock(&dquot_srcu);\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tret = check_bdq(dquots[cnt], number,\n\t\t\t\t!(flags & DQUOT_SPACE_WARN), &warn[cnt]);\n\t\tif (ret && !(flags & DQUOT_SPACE_NOFAIL)) {\n\t\t\tspin_unlock(&dq_data_lock);\n\t\t\tgoto out_flush_warn;\n\t\t}\n\t}\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (!dquots[cnt])\n\t\t\tcontinue;\n\t\tif (reserve)\n\t\t\tdquot_resv_space(dquots[cnt], number);\n\t\telse\n\t\t\tdquot_incr_space(dquots[cnt], number);\n\t}\n\tinode_incr_space(inode, number, reserve);\n\tspin_unlock(&dq_data_lock);\n\n\tif (reserve)\n\t\tgoto out_flush_warn;\n\tmark_all_dquot_dirty(dquots);\nout_flush_warn:\n\tsrcu_read_unlock(&dquot_srcu, index);\n\tflush_warnings(warn);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "inode_decr_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1578-1584",
    "snippet": "static void inode_decr_space(struct inode *inode, qsize_t number, int reserve)\n{\n\tif (reserve)\n\t\tinode_sub_rsv_space(inode, number);\n\telse\n\t\tinode_sub_bytes(inode, number);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_sub_bytes",
          "args": [
            "inode",
            "number"
          ],
          "line": 1583
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sub_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "482-487",
          "snippet": "void inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_sub_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_sub_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_sub_rsv_space",
          "args": [
            "inode",
            "number"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sub_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1549-1554",
          "snippet": "void inode_sub_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_sub_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\tspin_unlock(&inode->i_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void inode_decr_space(struct inode *inode, qsize_t number, int reserve)\n{\n\tif (reserve)\n\t\tinode_sub_rsv_space(inode, number);\n\telse\n\t\tinode_sub_bytes(inode, number);\n}"
  },
  {
    "function_name": "inode_incr_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1569-1576",
    "snippet": "static void inode_incr_space(struct inode *inode, qsize_t number,\n\t\t\t\tint reserve)\n{\n\tif (reserve)\n\t\tinode_add_rsv_space(inode, number);\n\telse\n\t\tinode_add_bytes(inode, number);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_add_bytes",
          "args": [
            "inode",
            "number"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "inode_add_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "460-465",
          "snippet": "void inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_add_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_add_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_add_rsv_space",
          "args": [
            "inode",
            "number"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "inode_add_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1523-1528",
          "snippet": "void inode_add_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\tspin_unlock(&inode->i_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_add_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\tspin_unlock(&inode->i_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void inode_incr_space(struct inode *inode, qsize_t number,\n\t\t\t\tint reserve)\n{\n\tif (reserve)\n\t\tinode_add_rsv_space(inode, number);\n\telse\n\t\tinode_add_bytes(inode, number);\n}"
  },
  {
    "function_name": "inode_get_rsv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1557-1567",
    "snippet": "static qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1565
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1515-1521",
          "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1563
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "inode_sub_rsv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1549-1554",
    "snippet": "void inode_sub_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1553
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1515-1521",
          "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1551
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_sub_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "inode_reclaim_rsv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1540-1546",
    "snippet": "void inode_reclaim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\t__inode_sub_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inode_sub_bytes",
          "args": [
            "inode",
            "number"
          ],
          "line": 1544
        },
        "resolved": true,
        "details": {
          "function_name": "__inode_sub_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "469-478",
          "snippet": "void __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1543
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1515-1521",
          "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1542
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_reclaim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\t__inode_sub_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "inode_claim_rsv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1531-1537",
    "snippet": "void inode_claim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\t__inode_add_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inode_add_bytes",
          "args": [
            "inode",
            "number"
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "__inode_add_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/stat.c",
          "lines": "449-458",
          "snippet": "void __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <asm/uaccess.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1534
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1515-1521",
          "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_claim_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) -= number;\n\t__inode_add_bytes(inode, number);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "inode_add_rsv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1523-1528",
    "snippet": "void inode_add_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1526
        },
        "resolved": true,
        "details": {
          "function_name": "inode_reserved_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1515-1521",
          "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid inode_add_rsv_space(struct inode *inode, qsize_t number)\n{\n\tspin_lock(&inode->i_lock);\n\t*inode_reserved_space(inode) += number;\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "inode_reserved_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1515-1521",
    "snippet": "static qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode->i_sb->dq_op->get_reserved_space",
          "args": [
            "inode"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!inode->i_sb->dq_op->get_reserved_space"
          ],
          "line": 1519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t *inode_reserved_space(struct inode * inode)\n{\n\t/* Filesystem must explicitly define it's own method in order to use\n\t * quota reservation interface */\n\tBUG_ON(!inode->i_sb->dq_op->get_reserved_space);\n\treturn inode->i_sb->dq_op->get_reserved_space(inode);\n}"
  },
  {
    "function_name": "dquot_drop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1487-1508",
    "snippet": "void dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn;\n\n\t/*\n\t * Test before calling to rule out calls from proc and such\n\t * where we are not allowed to block. Note that this is\n\t * actually reliable test even without the lock - the caller\n\t * must assure that nobody can come after the DQUOT_DROP and\n\t * add quota pointers back anyway.\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tbreak;\n\t}\n\n\tif (cnt < MAXQUOTAS)\n\t\t__dquot_drop(inode);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__dquot_drop",
          "args": [
            "inode"
          ],
          "line": 1507
        },
        "resolved": true,
        "details": {
          "function_name": "__dquot_drop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1473-1485",
          "snippet": "static void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1502
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn;\n\n\t/*\n\t * Test before calling to rule out calls from proc and such\n\t * where we are not allowed to block. Note that this is\n\t * actually reliable test even without the lock - the caller\n\t * must assure that nobody can come after the DQUOT_DROP and\n\t * add quota pointers back anyway.\n\t */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tbreak;\n\t}\n\n\tif (cnt < MAXQUOTAS)\n\t\t__dquot_drop(inode);\n}"
  },
  {
    "function_name": "__dquot_drop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1473-1485",
    "snippet": "static void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput_all",
          "args": [
            "put"
          ],
          "line": 1484
        },
        "resolved": true,
        "details": {
          "function_name": "dqput_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "376-382",
          "snippet": "static inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1483
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1478
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic void __dquot_drop(struct inode *inode)\n{\n\tint cnt;\n\tstruct dquot *put[MAXQUOTAS];\n\n\tspin_lock(&dq_data_lock);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tput[cnt] = i_dquot(inode)[cnt];\n\t\ti_dquot(inode)[cnt] = NULL;\n\t}\n\tspin_unlock(&dq_data_lock);\n\tdqput_all(put);\n}"
  },
  {
    "function_name": "dquot_initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1459-1462",
    "snippet": "void dquot_initialize(struct inode *inode)\n{\n\t__dquot_initialize(inode, -1);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__dquot_initialize",
          "args": [
            "inode",
            "-1"
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "__dquot_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1389-1457",
          "snippet": "static void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nvoid dquot_initialize(struct inode *inode)\n{\n\t__dquot_initialize(inode, -1);\n}"
  },
  {
    "function_name": "__dquot_initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1389-1457",
    "snippet": "static void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput_all",
          "args": [
            "got"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "dqput_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "376-382",
          "snippet": "static inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot_resv_space",
          "args": [
            "i_dquot(inode)[cnt]",
            "rsv"
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_resv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1070-1073",
          "snippet": "static inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "rsv"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_get_rsv_space",
          "args": [
            "inode"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "inode_get_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1557-1567",
          "snippet": "static qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqget",
          "args": [
            "sb",
            "qid"
          ],
          "line": 1422
        },
        "resolved": true,
        "details": {
          "function_name": "dqget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "832-893",
          "snippet": "struct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
            "static LIST_HEAD(inuse_list);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kqid_gid",
          "args": [
            "inode->i_gid"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kqid_uid",
          "args": [
            "inode->i_uid"
          ],
          "line": 1416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_active",
          "args": [
            "inode"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1374-1381",
          "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}"
  },
  {
    "function_name": "dquot_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1374-1381",
    "snippet": "static int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb_any_quota_suspended",
          "args": [
            "sb"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_any_quota_loaded",
          "args": [
            "sb"
          ],
          "line": 1380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic int dquot_active(const struct inode *inode)\n{\n\tstruct super_block *sb = inode->i_sb;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\treturn sb_any_quota_loaded(sb) & ~sb_any_quota_suspended(sb);\n}"
  },
  {
    "function_name": "info_bdq_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1360-1372",
    "snippet": "static int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 1362
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic int info_bdq_free(struct dquot *dquot, qsize_t space)\n{\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_NOWARN;\n\n\tif (dquot->dq_dqb.dqb_curspace - space <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\treturn QUOTA_NL_BSOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curspace >= dquot->dq_dqb.dqb_bhardlimit &&\n\t    dquot->dq_dqb.dqb_curspace - space < dquot->dq_dqb.dqb_bhardlimit)\n\t\treturn QUOTA_NL_BHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
  },
  {
    "function_name": "info_idq_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1342-1358",
    "snippet": "static int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb_has_quota_limits_enabled",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 1346
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int info_idq_free(struct dquot *dquot, qsize_t inodes)\n{\n\tqsize_t newinodes;\n\n\tif (test_bit(DQ_FAKE_B, &dquot->dq_flags) ||\n\t    dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit ||\n\t    !sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type))\n\t\treturn QUOTA_NL_NOWARN;\n\n\tnewinodes = dquot->dq_dqb.dqb_curinodes - inodes;\n\tif (newinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\treturn QUOTA_NL_ISOFTBELOW;\n\tif (dquot->dq_dqb.dqb_curinodes >= dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes < dquot->dq_dqb.dqb_ihardlimit)\n\t\treturn QUOTA_NL_IHARDBELOW;\n\treturn QUOTA_NL_NOWARN;\n}"
  },
  {
    "function_name": "check_bdq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1292-1340",
    "snippet": "static int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 1328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_warning",
          "args": [
            "warn",
            "dquot",
            "QUOTA_NL_BSOFTWARN"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1215-1223",
          "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_hardlimit",
          "args": [
            "dquot"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "ignore_hardlimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1245-1252",
          "snippet": "static int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_limits_enabled",
          "args": [
            "sb",
            "dquot->dq_id.type"
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_bdq(struct dquot *dquot, qsize_t space, int prealloc,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t tspace;\n\tstruct super_block *sb = dquot->dq_sb;\n\n\tif (!sb_has_quota_limits_enabled(sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\ttspace = dquot->dq_dqb.dqb_curspace + dquot->dq_dqb.dqb_rsvspace\n\t\t+ space;\n\n\tif (dquot->dq_dqb.dqb_bhardlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bhardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_btime &&\n            !ignore_hardlimit(dquot)) {\n\t\tif (!prealloc)\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_bsoftlimit &&\n\t    tspace > dquot->dq_dqb.dqb_bsoftlimit &&\n\t    dquot->dq_dqb.dqb_btime == 0) {\n\t\tif (!prealloc) {\n\t\t\tprepare_warning(warn, dquot, QUOTA_NL_BSOFTWARN);\n\t\t\tdquot->dq_dqb.dqb_btime = get_seconds() +\n\t\t\t    sb_dqopt(sb)->info[dquot->dq_id.type].dqi_bgrace;\n\t\t}\n\t\telse\n\t\t\t/*\n\t\t\t * We don't allow preallocation to exceed softlimit so exceeding will\n\t\t\t * be always printed\n\t\t\t */\n\t\t\treturn -EDQUOT;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "check_idq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1255-1289",
    "snippet": "static int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_warning",
          "args": [
            "warn",
            "dquot",
            "QUOTA_NL_ISOFTWARN"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1215-1223",
          "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_hardlimit",
          "args": [
            "dquot"
          ],
          "line": 1275
        },
        "resolved": true,
        "details": {
          "function_name": "ignore_hardlimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1245-1252",
          "snippet": "static int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_seconds",
          "args": [],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_FAKE_B",
            "&dquot->dq_flags"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_limits_enabled",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int check_idq(struct dquot *dquot, qsize_t inodes,\n\t\t     struct dquot_warn *warn)\n{\n\tqsize_t newinodes = dquot->dq_dqb.dqb_curinodes + inodes;\n\n\tif (!sb_has_quota_limits_enabled(dquot->dq_sb, dquot->dq_id.type) ||\n\t    test_bit(DQ_FAKE_B, &dquot->dq_flags))\n\t\treturn 0;\n\n\tif (dquot->dq_dqb.dqb_ihardlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_ihardlimit &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_IHARDWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime &&\n\t    get_seconds() >= dquot->dq_dqb.dqb_itime &&\n            !ignore_hardlimit(dquot)) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTLONGWARN);\n\t\treturn -EDQUOT;\n\t}\n\n\tif (dquot->dq_dqb.dqb_isoftlimit &&\n\t    newinodes > dquot->dq_dqb.dqb_isoftlimit &&\n\t    dquot->dq_dqb.dqb_itime == 0) {\n\t\tprepare_warning(warn, dquot, QUOTA_NL_ISOFTWARN);\n\t\tdquot->dq_dqb.dqb_itime = get_seconds() +\n\t\t    sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type].dqi_igrace;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ignore_hardlimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1245-1252",
    "snippet": "static int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_RESOURCE"
          ],
          "line": 1249
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "1901-1912",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (ns_capable(ns, CAP_FOWNER) && kuid_has_mapping(ns, inode->i_uid))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int ignore_hardlimit(struct dquot *dquot)\n{\n\tstruct mem_dqinfo *info = &sb_dqopt(dquot->dq_sb)->info[dquot->dq_id.type];\n\n\treturn capable(CAP_SYS_RESOURCE) &&\n\t       (info->dqi_format->qf_fmt_id != QFMT_VFS_OLD ||\n\t\t!(info->dqi_flags & DQF_ROOT_SQUASH));\n}"
  },
  {
    "function_name": "flush_warnings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1230-1243",
    "snippet": "static void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_send_warning",
          "args": [
            "warn[i].w_dq_id",
            "warn[i].w_sb->s_dev",
            "warn[i].w_type"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "quota_send_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/netlink.c",
          "lines": "44-98",
          "snippet": "void quota_send_warning(struct kqid qid, dev_t dev,\n\t\t\tconst char warntype)\n{\n\tstatic atomic_t seq;\n\tstruct sk_buff *skb;\n\tvoid *msg_head;\n\tint ret;\n\tint msg_size = 4 * nla_total_size(sizeof(u32)) +\n\t\t       2 * nla_total_size(sizeof(u64));\n\n\t/* We have to allocate using GFP_NOFS as we are called from a\n\t * filesystem performing write and thus further recursion into\n\t * the fs to free some data could cause deadlocks. */\n\tskb = genlmsg_new(msg_size, GFP_NOFS);\n\tif (!skb) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Not enough memory to send quota warning.\\n\");\n\t\treturn;\n\t}\n\tmsg_head = genlmsg_put(skb, 0, atomic_add_return(1, &seq),\n\t\t\t&quota_genl_family, 0, QUOTA_NL_C_WARNING);\n\tif (!msg_head) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Cannot store netlink header in quota warning.\\n\");\n\t\tgoto err_out;\n\t}\n\tret = nla_put_u32(skb, QUOTA_NL_A_QTYPE, qid.type);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64(skb, QUOTA_NL_A_EXCESS_ID,\n\t\t\t  from_kqid_munged(&init_user_ns, qid));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_WARNING, warntype);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MAJOR, MAJOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MINOR, MINOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64(skb, QUOTA_NL_A_CAUSED_ID,\n\t\t\t  from_kuid_munged(&init_user_ns, current_uid()));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tgenlmsg_end(skb, msg_head);\n\n\tgenlmsg_multicast(&quota_genl_family, skb, 0, 0, GFP_NOFS);\n\treturn;\nattr_err_out:\n\tprintk(KERN_ERR \"VFS: Not enough space to compose quota message!\\n\");\nerr_out:\n\tkfree_skb(skb);\n}",
          "includes": [
            "#include <net/genetlink.h>",
            "#include <net/netlink.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/cred.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct genl_family quota_genl_family = {\n\t/*\n\t * Needed due to multicast group ID abuse - old code assumed\n\t * the family ID was also a valid multicast group ID (which\n\t * isn't true) and userspace might thus rely on it. Assign a\n\t * static ID for this group to make dealing with that easier.\n\t */\n\t.id = GENL_ID_VFS_DQUOT,\n\t.hdrsize = 0,\n\t.name = \"VFS_DQUOT\",\n\t.version = 1,\n\t.maxattr = QUOTA_NL_A_MAX,\n\t.mcgrps = quota_mcgrps,\n\t.n_mcgrps = ARRAY_SIZE(quota_mcgrps),\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <net/genetlink.h>\n#include <net/netlink.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/quotaops.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/cred.h>\n\nstatic struct genl_family quota_genl_family = {\n\t/*\n\t * Needed due to multicast group ID abuse - old code assumed\n\t * the family ID was also a valid multicast group ID (which\n\t * isn't true) and userspace might thus rely on it. Assign a\n\t * static ID for this group to make dealing with that easier.\n\t */\n\t.id = GENL_ID_VFS_DQUOT,\n\t.hdrsize = 0,\n\t.name = \"VFS_DQUOT\",\n\t.version = 1,\n\t.maxattr = QUOTA_NL_A_MAX,\n\t.mcgrps = quota_mcgrps,\n\t.n_mcgrps = ARRAY_SIZE(quota_mcgrps),\n};\n\nvoid quota_send_warning(struct kqid qid, dev_t dev,\n\t\t\tconst char warntype)\n{\n\tstatic atomic_t seq;\n\tstruct sk_buff *skb;\n\tvoid *msg_head;\n\tint ret;\n\tint msg_size = 4 * nla_total_size(sizeof(u32)) +\n\t\t       2 * nla_total_size(sizeof(u64));\n\n\t/* We have to allocate using GFP_NOFS as we are called from a\n\t * filesystem performing write and thus further recursion into\n\t * the fs to free some data could cause deadlocks. */\n\tskb = genlmsg_new(msg_size, GFP_NOFS);\n\tif (!skb) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Not enough memory to send quota warning.\\n\");\n\t\treturn;\n\t}\n\tmsg_head = genlmsg_put(skb, 0, atomic_add_return(1, &seq),\n\t\t\t&quota_genl_family, 0, QUOTA_NL_C_WARNING);\n\tif (!msg_head) {\n\t\tprintk(KERN_ERR\n\t\t  \"VFS: Cannot store netlink header in quota warning.\\n\");\n\t\tgoto err_out;\n\t}\n\tret = nla_put_u32(skb, QUOTA_NL_A_QTYPE, qid.type);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64(skb, QUOTA_NL_A_EXCESS_ID,\n\t\t\t  from_kqid_munged(&init_user_ns, qid));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_WARNING, warntype);\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MAJOR, MAJOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u32(skb, QUOTA_NL_A_DEV_MINOR, MINOR(dev));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tret = nla_put_u64(skb, QUOTA_NL_A_CAUSED_ID,\n\t\t\t  from_kuid_munged(&init_user_ns, current_uid()));\n\tif (ret)\n\t\tgoto attr_err_out;\n\tgenlmsg_end(skb, msg_head);\n\n\tgenlmsg_multicast(&quota_genl_family, skb, 0, 0, GFP_NOFS);\n\treturn;\nattr_err_out:\n\tprintk(KERN_ERR \"VFS: Not enough space to compose quota message!\\n\");\nerr_out:\n\tkfree_skb(skb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_warning",
          "args": [
            "&warn[i]"
          ],
          "line": 1238
        },
        "resolved": true,
        "details": {
          "function_name": "print_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1169-1212",
          "snippet": "static void print_warning(struct dquot_warn *warn)\n{\n\tchar *msg = NULL;\n\tstruct tty_struct *tty;\n\tint warntype = warn->w_type;\n\n\tif (warntype == QUOTA_NL_IHARDBELOW ||\n\t    warntype == QUOTA_NL_ISOFTBELOW ||\n\t    warntype == QUOTA_NL_BHARDBELOW ||\n\t    warntype == QUOTA_NL_BSOFTBELOW || !need_print_warning(warn))\n\t\treturn;\n\n\ttty = get_current_tty();\n\tif (!tty)\n\t\treturn;\n\ttty_write_message(tty, warn->w_sb->s_id);\n\tif (warntype == QUOTA_NL_ISOFTWARN || warntype == QUOTA_NL_BSOFTWARN)\n\t\ttty_write_message(tty, \": warning, \");\n\telse\n\t\ttty_write_message(tty, \": write failed, \");\n\ttty_write_message(tty, quotatypes[warn->w_dq_id.type]);\n\tswitch (warntype) {\n\t\tcase QUOTA_NL_IHARDWARN:\n\t\t\tmsg = \" file limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTLONGWARN:\n\t\t\tmsg = \" file quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTWARN:\n\t\t\tmsg = \" file quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BHARDWARN:\n\t\t\tmsg = \" block limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTLONGWARN:\n\t\t\tmsg = \" block quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTWARN:\n\t\t\tmsg = \" block quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t}\n\ttty_write_message(tty, msg);\n\ttty_kref_put(tty);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void print_warning(struct dquot_warn *warn)\n{\n\tchar *msg = NULL;\n\tstruct tty_struct *tty;\n\tint warntype = warn->w_type;\n\n\tif (warntype == QUOTA_NL_IHARDBELOW ||\n\t    warntype == QUOTA_NL_ISOFTBELOW ||\n\t    warntype == QUOTA_NL_BHARDBELOW ||\n\t    warntype == QUOTA_NL_BSOFTBELOW || !need_print_warning(warn))\n\t\treturn;\n\n\ttty = get_current_tty();\n\tif (!tty)\n\t\treturn;\n\ttty_write_message(tty, warn->w_sb->s_id);\n\tif (warntype == QUOTA_NL_ISOFTWARN || warntype == QUOTA_NL_BSOFTWARN)\n\t\ttty_write_message(tty, \": warning, \");\n\telse\n\t\ttty_write_message(tty, \": write failed, \");\n\ttty_write_message(tty, quotatypes[warn->w_dq_id.type]);\n\tswitch (warntype) {\n\t\tcase QUOTA_NL_IHARDWARN:\n\t\t\tmsg = \" file limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTLONGWARN:\n\t\t\tmsg = \" file quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTWARN:\n\t\t\tmsg = \" file quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BHARDWARN:\n\t\t\tmsg = \" block limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTLONGWARN:\n\t\t\tmsg = \" block quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTWARN:\n\t\t\tmsg = \" block quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t}\n\ttty_write_message(tty, msg);\n\ttty_kref_put(tty);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void flush_warnings(struct dquot_warn *warn)\n{\n\tint i;\n\n\tfor (i = 0; i < MAXQUOTAS; i++) {\n\t\tif (warn[i].w_type == QUOTA_NL_NOWARN)\n\t\t\tcontinue;\n#ifdef CONFIG_PRINT_QUOTA_WARNING\n\t\tprint_warning(&warn[i]);\n#endif\n\t\tquota_send_warning(warn[i].w_dq_id,\n\t\t\t\t   warn[i].w_sb->s_dev, warn[i].w_type);\n\t}\n}"
  },
  {
    "function_name": "prepare_warning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1215-1223",
    "snippet": "static void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "warning_issued",
          "args": [
            "dquot",
            "warntype"
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "warning_issued",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1137-1147",
          "snippet": "static int warning_issued(struct dquot *dquot, const int warntype)\n{\n\tint flag = (warntype == QUOTA_NL_BHARDWARN ||\n\t\twarntype == QUOTA_NL_BSOFTLONGWARN) ? DQ_BLKS_B :\n\t\t((warntype == QUOTA_NL_IHARDWARN ||\n\t\twarntype == QUOTA_NL_ISOFTLONGWARN) ? DQ_INODES_B : 0);\n\n\tif (!flag)\n\t\treturn 0;\n\treturn test_and_set_bit(flag, &dquot->dq_flags);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic int warning_issued(struct dquot *dquot, const int warntype)\n{\n\tint flag = (warntype == QUOTA_NL_BHARDWARN ||\n\t\twarntype == QUOTA_NL_BSOFTLONGWARN) ? DQ_BLKS_B :\n\t\t((warntype == QUOTA_NL_IHARDWARN ||\n\t\twarntype == QUOTA_NL_ISOFTLONGWARN) ? DQ_INODES_B : 0);\n\n\tif (!flag)\n\t\treturn 0;\n\treturn test_and_set_bit(flag, &dquot->dq_flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void prepare_warning(struct dquot_warn *warn, struct dquot *dquot,\n\t\t\t    int warntype)\n{\n\tif (warning_issued(dquot, warntype))\n\t\treturn;\n\twarn->w_type = warntype;\n\twarn->w_sb = dquot->dq_sb;\n\twarn->w_dq_id = dquot->dq_id;\n}"
  },
  {
    "function_name": "print_warning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1169-1212",
    "snippet": "static void print_warning(struct dquot_warn *warn)\n{\n\tchar *msg = NULL;\n\tstruct tty_struct *tty;\n\tint warntype = warn->w_type;\n\n\tif (warntype == QUOTA_NL_IHARDBELOW ||\n\t    warntype == QUOTA_NL_ISOFTBELOW ||\n\t    warntype == QUOTA_NL_BHARDBELOW ||\n\t    warntype == QUOTA_NL_BSOFTBELOW || !need_print_warning(warn))\n\t\treturn;\n\n\ttty = get_current_tty();\n\tif (!tty)\n\t\treturn;\n\ttty_write_message(tty, warn->w_sb->s_id);\n\tif (warntype == QUOTA_NL_ISOFTWARN || warntype == QUOTA_NL_BSOFTWARN)\n\t\ttty_write_message(tty, \": warning, \");\n\telse\n\t\ttty_write_message(tty, \": write failed, \");\n\ttty_write_message(tty, quotatypes[warn->w_dq_id.type]);\n\tswitch (warntype) {\n\t\tcase QUOTA_NL_IHARDWARN:\n\t\t\tmsg = \" file limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTLONGWARN:\n\t\t\tmsg = \" file quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTWARN:\n\t\t\tmsg = \" file quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BHARDWARN:\n\t\t\tmsg = \" block limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTLONGWARN:\n\t\t\tmsg = \" block quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTWARN:\n\t\t\tmsg = \" block quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t}\n\ttty_write_message(tty, msg);\n\ttty_kref_put(tty);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "tty_kref_put",
          "args": [
            "tty"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tty_write_message",
          "args": [
            "tty",
            "msg"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tty_write_message",
          "args": [
            "tty",
            "quotatypes[warn->w_dq_id.type]"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tty_write_message",
          "args": [
            "tty",
            "\": write failed, \""
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tty_write_message",
          "args": [
            "tty",
            "\": warning, \""
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tty_write_message",
          "args": [
            "tty",
            "warn->w_sb->s_id"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_current_tty",
          "args": [],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "need_print_warning",
          "args": [
            "warn"
          ],
          "line": 1178
        },
        "resolved": true,
        "details": {
          "function_name": "need_print_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1152-1166",
          "snippet": "static int need_print_warning(struct dquot_warn *warn)\n{\n\tif (!flag_print_warnings)\n\t\treturn 0;\n\n\tswitch (warn->w_dq_id.type) {\n\t\tcase USRQUOTA:\n\t\t\treturn uid_eq(current_fsuid(), warn->w_dq_id.uid);\n\t\tcase GRPQUOTA:\n\t\t\treturn in_group_p(warn->w_dq_id.gid);\n\t\tcase PRJQUOTA:\t/* Never taken... Just make gcc happy */\n\t\t\treturn 0;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int need_print_warning(struct dquot_warn *warn)\n{\n\tif (!flag_print_warnings)\n\t\treturn 0;\n\n\tswitch (warn->w_dq_id.type) {\n\t\tcase USRQUOTA:\n\t\t\treturn uid_eq(current_fsuid(), warn->w_dq_id.uid);\n\t\tcase GRPQUOTA:\n\t\t\treturn in_group_p(warn->w_dq_id.gid);\n\t\tcase PRJQUOTA:\t/* Never taken... Just make gcc happy */\n\t\t\treturn 0;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void print_warning(struct dquot_warn *warn)\n{\n\tchar *msg = NULL;\n\tstruct tty_struct *tty;\n\tint warntype = warn->w_type;\n\n\tif (warntype == QUOTA_NL_IHARDBELOW ||\n\t    warntype == QUOTA_NL_ISOFTBELOW ||\n\t    warntype == QUOTA_NL_BHARDBELOW ||\n\t    warntype == QUOTA_NL_BSOFTBELOW || !need_print_warning(warn))\n\t\treturn;\n\n\ttty = get_current_tty();\n\tif (!tty)\n\t\treturn;\n\ttty_write_message(tty, warn->w_sb->s_id);\n\tif (warntype == QUOTA_NL_ISOFTWARN || warntype == QUOTA_NL_BSOFTWARN)\n\t\ttty_write_message(tty, \": warning, \");\n\telse\n\t\ttty_write_message(tty, \": write failed, \");\n\ttty_write_message(tty, quotatypes[warn->w_dq_id.type]);\n\tswitch (warntype) {\n\t\tcase QUOTA_NL_IHARDWARN:\n\t\t\tmsg = \" file limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTLONGWARN:\n\t\t\tmsg = \" file quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_ISOFTWARN:\n\t\t\tmsg = \" file quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BHARDWARN:\n\t\t\tmsg = \" block limit reached.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTLONGWARN:\n\t\t\tmsg = \" block quota exceeded too long.\\r\\n\";\n\t\t\tbreak;\n\t\tcase QUOTA_NL_BSOFTWARN:\n\t\t\tmsg = \" block quota exceeded.\\r\\n\";\n\t\t\tbreak;\n\t}\n\ttty_write_message(tty, msg);\n\ttty_kref_put(tty);\n}"
  },
  {
    "function_name": "need_print_warning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1152-1166",
    "snippet": "static int need_print_warning(struct dquot_warn *warn)\n{\n\tif (!flag_print_warnings)\n\t\treturn 0;\n\n\tswitch (warn->w_dq_id.type) {\n\t\tcase USRQUOTA:\n\t\t\treturn uid_eq(current_fsuid(), warn->w_dq_id.uid);\n\t\tcase GRPQUOTA:\n\t\t\treturn in_group_p(warn->w_dq_id.gid);\n\t\tcase PRJQUOTA:\t/* Never taken... Just make gcc happy */\n\t\t\treturn 0;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_group_p",
          "args": [
            "warn->w_dq_id.gid"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "current_fsuid()",
            "warn->w_dq_id.uid"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "uuid_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xfs/uuid.c",
          "lines": "59-63",
          "snippet": "int\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}",
          "includes": [
            "#include <xfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <xfs.h>\n\nint\nuuid_equal(uuid_t *uuid1, uuid_t *uuid2)\n{\n\treturn memcmp(uuid1, uuid2, sizeof(uuid_t)) ? 0 : 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_fsuid",
          "args": [],
          "line": 1159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int need_print_warning(struct dquot_warn *warn)\n{\n\tif (!flag_print_warnings)\n\t\treturn 0;\n\n\tswitch (warn->w_dq_id.type) {\n\t\tcase USRQUOTA:\n\t\t\treturn uid_eq(current_fsuid(), warn->w_dq_id.uid);\n\t\tcase GRPQUOTA:\n\t\t\treturn in_group_p(warn->w_dq_id.gid);\n\t\tcase PRJQUOTA:\t/* Never taken... Just make gcc happy */\n\t\t\treturn 0;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "warning_issued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1137-1147",
    "snippet": "static int warning_issued(struct dquot *dquot, const int warntype)\n{\n\tint flag = (warntype == QUOTA_NL_BHARDWARN ||\n\t\twarntype == QUOTA_NL_BSOFTLONGWARN) ? DQ_BLKS_B :\n\t\t((warntype == QUOTA_NL_IHARDWARN ||\n\t\twarntype == QUOTA_NL_ISOFTLONGWARN) ? DQ_INODES_B : 0);\n\n\tif (!flag)\n\t\treturn 0;\n\treturn test_and_set_bit(flag, &dquot->dq_flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "flag",
            "&dquot->dq_flags"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic int warning_issued(struct dquot *dquot, const int warntype)\n{\n\tint flag = (warntype == QUOTA_NL_BHARDWARN ||\n\t\twarntype == QUOTA_NL_BSOFTLONGWARN) ? DQ_BLKS_B :\n\t\t((warntype == QUOTA_NL_IHARDWARN ||\n\t\twarntype == QUOTA_NL_ISOFTLONGWARN) ? DQ_INODES_B : 0);\n\n\tif (!flag)\n\t\treturn 0;\n\treturn test_and_set_bit(flag, &dquot->dq_flags);\n}"
  },
  {
    "function_name": "dquot_decr_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1119-1129",
    "snippet": "static void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "DQ_BLKS_B",
            "&dquot->dq_flags"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_space(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curspace >= number)\n\t\tdquot->dq_dqb.dqb_curspace -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curspace = 0;\n\tif (dquot->dq_dqb.dqb_curspace <= dquot->dq_dqb.dqb_bsoftlimit)\n\t\tdquot->dq_dqb.dqb_btime = (time_t) 0;\n\tclear_bit(DQ_BLKS_B, &dquot->dq_flags);\n}"
  },
  {
    "function_name": "dquot_decr_inodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1107-1117",
    "snippet": "static void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "DQ_INODES_B",
            "&dquot->dq_flags"
          ],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_decr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tif (sb_dqopt(dquot->dq_sb)->flags & DQUOT_NEGATIVE_USAGE ||\n\t    dquot->dq_dqb.dqb_curinodes >= number)\n\t\tdquot->dq_dqb.dqb_curinodes -= number;\n\telse\n\t\tdquot->dq_dqb.dqb_curinodes = 0;\n\tif (dquot->dq_dqb.dqb_curinodes <= dquot->dq_dqb.dqb_isoftlimit)\n\t\tdquot->dq_dqb.dqb_itime = (time_t) 0;\n\tclear_bit(DQ_INODES_B, &dquot->dq_flags);\n}"
  },
  {
    "function_name": "dquot_free_reserved_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1096-1105",
    "snippet": "static inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline\nvoid dquot_free_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace >= number)\n\t\tdquot->dq_dqb.dqb_rsvspace -= number;\n\telse {\n\t\tWARN_ON_ONCE(1);\n\t\tdquot->dq_dqb.dqb_rsvspace = 0;\n\t}\n}"
  },
  {
    "function_name": "dquot_reclaim_reserved_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1088-1094",
    "snippet": "static void dquot_reclaim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (WARN_ON_ONCE(dquot->dq_dqb.dqb_curspace < number))\n\t\tnumber = dquot->dq_dqb.dqb_curspace;\n\tdquot->dq_dqb.dqb_rsvspace += number;\n\tdquot->dq_dqb.dqb_curspace -= number;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "dquot->dq_dqb.dqb_curspace < number"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_reclaim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (WARN_ON_ONCE(dquot->dq_dqb.dqb_curspace < number))\n\t\tnumber = dquot->dq_dqb.dqb_curspace;\n\tdquot->dq_dqb.dqb_rsvspace += number;\n\tdquot->dq_dqb.dqb_curspace -= number;\n}"
  },
  {
    "function_name": "dquot_claim_reserved_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1078-1086",
    "snippet": "static void dquot_claim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace < number) {\n\t\tWARN_ON_ONCE(1);\n\t\tnumber = dquot->dq_dqb.dqb_rsvspace;\n\t}\n\tdquot->dq_dqb.dqb_curspace += number;\n\tdquot->dq_dqb.dqb_rsvspace -= number;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void dquot_claim_reserved_space(struct dquot *dquot, qsize_t number)\n{\n\tif (dquot->dq_dqb.dqb_rsvspace < number) {\n\t\tWARN_ON_ONCE(1);\n\t\tnumber = dquot->dq_dqb.dqb_rsvspace;\n\t}\n\tdquot->dq_dqb.dqb_curspace += number;\n\tdquot->dq_dqb.dqb_rsvspace -= number;\n}"
  },
  {
    "function_name": "dquot_resv_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1070-1073",
    "snippet": "static inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_resv_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_rsvspace += number;\n}"
  },
  {
    "function_name": "dquot_incr_space",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1065-1068",
    "snippet": "static inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_space(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curspace += number;\n}"
  },
  {
    "function_name": "dquot_incr_inodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1060-1063",
    "snippet": "static inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dquot_incr_inodes(struct dquot *dquot, qsize_t number)\n{\n\tdquot->dq_dqb.dqb_curinodes += number;\n}"
  },
  {
    "function_name": "drop_dquot_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1049-1058",
    "snippet": "static void drop_dquot_ref(struct super_block *sb, int type)\n{\n\tLIST_HEAD(tofree_head);\n\n\tif (sb->dq_op) {\n\t\tremove_dquot_ref(sb, type, &tofree_head);\n\t\tsynchronize_srcu(&dquot_srcu);\n\t\tput_dquot_list(&tofree_head);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_dquot_list",
          "args": [
            "&tofree_head"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "put_dquot_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1001-1014",
          "snippet": "static void put_dquot_list(struct list_head *tofree_head)\n{\n\tstruct list_head *act_head;\n\tstruct dquot *dquot;\n\n\tact_head = tofree_head->next;\n\twhile (act_head != tofree_head) {\n\t\tdquot = list_entry(act_head, struct dquot, dq_free);\n\t\tact_head = act_head->next;\n\t\t/* Remove dquot from the list so we won't have problems... */\n\t\tlist_del_init(&dquot->dq_free);\n\t\tdqput(dquot);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void put_dquot_list(struct list_head *tofree_head)\n{\n\tstruct list_head *act_head;\n\tstruct dquot *dquot;\n\n\tact_head = tofree_head->next;\n\twhile (act_head != tofree_head) {\n\t\tdquot = list_entry(act_head, struct dquot, dq_free);\n\t\tact_head = act_head->next;\n\t\t/* Remove dquot from the list so we won't have problems... */\n\t\tlist_del_init(&dquot->dq_free);\n\t\tdqput(dquot);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "synchronize_srcu",
          "args": [
            "&dquot_srcu"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_dquot_ref",
          "args": [
            "sb",
            "type",
            "&tofree_head"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "remove_dquot_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1016-1046",
          "snippet": "static void remove_dquot_ref(struct super_block *sb, int type,\n\t\tstruct list_head *tofree_head)\n{\n\tstruct inode *inode;\n\tint reserved = 0;\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\t/*\n\t\t *  We have to scan also I_NEW inodes because they can already\n\t\t *  have quota pointer initialized. Luckily, we need to touch\n\t\t *  only quota pointers and these have separate locking\n\t\t *  (dq_data_lock).\n\t\t */\n\t\tspin_lock(&dq_data_lock);\n\t\tif (!IS_NOQUOTA(inode)) {\n\t\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\t\treserved = 1;\n\t\t\tremove_inode_dquot_ref(inode, type, tofree_head);\n\t\t}\n\t\tspin_unlock(&dq_data_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tprintk(KERN_WARNING \"VFS (%s): Writes happened after quota\"\n\t\t\t\" was disabled thus quota information is probably \"\n\t\t\t\"inconsistent. Please run quotacheck(8).\\n\", sb->s_id);\n\t}\n#endif\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void remove_dquot_ref(struct super_block *sb, int type,\n\t\tstruct list_head *tofree_head)\n{\n\tstruct inode *inode;\n\tint reserved = 0;\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\t/*\n\t\t *  We have to scan also I_NEW inodes because they can already\n\t\t *  have quota pointer initialized. Luckily, we need to touch\n\t\t *  only quota pointers and these have separate locking\n\t\t *  (dq_data_lock).\n\t\t */\n\t\tspin_lock(&dq_data_lock);\n\t\tif (!IS_NOQUOTA(inode)) {\n\t\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\t\treserved = 1;\n\t\t\tremove_inode_dquot_ref(inode, type, tofree_head);\n\t\t}\n\t\tspin_unlock(&dq_data_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tprintk(KERN_WARNING \"VFS (%s): Writes happened after quota\"\n\t\t\t\" was disabled thus quota information is probably \"\n\t\t\t\"inconsistent. Please run quotacheck(8).\\n\", sb->s_id);\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "tofree_head"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void drop_dquot_ref(struct super_block *sb, int type)\n{\n\tLIST_HEAD(tofree_head);\n\n\tif (sb->dq_op) {\n\t\tremove_dquot_ref(sb, type, &tofree_head);\n\t\tsynchronize_srcu(&dquot_srcu);\n\t\tput_dquot_list(&tofree_head);\n\t}\n}"
  },
  {
    "function_name": "remove_dquot_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1016-1046",
    "snippet": "static void remove_dquot_ref(struct super_block *sb, int type,\n\t\tstruct list_head *tofree_head)\n{\n\tstruct inode *inode;\n\tint reserved = 0;\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\t/*\n\t\t *  We have to scan also I_NEW inodes because they can already\n\t\t *  have quota pointer initialized. Luckily, we need to touch\n\t\t *  only quota pointers and these have separate locking\n\t\t *  (dq_data_lock).\n\t\t */\n\t\tspin_lock(&dq_data_lock);\n\t\tif (!IS_NOQUOTA(inode)) {\n\t\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\t\treserved = 1;\n\t\t\tremove_inode_dquot_ref(inode, type, tofree_head);\n\t\t}\n\t\tspin_unlock(&dq_data_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tprintk(KERN_WARNING \"VFS (%s): Writes happened after quota\"\n\t\t\t\" was disabled thus quota information is probably \"\n\t\t\t\"inconsistent. Please run quotacheck(8).\\n\", sb->s_id);\n\t}\n#endif\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"VFS (%s): Writes happened after quota\"\n\t\t\t\" was disabled thus quota information is probably \"\n\t\t\t\"inconsistent. Please run quotacheck(8).\\n\"",
            "sb->s_id"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode_sb_list_lock"
          ],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_inode_dquot_ref",
          "args": [
            "inode",
            "type",
            "tofree_head"
          ],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "remove_inode_dquot_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "970-994",
          "snippet": "static void remove_inode_dquot_ref(struct inode *inode, int type,\n\t\t\t\t   struct list_head *tofree_head)\n{\n\tstruct dquot *dquot = i_dquot(inode)[type];\n\n\ti_dquot(inode)[type] = NULL;\n\tif (!dquot)\n\t\treturn;\n\n\tif (list_empty(&dquot->dq_free)) {\n\t\t/*\n\t\t * The inode still has reference to dquot so it can't be in the\n\t\t * free list\n\t\t */\n\t\tspin_lock(&dq_list_lock);\n\t\tlist_add(&dquot->dq_free, tofree_head);\n\t\tspin_unlock(&dq_list_lock);\n\t} else {\n\t\t/*\n\t\t * Dquot is already in a list to put so we won't drop the last\n\t\t * reference here.\n\t\t */\n\t\tdqput(dquot);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void remove_inode_dquot_ref(struct inode *inode, int type,\n\t\t\t\t   struct list_head *tofree_head)\n{\n\tstruct dquot *dquot = i_dquot(inode)[type];\n\n\ti_dquot(inode)[type] = NULL;\n\tif (!dquot)\n\t\treturn;\n\n\tif (list_empty(&dquot->dq_free)) {\n\t\t/*\n\t\t * The inode still has reference to dquot so it can't be in the\n\t\t * free list\n\t\t */\n\t\tspin_lock(&dq_list_lock);\n\t\tlist_add(&dquot->dq_free, tofree_head);\n\t\tspin_unlock(&dq_list_lock);\n\t} else {\n\t\t/*\n\t\t * Dquot is already in a list to put so we won't drop the last\n\t\t * reference here.\n\t\t */\n\t\tdqput(dquot);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "inode_get_rsv_space(inode) > 0"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_get_rsv_space",
          "args": [
            "inode"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "inode_get_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1557-1567",
          "snippet": "static qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_data_lock"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&sb->s_inodes",
            "i_sb_list"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void remove_dquot_ref(struct super_block *sb, int type,\n\t\tstruct list_head *tofree_head)\n{\n\tstruct inode *inode;\n\tint reserved = 0;\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\t/*\n\t\t *  We have to scan also I_NEW inodes because they can already\n\t\t *  have quota pointer initialized. Luckily, we need to touch\n\t\t *  only quota pointers and these have separate locking\n\t\t *  (dq_data_lock).\n\t\t */\n\t\tspin_lock(&dq_data_lock);\n\t\tif (!IS_NOQUOTA(inode)) {\n\t\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\t\treserved = 1;\n\t\t\tremove_inode_dquot_ref(inode, type, tofree_head);\n\t\t}\n\t\tspin_unlock(&dq_data_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tprintk(KERN_WARNING \"VFS (%s): Writes happened after quota\"\n\t\t\t\" was disabled thus quota information is probably \"\n\t\t\t\"inconsistent. Please run quotacheck(8).\\n\", sb->s_id);\n\t}\n#endif\n}"
  },
  {
    "function_name": "put_dquot_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "1001-1014",
    "snippet": "static void put_dquot_list(struct list_head *tofree_head)\n{\n\tstruct list_head *act_head;\n\tstruct dquot *dquot;\n\n\tact_head = tofree_head->next;\n\twhile (act_head != tofree_head) {\n\t\tdquot = list_entry(act_head, struct dquot, dq_free);\n\t\tact_head = act_head->next;\n\t\t/* Remove dquot from the list so we won't have problems... */\n\t\tlist_del_init(&dquot->dq_free);\n\t\tdqput(dquot);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "act_head",
            "structdquot",
            "dq_free"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void put_dquot_list(struct list_head *tofree_head)\n{\n\tstruct list_head *act_head;\n\tstruct dquot *dquot;\n\n\tact_head = tofree_head->next;\n\twhile (act_head != tofree_head) {\n\t\tdquot = list_entry(act_head, struct dquot, dq_free);\n\t\tact_head = act_head->next;\n\t\t/* Remove dquot from the list so we won't have problems... */\n\t\tlist_del_init(&dquot->dq_free);\n\t\tdqput(dquot);\n\t}\n}"
  },
  {
    "function_name": "remove_inode_dquot_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "970-994",
    "snippet": "static void remove_inode_dquot_ref(struct inode *inode, int type,\n\t\t\t\t   struct list_head *tofree_head)\n{\n\tstruct dquot *dquot = i_dquot(inode)[type];\n\n\ti_dquot(inode)[type] = NULL;\n\tif (!dquot)\n\t\treturn;\n\n\tif (list_empty(&dquot->dq_free)) {\n\t\t/*\n\t\t * The inode still has reference to dquot so it can't be in the\n\t\t * free list\n\t\t */\n\t\tspin_lock(&dq_list_lock);\n\t\tlist_add(&dquot->dq_free, tofree_head);\n\t\tspin_unlock(&dq_list_lock);\n\t} else {\n\t\t/*\n\t\t * Dquot is already in a list to put so we won't drop the last\n\t\t * reference here.\n\t\t */\n\t\tdqput(dquot);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&dquot->dq_free",
            "tofree_head"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void remove_inode_dquot_ref(struct inode *inode, int type,\n\t\t\t\t   struct list_head *tofree_head)\n{\n\tstruct dquot *dquot = i_dquot(inode)[type];\n\n\ti_dquot(inode)[type] = NULL;\n\tif (!dquot)\n\t\treturn;\n\n\tif (list_empty(&dquot->dq_free)) {\n\t\t/*\n\t\t * The inode still has reference to dquot so it can't be in the\n\t\t * free list\n\t\t */\n\t\tspin_lock(&dq_list_lock);\n\t\tlist_add(&dquot->dq_free, tofree_head);\n\t\tspin_unlock(&dq_list_lock);\n\t} else {\n\t\t/*\n\t\t * Dquot is already in a list to put so we won't drop the last\n\t\t * reference here.\n\t\t */\n\t\tdqput(dquot);\n\t}\n}"
  },
  {
    "function_name": "add_dquot_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "916-964",
    "snippet": "static void add_dquot_ref(struct super_block *sb, int type)\n{\n\tstruct inode *inode, *old_inode = NULL;\n#ifdef CONFIG_QUOTA_DEBUG\n\tint reserved = 0;\n#endif\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\tspin_lock(&inode->i_lock);\n\t\tif ((inode->i_state & (I_FREEING|I_WILL_FREE|I_NEW)) ||\n\t\t    !atomic_read(&inode->i_writecount) ||\n\t\t    !dqinit_needed(inode, type)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t\tspin_unlock(&inode_sb_list_lock);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\treserved = 1;\n#endif\n\t\tiput(old_inode);\n\t\t__dquot_initialize(inode, type);\n\n\t\t/*\n\t\t * We hold a reference to 'inode' so it couldn't have been\n\t\t * removed from s_inodes list while we dropped the\n\t\t * inode_sb_list_lock We cannot iput the inode now as we can be\n\t\t * holding the last reference and we cannot iput it under\n\t\t * inode_sb_list_lock. So we keep the reference and iput it\n\t\t * later.\n\t\t */\n\t\told_inode = inode;\n\t\tspin_lock(&inode_sb_list_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n\tiput(old_inode);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tquota_error(sb, \"Writes happened before quota was turned on \"\n\t\t\t\"thus quota information is probably inconsistent. \"\n\t\t\t\"Please run quotacheck(8)\");\n\t}\n#endif\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "sb",
            "\"Writes happened before quota was turned on \"\n\t\t\t\"thus quota information is probably inconsistent. \"\n\t\t\t\"Please run quotacheck(8)\""
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "old_inode"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode_sb_list_lock"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode_sb_list_lock"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__dquot_initialize",
          "args": [
            "inode",
            "type"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "__dquot_initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1389-1457",
          "snippet": "static void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);",
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_data_lock);\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void __dquot_initialize(struct inode *inode, int type)\n{\n\tint cnt, init_needed = 0;\n\tstruct dquot *got[MAXQUOTAS];\n\tstruct super_block *sb = inode->i_sb;\n\tqsize_t rsv;\n\n\tif (!dquot_active(inode))\n\t\treturn;\n\n\t/* First get references to structures we might need. */\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tstruct kqid qid;\n\t\tgot[cnt] = NULL;\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/*\n\t\t * The i_dquot should have been initialized in most cases,\n\t\t * we check it without locking here to avoid unnecessary\n\t\t * dqget()/dqput() calls.\n\t\t */\n\t\tif (i_dquot(inode)[cnt])\n\t\t\tcontinue;\n\t\tinit_needed = 1;\n\n\t\tswitch (cnt) {\n\t\tcase USRQUOTA:\n\t\t\tqid = make_kqid_uid(inode->i_uid);\n\t\t\tbreak;\n\t\tcase GRPQUOTA:\n\t\t\tqid = make_kqid_gid(inode->i_gid);\n\t\t\tbreak;\n\t\t}\n\t\tgot[cnt] = dqget(sb, qid);\n\t}\n\n\t/* All required i_dquot has been initialized */\n\tif (!init_needed)\n\t\treturn;\n\n\tspin_lock(&dq_data_lock);\n\tif (IS_NOQUOTA(inode))\n\t\tgoto out_err;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\t/* Avoid races with quotaoff() */\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\t/* We could race with quotaon or dqget() could have failed */\n\t\tif (!got[cnt])\n\t\t\tcontinue;\n\t\tif (!i_dquot(inode)[cnt]) {\n\t\t\ti_dquot(inode)[cnt] = got[cnt];\n\t\t\tgot[cnt] = NULL;\n\t\t\t/*\n\t\t\t * Make quota reservation system happy if someone\n\t\t\t * did a write before quota was turned on\n\t\t\t */\n\t\t\trsv = inode_get_rsv_space(inode);\n\t\t\tif (unlikely(rsv))\n\t\t\t\tdquot_resv_space(i_dquot(inode)[cnt], rsv);\n\t\t}\n\t}\nout_err:\n\tspin_unlock(&dq_data_lock);\n\t/* Drop unused references */\n\tdqput_all(got);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "inode_get_rsv_space(inode) > 0"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_get_rsv_space",
          "args": [
            "inode"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "inode_get_rsv_space",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "1557-1567",
          "snippet": "static qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode)\n{\n\tqsize_t ret;\n\n\tif (!inode->i_sb->dq_op->get_reserved_space)\n\t\treturn 0;\n\tspin_lock(&inode->i_lock);\n\tret = *inode_reserved_space(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__iget",
          "args": [
            "inode"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "__iget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "380-383",
          "snippet": "void __iget(struct inode *inode)\n{\n\tatomic_inc(&inode->i_count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid __iget(struct inode *inode)\n{\n\tatomic_inc(&inode->i_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqinit_needed",
          "args": [
            "inode",
            "type"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "dqinit_needed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "901-913",
          "snippet": "static int dqinit_needed(struct inode *inode, int type)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\tif (type != -1)\n\t\treturn !i_dquot(inode)[type];\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (!i_dquot(inode)[cnt])\n\t\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int dqinit_needed(struct inode *inode, int type)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\tif (type != -1)\n\t\treturn !i_dquot(inode)[type];\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (!i_dquot(inode)[cnt])\n\t\t\treturn 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&inode->i_writecount"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&sb->s_inodes",
            "i_sb_list"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void add_dquot_ref(struct super_block *sb, int type)\n{\n\tstruct inode *inode, *old_inode = NULL;\n#ifdef CONFIG_QUOTA_DEBUG\n\tint reserved = 0;\n#endif\n\n\tspin_lock(&inode_sb_list_lock);\n\tlist_for_each_entry(inode, &sb->s_inodes, i_sb_list) {\n\t\tspin_lock(&inode->i_lock);\n\t\tif ((inode->i_state & (I_FREEING|I_WILL_FREE|I_NEW)) ||\n\t\t    !atomic_read(&inode->i_writecount) ||\n\t\t    !dqinit_needed(inode, type)) {\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tcontinue;\n\t\t}\n\t\t__iget(inode);\n\t\tspin_unlock(&inode->i_lock);\n\t\tspin_unlock(&inode_sb_list_lock);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\t\tif (unlikely(inode_get_rsv_space(inode) > 0))\n\t\t\treserved = 1;\n#endif\n\t\tiput(old_inode);\n\t\t__dquot_initialize(inode, type);\n\n\t\t/*\n\t\t * We hold a reference to 'inode' so it couldn't have been\n\t\t * removed from s_inodes list while we dropped the\n\t\t * inode_sb_list_lock We cannot iput the inode now as we can be\n\t\t * holding the last reference and we cannot iput it under\n\t\t * inode_sb_list_lock. So we keep the reference and iput it\n\t\t * later.\n\t\t */\n\t\told_inode = inode;\n\t\tspin_lock(&inode_sb_list_lock);\n\t}\n\tspin_unlock(&inode_sb_list_lock);\n\tiput(old_inode);\n\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (reserved) {\n\t\tquota_error(sb, \"Writes happened before quota was turned on \"\n\t\t\t\"thus quota information is probably inconsistent. \"\n\t\t\t\"Please run quotacheck(8)\");\n\t}\n#endif\n}"
  },
  {
    "function_name": "dqinit_needed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "901-913",
    "snippet": "static int dqinit_needed(struct inode *inode, int type)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\tif (type != -1)\n\t\treturn !i_dquot(inode)[type];\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (!i_dquot(inode)[cnt])\n\t\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "i_dquot",
          "args": [
            "inode"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "i_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "896-899",
          "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static qsize_t inode_get_rsv_space(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_NOQUOTA",
          "args": [
            "inode"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic int dqinit_needed(struct inode *inode, int type)\n{\n\tint cnt;\n\n\tif (IS_NOQUOTA(inode))\n\t\treturn 0;\n\tif (type != -1)\n\t\treturn !i_dquot(inode)[type];\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif (!i_dquot(inode)[cnt])\n\t\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "i_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "896-899",
    "snippet": "static inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static qsize_t inode_get_rsv_space(struct inode *inode);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode->i_sb->s_op->get_dquots",
          "args": [
            "inode"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic qsize_t inode_get_rsv_space(struct inode *inode);\n\nstatic inline struct dquot **i_dquot(struct inode *inode)\n{\n\treturn inode->i_sb->s_op->get_dquots(inode);\n}"
  },
  {
    "function_name": "dqget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "832-893",
    "snippet": "struct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);",
      "static LIST_HEAD(inuse_list);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_destroy_dquot",
          "args": [
            "empty"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "do_destroy_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "502-505",
          "snippet": "static inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!dquot->dq_sb"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->dq_op->acquire_dquot",
          "args": [
            "dquot"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_on_dquot",
          "args": [
            "dquot"
          ],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "wait_on_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "324-328",
          "snippet": "static void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_LOOKUPS"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_CACHE_HITS"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remove_free_dquot",
          "args": [
            "dquot"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "remove_free_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "299-305",
          "snippet": "static inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_LOOKUPS"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "insert_dquot_hash",
          "args": [
            "dquot"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "insert_dquot_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "266-271",
          "snippet": "static inline void insert_dquot_hash(struct dquot *dquot)\n{\n\tstruct hlist_head *head;\n\thead = dquot_hash + hashfn(dquot->dq_sb, dquot->dq_id);\n\thlist_add_head(&dquot->dq_hash, head);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_head *dquot_hash;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct hlist_head *dquot_hash;\n\nstatic inline void insert_dquot_hash(struct dquot *dquot)\n{\n\tstruct hlist_head *head;\n\thead = dquot_hash + hashfn(dquot->dq_sb, dquot->dq_id);\n\thlist_add_head(&dquot->dq_hash, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_inuse",
          "args": [
            "dquot"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "put_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "307-313",
          "snippet": "static inline void put_inuse(struct dquot *dquot)\n{\n\t/* We add to the back of inuse list so we don't have to restart\n\t * when traversing this list and we block */\n\tlist_add_tail(&dquot->dq_inuse, &inuse_list);\n\tdqstats_inc(DQST_ALLOC_DQUOTS);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(inuse_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic LIST_HEAD(inuse_list);\n\nstatic inline void put_inuse(struct dquot *dquot)\n{\n\t/* We add to the back of inuse list so we don't have to restart\n\t * when traversing this list and we block */\n\tlist_add_tail(&dquot->dq_inuse, &inuse_list);\n\tdqstats_inc(DQST_ALLOC_DQUOTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_empty_dquot",
          "args": [
            "sb",
            "qid.type"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "get_empty_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "803-822",
          "snippet": "static struct dquot *get_empty_dquot(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot;\n\n\tdquot = sb->dq_op->alloc_dquot(sb, type);\n\tif(!dquot)\n\t\treturn NULL;\n\n\tmutex_init(&dquot->dq_lock);\n\tINIT_LIST_HEAD(&dquot->dq_free);\n\tINIT_LIST_HEAD(&dquot->dq_inuse);\n\tINIT_HLIST_NODE(&dquot->dq_hash);\n\tINIT_LIST_HEAD(&dquot->dq_dirty);\n\tinit_waitqueue_head(&dquot->dq_wait_unused);\n\tdquot->dq_sb = sb;\n\tdquot->dq_id = make_kqid_invalid(type);\n\tatomic_set(&dquot->dq_count, 1);\n\n\treturn dquot;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic struct dquot *get_empty_dquot(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot;\n\n\tdquot = sb->dq_op->alloc_dquot(sb, type);\n\tif(!dquot)\n\t\treturn NULL;\n\n\tmutex_init(&dquot->dq_lock);\n\tINIT_LIST_HEAD(&dquot->dq_free);\n\tINIT_LIST_HEAD(&dquot->dq_inuse);\n\tINIT_HLIST_NODE(&dquot->dq_hash);\n\tINIT_LIST_HEAD(&dquot->dq_dirty);\n\tinit_waitqueue_head(&dquot->dq_wait_unused);\n\tdquot->dq_sb = sb;\n\tdquot->dq_id = make_kqid_invalid(type);\n\tatomic_set(&dquot->dq_count, 1);\n\n\treturn dquot;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_dquot",
          "args": [
            "hashent",
            "sb",
            "qid"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "find_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "278-290",
          "snippet": "static struct dquot *find_dquot(unsigned int hashent, struct super_block *sb,\n\t\t\t\tstruct kqid qid)\n{\n\tstruct hlist_node *node;\n\tstruct dquot *dquot;\n\n\thlist_for_each (node, dquot_hash+hashent) {\n\t\tdquot = hlist_entry(node, struct dquot, dq_hash);\n\t\tif (dquot->dq_sb == sb && qid_eq(dquot->dq_id, qid))\n\t\t\treturn dquot;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_head *dquot_hash;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct hlist_head *dquot_hash;\n\nstatic struct dquot *find_dquot(unsigned int hashent, struct super_block *sb,\n\t\t\t\tstruct kqid qid)\n{\n\tstruct hlist_node *node;\n\tstruct dquot *dquot;\n\n\thlist_for_each (node, dquot_hash+hashent) {\n\t\tdquot = hlist_entry(node, struct dquot, dq_hash);\n\t\tif (dquot->dq_sb == sb && qid_eq(dquot->dq_id, qid))\n\t\t\treturn dquot;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "qid.type"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_state_lock"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "qid.type"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hashfn",
          "args": [
            "sb",
            "qid"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "hashfn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "252-261",
          "snippet": "static inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int dq_hash_bits, dq_hash_mask;",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic unsigned int dq_hash_bits, dq_hash_mask;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_state_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dqget(struct super_block *sb, struct kqid qid)\n{\n\tunsigned int hashent = hashfn(sb, qid);\n\tstruct dquot *dquot = NULL, *empty = NULL;\n\n        if (!sb_has_quota_active(sb, qid.type))\n\t\treturn NULL;\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tspin_lock(&dq_state_lock);\n\tif (!sb_has_quota_active(sb, qid.type)) {\n\t\tspin_unlock(&dq_state_lock);\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out;\n\t}\n\tspin_unlock(&dq_state_lock);\n\n\tdquot = find_dquot(hashent, sb, qid);\n\tif (!dquot) {\n\t\tif (!empty) {\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tempty = get_empty_dquot(sb, qid.type);\n\t\t\tif (!empty)\n\t\t\t\tschedule();\t/* Try to wait for a moment... */\n\t\t\tgoto we_slept;\n\t\t}\n\t\tdquot = empty;\n\t\tempty = NULL;\n\t\tdquot->dq_id = qid;\n\t\t/* all dquots go on the inuse_list */\n\t\tput_inuse(dquot);\n\t\t/* hash it first so it can be found */\n\t\tinsert_dquot_hash(dquot);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t} else {\n\t\tif (!atomic_read(&dquot->dq_count))\n\t\t\tremove_free_dquot(dquot);\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_CACHE_HITS);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t}\n\t/* Wait for dq_lock - after this we know that either dquot_release() is\n\t * already finished or it will be canceled due to dq_count > 1 test */\n\twait_on_dquot(dquot);\n\t/* Read the dquot / allocate space in quota file */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) &&\n\t    sb->dq_op->acquire_dquot(dquot) < 0) {\n\t\tdqput(dquot);\n\t\tdquot = NULL;\n\t\tgoto out;\n\t}\n#ifdef CONFIG_QUOTA_DEBUG\n\tBUG_ON(!dquot->dq_sb);\t/* Has somebody invalidated entry under us? */\n#endif\nout:\n\tif (empty)\n\t\tdo_destroy_dquot(empty);\n\n\treturn dquot;\n}"
  },
  {
    "function_name": "get_empty_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "803-822",
    "snippet": "static struct dquot *get_empty_dquot(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot;\n\n\tdquot = sb->dq_op->alloc_dquot(sb, type);\n\tif(!dquot)\n\t\treturn NULL;\n\n\tmutex_init(&dquot->dq_lock);\n\tINIT_LIST_HEAD(&dquot->dq_free);\n\tINIT_LIST_HEAD(&dquot->dq_inuse);\n\tINIT_HLIST_NODE(&dquot->dq_hash);\n\tINIT_LIST_HEAD(&dquot->dq_dirty);\n\tinit_waitqueue_head(&dquot->dq_wait_unused);\n\tdquot->dq_sb = sb;\n\tdquot->dq_id = make_kqid_invalid(type);\n\tatomic_set(&dquot->dq_count, 1);\n\n\treturn dquot;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&dquot->dq_count",
            "1"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kqid_invalid",
          "args": [
            "type"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_waitqueue_head",
          "args": [
            "&dquot->dq_wait_unused"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dquot->dq_dirty"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_NODE",
          "args": [
            "&dquot->dq_hash"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dquot->dq_inuse"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->dq_op->alloc_dquot",
          "args": [
            "sb",
            "type"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic struct dquot *get_empty_dquot(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot;\n\n\tdquot = sb->dq_op->alloc_dquot(sb, type);\n\tif(!dquot)\n\t\treturn NULL;\n\n\tmutex_init(&dquot->dq_lock);\n\tINIT_LIST_HEAD(&dquot->dq_free);\n\tINIT_LIST_HEAD(&dquot->dq_inuse);\n\tINIT_HLIST_NODE(&dquot->dq_hash);\n\tINIT_LIST_HEAD(&dquot->dq_dirty);\n\tinit_waitqueue_head(&dquot->dq_wait_unused);\n\tdquot->dq_sb = sb;\n\tdquot->dq_id = make_kqid_invalid(type);\n\tatomic_set(&dquot->dq_count, 1);\n\n\treturn dquot;\n}"
  },
  {
    "function_name": "dquot_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "797-800",
    "snippet": "struct dquot *dquot_alloc(struct super_block *sb, int type)\n{\n\treturn kmem_cache_zalloc(dquot_cachep, GFP_NOFS);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *dquot_cachep;",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_zalloc",
          "args": [
            "dquot_cachep",
            "GFP_NOFS"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *dquot_cachep;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstruct dquot *dquot_alloc(struct super_block *sb, int type)\n{\n\treturn kmem_cache_zalloc(dquot_cachep, GFP_NOFS);\n}"
  },
  {
    "function_name": "dqput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "734-794",
    "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_dquot_last",
          "args": [
            "dquot"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "put_dquot_last",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "293-297",
          "snippet": "static inline void put_dquot_last(struct dquot *dquot)\n{\n\tlist_add_tail(&dquot->dq_free, &free_dquots);\n\tdqstats_inc(DQST_FREE_DQUOTS);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(free_dquots);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic LIST_HEAD(free_dquots);\n\nstatic inline void put_dquot_last(struct dquot *dquot)\n{\n\tlist_add_tail(&dquot->dq_free, &free_dquots);\n\tdqstats_inc(DQST_FREE_DQUOTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!list_empty(&dquot->dq_free)"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot->dq_sb->dq_op->release_dquot",
          "args": [
            "dquot"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_dquot_dirty",
          "args": [
            "dquot"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "clear_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "385-391",
          "snippet": "static inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "quota_error",
          "args": [
            "dquot->dq_sb",
            "\"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\"",
            "ret"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "__quota_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "132-149",
          "snippet": "void __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nvoid __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dquot->dq_sb->dq_op->write_dquot",
          "args": [
            "dquot"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&dquot->dq_wait_unused"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "locks_wake_up_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/locks.c",
          "lines": "656-681",
          "snippet": "static void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <asm/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/lglock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(blocked_lock_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <asm/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/lglock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(blocked_lock_lock);\n\nstatic void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_DROPS"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "dquot->dq_id"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
  },
  {
    "function_name": "dqcache_shrink_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "718-723",
    "snippet": "static unsigned long\ndqcache_shrink_count(struct shrinker *shrink, struct shrink_control *sc)\n{\n\treturn vfs_pressure_ratio(\n\tpercpu_counter_read_positive(&dqstats.counter[DQST_FREE_DQUOTS]));\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct dqstats dqstats;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_pressure_ratio",
          "args": [
            "percpu_counter_read_positive(&dqstats.counter[DQST_FREE_DQUOTS])"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_read_positive",
          "args": [
            "&dqstats.counter[DQST_FREE_DQUOTS]"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstruct dqstats dqstats;\n\nstatic unsigned long\ndqcache_shrink_count(struct shrinker *shrink, struct shrink_control *sc)\n{\n\treturn vfs_pressure_ratio(\n\tpercpu_counter_read_positive(&dqstats.counter[DQST_FREE_DQUOTS]));\n}"
  },
  {
    "function_name": "dqcache_shrink_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "695-716",
    "snippet": "static unsigned long\ndqcache_shrink_scan(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tstruct list_head *head;\n\tstruct dquot *dquot;\n\tunsigned long freed = 0;\n\n\tspin_lock(&dq_list_lock);\n\thead = free_dquots.prev;\n\twhile (head != &free_dquots && sc->nr_to_scan) {\n\t\tdquot = list_entry(head, struct dquot, dq_free);\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t\tsc->nr_to_scan--;\n\t\tfreed++;\n\t\thead = free_dquots.prev;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn freed;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static LIST_HEAD(free_dquots);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_destroy_dquot",
          "args": [
            "dquot"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "do_destroy_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "502-505",
          "snippet": "static inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_inuse",
          "args": [
            "dquot"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "remove_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "315-319",
          "snippet": "static inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_free_dquot",
          "args": [
            "dquot"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "remove_free_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "299-305",
          "snippet": "static inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_dquot_hash",
          "args": [
            "dquot"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "remove_dquot_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "273-276",
          "snippet": "static inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "head",
            "structdquot",
            "dq_free"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic LIST_HEAD(free_dquots);\n\nstatic unsigned long\ndqcache_shrink_scan(struct shrinker *shrink, struct shrink_control *sc)\n{\n\tstruct list_head *head;\n\tstruct dquot *dquot;\n\tunsigned long freed = 0;\n\n\tspin_lock(&dq_list_lock);\n\thead = free_dquots.prev;\n\twhile (head != &free_dquots && sc->nr_to_scan) {\n\t\tdquot = list_entry(head, struct dquot, dq_free);\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t\tsc->nr_to_scan--;\n\t\tfreed++;\n\t\thead = free_dquots.prev;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn freed;\n}"
  },
  {
    "function_name": "dquot_quota_sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "656-692",
    "snippet": "int dquot_quota_sync(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint ret;\n\n\tret = dquot_writeback_dquots(sb, type);\n\tif (ret)\n\t\treturn ret;\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\treturn 0;\n\n\t/* This is not very clever (and fast) but currently I don't know about\n\t * any other simple way of getting quota data to disk and we must get\n\t * them there for userspace to be visible... */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\n\t/*\n\t * Now when everything is written we can discard the pagecache so\n\t * that userspace sees the changes.\n\t */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tmutex_lock(&dqopt->files[cnt]->i_mutex);\n\t\ttruncate_inode_pages(&dqopt->files[cnt]->i_data, 0);\n\t\tmutex_unlock(&dqopt->files[cnt]->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->files[cnt]->i_mutex"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages",
          "args": [
            "&dqopt->files[cnt]->i_data",
            "0"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->files[cnt]->i_mutex"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sync_blockdev",
          "args": [
            "sb->s_bdev"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "sync_blockdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/block_dev.c",
          "lines": "174-177",
          "snippet": "int sync_blockdev(struct block_device *bdev)\n{\n\treturn __sync_blockdev(bdev, 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/log2.h>",
            "#include <linux/namei.h>",
            "#include <linux/uio.h>",
            "#include <linux/mount.h>",
            "#include <linux/mpage.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/swap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/magic.h>",
            "#include <linux/blkpg.h>",
            "#include <linux/module.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/highmem.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/major.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/cleancache.h>\n#include <linux/log2.h>\n#include <linux/namei.h>\n#include <linux/uio.h>\n#include <linux/mount.h>\n#include <linux/mpage.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/swap.h>\n#include <linux/buffer_head.h>\n#include <linux/magic.h>\n#include <linux/blkpg.h>\n#include <linux/module.h>\n#include <linux/blkdev.h>\n#include <linux/highmem.h>\n#include <linux/device_cgroup.h>\n#include <linux/major.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/fcntl.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n\nint sync_blockdev(struct block_device *bdev)\n{\n\treturn __sync_blockdev(bdev, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->s_op->sync_fs",
          "args": [
            "sb",
            "1"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dquot_writeback_dquots",
          "args": [
            "sb",
            "type"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_writeback_dquots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "605-652",
          "snippet": "int dquot_writeback_dquots(struct super_block *sb, int type)\n{\n\tstruct list_head *dirty;\n\tstruct dquot *dquot;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint err, ret = 0;\n\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tspin_lock(&dq_list_lock);\n\t\tdirty = &dqopt->info[cnt].dqi_dirty_list;\n\t\twhile (!list_empty(dirty)) {\n\t\t\tdquot = list_first_entry(dirty, struct dquot,\n\t\t\t\t\t\t dq_dirty);\n\t\t\t/* Dirty and inactive can be only bad dquot... */\n\t\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\t\tclear_dquot_dirty(dquot);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* Now we have active dquot from which someone is\n \t\t\t * holding reference so we can safely just increase\n\t\t\t * use count */\n\t\t\tdqgrab(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tdqstats_inc(DQST_LOOKUPS);\n\t\t\terr = sb->dq_op->write_dquot(dquot);\n\t\t\tif (!ret && err)\n\t\t\t\tret = err;\n\t\t\tdqput(dquot);\n\t\t\tspin_lock(&dq_list_lock);\n\t\t}\n\t\tspin_unlock(&dq_list_lock);\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif ((cnt == type || type == -1) && sb_has_quota_active(sb, cnt)\n\t\t    && info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\tdqstats_inc(DQST_SYNCS);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_writeback_dquots(struct super_block *sb, int type)\n{\n\tstruct list_head *dirty;\n\tstruct dquot *dquot;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint err, ret = 0;\n\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tspin_lock(&dq_list_lock);\n\t\tdirty = &dqopt->info[cnt].dqi_dirty_list;\n\t\twhile (!list_empty(dirty)) {\n\t\t\tdquot = list_first_entry(dirty, struct dquot,\n\t\t\t\t\t\t dq_dirty);\n\t\t\t/* Dirty and inactive can be only bad dquot... */\n\t\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\t\tclear_dquot_dirty(dquot);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* Now we have active dquot from which someone is\n \t\t\t * holding reference so we can safely just increase\n\t\t\t * use count */\n\t\t\tdqgrab(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tdqstats_inc(DQST_LOOKUPS);\n\t\t\terr = sb->dq_op->write_dquot(dquot);\n\t\t\tif (!ret && err)\n\t\t\t\tret = err;\n\t\t\tdqput(dquot);\n\t\t\tspin_lock(&dq_list_lock);\n\t\t}\n\t\tspin_unlock(&dq_list_lock);\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif ((cnt == type || type == -1) && sb_has_quota_active(sb, cnt)\n\t\t    && info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\tdqstats_inc(DQST_SYNCS);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_quota_sync(struct super_block *sb, int type)\n{\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint ret;\n\n\tret = dquot_writeback_dquots(sb, type);\n\tif (ret)\n\t\treturn ret;\n\tif (dqopt->flags & DQUOT_QUOTA_SYS_FILE)\n\t\treturn 0;\n\n\t/* This is not very clever (and fast) but currently I don't know about\n\t * any other simple way of getting quota data to disk and we must get\n\t * them there for userspace to be visible... */\n\tif (sb->s_op->sync_fs)\n\t\tsb->s_op->sync_fs(sb, 1);\n\tsync_blockdev(sb->s_bdev);\n\n\t/*\n\t * Now when everything is written we can discard the pagecache so\n\t * that userspace sees the changes.\n\t */\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tmutex_lock(&dqopt->files[cnt]->i_mutex);\n\t\ttruncate_inode_pages(&dqopt->files[cnt]->i_data, 0);\n\t\tmutex_unlock(&dqopt->files[cnt]->i_mutex);\n\t}\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "dquot_writeback_dquots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "605-652",
    "snippet": "int dquot_writeback_dquots(struct super_block *sb, int type)\n{\n\tstruct list_head *dirty;\n\tstruct dquot *dquot;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint err, ret = 0;\n\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tspin_lock(&dq_list_lock);\n\t\tdirty = &dqopt->info[cnt].dqi_dirty_list;\n\t\twhile (!list_empty(dirty)) {\n\t\t\tdquot = list_first_entry(dirty, struct dquot,\n\t\t\t\t\t\t dq_dirty);\n\t\t\t/* Dirty and inactive can be only bad dquot... */\n\t\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\t\tclear_dquot_dirty(dquot);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* Now we have active dquot from which someone is\n \t\t\t * holding reference so we can safely just increase\n\t\t\t * use count */\n\t\t\tdqgrab(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tdqstats_inc(DQST_LOOKUPS);\n\t\t\terr = sb->dq_op->write_dquot(dquot);\n\t\t\tif (!ret && err)\n\t\t\t\tret = err;\n\t\t\tdqput(dquot);\n\t\t\tspin_lock(&dq_list_lock);\n\t\t}\n\t\tspin_unlock(&dq_list_lock);\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif ((cnt == type || type == -1) && sb_has_quota_active(sb, cnt)\n\t\t    && info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\tdqstats_inc(DQST_SYNCS);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_SYNCS"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb->dq_op->write_info",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info_dirty",
          "args": [
            "&dqopt->info[cnt]"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "mark_fsinfo_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fatent.c",
          "lines": "311-319",
          "snippet": "static void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/msdos_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/blkdev.h>\n#include <linux/msdos_fs.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb->dq_op->write_dquot",
          "args": [
            "dquot"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_LOOKUPS"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqgrab",
          "args": [
            "dquot"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_dquot_dirty",
          "args": [
            "dquot"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "clear_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "385-391",
          "snippet": "static inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "dirty",
            "structdquot",
            "dq_dirty"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "dirty"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_has_quota_active",
          "args": [
            "sb",
            "cnt"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqonoff_mutex"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_writeback_dquots(struct super_block *sb, int type)\n{\n\tstruct list_head *dirty;\n\tstruct dquot *dquot;\n\tstruct quota_info *dqopt = sb_dqopt(sb);\n\tint cnt;\n\tint err, ret = 0;\n\n\tmutex_lock(&dqopt->dqonoff_mutex);\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (type != -1 && cnt != type)\n\t\t\tcontinue;\n\t\tif (!sb_has_quota_active(sb, cnt))\n\t\t\tcontinue;\n\t\tspin_lock(&dq_list_lock);\n\t\tdirty = &dqopt->info[cnt].dqi_dirty_list;\n\t\twhile (!list_empty(dirty)) {\n\t\t\tdquot = list_first_entry(dirty, struct dquot,\n\t\t\t\t\t\t dq_dirty);\n\t\t\t/* Dirty and inactive can be only bad dquot... */\n\t\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\t\tclear_dquot_dirty(dquot);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t/* Now we have active dquot from which someone is\n \t\t\t * holding reference so we can safely just increase\n\t\t\t * use count */\n\t\t\tdqgrab(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\tdqstats_inc(DQST_LOOKUPS);\n\t\t\terr = sb->dq_op->write_dquot(dquot);\n\t\t\tif (!ret && err)\n\t\t\t\tret = err;\n\t\t\tdqput(dquot);\n\t\t\tspin_lock(&dq_list_lock);\n\t\t}\n\t\tspin_unlock(&dq_list_lock);\n\t}\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tif ((cnt == type || type == -1) && sb_has_quota_active(sb, cnt)\n\t\t    && info_dirty(&dqopt->info[cnt]))\n\t\t\tsb->dq_op->write_info(sb, cnt);\n\tdqstats_inc(DQST_SYNCS);\n\tmutex_unlock(&dqopt->dqonoff_mutex);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_scan_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "561-601",
    "snippet": "int dquot_scan_active(struct super_block *sb,\n\t\t      int (*fn)(struct dquot *dquot, unsigned long priv),\n\t\t      unsigned long priv)\n{\n\tstruct dquot *dquot, *old_dquot = NULL;\n\tint ret = 0;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry(dquot, &inuse_list, dq_inuse) {\n\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags))\n\t\t\tcontinue;\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\t/* Now we have active dquot so we can just increase use count */\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t\tdqput(old_dquot);\n\t\told_dquot = dquot;\n\t\t/*\n\t\t * ->release_dquot() can be racing with us. Our reference\n\t\t * protects us from new calls to it so just wait for any\n\t\t * outstanding call and recheck the DQ_ACTIVE_B after that.\n\t\t */\n\t\twait_on_dquot(dquot);\n\t\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\tret = fn(dquot, priv);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto out;\n\t\t}\n\t\tspin_lock(&dq_list_lock);\n\t\t/* We are safe to continue now because our dquot could not\n\t\t * be moved out of the inuse list while we hold the reference */\n\t}\n\tspin_unlock(&dq_list_lock);\nout:\n\tdqput(old_dquot);\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static LIST_HEAD(inuse_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "old_dquot"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fn",
          "args": [
            "dquot",
            "priv"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "hashfn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "252-261",
          "snippet": "static inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int dq_hash_bits, dq_hash_mask;",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic unsigned int dq_hash_bits, dq_hash_mask;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_on_dquot",
          "args": [
            "dquot"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "wait_on_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "324-328",
          "snippet": "static void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_LOOKUPS"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "dquot",
            "&inuse_list",
            "dq_inuse"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sb_dqopt(sb)->dqonoff_mutex"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic LIST_HEAD(inuse_list);\n\nint dquot_scan_active(struct super_block *sb,\n\t\t      int (*fn)(struct dquot *dquot, unsigned long priv),\n\t\t      unsigned long priv)\n{\n\tstruct dquot *dquot, *old_dquot = NULL;\n\tint ret = 0;\n\n\tmutex_lock(&sb_dqopt(sb)->dqonoff_mutex);\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry(dquot, &inuse_list, dq_inuse) {\n\t\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags))\n\t\t\tcontinue;\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\t/* Now we have active dquot so we can just increase use count */\n\t\tatomic_inc(&dquot->dq_count);\n\t\tspin_unlock(&dq_list_lock);\n\t\tdqstats_inc(DQST_LOOKUPS);\n\t\tdqput(old_dquot);\n\t\told_dquot = dquot;\n\t\t/*\n\t\t * ->release_dquot() can be racing with us. Our reference\n\t\t * protects us from new calls to it so just wait for any\n\t\t * outstanding call and recheck the DQ_ACTIVE_B after that.\n\t\t */\n\t\twait_on_dquot(dquot);\n\t\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\t\tret = fn(dquot, priv);\n\t\t\tif (ret < 0)\n\t\t\t\tgoto out;\n\t\t}\n\t\tspin_lock(&dq_list_lock);\n\t\t/* We are safe to continue now because our dquot could not\n\t\t * be moved out of the inuse list while we hold the reference */\n\t}\n\tspin_unlock(&dq_list_lock);\nout:\n\tdqput(old_dquot);\n\tmutex_unlock(&sb_dqopt(sb)->dqonoff_mutex);\n\treturn ret;\n}"
  },
  {
    "function_name": "invalidate_dquots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "513-558",
    "snippet": "static void invalidate_dquots(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot, *tmp;\n\nrestart:\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry_safe(dquot, tmp, &inuse_list, dq_inuse) {\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\tif (dquot->dq_id.type != type)\n\t\t\tcontinue;\n\t\t/* Wait for dquot users */\n\t\tif (atomic_read(&dquot->dq_count)) {\n\t\t\tDEFINE_WAIT(wait);\n\n\t\t\tdqgrab(dquot);\n\t\t\tprepare_to_wait(&dquot->dq_wait_unused, &wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\t/* Once dqput() wakes us up, we know it's time to free\n\t\t\t * the dquot.\n\t\t\t * IMPORTANT: we rely on the fact that there is always\n\t\t\t * at most one process waiting for dquot to free.\n\t\t\t * Otherwise dq_count would be > 1 and we would never\n\t\t\t * wake up.\n\t\t\t */\n\t\t\tif (atomic_read(&dquot->dq_count) > 1)\n\t\t\t\tschedule();\n\t\t\tfinish_wait(&dquot->dq_wait_unused, &wait);\n\t\t\tdqput(dquot);\n\t\t\t/* At this moment dquot() need not exist (it could be\n\t\t\t * reclaimed by prune_dqcache(). Hence we must\n\t\t\t * restart. */\n\t\t\tgoto restart;\n\t\t}\n\t\t/*\n\t\t * Quota now has no users and it has been written on last\n\t\t * dqput()\n\t\t */\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t}\n\tspin_unlock(&dq_list_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static LIST_HEAD(inuse_list);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_destroy_dquot",
          "args": [
            "dquot"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "do_destroy_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "502-505",
          "snippet": "static inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_inuse",
          "args": [
            "dquot"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "remove_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "315-319",
          "snippet": "static inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_free_dquot",
          "args": [
            "dquot"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "remove_free_dquot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "299-305",
          "snippet": "static inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_dquot_hash",
          "args": [
            "dquot"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "remove_dquot_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "273-276",
          "snippet": "static inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "&dquot->dq_wait_unused",
            "&wait"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "&dquot->dq_wait_unused",
            "&wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqgrab",
          "args": [
            "dquot"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT",
          "args": [
            "wait"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "dquot",
            "tmp",
            "&inuse_list",
            "dq_inuse"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic LIST_HEAD(inuse_list);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic void invalidate_dquots(struct super_block *sb, int type)\n{\n\tstruct dquot *dquot, *tmp;\n\nrestart:\n\tspin_lock(&dq_list_lock);\n\tlist_for_each_entry_safe(dquot, tmp, &inuse_list, dq_inuse) {\n\t\tif (dquot->dq_sb != sb)\n\t\t\tcontinue;\n\t\tif (dquot->dq_id.type != type)\n\t\t\tcontinue;\n\t\t/* Wait for dquot users */\n\t\tif (atomic_read(&dquot->dq_count)) {\n\t\t\tDEFINE_WAIT(wait);\n\n\t\t\tdqgrab(dquot);\n\t\t\tprepare_to_wait(&dquot->dq_wait_unused, &wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t\t/* Once dqput() wakes us up, we know it's time to free\n\t\t\t * the dquot.\n\t\t\t * IMPORTANT: we rely on the fact that there is always\n\t\t\t * at most one process waiting for dquot to free.\n\t\t\t * Otherwise dq_count would be > 1 and we would never\n\t\t\t * wake up.\n\t\t\t */\n\t\t\tif (atomic_read(&dquot->dq_count) > 1)\n\t\t\t\tschedule();\n\t\t\tfinish_wait(&dquot->dq_wait_unused, &wait);\n\t\t\tdqput(dquot);\n\t\t\t/* At this moment dquot() need not exist (it could be\n\t\t\t * reclaimed by prune_dqcache(). Hence we must\n\t\t\t * restart. */\n\t\t\tgoto restart;\n\t\t}\n\t\t/*\n\t\t * Quota now has no users and it has been written on last\n\t\t * dqput()\n\t\t */\n\t\tremove_dquot_hash(dquot);\n\t\tremove_free_dquot(dquot);\n\t\tremove_inuse(dquot);\n\t\tdo_destroy_dquot(dquot);\n\t}\n\tspin_unlock(&dq_list_lock);\n}"
  },
  {
    "function_name": "do_destroy_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "502-505",
    "snippet": "static inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot->dq_sb->dq_op->destroy_dquot",
          "args": [
            "dquot"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void do_destroy_dquot(struct dquot *dquot)\n{\n\tdquot->dq_sb->dq_op->destroy_dquot(dquot);\n}"
  },
  {
    "function_name": "dquot_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "496-499",
    "snippet": "void dquot_destroy(struct dquot *dquot)\n{\n\tkmem_cache_free(dquot_cachep, dquot);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *dquot_cachep;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "dquot_cachep",
            "dquot"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct kmem_cache *dquot_cachep;\n\nvoid dquot_destroy(struct dquot *dquot)\n{\n\tkmem_cache_free(dquot_cachep, dquot);\n}"
  },
  {
    "function_name": "dquot_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "468-493",
    "snippet": "int dquot_release(struct dquot *dquot)\n{\n\tint ret = 0, ret2 = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dquot->dq_lock);\n\t/* Check whether we are not racing with some other dqget() */\n\tif (atomic_read(&dquot->dq_count) > 1)\n\t\tgoto out_dqlock;\n\tmutex_lock(&dqopt->dqio_mutex);\n\tif (dqopt->ops[dquot->dq_id.type]->release_dqblk) {\n\t\tret = dqopt->ops[dquot->dq_id.type]->release_dqblk(dquot);\n\t\t/* Write the info */\n\t\tif (info_dirty(&dqopt->info[dquot->dq_id.type])) {\n\t\t\tret2 = dqopt->ops[dquot->dq_id.type]->write_file_info(\n\t\t\t\t\t\tdquot->dq_sb, dquot->dq_id.type);\n\t\t}\n\t\tif (ret >= 0)\n\t\t\tret = ret2;\n\t}\n\tclear_bit(DQ_ACTIVE_B, &dquot->dq_flags);\n\tmutex_unlock(&dqopt->dqio_mutex);\nout_dqlock:\n\tmutex_unlock(&dquot->dq_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clear_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "892-896",
          "snippet": "static inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_clear_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_clear_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->write_file_info",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info_dirty",
          "args": [
            "&dqopt->info[dquot->dq_id.type]"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "mark_fsinfo_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fatent.c",
          "lines": "311-319",
          "snippet": "static void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/msdos_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/blkdev.h>\n#include <linux/msdos_fs.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->release_dqblk",
          "args": [
            "dquot"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&dquot->dq_count"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_release(struct dquot *dquot)\n{\n\tint ret = 0, ret2 = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dquot->dq_lock);\n\t/* Check whether we are not racing with some other dqget() */\n\tif (atomic_read(&dquot->dq_count) > 1)\n\t\tgoto out_dqlock;\n\tmutex_lock(&dqopt->dqio_mutex);\n\tif (dqopt->ops[dquot->dq_id.type]->release_dqblk) {\n\t\tret = dqopt->ops[dquot->dq_id.type]->release_dqblk(dquot);\n\t\t/* Write the info */\n\t\tif (info_dirty(&dqopt->info[dquot->dq_id.type])) {\n\t\t\tret2 = dqopt->ops[dquot->dq_id.type]->write_file_info(\n\t\t\t\t\t\tdquot->dq_sb, dquot->dq_id.type);\n\t\t}\n\t\tif (ret >= 0)\n\t\t\tret = ret2;\n\t}\n\tclear_bit(DQ_ACTIVE_B, &dquot->dq_flags);\n\tmutex_unlock(&dqopt->dqio_mutex);\nout_dqlock:\n\tmutex_unlock(&dquot->dq_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "441-462",
    "snippet": "int dquot_commit(struct dquot *dquot)\n{\n\tint ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_list_lock);\n\tif (!clear_dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out_sem;\n\t}\n\tspin_unlock(&dq_list_lock);\n\t/* Inactive dquot can be only if there was error during read/init\n\t * => we have better not writing it */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags))\n\t\tret = dqopt->ops[dquot->dq_id.type]->commit_dqblk(dquot);\n\telse\n\t\tret = -EIO;\nout_sem:\n\tmutex_unlock(&dqopt->dqio_mutex);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->commit_dqblk",
          "args": [
            "dquot"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_dquot_dirty",
          "args": [
            "dquot"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "clear_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "385-391",
          "snippet": "static inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_commit(struct dquot *dquot)\n{\n\tint ret = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dqopt->dqio_mutex);\n\tspin_lock(&dq_list_lock);\n\tif (!clear_dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tgoto out_sem;\n\t}\n\tspin_unlock(&dq_list_lock);\n\t/* Inactive dquot can be only if there was error during read/init\n\t * => we have better not writing it */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags))\n\t\tret = dqopt->ops[dquot->dq_id.type]->commit_dqblk(dquot);\n\telse\n\t\tret = -EIO;\nout_sem:\n\tmutex_unlock(&dqopt->dqio_mutex);\n\treturn ret;\n}"
  },
  {
    "function_name": "dquot_acquire",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "403-435",
    "snippet": "int dquot_acquire(struct dquot *dquot)\n{\n\tint ret = 0, ret2 = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_lock(&dqopt->dqio_mutex);\n\tif (!test_bit(DQ_READ_B, &dquot->dq_flags))\n\t\tret = dqopt->ops[dquot->dq_id.type]->read_dqblk(dquot);\n\tif (ret < 0)\n\t\tgoto out_iolock;\n\tset_bit(DQ_READ_B, &dquot->dq_flags);\n\t/* Instantiate dquot if needed */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && !dquot->dq_off) {\n\t\tret = dqopt->ops[dquot->dq_id.type]->commit_dqblk(dquot);\n\t\t/* Write the info if needed */\n\t\tif (info_dirty(&dqopt->info[dquot->dq_id.type])) {\n\t\t\tret2 = dqopt->ops[dquot->dq_id.type]->write_file_info(\n\t\t\t\t\tdquot->dq_sb, dquot->dq_id.type);\n\t\t}\n\t\tif (ret < 0)\n\t\t\tgoto out_iolock;\n\t\tif (ret2 < 0) {\n\t\t\tret = ret2;\n\t\t\tgoto out_iolock;\n\t\t}\n\t}\n\tset_bit(DQ_ACTIVE_B, &dquot->dq_flags);\nout_iolock:\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tmutex_unlock(&dquot->dq_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->write_file_info",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id.type"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info_dirty",
          "args": [
            "&dqopt->info[dquot->dq_id.type]"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "mark_fsinfo_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/fat/fatent.c",
          "lines": "311-319",
          "snippet": "static void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}",
          "includes": [
            "#include \"fat.h\"",
            "#include <linux/blkdev.h>",
            "#include <linux/msdos_fs.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fat.h\"\n#include <linux/blkdev.h>\n#include <linux/msdos_fs.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void mark_fsinfo_dirty(struct super_block *sb)\n{\n\tstruct msdos_sb_info *sbi = MSDOS_SB(sb);\n\n\tif (sb->s_flags & MS_RDONLY || sbi->fat_bits != 32)\n\t\treturn;\n\n\t__mark_inode_dirty(sbi->fsinfo_inode, I_DIRTY_SYNC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->commit_dqblk",
          "args": [
            "dquot"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_ACTIVE_B",
            "&dquot->dq_flags"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqopt->ops[dquot->dq_id.type]->read_dqblk",
          "args": [
            "dquot"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dqopt->dqio_mutex"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_acquire(struct dquot *dquot)\n{\n\tint ret = 0, ret2 = 0;\n\tstruct quota_info *dqopt = sb_dqopt(dquot->dq_sb);\n\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_lock(&dqopt->dqio_mutex);\n\tif (!test_bit(DQ_READ_B, &dquot->dq_flags))\n\t\tret = dqopt->ops[dquot->dq_id.type]->read_dqblk(dquot);\n\tif (ret < 0)\n\t\tgoto out_iolock;\n\tset_bit(DQ_READ_B, &dquot->dq_flags);\n\t/* Instantiate dquot if needed */\n\tif (!test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && !dquot->dq_off) {\n\t\tret = dqopt->ops[dquot->dq_id.type]->commit_dqblk(dquot);\n\t\t/* Write the info if needed */\n\t\tif (info_dirty(&dqopt->info[dquot->dq_id.type])) {\n\t\t\tret2 = dqopt->ops[dquot->dq_id.type]->write_file_info(\n\t\t\t\t\tdquot->dq_sb, dquot->dq_id.type);\n\t\t}\n\t\tif (ret < 0)\n\t\t\tgoto out_iolock;\n\t\tif (ret2 < 0) {\n\t\t\tret = ret2;\n\t\t\tgoto out_iolock;\n\t\t}\n\t}\n\tset_bit(DQ_ACTIVE_B, &dquot->dq_flags);\nout_iolock:\n\tmutex_unlock(&dqopt->dqio_mutex);\n\tmutex_unlock(&dquot->dq_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "mark_info_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "393-396",
    "snippet": "void mark_info_dirty(struct super_block *sb, int type)\n{\n\tset_bit(DQF_INFO_DIRTY_B, &sb_dqopt(sb)->info[type].dqi_flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "DQF_INFO_DIRTY_B",
            "&sb_dqopt(sb)->info[type].dqi_flags"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_set_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "886-890",
          "snippet": "static inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline void ocfs2_set_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\tocfs2_set_bit(bit, bitmap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "sb"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid mark_info_dirty(struct super_block *sb, int type)\n{\n\tset_bit(DQF_INFO_DIRTY_B, &sb_dqopt(sb)->info[type].dqi_flags);\n}"
  },
  {
    "function_name": "clear_dquot_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "385-391",
    "snippet": "static inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&dquot->dq_dirty"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "DQ_MOD_B",
            "&dquot->dq_flags"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1129-1139",
          "snippet": "static inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_clear_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr &= ~mask;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int clear_dquot_dirty(struct dquot *dquot)\n{\n\tif (!test_and_clear_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 0;\n\tlist_del_init(&dquot->dq_dirty);\n\treturn 1;\n}"
  },
  {
    "function_name": "dqput_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "376-382",
    "snippet": "static inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqput",
          "args": [
            "dquot[cnt]"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "dqput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "734-794",
          "snippet": "void dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nvoid dqput(struct dquot *dquot)\n{\n\tint ret;\n\n\tif (!dquot)\n\t\treturn;\n#ifdef CONFIG_QUOTA_DEBUG\n\tif (!atomic_read(&dquot->dq_count)) {\n\t\tquota_error(dquot->dq_sb, \"trying to free free dquot of %s %d\",\n\t\t\t    quotatypes[dquot->dq_id.type],\n\t\t\t    from_kqid(&init_user_ns, dquot->dq_id));\n\t\tBUG();\n\t}\n#endif\n\tdqstats_inc(DQST_DROPS);\nwe_slept:\n\tspin_lock(&dq_list_lock);\n\tif (atomic_read(&dquot->dq_count) > 1) {\n\t\t/* We have more than one user... nothing to do */\n\t\tatomic_dec(&dquot->dq_count);\n\t\t/* Releasing dquot during quotaoff phase? */\n\t\tif (!sb_has_quota_active(dquot->dq_sb, dquot->dq_id.type) &&\n\t\t    atomic_read(&dquot->dq_count) == 1)\n\t\t\twake_up(&dquot->dq_wait_unused);\n\t\tspin_unlock(&dq_list_lock);\n\t\treturn;\n\t}\n\t/* Need to release dquot? */\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags) && dquot_dirty(dquot)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\t/* Commit dquot before releasing */\n\t\tret = dquot->dq_sb->dq_op->write_dquot(dquot);\n\t\tif (ret < 0) {\n\t\t\tquota_error(dquot->dq_sb, \"Can't write quota structure\"\n\t\t\t\t    \" (error %d). Quota may get out of sync!\",\n\t\t\t\t    ret);\n\t\t\t/*\n\t\t\t * We clear dirty bit anyway, so that we avoid\n\t\t\t * infinite loop here\n\t\t\t */\n\t\t\tspin_lock(&dq_list_lock);\n\t\t\tclear_dquot_dirty(dquot);\n\t\t\tspin_unlock(&dq_list_lock);\n\t\t}\n\t\tgoto we_slept;\n\t}\n\t/* Clear flag in case dquot was inactive (something bad happened) */\n\tclear_dquot_dirty(dquot);\n\tif (test_bit(DQ_ACTIVE_B, &dquot->dq_flags)) {\n\t\tspin_unlock(&dq_list_lock);\n\t\tdquot->dq_sb->dq_op->release_dquot(dquot);\n\t\tgoto we_slept;\n\t}\n\tatomic_dec(&dquot->dq_count);\n#ifdef CONFIG_QUOTA_DEBUG\n\t/* sanity check */\n\tBUG_ON(!list_empty(&dquot->dq_free));\n#endif\n\tput_dquot_last(dquot);\n\tspin_unlock(&dq_list_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void dqput_all(struct dquot **dquot)\n{\n\tunsigned int cnt;\n\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++)\n\t\tdqput(dquot[cnt]);\n}"
  },
  {
    "function_name": "mark_all_dquot_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "361-374",
    "snippet": "static inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mark_dquot_dirty",
          "args": [
            "dquot[cnt]"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "dquot_mark_dquot_dirty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "341-357",
          "snippet": "int dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_all_dquot_dirty(struct dquot * const *dquot)\n{\n\tint ret, err, cnt;\n\n\tret = err = 0;\n\tfor (cnt = 0; cnt < MAXQUOTAS; cnt++) {\n\t\tif (dquot[cnt])\n\t\t\t/* Even in case of error we have to continue */\n\t\t\tret = mark_dquot_dirty(dquot[cnt]);\n\t\tif (!err)\n\t\t\terr = ret;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "dquot_mark_dquot_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "341-357",
    "snippet": "int dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&dquot->dq_dirty",
            "&sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "966-972",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb_dqopt",
          "args": [
            "dquot->dq_sb"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "DQ_MOD_B",
            "&dquot->dq_flags"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_test_and_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/f2fs/f2fs.h",
          "lines": "1117-1127",
          "snippet": "static inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}",
          "includes": [
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n\nstatic inline int f2fs_test_and_set_bit(unsigned int nr, char *addr)\n{\n\tint mask;\n\tint ret;\n\n\taddr += (nr >> 3);\n\tmask = 1 << (7 - (nr & 0x07));\n\tret = mask & *addr;\n\t*addr |= mask;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_MOD_B",
            "&dquot->dq_flags"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nint dquot_mark_dquot_dirty(struct dquot *dquot)\n{\n\tint ret = 1;\n\n\t/* If quota is dirty already, we don't have to acquire dq_list_lock */\n\tif (test_bit(DQ_MOD_B, &dquot->dq_flags))\n\t\treturn 1;\n\n\tspin_lock(&dq_list_lock);\n\tif (!test_and_set_bit(DQ_MOD_B, &dquot->dq_flags)) {\n\t\tlist_add(&dquot->dq_dirty, &sb_dqopt(dquot->dq_sb)->\n\t\t\t\tinfo[dquot->dq_id.type].dqi_dirty_list);\n\t\tret = 0;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "mark_dquot_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "335-338",
    "snippet": "static inline int mark_dquot_dirty(struct dquot *dquot)\n{\n\treturn dquot->dq_sb->dq_op->mark_dirty(dquot);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dquot->dq_sb->dq_op->mark_dirty",
          "args": [
            "dquot"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int mark_dquot_dirty(struct dquot *dquot)\n{\n\treturn dquot->dq_sb->dq_op->mark_dirty(dquot);\n}"
  },
  {
    "function_name": "dquot_dirty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "330-333",
    "snippet": "static inline int dquot_dirty(struct dquot *dquot)\n{\n\treturn test_bit(DQ_MOD_B, &dquot->dq_flags);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "DQ_MOD_B",
            "&dquot->dq_flags"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_test_bit_unaligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/ocfs2.h",
          "lines": "898-902",
          "snippet": "static inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}",
          "includes": [
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [
            "#define ocfs2_test_bit test_bit_le"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\n#define ocfs2_test_bit test_bit_le\n\nstatic inline int ocfs2_test_bit_unaligned(int bit, void *bitmap)\n{\n\tbitmap = correct_addr_and_bit_unaligned(&bit, bitmap);\n\treturn ocfs2_test_bit(bit, bitmap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline int dquot_dirty(struct dquot *dquot)\n{\n\treturn test_bit(DQ_MOD_B, &dquot->dq_flags);\n}"
  },
  {
    "function_name": "wait_on_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "324-328",
    "snippet": "static void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dquot->dq_lock"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void wait_on_dquot(struct dquot *dquot)\n{\n\tmutex_lock(&dquot->dq_lock);\n\tmutex_unlock(&dquot->dq_lock);\n}"
  },
  {
    "function_name": "remove_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "315-319",
    "snippet": "static inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&dquot->dq_inuse"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/inode.c",
          "lines": "433-440",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);",
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/bootmem.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\n__cacheline_aligned_in_smp DEFINE_SPINLOCK(inode_sb_list_lock);\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode_sb_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode_sb_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dqstats_dec",
          "args": [
            "DQST_ALLOC_DQUOTS"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_inuse(struct dquot *dquot)\n{\n\tdqstats_dec(DQST_ALLOC_DQUOTS);\n\tlist_del(&dquot->dq_inuse);\n}"
  },
  {
    "function_name": "put_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "307-313",
    "snippet": "static inline void put_inuse(struct dquot *dquot)\n{\n\t/* We add to the back of inuse list so we don't have to restart\n\t * when traversing this list and we block */\n\tlist_add_tail(&dquot->dq_inuse, &inuse_list);\n\tdqstats_inc(DQST_ALLOC_DQUOTS);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(inuse_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_ALLOC_DQUOTS"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&dquot->dq_inuse",
            "&inuse_list"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic LIST_HEAD(inuse_list);\n\nstatic inline void put_inuse(struct dquot *dquot)\n{\n\t/* We add to the back of inuse list so we don't have to restart\n\t * when traversing this list and we block */\n\tlist_add_tail(&dquot->dq_inuse, &inuse_list);\n\tdqstats_inc(DQST_ALLOC_DQUOTS);\n}"
  },
  {
    "function_name": "remove_free_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "299-305",
    "snippet": "static inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqstats_dec",
          "args": [
            "DQST_FREE_DQUOTS"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&dquot->dq_free"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "505-514",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_free_dquot(struct dquot *dquot)\n{\n\tif (list_empty(&dquot->dq_free))\n\t\treturn;\n\tlist_del_init(&dquot->dq_free);\n\tdqstats_dec(DQST_FREE_DQUOTS);\n}"
  },
  {
    "function_name": "put_dquot_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "293-297",
    "snippet": "static inline void put_dquot_last(struct dquot *dquot)\n{\n\tlist_add_tail(&dquot->dq_free, &free_dquots);\n\tdqstats_inc(DQST_FREE_DQUOTS);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(free_dquots);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dqstats_inc",
          "args": [
            "DQST_FREE_DQUOTS"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&dquot->dq_free",
            "&free_dquots"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic LIST_HEAD(free_dquots);\n\nstatic inline void put_dquot_last(struct dquot *dquot)\n{\n\tlist_add_tail(&dquot->dq_free, &free_dquots);\n\tdqstats_inc(DQST_FREE_DQUOTS);\n}"
  },
  {
    "function_name": "find_dquot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "278-290",
    "snippet": "static struct dquot *find_dquot(unsigned int hashent, struct super_block *sb,\n\t\t\t\tstruct kqid qid)\n{\n\tstruct hlist_node *node;\n\tstruct dquot *dquot;\n\n\thlist_for_each (node, dquot_hash+hashent) {\n\t\tdquot = hlist_entry(node, struct dquot, dq_hash);\n\t\tif (dquot->dq_sb == sb && qid_eq(dquot->dq_id, qid))\n\t\t\treturn dquot;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_head *dquot_hash;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qid_eq",
          "args": [
            "dquot->dq_id",
            "qid"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "qid_eq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "12-26",
          "snippet": "bool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nbool qid_eq(struct kqid left, struct kqid right)\n{\n\tif (left.type != right.type)\n\t\treturn false;\n\tswitch(left.type) {\n\tcase USRQUOTA:\n\t\treturn uid_eq(left.uid, right.uid);\n\tcase GRPQUOTA:\n\t\treturn gid_eq(left.gid, right.gid);\n\tcase PRJQUOTA:\n\t\treturn projid_eq(left.projid, right.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_entry",
          "args": [
            "node",
            "structdquot",
            "dq_hash"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each",
          "args": [
            "node",
            "dquot_hash+hashent"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct hlist_head *dquot_hash;\n\nstatic struct dquot *find_dquot(unsigned int hashent, struct super_block *sb,\n\t\t\t\tstruct kqid qid)\n{\n\tstruct hlist_node *node;\n\tstruct dquot *dquot;\n\n\thlist_for_each (node, dquot_hash+hashent) {\n\t\tdquot = hlist_entry(node, struct dquot, dq_hash);\n\t\tif (dquot->dq_sb == sb && qid_eq(dquot->dq_id, qid))\n\t\t\treturn dquot;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "remove_dquot_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "273-276",
    "snippet": "static inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_del_init",
          "args": [
            "&dquot->dq_hash"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic inline void remove_dquot_hash(struct dquot *dquot)\n{\n\thlist_del_init(&dquot->dq_hash);\n}"
  },
  {
    "function_name": "insert_dquot_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "266-271",
    "snippet": "static inline void insert_dquot_hash(struct dquot *dquot)\n{\n\tstruct hlist_head *head;\n\thead = dquot_hash + hashfn(dquot->dq_sb, dquot->dq_id);\n\thlist_add_head(&dquot->dq_hash, head);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct hlist_head *dquot_hash;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_add_head",
          "args": [
            "&dquot->dq_hash",
            "head"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hashfn",
          "args": [
            "dquot->dq_sb",
            "dquot->dq_id"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "hashfn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
          "lines": "252-261",
          "snippet": "static inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include \"../internal.h\" /* ugh */",
            "#include <linux/quotaops.h>",
            "#include <linux/capability.h>",
            "#include <linux/namei.h>",
            "#include <linux/kmod.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/file.h>",
            "#include <linux/tty.h>",
            "#include <linux/stat.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/time.h>",
            "#include <linux/mm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int dq_hash_bits, dq_hash_mask;",
            "static void __dquot_initialize(struct inode *inode, int type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic unsigned int dq_hash_bits, dq_hash_mask;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic struct hlist_head *dquot_hash;\n\nstatic inline void insert_dquot_hash(struct dquot *dquot)\n{\n\tstruct hlist_head *head;\n\thead = dquot_hash + hashfn(dquot->dq_sb, dquot->dq_id);\n\thlist_add_head(&dquot->dq_hash, head);\n}"
  },
  {
    "function_name": "hashfn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "252-261",
    "snippet": "static inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int dq_hash_bits, dq_hash_mask;",
      "static void __dquot_initialize(struct inode *inode, int type);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "from_kqid",
          "args": [
            "&init_user_ns",
            "qid"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "from_kqid_munged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/kqid.c",
          "lines": "100-112",
          "snippet": "qid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/quota.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/quota.h>\n#include <linux/fs.h>\n\nqid_t from_kqid_munged(struct user_namespace *targ, struct kqid kqid)\n{\n\tswitch (kqid.type) {\n\tcase USRQUOTA:\n\t\treturn from_kuid_munged(targ, kqid.uid);\n\tcase GRPQUOTA:\n\t\treturn from_kgid_munged(targ, kqid.gid);\n\tcase PRJQUOTA:\n\t\treturn from_kprojid_munged(targ, kqid.projid);\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic unsigned int dq_hash_bits, dq_hash_mask;\nstatic void __dquot_initialize(struct inode *inode, int type);\n\nstatic inline unsigned int\nhashfn(const struct super_block *sb, struct kqid qid)\n{\n\tunsigned int id = from_kqid(&init_user_ns, qid);\n\tint type = qid.type;\n\tunsigned long tmp;\n\n\ttmp = (((unsigned long)sb>>L1_CACHE_SHIFT) ^ id) * (MAXQUOTAS - type);\n\treturn (tmp + (tmp >> dq_hash_bits)) & dq_hash_mask;\n}"
  },
  {
    "function_name": "put_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "216-219",
    "snippet": "static void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "fmt->qf_owner"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic void put_quota_format(struct quota_format_type *fmt)\n{\n\tmodule_put(fmt->qf_owner);\n}"
  },
  {
    "function_name": "find_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "185-214",
    "snippet": "static struct quota_format_type *find_quota_format(int id)\n{\n\tstruct quota_format_type *actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t     actqf = actqf->qf_next)\n\t\t;\n\tif (!actqf || !try_module_get(actqf->qf_owner)) {\n\t\tint qm;\n\n\t\tspin_unlock(&dq_list_lock);\n\t\t\n\t\tfor (qm = 0; module_names[qm].qm_fmt_id &&\n\t\t\t     module_names[qm].qm_fmt_id != id; qm++)\n\t\t\t;\n\t\tif (!module_names[qm].qm_fmt_id ||\n\t\t    request_module(module_names[qm].qm_mod_name))\n\t\t\treturn NULL;\n\n\t\tspin_lock(&dq_list_lock);\n\t\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t\t     actqf = actqf->qf_next)\n\t\t\t;\n\t\tif (actqf && !try_module_get(actqf->qf_owner))\n\t\t\tactqf = NULL;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn actqf;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static struct quota_format_type *quota_formats;",
      "static struct quota_module_name module_names[] = INIT_QUOTA_MODULE_NAMES;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "actqf->qf_owner"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "module_names[qm].qm_mod_name"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "actqf->qf_owner"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\nstatic struct quota_module_name module_names[] = INIT_QUOTA_MODULE_NAMES;\n\nstatic struct quota_format_type *find_quota_format(int id)\n{\n\tstruct quota_format_type *actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t     actqf = actqf->qf_next)\n\t\t;\n\tif (!actqf || !try_module_get(actqf->qf_owner)) {\n\t\tint qm;\n\n\t\tspin_unlock(&dq_list_lock);\n\t\t\n\t\tfor (qm = 0; module_names[qm].qm_fmt_id &&\n\t\t\t     module_names[qm].qm_fmt_id != id; qm++)\n\t\t\t;\n\t\tif (!module_names[qm].qm_fmt_id ||\n\t\t    request_module(module_names[qm].qm_mod_name))\n\t\t\treturn NULL;\n\n\t\tspin_lock(&dq_list_lock);\n\t\tfor (actqf = quota_formats; actqf && actqf->qf_fmt_id != id;\n\t\t     actqf = actqf->qf_next)\n\t\t\t;\n\t\tif (actqf && !try_module_get(actqf->qf_owner))\n\t\t\tactqf = NULL;\n\t}\n\tspin_unlock(&dq_list_lock);\n\treturn actqf;\n}"
  },
  {
    "function_name": "unregister_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "171-182",
    "snippet": "void unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static struct quota_format_type *quota_formats;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nvoid unregister_quota_format(struct quota_format_type *fmt)\n{\n\tstruct quota_format_type **actqf;\n\n\tspin_lock(&dq_list_lock);\n\tfor (actqf = &quota_formats; *actqf && *actqf != fmt;\n\t     actqf = &(*actqf)->qf_next)\n\t\t;\n\tif (*actqf)\n\t\t*actqf = (*actqf)->qf_next;\n\tspin_unlock(&dq_list_lock);\n}"
  },
  {
    "function_name": "register_quota_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "161-168",
    "snippet": "int register_quota_format(struct quota_format_type *fmt)\n{\n\tspin_lock(&dq_list_lock);\n\tfmt->qf_next = quota_formats;\n\tquota_formats = fmt;\n\tspin_unlock(&dq_list_lock);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);",
      "static struct quota_format_type *quota_formats;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_unlock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "139-144",
          "snippet": "static inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_unlock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_unlock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&dq_list_lock"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "__spin_lock_mb_cache_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/mbcache.c",
          "lines": "132-137",
          "snippet": "static inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}",
          "includes": [
            "#include <linux/log2.h>",
            "#include <linux/blockgroup_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/mbcache.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hash.h>",
            "#include <linux/module.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct blockgroup_lock *mb_cache_bg_lock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/log2.h>\n#include <linux/blockgroup_lock.h>\n#include <linux/init.h>\n#include <linux/mbcache.h>\n#include <linux/list_bl.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hash.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic struct blockgroup_lock *mb_cache_bg_lock;\n\nstatic inline void\n__spin_lock_mb_cache_entry(struct mb_cache_entry *ce)\n{\n\tspin_lock(bgl_lock_ptr(mb_cache_bg_lock,\n\t\tMB_CACHE_ENTRY_LOCK_INDEX(ce)));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nstatic __cacheline_aligned_in_smp DEFINE_SPINLOCK(dq_list_lock);\nstatic struct quota_format_type *quota_formats;\n\nint register_quota_format(struct quota_format_type *fmt)\n{\n\tspin_lock(&dq_list_lock);\n\tfmt->qf_next = quota_formats;\n\tquota_formats = fmt;\n\tspin_unlock(&dq_list_lock);\n\treturn 0;\n}"
  },
  {
    "function_name": "__quota_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/quota/dquot.c",
    "lines": "132-149",
    "snippet": "void __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include \"../internal.h\" /* ugh */",
      "#include <linux/quotaops.h>",
      "#include <linux/capability.h>",
      "#include <linux/namei.h>",
      "#include <linux/kmod.h>",
      "#include <linux/sched.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/init.h>",
      "#include <linux/sysctl.h>",
      "#include <linux/slab.h>",
      "#include <linux/file.h>",
      "#include <linux/tty.h>",
      "#include <linux/stat.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/time.h>",
      "#include <linux/mm.h>",
      "#include <linux/mount.h>",
      "#include <linux/fs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/errno.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"Quota error (device %s): %s: %pV\\n\"",
            "sb->s_id",
            "func",
            "&vaf"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_ratelimit",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include \"../internal.h\" /* ugh */\n#include <linux/quotaops.h>\n#include <linux/capability.h>\n#include <linux/namei.h>\n#include <linux/kmod.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/file.h>\n#include <linux/tty.h>\n#include <linux/stat.h>\n#include <linux/fcntl.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/time.h>\n#include <linux/mm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nvoid __quota_error(struct super_block *sb, const char *func,\n\t\t   const char *fmt, ...)\n{\n\tif (printk_ratelimit()) {\n\t\tva_list args;\n\t\tstruct va_format vaf;\n\n\t\tva_start(args, fmt);\n\n\t\tvaf.fmt = fmt;\n\t\tvaf.va = &args;\n\n\t\tprintk(KERN_ERR \"Quota error (device %s): %s: %pV\\n\",\n\t\t       sb->s_id, func, &vaf);\n\n\t\tva_end(args);\n\t}\n}"
  }
]