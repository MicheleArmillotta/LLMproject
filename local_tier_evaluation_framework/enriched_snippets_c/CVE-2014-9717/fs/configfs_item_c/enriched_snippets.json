[
  {
    "function_name": "config_group_find_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "198-213",
    "snippet": "struct config_item *config_group_find_item(struct config_group *group,\n\t\t\t\t\t   const char *name)\n{\n\tstruct list_head *entry;\n\tstruct config_item *ret = NULL;\n\n\tlist_for_each(entry, &group->cg_children) {\n\t\tstruct config_item *item = to_item(entry);\n\t\tif (config_item_name(item) &&\n\t\t    !strcmp(config_item_name(item), name)) {\n\t\t\tret = config_item_get(item);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_get",
          "args": [
            "item"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "134-139",
          "snippet": "struct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "config_item_name(item)",
            "name"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/xattr.c",
          "lines": "667-675",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <asm/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "item"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "item"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_item",
          "args": [
            "entry"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "to_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "38-41",
          "snippet": "static inline struct config_item *to_item(struct list_head *entry)\n{\n\treturn container_of(entry, struct config_item, ci_entry);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstatic inline struct config_item *to_item(struct list_head *entry)\n{\n\treturn container_of(entry, struct config_item, ci_entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each",
          "args": [
            "entry",
            "&group->cg_children"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_group_find_item(struct config_group *group,\n\t\t\t\t\t   const char *name)\n{\n\tstruct list_head *entry;\n\tstruct config_item *ret = NULL;\n\n\tlist_for_each(entry, &group->cg_children) {\n\t\tstruct config_item *item = to_item(entry);\n\t\tif (config_item_name(item) &&\n\t\t    !strcmp(config_item_name(item), name)) {\n\t\t\tret = config_item_get(item);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "config_group_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "182-186",
    "snippet": "void config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&group->cg_children"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_init",
          "args": [
            "&group->cg_item"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "50-54",
          "snippet": "void config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}"
  },
  {
    "function_name": "config_item_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "171-175",
    "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&item->ci_kref",
            "config_item_release"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
  },
  {
    "function_name": "config_item_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "160-163",
    "snippet": "static void config_item_release(struct kref *kref)\n{\n\tconfig_item_cleanup(container_of(kref, struct config_item, ci_kref));\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void config_item_release(struct kref *kref);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstatic void config_item_release(struct kref *kref);\n\nstatic void config_item_release(struct kref *kref)\n{\n\tconfig_item_cleanup(container_of(kref, struct config_item, ci_kref));\n}"
  },
  {
    "function_name": "config_item_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "142-158",
    "snippet": "static void config_item_cleanup(struct config_item *item)\n{\n\tstruct config_item_type *t = item->ci_type;\n\tstruct config_group *s = item->ci_group;\n\tstruct config_item *parent = item->ci_parent;\n\n\tpr_debug(\"config_item %s: cleaning up\\n\", config_item_name(item));\n\tif (item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\titem->ci_name = NULL;\n\tif (t && t->ct_item_ops && t->ct_item_ops->release)\n\t\tt->ct_item_ops->release(item);\n\tif (s)\n\t\tconfig_group_put(s);\n\tif (parent)\n\t\tconfig_item_put(parent);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_put",
          "args": [
            "parent"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "171-175",
          "snippet": "void config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_put(struct config_item *item)\n{\n\tif (item)\n\t\tkref_put(&item->ci_kref, config_item_release);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_group_put",
          "args": [
            "s"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->ct_item_ops->release",
          "args": [
            "item"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "item->ci_name"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"config_item %s: cleaning up\\n\"",
            "config_item_name(item)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_item_name",
          "args": [
            "item"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstatic void config_item_cleanup(struct config_item *item)\n{\n\tstruct config_item_type *t = item->ci_type;\n\tstruct config_group *s = item->ci_group;\n\tstruct config_item *parent = item->ci_parent;\n\n\tpr_debug(\"config_item %s: cleaning up\\n\", config_item_name(item));\n\tif (item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\titem->ci_name = NULL;\n\tif (t && t->ct_item_ops && t->ct_item_ops->release)\n\t\tt->ct_item_ops->release(item);\n\tif (s)\n\t\tconfig_group_put(s);\n\tif (parent)\n\t\tconfig_item_put(parent);\n}"
  },
  {
    "function_name": "config_item_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "134-139",
    "snippet": "struct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&item->ci_kref"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstruct config_item *config_item_get(struct config_item *item)\n{\n\tif (item)\n\t\tkref_get(&item->ci_kref);\n\treturn item;\n}"
  },
  {
    "function_name": "config_group_init_type_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "125-131",
    "snippet": "void config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_group_init",
          "args": [
            "group"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "config_group_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "182-186",
          "snippet": "void config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init(struct config_group *group)\n{\n\tconfig_item_init(&group->cg_item);\n\tINIT_LIST_HEAD(&group->cg_children);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_set_name",
          "args": [
            "&group->cg_item",
            "name"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_set_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "66-112",
          "snippet": "int config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nint config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_group_init_type_name(struct config_group *group, const char *name,\n\t\t\t struct config_item_type *type)\n{\n\tconfig_item_set_name(&group->cg_item, name);\n\tgroup->cg_item.ci_type = type;\n\tconfig_group_init(group);\n}"
  },
  {
    "function_name": "config_item_init_type_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "115-122",
    "snippet": "void config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_item_init",
          "args": [
            "item"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "50-54",
          "snippet": "void config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_item_set_name",
          "args": [
            "item",
            "name"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "config_item_set_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
          "lines": "66-112",
          "snippet": "int config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}",
          "includes": [
            "#include <linux/configfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/stat.h>",
            "#include <linux/module.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nint config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init_type_name(struct config_item *item,\n\t\t\t\tconst char *name,\n\t\t\t\tstruct config_item_type *type)\n{\n\tconfig_item_set_name(item, name);\n\titem->ci_type = type;\n\tconfig_item_init(item);\n}"
  },
  {
    "function_name": "config_item_set_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "66-112",
    "snippet": "int config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "item->ci_name"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "name"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "name",
            "limit",
            "fmt",
            "args"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "limit",
            "GFP_KERNEL"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "item->ci_namebuf",
            "limit",
            "fmt",
            "args"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nint config_item_set_name(struct config_item *item, const char *fmt, ...)\n{\n\tint error = 0;\n\tint limit = CONFIGFS_ITEM_NAME_LEN;\n\tint need;\n\tva_list args;\n\tchar *name;\n\n\t/*\n\t * First, try the static array\n\t */\n\tva_start(args, fmt);\n\tneed = vsnprintf(item->ci_namebuf, limit, fmt, args);\n\tva_end(args);\n\tif (need < limit)\n\t\tname = item->ci_namebuf;\n\telse {\n\t\t/*\n\t\t * Need more space? Allocate it and try again\n\t\t */\n\t\tlimit = need + 1;\n\t\tname = kmalloc(limit, GFP_KERNEL);\n\t\tif (!name) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Done;\n\t\t}\n\t\tva_start(args, fmt);\n\t\tneed = vsnprintf(name, limit, fmt, args);\n\t\tva_end(args);\n\n\t\t/* Still? Give up. */\n\t\tif (need >= limit) {\n\t\t\tkfree(name);\n\t\t\terror = -EFAULT;\n\t\t\tgoto Done;\n\t\t}\n\t}\n\n\t/* Free the old name, if necessary. */\n\tif (item->ci_name && item->ci_name != item->ci_namebuf)\n\t\tkfree(item->ci_name);\n\n\t/* Now, set the new name */\n\titem->ci_name = name;\n Done:\n\treturn error;\n}"
  },
  {
    "function_name": "config_item_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "50-54",
    "snippet": "void config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&item->ci_entry"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&item->ci_kref"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nvoid config_item_init(struct config_item *item)\n{\n\tkref_init(&item->ci_kref);\n\tINIT_LIST_HEAD(&item->ci_entry);\n}"
  },
  {
    "function_name": "to_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/configfs/item.c",
    "lines": "38-41",
    "snippet": "static inline struct config_item *to_item(struct list_head *entry)\n{\n\treturn container_of(entry, struct config_item, ci_entry);\n}",
    "includes": [
      "#include <linux/configfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/stat.h>",
      "#include <linux/module.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "entry",
            "structconfig_item",
            "ci_entry"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/configfs.h>\n#include <linux/slab.h>\n#include <linux/stat.h>\n#include <linux/module.h>\n#include <linux/string.h>\n\nstatic inline struct config_item *to_item(struct list_head *entry)\n{\n\treturn container_of(entry, struct config_item, ci_entry);\n}"
  }
]