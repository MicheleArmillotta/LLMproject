[
  {
    "function_name": "squashfs_page_actor_init_special",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "83-100",
    "snippet": "struct squashfs_page_actor *squashfs_page_actor_init_special(struct page **page,\n\tint pages, int length)\n{\n\tstruct squashfs_page_actor *actor = kmalloc(sizeof(*actor), GFP_KERNEL);\n\n\tif (actor == NULL)\n\t\treturn NULL;\n\n\tactor->length = length ? : pages * PAGE_CACHE_SIZE;\n\tactor->page = page;\n\tactor->pages = pages;\n\tactor->next_page = 0;\n\tactor->pageaddr = NULL;\n\tactor->squashfs_first_page = direct_first_page;\n\tactor->squashfs_next_page = direct_next_page;\n\tactor->squashfs_finish_page = direct_finish_page;\n\treturn actor;\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*actor)",
            "GFP_KERNEL"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstruct squashfs_page_actor *squashfs_page_actor_init_special(struct page **page,\n\tint pages, int length)\n{\n\tstruct squashfs_page_actor *actor = kmalloc(sizeof(*actor), GFP_KERNEL);\n\n\tif (actor == NULL)\n\t\treturn NULL;\n\n\tactor->length = length ? : pages * PAGE_CACHE_SIZE;\n\tactor->page = page;\n\tactor->pages = pages;\n\tactor->next_page = 0;\n\tactor->pageaddr = NULL;\n\tactor->squashfs_first_page = direct_first_page;\n\tactor->squashfs_next_page = direct_next_page;\n\tactor->squashfs_finish_page = direct_finish_page;\n\treturn actor;\n}"
  },
  {
    "function_name": "direct_finish_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "77-81",
    "snippet": "static void direct_finish_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->pageaddr)\n\t\tkunmap_atomic(actor->pageaddr);\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "actor->pageaddr"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void direct_finish_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->pageaddr)\n\t\tkunmap_atomic(actor->pageaddr);\n}"
  },
  {
    "function_name": "direct_next_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "68-75",
    "snippet": "static void *direct_next_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->pageaddr)\n\t\tkunmap_atomic(actor->pageaddr);\n\n\treturn actor->pageaddr = actor->next_page == actor->pages ? NULL :\n\t\tkmap_atomic(actor->page[actor->next_page++]);\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "actor->page[actor->next_page++]"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "actor->pageaddr"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void *direct_next_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->pageaddr)\n\t\tkunmap_atomic(actor->pageaddr);\n\n\treturn actor->pageaddr = actor->next_page == actor->pages ? NULL :\n\t\tkmap_atomic(actor->page[actor->next_page++]);\n}"
  },
  {
    "function_name": "direct_first_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "62-66",
    "snippet": "static void *direct_first_page(struct squashfs_page_actor *actor)\n{\n\tactor->next_page = 1;\n\treturn actor->pageaddr = kmap_atomic(actor->page[0]);\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "actor->page[0]"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void *direct_first_page(struct squashfs_page_actor *actor)\n{\n\tactor->next_page = 1;\n\treturn actor->pageaddr = kmap_atomic(actor->page[0]);\n}"
  },
  {
    "function_name": "squashfs_page_actor_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "43-59",
    "snippet": "struct squashfs_page_actor *squashfs_page_actor_init(void **buffer,\n\tint pages, int length)\n{\n\tstruct squashfs_page_actor *actor = kmalloc(sizeof(*actor), GFP_KERNEL);\n\n\tif (actor == NULL)\n\t\treturn NULL;\n\n\tactor->length = length ? : pages * PAGE_CACHE_SIZE;\n\tactor->buffer = buffer;\n\tactor->pages = pages;\n\tactor->next_page = 0;\n\tactor->squashfs_first_page = cache_first_page;\n\tactor->squashfs_next_page = cache_next_page;\n\tactor->squashfs_finish_page = cache_finish_page;\n\treturn actor;\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*actor)",
            "GFP_KERNEL"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstruct squashfs_page_actor *squashfs_page_actor_init(void **buffer,\n\tint pages, int length)\n{\n\tstruct squashfs_page_actor *actor = kmalloc(sizeof(*actor), GFP_KERNEL);\n\n\tif (actor == NULL)\n\t\treturn NULL;\n\n\tactor->length = length ? : pages * PAGE_CACHE_SIZE;\n\tactor->buffer = buffer;\n\tactor->pages = pages;\n\tactor->next_page = 0;\n\tactor->squashfs_first_page = cache_first_page;\n\tactor->squashfs_next_page = cache_next_page;\n\tactor->squashfs_finish_page = cache_finish_page;\n\treturn actor;\n}"
  },
  {
    "function_name": "cache_finish_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "38-41",
    "snippet": "static void cache_finish_page(struct squashfs_page_actor *actor)\n{\n\t/* empty */\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void cache_finish_page(struct squashfs_page_actor *actor)\n{\n\t/* empty */\n}"
  },
  {
    "function_name": "cache_next_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "30-36",
    "snippet": "static void *cache_next_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->next_page == actor->pages)\n\t\treturn NULL;\n\n\treturn actor->buffer[actor->next_page++];\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void *cache_next_page(struct squashfs_page_actor *actor)\n{\n\tif (actor->next_page == actor->pages)\n\t\treturn NULL;\n\n\treturn actor->buffer[actor->next_page++];\n}"
  },
  {
    "function_name": "cache_first_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/squashfs/page_actor.c",
    "lines": "24-28",
    "snippet": "static void *cache_first_page(struct squashfs_page_actor *actor)\n{\n\tactor->next_page = 1;\n\treturn actor->buffer[0];\n}",
    "includes": [
      "#include \"page_actor.h\"",
      "#include <linux/pagemap.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"page_actor.h\"\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic void *cache_first_page(struct squashfs_page_actor *actor)\n{\n\tactor->next_page = 1;\n\treturn actor->buffer[0];\n}"
  }
]