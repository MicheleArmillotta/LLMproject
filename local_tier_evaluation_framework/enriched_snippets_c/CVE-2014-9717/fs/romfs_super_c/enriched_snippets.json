[
  {
    "function_name": "romfs_fs(void",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "643-652",
    "snippet": "c void __exit exit_romfs_fs(void)\n{\n\tunregister_filesystem(&romfs_fs_type);\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(romfs_inode_cachep);\n}\n\nmod",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct file_system_type romfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"romfs\",\n\t.mount\t\t= romfs_mount,\n\t.kill_sb\t= romfs_kill_sb,\n\t.fs_flags\t= FS_REQUIRES_DEV,\n};\nMODU"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy(romf",
          "args": [
            "_inode_cachep);\n}"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arrier();",
          "args": [],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ister_filesystem(&rom",
          "args": [
            "s_fs_type);\n\t/"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct file_system_type romfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"romfs\",\n\t.mount\t\t= romfs_mount,\n\t.kill_sb\t= romfs_kill_sb,\n\t.fs_flags\t= FS_REQUIRES_DEV,\n};\nMODU;\n\nc void __exit exit_romfs_fs(void)\n{\n\tunregister_filesystem(&romfs_fs_type);\n\t/*\n\t * Make sure all delayed rcu free inodes are flushed before we\n\t * destroy cache.\n\t */\n\trcu_barrier();\n\tkmem_cache_destroy(romfs_inode_cachep);\n}\n\nmod"
  },
  {
    "function_name": "romfs_fs(void",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "612-638",
    "snippet": "c int __init init_romfs_fs(void)\n{\n\tint ret;\n\n\tpr_info(\"ROMFS MTD (C) 2007 Red Hat, Inc.\\n\");\n\n\tromfs_inode_cachep =\n\t\tkmem_cache_create(\"romfs_i\",\n\t\t\t\t  sizeof(struct romfs_inode_info), 0,\n\t\t\t\t  SLAB_RECLAIM_ACCOUNT | SLAB_MEM_SPREAD,\n\t\t\t\t  romfs_i_init_once);\n\n\tif (!romfs_inode_cachep) {\n\t\tpr_err(\"Failed to initialise inode cache\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tret = register_filesystem(&romfs_fs_type);\n\tif (ret) {\n\t\tpr_err(\"Failed to register filesystem\\n\");\n\t\tgoto error_register;\n\t}\n\treturn 0;\n\nerror_register:\n\tkmem_cache_destroy(romfs_inode_cachep);\n\treturn ret;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct file_system_type romfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"romfs\",\n\t.mount\t\t= romfs_mount,\n\t.kill_sb\t= romfs_kill_sb,\n\t.fs_flags\t= FS_REQUIRES_DEV,\n};\nMODU"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy(romf",
          "args": [
            "_inode_cachep);\n\tr"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(\"Fai",
          "args": [
            "ed to register filesystem\\n\");"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ter_filesystem(&rom",
          "args": [
            "s_fs_type);\n\ti"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(\"Fai",
          "args": [
            "ed to initialise inode cache\\n\");"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create(\"rom",
          "args": [
            "s_i\",",
            "f(struct romfs_inode_info), 0,",
            "RECLAIM_ACCOUNT | SLAB_MEM_SPREAD,",
            "_i_init_once);"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fo(\"ROM",
          "args": [
            "S MTD (C) 2007 Red Hat, Inc.\\n\");"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct file_system_type romfs_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"romfs\",\n\t.mount\t\t= romfs_mount,\n\t.kill_sb\t= romfs_kill_sb,\n\t.fs_flags\t= FS_REQUIRES_DEV,\n};\nMODU;\n\nc int __init init_romfs_fs(void)\n{\n\tint ret;\n\n\tpr_info(\"ROMFS MTD (C) 2007 Red Hat, Inc.\\n\");\n\n\tromfs_inode_cachep =\n\t\tkmem_cache_create(\"romfs_i\",\n\t\t\t\t  sizeof(struct romfs_inode_info), 0,\n\t\t\t\t  SLAB_RECLAIM_ACCOUNT | SLAB_MEM_SPREAD,\n\t\t\t\t  romfs_i_init_once);\n\n\tif (!romfs_inode_cachep) {\n\t\tpr_err(\"Failed to initialise inode cache\\n\");\n\t\treturn -ENOMEM;\n\t}\n\tret = register_filesystem(&romfs_fs_type);\n\tif (ret) {\n\t\tpr_err(\"Failed to register filesystem\\n\");\n\t\tgoto error_register;\n\t}\n\treturn 0;\n\nerror_register:\n\tkmem_cache_destroy(romfs_inode_cachep);\n\treturn ret;\n}\n\n/*"
  },
  {
    "function_name": "_i_init_once(void",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "602-607",
    "snippet": "c void romfs_i_init_once(void *_inode)\n{\n\tstruct romfs_inode_info *inode = _inode;\n\n\tinode_init_once(&inode->vfs_inode);\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_init_once(&ino",
          "args": [
            "e->vfs_inode);\n}"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc void romfs_i_init_once(void *_inode)\n{\n\tstruct romfs_inode_info *inode = _inode;\n\n\tinode_init_once(&inode->vfs_inode);\n}\n\n/*"
  },
  {
    "function_name": "_kill_sb(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "574-588",
    "snippet": "c void romfs_kill_sb(struct super_block *sb)\n{\n#ifdef CONFIG_ROMFS_ON_MTD\n\tif (sb->s_mtd) {\n\t\tkill_mtd_super(sb);\n\t\treturn;\n\t}\n#endif\n#ifdef CONFIG_ROMFS_ON_BLOCK\n\tif (sb->s_bdev) {\n\t\tkill_block_super(sb);\n\t\treturn;\n\t}\n#endif\n}\n\nsta",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct kmem_cache *romfs_inode_cachep;\n\nsta"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "block_super(sb);",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mtd_super(sb);",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct kmem_cache *romfs_inode_cachep;\n\nsta;\n\nc void romfs_kill_sb(struct super_block *sb)\n{\n#ifdef CONFIG_ROMFS_ON_MTD\n\tif (sb->s_mtd) {\n\t\tkill_mtd_super(sb);\n\t\treturn;\n\t}\n#endif\n#ifdef CONFIG_ROMFS_ON_BLOCK\n\tif (sb->s_bdev) {\n\t\tkill_block_super(sb);\n\t\treturn;\n\t}\n#endif\n}\n\nsta"
  },
  {
    "function_name": "_mount(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "554-569",
    "snippet": "c struct dentry *romfs_mount(struct file_system_type *fs_type,\n\t\t\tint flags, const char *dev_name,\n\t\t\tvoid *data)\n{\n\tstruct dentry *ret = ERR_PTR(-EINVAL);\n\n#ifdef CONFIG_ROMFS_ON_MTD\n\tret = mount_mtd(fs_type, flags, dev_name, data, romfs_fill_super);\n#endif\n#ifdef CONFIG_ROMFS_ON_BLOCK\n\tif (ret == ERR_PTR(-EINVAL))\n\t\tret = mount_bdev(fs_type, flags, dev_name, data,\n\t\t\t\t  romfs_fill_super);\n#endif\n\treturn ret;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_bdev(fs_t",
          "args": [
            "pe, fla",
            ", dev",
            "ame, dat",
            "_fill_super);\n#e"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TR(-EIN",
          "args": [
            "AL))"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mtd(fs_t",
          "args": [
            "pe, fla",
            ", dev",
            "ame, dat",
            "rom",
            "_fill_super);\n#e"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TR(-EIN",
          "args": [
            "AL);\n\n#"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct dentry *romfs_mount(struct file_system_type *fs_type,\n\t\t\tint flags, const char *dev_name,\n\t\t\tvoid *data)\n{\n\tstruct dentry *ret = ERR_PTR(-EINVAL);\n\n#ifdef CONFIG_ROMFS_ON_MTD\n\tret = mount_mtd(fs_type, flags, dev_name, data, romfs_fill_super);\n#endif\n#ifdef CONFIG_ROMFS_ON_BLOCK\n\tif (ret == ERR_PTR(-EINVAL))\n\t\tret = mount_bdev(fs_type, flags, dev_name, data,\n\t\t\t\t  romfs_fill_super);\n#endif\n\treturn ret;\n}\n\n/*"
  },
  {
    "function_name": "_fill_super(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "468-549",
    "snippet": "c int romfs_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct romfs_super_block *rsb;\n\tstruct inode *root;\n\tunsigned long pos, img_size;\n\tconst char *storage;\n\tsize_t len;\n\tint ret;\n\n#ifdef CONFIG_BLOCK\n\tif (!sb->s_mtd) {\n\t\tsb_set_blocksize(sb, ROMBSIZE);\n\t} else {\n\t\tsb->s_blocksize = ROMBSIZE;\n\t\tsb->s_blocksize_bits = blksize_bits(ROMBSIZE);\n\t}\n#endif\n\n\tsb->s_maxbytes = 0xFFFFFFFF;\n\tsb->s_magic = ROMFS_MAGIC;\n\tsb->s_flags |= MS_RDONLY | MS_NOATIME;\n\tsb->s_op = &romfs_super_ops;\n\n\t/* read the image superblock and check it */\n\trsb = kmalloc(512, GFP_KERNEL);\n\tif (!rsb)\n\t\treturn -ENOMEM;\n\n\tsb->s_fs_info = (void *) 512;\n\tret = romfs_dev_read(sb, 0, rsb, 512);\n\tif (ret < 0)\n\t\tgoto error_rsb;\n\n\timg_size = be32_to_cpu(rsb->size);\n\n\tif (sb->s_mtd && img_size > sb->s_mtd->size)\n\t\tgoto error_rsb_inval;\n\n\tsb->s_fs_info = (void *) img_size;\n\n\tif (rsb->word0 != ROMSB_WORD0 || rsb->word1 != ROMSB_WORD1 ||\n\t    img_size < ROMFH_SIZE) {\n\t\tif (!silent)\n\t\t\tpr_warn(\"VFS: Can't find a romfs filesystem on dev %s.\\n\",\n\t\t\t       sb->s_id);\n\t\tgoto error_rsb_inval;\n\t}\n\n\tif (romfs_checksum(rsb, min_t(size_t, img_size, 512))) {\n\t\tpr_err(\"bad initial checksum on dev %s.\\n\", sb->s_id);\n\t\tgoto error_rsb_inval;\n\t}\n\n\tstorage = sb->s_mtd ? \"MTD\" : \"the block layer\";\n\n\tlen = strnlen(rsb->name, ROMFS_MAXFN);\n\tif (!silent)\n\t\tpr_notice(\"Mounting image '%*.*s' through %s\\n\",\n\t\t\t  (unsigned) len, (unsigned) len, rsb->name, storage);\n\n\tkfree(rsb);\n\trsb = NULL;\n\n\t/* find the root directory */\n\tpos = (ROMFH_SIZE + len + 1 + ROMFH_PAD) & ROMFH_MASK;\n\n\troot = romfs_iget(sb, pos);\n\tif (IS_ERR(root))\n\t\treturn PTR_ERR(root);\n\n\tsb->s_root = d_make_root(root);\n\tif (!sb->s_root)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n\nerror_rsb_inval:\n\tret = -EINVAL;\nerror_rsb:\n\tkfree(rsb);\n\treturn ret;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*",
      "c const struct super_operations romfs_super_ops = {\n\t.alloc_inode\t= romfs_alloc_inode,\n\t.destroy_inode\t= romfs_destroy_inode,\n\t.statfs\t\t= romfs_statfs,\n\t.remount_fs\t= romfs_remount,\n};\n\n/*"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "(rsb)",
          "args": [
            "r"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e_root(root",
          "args": [
            ";\n\ti"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RR(root",
          "args": [
            ";"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "R(root",
          "args": [
            ")"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_iget(sb,",
          "args": [
            "os",
            "i"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(rsb)",
          "args": [
            "r"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tice(\"Mou",
          "args": [
            "ting image '%*.*s' through %s\\n\",",
            "gned) len, (un",
            "gned) len, rsb",
            "name, sto",
            "ge);"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "en(rsb-",
          "args": [
            "name, ROM",
            "_MAXFN);\n\ti"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(\"bad",
          "args": [
            "initial checksum on dev %s.\\n\", sb-",
            "_id);"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_checksum(rsb,",
          "args": [
            "min",
            "(size_t, img_size, 512))) {"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(size",
          "args": [
            "t, img",
            "ize, 512",
            ") {"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rn(\"VFS",
          "args": [
            "Can't find a romfs filesystem on dev %s.\\n\",",
            "_id);"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(rsb-",
          "args": [
            "size);"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(sb,",
          "args": [
            ",",
            "b",
            "512",
            "i"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oc(512,",
          "args": [
            "GFP",
            "ERNEL);\n\ti"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ze_bits(ROMB",
          "args": [
            "IZE);\n\t}"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t_blocksize(sb,",
          "args": [
            "OM",
            "IZE);\n\t}"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*;\nc const struct super_operations romfs_super_ops = {\n\t.alloc_inode\t= romfs_alloc_inode,\n\t.destroy_inode\t= romfs_destroy_inode,\n\t.statfs\t\t= romfs_statfs,\n\t.remount_fs\t= romfs_remount,\n};\n\n/*;\n\nc int romfs_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct romfs_super_block *rsb;\n\tstruct inode *root;\n\tunsigned long pos, img_size;\n\tconst char *storage;\n\tsize_t len;\n\tint ret;\n\n#ifdef CONFIG_BLOCK\n\tif (!sb->s_mtd) {\n\t\tsb_set_blocksize(sb, ROMBSIZE);\n\t} else {\n\t\tsb->s_blocksize = ROMBSIZE;\n\t\tsb->s_blocksize_bits = blksize_bits(ROMBSIZE);\n\t}\n#endif\n\n\tsb->s_maxbytes = 0xFFFFFFFF;\n\tsb->s_magic = ROMFS_MAGIC;\n\tsb->s_flags |= MS_RDONLY | MS_NOATIME;\n\tsb->s_op = &romfs_super_ops;\n\n\t/* read the image superblock and check it */\n\trsb = kmalloc(512, GFP_KERNEL);\n\tif (!rsb)\n\t\treturn -ENOMEM;\n\n\tsb->s_fs_info = (void *) 512;\n\tret = romfs_dev_read(sb, 0, rsb, 512);\n\tif (ret < 0)\n\t\tgoto error_rsb;\n\n\timg_size = be32_to_cpu(rsb->size);\n\n\tif (sb->s_mtd && img_size > sb->s_mtd->size)\n\t\tgoto error_rsb_inval;\n\n\tsb->s_fs_info = (void *) img_size;\n\n\tif (rsb->word0 != ROMSB_WORD0 || rsb->word1 != ROMSB_WORD1 ||\n\t    img_size < ROMFH_SIZE) {\n\t\tif (!silent)\n\t\t\tpr_warn(\"VFS: Can't find a romfs filesystem on dev %s.\\n\",\n\t\t\t       sb->s_id);\n\t\tgoto error_rsb_inval;\n\t}\n\n\tif (romfs_checksum(rsb, min_t(size_t, img_size, 512))) {\n\t\tpr_err(\"bad initial checksum on dev %s.\\n\", sb->s_id);\n\t\tgoto error_rsb_inval;\n\t}\n\n\tstorage = sb->s_mtd ? \"MTD\" : \"the block layer\";\n\n\tlen = strnlen(rsb->name, ROMFS_MAXFN);\n\tif (!silent)\n\t\tpr_notice(\"Mounting image '%*.*s' through %s\\n\",\n\t\t\t  (unsigned) len, (unsigned) len, rsb->name, storage);\n\n\tkfree(rsb);\n\trsb = NULL;\n\n\t/* find the root directory */\n\tpos = (ROMFH_SIZE + len + 1 + ROMFH_PAD) & ROMFH_MASK;\n\n\troot = romfs_iget(sb, pos);\n\tif (IS_ERR(root))\n\t\treturn PTR_ERR(root);\n\n\tsb->s_root = d_make_root(root);\n\tif (!sb->s_root)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n\nerror_rsb_inval:\n\tret = -EINVAL;\nerror_rsb:\n\tkfree(rsb);\n\treturn ret;\n}\n\n/*"
  },
  {
    "function_name": "_checksum(cons",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "451-463",
    "snippet": "c __u32 romfs_checksum(const void *data, int size)\n{\n\tconst __be32 *ptr = data;\n\t__u32 sum;\n\n\tsum = 0;\n\tsize >>= 2;\n\twhile (size > 0) {\n\t\tsum += be32_to_cpu(*ptr++);\n\t\tsize--;\n\t}\n\treturn sum;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_cpu(*ptr",
          "args": [
            "+);"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc __u32 romfs_checksum(const void *data, int size)\n{\n\tconst __be32 *ptr = data;\n\t__u32 sum;\n\n\tsum = 0;\n\tsize >>= 2;\n\twhile (size > 0) {\n\t\tsum += be32_to_cpu(*ptr++);\n\t\tsize--;\n\t}\n\treturn sum;\n}\n\n/*"
  },
  {
    "function_name": "_remount(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "434-439",
    "snippet": "c int romfs_remount(struct super_block *sb, int *flags, char *data)\n{\n\tsync_filesystem(sb);\n\t*flags |= MS_RDONLY;\n\treturn 0;\n}\n\nsta",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct kmem_cache *romfs_inode_cachep;\n\nsta"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "filesystem(sb);",
          "args": [
            "*"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct kmem_cache *romfs_inode_cachep;\n\nsta;\n\nc int romfs_remount(struct super_block *sb, int *flags, char *data)\n{\n\tsync_filesystem(sb);\n\t*flags |= MS_RDONLY;\n\treturn 0;\n}\n\nsta"
  },
  {
    "function_name": "_statfs(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "415-429",
    "snippet": "c int romfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct super_block *sb = dentry->d_sb;\n\tu64 id = huge_encode_dev(sb->s_bdev->bd_dev);\n\n\tbuf->f_type = ROMFS_MAGIC;\n\tbuf->f_namelen = ROMFS_MAXFN;\n\tbuf->f_bsize = ROMBSIZE;\n\tbuf->f_bfree = buf->f_bavail = buf->f_ffree;\n\tbuf->f_blocks =\n\t\t(romfs_maxsize(dentry->d_sb) + ROMBSIZE - 1) >> ROMBSBITS;\n\tbuf->f_fsid.val[0] = (u32)id;\n\tbuf->f_fsid.val[1] = (u32)(id >> 32);\n\treturn 0;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "32);\n\tr"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_maxsize(dent",
          "args": [
            "y->d_sb) + R"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_dev(sb->",
          "args": [
            "_bdev->bd_dev);"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc int romfs_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct super_block *sb = dentry->d_sb;\n\tu64 id = huge_encode_dev(sb->s_bdev->bd_dev);\n\n\tbuf->f_type = ROMFS_MAGIC;\n\tbuf->f_namelen = ROMFS_MAXFN;\n\tbuf->f_bsize = ROMBSIZE;\n\tbuf->f_bfree = buf->f_bavail = buf->f_ffree;\n\tbuf->f_blocks =\n\t\t(romfs_maxsize(dentry->d_sb) + ROMBSIZE - 1) >> ROMBSBITS;\n\tbuf->f_fsid.val[0] = (u32)id;\n\tbuf->f_fsid.val[1] = (u32)(id >> 32);\n\treturn 0;\n}\n\n/*"
  },
  {
    "function_name": "_destroy_inode(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "407-410",
    "snippet": "c void romfs_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, romfs_i_callback);\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu(&ino",
          "args": [
            "e->i_rcu, rom",
            "_i_callback);\n}"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc void romfs_destroy_inode(struct inode *inode)\n{\n\tcall_rcu(&inode->i_rcu, romfs_i_callback);\n}\n\n/*"
  },
  {
    "function_name": "_i_callback(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "400-405",
    "snippet": "c void romfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\n\tkmem_cache_free(romfs_inode_cachep, ROMFS_I(inode));\n}\n\nsta",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct kmem_cache *romfs_inode_cachep;\n\nsta"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_free(romf",
          "args": [
            "_inode_cachep, ROM",
            "_I(inode));\n}"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_I(inod",
          "args": [
            "));\n}"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iner_of(head",
          "args": [
            "str",
            "t inod, i_r",
            ");"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct kmem_cache *romfs_inode_cachep;\n\nsta;\n\nc void romfs_i_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\n\tkmem_cache_free(romfs_inode_cachep, ROMFS_I(inode));\n}\n\nsta"
  },
  {
    "function_name": "_alloc_inode(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "389-395",
    "snippet": "c struct inode *romfs_alloc_inode(struct super_block *sb)\n{\n\tstruct romfs_inode_info *inode;\n\n\tinode = kmem_cache_alloc(romfs_inode_cachep, GFP_KERNEL);\n\treturn inode ? &inode->vfs_inode : NULL;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_alloc(romf",
          "args": [
            "_inode_cachep, GFP",
            "ERNEL);\n\tr"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct inode *romfs_alloc_inode(struct super_block *sb)\n{\n\tstruct romfs_inode_info *inode;\n\n\tinode = kmem_cache_alloc(romfs_inode_cachep, GFP_KERNEL);\n\treturn inode ? &inode->vfs_inode : NULL;\n}\n\n/*"
  },
  {
    "function_name": "_iget(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "295-384",
    "snippet": "c struct inode *romfs_iget(struct super_block *sb, unsigned long pos)\n{\n\tstruct romfs_inode_info *inode;\n\tstruct romfs_inode ri;\n\tstruct inode *i;\n\tunsigned long nlen;\n\tunsigned nextfh;\n\tint ret;\n\tumode_t mode;\n\n\t/* we might have to traverse a chain of \"hard link\" file entries to get\n\t * to the actual file */\n\tfor (;;) {\n\t\tret = romfs_dev_read(sb, pos, &ri, sizeof(ri));\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\n\t\t/* XXX: do romfs_checksum here too (with name) */\n\n\t\tnextfh = be32_to_cpu(ri.next);\n\t\tif ((nextfh & ROMFH_TYPE) != ROMFH_HRD)\n\t\t\tbreak;\n\n\t\tpos = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\t}\n\n\t/* determine the length of the filename */\n\tnlen = romfs_dev_strnlen(sb, pos + ROMFH_SIZE, ROMFS_MAXFN);\n\tif (IS_ERR_VALUE(nlen))\n\t\tgoto eio;\n\n\t/* get an inode for this image position */\n\ti = iget_locked(sb, pos);\n\tif (!i)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (!(i->i_state & I_NEW))\n\t\treturn i;\n\n\t/* precalculate the data offset */\n\tinode = ROMFS_I(i);\n\tinode->i_metasize = (ROMFH_SIZE + nlen + 1 + ROMFH_PAD) & ROMFH_MASK;\n\tinode->i_dataoffset = pos + inode->i_metasize;\n\n\tset_nlink(i, 1);\t\t/* Hard to decide.. */\n\ti->i_size = be32_to_cpu(ri.size);\n\ti->i_mtime.tv_sec = i->i_atime.tv_sec = i->i_ctime.tv_sec = 0;\n\ti->i_mtime.tv_nsec = i->i_atime.tv_nsec = i->i_ctime.tv_nsec = 0;\n\n\t/* set up mode and ops */\n\tmode = romfs_modemap[nextfh & ROMFH_TYPE];\n\n\tswitch (nextfh & ROMFH_TYPE) {\n\tcase ROMFH_DIR:\n\t\ti->i_size = ROMFS_I(i)->i_metasize;\n\t\ti->i_op = &romfs_dir_inode_operations;\n\t\ti->i_fop = &romfs_dir_operations;\n\t\tif (nextfh & ROMFH_EXEC)\n\t\t\tmode |= S_IXUGO;\n\t\tbreak;\n\tcase ROMFH_REG:\n\t\ti->i_fop = &romfs_ro_fops;\n\t\ti->i_data.a_ops = &romfs_aops;\n\t\tif (nextfh & ROMFH_EXEC)\n\t\t\tmode |= S_IXUGO;\n\t\tbreak;\n\tcase ROMFH_SYM:\n\t\ti->i_op = &page_symlink_inode_operations;\n\t\ti->i_data.a_ops = &romfs_aops;\n\t\tmode |= S_IRWXUGO;\n\t\tbreak;\n\tdefault:\n\t\t/* depending on MBZ for sock/fifos */\n\t\tnextfh = be32_to_cpu(ri.spec);\n\t\tinit_special_inode(i, mode, MKDEV(nextfh >> 16,\n\t\t\t\t\t\t  nextfh & 0xffff));\n\t\tbreak;\n\t}\n\n\ti->i_mode = mode;\n\n\tunlock_new_inode(i);\n\treturn i;\n\neio:\n\tret = -EIO;\nerror:\n\tpr_err(\"read error for inode 0x%lx\\n\", pos);\n\treturn ERR_PTR(ret);\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c const umode_t romfs_modemap[8] = {\n\t0,\t\t\t/* hard link */\n\tS_IFDIR  | 0644,\t/* directory */\n\tS_IFREG  | 0644,\t/* regular file */\n\tS_IFLNK  | 0777,\t/* symlink */\n\tS_IFBLK  | 0600,\t/* blockdev */\n\tS_IFCHR  | 0600,\t/* chardev */\n\tS_IFSOCK | 0644,\t/* socket */\n\tS_IFIFO  | 0644\t\t/* FIFO */\n};\n\nsta",
      "c struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*",
      "c const struct address_space_operations romfs_aops = {\n\t.readpage\t= romfs_readpage\n};\n\n/*",
      "c const struct file_operations romfs_dir_operations = {\n\t.read\t\t= generic_read_dir,\n\t.iterate\t= romfs_readdir,\n\t.llseek\t\t= default_llseek,\n};\n\nsta",
      "c const struct inode_operations romfs_dir_inode_operations = {\n\t.lookup\t\t= romfs_lookup,\n};\n\n/*"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TR(ret)",
          "args": [
            "}"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(\"rea",
          "args": [
            "error for inode 0x%lx\\n\", pos",
            "r"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k_new_inode(i);",
          "args": [
            "r"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "special_inode(i, m",
          "args": [
            "d",
            "MKD",
            "(nextfh >> 16,\n\t\t\t\t\t\t  nextfh & 0xffff));"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(next",
          "args": [
            "h >> 16,",
            "h & 0xffff));"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec);"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_I(i)->",
          "args": [
            "_"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ze);\n\ti"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "link(i, 1",
          "args": [
            ";",
            "/"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_I(i);",
          "args": [
            "i"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TR(-ENO",
          "args": [
            "EM);"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "locked(sb,",
          "args": [
            "os",
            "i"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "R_VALUE(nlen",
          "args": [
            ")"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_strnlen(sb,",
          "args": [
            "os",
            "ROMFH_SIZE, ROM",
            "_MAXFN);\n\ti"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec) & R"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.n",
          "args": [
            "xt);"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(sb,",
          "args": [
            "os",
            "&ri",
            "siz",
            "f(ri));"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc const umode_t romfs_modemap[8] = {\n\t0,\t\t\t/* hard link */\n\tS_IFDIR  | 0644,\t/* directory */\n\tS_IFREG  | 0644,\t/* regular file */\n\tS_IFLNK  | 0777,\t/* symlink */\n\tS_IFBLK  | 0600,\t/* blockdev */\n\tS_IFCHR  | 0600,\t/* chardev */\n\tS_IFSOCK | 0644,\t/* socket */\n\tS_IFIFO  | 0644\t\t/* FIFO */\n};\n\nsta;\nc struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*;\nc const struct address_space_operations romfs_aops = {\n\t.readpage\t= romfs_readpage\n};\n\n/*;\nc const struct file_operations romfs_dir_operations = {\n\t.read\t\t= generic_read_dir,\n\t.iterate\t= romfs_readdir,\n\t.llseek\t\t= default_llseek,\n};\n\nsta;\nc const struct inode_operations romfs_dir_inode_operations = {\n\t.lookup\t\t= romfs_lookup,\n};\n\n/*;\n\nc struct inode *romfs_iget(struct super_block *sb, unsigned long pos)\n{\n\tstruct romfs_inode_info *inode;\n\tstruct romfs_inode ri;\n\tstruct inode *i;\n\tunsigned long nlen;\n\tunsigned nextfh;\n\tint ret;\n\tumode_t mode;\n\n\t/* we might have to traverse a chain of \"hard link\" file entries to get\n\t * to the actual file */\n\tfor (;;) {\n\t\tret = romfs_dev_read(sb, pos, &ri, sizeof(ri));\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\n\t\t/* XXX: do romfs_checksum here too (with name) */\n\n\t\tnextfh = be32_to_cpu(ri.next);\n\t\tif ((nextfh & ROMFH_TYPE) != ROMFH_HRD)\n\t\t\tbreak;\n\n\t\tpos = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\t}\n\n\t/* determine the length of the filename */\n\tnlen = romfs_dev_strnlen(sb, pos + ROMFH_SIZE, ROMFS_MAXFN);\n\tif (IS_ERR_VALUE(nlen))\n\t\tgoto eio;\n\n\t/* get an inode for this image position */\n\ti = iget_locked(sb, pos);\n\tif (!i)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tif (!(i->i_state & I_NEW))\n\t\treturn i;\n\n\t/* precalculate the data offset */\n\tinode = ROMFS_I(i);\n\tinode->i_metasize = (ROMFH_SIZE + nlen + 1 + ROMFH_PAD) & ROMFH_MASK;\n\tinode->i_dataoffset = pos + inode->i_metasize;\n\n\tset_nlink(i, 1);\t\t/* Hard to decide.. */\n\ti->i_size = be32_to_cpu(ri.size);\n\ti->i_mtime.tv_sec = i->i_atime.tv_sec = i->i_ctime.tv_sec = 0;\n\ti->i_mtime.tv_nsec = i->i_atime.tv_nsec = i->i_ctime.tv_nsec = 0;\n\n\t/* set up mode and ops */\n\tmode = romfs_modemap[nextfh & ROMFH_TYPE];\n\n\tswitch (nextfh & ROMFH_TYPE) {\n\tcase ROMFH_DIR:\n\t\ti->i_size = ROMFS_I(i)->i_metasize;\n\t\ti->i_op = &romfs_dir_inode_operations;\n\t\ti->i_fop = &romfs_dir_operations;\n\t\tif (nextfh & ROMFH_EXEC)\n\t\t\tmode |= S_IXUGO;\n\t\tbreak;\n\tcase ROMFH_REG:\n\t\ti->i_fop = &romfs_ro_fops;\n\t\ti->i_data.a_ops = &romfs_aops;\n\t\tif (nextfh & ROMFH_EXEC)\n\t\t\tmode |= S_IXUGO;\n\t\tbreak;\n\tcase ROMFH_SYM:\n\t\ti->i_op = &page_symlink_inode_operations;\n\t\ti->i_data.a_ops = &romfs_aops;\n\t\tmode |= S_IRWXUGO;\n\t\tbreak;\n\tdefault:\n\t\t/* depending on MBZ for sock/fifos */\n\t\tnextfh = be32_to_cpu(ri.spec);\n\t\tinit_special_inode(i, mode, MKDEV(nextfh >> 16,\n\t\t\t\t\t\t  nextfh & 0xffff));\n\t\tbreak;\n\t}\n\n\ti->i_mode = mode;\n\n\tunlock_new_inode(i);\n\treturn i;\n\neio:\n\tret = -EIO;\nerror:\n\tpr_err(\"read error for inode 0x%lx\\n\", pos);\n\treturn ERR_PTR(ret);\n}\n\n/*"
  },
  {
    "function_name": "_lookup(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "211-279",
    "snippet": "c struct dentry *romfs_lookup(struct inode *dir, struct dentry *dentry,\n\t\t\t\t   unsigned int flags)\n{\n\tunsigned long offset, maxoff;\n\tstruct inode *inode;\n\tstruct romfs_inode ri;\n\tconst char *name;\t\t/* got from dentry */\n\tint len, ret;\n\n\toffset = dir->i_ino & ROMFH_MASK;\n\tret = romfs_dev_read(dir->i_sb, offset, &ri, ROMFH_SIZE);\n\tif (ret < 0)\n\t\tgoto error;\n\n\t/* search all the file entries in the list starting from the one\n\t * pointed to by the directory's special data */\n\tmaxoff = romfs_maxsize(dir->i_sb);\n\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\n\tname = dentry->d_name.name;\n\tlen = dentry->d_name.len;\n\n\tfor (;;) {\n\t\tif (!offset || offset >= maxoff)\n\t\t\tgoto out0;\n\n\t\tret = romfs_dev_read(dir->i_sb, offset, &ri, sizeof(ri));\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\n\t\t/* try to match the first 16 bytes of name */\n\t\tret = romfs_dev_strcmp(dir->i_sb, offset + ROMFH_SIZE, name,\n\t\t\t\t       len);\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\t\tif (ret == 1)\n\t\t\tbreak;\n\n\t\t/* next entry */\n\t\toffset = be32_to_cpu(ri.next) & ROMFH_MASK;\n\t}\n\n\t/* Hard link handling */\n\tif ((be32_to_cpu(ri.next) & ROMFH_TYPE) == ROMFH_HRD)\n\t\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\n\tinode = romfs_iget(dir->i_sb, offset);\n\tif (IS_ERR(inode)) {\n\t\tret = PTR_ERR(inode);\n\t\tgoto error;\n\t}\n\tgoto outi;\n\n\t/*\n\t * it's a bit funky, _lookup needs to return an error code\n\t * (negative) or a NULL, both as a dentry.  ENOENT should not\n\t * be returned, instead we need to create a negative dentry by\n\t * d_add(dentry, NULL); and return 0 as no error.\n\t * (Although as I see, it only matters on writable file\n\t * systems).\n\t */\nout0:\n\tinode = NULL;\nouti:\n\td_add(dentry, inode);\n\tret = 0;\nerror:\n\treturn ERR_PTR(ret);\n}\n\nsta",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct kmem_cache *romfs_inode_cachep;\n\nsta"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TR(ret)",
          "args": [
            "}"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(dent",
          "args": [
            "y, ino",
            ");\n\tr"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RR(inod",
          "args": [
            ");"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "R(inod",
          "args": [
            ")) {"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_iget(dir-",
          "args": [
            "i_sb, off",
            "t);\n\ti"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec) & R"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.n",
          "args": [
            "xt) & R"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.n",
          "args": [
            "xt) & R"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_strcmp(dir-",
          "args": [
            "i_sb, off",
            "t + ROMFH_SIZE, nam"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(dir-",
          "args": [
            "i_sb, off",
            "t, &ri",
            "siz",
            "f(ri));"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec) & R"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_maxsize(dir-",
          "args": [
            "i_sb);\n\to"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(dir-",
          "args": [
            "i_sb, off",
            "t, &ri",
            "ROM",
            "_SIZE);\n\ti"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct kmem_cache *romfs_inode_cachep;\n\nsta;\n\nc struct dentry *romfs_lookup(struct inode *dir, struct dentry *dentry,\n\t\t\t\t   unsigned int flags)\n{\n\tunsigned long offset, maxoff;\n\tstruct inode *inode;\n\tstruct romfs_inode ri;\n\tconst char *name;\t\t/* got from dentry */\n\tint len, ret;\n\n\toffset = dir->i_ino & ROMFH_MASK;\n\tret = romfs_dev_read(dir->i_sb, offset, &ri, ROMFH_SIZE);\n\tif (ret < 0)\n\t\tgoto error;\n\n\t/* search all the file entries in the list starting from the one\n\t * pointed to by the directory's special data */\n\tmaxoff = romfs_maxsize(dir->i_sb);\n\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\n\tname = dentry->d_name.name;\n\tlen = dentry->d_name.len;\n\n\tfor (;;) {\n\t\tif (!offset || offset >= maxoff)\n\t\t\tgoto out0;\n\n\t\tret = romfs_dev_read(dir->i_sb, offset, &ri, sizeof(ri));\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\n\t\t/* try to match the first 16 bytes of name */\n\t\tret = romfs_dev_strcmp(dir->i_sb, offset + ROMFH_SIZE, name,\n\t\t\t\t       len);\n\t\tif (ret < 0)\n\t\t\tgoto error;\n\t\tif (ret == 1)\n\t\t\tbreak;\n\n\t\t/* next entry */\n\t\toffset = be32_to_cpu(ri.next) & ROMFH_MASK;\n\t}\n\n\t/* Hard link handling */\n\tif ((be32_to_cpu(ri.next) & ROMFH_TYPE) == ROMFH_HRD)\n\t\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\n\tinode = romfs_iget(dir->i_sb, offset);\n\tif (IS_ERR(inode)) {\n\t\tret = PTR_ERR(inode);\n\t\tgoto error;\n\t}\n\tgoto outi;\n\n\t/*\n\t * it's a bit funky, _lookup needs to return an error code\n\t * (negative) or a NULL, both as a dentry.  ENOENT should not\n\t * be returned, instead we need to create a negative dentry by\n\t * d_add(dentry, NULL); and return 0 as no error.\n\t * (Although as I see, it only matters on writable file\n\t * systems).\n\t */\nout0:\n\tinode = NULL;\nouti:\n\td_add(dentry, inode);\n\tret = 0;\nerror:\n\treturn ERR_PTR(ret);\n}\n\nsta"
  },
  {
    "function_name": "_readdir(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "150-206",
    "snippet": "c int romfs_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *i = file_inode(file);\n\tstruct romfs_inode ri;\n\tunsigned long offset, maxoff;\n\tint j, ino, nextfh;\n\tchar fsname[ROMFS_MAXFN];\t/* XXX dynamic? */\n\tint ret;\n\n\tmaxoff = romfs_maxsize(i->i_sb);\n\n\toffset = ctx->pos;\n\tif (!offset) {\n\t\toffset = i->i_ino & ROMFH_MASK;\n\t\tret = romfs_dev_read(i->i_sb, offset, &ri, ROMFH_SIZE);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\t}\n\n\t/* Not really failsafe, but we are read-only... */\n\tfor (;;) {\n\t\tif (!offset || offset >= maxoff) {\n\t\t\toffset = maxoff;\n\t\t\tctx->pos = offset;\n\t\t\tgoto out;\n\t\t}\n\t\tctx->pos = offset;\n\n\t\t/* Fetch inode info */\n\t\tret = romfs_dev_read(i->i_sb, offset, &ri, ROMFH_SIZE);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\n\t\tj = romfs_dev_strnlen(i->i_sb, offset + ROMFH_SIZE,\n\t\t\t\t      sizeof(fsname) - 1);\n\t\tif (j < 0)\n\t\t\tgoto out;\n\n\t\tret = romfs_dev_read(i->i_sb, offset + ROMFH_SIZE, fsname, j);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tfsname[j] = '\\0';\n\n\t\tino = offset;\n\t\tnextfh = be32_to_cpu(ri.next);\n\t\tif ((nextfh & ROMFH_TYPE) == ROMFH_HRD)\n\t\t\tino = be32_to_cpu(ri.spec);\n\t\tif (!dir_emit(ctx, fsname, j, ino,\n\t\t\t    romfs_dtype_table[nextfh & ROMFH_TYPE]))\n\t\t\tgoto out;\n\n\t\toffset = nextfh & ROMFH_MASK;\n\t}\nout:\n\treturn 0;\n}\n\n/*",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c const unsigned char romfs_dtype_table[] = {\n\tDT_UNKNOWN, DT_DIR, DT_REG, DT_LNK, DT_BLK, DT_CHR, DT_SOCK, DT_FIFO\n};\n\nsta",
      "c struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mit(ctx,",
          "args": [
            "fsn",
            "e, j,",
            "o",
            "_dtype_table[nextfh & ROMFH_TYPE]))"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec);"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.n",
          "args": [
            "xt);"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(i->i",
          "args": [
            "sb, off",
            "t + ROMFH_SIZE, fsn",
            "e, j);"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_strnlen(i->i",
          "args": [
            "sb, off",
            "t + ROMFH_SIZE,",
            "f(fsname) - 1);"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(i->i",
          "args": [
            "sb, off",
            "t, &ri",
            "ROM",
            "_SIZE);"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_cpu(ri.s",
          "args": [
            "ec) & R"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(i->i",
          "args": [
            "sb, off",
            "t, &ri",
            "ROM",
            "_SIZE);"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_maxsize(i->i",
          "args": [
            "sb);"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode(file",
          "args": [
            ";\n\ts"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc const unsigned char romfs_dtype_table[] = {\n\tDT_UNKNOWN, DT_DIR, DT_REG, DT_LNK, DT_BLK, DT_CHR, DT_SOCK, DT_FIFO\n};\n\nsta;\nc struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*;\n\nc int romfs_readdir(struct file *file, struct dir_context *ctx)\n{\n\tstruct inode *i = file_inode(file);\n\tstruct romfs_inode ri;\n\tunsigned long offset, maxoff;\n\tint j, ino, nextfh;\n\tchar fsname[ROMFS_MAXFN];\t/* XXX dynamic? */\n\tint ret;\n\n\tmaxoff = romfs_maxsize(i->i_sb);\n\n\toffset = ctx->pos;\n\tif (!offset) {\n\t\toffset = i->i_ino & ROMFH_MASK;\n\t\tret = romfs_dev_read(i->i_sb, offset, &ri, ROMFH_SIZE);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\toffset = be32_to_cpu(ri.spec) & ROMFH_MASK;\n\t}\n\n\t/* Not really failsafe, but we are read-only... */\n\tfor (;;) {\n\t\tif (!offset || offset >= maxoff) {\n\t\t\toffset = maxoff;\n\t\t\tctx->pos = offset;\n\t\t\tgoto out;\n\t\t}\n\t\tctx->pos = offset;\n\n\t\t/* Fetch inode info */\n\t\tret = romfs_dev_read(i->i_sb, offset, &ri, ROMFH_SIZE);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\n\t\tj = romfs_dev_strnlen(i->i_sb, offset + ROMFH_SIZE,\n\t\t\t\t      sizeof(fsname) - 1);\n\t\tif (j < 0)\n\t\t\tgoto out;\n\n\t\tret = romfs_dev_read(i->i_sb, offset + ROMFH_SIZE, fsname, j);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t\tfsname[j] = '\\0';\n\n\t\tino = offset;\n\t\tnextfh = be32_to_cpu(ri.next);\n\t\tif ((nextfh & ROMFH_TYPE) == ROMFH_HRD)\n\t\t\tino = be32_to_cpu(ri.spec);\n\t\tif (!dir_emit(ctx, fsname, j, ino,\n\t\t\t    romfs_dtype_table[nextfh & ROMFH_TYPE]))\n\t\t\tgoto out;\n\n\t\toffset = nextfh & ROMFH_MASK;\n\t}\nout:\n\treturn 0;\n}\n\n/*"
  },
  {
    "function_name": "_readpage(stru",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/romfs/super.c",
    "lines": "101-141",
    "snippet": "c int romfs_readpage(struct file *file, struct page *page)\n{\n\tstruct inode *inode = page->mapping->host;\n\tloff_t offset, size;\n\tunsigned long fillsize, pos;\n\tvoid *buf;\n\tint ret;\n\n\tbuf = kmap(page);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\t/* 32 bit warning -- but not for us :) */\n\toffset = page_offset(page);\n\tsize = i_size_read(inode);\n\tfillsize = 0;\n\tret = 0;\n\tif (offset < size) {\n\t\tsize -= offset;\n\t\tfillsize = size > PAGE_SIZE ? PAGE_SIZE : size;\n\n\t\tpos = ROMFS_I(inode)->i_dataoffset + offset;\n\n\t\tret = romfs_dev_read(inode->i_sb, pos, buf, fillsize);\n\t\tif (ret < 0) {\n\t\t\tSetPageError(page);\n\t\t\tfillsize = 0;\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\tif (fillsize < PAGE_SIZE)\n\t\tmemset(buf + fillsize, 0, PAGE_SIZE - fillsize);\n\tif (ret == 0)\n\t\tSetPageUptodate(page);\n\n\tflush_dcache_page(page);\n\tkunmap(page);\n\tunlock_page(page);\n\treturn ret;\n}\n\nsta",
    "includes": [
      "ude \"internal.h\"\n\nstat",
      "ude <linux/uaccess.h>\n#incl",
      "ude <linux/pagemap.h>\n#incl",
      "ude <linux/highmem.h>\n#incl",
      "ude <linux/ctype.h>\n#incl",
      "ude <linux/mtd/super.h>\n#incl",
      "ude <linux/statfs.h>\n#incl",
      "ude <linux/namei.h>\n#incl",
      "ude <linux/mount.h>\n#incl",
      "ude <linux/parser.h>\n#incl",
      "ude <linux/blkdev.h>\n#incl",
      "ude <linux/init.h>\n#incl",
      "ude <linux/slab.h>\n#incl",
      "ude <linux/time.h>\n#incl",
      "ude <linux/fs.h>\n#incl",
      "ude <linux/string.h>\n#incl",
      "ude <linux/module.h>\n#incl"
    ],
    "macros_used": [],
    "globals_used": [
      "c struct kmem_cache *romfs_inode_cachep;\n\nsta",
      "c struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "k_page(page",
          "args": [
            ";\n\tr"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p(page",
          "args": [
            ";\n\tu"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dcache_page(page",
          "args": [
            ";\n\tk"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geUptodate(page",
          "args": [
            ";"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t(buf",
          "args": [
            "fillsize, 0,",
            "G",
            "SIZE - fillsize);\n\ti"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geError(page",
          "args": [
            ";"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_dev_read(inod",
          "args": [
            "->i_sb, pos",
            "buf",
            "fil",
            "ize);"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_I(inod",
          "args": [
            ")->i_"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e_read(inod",
          "args": [
            ");\n\tf"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "offset(page",
          "args": [
            ";\n\ts"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page",
          "args": [
            ";\n\ti"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "__ra_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/exofs/super.c",
          "lines": "502-517",
          "snippet": "static unsigned __ra_pages(struct ore_layout *layout)\n{\n\tconst unsigned _MIN_RA = 32; /* min 128K read-ahead */\n\tunsigned ra_pages = layout->group_width * layout->stripe_unit /\n\t\t\t\tPAGE_SIZE;\n\tunsigned max_io_pages = exofs_max_io_pages(layout, ~0);\n\n\tra_pages *= 2; /* two stripes */\n\tif (ra_pages < _MIN_RA)\n\t\tra_pages = roundup(_MIN_RA, ra_pages / 2);\n\n\tif (ra_pages > max_io_pages)\n\t\tra_pages = max_io_pages;\n\n\treturn ra_pages;\n}",
          "includes": [
            "#include \"exofs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/module.h>",
            "#include <linux/random.h>",
            "#include <linux/vfs.h>",
            "#include <linux/parser.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"exofs.h\"\n#include <linux/slab.h>\n#include <linux/exportfs.h>\n#include <linux/module.h>\n#include <linux/random.h>\n#include <linux/vfs.h>\n#include <linux/parser.h>\n#include <linux/string.h>\n\nstatic unsigned __ra_pages(struct ore_layout *layout)\n{\n\tconst unsigned _MIN_RA = 32; /* min 128K read-ahead */\n\tunsigned ra_pages = layout->group_width * layout->stripe_unit /\n\t\t\t\tPAGE_SIZE;\n\tunsigned max_io_pages = exofs_max_io_pages(layout, ~0);\n\n\tra_pages *= 2; /* two stripes */\n\tif (ra_pages < _MIN_RA)\n\t\tra_pages = roundup(_MIN_RA, ra_pages / 2);\n\n\tif (ra_pages > max_io_pages)\n\t\tra_pages = max_io_pages;\n\n\treturn ra_pages;\n}"
        }
      }
    ],
    "contextual_snippet": "ude \"internal.h\"\n\nstat\nude <linux/uaccess.h>\n#incl\nude <linux/pagemap.h>\n#incl\nude <linux/highmem.h>\n#incl\nude <linux/ctype.h>\n#incl\nude <linux/mtd/super.h>\n#incl\nude <linux/statfs.h>\n#incl\nude <linux/namei.h>\n#incl\nude <linux/mount.h>\n#incl\nude <linux/parser.h>\n#incl\nude <linux/blkdev.h>\n#incl\nude <linux/init.h>\n#incl\nude <linux/slab.h>\n#incl\nude <linux/time.h>\n#incl\nude <linux/fs.h>\n#incl\nude <linux/string.h>\n#incl\nude <linux/module.h>\n#incl\n\nc struct kmem_cache *romfs_inode_cachep;\n\nsta;\nc struct inode *romfs_iget(struct super_block *sb, unsigned long pos);\n\n/*;\n\nc int romfs_readpage(struct file *file, struct page *page)\n{\n\tstruct inode *inode = page->mapping->host;\n\tloff_t offset, size;\n\tunsigned long fillsize, pos;\n\tvoid *buf;\n\tint ret;\n\n\tbuf = kmap(page);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\t/* 32 bit warning -- but not for us :) */\n\toffset = page_offset(page);\n\tsize = i_size_read(inode);\n\tfillsize = 0;\n\tret = 0;\n\tif (offset < size) {\n\t\tsize -= offset;\n\t\tfillsize = size > PAGE_SIZE ? PAGE_SIZE : size;\n\n\t\tpos = ROMFS_I(inode)->i_dataoffset + offset;\n\n\t\tret = romfs_dev_read(inode->i_sb, pos, buf, fillsize);\n\t\tif (ret < 0) {\n\t\t\tSetPageError(page);\n\t\t\tfillsize = 0;\n\t\t\tret = -EIO;\n\t\t}\n\t}\n\n\tif (fillsize < PAGE_SIZE)\n\t\tmemset(buf + fillsize, 0, PAGE_SIZE - fillsize);\n\tif (ret == 0)\n\t\tSetPageUptodate(page);\n\n\tflush_dcache_page(page);\n\tkunmap(page);\n\tunlock_page(page);\n\treturn ret;\n}\n\nsta"
  }
]