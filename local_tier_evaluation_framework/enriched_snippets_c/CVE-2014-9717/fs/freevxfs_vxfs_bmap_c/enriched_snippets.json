[
  {
    "function_name": "vxfs_bmap1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
    "lines": "259-281",
    "snippet": "daddr_t\nvxfs_bmap1(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\n\tif (VXFS_ISEXT4(vip))\n\t\treturn vxfs_bmap_ext4(ip, iblock);\n\tif (VXFS_ISTYPED(vip))\n\t\treturn vxfs_bmap_typed(ip, iblock);\n\tif (VXFS_ISNONE(vip))\n\t\tgoto unsupp;\n\tif (VXFS_ISIMMED(vip))\n\t\tgoto unsupp;\n\n\tprintk(KERN_WARNING \"vxfs: inode %ld has no valid orgtype (%x)\\n\",\n\t\t\tip->i_ino, vip->vii_orgtype);\n\tBUG();\n\nunsupp:\n\tprintk(KERN_WARNING \"vxfs: inode %ld has an unsupported orgtype (%x)\\n\",\n\t\t\tip->i_ino, vip->vii_orgtype);\n\treturn 0;\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"vxfs: inode %ld has an unsupported orgtype (%x)\\n\"",
            "ip->i_ino",
            "vip->vii_orgtype"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_ISIMMED",
          "args": [
            "vip"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_ISNONE",
          "args": [
            "vip"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_bmap_typed",
          "args": [
            "ip",
            "iblock"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_bmap_typed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
          "lines": "200-245",
          "snippet": "static daddr_t\nvxfs_bmap_typed(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < VXFS_NTYPED; i++) {\n\t\tstruct vxfs_typed\t*typ = vip->vii_org.typed + i;\n\t\tint64_t\t\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n#ifdef DIAGNOSTIC\n\t\tvxfs_typdump(typ);\n#endif\n\t\tif (iblock < off)\n\t\t\tcontinue;\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, iblock - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\treturn (pblock);\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((iblock - off) < typ->vt_size)\n\t\t\t\treturn (typ->vt_block + iblock - off);\n\t\t\tbreak;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\treturn 0;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_typed(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < VXFS_NTYPED; i++) {\n\t\tstruct vxfs_typed\t*typ = vip->vii_org.typed + i;\n\t\tint64_t\t\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n#ifdef DIAGNOSTIC\n\t\tvxfs_typdump(typ);\n#endif\n\t\tif (iblock < off)\n\t\t\tcontinue;\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, iblock - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\treturn (pblock);\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((iblock - off) < typ->vt_size)\n\t\t\t\treturn (typ->vt_block + iblock - off);\n\t\t\tbreak;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\treturn 0;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_ISTYPED",
          "args": [
            "vip"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_bmap_ext4",
          "args": [
            "ip",
            "iblock"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_bmap_ext4",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
          "lines": "66-108",
          "snippet": "static daddr_t\nvxfs_bmap_ext4(struct inode *ip, long bn)\n{\n\tstruct super_block *sb = ip->i_sb;\n\tstruct vxfs_inode_info *vip = VXFS_INO(ip);\n\tunsigned long bsize = sb->s_blocksize;\n\tu32 indsize = vip->vii_ext4.ve4_indsize;\n\tint i;\n\n\tif (indsize > sb->s_blocksize)\n\t\tgoto fail_size;\n\n\tfor (i = 0; i < VXFS_NDADDR; i++) {\n\t\tstruct direct *d = vip->vii_ext4.ve4_direct + i;\n\t\tif (bn >= 0 && bn < d->size)\n\t\t\treturn (bn + d->extent);\n\t\tbn -= d->size;\n\t}\n\n\tif ((bn / (indsize * indsize * bsize / 4)) == 0) {\n\t\tstruct buffer_head *buf;\n\t\tdaddr_t\tbno;\n\t\tu32 *indir;\n\n\t\tbuf = sb_bread(sb, vip->vii_ext4.ve4_indir[0]);\n\t\tif (!buf || !buffer_mapped(buf))\n\t\t\tgoto fail_buf;\n\n\t\tindir = (u32 *)buf->b_data;\n\t\tbno = indir[(bn/indsize) % (indsize*bn)] + (bn%indsize);\n\n\t\tbrelse(buf);\n\t\treturn bno;\n\t} else\n\t\tprintk(KERN_WARNING \"no matching indir?\");\n\n\treturn 0;\n\nfail_size:\n\tprintk(\"vxfs: indirect extent too big!\\n\");\nfail_buf:\n\treturn 0;\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_ext4(struct inode *ip, long bn)\n{\n\tstruct super_block *sb = ip->i_sb;\n\tstruct vxfs_inode_info *vip = VXFS_INO(ip);\n\tunsigned long bsize = sb->s_blocksize;\n\tu32 indsize = vip->vii_ext4.ve4_indsize;\n\tint i;\n\n\tif (indsize > sb->s_blocksize)\n\t\tgoto fail_size;\n\n\tfor (i = 0; i < VXFS_NDADDR; i++) {\n\t\tstruct direct *d = vip->vii_ext4.ve4_direct + i;\n\t\tif (bn >= 0 && bn < d->size)\n\t\t\treturn (bn + d->extent);\n\t\tbn -= d->size;\n\t}\n\n\tif ((bn / (indsize * indsize * bsize / 4)) == 0) {\n\t\tstruct buffer_head *buf;\n\t\tdaddr_t\tbno;\n\t\tu32 *indir;\n\n\t\tbuf = sb_bread(sb, vip->vii_ext4.ve4_indir[0]);\n\t\tif (!buf || !buffer_mapped(buf))\n\t\t\tgoto fail_buf;\n\n\t\tindir = (u32 *)buf->b_data;\n\t\tbno = indir[(bn/indsize) % (indsize*bn)] + (bn%indsize);\n\n\t\tbrelse(buf);\n\t\treturn bno;\n\t} else\n\t\tprintk(KERN_WARNING \"no matching indir?\");\n\n\treturn 0;\n\nfail_size:\n\tprintk(\"vxfs: indirect extent too big!\\n\");\nfail_buf:\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_ISEXT4",
          "args": [
            "vip"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "ip"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\ndaddr_t\nvxfs_bmap1(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\n\tif (VXFS_ISEXT4(vip))\n\t\treturn vxfs_bmap_ext4(ip, iblock);\n\tif (VXFS_ISTYPED(vip))\n\t\treturn vxfs_bmap_typed(ip, iblock);\n\tif (VXFS_ISNONE(vip))\n\t\tgoto unsupp;\n\tif (VXFS_ISIMMED(vip))\n\t\tgoto unsupp;\n\n\tprintk(KERN_WARNING \"vxfs: inode %ld has no valid orgtype (%x)\\n\",\n\t\t\tip->i_ino, vip->vii_orgtype);\n\tBUG();\n\nunsupp:\n\tprintk(KERN_WARNING \"vxfs: inode %ld has an unsupported orgtype (%x)\\n\",\n\t\t\tip->i_ino, vip->vii_orgtype);\n\treturn 0;\n}"
  },
  {
    "function_name": "vxfs_bmap_typed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
    "lines": "200-245",
    "snippet": "static daddr_t\nvxfs_bmap_typed(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < VXFS_NTYPED; i++) {\n\t\tstruct vxfs_typed\t*typ = vip->vii_org.typed + i;\n\t\tint64_t\t\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n#ifdef DIAGNOSTIC\n\t\tvxfs_typdump(typ);\n#endif\n\t\tif (iblock < off)\n\t\t\tcontinue;\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, iblock - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\treturn (pblock);\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((iblock - off) < typ->vt_size)\n\t\t\t\treturn (typ->vt_block + iblock - off);\n\t\t\tbreak;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\treturn 0;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\"",
            "(unsigned long long) typ4->vd4_block",
            "(unsigned long long) typ4->vd4_size",
            "typ4->vd4_dev"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_bmap_indir",
          "args": [
            "ip",
            "typ->vt_block",
            "typ->vt_size",
            "iblock - off"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_bmap_indir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
          "lines": "127-187",
          "snippet": "static daddr_t\nvxfs_bmap_indir(struct inode *ip, long indir, int size, long block)\n{\n\tstruct buffer_head\t\t*bp = NULL;\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < size * VXFS_TYPED_PER_BLOCK(ip->i_sb); i++) {\n\t\tstruct vxfs_typed\t*typ;\n\t\tint64_t\t\t\toff;\n\n\t\tbp = sb_bread(ip->i_sb,\n\t\t\t\tindir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb)));\n\t\tif (!bp || !buffer_mapped(bp))\n\t\t\treturn 0;\n\n\t\ttyp = ((struct vxfs_typed *)bp->b_data) +\n\t\t\t(i % VXFS_TYPED_PER_BLOCK(ip->i_sb));\n\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n\t\tif (block < off) {\n\t\t\tbrelse(bp);\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, block - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((block - off) >= typ->vt_size)\n\t\t\t\tbreak;\n\t\t\tpblock = (typ->vt_block + block - off);\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\tgoto fail;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tbrelse(bp);\n\t}\n\nfail:\n\tpblock = 0;\nout:\n\tbrelse(bp);\n\treturn (pblock);\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_indir(struct inode *ip, long indir, int size, long block)\n{\n\tstruct buffer_head\t\t*bp = NULL;\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < size * VXFS_TYPED_PER_BLOCK(ip->i_sb); i++) {\n\t\tstruct vxfs_typed\t*typ;\n\t\tint64_t\t\t\toff;\n\n\t\tbp = sb_bread(ip->i_sb,\n\t\t\t\tindir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb)));\n\t\tif (!bp || !buffer_mapped(bp))\n\t\t\treturn 0;\n\n\t\ttyp = ((struct vxfs_typed *)bp->b_data) +\n\t\t\t(i % VXFS_TYPED_PER_BLOCK(ip->i_sb));\n\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n\t\tif (block < off) {\n\t\t\tbrelse(bp);\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, block - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((block - off) >= typ->vt_size)\n\t\t\t\tbreak;\n\t\t\tpblock = (typ->vt_block + block - off);\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\tgoto fail;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tbrelse(bp);\n\t}\n\nfail:\n\tpblock = 0;\nout:\n\tbrelse(bp);\n\treturn (pblock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "typ->vt_hdr >> VXFS_TYPED_TYPESHIFT"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_typdump",
          "args": [
            "typ"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_typdump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
          "lines": "43-50",
          "snippet": "static void\nvxfs_typdump(struct vxfs_typed *typ)\n{\n\tprintk(KERN_DEBUG \"type=%Lu \", typ->vt_hdr >> VXFS_TYPED_TYPESHIFT);\n\tprintk(\"offset=%Lx \", typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\tprintk(\"block=%x \", typ->vt_block);\n\tprintk(\"size=%x\\n\", typ->vt_size);\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic void\nvxfs_typdump(struct vxfs_typed *typ)\n{\n\tprintk(KERN_DEBUG \"type=%Lu \", typ->vt_hdr >> VXFS_TYPED_TYPESHIFT);\n\tprintk(\"offset=%Lx \", typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\tprintk(\"block=%x \", typ->vt_block);\n\tprintk(\"size=%x\\n\", typ->vt_size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "ip"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_typed(struct inode *ip, long iblock)\n{\n\tstruct vxfs_inode_info\t\t*vip = VXFS_INO(ip);\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < VXFS_NTYPED; i++) {\n\t\tstruct vxfs_typed\t*typ = vip->vii_org.typed + i;\n\t\tint64_t\t\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n#ifdef DIAGNOSTIC\n\t\tvxfs_typdump(typ);\n#endif\n\t\tif (iblock < off)\n\t\t\tcontinue;\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, iblock - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\treturn (pblock);\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((iblock - off) < typ->vt_size)\n\t\t\t\treturn (typ->vt_block + iblock - off);\n\t\t\tbreak;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\treturn 0;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "vxfs_bmap_indir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
    "lines": "127-187",
    "snippet": "static daddr_t\nvxfs_bmap_indir(struct inode *ip, long indir, int size, long block)\n{\n\tstruct buffer_head\t\t*bp = NULL;\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < size * VXFS_TYPED_PER_BLOCK(ip->i_sb); i++) {\n\t\tstruct vxfs_typed\t*typ;\n\t\tint64_t\t\t\toff;\n\n\t\tbp = sb_bread(ip->i_sb,\n\t\t\t\tindir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb)));\n\t\tif (!bp || !buffer_mapped(bp))\n\t\t\treturn 0;\n\n\t\ttyp = ((struct vxfs_typed *)bp->b_data) +\n\t\t\t(i % VXFS_TYPED_PER_BLOCK(ip->i_sb));\n\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n\t\tif (block < off) {\n\t\t\tbrelse(bp);\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, block - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((block - off) >= typ->vt_size)\n\t\t\t\tbreak;\n\t\t\tpblock = (typ->vt_block + block - off);\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\tgoto fail;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tbrelse(bp);\n\t}\n\nfail:\n\tpblock = 0;\nout:\n\tbrelse(bp);\n\treturn (pblock);\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bp"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\"",
            "(unsigned long long) typ4->vd4_block",
            "(unsigned long long) typ4->vd4_size",
            "typ4->vd4_dev"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_bmap_indir",
          "args": [
            "ip",
            "typ->vt_block",
            "typ->vt_size",
            "block - off"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_bmap_indir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
          "lines": "127-187",
          "snippet": "static daddr_t\nvxfs_bmap_indir(struct inode *ip, long indir, int size, long block)\n{\n\tstruct buffer_head\t\t*bp = NULL;\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < size * VXFS_TYPED_PER_BLOCK(ip->i_sb); i++) {\n\t\tstruct vxfs_typed\t*typ;\n\t\tint64_t\t\t\toff;\n\n\t\tbp = sb_bread(ip->i_sb,\n\t\t\t\tindir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb)));\n\t\tif (!bp || !buffer_mapped(bp))\n\t\t\treturn 0;\n\n\t\ttyp = ((struct vxfs_typed *)bp->b_data) +\n\t\t\t(i % VXFS_TYPED_PER_BLOCK(ip->i_sb));\n\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n\t\tif (block < off) {\n\t\t\tbrelse(bp);\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, block - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((block - off) >= typ->vt_size)\n\t\t\t\tbreak;\n\t\t\tpblock = (typ->vt_block + block - off);\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\tgoto fail;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tbrelse(bp);\n\t}\n\nfail:\n\tpblock = 0;\nout:\n\tbrelse(bp);\n\treturn (pblock);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "typ->vt_hdr >> VXFS_TYPED_TYPESHIFT"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_TYPED_PER_BLOCK",
          "args": [
            "ip->i_sb"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_mapped",
          "args": [
            "bp"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "ip->i_sb",
            "indir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb))"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_TYPED_PER_BLOCK",
          "args": [
            "ip->i_sb"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_TYPED_PER_BLOCK",
          "args": [
            "ip->i_sb"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_indir(struct inode *ip, long indir, int size, long block)\n{\n\tstruct buffer_head\t\t*bp = NULL;\n\tdaddr_t\t\t\t\tpblock = 0;\n\tint\t\t\t\ti;\n\n\tfor (i = 0; i < size * VXFS_TYPED_PER_BLOCK(ip->i_sb); i++) {\n\t\tstruct vxfs_typed\t*typ;\n\t\tint64_t\t\t\toff;\n\n\t\tbp = sb_bread(ip->i_sb,\n\t\t\t\tindir + (i / VXFS_TYPED_PER_BLOCK(ip->i_sb)));\n\t\tif (!bp || !buffer_mapped(bp))\n\t\t\treturn 0;\n\n\t\ttyp = ((struct vxfs_typed *)bp->b_data) +\n\t\t\t(i % VXFS_TYPED_PER_BLOCK(ip->i_sb));\n\t\toff = (typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\n\t\tif (block < off) {\n\t\t\tbrelse(bp);\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch ((u_int32_t)(typ->vt_hdr >> VXFS_TYPED_TYPESHIFT)) {\n\t\tcase VXFS_TYPED_INDIRECT:\n\t\t\tpblock = vxfs_bmap_indir(ip, typ->vt_block,\n\t\t\t\t\ttyp->vt_size, block - off);\n\t\t\tif (pblock == -2)\n\t\t\t\tbreak;\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_DATA:\n\t\t\tif ((block - off) >= typ->vt_size)\n\t\t\t\tbreak;\n\t\t\tpblock = (typ->vt_block + block - off);\n\t\t\tgoto out;\n\t\tcase VXFS_TYPED_INDIRECT_DEV4:\n\t\tcase VXFS_TYPED_DATA_DEV4: {\n\t\t\tstruct vxfs_typed_dev4\t*typ4 =\n\t\t\t\t(struct vxfs_typed_dev4 *)typ;\n\n\t\t\tprintk(KERN_INFO \"\\n\\nTYPED_DEV4 detected!\\n\");\n\t\t\tprintk(KERN_INFO \"block: %Lu\\tsize: %Ld\\tdev: %d\\n\",\n\t\t\t       (unsigned long long) typ4->vd4_block,\n\t\t\t       (unsigned long long) typ4->vd4_size,\n\t\t\t       typ4->vd4_dev);\n\t\t\tgoto fail;\n\t\t}\n\t\tdefault:\n\t\t\tBUG();\n\t\t}\n\t\tbrelse(bp);\n\t}\n\nfail:\n\tpblock = 0;\nout:\n\tbrelse(bp);\n\treturn (pblock);\n}"
  },
  {
    "function_name": "vxfs_bmap_ext4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
    "lines": "66-108",
    "snippet": "static daddr_t\nvxfs_bmap_ext4(struct inode *ip, long bn)\n{\n\tstruct super_block *sb = ip->i_sb;\n\tstruct vxfs_inode_info *vip = VXFS_INO(ip);\n\tunsigned long bsize = sb->s_blocksize;\n\tu32 indsize = vip->vii_ext4.ve4_indsize;\n\tint i;\n\n\tif (indsize > sb->s_blocksize)\n\t\tgoto fail_size;\n\n\tfor (i = 0; i < VXFS_NDADDR; i++) {\n\t\tstruct direct *d = vip->vii_ext4.ve4_direct + i;\n\t\tif (bn >= 0 && bn < d->size)\n\t\t\treturn (bn + d->extent);\n\t\tbn -= d->size;\n\t}\n\n\tif ((bn / (indsize * indsize * bsize / 4)) == 0) {\n\t\tstruct buffer_head *buf;\n\t\tdaddr_t\tbno;\n\t\tu32 *indir;\n\n\t\tbuf = sb_bread(sb, vip->vii_ext4.ve4_indir[0]);\n\t\tif (!buf || !buffer_mapped(buf))\n\t\t\tgoto fail_buf;\n\n\t\tindir = (u32 *)buf->b_data;\n\t\tbno = indir[(bn/indsize) % (indsize*bn)] + (bn%indsize);\n\n\t\tbrelse(buf);\n\t\treturn bno;\n\t} else\n\t\tprintk(KERN_WARNING \"no matching indir?\");\n\n\treturn 0;\n\nfail_size:\n\tprintk(\"vxfs: indirect extent too big!\\n\");\nfail_buf:\n\treturn 0;\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"vxfs: indirect extent too big!\\n\""
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "buf"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_mapped",
          "args": [
            "buf"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sb_bread",
          "args": [
            "sb",
            "vip->vii_ext4.ve4_indir[0]"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "ip"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic daddr_t\nvxfs_bmap_ext4(struct inode *ip, long bn)\n{\n\tstruct super_block *sb = ip->i_sb;\n\tstruct vxfs_inode_info *vip = VXFS_INO(ip);\n\tunsigned long bsize = sb->s_blocksize;\n\tu32 indsize = vip->vii_ext4.ve4_indsize;\n\tint i;\n\n\tif (indsize > sb->s_blocksize)\n\t\tgoto fail_size;\n\n\tfor (i = 0; i < VXFS_NDADDR; i++) {\n\t\tstruct direct *d = vip->vii_ext4.ve4_direct + i;\n\t\tif (bn >= 0 && bn < d->size)\n\t\t\treturn (bn + d->extent);\n\t\tbn -= d->size;\n\t}\n\n\tif ((bn / (indsize * indsize * bsize / 4)) == 0) {\n\t\tstruct buffer_head *buf;\n\t\tdaddr_t\tbno;\n\t\tu32 *indir;\n\n\t\tbuf = sb_bread(sb, vip->vii_ext4.ve4_indir[0]);\n\t\tif (!buf || !buffer_mapped(buf))\n\t\t\tgoto fail_buf;\n\n\t\tindir = (u32 *)buf->b_data;\n\t\tbno = indir[(bn/indsize) % (indsize*bn)] + (bn%indsize);\n\n\t\tbrelse(buf);\n\t\treturn bno;\n\t} else\n\t\tprintk(KERN_WARNING \"no matching indir?\");\n\n\treturn 0;\n\nfail_size:\n\tprintk(\"vxfs: indirect extent too big!\\n\");\nfail_buf:\n\treturn 0;\n}"
  },
  {
    "function_name": "vxfs_typdump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_bmap.c",
    "lines": "43-50",
    "snippet": "static void\nvxfs_typdump(struct vxfs_typed *typ)\n{\n\tprintk(KERN_DEBUG \"type=%Lu \", typ->vt_hdr >> VXFS_TYPED_TYPESHIFT);\n\tprintk(\"offset=%Lx \", typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\tprintk(\"block=%x \", typ->vt_block);\n\tprintk(\"size=%x\\n\", typ->vt_size);\n}",
    "includes": [
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"size=%x\\n\"",
            "typ->vt_size"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic void\nvxfs_typdump(struct vxfs_typed *typ)\n{\n\tprintk(KERN_DEBUG \"type=%Lu \", typ->vt_hdr >> VXFS_TYPED_TYPESHIFT);\n\tprintk(\"offset=%Lx \", typ->vt_hdr & VXFS_TYPED_OFFSETMASK);\n\tprintk(\"block=%x \", typ->vt_block);\n\tprintk(\"size=%x\\n\", typ->vt_size);\n}"
  }
]