[
  {
    "function_name": "vxfs_read_fshead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_fshead.c",
    "lines": "106-203",
    "snippet": "int\nvxfs_read_fshead(struct super_block *sbp)\n{\n\tstruct vxfs_sb_info\t\t*infp = VXFS_SBI(sbp);\n\tstruct vxfs_fsh\t\t\t*pfp, *sfp;\n\tstruct vxfs_inode_info\t\t*vip, *tip;\n\n\tvip = vxfs_blkiget(sbp, infp->vsi_iext, infp->vsi_fshino);\n\tif (!vip) {\n\t\tprintk(KERN_ERR \"vxfs: unable to read fsh inode\\n\");\n\t\treturn -EINVAL;\n\t}\n\tif (!VXFS_ISFSH(vip)) {\n\t\tprintk(KERN_ERR \"vxfs: fsh list inode is of wrong type (%x)\\n\",\n\t\t\t\tvip->vii_mode & VXFS_TYPE_MASK); \n\t\tgoto out_free_fship;\n\t}\n\n\n#ifdef DIAGNOSTIC\n\tprintk(\"vxfs: fsh inode dump:\\n\");\n\tvxfs_dumpi(vip, infp->vsi_fshino);\n#endif\n\n\tinfp->vsi_fship = vxfs_get_fake_inode(sbp, vip);\n\tif (!infp->vsi_fship) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get fsh inode\\n\");\n\t\tgoto out_free_fship;\n\t}\n\n\tsfp = vxfs_getfsh(infp->vsi_fship, 0);\n\tif (!sfp) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get structural fsh\\n\");\n\t\tgoto out_iput_fship;\n\t} \n\n#ifdef DIAGNOSTIC\n\tvxfs_dumpfsh(sfp);\n#endif\n\n\tpfp = vxfs_getfsh(infp->vsi_fship, 1);\n\tif (!pfp) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get primary fsh\\n\");\n\t\tgoto out_free_sfp;\n\t}\n\n#ifdef DIAGNOSTIC\n\tvxfs_dumpfsh(pfp);\n#endif\n\n\ttip = vxfs_blkiget(sbp, infp->vsi_iext, sfp->fsh_ilistino[0]);\n\tif (!tip)\n\t\tgoto out_free_pfp;\n\n\tinfp->vsi_stilist = vxfs_get_fake_inode(sbp, tip);\n\tif (!infp->vsi_stilist) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get structural list inode\\n\");\n\t\tkfree(tip);\n\t\tgoto out_free_pfp;\n\t}\n\tif (!VXFS_ISILT(VXFS_INO(infp->vsi_stilist))) {\n\t\tprintk(KERN_ERR \"vxfs: structural list inode is of wrong type (%x)\\n\",\n\t\t\t\tVXFS_INO(infp->vsi_stilist)->vii_mode & VXFS_TYPE_MASK); \n\t\tgoto out_iput_stilist;\n\t}\n\n\ttip = vxfs_stiget(sbp, pfp->fsh_ilistino[0]);\n\tif (!tip)\n\t\tgoto out_iput_stilist;\n\tinfp->vsi_ilist = vxfs_get_fake_inode(sbp, tip);\n\tif (!infp->vsi_ilist) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get inode list inode\\n\");\n\t\tkfree(tip);\n\t\tgoto out_iput_stilist;\n\t}\n\tif (!VXFS_ISILT(VXFS_INO(infp->vsi_ilist))) {\n\t\tprintk(KERN_ERR \"vxfs: inode list inode is of wrong type (%x)\\n\",\n\t\t\t\tVXFS_INO(infp->vsi_ilist)->vii_mode & VXFS_TYPE_MASK);\n\t\tgoto out_iput_ilist;\n\t}\n\n\treturn 0;\n\n out_iput_ilist:\n \tiput(infp->vsi_ilist);\n out_iput_stilist:\n \tiput(infp->vsi_stilist);\n out_free_pfp:\n\tkfree(pfp);\n out_free_sfp:\n \tkfree(sfp);\n out_iput_fship:\n\tiput(infp->vsi_fship);\n\treturn -EINVAL;\n out_free_fship:\n \tkfree(vip);\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"vxfs_fshead.h\"",
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "vip"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "infp->vsi_fship"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "dentry_iput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/dcache.c",
          "lines": "308-327",
          "snippet": "static void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/bootmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/security.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/cache.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/kasan.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/prefetch.h>\n#include <linux/rculist_bl.h>\n#include <linux/bit_spinlock.h>\n#include <linux/hardirq.h>\n#include <linux/fs_struct.h>\n#include <linux/bootmem.h>\n#include <linux/swap.h>\n#include <linux/seqlock.h>\n#include <linux/security.h>\n#include <asm/uaccess.h>\n#include <linux/file.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/cache.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/syscalls.h>\n\nstatic void dentry_iput(struct dentry * dentry)\n\t__releases(dentry->d_lock)\n\t__releases(dentry->d_inode->i_lock)\n{\n\tstruct inode *inode = dentry->d_inode;\n\tif (inode) {\n\t\tdentry->d_inode = NULL;\n\t\thlist_del_init(&dentry->d_u.d_alias);\n\t\tspin_unlock(&dentry->d_lock);\n\t\tspin_unlock(&inode->i_lock);\n\t\tif (!inode->i_nlink)\n\t\t\tfsnotify_inoderemove(inode);\n\t\tif (dentry->d_op && dentry->d_op->d_iput)\n\t\t\tdentry->d_op->d_iput(dentry, inode);\n\t\telse\n\t\t\tiput(inode);\n\t} else {\n\t\tspin_unlock(&dentry->d_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sfp"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pfp"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"vxfs: inode list inode is of wrong type (%x)\\n\"",
            "VXFS_INO(infp->vsi_ilist)->vii_mode & VXFS_TYPE_MASK"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "infp->vsi_ilist"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_ISILT",
          "args": [
            "VXFS_INO(infp->vsi_ilist)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "infp->vsi_ilist"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "tip"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_get_fake_inode",
          "args": [
            "sbp",
            "tip"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_get_fake_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_inode.c",
          "lines": "257-268",
          "snippet": "struct inode *\nvxfs_get_fake_inode(struct super_block *sbp, struct vxfs_inode_info *vip)\n{\n\tstruct inode\t\t\t*ip = NULL;\n\n\tif ((ip = new_inode(sbp))) {\n\t\tip->i_ino = get_next_ino();\n\t\tvxfs_iinit(ip, vip);\n\t\tip->i_mapping->a_ops = &vxfs_aops;\n\t}\n\treturn (ip);\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/pagemap.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstruct inode *\nvxfs_get_fake_inode(struct super_block *sbp, struct vxfs_inode_info *vip)\n{\n\tstruct inode\t\t\t*ip = NULL;\n\n\tif ((ip = new_inode(sbp))) {\n\t\tip->i_ino = get_next_ino();\n\t\tvxfs_iinit(ip, vip);\n\t\tip->i_mapping->a_ops = &vxfs_aops;\n\t}\n\treturn (ip);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_stiget",
          "args": [
            "sbp",
            "pfp->fsh_ilistino[0]"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_stiget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_inode.c",
          "lines": "173-180",
          "snippet": "struct vxfs_inode_info *\nvxfs_stiget(struct super_block *sbp, ino_t ino)\n{\n\tstruct vxfs_inode_info *vip;\n\n\tvip = __vxfs_iget(ino, VXFS_SBI(sbp)->vsi_stilist);\n\treturn IS_ERR(vip) ? NULL : vip;\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/pagemap.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstruct vxfs_inode_info *\nvxfs_stiget(struct super_block *sbp, ino_t ino)\n{\n\tstruct vxfs_inode_info *vip;\n\n\tvip = __vxfs_iget(ino, VXFS_SBI(sbp)->vsi_stilist);\n\treturn IS_ERR(vip) ? NULL : vip;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "infp->vsi_stilist"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_ISILT",
          "args": [
            "VXFS_INO(infp->vsi_stilist)"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_INO",
          "args": [
            "infp->vsi_stilist"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "tip"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vxfs_blkiget",
          "args": [
            "sbp",
            "infp->vsi_iext",
            "sfp->fsh_ilistino[0]"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_blkiget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_inode.c",
          "lines": "87-116",
          "snippet": "struct vxfs_inode_info *\nvxfs_blkiget(struct super_block *sbp, u_long extent, ino_t ino)\n{\n\tstruct buffer_head\t\t*bp;\n\tu_long\t\t\t\tblock, offset;\n\n\tblock = extent + ((ino * VXFS_ISIZE) / sbp->s_blocksize);\n\toffset = ((ino % (sbp->s_blocksize / VXFS_ISIZE)) * VXFS_ISIZE);\n\tbp = sb_bread(sbp, block);\n\n\tif (bp && buffer_mapped(bp)) {\n\t\tstruct vxfs_inode_info\t*vip;\n\t\tstruct vxfs_dinode\t*dip;\n\n\t\tif (!(vip = kmem_cache_alloc(vxfs_inode_cachep, GFP_KERNEL)))\n\t\t\tgoto fail;\n\t\tdip = (struct vxfs_dinode *)(bp->b_data + offset);\n\t\tmemcpy(vip, dip, sizeof(*vip));\n#ifdef DIAGNOSTIC\n\t\tvxfs_dumpi(vip, ino);\n#endif\n\t\tbrelse(bp);\n\t\treturn (vip);\n\t}\n\nfail:\n\tprintk(KERN_WARNING \"vxfs: unable to read block %ld\\n\", block);\n\tbrelse(bp);\n\treturn NULL;\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache\t\t*vxfs_inode_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/pagemap.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstruct kmem_cache\t\t*vxfs_inode_cachep;\n\nstruct vxfs_inode_info *\nvxfs_blkiget(struct super_block *sbp, u_long extent, ino_t ino)\n{\n\tstruct buffer_head\t\t*bp;\n\tu_long\t\t\t\tblock, offset;\n\n\tblock = extent + ((ino * VXFS_ISIZE) / sbp->s_blocksize);\n\toffset = ((ino % (sbp->s_blocksize / VXFS_ISIZE)) * VXFS_ISIZE);\n\tbp = sb_bread(sbp, block);\n\n\tif (bp && buffer_mapped(bp)) {\n\t\tstruct vxfs_inode_info\t*vip;\n\t\tstruct vxfs_dinode\t*dip;\n\n\t\tif (!(vip = kmem_cache_alloc(vxfs_inode_cachep, GFP_KERNEL)))\n\t\t\tgoto fail;\n\t\tdip = (struct vxfs_dinode *)(bp->b_data + offset);\n\t\tmemcpy(vip, dip, sizeof(*vip));\n#ifdef DIAGNOSTIC\n\t\tvxfs_dumpi(vip, ino);\n#endif\n\t\tbrelse(bp);\n\t\treturn (vip);\n\t}\n\nfail:\n\tprintk(KERN_WARNING \"vxfs: unable to read block %ld\\n\", block);\n\tbrelse(bp);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_dumpfsh",
          "args": [
            "pfp"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_dumpfsh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_fshead.c",
          "lines": "46-60",
          "snippet": "static void\nvxfs_dumpfsh(struct vxfs_fsh *fhp)\n{\n\tprintk(\"\\n\\ndumping fileset header:\\n\");\n\tprintk(\"----------------------------\\n\");\n\tprintk(\"version: %u\\n\", fhp->fsh_version);\n\tprintk(\"fsindex: %u\\n\", fhp->fsh_fsindex);\n\tprintk(\"iauino: %u\\tninodes:%u\\n\",\n\t\t\tfhp->fsh_iauino, fhp->fsh_ninodes);\n\tprintk(\"maxinode: %u\\tlctino: %u\\n\",\n\t\t\tfhp->fsh_maxinode, fhp->fsh_lctino);\n\tprintk(\"nau: %u\\n\", fhp->fsh_nau);\n\tprintk(\"ilistino[0]: %u\\tilistino[1]: %u\\n\",\n\t\t\tfhp->fsh_ilistino[0], fhp->fsh_ilistino[1]);\n}",
          "includes": [
            "#include \"vxfs_fshead.h\"",
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_fshead.h\"\n#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic void\nvxfs_dumpfsh(struct vxfs_fsh *fhp)\n{\n\tprintk(\"\\n\\ndumping fileset header:\\n\");\n\tprintk(\"----------------------------\\n\");\n\tprintk(\"version: %u\\n\", fhp->fsh_version);\n\tprintk(\"fsindex: %u\\n\", fhp->fsh_fsindex);\n\tprintk(\"iauino: %u\\tninodes:%u\\n\",\n\t\t\tfhp->fsh_iauino, fhp->fsh_ninodes);\n\tprintk(\"maxinode: %u\\tlctino: %u\\n\",\n\t\t\tfhp->fsh_maxinode, fhp->fsh_lctino);\n\tprintk(\"nau: %u\\n\", fhp->fsh_nau);\n\tprintk(\"ilistino[0]: %u\\tilistino[1]: %u\\n\",\n\t\t\tfhp->fsh_ilistino[0], fhp->fsh_ilistino[1]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_getfsh",
          "args": [
            "infp->vsi_fship",
            "1"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_getfsh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_fshead.c",
          "lines": "75-94",
          "snippet": "static struct vxfs_fsh *\nvxfs_getfsh(struct inode *ip, int which)\n{\n\tstruct buffer_head\t\t*bp;\n\n\tbp = vxfs_bread(ip, which);\n\tif (bp) {\n\t\tstruct vxfs_fsh\t\t*fhp;\n\n\t\tif (!(fhp = kmalloc(sizeof(*fhp), GFP_KERNEL)))\n\t\t\tgoto out;\n\t\tmemcpy(fhp, bp->b_data, sizeof(*fhp));\n\n\t\tput_bh(bp);\n\t\treturn (fhp);\n\t}\nout:\n\tbrelse(bp);\n\treturn NULL;\n}",
          "includes": [
            "#include \"vxfs_fshead.h\"",
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_fshead.h\"\n#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic struct vxfs_fsh *\nvxfs_getfsh(struct inode *ip, int which)\n{\n\tstruct buffer_head\t\t*bp;\n\n\tbp = vxfs_bread(ip, which);\n\tif (bp) {\n\t\tstruct vxfs_fsh\t\t*fhp;\n\n\t\tif (!(fhp = kmalloc(sizeof(*fhp), GFP_KERNEL)))\n\t\t\tgoto out;\n\t\tmemcpy(fhp, bp->b_data, sizeof(*fhp));\n\n\t\tput_bh(bp);\n\t\treturn (fhp);\n\t}\nout:\n\tbrelse(bp);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_dumpi",
          "args": [
            "vip",
            "infp->vsi_fshino"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_dumpi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_inode.c",
          "lines": "51-67",
          "snippet": "void\nvxfs_dumpi(struct vxfs_inode_info *vip, ino_t ino)\n{\n\tprintk(KERN_DEBUG \"\\n\\n\");\n\tif (ino)\n\t\tprintk(KERN_DEBUG \"dumping vxfs inode %ld\\n\", ino);\n\telse\n\t\tprintk(KERN_DEBUG \"dumping unknown vxfs inode\\n\");\n\n\tprintk(KERN_DEBUG \"---------------------------\\n\");\n\tprintk(KERN_DEBUG \"mode is %x\\n\", vip->vii_mode);\n\tprintk(KERN_DEBUG \"nlink:%u, uid:%u, gid:%u\\n\",\n\t\t\tvip->vii_nlink, vip->vii_uid, vip->vii_gid);\n\tprintk(KERN_DEBUG \"size:%Lx, blocks:%u\\n\",\n\t\t\tvip->vii_size, vip->vii_blocks);\n\tprintk(KERN_DEBUG \"orgtype:%u\\n\", vip->vii_orgtype);\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include \"vxfs_inode.h\"",
            "#include \"vxfs.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/pagemap.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nvoid\nvxfs_dumpi(struct vxfs_inode_info *vip, ino_t ino)\n{\n\tprintk(KERN_DEBUG \"\\n\\n\");\n\tif (ino)\n\t\tprintk(KERN_DEBUG \"dumping vxfs inode %ld\\n\", ino);\n\telse\n\t\tprintk(KERN_DEBUG \"dumping unknown vxfs inode\\n\");\n\n\tprintk(KERN_DEBUG \"---------------------------\\n\");\n\tprintk(KERN_DEBUG \"mode is %x\\n\", vip->vii_mode);\n\tprintk(KERN_DEBUG \"nlink:%u, uid:%u, gid:%u\\n\",\n\t\t\tvip->vii_nlink, vip->vii_uid, vip->vii_gid);\n\tprintk(KERN_DEBUG \"size:%Lx, blocks:%u\\n\",\n\t\t\tvip->vii_size, vip->vii_blocks);\n\tprintk(KERN_DEBUG \"orgtype:%u\\n\", vip->vii_orgtype);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VXFS_ISFSH",
          "args": [
            "vip"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VXFS_SBI",
          "args": [
            "sbp"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vxfs_fshead.h\"\n#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nint\nvxfs_read_fshead(struct super_block *sbp)\n{\n\tstruct vxfs_sb_info\t\t*infp = VXFS_SBI(sbp);\n\tstruct vxfs_fsh\t\t\t*pfp, *sfp;\n\tstruct vxfs_inode_info\t\t*vip, *tip;\n\n\tvip = vxfs_blkiget(sbp, infp->vsi_iext, infp->vsi_fshino);\n\tif (!vip) {\n\t\tprintk(KERN_ERR \"vxfs: unable to read fsh inode\\n\");\n\t\treturn -EINVAL;\n\t}\n\tif (!VXFS_ISFSH(vip)) {\n\t\tprintk(KERN_ERR \"vxfs: fsh list inode is of wrong type (%x)\\n\",\n\t\t\t\tvip->vii_mode & VXFS_TYPE_MASK); \n\t\tgoto out_free_fship;\n\t}\n\n\n#ifdef DIAGNOSTIC\n\tprintk(\"vxfs: fsh inode dump:\\n\");\n\tvxfs_dumpi(vip, infp->vsi_fshino);\n#endif\n\n\tinfp->vsi_fship = vxfs_get_fake_inode(sbp, vip);\n\tif (!infp->vsi_fship) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get fsh inode\\n\");\n\t\tgoto out_free_fship;\n\t}\n\n\tsfp = vxfs_getfsh(infp->vsi_fship, 0);\n\tif (!sfp) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get structural fsh\\n\");\n\t\tgoto out_iput_fship;\n\t} \n\n#ifdef DIAGNOSTIC\n\tvxfs_dumpfsh(sfp);\n#endif\n\n\tpfp = vxfs_getfsh(infp->vsi_fship, 1);\n\tif (!pfp) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get primary fsh\\n\");\n\t\tgoto out_free_sfp;\n\t}\n\n#ifdef DIAGNOSTIC\n\tvxfs_dumpfsh(pfp);\n#endif\n\n\ttip = vxfs_blkiget(sbp, infp->vsi_iext, sfp->fsh_ilistino[0]);\n\tif (!tip)\n\t\tgoto out_free_pfp;\n\n\tinfp->vsi_stilist = vxfs_get_fake_inode(sbp, tip);\n\tif (!infp->vsi_stilist) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get structural list inode\\n\");\n\t\tkfree(tip);\n\t\tgoto out_free_pfp;\n\t}\n\tif (!VXFS_ISILT(VXFS_INO(infp->vsi_stilist))) {\n\t\tprintk(KERN_ERR \"vxfs: structural list inode is of wrong type (%x)\\n\",\n\t\t\t\tVXFS_INO(infp->vsi_stilist)->vii_mode & VXFS_TYPE_MASK); \n\t\tgoto out_iput_stilist;\n\t}\n\n\ttip = vxfs_stiget(sbp, pfp->fsh_ilistino[0]);\n\tif (!tip)\n\t\tgoto out_iput_stilist;\n\tinfp->vsi_ilist = vxfs_get_fake_inode(sbp, tip);\n\tif (!infp->vsi_ilist) {\n\t\tprintk(KERN_ERR \"vxfs: unable to get inode list inode\\n\");\n\t\tkfree(tip);\n\t\tgoto out_iput_stilist;\n\t}\n\tif (!VXFS_ISILT(VXFS_INO(infp->vsi_ilist))) {\n\t\tprintk(KERN_ERR \"vxfs: inode list inode is of wrong type (%x)\\n\",\n\t\t\t\tVXFS_INO(infp->vsi_ilist)->vii_mode & VXFS_TYPE_MASK);\n\t\tgoto out_iput_ilist;\n\t}\n\n\treturn 0;\n\n out_iput_ilist:\n \tiput(infp->vsi_ilist);\n out_iput_stilist:\n \tiput(infp->vsi_stilist);\n out_free_pfp:\n\tkfree(pfp);\n out_free_sfp:\n \tkfree(sfp);\n out_iput_fship:\n\tiput(infp->vsi_fship);\n\treturn -EINVAL;\n out_free_fship:\n \tkfree(vip);\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "vxfs_getfsh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_fshead.c",
    "lines": "75-94",
    "snippet": "static struct vxfs_fsh *\nvxfs_getfsh(struct inode *ip, int which)\n{\n\tstruct buffer_head\t\t*bp;\n\n\tbp = vxfs_bread(ip, which);\n\tif (bp) {\n\t\tstruct vxfs_fsh\t\t*fhp;\n\n\t\tif (!(fhp = kmalloc(sizeof(*fhp), GFP_KERNEL)))\n\t\t\tgoto out;\n\t\tmemcpy(fhp, bp->b_data, sizeof(*fhp));\n\n\t\tput_bh(bp);\n\t\treturn (fhp);\n\t}\nout:\n\tbrelse(bp);\n\treturn NULL;\n}",
    "includes": [
      "#include \"vxfs_fshead.h\"",
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "brelse",
          "args": [
            "bp"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "__brelse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/buffer.c",
          "lines": "1177-1184",
          "snippet": "void __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}",
          "includes": [
            "#include <trace/events/block.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/mpage.h>",
            "#include <linux/bitops.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/bio.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/suspend.h>",
            "#include <linux/hash.h>",
            "#include <linux/writeback.h>",
            "#include <linux/export.h>",
            "#include <linux/highmem.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/file.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/capability.h>",
            "#include <linux/slab.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/block.h>\n#include <linux/bit_spinlock.h>\n#include <linux/mpage.h>\n#include <linux/bitops.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/bio.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/buffer_head.h>\n#include <linux/suspend.h>\n#include <linux/hash.h>\n#include <linux/writeback.h>\n#include <linux/export.h>\n#include <linux/highmem.h>\n#include <linux/quotaops.h>\n#include <linux/file.h>\n#include <linux/blkdev.h>\n#include <linux/capability.h>\n#include <linux/slab.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n\nvoid __brelse(struct buffer_head * buf)\n{\n\tif (atomic_read(&buf->b_count)) {\n\t\tput_bh(buf);\n\t\treturn;\n\t}\n\tWARN(1, KERN_ERR \"VFS: brelse: Trying to free free buffer\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_bh",
          "args": [
            "bp"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fhp",
            "bp->b_data",
            "sizeof(*fhp)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*fhp)",
            "GFP_KERNEL"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_dx_dir_kmalloc_leaves",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/ocfs2/dir.c",
          "lines": "2534-2546",
          "snippet": "static struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}",
          "includes": [
            "#include \"buffer_head_io.h\"",
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"sysfile.h\"",
            "#include \"super.h\"",
            "#include \"suballoc.h\"",
            "#include \"namei.h\"",
            "#include \"journal.h\"",
            "#include \"inode.h\"",
            "#include \"file.h\"",
            "#include \"extent_map.h\"",
            "#include \"dlmglue.h\"",
            "#include \"dir.h\"",
            "#include \"blockcheck.h\"",
            "#include \"alloc.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/sort.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"buffer_head_io.h\"\n#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"sysfile.h\"\n#include \"super.h\"\n#include \"suballoc.h\"\n#include \"namei.h\"\n#include \"journal.h\"\n#include \"inode.h\"\n#include \"file.h\"\n#include \"extent_map.h\"\n#include \"dlmglue.h\"\n#include \"dir.h\"\n#include \"blockcheck.h\"\n#include \"alloc.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/sort.h>\n#include <linux/quotaops.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstatic struct buffer_head **ocfs2_dx_dir_kmalloc_leaves(struct super_block *sb,\n\t\t\t\t\t\t\tint *ret_num_leaves)\n{\n\tint num_dx_leaves = ocfs2_clusters_to_blocks(sb, 1);\n\tstruct buffer_head **dx_leaves;\n\n\tdx_leaves = kcalloc(num_dx_leaves, sizeof(struct buffer_head *),\n\t\t\t    GFP_NOFS);\n\tif (dx_leaves && ret_num_leaves)\n\t\t*ret_num_leaves = num_dx_leaves;\n\n\treturn dx_leaves;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vxfs_bread",
          "args": [
            "ip",
            "which"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "vxfs_bread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_subr.c",
          "lines": "101-111",
          "snippet": "struct buffer_head *\nvxfs_bread(struct inode *ip, int block)\n{\n\tstruct buffer_head\t*bp;\n\tdaddr_t\t\t\tpblock;\n\n\tpblock = vxfs_bmap1(ip, block);\n\tbp = sb_bread(ip->i_sb, pblock);\n\n\treturn (bp);\n}",
          "includes": [
            "#include \"vxfs_extern.h\"",
            "#include <linux/pagemap.h>",
            "#include <linux/kernel.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vxfs_extern.h\"\n#include <linux/pagemap.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstruct buffer_head *\nvxfs_bread(struct inode *ip, int block)\n{\n\tstruct buffer_head\t*bp;\n\tdaddr_t\t\t\tpblock;\n\n\tpblock = vxfs_bmap1(ip, block);\n\tbp = sb_bread(ip->i_sb, pblock);\n\n\treturn (bp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vxfs_fshead.h\"\n#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic struct vxfs_fsh *\nvxfs_getfsh(struct inode *ip, int which)\n{\n\tstruct buffer_head\t\t*bp;\n\n\tbp = vxfs_bread(ip, which);\n\tif (bp) {\n\t\tstruct vxfs_fsh\t\t*fhp;\n\n\t\tif (!(fhp = kmalloc(sizeof(*fhp), GFP_KERNEL)))\n\t\t\tgoto out;\n\t\tmemcpy(fhp, bp->b_data, sizeof(*fhp));\n\n\t\tput_bh(bp);\n\t\treturn (fhp);\n\t}\nout:\n\tbrelse(bp);\n\treturn NULL;\n}"
  },
  {
    "function_name": "vxfs_dumpfsh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/freevxfs/vxfs_fshead.c",
    "lines": "46-60",
    "snippet": "static void\nvxfs_dumpfsh(struct vxfs_fsh *fhp)\n{\n\tprintk(\"\\n\\ndumping fileset header:\\n\");\n\tprintk(\"----------------------------\\n\");\n\tprintk(\"version: %u\\n\", fhp->fsh_version);\n\tprintk(\"fsindex: %u\\n\", fhp->fsh_fsindex);\n\tprintk(\"iauino: %u\\tninodes:%u\\n\",\n\t\t\tfhp->fsh_iauino, fhp->fsh_ninodes);\n\tprintk(\"maxinode: %u\\tlctino: %u\\n\",\n\t\t\tfhp->fsh_maxinode, fhp->fsh_lctino);\n\tprintk(\"nau: %u\\n\", fhp->fsh_nau);\n\tprintk(\"ilistino[0]: %u\\tilistino[1]: %u\\n\",\n\t\t\tfhp->fsh_ilistino[0], fhp->fsh_ilistino[1]);\n}",
    "includes": [
      "#include \"vxfs_fshead.h\"",
      "#include \"vxfs_extern.h\"",
      "#include \"vxfs_inode.h\"",
      "#include \"vxfs.h\"",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/buffer_head.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"ilistino[0]: %u\\tilistino[1]: %u\\n\"",
            "fhp->fsh_ilistino[0]",
            "fhp->fsh_ilistino[1]"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "compat_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/compat.c",
          "lines": "59-69",
          "snippet": "int compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/ioctls.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/aio.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/mm.h>",
            "#include <linux/poll.h>",
            "#include <linux/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/security.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/personality.h>",
            "#include <linux/highuid.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/dirent.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nfs4_mount.h>",
            "#include <linux/ncp_mount.h>",
            "#include <linux/init.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/vfs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/namei.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/errno.h>",
            "#include <linux/compat.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int compat_log = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/ioctls.h>\n#include <asm/mmu_context.h>\n#include <asm/uaccess.h>\n#include <linux/aio.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/fs_struct.h>\n#include <linux/mm.h>\n#include <linux/poll.h>\n#include <linux/signal.h>\n#include <linux/highmem.h>\n#include <linux/security.h>\n#include <linux/tsacct_kern.h>\n#include <linux/rwsem.h>\n#include <linux/personality.h>\n#include <linux/highuid.h>\n#include <linux/fsnotify.h>\n#include <linux/dirent.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/nfs4_mount.h>\n#include <linux/ncp_mount.h>\n#include <linux/init.h>\n#include <linux/ioctl.h>\n#include <linux/vfs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/namei.h>\n#include <linux/fcntl.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/errno.h>\n#include <linux/compat.h>\n#include <linux/linkage.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n\nint compat_log = 1;\n\nint compat_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tint ret;\n\tif (!compat_log)\n\t\treturn 0;\n\tva_start(ap, fmt);\n\tret = vprintk(fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vxfs_fshead.h\"\n#include \"vxfs_extern.h\"\n#include \"vxfs_inode.h\"\n#include \"vxfs.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/buffer_head.h>\n#include <linux/fs.h>\n\nstatic void\nvxfs_dumpfsh(struct vxfs_fsh *fhp)\n{\n\tprintk(\"\\n\\ndumping fileset header:\\n\");\n\tprintk(\"----------------------------\\n\");\n\tprintk(\"version: %u\\n\", fhp->fsh_version);\n\tprintk(\"fsindex: %u\\n\", fhp->fsh_fsindex);\n\tprintk(\"iauino: %u\\tninodes:%u\\n\",\n\t\t\tfhp->fsh_iauino, fhp->fsh_ninodes);\n\tprintk(\"maxinode: %u\\tlctino: %u\\n\",\n\t\t\tfhp->fsh_maxinode, fhp->fsh_lctino);\n\tprintk(\"nau: %u\\n\", fhp->fsh_nau);\n\tprintk(\"ilistino[0]: %u\\tilistino[1]: %u\\n\",\n\t\t\tfhp->fsh_ilistino[0], fhp->fsh_ilistino[1]);\n}"
  }
]