[
  {
    "function_name": "nfs_stat_to_errno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "1106-1116",
    "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);",
      "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: Unrecognized nfs status value: %u\\n\"",
            "status"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_statfsres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "1036-1052",
    "snippet": "static int nfs2_xdr_dec_statfsres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  struct nfs2_fsstat *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_info(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 1051
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_info",
          "args": [
            "xdr",
            "result"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "decode_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1018-1034",
          "snippet": "static int decode_info(struct xdr_stream *xdr, struct nfs2_fsstat *result)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_info_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tresult->tsize  = be32_to_cpup(p++);\n\tresult->bsize  = be32_to_cpup(p++);\n\tresult->blocks = be32_to_cpup(p++);\n\tresult->bfree  = be32_to_cpup(p++);\n\tresult->bavail = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS_info_sz\t\t(5)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_info_sz\t\t(5)\n\nstatic int decode_info(struct xdr_stream *xdr, struct nfs2_fsstat *result)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_info_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tresult->tsize  = be32_to_cpup(p++);\n\tresult->bsize  = be32_to_cpup(p++);\n\tresult->blocks = be32_to_cpup(p++);\n\tresult->bfree  = be32_to_cpup(p++);\n\tresult->bavail = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int nfs2_xdr_dec_statfsres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t  struct nfs2_fsstat *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_info(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "decode_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "1018-1034",
    "snippet": "static int decode_info(struct xdr_stream *xdr, struct nfs2_fsstat *result)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_info_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tresult->tsize  = be32_to_cpup(p++);\n\tresult->bsize  = be32_to_cpup(p++);\n\tresult->blocks = be32_to_cpup(p++);\n\tresult->bfree  = be32_to_cpup(p++);\n\tresult->bavail = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS_info_sz\t\t(5)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "NFS_info_sz << 2"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_info_sz\t\t(5)\n\nstatic int decode_info(struct xdr_stream *xdr, struct nfs2_fsstat *result)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_info_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tresult->tsize  = be32_to_cpup(p++);\n\tresult->bsize  = be32_to_cpup(p++);\n\tresult->blocks = be32_to_cpup(p++);\n\tresult->bfree  = be32_to_cpup(p++);\n\tresult->bavail = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_readdirres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "984-1000",
    "snippet": "static int nfs2_xdr_dec_readdirres(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr, void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_readdirok(xdr);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_readdirok",
          "args": [
            "xdr"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "decode_readdirok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "979-982",
          "snippet": "static int decode_readdirok(struct xdr_stream *xdr)\n{\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readdirok(struct xdr_stream *xdr)\n{\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int nfs2_xdr_dec_readdirres(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr, void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_readdirok(xdr);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "decode_readdirok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "979-982",
    "snippet": "static int decode_readdirok(struct xdr_stream *xdr)\n{\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "xdr->buf->page_len"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_readdirok(struct xdr_stream *xdr)\n{\n\treturn xdr_read_pages(xdr, xdr->buf->page_len);\n}"
  },
  {
    "function_name": "nfs2_decode_dirent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "915-960",
    "snippet": "int nfs2_decode_dirent(struct xdr_stream *xdr, struct nfs_entry *entry,\n\t\t       int plus)\n{\n\t__be32 *p;\n\tint error;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (*p++ == xdr_zero) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(p == NULL))\n\t\t\tgoto out_overflow;\n\t\tif (*p++ == xdr_zero)\n\t\t\treturn -EAGAIN;\n\t\tentry->eof = 1;\n\t\treturn -EBADCOOKIE;\n\t}\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tentry->ino = be32_to_cpup(p);\n\n\terror = decode_filename_inline(xdr, &entry->name, &entry->len);\n\tif (unlikely(error))\n\t\treturn error;\n\n\t/*\n\t * The type (size and byte order) of nfscookie isn't defined in\n\t * RFC 1094.  This implementation assumes that it's an XDR uint32.\n\t */\n\tentry->prev_cookie = entry->cookie;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tentry->cookie = be32_to_cpup(p);\n\n\tentry->d_type = DT_UNKNOWN;\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EAGAIN;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_filename_inline",
          "args": [
            "xdr",
            "&entry->name",
            "&entry->len"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "decode_filename_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "406-430",
          "snippet": "static int decode_filename_inline(struct xdr_stream *xdr,\n\t\t\t\t  const char **name, u32 *length)\n{\n\t__be32 *p;\n\tu32 count;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\tif (count > NFS3_MAXNAMLEN)\n\t\tgoto out_nametoolong;\n\tp = xdr_inline_decode(xdr, count);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*name = (const char *)p;\n\t*length = count;\n\treturn 0;\nout_nametoolong:\n\tdprintk(\"NFS: returned filename too long: %u\\n\", count);\n\treturn -ENAMETOOLONG;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_filename_inline(struct xdr_stream *xdr,\n\t\t\t\t  const char **name, u32 *length)\n{\n\t__be32 *p;\n\tu32 count;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\tif (count > NFS3_MAXNAMLEN)\n\t\tgoto out_nametoolong;\n\tp = xdr_inline_decode(xdr, count);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*name = (const char *)p;\n\t*length = count;\n\treturn 0;\nout_nametoolong:\n\tdprintk(\"NFS: returned filename too long: %u\\n\", count);\n\treturn -ENAMETOOLONG;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nint nfs2_decode_dirent(struct xdr_stream *xdr, struct nfs_entry *entry,\n\t\t       int plus)\n{\n\t__be32 *p;\n\tint error;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tif (*p++ == xdr_zero) {\n\t\tp = xdr_inline_decode(xdr, 4);\n\t\tif (unlikely(p == NULL))\n\t\t\tgoto out_overflow;\n\t\tif (*p++ == xdr_zero)\n\t\t\treturn -EAGAIN;\n\t\tentry->eof = 1;\n\t\treturn -EBADCOOKIE;\n\t}\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tentry->ino = be32_to_cpup(p);\n\n\terror = decode_filename_inline(xdr, &entry->name, &entry->len);\n\tif (unlikely(error))\n\t\treturn error;\n\n\t/*\n\t * The type (size and byte order) of nfscookie isn't defined in\n\t * RFC 1094.  This implementation assumes that it's an XDR uint32.\n\t */\n\tentry->prev_cookie = entry->cookie;\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tentry->cookie = be32_to_cpup(p);\n\n\tentry->d_type = DT_UNKNOWN;\n\n\treturn 0;\n\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EAGAIN;\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_writeres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "884-890",
    "snippet": "static int nfs2_xdr_dec_writeres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_pgio_res *result)\n{\n\t/* All NFSv2 writes are \"file sync\" writes */\n\tresult->verf->committed = NFS_FILE_SYNC;\n\treturn decode_attrstat(xdr, result->fattr, &result->op_status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_attrstat",
          "args": [
            "xdr",
            "result->fattr",
            "&result->op_status"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attrstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "484-502",
          "snippet": "static int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs2_xdr_dec_writeres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_pgio_res *result)\n{\n\t/* All NFSv2 writes are \"file sync\" writes */\n\tresult->verf->committed = NFS_FILE_SYNC;\n\treturn decode_attrstat(xdr, result->fattr, &result->op_status);\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_readres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "862-882",
    "snippet": "static int nfs2_xdr_dec_readres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_pgio_res *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tresult->op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result->fattr);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nfsdata(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_nfsdata",
          "args": [
            "xdr",
            "result"
          ],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "decode_nfsdata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "106-130",
          "snippet": "static int decode_nfsdata(struct xdr_stream *xdr, struct nfs_pgio_res *result)\n{\n\tu32 recvd, count;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (unlikely(count > recvd))\n\t\tgoto out_cheating;\nout:\n\tresult->eof = 0;\t/* NFSv2 does not pass EOF flag on the wire. */\n\tresult->count = count;\n\treturn count;\nout_cheating:\n\tdprintk(\"NFS: server cheating in read result: \"\n\t\t\"count %u > recvd %u\\n\", count, recvd);\n\tcount = recvd;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_nfsdata(struct xdr_stream *xdr, struct nfs_pgio_res *result)\n{\n\tu32 recvd, count;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (unlikely(count > recvd))\n\t\tgoto out_cheating;\nout:\n\tresult->eof = 0;\t/* NFSv2 does not pass EOF flag on the wire. */\n\tresult->count = count;\n\treturn count;\nout_cheating:\n\tdprintk(\"NFS: server cheating in read result: \"\n\t\t\"count %u > recvd %u\\n\", count, recvd);\n\tcount = recvd;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_fattr",
          "args": [
            "xdr",
            "result->fattr"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "278-330",
          "snippet": "static int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS_fattr_sz\t\t(17)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_fattr_sz\t\t(17)\n\nstatic int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int nfs2_xdr_dec_readres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\tstruct nfs_pgio_res *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tresult->op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result->fattr);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_nfsdata(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_readlinkres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "833-849",
    "snippet": "static int nfs2_xdr_dec_readlinkres(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr, void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_path(xdr);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_path",
          "args": [
            "xdr"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "decode_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "446-472",
          "snippet": "static int decode_path(struct xdr_stream *xdr)\n{\n\tu32 length, recvd;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p);\n\tif (unlikely(length >= xdr->buf->page_len || length > NFS_MAXPATHLEN))\n\t\tgoto out_size;\n\trecvd = xdr_read_pages(xdr, length);\n\tif (unlikely(length > recvd))\n\t\tgoto out_cheating;\n\txdr_terminate_string(xdr->buf, length);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned pathname too long: %u\\n\", length);\n\treturn -ENAMETOOLONG;\nout_cheating:\n\tdprintk(\"NFS: server cheating in pathname result: \"\n\t\t\"length %u > received %u\\n\", length, recvd);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_path(struct xdr_stream *xdr)\n{\n\tu32 length, recvd;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p);\n\tif (unlikely(length >= xdr->buf->page_len || length > NFS_MAXPATHLEN))\n\t\tgoto out_size;\n\trecvd = xdr_read_pages(xdr, length);\n\tif (unlikely(length > recvd))\n\t\tgoto out_cheating;\n\txdr_terminate_string(xdr->buf, length);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned pathname too long: %u\\n\", length);\n\treturn -ENAMETOOLONG;\nout_cheating:\n\tdprintk(\"NFS: server cheating in pathname result: \"\n\t\t\"length %u > received %u\\n\", length, recvd);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int nfs2_xdr_dec_readlinkres(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr, void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_path(xdr);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_diropres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "817-821",
    "snippet": "static int nfs2_xdr_dec_diropres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_diropok *result)\n{\n\treturn decode_diropres(xdr, result);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_diropres",
          "args": [
            "xdr",
            "result"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "decode_diropres",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "544-559",
          "snippet": "static int decode_diropres(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_diropok(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_diropres(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_diropok(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs2_xdr_dec_diropres(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_diropok *result)\n{\n\treturn decode_diropres(xdr, result);\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_attrstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "811-815",
    "snippet": "static int nfs2_xdr_dec_attrstat(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_fattr *result)\n{\n\treturn decode_attrstat(xdr, result, NULL);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_attrstat",
          "args": [
            "xdr",
            "result",
            "NULL"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "decode_attrstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "484-502",
          "snippet": "static int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs2_xdr_dec_attrstat(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t\t struct nfs_fattr *result)\n{\n\treturn decode_attrstat(xdr, result, NULL);\n}"
  },
  {
    "function_name": "nfs2_xdr_dec_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "794-809",
    "snippet": "static int nfs2_xdr_dec_stat(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t     void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int nfs2_xdr_dec_stat(struct rpc_rqst *req, struct xdr_stream *xdr,\n\t\t\t     void *__unused)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_readdirargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "778-785",
    "snippet": "static void nfs2_xdr_enc_readdirargs(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs_readdirargs *args)\n{\n\tencode_readdirargs(xdr, args);\n\tprepare_reply_buffer(req, args->pages, 0,\n\t\t\t\t\targs->count, NFS_readdirres_sz);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS_readdirres_sz\t(1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prepare_reply_buffer",
          "args": [
            "req",
            "args->pages",
            "0",
            "args->count",
            "NFS_readdirres_sz"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_reply_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "70-79",
          "snippet": "static void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_readdirargs",
          "args": [
            "xdr",
            "args"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "encode_readdirargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "766-776",
          "snippet": "static void encode_readdirargs(struct xdr_stream *xdr,\n\t\t\t       const struct nfs_readdirargs *args)\n{\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(args->cookie);\n\t*p = cpu_to_be32(args->count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_readdirargs(struct xdr_stream *xdr,\n\t\t\t       const struct nfs_readdirargs *args)\n{\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(args->cookie);\n\t*p = cpu_to_be32(args->count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_readdirres_sz\t(1)\n\nstatic void nfs2_xdr_enc_readdirargs(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs_readdirargs *args)\n{\n\tencode_readdirargs(xdr, args);\n\tprepare_reply_buffer(req, args->pages, 0,\n\t\t\t\t\targs->count, NFS_readdirres_sz);\n}"
  },
  {
    "function_name": "encode_readdirargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "766-776",
    "snippet": "static void encode_readdirargs(struct xdr_stream *xdr,\n\t\t\t       const struct nfs_readdirargs *args)\n{\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(args->cookie);\n\t*p = cpu_to_be32(args->count);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->count"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "args->cookie"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 4"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fh"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_readdirargs(struct xdr_stream *xdr,\n\t\t\t       const struct nfs_readdirargs *args)\n{\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4);\n\t*p++ = cpu_to_be32(args->cookie);\n\t*p = cpu_to_be32(args->count);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_symlinkargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "748-755",
    "snippet": "static void nfs2_xdr_enc_symlinkargs(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs_symlinkargs *args)\n{\n\tencode_diropargs(xdr, args->fromfh, args->fromname, args->fromlen);\n\tencode_path(xdr, args->pages, args->pathlen);\n\tencode_sattr(xdr, args->sattr);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_sattr",
          "args": [
            "xdr",
            "args->sattr"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "354-389",
          "snippet": "static void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS2_SATTR_NOT_SET\t(0xffffffff)",
            "#define NFS_sattr_sz\t\t(8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n#define NFS_sattr_sz\t\t(8)\n\nstatic void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_path",
          "args": [
            "xdr",
            "args->pages",
            "args->pathlen"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "encode_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "437-444",
          "snippet": "static void encode_path(struct xdr_stream *xdr, struct page **pages, u32 length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(length);\n\txdr_write_pages(xdr, pages, 0, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_path(struct xdr_stream *xdr, struct page **pages, u32 length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(length);\n\txdr_write_pages(xdr, pages, 0, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->fromfh",
            "args->fromname",
            "args->fromlen"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_symlinkargs(struct rpc_rqst *req,\n\t\t\t\t     struct xdr_stream *xdr,\n\t\t\t\t     const struct nfs_symlinkargs *args)\n{\n\tencode_diropargs(xdr, args->fromfh, args->fromname, args->fromlen);\n\tencode_path(xdr, args->pages, args->pathlen);\n\tencode_sattr(xdr, args->sattr);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_linkargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "731-737",
    "snippet": "static void nfs2_xdr_enc_linkargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs_linkargs *args)\n{\n\tencode_fhandle(xdr, args->fromfh);\n\tencode_diropargs(xdr, args->tofh, args->toname, args->tolen);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->tofh",
            "args->toname",
            "args->tolen"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fromfh"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_linkargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs_linkargs *args)\n{\n\tencode_fhandle(xdr, args->fromfh);\n\tencode_diropargs(xdr, args->tofh, args->toname, args->tolen);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_renameargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "712-721",
    "snippet": "static void nfs2_xdr_enc_renameargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_renameargs *args)\n{\n\tconst struct qstr *old = args->old_name;\n\tconst struct qstr *new = args->new_name;\n\n\tencode_diropargs(xdr, args->old_dir, old->name, old->len);\n\tencode_diropargs(xdr, args->new_dir, new->name, new->len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->new_dir",
            "new->name",
            "new->len"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_renameargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_renameargs *args)\n{\n\tconst struct qstr *old = args->old_name;\n\tconst struct qstr *new = args->new_name;\n\n\tencode_diropargs(xdr, args->old_dir, old->name, old->len);\n\tencode_diropargs(xdr, args->new_dir, new->name, new->len);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_removeargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "697-702",
    "snippet": "static void nfs2_xdr_enc_removeargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_removeargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name.name, args->name.len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->fh",
            "args->name.name",
            "args->name.len"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_removeargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_removeargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name.name, args->name.len);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_createargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "689-695",
    "snippet": "static void nfs2_xdr_enc_createargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_createargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name, args->len);\n\tencode_sattr(xdr, args->sattr);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_sattr",
          "args": [
            "xdr",
            "args->sattr"
          ],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "354-389",
          "snippet": "static void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS2_SATTR_NOT_SET\t(0xffffffff)",
            "#define NFS_sattr_sz\t\t(8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n#define NFS_sattr_sz\t\t(8)\n\nstatic void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->fh",
            "args->name",
            "args->len"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_createargs(struct rpc_rqst *req,\n\t\t\t\t    struct xdr_stream *xdr,\n\t\t\t\t    const struct nfs_createargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name, args->len);\n\tencode_sattr(xdr, args->sattr);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_writeargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "673-679",
    "snippet": "static void nfs2_xdr_enc_writeargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_pgio_args *args)\n{\n\tencode_writeargs(xdr, args);\n\txdr->buf->flags |= XDRBUF_WRITE;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_writeargs",
          "args": [
            "xdr",
            "args"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "encode_writeargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "654-671",
          "snippet": "static void encode_writeargs(struct xdr_stream *xdr,\n\t\t\t     const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\n\t/* nfsdata */\n\t*p = cpu_to_be32(count);\n\txdr_write_pages(xdr, args->pages, args->pgbase, count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_writeargs(struct xdr_stream *xdr,\n\t\t\t     const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\n\t/* nfsdata */\n\t*p = cpu_to_be32(count);\n\txdr_write_pages(xdr, args->pages, args->pgbase, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_writeargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_pgio_args *args)\n{\n\tencode_writeargs(xdr, args);\n\txdr->buf->flags |= XDRBUF_WRITE;\n}"
  },
  {
    "function_name": "encode_writeargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "654-671",
    "snippet": "static void encode_writeargs(struct xdr_stream *xdr,\n\t\t\t     const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\n\t/* nfsdata */\n\t*p = cpu_to_be32(count);\n\txdr_write_pages(xdr, args->pages, args->pgbase, count);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "args->pages",
            "args->pgbase",
            "count"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "count"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "count"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "offset"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "offset"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 4 + 4 + 4"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fh"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_writeargs(struct xdr_stream *xdr,\n\t\t\t     const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\n\t/* nfsdata */\n\t*p = cpu_to_be32(count);\n\txdr_write_pages(xdr, args->pages, args->pgbase, count);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_readargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "633-641",
    "snippet": "static void nfs2_xdr_enc_readargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs_pgio_args *args)\n{\n\tencode_readargs(xdr, args);\n\tprepare_reply_buffer(req, args->pages, args->pgbase,\n\t\t\t\t\targs->count, NFS_readres_sz);\n\treq->rq_rcv_buf.flags |= XDRBUF_READ;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS_readres_sz\t\t(1+NFS_fattr_sz+1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prepare_reply_buffer",
          "args": [
            "req",
            "args->pages",
            "args->pgbase",
            "args->count",
            "NFS_readres_sz"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_reply_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "70-79",
          "snippet": "static void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_readargs",
          "args": [
            "xdr",
            "args"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "encode_readargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "618-631",
          "snippet": "static void encode_readargs(struct xdr_stream *xdr,\n\t\t\t    const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\t*p = cpu_to_be32(count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_readargs(struct xdr_stream *xdr,\n\t\t\t    const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\t*p = cpu_to_be32(count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_readres_sz\t\t(1+NFS_fattr_sz+1)\n\nstatic void nfs2_xdr_enc_readargs(struct rpc_rqst *req,\n\t\t\t\t  struct xdr_stream *xdr,\n\t\t\t\t  const struct nfs_pgio_args *args)\n{\n\tencode_readargs(xdr, args);\n\tprepare_reply_buffer(req, args->pages, args->pgbase,\n\t\t\t\t\targs->count, NFS_readres_sz);\n\treq->rq_rcv_buf.flags |= XDRBUF_READ;\n}"
  },
  {
    "function_name": "encode_readargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "618-631",
    "snippet": "static void encode_readargs(struct xdr_stream *xdr,\n\t\t\t    const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\t*p = cpu_to_be32(count);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "count"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "count"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "offset"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + 4 + 4"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fh"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_readargs(struct xdr_stream *xdr,\n\t\t\t    const struct nfs_pgio_args *args)\n{\n\tu32 offset = args->offset;\n\tu32 count = args->count;\n\t__be32 *p;\n\n\tencode_fhandle(xdr, args->fh);\n\n\tp = xdr_reserve_space(xdr, 4 + 4 + 4);\n\t*p++ = cpu_to_be32(offset);\n\t*p++ = cpu_to_be32(count);\n\t*p = cpu_to_be32(count);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_readlinkargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "599-606",
    "snippet": "static void nfs2_xdr_enc_readlinkargs(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      const struct nfs_readlinkargs *args)\n{\n\tencode_fhandle(xdr, args->fh);\n\tprepare_reply_buffer(req, args->pages, args->pgbase,\n\t\t\t\t\targs->pglen, NFS_readlinkres_sz);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS_readlinkres_sz\t(2)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prepare_reply_buffer",
          "args": [
            "req",
            "args->pages",
            "args->pgbase",
            "args->pglen",
            "NFS_readlinkres_sz"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_reply_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "70-79",
          "snippet": "static void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fh"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_readlinkres_sz\t(2)\n\nstatic void nfs2_xdr_enc_readlinkargs(struct rpc_rqst *req,\n\t\t\t\t      struct xdr_stream *xdr,\n\t\t\t\t      const struct nfs_readlinkargs *args)\n{\n\tencode_fhandle(xdr, args->fh);\n\tprepare_reply_buffer(req, args->pages, args->pgbase,\n\t\t\t\t\targs->pglen, NFS_readlinkres_sz);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_diropargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "592-597",
    "snippet": "static void nfs2_xdr_enc_diropargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_diropargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name, args->len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_diropargs",
          "args": [
            "xdr",
            "args->fh",
            "args->name",
            "args->len"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "encode_diropargs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "512-517",
          "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_diropargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_diropargs *args)\n{\n\tencode_diropargs(xdr, args->fh, args->name, args->len);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_sattrargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "584-590",
    "snippet": "static void nfs2_xdr_enc_sattrargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_sattrargs *args)\n{\n\tencode_fhandle(xdr, args->fh);\n\tencode_sattr(xdr, args->sattr);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_sattr",
          "args": [
            "xdr",
            "args->sattr"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "encode_sattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "354-389",
          "snippet": "static void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS2_SATTR_NOT_SET\t(0xffffffff)",
            "#define NFS_sattr_sz\t\t(8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n#define NFS_sattr_sz\t\t(8)\n\nstatic void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "args->fh"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_sattrargs(struct rpc_rqst *req,\n\t\t\t\t   struct xdr_stream *xdr,\n\t\t\t\t   const struct nfs_sattrargs *args)\n{\n\tencode_fhandle(xdr, args->fh);\n\tencode_sattr(xdr, args->sattr);\n}"
  },
  {
    "function_name": "nfs2_xdr_enc_fhandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "569-574",
    "snippet": "static void nfs2_xdr_enc_fhandle(struct rpc_rqst *req,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t const struct nfs_fh *fh)\n{\n\tencode_fhandle(xdr, fh);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "fh"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void nfs2_xdr_enc_fhandle(struct rpc_rqst *req,\n\t\t\t\t struct xdr_stream *xdr,\n\t\t\t\t const struct nfs_fh *fh)\n{\n\tencode_fhandle(xdr, fh);\n}"
  },
  {
    "function_name": "decode_diropres",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "544-559",
    "snippet": "static int decode_diropres(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_diropok(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_diropok",
          "args": [
            "xdr",
            "result"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "decode_diropok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "532-542",
          "snippet": "static int decode_diropok(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tint error;\n\n\terror = decode_fhandle(xdr, result->fh);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_fattr(xdr, result->fattr);\nout:\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_diropok(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tint error;\n\n\terror = decode_fhandle(xdr, result->fh);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_fattr(xdr, result->fattr);\nout:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_diropres(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_diropok(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "decode_diropok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "532-542",
    "snippet": "static int decode_diropok(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tint error;\n\n\terror = decode_fhandle(xdr, result->fh);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_fattr(xdr, result->fattr);\nout:\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decode_fattr",
          "args": [
            "xdr",
            "result->fattr"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "278-330",
          "snippet": "static int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS_fattr_sz\t\t(17)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_fattr_sz\t\t(17)\n\nstatic int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_fhandle",
          "args": [
            "xdr",
            "result->fh"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "202-215",
          "snippet": "static int decode_fhandle(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS2_FHSIZE);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tfh->size = NFS2_FHSIZE;\n\tmemcpy(fh->data, p, NFS2_FHSIZE);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_fhandle(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS2_FHSIZE);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tfh->size = NFS2_FHSIZE;\n\tmemcpy(fh->data, p, NFS2_FHSIZE);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_diropok(struct xdr_stream *xdr, struct nfs_diropok *result)\n{\n\tint error;\n\n\terror = decode_fhandle(xdr, result->fh);\n\tif (unlikely(error))\n\t\tgoto out;\n\terror = decode_fattr(xdr, result->fattr);\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "encode_diropargs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "512-517",
    "snippet": "static void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_filename",
          "args": [
            "xdr",
            "name",
            "length"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "encode_filename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "396-404",
          "snippet": "static void encode_filename(struct xdr_stream *xdr,\n\t\t\t    const char *name, u32 length)\n{\n\t__be32 *p;\n\n\tWARN_ON_ONCE(length > NFS2_MAXNAMLEN);\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_filename(struct xdr_stream *xdr,\n\t\t\t    const char *name, u32 length)\n{\n\t__be32 *p;\n\n\tWARN_ON_ONCE(length > NFS2_MAXNAMLEN);\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_fhandle",
          "args": [
            "xdr",
            "fh"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "encode_fhandle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "194-200",
          "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_diropargs(struct xdr_stream *xdr, const struct nfs_fh *fh,\n\t\t\t     const char *name, u32 length)\n{\n\tencode_fhandle(xdr, fh);\n\tencode_filename(xdr, name, length);\n}"
  },
  {
    "function_name": "decode_attrstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "484-502",
    "snippet": "static int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfs_stat_to_errno",
          "args": [
            "status"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_stat_to_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "1106-1116",
          "snippet": "static int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);",
            "static const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\nstatic const struct {\n\tint stat;\n\tint errno;\n} nfs_errtbl[] = {\n\t{ NFS_OK,\t\t0\t\t},\n\t{ NFSERR_PERM,\t\t-EPERM\t\t},\n\t{ NFSERR_NOENT,\t\t-ENOENT\t\t},\n\t{ NFSERR_IO,\t\t-errno_NFSERR_IO},\n\t{ NFSERR_NXIO,\t\t-ENXIO\t\t},\n/*\t{ NFSERR_EAGAIN,\t-EAGAIN\t\t}, */\n\t{ NFSERR_ACCES,\t\t-EACCES\t\t},\n\t{ NFSERR_EXIST,\t\t-EEXIST\t\t},\n\t{ NFSERR_XDEV,\t\t-EXDEV\t\t},\n\t{ NFSERR_NODEV,\t\t-ENODEV\t\t},\n\t{ NFSERR_NOTDIR,\t-ENOTDIR\t},\n\t{ NFSERR_ISDIR,\t\t-EISDIR\t\t},\n\t{ NFSERR_INVAL,\t\t-EINVAL\t\t},\n\t{ NFSERR_FBIG,\t\t-EFBIG\t\t},\n\t{ NFSERR_NOSPC,\t\t-ENOSPC\t\t},\n\t{ NFSERR_ROFS,\t\t-EROFS\t\t},\n\t{ NFSERR_MLINK,\t\t-EMLINK\t\t},\n\t{ NFSERR_NAMETOOLONG,\t-ENAMETOOLONG\t},\n\t{ NFSERR_NOTEMPTY,\t-ENOTEMPTY\t},\n\t{ NFSERR_DQUOT,\t\t-EDQUOT\t\t},\n\t{ NFSERR_STALE,\t\t-ESTALE\t\t},\n\t{ NFSERR_REMOTE,\t-EREMOTE\t},\n#ifdef EWFLUSH\n\t{ NFSERR_WFLUSH,\t-EWFLUSH\t},\n#endif\n\t{ NFSERR_BADHANDLE,\t-EBADHANDLE\t},\n\t{ NFSERR_NOT_SYNC,\t-ENOTSYNC\t},\n\t{ NFSERR_BAD_COOKIE,\t-EBADCOOKIE\t},\n\t{ NFSERR_NOTSUPP,\t-ENOTSUPP\t},\n\t{ NFSERR_TOOSMALL,\t-ETOOSMALL\t},\n\t{ NFSERR_SERVERFAULT,\t-EREMOTEIO\t},\n\t{ NFSERR_BADTYPE,\t-EBADTYPE\t},\n\t{ NFSERR_JUKEBOX,\t-EJUKEBOX\t},\n\t{ -1,\t\t\t-EIO\t\t}\n};\n\nstatic int nfs_stat_to_errno(enum nfs_stat status)\n{\n\tint i;\n\n\tfor (i = 0; nfs_errtbl[i].stat != -1; i++) {\n\t\tif (nfs_errtbl[i].stat == (int)status)\n\t\t\treturn nfs_errtbl[i].errno;\n\t}\n\tdprintk(\"NFS: Unrecognized nfs status value: %u\\n\", status);\n\treturn nfs_errtbl[i].errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "decode_fattr",
          "args": [
            "xdr",
            "result"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "decode_fattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "278-330",
          "snippet": "static int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS_fattr_sz\t\t(17)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_fattr_sz\t\t(17)\n\nstatic int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decode_stat",
          "args": [
            "xdr",
            "&status"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "decode_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "154-166",
          "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nfs_stat_to_errno(enum nfs_stat);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_attrstat(struct xdr_stream *xdr, struct nfs_fattr *result,\n\t\t\t   __u32 *op_status)\n{\n\tenum nfs_stat status;\n\tint error;\n\n\terror = decode_stat(xdr, &status);\n\tif (unlikely(error))\n\t\tgoto out;\n\tif (op_status)\n\t\t*op_status = status;\n\tif (status != NFS_OK)\n\t\tgoto out_default;\n\terror = decode_fattr(xdr, result);\nout:\n\treturn error;\nout_default:\n\treturn nfs_stat_to_errno(status);\n}"
  },
  {
    "function_name": "decode_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "446-472",
    "snippet": "static int decode_path(struct xdr_stream *xdr)\n{\n\tu32 length, recvd;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p);\n\tif (unlikely(length >= xdr->buf->page_len || length > NFS_MAXPATHLEN))\n\t\tgoto out_size;\n\trecvd = xdr_read_pages(xdr, length);\n\tif (unlikely(length > recvd))\n\t\tgoto out_cheating;\n\txdr_terminate_string(xdr->buf, length);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned pathname too long: %u\\n\", length);\n\treturn -ENAMETOOLONG;\nout_cheating:\n\tdprintk(\"NFS: server cheating in pathname result: \"\n\t\t\"length %u > received %u\\n\", length, recvd);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: server cheating in pathname result: \"\n\t\t\"length %u > received %u\\n\"",
            "length",
            "recvd"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned pathname too long: %u\\n\"",
            "length"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_terminate_string",
          "args": [
            "xdr->buf",
            "length"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "length > recvd"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "length"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "length >= xdr->buf->page_len || length > NFS_MAXPATHLEN"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_path(struct xdr_stream *xdr)\n{\n\tu32 length, recvd;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tlength = be32_to_cpup(p);\n\tif (unlikely(length >= xdr->buf->page_len || length > NFS_MAXPATHLEN))\n\t\tgoto out_size;\n\trecvd = xdr_read_pages(xdr, length);\n\tif (unlikely(length > recvd))\n\t\tgoto out_cheating;\n\txdr_terminate_string(xdr->buf, length);\n\treturn 0;\nout_size:\n\tdprintk(\"NFS: returned pathname too long: %u\\n\", length);\n\treturn -ENAMETOOLONG;\nout_cheating:\n\tdprintk(\"NFS: server cheating in pathname result: \"\n\t\t\"length %u > received %u\\n\", length, recvd);\n\treturn -EIO;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "437-444",
    "snippet": "static void encode_path(struct xdr_stream *xdr, struct page **pages, u32 length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(length);\n\txdr_write_pages(xdr, pages, 0, length);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_write_pages",
          "args": [
            "xdr",
            "pages",
            "0",
            "length"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "length"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_path(struct xdr_stream *xdr, struct page **pages, u32 length)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, 4);\n\t*p = cpu_to_be32(length);\n\txdr_write_pages(xdr, pages, 0, length);\n}"
  },
  {
    "function_name": "decode_filename_inline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "406-430",
    "snippet": "static int decode_filename_inline(struct xdr_stream *xdr,\n\t\t\t\t  const char **name, u32 *length)\n{\n\t__be32 *p;\n\tu32 count;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\tif (count > NFS3_MAXNAMLEN)\n\t\tgoto out_nametoolong;\n\tp = xdr_inline_decode(xdr, count);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*name = (const char *)p;\n\t*length = count;\n\treturn 0;\nout_nametoolong:\n\tdprintk(\"NFS: returned filename too long: %u\\n\", count);\n\treturn -ENAMETOOLONG;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned filename too long: %u\\n\"",
            "count"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "count"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_filename_inline(struct xdr_stream *xdr,\n\t\t\t\t  const char **name, u32 *length)\n{\n\t__be32 *p;\n\tu32 count;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\tif (count > NFS3_MAXNAMLEN)\n\t\tgoto out_nametoolong;\n\tp = xdr_inline_decode(xdr, count);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*name = (const char *)p;\n\t*length = count;\n\treturn 0;\nout_nametoolong:\n\tdprintk(\"NFS: returned filename too long: %u\\n\", count);\n\treturn -ENAMETOOLONG;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "396-404",
    "snippet": "static void encode_filename(struct xdr_stream *xdr,\n\t\t\t    const char *name, u32 length)\n{\n\t__be32 *p;\n\n\tWARN_ON_ONCE(length > NFS2_MAXNAMLEN);\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "name",
            "length"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "4 + length"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "length > NFS2_MAXNAMLEN"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_filename(struct xdr_stream *xdr,\n\t\t\t    const char *name, u32 length)\n{\n\t__be32 *p;\n\n\tWARN_ON_ONCE(length > NFS2_MAXNAMLEN);\n\tp = xdr_reserve_space(xdr, 4 + length);\n\txdr_encode_opaque(p, name, length);\n}"
  },
  {
    "function_name": "encode_sattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "354-389",
    "snippet": "static void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS2_SATTR_NOT_SET\t(0xffffffff)",
      "#define NFS_sattr_sz\t\t(8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_time_not_set",
          "args": [
            "p"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_time_not_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "347-352",
          "snippet": "static __be32 *xdr_time_not_set(__be32 *p)\n{\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [
            "#define NFS2_SATTR_NOT_SET\t(0xffffffff)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n\nstatic __be32 *xdr_time_not_set(__be32 *p)\n{\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_current_server_time",
          "args": [
            "p",
            "&attr->ia_mtime"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_encode_current_server_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "242-248",
          "snippet": "static __be32 *xdr_encode_current_server_time(__be32 *p,\n\t\t\t\t\t      const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\t*p++ = cpu_to_be32(1000000);\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_encode_current_server_time(__be32 *p,\n\t\t\t\t\t      const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\t*p++ = cpu_to_be32(1000000);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_encode_time",
          "args": [
            "p",
            "&attr->ia_mtime"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_encode_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "225-233",
          "snippet": "static __be32 *xdr_encode_time(__be32 *p, const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\tif (timep->tv_nsec != 0)\n\t\t*p++ = cpu_to_be32(timep->tv_nsec / NSEC_PER_USEC);\n\telse\n\t\t*p++ = cpu_to_be32(0);\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_encode_time(__be32 *p, const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\tif (timep->tv_nsec != 0)\n\t\t*p++ = cpu_to_be32(timep->tv_nsec / NSEC_PER_USEC);\n\telse\n\t\t*p++ = cpu_to_be32(0);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "(u32)attr->ia_size"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "from_kgid(&init_user_ns, attr->ia_gid)"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "attr->ia_gid"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "from_kuid(&init_user_ns, attr->ia_uid)"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "attr->ia_uid"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "attr->ia_mode"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "NFS_sattr_sz << 2"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n#define NFS_sattr_sz\t\t(8)\n\nstatic void encode_sattr(struct xdr_stream *xdr, const struct iattr *attr)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS_sattr_sz << 2);\n\n\tif (attr->ia_valid & ATTR_MODE)\n\t\t*p++ = cpu_to_be32(attr->ia_mode);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_UID)\n\t\t*p++ = cpu_to_be32(from_kuid(&init_user_ns, attr->ia_uid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_GID)\n\t\t*p++ = cpu_to_be32(from_kgid(&init_user_ns, attr->ia_gid));\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\tif (attr->ia_valid & ATTR_SIZE)\n\t\t*p++ = cpu_to_be32((u32)attr->ia_size);\n\telse\n\t\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\n\tif (attr->ia_valid & ATTR_ATIME_SET)\n\t\tp = xdr_encode_time(p, &attr->ia_atime);\n\telse if (attr->ia_valid & ATTR_ATIME)\n\t\tp = xdr_encode_current_server_time(p, &attr->ia_atime);\n\telse\n\t\tp = xdr_time_not_set(p);\n\tif (attr->ia_valid & ATTR_MTIME_SET)\n\t\txdr_encode_time(p, &attr->ia_mtime);\n\telse if (attr->ia_valid & ATTR_MTIME)\n\t\txdr_encode_current_server_time(p, &attr->ia_mtime);\n\telse\n\t\txdr_time_not_set(p);\n}"
  },
  {
    "function_name": "xdr_time_not_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "347-352",
    "snippet": "static __be32 *xdr_time_not_set(__be32 *p)\n{\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS2_SATTR_NOT_SET\t(0xffffffff)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "NFS2_SATTR_NOT_SET"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS2_SATTR_NOT_SET\t(0xffffffff)\n\nstatic __be32 *xdr_time_not_set(__be32 *p)\n{\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\t*p++ = cpu_to_be32(NFS2_SATTR_NOT_SET);\n\treturn p;\n}"
  },
  {
    "function_name": "decode_fattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "278-330",
    "snippet": "static int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [
      "#define NFS_fattr_sz\t\t(17)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned invalid gid\\n\""
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: returned invalid uid\\n\""
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfs_timespec_to_change_attr",
          "args": [
            "&fattr->ctime"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_timespec_to_change_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/internal.h",
          "lines": "660-664",
          "snippet": "static inline\nu64 nfs_timespec_to_change_attr(const struct timespec *ts)\n{\n\treturn ((u64)ts->tv_sec << 30) + ts->tv_nsec;\n}",
          "includes": [
            "#include <linux/nfs_page.h>",
            "#include <linux/crc32.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include \"nfs4_fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nfs_page.h>\n#include <linux/crc32.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include \"nfs4_fs.h\"\n\nstatic inline\nu64 nfs_timespec_to_change_attr(const struct timespec *ts)\n{\n\treturn ((u64)ts->tv_sec << 30) + ts->tv_nsec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdr_decode_time",
          "args": [
            "p",
            "&fattr->ctime"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_decode_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "250-255",
          "snippet": "static __be32 *xdr_decode_time(__be32 *p, struct timespec *timep)\n{\n\ttimep->tv_sec = be32_to_cpup(p++);\n\ttimep->tv_nsec = be32_to_cpup(p++) * NSEC_PER_USEC;\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_decode_time(__be32 *p, struct timespec *timep)\n{\n\ttimep->tv_sec = be32_to_cpup(p++);\n\ttimep->tv_nsec = be32_to_cpup(p++) * NSEC_PER_USEC;\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_decode_dev",
          "args": [
            "rdev"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "fattr->gid"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "be32_to_cpup(p++)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "fattr->uid"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "gfs2_uuid_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/gfs2/sys.c",
          "lines": "73-82",
          "snippet": "static int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"recovery.h\"",
            "#include \"glops.h\"",
            "#include \"util.h\"",
            "#include \"quota.h\"",
            "#include \"glock.h\"",
            "#include \"super.h\"",
            "#include \"sys.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/genhd.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <asm/uaccess.h>",
            "#include <linux/kobject.h>",
            "#include <linux/module.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"recovery.h\"\n#include \"glops.h\"\n#include \"util.h\"\n#include \"quota.h\"\n#include \"glock.h\"\n#include \"super.h\"\n#include \"sys.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/genhd.h>\n#include <linux/gfs2_ondisk.h>\n#include <asm/uaccess.h>\n#include <linux/kobject.h>\n#include <linux/module.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n\nstatic int gfs2_uuid_valid(const u8 *uuid)\n{\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tif (uuid[i])\n\t\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "be32_to_cpup(p++)"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_decode_ftype",
          "args": [
            "p",
            "&type"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_decode_ftype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "181-187",
          "snippet": "static __be32 *xdr_decode_ftype(__be32 *p, u32 *type)\n{\n\t*type = be32_to_cpup(p++);\n\tif (unlikely(*type > NF2FIFO))\n\t\t*type = NFBAD;\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_decode_ftype(__be32 *p, u32 *type)\n{\n\t*type = be32_to_cpup(p++);\n\tif (unlikely(*type > NF2FIFO))\n\t\t*type = NFBAD;\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "NFS_fattr_sz << 2"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\n#define NFS_fattr_sz\t\t(17)\n\nstatic int decode_fattr(struct xdr_stream *xdr, struct nfs_fattr *fattr)\n{\n\tu32 rdev, type;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS_fattr_sz << 2);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\n\tfattr->valid |= NFS_ATTR_FATTR_V2;\n\n\tp = xdr_decode_ftype(p, &type);\n\n\tfattr->mode = be32_to_cpup(p++);\n\tfattr->nlink = be32_to_cpup(p++);\n\tfattr->uid = make_kuid(&init_user_ns, be32_to_cpup(p++));\n\tif (!uid_valid(fattr->uid))\n\t\tgoto out_uid;\n\tfattr->gid = make_kgid(&init_user_ns, be32_to_cpup(p++));\n\tif (!gid_valid(fattr->gid))\n\t\tgoto out_gid;\n\t\t\n\tfattr->size = be32_to_cpup(p++);\n\tfattr->du.nfs2.blocksize = be32_to_cpup(p++);\n\n\trdev = be32_to_cpup(p++);\n\tfattr->rdev = new_decode_dev(rdev);\n\tif (type == (u32)NFCHR && rdev == (u32)NFS2_FIFO_DEV) {\n\t\tfattr->mode = (fattr->mode & ~S_IFMT) | S_IFIFO;\n\t\tfattr->rdev = 0;\n\t}\n\n\tfattr->du.nfs2.blocks = be32_to_cpup(p++);\n\tfattr->fsid.major = be32_to_cpup(p++);\n\tfattr->fsid.minor = 0;\n\tfattr->fileid = be32_to_cpup(p++);\n\n\tp = xdr_decode_time(p, &fattr->atime);\n\tp = xdr_decode_time(p, &fattr->mtime);\n\txdr_decode_time(p, &fattr->ctime);\n\tfattr->change_attr = nfs_timespec_to_change_attr(&fattr->ctime);\n\n\treturn 0;\nout_uid:\n\tdprintk(\"NFS: returned invalid uid\\n\");\n\treturn -EINVAL;\nout_gid:\n\tdprintk(\"NFS: returned invalid gid\\n\");\n\treturn -EINVAL;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "xdr_decode_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "250-255",
    "snippet": "static __be32 *xdr_decode_time(__be32 *p, struct timespec *timep)\n{\n\ttimep->tv_sec = be32_to_cpup(p++);\n\ttimep->tv_nsec = be32_to_cpup(p++) * NSEC_PER_USEC;\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_decode_time(__be32 *p, struct timespec *timep)\n{\n\ttimep->tv_sec = be32_to_cpup(p++);\n\ttimep->tv_nsec = be32_to_cpup(p++) * NSEC_PER_USEC;\n\treturn p;\n}"
  },
  {
    "function_name": "xdr_encode_current_server_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "242-248",
    "snippet": "static __be32 *xdr_encode_current_server_time(__be32 *p,\n\t\t\t\t\t      const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\t*p++ = cpu_to_be32(1000000);\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "1000000"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "timep->tv_sec"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_encode_current_server_time(__be32 *p,\n\t\t\t\t\t      const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\t*p++ = cpu_to_be32(1000000);\n\treturn p;\n}"
  },
  {
    "function_name": "xdr_encode_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "225-233",
    "snippet": "static __be32 *xdr_encode_time(__be32 *p, const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\tif (timep->tv_nsec != 0)\n\t\t*p++ = cpu_to_be32(timep->tv_nsec / NSEC_PER_USEC);\n\telse\n\t\t*p++ = cpu_to_be32(0);\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "0"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "timep->tv_nsec / NSEC_PER_USEC"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_be32",
          "args": [
            "timep->tv_sec"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_encode_time(__be32 *p, const struct timespec *timep)\n{\n\t*p++ = cpu_to_be32(timep->tv_sec);\n\tif (timep->tv_nsec != 0)\n\t\t*p++ = cpu_to_be32(timep->tv_nsec / NSEC_PER_USEC);\n\telse\n\t\t*p++ = cpu_to_be32(0);\n\treturn p;\n}"
  },
  {
    "function_name": "decode_fhandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "202-215",
    "snippet": "static int decode_fhandle(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS2_FHSIZE);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tfh->size = NFS2_FHSIZE;\n\tmemcpy(fh->data, p, NFS2_FHSIZE);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fh->data",
            "p",
            "NFS2_FHSIZE"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "NFS2_FHSIZE"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_fhandle(struct xdr_stream *xdr, struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, NFS2_FHSIZE);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tfh->size = NFS2_FHSIZE;\n\tmemcpy(fh->data, p, NFS2_FHSIZE);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "encode_fhandle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "194-200",
    "snippet": "static void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "p",
            "fh->data",
            "NFS2_FHSIZE"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "NFS2_FHSIZE"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void encode_fhandle(struct xdr_stream *xdr, const struct nfs_fh *fh)\n{\n\t__be32 *p;\n\n\tp = xdr_reserve_space(xdr, NFS2_FHSIZE);\n\tmemcpy(p, fh->data, NFS2_FHSIZE);\n}"
  },
  {
    "function_name": "xdr_decode_ftype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "181-187",
    "snippet": "static __be32 *xdr_decode_ftype(__be32 *p, u32 *type)\n{\n\t*type = be32_to_cpup(p++);\n\tif (unlikely(*type > NF2FIFO))\n\t\t*type = NFBAD;\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "*type > NF2FIFO"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p++"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic __be32 *xdr_decode_ftype(__be32 *p, u32 *type)\n{\n\t*type = be32_to_cpup(p++);\n\tif (unlikely(*type > NF2FIFO))\n\t\t*type = NFBAD;\n\treturn p;\n}"
  },
  {
    "function_name": "decode_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "154-166",
    "snippet": "static int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nfs_stat_to_errno(enum nfs_stat);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int nfs_stat_to_errno(enum nfs_stat);\n\nstatic int decode_stat(struct xdr_stream *xdr, enum nfs_stat *status)\n{\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\t*status = be32_to_cpup(p);\n\treturn 0;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "decode_nfsdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "106-130",
    "snippet": "static int decode_nfsdata(struct xdr_stream *xdr, struct nfs_pgio_res *result)\n{\n\tu32 recvd, count;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (unlikely(count > recvd))\n\t\tgoto out_cheating;\nout:\n\tresult->eof = 0;\t/* NFSv2 does not pass EOF flag on the wire. */\n\tresult->count = count;\n\treturn count;\nout_cheating:\n\tdprintk(\"NFS: server cheating in read result: \"\n\t\t\"count %u > recvd %u\\n\", count, recvd);\n\tcount = recvd;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_overflow_msg",
          "args": [
            "__func__",
            "xdr"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "print_overflow_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
          "lines": "84-89",
          "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/nfs_fs.h>",
            "#include <linux/nfs2.h>",
            "#include <linux/nfs.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/in.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/time.h>",
            "#include <linux/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: server cheating in read result: \"\n\t\t\"count %u > recvd %u\\n\"",
            "count",
            "recvd"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "count > recvd"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_read_pages",
          "args": [
            "xdr",
            "count"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "be32_to_cpup",
          "args": [
            "p"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p == NULL"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_inline_decode",
          "args": [
            "xdr",
            "4"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic int decode_nfsdata(struct xdr_stream *xdr, struct nfs_pgio_res *result)\n{\n\tu32 recvd, count;\n\t__be32 *p;\n\n\tp = xdr_inline_decode(xdr, 4);\n\tif (unlikely(p == NULL))\n\t\tgoto out_overflow;\n\tcount = be32_to_cpup(p);\n\trecvd = xdr_read_pages(xdr, count);\n\tif (unlikely(count > recvd))\n\t\tgoto out_cheating;\nout:\n\tresult->eof = 0;\t/* NFSv2 does not pass EOF flag on the wire. */\n\tresult->count = count;\n\treturn count;\nout_cheating:\n\tdprintk(\"NFS: server cheating in read result: \"\n\t\t\"count %u > recvd %u\\n\", count, recvd);\n\tcount = recvd;\n\tgoto out;\nout_overflow:\n\tprint_overflow_msg(__func__, xdr);\n\treturn -EIO;\n}"
  },
  {
    "function_name": "print_overflow_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "84-89",
    "snippet": "static void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dprintk",
          "args": [
            "\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\"",
            "func",
            "xdr->end - xdr->p"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void print_overflow_msg(const char *func, const struct xdr_stream *xdr)\n{\n\tdprintk(\"NFS: %s prematurely hit the end of our receive buffer. \"\n\t\t\"Remaining buffer length is %tu words.\\n\",\n\t\tfunc, xdr->end - xdr->p);\n}"
  },
  {
    "function_name": "prepare_reply_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9717/repo/fs/nfs/nfs2xdr.c",
    "lines": "70-79",
    "snippet": "static void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/nfs_fs.h>",
      "#include <linux/nfs2.h>",
      "#include <linux/nfs.h>",
      "#include <linux/sunrpc/clnt.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/in.h>",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/time.h>",
      "#include <linux/param.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_inline_pages",
          "args": [
            "&req->rq_rcv_buf",
            "replen << 2",
            "pages",
            "base",
            "len"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/nfs_fs.h>\n#include <linux/nfs2.h>\n#include <linux/nfs.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/in.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/time.h>\n#include <linux/param.h>\n\nstatic void prepare_reply_buffer(struct rpc_rqst *req, struct page **pages,\n\t\t\t\t unsigned int base, unsigned int len,\n\t\t\t\t unsigned int bufsize)\n{\n\tstruct rpc_auth\t*auth = req->rq_cred->cr_auth;\n\tunsigned int replen;\n\n\treplen = RPC_REPHDRSIZE + auth->au_rslack + bufsize;\n\txdr_inline_pages(&req->rq_rcv_buf, replen << 2, pages, base, len);\n}"
  }
]